- en: '2.3\. Geometry of least squares: the orthogonal projection#'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 2.3\. 最小二乘法的几何学：正交投影#
- en: 原文：[https://mmids-textbook.github.io/chap02_ls/03_orthog/roch-mmids-ls-orthog.html](https://mmids-textbook.github.io/chap02_ls/03_orthog/roch-mmids-ls-orthog.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://mmids-textbook.github.io/chap02_ls/03_orthog/roch-mmids-ls-orthog.html](https://mmids-textbook.github.io/chap02_ls/03_orthog/roch-mmids-ls-orthog.html)
- en: 'We consider the following problem: we are given \(A \in \mathbb{R}^{n\times
    m}\) an \(n\times m\) matrix and \(\mathbf{b} \in \mathbb{R}^n\) a vector. We
    are looking to solve the system \(A \mathbf{x} \approx \mathbf{b}\). In the special
    case where \(A\) is invertible, a unique exact solution exists. In general, however,
    a solution may not exist or may not be unique. We focus here on the over-determined
    case where the former situation generically occurs. We begin by rewieving the
    concept of orthogonality.'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 我们考虑以下问题：我们给定 \(A \in \mathbb{R}^{n\times m}\) 一个 \(n\times m\) 的矩阵和 \(\mathbf{b}
    \in \mathbb{R}^n\) 一个向量。我们试图求解系统 \(A \mathbf{x} \approx \mathbf{b}\)。在 \(A\) 可逆的特殊情况下，存在一个唯一的精确解。然而，在一般情况下，解可能不存在或可能不是唯一的。我们专注于前者通常发生的情况，即过定的情况。我们首先回顾正交性的概念。
- en: '2.3.1\. A key concept: orthogonality[#](#a-key-concept-orthogonality "Link
    to this heading")'
  id: totrans-3
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.3.1\. 一个关键概念：正交性[#](#a-key-concept-orthogonality "链接到这个标题")
- en: Orthogonality plays a key role in linear algebra for data science thanks to
    its computational properties and its connection to the least-squares problem.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 正交性由于其计算特性和与最小二乘问题的联系，在线性代数中在数据科学中扮演着关键角色。
- en: '**DEFINITION** **(Orthogonality)** \(\idx{orthogonality}\xdi\) Vectors \(\mathbf{u}\)
    and \(\mathbf{v}\) in \(\mathbb{R}^n\) (as column vectors) are orthogonal if their
    inner product is zero'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '**定义** **(正交性)** \(\idx{正交性}\xdi\) 在 \(\mathbb{R}^n\) 中（作为列向量）的向量 \(\mathbf{u}\)
    和 \(\mathbf{v}\) 是正交的，如果它们的内积为零'
- en: \[ \langle \mathbf{u}, \mathbf{v} \rangle =\mathbf{u}^T \mathbf{v} = \sum_{i=1}^n
    u_i v_i = 0. \]
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \langle \mathbf{u}, \mathbf{v} \rangle =\mathbf{u}^T \mathbf{v} = \sum_{i=1}^n
    u_i v_i = 0. \]
- en: \(\natural\)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: \(\natural\)
- en: Orthogonality has important implications. The following classical result will
    be useful below. Throughout, we use \(\|\mathbf{u}\|\) for the Euclidean norm
    of \(\mathbf{u}\).
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 正交性有重要的含义。以下经典结果将在下面有用。在整个过程中，我们使用 \(\|\mathbf{u}\|\) 表示 \(\mathbf{u}\) 的欧几里得范数。
- en: '**THEOREM** **(Pythagoras)** \(\idx{Pythagoras'' theorem}\xdi\) Let \(\mathbf{u},
    \mathbf{v} \in \mathbb{R}^n\) be orthogonal. Then \(\|\mathbf{u} + \mathbf{v}\|^2
    = \|\mathbf{u}\|^2 + \|\mathbf{v}\|^2\). \(\sharp\)'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '**定理** **(毕达哥拉斯)** \(\idx{毕达哥拉斯定理}\xdi\) 设 \(\mathbf{u}, \mathbf{v} \in \mathbb{R}^n\)
    是正交的。那么 \(\|\mathbf{u} + \mathbf{v}\|^2 = \|\mathbf{u}\|^2 + \|\mathbf{v}\|^2\).
    \(\sharp\)'
- en: '*Proof:* Using \(\|\mathbf{w}\|^2 = \langle \mathbf{w}, \mathbf{w}\rangle\),
    we get'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '**证明：** 使用 \(\|\mathbf{w}\|^2 = \langle \mathbf{w}, \mathbf{w}\rangle\)，我们得到'
- en: \[\begin{align*} \|\mathbf{u} + \mathbf{v}\|^2 &= \langle \mathbf{u} + \mathbf{v},
    \mathbf{u} + \mathbf{v}\rangle\\ &= \langle \mathbf{u}, \mathbf{u}\rangle + 2
    \,\langle \mathbf{u}, \mathbf{v}\rangle + \langle \mathbf{v}, \mathbf{v}\rangle\\
    &= \|\mathbf{u}\|^2 + \|\mathbf{v}\|^2. \end{align*}\]
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \|\mathbf{u} + \mathbf{v}\|^2 &= \langle \mathbf{u} + \mathbf{v},
    \mathbf{u} + \mathbf{v}\rangle\\ &= \langle \mathbf{u}, \mathbf{u}\rangle + 2
    \,\langle \mathbf{u}, \mathbf{v}\rangle + \langle \mathbf{v}, \mathbf{v}\rangle\\
    &= \|\mathbf{u}\|^2 + \|\mathbf{v}\|^2. \end{align*}\]
- en: \(\square\)
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: \(\square\)
- en: An application of *Pythagoras’ Theorem* is a proof of the *Cauchy-Schwarz Inequality*.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '**毕达哥拉斯定理**的应用是**柯西-施瓦茨不等式**的证明。'
- en: '*Proof:* *(Cauchy-Schwarz)* \(\idx{Cauchy-Schwarz inequality}\xdi\) Let \(\mathbf{q}
    = \frac{\mathbf{v}}{\|\mathbf{v}\|}\) be the unit vector in the direction of \(\mathbf{v}\).
    We want to show \(|\langle \mathbf{u}, \mathbf{q}\rangle| \leq \|\mathbf{u}\|\).
    Decompose \(\mathbf{u}\) as follows:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '**证明：** *(柯西-施瓦茨)* \(\idx{柯西-施瓦茨不等式}\xdi\) 设 \(\mathbf{q} = \frac{\mathbf{v}}{\|\mathbf{v}\|}\)
    为 \(\mathbf{v}\) 方向上的单位向量。我们要证明 \(|\langle \mathbf{u}, \mathbf{q}\rangle| \leq
    \|\mathbf{u}\|\)。如下分解 \(\mathbf{u}\)：'
- en: \[ \mathbf{u} = \left\langle \mathbf{u}, \mathbf{q}\right\rangle \mathbf{q}
    + \left\{\mathbf{u} - \left\langle \mathbf{u}, \mathbf{q}\right\rangle \mathbf{q}\right\}.
    \]
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{u} = \left\langle \mathbf{u}, \mathbf{q}\right\rangle \mathbf{q}
    + \left\{\mathbf{u} - \left\langle \mathbf{u}, \mathbf{q}\right\rangle \mathbf{q}\right\}.
    \]
- en: 'The two terms on the right-hand side are orthogonal:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 右侧的两个项是正交的：
- en: \[ \left\langle \left\langle \mathbf{u}, \mathbf{q}\right\rangle \mathbf{q},
    \mathbf{u} - \left\langle \mathbf{u}, \mathbf{q}\right\rangle \mathbf{q} \right\rangle
    = \left\langle \mathbf{u}, \mathbf{q}\right\rangle^2 - \left\langle \mathbf{u},
    \mathbf{q}\right\rangle^2 \left\langle \mathbf{q}, \mathbf{q}\right\rangle = 0.
    \]
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \left\langle \left\langle \mathbf{u}, \mathbf{q}\right\rangle \mathbf{q},
    \mathbf{u} - \left\langle \mathbf{u}, \mathbf{q}\right\rangle \mathbf{q} \right\rangle
    = \left\langle \mathbf{u}, \mathbf{q}\right\rangle^2 - \left\langle \mathbf{u},
    \mathbf{q}\right\rangle^2 \left\langle \mathbf{q}, \mathbf{q}\right\rangle = 0.
    \]
- en: So *Pythagoras* gives
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，**毕达哥拉斯**给出
- en: \[ \|\mathbf{u}\|^2 = \left\|\left\langle \mathbf{u}, \mathbf{q}\right\rangle
    \mathbf{q}\right\|^2 + \left\|\mathbf{u} - \left\langle \mathbf{u}, \mathbf{q}\right\rangle
    \mathbf{q}\right\|^2 \geq \left\|\left\langle \mathbf{u}, \mathbf{q}\right\rangle
    \mathbf{q}\right\|^2 = \left\langle \mathbf{u}, \mathbf{q}\right\rangle^2. \]
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \|\mathbf{u}\|^2 = \left\|\left\langle \mathbf{u}, \mathbf{q}\right\rangle
    \mathbf{q}\right\|^2 + \left\|\mathbf{u} - \left\langle \mathbf{u}, \mathbf{q}\right\rangle
    \mathbf{q}\right\|^2 \geq \left\|\left\langle \mathbf{u}, \mathbf{q}\right\rangle
    \mathbf{q}\right\|^2 = \left\langle \mathbf{u}, \mathbf{q}\right\rangle^2. \]
- en: Taking a square root gives the claim. \(\square\)
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 开平方得到结论。\(\square\)
- en: '**Orthonormal basis expansion** To begin to see the power of orthogonality,
    consider the following. A list of vectors \(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\)
    is an orthonormal list if the \(\mathbf{u}_i\)’s are pairwise orthogonal and each
    has norm 1, that is, for all \(i\) and all \(j \neq i\), we have \(\|\mathbf{u}_i\|
    = 1\) and \(\langle \mathbf{u}_i, \mathbf{u}_j \rangle = 0\). Alternatively,'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: '**正交基展开** 为了开始看到正交性的力量，考虑以下内容。向量列表\(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\)是一个正交列表，如果\(\mathbf{u}_i\)是成对正交的，并且每个向量的范数为1，即对于所有\(i\)和所有\(j
    \neq i\)，我们有\(\|\mathbf{u}_i\| = 1\)和\(\langle \mathbf{u}_i, \mathbf{u}_j \rangle
    = 0\)。或者，'
- en: \[\begin{split} \langle \mathbf{u}_i, \mathbf{u}_j \rangle = \begin{cases} 1
    & \text{if $i=j$}\\ 0 & \text{if $i\neq j$}. \end{cases} \end{split}\]
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \langle \mathbf{u}_i, \mathbf{u}_j \rangle = \begin{cases} 1
    & \text{如果 } i=j\\ 0 & \text{如果 } i\neq j. \end{cases} \end{split}\]
- en: '**LEMMA** **(Properties of Orthonormal Lists)** \(\idx{properties of orthonormal
    lists}\xdi\) Let \(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\) be an orthonormal list.
    Then:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '**引理** **(正交列表的性质)** \(\idx{正交列表的性质}\xdi\) 设\(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\)是一个正交列表。那么：'
- en: for any \(\alpha_j \in \mathbb{R}\), \(j=1,\ldots,m\), we have
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于任何\(\alpha_j \in \mathbb{R}\)，\(j=1,\ldots,m\)，我们有
- en: \[ \left\|\sum_{j=1}^m \alpha_j \mathbf{u}_j\right\|^2 = \sum_{j=1}^m \alpha_j^2,
    \]
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \left\|\sum_{j=1}^m \alpha_j \mathbf{u}_j\right\|^2 = \sum_{j=1}^m \alpha_j^2,
    \]
- en: the vectors \(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\) are linearly independent.
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向量\(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\)是线性无关的。
- en: \(\flat\)
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: \(\flat\)
- en: '*Proof:* For 1., using that \(\|\mathbf{x}\|^2 = \langle \mathbf{x}, \mathbf{x}
    \rangle\), we have'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明:* 对于1，利用\(\|\mathbf{x}\|^2 = \langle \mathbf{x}, \mathbf{x} \rangle\)，我们有'
- en: \[\begin{align*} \left\|\sum_{j=1}^m \alpha_j \mathbf{u}_j\right\|^2 &= \left\langle
    \sum_{i=1}^m \alpha_i \mathbf{u}_i, \sum_{j=1}^m \alpha_j \mathbf{u}_j \right\rangle\\
    &= \sum_{i=1}^m \alpha_i \left\langle \mathbf{u}_i, \sum_{j=1}^m \alpha_j \mathbf{u}_j
    \right\rangle\\ &= \sum_{i=1}^m \sum_{j=1}^m \alpha_i \alpha_j \left\langle \mathbf{u}_i,
    \mathbf{u}_j \right\rangle\\ &= \sum_{i=1}^m \alpha_i^2 \end{align*}\]
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \left\|\sum_{j=1}^m \alpha_j \mathbf{u}_j\right\|^2 &= \left\langle
    \sum_{i=1}^m \alpha_i \mathbf{u}_i, \sum_{j=1}^m \alpha_j \mathbf{u}_j \right\rangle\\
    &= \sum_{i=1}^m \alpha_i \left\langle \mathbf{u}_i, \sum_{j=1}^m \alpha_j \mathbf{u}_j
    \right\rangle\\ &= \sum_{i=1}^m \sum_{j=1}^m \alpha_i \alpha_j \left\langle \mathbf{u}_i,
    \mathbf{u}_j \right\rangle\\ &= \sum_{i=1}^m \alpha_i^2 \end{align*}\]
- en: where we used orthonormality in the last equation, that is, \(\langle \mathbf{u}_i,
    \mathbf{u}_j \rangle\) is \(1\) if \(i=j\) and \(0\) otherwise.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 其中我们在最后一个等式中使用了正交性，即\(\langle \mathbf{u}_i, \mathbf{u}_j \rangle\)在\(i=j\)时为1，否则为0。
- en: For 2., suppose \(\sum_{i=1}^m \beta_i \mathbf{u}_i = \mathbf{0}\), then we
    must have by 1\. that \(\sum_{i=1}^m \beta_i^2 = 0\). That implies \(\beta_i =
    0\) for all \(i\). Hence the \(\mathbf{u}_i\)’s are linearly independent. \(\square\)
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 对于2，假设\(\sum_{i=1}^m \beta_i \mathbf{u}_i = \mathbf{0}\)，那么根据1，我们必须有\(\sum_{i=1}^m
    \beta_i^2 = 0\)。这意味着对于所有\(i\)，\(\beta_i = 0\)。因此，\(\mathbf{u}_i\)是线性无关的。\(\square\)
- en: 'Given a basis \(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\) of \(U\), we know that:
    for any \(\mathbf{w} \in U\), \(\mathbf{w} = \sum_{i=1}^m \alpha_i \mathbf{u}_i\)
    for some \(\alpha_i\)’s. It is not immediately obvious in general how to find
    the \(\alpha_i\)’s – one must solve a system of linear equations. In the orthonormal
    case, however, there is a formula. We say that the basis \(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\)
    is orthonormal if it forms an orthonormal list.'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 给定\(U\)的一个基\(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\)，我们知道：对于\(U\)中的任何\(\mathbf{w}\)，\(\mathbf{w}
    = \sum_{i=1}^m \alpha_i \mathbf{u}_i\)，其中存在一些\(\alpha_i\)。在一般情况下，如何找到\(\alpha_i\)并不明显——必须解一个线性方程组。然而，在正交的情况下，有一个公式。我们说基\(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\)是正交的，如果它形成一个正交列表。
- en: '**THEOREM** **(Orthonormal Expansion)** \(\idx{orthonormal expansion theorem}\xdi\)
    Let \(\mathbf{q}_1,\ldots,\mathbf{q}_m\) be an orthonormal basis of \(U\) and
    let \(\mathbf{w} \in U\). Then'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: '**定理** **(正交展开定理)** \(\idx{正交展开定理}\xdi\) 设\(\mathbf{q}_1,\ldots,\mathbf{q}_m\)是\(U\)的一个正交基，并且设\(\mathbf{w}
    \in U\)。那么'
- en: \[ \mathbf{w} = \sum_{j=1}^m \langle \mathbf{w}, \mathbf{q}_j\rangle \,\mathbf{q}_j.
    \]
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{w} = \sum_{j=1}^m \langle \mathbf{w}, \mathbf{q}_j\rangle \,\mathbf{q}_j.
    \]
- en: \(\sharp\)
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: \(\sharp\)
- en: '*Proof:* Because \(\mathbf{w} \in U\), \(\mathbf{w} = \sum_{i=1}^m \alpha_i
    \mathbf{q}_i\) for some \(\alpha_i\). Take the inner product with \(\mathbf{q}_j\)
    and use orthonormality:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明:* 因为 \(\mathbf{w} \in U\)，\(\mathbf{w} = \sum_{i=1}^m \alpha_i \mathbf{q}_i\)
    对于某些 \(\alpha_i\)。与 \(\mathbf{q}_j\) 取内积并使用正交性：'
- en: \[ \langle \mathbf{w}, \mathbf{q}_j\rangle = \left\langle \sum_{i=1}^m \alpha_i
    \mathbf{q}_i, \mathbf{q}_j\right\rangle = \sum_{i=1}^m \alpha_i \langle \mathbf{q}_i,
    \mathbf{q}_j\rangle = \alpha_j. \]
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \langle \mathbf{w}, \mathbf{q}_j\rangle = \left\langle \sum_{i=1}^m \alpha_i
    \mathbf{q}_i, \mathbf{q}_j\right\rangle = \sum_{i=1}^m \alpha_i \langle \mathbf{q}_i,
    \mathbf{q}_j\rangle = \alpha_j. \]
- en: Hence, we have determined all \(\alpha_j\)’s in the basis expansion of \(\mathbf{w}\).
    \(\square\)
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们已经确定了 \(\mathbf{w}\) 的基展开中的所有 \(\alpha_j\)。 \(\square\)
- en: '**EXAMPLE:** Consider again the linear subspace \(W = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3)\),
    where \(\mathbf{w}_1 = (1,0,1)\), \(\mathbf{w}_2 = (0,1,1)\), and \(\mathbf{w}_3
    = (1,-1,0)\). We have shown that in fact'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: '**EXAMPLE:** 考虑再次线性子空间 \(W = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3)\)，其中
    \(\mathbf{w}_1 = (1,0,1)\)，\(\mathbf{w}_2 = (0,1,1)\)，和 \(\mathbf{w}_3 = (1,-1,0)\)。我们已经证明实际上'
- en: \[ \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3) = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2),
    \]
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3) = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2),
    \]
- en: as \(\mathbf{w}_1,\mathbf{w}_2\) form a basis of \(W\). On the other hand,
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 因为 \(\mathbf{w}_1,\mathbf{w}_2\) 形成 \(W\) 的一个基。另一方面，
- en: \[ \langle\mathbf{w}_1,\mathbf{w}_2\rangle = (1)(0) + (0)(1) + (1)(1) = 0 +
    0 + 1 = 1 \neq 0 \]
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \langle\mathbf{w}_1,\mathbf{w}_2\rangle = (1)(0) + (0)(1) + (1)(1) = 0 +
    0 + 1 = 1 \neq 0 \]
- en: so this basis is not orthonormal. Indeed, an orthonormal list is necessarily
    an independent list, but the opposite may not hold.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 因此这个基不是正交归一的。实际上，一个正交归一的列表必然是一个独立的列表，但反之不一定成立。
- en: To produce an orthonormal basis of \(W\), we can first proceed by normalizing
    \(\mathbf{w}_1\)
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 为了生成 \(W\) 的一个正交归一基，我们首先可以通过标准化 \(\mathbf{w}_1\)
- en: \[ \mathbf{q}_1 = \frac{\mathbf{w}_1}{\|\mathbf{w}_1\|} = \frac{\mathbf{w}_1}{\sqrt{1^2
    + 0^2 + 1^2}} = \frac{1}{\sqrt{2}} \mathbf{w}_1. \]
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{q}_1 = \frac{\mathbf{w}_1}{\|\mathbf{w}_1\|} = \frac{\mathbf{w}_1}{\sqrt{1^2
    + 0^2 + 1^2}} = \frac{1}{\sqrt{2}} \mathbf{w}_1. \]
- en: Then \(\|\mathbf{q}_1\| = 1\) since, in general, by absolute homogeneity of
    the norm
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 然后 \(\|\mathbf{q}_1\| = 1\)，因为，一般来说，由范数的绝对齐次性
- en: \[ \left\|\frac{\mathbf{w}_1}{\|\mathbf{w}_1\|}\right\| = \frac{1}{\|\mathbf{w}_1\|}
    \|\mathbf{w}_1\| = 1. \]
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \left\|\frac{\mathbf{w}_1}{\|\mathbf{w}_1\|}\right\| = \frac{1}{\|\mathbf{w}_1\|}
    \|\mathbf{w}_1\| = 1. \]
- en: 'We then seek a second basis vector. It must satisfy two conditions in this
    case:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 我们接下来寻求第二个基向量。在这种情况下，它必须满足两个条件：
- en: it must be of unit norm and be orthogonal to \(\mathbf{q}_1\); and
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它必须具有单位范数并且与 \(\mathbf{q}_1\) 正交；并且
- en: \(\mathbf{w}_2\) must be a linear combination of \(\mathbf{q}_1\) and \(\mathbf{q}_2\).
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: \(\mathbf{w}_2\) 必须是 \(\mathbf{q}_1\) 和 \(\mathbf{q}_2\) 的线性组合。
- en: The latter condition guarantees that \(\mathrm{span}(\mathbf{q}_1,\mathbf{q}_2)
    = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2)\). (Formally, that would imply only
    that \(\mathrm{span}(\mathbf{w}_1,\mathbf{w}_2) \subseteq \mathrm{span}(\mathbf{q}_1,\mathbf{q}_2)\).
    In this case, it is easy to see that the containment must go in the opposite direction
    as well. Why?)
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 后者条件保证了 \(\mathrm{span}(\mathbf{q}_1,\mathbf{q}_2) = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2)\)。（形式上，这只会意味着
    \(\mathrm{span}(\mathbf{w}_1,\mathbf{w}_2) \subseteq \mathrm{span}(\mathbf{q}_1,\mathbf{q}_2)\)。在这种情况下，很容易看出包含关系也必须相反。为什么？）
- en: The first condition translates into
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个条件转化为
- en: \[ 1 = \|\mathbf{q}_2\|^2 = q_{21}^2 + q_{22}^2 + q_{23}^2, \]
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 1 = \|\mathbf{q}_2\|^2 = q_{21}^2 + q_{22}^2 + q_{23}^2, \]
- en: where \(\mathbf{q}_2 = (q_{21}, q_{22}, q_{23})\), and
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(\mathbf{q}_2 = (q_{21}, q_{22}, q_{23})\)，并且
- en: \[ 0 = \langle\mathbf{q}_1, \mathbf{q}_2\rangle = \frac{1}{\sqrt{2}}\left[1\cdot
    q_{21} + 0 \cdot q_{22} + 1 \cdot q_{23}\right] = \frac{1}{\sqrt{2}}\left[q_{21}
    + q_{23}\right]. \]
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 0 = \langle\mathbf{q}_1, \mathbf{q}_2\rangle = \frac{1}{\sqrt{2}}\left[1\cdot
    q_{21} + 0 \cdot q_{22} + 1 \cdot q_{23}\right] = \frac{1}{\sqrt{2}}\left[q_{21}
    + q_{23}\right]. \]
- en: That is, simplifying the second display and plugging into the first, \(q_{23}
    = -q_{21}\) and \(q_{22} = \sqrt{1 - 2 q_{21}^2}\).
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 即，简化第二个显示并代入第一个，\(q_{23} = -q_{21}\) 和 \(q_{22} = \sqrt{1 - 2 q_{21}^2}\)。
- en: 'The second condition translates into: there is \(\beta_1, \beta_2 \in \mathbb{R}\)
    such that'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 第二个条件转化为：存在 \(\beta_1, \beta_2 \in \mathbb{R}\) 使得
- en: \[\begin{split} \mathbf{w}_2 = \begin{pmatrix} 0 \\ 1 \\ 1 \end{pmatrix} = \beta_1
    \mathbf{q}_1 + \beta_2 \mathbf{q}_2 = \beta_1 \frac{1}{\sqrt{2}} \begin{pmatrix}
    1 \\ 0 \\ 1 \end{pmatrix} + \beta_2 \begin{pmatrix} q_{21} \\ \sqrt{1-2 q_{21}^2}
    \\ -q_{21} \end{pmatrix}. \end{split}\]
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{w}_2 = \begin{pmatrix} 0 \\ 1 \\ 1 \end{pmatrix} = \beta_1
    \mathbf{q}_1 + \beta_2 \mathbf{q}_2 = \beta_1 \frac{1}{\sqrt{2}} \begin{pmatrix}
    1 \\ 0 \\ 1 \end{pmatrix} + \beta_2 \begin{pmatrix} q_{21} \\ \sqrt{1-2 q_{21}^2}
    \\ -q_{21} \end{pmatrix}. \end{split}\]
- en: The first entry gives \(\beta_1/\sqrt{2} + \beta_2 q_{21} = 0\) while the third
    entry gives \(\beta_1/\sqrt{2} - \beta_2 q_{21} = 1\). Adding up the equations
    gives \(\beta_1 = 1/\sqrt{2}\). Plugging back into the first one gives \(\beta_2
    = -1/(2q_{21})\). Returning to the equation for \(\mathbf{w}_2\), we get from
    the second entry
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 第一项给出 \(\beta_1/\sqrt{2} + \beta_2 q_{21} = 0\)，而第三项给出 \(\beta_1/\sqrt{2} -
    \beta_2 q_{21} = 1\)。将方程相加得到 \(\beta_1 = 1/\sqrt{2}\)。将这个值代入第一个方程中得到 \(\beta_2
    = -1/(2q_{21})\)。回到 \(\mathbf{w}_2\) 的方程，从第二个方程中得到
- en: \[ 1 = - \frac{1}{2 q_{21}} \sqrt{1 - 2 q_{21}^2}. \]
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 1 = - \frac{1}{2 q_{21}} \sqrt{1 - 2 q_{21}^2}. \]
- en: Rearranging and taking a square, we want the negative solution to
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 通过重新排列并取平方，我们希望得到负解。
- en: \[ 4 q_{21}^2 = 1 - 2 q_{21}^2, \]
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 4 q_{21}^2 = 1 - 2 q_{21}^2, \]
- en: that is, \(q_{21} = - 1/\sqrt{6}\). Finally, we get \(q_{23} = - q_{21} = 1/\sqrt{6}\)
    and \(q_{22} = \sqrt{1 - 2 q_{21}^2} = \sqrt{1 - 1/3} = \sqrt{2/3} = 2/\sqrt{6}\).
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 即，\(q_{21} = - 1/\sqrt{6}\)。最后，我们得到 \(q_{23} = - q_{21} = 1/\sqrt{6}\) 和 \(q_{22}
    = \sqrt{1 - 2 q_{21}^2} = \sqrt{1 - 1/3} = \sqrt{2/3} = 2/\sqrt{6}\)。
- en: To summarize, we have
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 总结一下，我们有
- en: \[\begin{split} \mathbf{q}_1 = \frac{1}{\sqrt{2}} \begin{pmatrix} 1\\ 0\\ 1
    \end{pmatrix}, \quad \mathbf{q}_2 = \frac{1}{\sqrt{6}} \begin{pmatrix} -1\\ 2\\
    1 \end{pmatrix}. \end{split}\]
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{q}_1 = \frac{1}{\sqrt{2}} \begin{pmatrix} 1\\ 0\\ 1
    \end{pmatrix}, \quad \mathbf{q}_2 = \frac{1}{\sqrt{6}} \begin{pmatrix} -1\\ 2\\
    1 \end{pmatrix}. \end{split}\]
- en: We confirm that
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 我们确认
- en: \[ \langle \mathbf{q}_1, \mathbf{q}_2\rangle = \frac{1}{\sqrt{2}\sqrt{6}}[(1)(-1)
    + (0)(2) + (1)(1)] = 0 \]
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \langle \mathbf{q}_1, \mathbf{q}_2\rangle = \frac{1}{\sqrt{2}\sqrt{6}}[(1)(-1)
    + (0)(2) + (1)(1)] = 0 \]
- en: and
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 和
- en: \[ \|\mathbf{q}_2\|^2 = \left(-\frac{1}{\sqrt{6}}\right)^2 + \left(\frac{2}{\sqrt{6}}\right)^2
    + \left(\frac{1}{\sqrt{6}}\right)^2 = \frac{1}{6} + \frac{4}{6} + \frac{1}{6}
    = 1. \]
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \|\mathbf{q}_2\|^2 = \left(-\frac{1}{\sqrt{6}}\right)^2 + \left(\frac{2}{\sqrt{6}}\right)^2
    + \left(\frac{1}{\sqrt{6}}\right)^2 = \frac{1}{6} + \frac{4}{6} + \frac{1}{6}
    = 1. \]
- en: We can use the *Orthonormal Expansion Theorem* to write \(\mathbf{w}_2\) as
    a linear combination of \(\mathbf{q}_1\) and \(\mathbf{q}_2\). The inner products
    are
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用 *正交展开定理* 将 \(\mathbf{w}_2\) 写成 \(\mathbf{q}_1\) 和 \(\mathbf{q}_2\) 的线性组合。内积是
- en: \[ \langle \mathbf{w}_2, \mathbf{q}_1 \rangle = 0 \left(\frac{1}{\sqrt{2}}\right)
    + 1 \left(\frac{0}{\sqrt{2}}\right) + 1 \left(\frac{1}{\sqrt{2}}\right) = \frac{1}{\sqrt{2}},
    \]\[ \langle \mathbf{w}_2, \mathbf{q}_2 \rangle = 0 \left(-\frac{1}{\sqrt{6}}\right)
    + 1 \left(\frac{2}{\sqrt{6}}\right) + 1 \left(\frac{1}{\sqrt{6}}\right) = \frac{3}{\sqrt{6}}.
    \]
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \langle \mathbf{w}_2, \mathbf{q}_1 \rangle = 0 \left(\frac{1}{\sqrt{2}}\right)
    + 1 \left(\frac{0}{\sqrt{2}}\right) + 1 \left(\frac{1}{\sqrt{2}}\right) = \frac{1}{\sqrt{2}},
    \]\[ \langle \mathbf{w}_2, \mathbf{q}_2 \rangle = 0 \left(-\frac{1}{\sqrt{6}}\right)
    + 1 \left(\frac{2}{\sqrt{6}}\right) + 1 \left(\frac{1}{\sqrt{6}}\right) = \frac{3}{\sqrt{6}}.
    \]
- en: So
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 所以
- en: \[ \mathbf{w}_2 = \frac{1}{\sqrt{2}} \mathbf{q}_1 + \frac{3}{\sqrt{6}} \mathbf{q}_2.
    \]
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{w}_2 = \frac{1}{\sqrt{2}} \mathbf{q}_1 + \frac{3}{\sqrt{6}} \mathbf{q}_2.
    \]
- en: Check it! Try \(\mathbf{w}_3\). \(\lhd\)
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 检查它！尝试 \(\mathbf{w}_3\)。 \(\lhd\)
- en: '**Gram-Schmidt** We have shown that working with orthonormal bases is desirable.
    What if we do not have one? We could try to construct one by hand as we did in
    the previous example. But there are better ways. We review the [Gram-Schmidt algorithm](https://en.wikipedia.org/wiki/Gram%E2%80%93Schmidt_process)
    in an upcoming section, which will imply that every linear subspace has an orthonormal
    basis. That is, we will prove the following theorem.'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '**Gram-Schmidt** 我们已经证明，使用正交归一基是可取的。如果我们没有这样的基怎么办？我们可以尝试手动构造一个，就像我们在前面的例子中所做的那样。但是，还有更好的方法。我们将在下一节中回顾
    [Gram-Schmidt 算法](https://en.wikipedia.org/wiki/Gram%E2%80%93Schmidt_process)，这将意味着每个线性子空间都有一个正交归一基。也就是说，我们将证明以下定理。'
- en: '**THEOREM** **(Gram-Schmidt)** \(\idx{Gram-Schmidt theorem}\xdi\) Let \(\mathbf{a}_1,\ldots,\mathbf{a}_m\)
    be linearly independent. Then there exists an orthonormal basis \(\mathbf{q}_1,\ldots,\mathbf{q}_m\)
    of \(\mathrm{span}(\mathbf{a}_1,\ldots,\mathbf{a}_m)\). \(\sharp\)'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '**定理** **(Gram-Schmidt)** \(\idx{Gram-Schmidt 定理}\xdi\) 设 \(\mathbf{a}_1,\ldots,\mathbf{a}_m\)
    是线性无关的。那么存在一个 \(\mathrm{span}(\mathbf{a}_1,\ldots,\mathbf{a}_m)\) 的正交归一基 \(\mathbf{q}_1,\ldots,\mathbf{q}_m\)。
    \(\sharp\)'
- en: But, first, we will need to define the orthogonal projection, which will play
    a key role in our applications. This is done next.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 但是，首先，我们需要定义正交投影，这将在我们的应用中扮演关键角色。这将在下面进行。
- en: 2.3.2\. Orthogonal projection[#](#orthogonal-projection "Link to this heading")
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.3.2\. 正交投影[#](#orthogonal-projection "链接到这个标题")
- en: To solve the overdetermined case, i.e., when \(n > m\), we consider the following
    more general problem first. We have a linear subspace \(U \subseteq \mathbb{R}^n\)
    and a vector \(\mathbf{v} \notin U\). We want to find the vector \(\mathbf{p}\)
    in \(U\) that is closest to \(\mathbf{v}\) in Euclidean norm, that is, we want
    to solve
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 为了解决超定情况，即当 \(n > m\) 时，我们首先考虑以下更一般的问题。我们有一个线性子空间 \(U \subseteq \mathbb{R}^n\)
    和一个不在 \(U\) 中的向量 \(\mathbf{v}\)。我们想要找到 \(U\) 中与 \(\mathbf{v}\) 在欧几里得范数下最近的向量 \(\mathbf{p}\)，也就是说，我们想要解决
- en: \[ \min_{\mathbf{p} \in U} \|\mathbf{p} - \mathbf{v}\|. \]
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \min_{\mathbf{p} \in U} \|\mathbf{p} - \mathbf{v}\|. \]
- en: '**EXAMPLE:** Consider the two-dimensional case with a one-dimensional subspace,
    say \(U = \mathrm{span}(\mathbf{u}_1)\) with \(\|\mathbf{u}_1\|=1\). The geometrical
    intuition is in the following figure. The solution \(\mathbf{p} = \mathbf{v}^*\)
    has the property that the difference \(\mathbf{v} - \mathbf{v}^*\) makes a right
    angle with \(\mathbf{u}_1\), that is, it is orthogonal to it.'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例：** 考虑二维情况，有一个一维子空间，比如 \(U = \mathrm{span}(\mathbf{u}_1)\)，其中 \(\|\mathbf{u}_1\|=1\)。几何直观如下面的图中所示。解
    \(\mathbf{p} = \mathbf{v}^*\) 具有这样的性质，即 \(\mathbf{v} - \mathbf{v}^*\) 与 \(\mathbf{u}_1\)
    形成直角，也就是说，它与 \(\mathbf{u}_1\) 正交。'
- en: '![Orthogonal projection on a line (with help from ChatGPT and Claude; inspired
    by Source)](../Images/067d2c4143b5d805e9e1b2381a00c9db.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![正交投影到一条线（受益于ChatGPT和Claude；受来源启发）](../Images/067d2c4143b5d805e9e1b2381a00c9db.png)'
- en: Letting \(\mathbf{v}^* = \alpha^* \,\mathbf{u}_1\), the geometrical condition
    above translates into
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 令 \(\mathbf{v}^* = \alpha^* \,\mathbf{u}_1\)，上述几何条件转化为
- en: \[ 0 = \langle \mathbf{u}_1, \mathbf{v} - \mathbf{v}^* \rangle = \langle \mathbf{u}_1,
    \mathbf{v} - \alpha^* \,\mathbf{u}_1 \rangle = \langle \mathbf{u}_1, \mathbf{v}
    \rangle - \alpha^* \,\langle \mathbf{u}_1, \mathbf{u}_1 \rangle = \langle \mathbf{u}_1,
    \mathbf{v} \rangle - \alpha^* \]
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 0 = \langle \mathbf{u}_1, \mathbf{v} - \mathbf{v}^* \rangle = \langle \mathbf{u}_1,
    \mathbf{v} - \alpha^* \,\mathbf{u}_1 \rangle = \langle \mathbf{u}_1, \mathbf{v}
    \rangle - \alpha^* \,\langle \mathbf{u}_1, \mathbf{u}_1 \rangle = \langle \mathbf{u}_1,
    \mathbf{v} \rangle - \alpha^* \]
- en: so
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 所以
- en: \[ \mathbf{v}^* = \langle \mathbf{u}_1, \mathbf{v} \rangle \,\mathbf{u}_1. \]
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{v}^* = \langle \mathbf{u}_1, \mathbf{v} \rangle \,\mathbf{u}_1. \]
- en: By *Pythagoras’ Theorem*, we then have for any \(\alpha \in \mathbb{R}\)
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 通过 **毕达哥拉斯定理**，我们得到对于任何 \(\alpha \in \mathbb{R}\)
- en: \[\begin{align*} \|\mathbf{v} - \alpha \,\mathbf{u}_1\|^2 &= \|\mathbf{v}- \mathbf{v}^*
    + \mathbf{v}^* - \alpha \,\mathbf{u}_1\|^2\\ &= \|\mathbf{v}- \mathbf{v}^* + (\alpha^*
    - \alpha) \,\mathbf{u}_1\|^2\\ &= \|\mathbf{v}- \mathbf{v}^*\|^2 + \| (\alpha^*
    - \alpha) \,\mathbf{u}_1\|^2\\ &\geq \|\mathbf{v}- \mathbf{v}^*\|^2, \end{align*}\]
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \|\mathbf{v} - \alpha \,\mathbf{u}_1\|^2 &= \|\mathbf{v}- \mathbf{v}^*
    + \mathbf{v}^* - \alpha \,\mathbf{u}_1\|^2\\ &= \|\mathbf{v}- \mathbf{v}^* + (\alpha^*
    - \alpha) \,\mathbf{u}_1\|^2\\ &= \|\mathbf{v}- \mathbf{v}^*\|^2 + \| (\alpha^*
    - \alpha) \,\mathbf{u}_1\|^2\\ &\geq \|\mathbf{v}- \mathbf{v}^*\|^2, \end{align*}\]
- en: where we used that \(\mathbf{v} - \mathbf{v}^*\) is orthogonal to \(\mathbf{u}_1\)
    (and therefore \((\alpha^* - \alpha) \mathbf{u}_1\)) on the third line.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 其中我们在第三行使用了 \(\mathbf{v} - \mathbf{v}^*\) 与 \(\mathbf{u}_1\) 正交（因此与 \((\alpha^*
    - \alpha) \mathbf{u}_1\) 正交）。
- en: That confirms the optimality of \(\mathbf{v}^*\). The argument in this example
    carries through in higher dimension, as we show next. \(\lhd\)
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 这证实了 \(\mathbf{v}^*\) 的最优性。这个例子中的论证在更高维的情况下也适用，我们将在下面展示。 \(\lhd\)
- en: '**DEFINITION** **(Orthogonal Projection on an Orthonormal List)** \(\idx{orthogonal
    projection on an orthonormal list}\xdi\) Let \(\mathbf{q}_1,\ldots,\mathbf{q}_m\)
    be an orthonormal list. The orthogonal projection of \(\mathbf{v} \in \mathbb{R}^n\)
    on \(\{\mathbf{q}_i\}_{i=1}^m\) is defined as'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: '**定义** **（正交投影到正交列表）** \(\idx{正交投影到正交列表}\xdi\) 设 \(\mathbf{q}_1,\ldots,\mathbf{q}_m\)
    为一个正交列表。向量 \(\mathbf{v} \in \mathbb{R}^n\) 在 \(\{\mathbf{q}_i\}_{i=1}^m\) 上的正交投影定义为'
- en: \[ \mathrm{proj}_{\{\mathbf{q}_i\}_{i=1}^m} \mathbf{v} = \sum_{j=1}^m \langle
    \mathbf{v}, \mathbf{q}_j \rangle \,\mathbf{q}_j. \]
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathrm{proj}_{\{\mathbf{q}_i\}_{i=1}^m} \mathbf{v} = \sum_{j=1}^m \langle
    \mathbf{v}, \mathbf{q}_j \rangle \,\mathbf{q}_j. \]
- en: \(\natural\)
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: \(\natural\)
- en: '**THEOREM** **(Orthogonal Projection)** \(\idx{orthogonal projection theorem}\xdi\)
    Let \(U \subseteq V\) be a linear subspace and let \(\mathbf{v} \in \mathbb{R}^n\).
    Then:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: '**定理** **（正交投影）** \(\idx{正交投影定理}\xdi\) 设 \(U \subseteq V\) 为一个线性子空间，且 \(\mathbf{v}
    \in \mathbb{R}^n\)。那么：'
- en: a) There exists a unique solution \(\mathbf{p}^*\) to
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: a) 存在唯一解 \(\mathbf{p}^*\) 满足
- en: \[ \min_{\mathbf{p} \in U} \|\mathbf{p} - \mathbf{v}\|. \]
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \min_{\mathbf{p} \in U} \|\mathbf{p} - \mathbf{v}\|. \]
- en: We denote it by \(\mathbf{p}^* = \mathrm{proj}_U \mathbf{v}\) and refer to it
    as the orthogonal projection of \(\mathbf{v}\) onto \(U\).
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将其表示为 \(\mathbf{p}^* = \mathrm{proj}_U \mathbf{v}\) 并将其称为 \(\mathbf{v}\) 在
    \(U\) 上的正交投影。
- en: b) The solution \(\mathbf{p}^* \in U\) is characterized geometrically by
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: b) 解 \(\mathbf{p}^* \in U\) 在几何上由
- en: \[ (*) \qquad \left\langle \mathbf{v} - \mathbf{p}^*, \mathbf{u}\right\rangle
    =0, \quad \forall \mathbf{u} \in U. \]
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: \[ (*) \qquad \left\langle \mathbf{v} - \mathbf{p}^*, \mathbf{u}\right\rangle
    =0, \quad \forall \mathbf{u} \in U. \]
- en: c) For any orthonormal basis \(\mathbf{q}_1,\ldots,\mathbf{q}_m\) of \(U\),
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: c) 对于 \(U\) 的任意正交基 \(\mathbf{q}_1,\ldots,\mathbf{q}_m\),
- en: \[ \mathrm{proj}_U \mathbf{v} = \mathrm{proj}_{\{\mathbf{q}_i\}_{i=1}^m} \mathbf{v}.
    \]
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathrm{proj}_U \mathbf{v} = \mathrm{proj}_{\{\mathbf{q}_i\}_{i=1}^m} \mathbf{v}.
    \]
- en: \(\sharp\)
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: \(\sharp\)
- en: '*Proof:* Let \(\mathbf{p}^*\) be any vector in \(U\) satisfying \((*)\). We
    show first that it necessarily satisfies'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明:* 设 \(\mathbf{p}^*\) 是 \(U\) 中满足 \((*)\) 的任意向量。我们首先证明它必然满足'
- en: \[ (**) \qquad \|\mathbf{p}^* - \mathbf{v}\| \leq \|\mathbf{p} - \mathbf{v}\|,
    \quad \forall \mathbf{p} \in U. \]
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: \[ (**) \qquad \|\mathbf{p}^* - \mathbf{v}\| \leq \|\mathbf{p} - \mathbf{v}\|,
    \quad \forall \mathbf{p} \in U. \]
- en: Note that for any \(\mathbf{p} \in U\) the vector \(\mathbf{u} = \mathbf{p}
    - \mathbf{p}^*\) is also in \(U\). Hence by \((*)\) and *Pythagoras*,
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 注意到对于任意 \(\mathbf{p} \in U\)，向量 \(\mathbf{u} = \mathbf{p} - \mathbf{p}^*\) 也在
    \(U\) 中。因此，根据 \((*)\) 和 *毕达哥拉斯*，
- en: \[\begin{align*} \|\mathbf{p} - \mathbf{v}\|^2 &= \|\mathbf{p} - \mathbf{p}^*
    + \mathbf{p}^* - \mathbf{v}\|^2\\ &= \|\mathbf{p} - \mathbf{p}^*\|^2 + \|\mathbf{p}^*
    - \mathbf{v}\|^2\\ &\geq \|\mathbf{p}^* - \mathbf{v}\|^2. \end{align*}\]
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \|\mathbf{p} - \mathbf{v}\|^2 &= \|\mathbf{p} - \mathbf{p}^*
    + \mathbf{p}^* - \mathbf{v}\|^2\\ &= \|\mathbf{p} - \mathbf{p}^*\|^2 + \|\mathbf{p}^*
    - \mathbf{v}\|^2\\ &\geq \|\mathbf{p}^* - \mathbf{v}\|^2. \end{align*}\]
- en: Furthermore, equality holds only if \(\|\mathbf{p} - \mathbf{p}^*\|^2 = 0\)
    which holds only if \(\mathbf{p} = \mathbf{p}^*\) by the point-separating property
    of the Euclidean norm. Hence, if such a vector \(\mathbf{p}^*\) exists, it is
    unique.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，等号成立仅当 \(\|\mathbf{p} - \mathbf{p}^*\|^2 = 0\)，这仅在 \(\mathbf{p} = \mathbf{p}^*\)
    时成立，这是由欧几里得范数的点分离性质决定的。因此，如果这样的向量 \(\mathbf{p}^*\) 存在，它是唯一的。
- en: 'Next, we show that any minimizer must satisfy \((*)\). Let \(\mathbf{p}^*\)
    be a minimizer and suppose, for contradiction, that \((*)\) does not hold. Then
    there exists \(\mathbf{u} \in U\) with \(\langle \mathbf{v} - \mathbf{p}^*, \mathbf{u}
    \rangle = c \neq 0\). Consider \(\mathbf{p}_t = \mathbf{p}^* + t\mathbf{u}\) for
    small \(t\). Then:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们证明任何最小化值必须满足 \((*)\)。设 \(\mathbf{p}^*\) 是一个最小化值，假设，为了矛盾，\((*)\) 不成立。那么存在
    \(\mathbf{u} \in U\)，使得 \(\langle \mathbf{v} - \mathbf{p}^*, \mathbf{u} \rangle
    = c \neq 0\)。考虑 \(\mathbf{p}_t = \mathbf{p}^* + t\mathbf{u}\) 对于小的 \(t\)。那么：
- en: \[\begin{align*} \|\mathbf{p}_t - \mathbf{v}\|^2 &= \|(\mathbf{p}^* - \mathbf{v})
    + t\mathbf{u}\|^2\\ &= \|\mathbf{p}^* - \mathbf{v}\|^2 + 2t\langle \mathbf{v}
    - \mathbf{p}^*, \mathbf{u} \rangle + t^2\|\mathbf{u}\|^2\\ &= \|\mathbf{p}^* -
    \mathbf{v}\|^2 + 2tc + t^2\|\mathbf{u}\|^2. \end{align*}\]
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \|\mathbf{p}_t - \mathbf{v}\|^2 &= \|(\mathbf{p}^* - \mathbf{v})
    + t\mathbf{u}\|^2\\ &= \|\mathbf{p}^* - \mathbf{v}\|^2 + 2t\langle \mathbf{v}
    - \mathbf{p}^*, \mathbf{u} \rangle + t^2\|\mathbf{u}\|^2\\ &= \|\mathbf{p}^* -
    \mathbf{v}\|^2 + 2tc + t^2\|\mathbf{u}\|^2. \end{align*}\]
- en: For small \(t\) with appropriate sign, this is smaller than \(\|\mathbf{p}^*
    - \mathbf{v}\|^2\), contradicting minimality.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 对于小的 \(t\) 和适当的符号，这将小于 \(\|\mathbf{p}^* - \mathbf{v}\|^2\)，与最小性矛盾。
- en: It remains to show that there is at least one vector in \(U\) satisfying \((*)\).
    By the *Gram-Schmidt Theorem*, the linear subspace \(U\) has an orthonormal basis
    \(\mathbf{q}_1,\ldots,\mathbf{q}_m\). By definition, \(\mathrm{proj}_{\{\mathbf{q}_i\}_{i=1}^m}
    \mathbf{v} \in \mathrm{span}(\{\mathbf{q}_i\}_{i=1}^m) = U\). We show that \(\mathrm{proj}_{\{\mathbf{q}_i\}_{i=1}^m}
    \mathbf{v}\) satisfies \((*)\). We can write any \(\mathbf{u} \in U\) as \(\sum_{i=1}^m
    \alpha_i \mathbf{q}_i\) with \(\alpha_i = \langle \mathbf{u}, \mathbf{q}_i \rangle\).
    So, using this representation, we get
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 剩下的工作是要证明 \(U\) 中至少存在一个向量满足 \((*)\)。根据 *Gram-Schmidt 定理*，线性子空间 \(U\) 有一个正交基
    \(\mathbf{q}_1,\ldots,\mathbf{q}_m\)。根据定义，\(\mathrm{proj}_{\{\mathbf{q}_i\}_{i=1}^m}
    \mathbf{v} \in \mathrm{span}(\{\mathbf{q}_i\}_{i=1}^m) = U\)。我们证明 \(\mathrm{proj}_{\{\mathbf{q}_i\}_{i=1}^m}
    \mathbf{v}\) 满足 \((*)\)。我们可以将 \(U\) 中的任意向量 \(\mathbf{u}\) 写成 \(\sum_{i=1}^m \alpha_i
    \mathbf{q}_i\)，其中 \(\alpha_i = \langle \mathbf{u}, \mathbf{q}_i \rangle\)。因此，使用这种表示法，我们得到
- en: \[\begin{align*} \left\langle \mathbf{v} - \sum_{j=1}^m \langle \mathbf{v},
    \mathbf{q}_j \rangle \,\mathbf{q}_j, \sum_{i=1}^m \alpha_i \mathbf{q}_i \right\rangle
    &= \sum_{i=1}^m \langle \mathbf{v}, \mathbf{q}_i \rangle \,\alpha_i - \sum_{j=1}^m
    \sum_{i=1}^m \alpha_i \langle \mathbf{v}, \mathbf{q}_j \rangle \langle \mathbf{q}_j,
    \mathbf{q}_i \rangle\\ &= \sum_{i=1}^m \langle \mathbf{v}, \mathbf{q}_i \rangle
    \,\alpha_i - \sum_{j=1}^m \alpha_j \langle \mathbf{v}, \mathbf{q}_j \rangle\\
    &= 0, \end{align*}\]
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \left\langle \mathbf{v} - \sum_{j=1}^m \langle \mathbf{v},
    \mathbf{q}_j \rangle \,\mathbf{q}_j, \sum_{i=1}^m \alpha_i \mathbf{q}_i \right\rangle
    &= \sum_{i=1}^m \langle \mathbf{v}, \mathbf{q}_i \rangle \,\alpha_i - \sum_{j=1}^m
    \sum_{i=1}^m \alpha_i \langle \mathbf{v}, \mathbf{q}_j \rangle \langle \mathbf{q}_j,
    \mathbf{q}_i \rangle\\ &= \sum_{i=1}^m \langle \mathbf{v}, \mathbf{q}_i \rangle
    \,\alpha_i - \sum_{j=1}^m \alpha_j \langle \mathbf{v}, \mathbf{q}_j \rangle\\
    &= 0, \end{align*}\]
- en: where we used the orthonormality of the \(\mathbf{q}_j\)’s on the second line.
    \(\square\)
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 其中我们在第二行使用了 \(\mathbf{q}_j\) 的正交性。\(\square\)
- en: '**EXAMPLE:** **(continued)** Consider again the linear subspace \(W = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3)\),
    where \(\mathbf{w}_1 = (1,0,1)\), \(\mathbf{w}_2 = (0,1,1)\), and \(\mathbf{w}_3
    = (1,-1,0)\). We have shown that'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例：** **（继续）** 再次考虑线性子空间 \(W = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3)\)，其中
    \(\mathbf{w}_1 = (1,0,1)\)，\(\mathbf{w}_2 = (0,1,1)\)，和 \(\mathbf{w}_3 = (1,-1,0)\)。我们已经证明'
- en: \[\begin{split} \mathbf{q}_1 = \frac{1}{\sqrt{2}} \begin{pmatrix} 1\\ 0\\ 1
    \end{pmatrix}, \quad \mathbf{q}_2 = \frac{1}{\sqrt{6}} \begin{pmatrix} -1\\ 2\\
    1 \end{pmatrix}, \end{split}\]
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{q}_1 = \frac{1}{\sqrt{2}} \begin{pmatrix} 1\\ 0\\ 1
    \end{pmatrix}, \quad \mathbf{q}_2 = \frac{1}{\sqrt{6}} \begin{pmatrix} -1\\ 2\\
    1 \end{pmatrix}, \end{split}\]
- en: is an orthonormal basis. Let \(\mathbf{w}_4 = (0,0,2)\). It is immediate that
    \(\mathbf{w}_4 \notin \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2)\) since vectors
    in that span are of the form \((x,y,x+y)\) for some \(x,y \in \mathbb{R}\).
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 是一个正交基。设 \(\mathbf{w}_4 = (0,0,2)\)。显然，\(\mathbf{w}_4 \notin \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2)\)，因为该生成空间中的向量形式为
    \((x,y,x+y)\)，其中 \(x,y \in \mathbb{R}\)。
- en: We can however compute the orthogonal projection \(\mathbf{w}_4\) onto \(W\).
    The inner products are
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，我们可以计算 \(\mathbf{w}_4\) 在 \(W\) 上的正交投影。内积为
- en: \[ \langle \mathbf{w}_4, \mathbf{q}_1 \rangle = 0 \left(\frac{1}{\sqrt{2}}\right)
    + 0 \left(\frac{0}{\sqrt{2}}\right) + 2 \left(\frac{1}{\sqrt{2}}\right) = \frac{2}{\sqrt{2}},
    \]\[ \langle \mathbf{w}_4, \mathbf{q}_2 \rangle = 0 \left(-\frac{1}{\sqrt{6}}\right)
    + 0 \left(\frac{2}{\sqrt{6}}\right) + 2 \left(\frac{1}{\sqrt{6}}\right) = \frac{2}{\sqrt{6}}.
    \]
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \langle \mathbf{w}_4, \mathbf{q}_1 \rangle = 0 \left(\frac{1}{\sqrt{2}}\right)
    + 0 \left(\frac{0}{\sqrt{2}}\right) + 2 \left(\frac{1}{\sqrt{2}}\right) = \frac{2}{\sqrt{2}},
    \]\[ \langle \mathbf{w}_4, \mathbf{q}_2 \rangle = 0 \left(-\frac{1}{\sqrt{6}}\right)
    + 0 \left(\frac{2}{\sqrt{6}}\right) + 2 \left(\frac{1}{\sqrt{6}}\right) = \frac{2}{\sqrt{6}}.
    \]
- en: So
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 因此
- en: \[\begin{split} \mathrm{proj}_W \mathbf{w}_4 = \frac{2}{\sqrt{2}} \mathbf{q}_1
    + \frac{2}{\sqrt{6}} \mathbf{q}_2 = \begin{pmatrix} 2/3\\ 2/3\\ 4/3 \end{pmatrix}.
    \end{split}\]
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathrm{proj}_W \mathbf{w}_4 = \frac{2}{\sqrt{2}} \mathbf{q}_1
    + \frac{2}{\sqrt{6}} \mathbf{q}_2 = \begin{pmatrix} 2/3\\ 2/3\\ 4/3 \end{pmatrix}.
    \end{split}\]
- en: As a sanity check, note that \(\mathbf{w}_4 \in W\) since its third entry is
    equal to the sum of its first two entries. \(\lhd\)
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 作为合理性检查，请注意，\(\mathbf{w}_4 \in W\)，因为它的第三个分量等于前两个分量的和。\(\lhd\)
- en: The map \(\mathrm{proj}_U\) is linear, that is, \(\mathrm{proj}_U (\alpha \,\mathbf{x}
    + \mathbf{y}) = \alpha \,\mathrm{proj}_U \mathbf{x} + \mathrm{proj}_U\mathbf{y}\)
    for all \(\alpha \in \mathbb{R}\) and \(\mathbf{x}, \mathbf{y} \in \mathbb{R}^n\).
    Indeed,
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 映射 \(\mathrm{proj}_U\) 是线性的，即对于所有 \(\alpha \in \mathbb{R}\) 和 \(\mathbf{x},
    \mathbf{y} \in \mathbb{R}^n\)，有 \(\mathrm{proj}_U (\alpha \,\mathbf{x} + \mathbf{y})
    = \alpha \,\mathrm{proj}_U \mathbf{x} + \mathrm{proj}_U\mathbf{y}\)。实际上，
- en: \[\begin{align*} \mathrm{proj}_U(\alpha \,\mathbf{x} + \mathbf{y}) &= \sum_{j=1}^m
    \langle \alpha \,\mathbf{x} + \mathbf{y}, \mathbf{q}_j \rangle \,\mathbf{q}_j\\
    &= \sum_{j=1}^m \left\{\alpha \, \langle \mathbf{x}, \mathbf{q}_j \rangle + \langle
    \mathbf{y}, \mathbf{q}_j \rangle\right\} \mathbf{q}_j\\ &= \alpha \,\mathrm{proj}_U
    \mathbf{x} + \mathrm{proj}_U \mathbf{y}. \end{align*}\]
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \mathrm{proj}_U(\alpha \,\mathbf{x} + \mathbf{y}) &= \sum_{j=1}^m
    \langle \alpha \,\mathbf{x} + \mathbf{y}, \mathbf{q}_j \rangle \,\mathbf{q}_j\\
    &= \sum_{j=1}^m \left\{\alpha \, \langle \mathbf{x}, \mathbf{q}_j \rangle + \langle
    \mathbf{y}, \mathbf{q}_j \rangle\right\} \mathbf{q}_j\\ &= \alpha \,\mathrm{proj}_U
    \mathbf{x} + \mathrm{proj}_U \mathbf{y}. \end{align*}\]
- en: Any linear map from \(\mathbb{R}^n\) to \(\mathbb{R}^n\) can be encoded as an
    \(n \times n\) matrix \(P\).
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 任何从 \(\mathbb{R}^n\) 到 \(\mathbb{R}^n\) 的线性映射都可以编码为一个 \(n \times n\) 的矩阵 \(P\)。
- en: Let
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 设
- en: \[\begin{split} Q = \begin{pmatrix} | & & | \\ \mathbf{q}_1 & \ldots & \mathbf{q}_m
    \\ | & & | \end{pmatrix} \end{split}\]
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} Q = \begin{pmatrix} | & & | \\ \mathbf{q}_1 & \ldots & \mathbf{q}_m
    \\ | & & | \end{pmatrix} \end{split}\]
- en: and note that computing
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 并注意计算
- en: \[\begin{split} Q^T \mathbf{v} = \begin{pmatrix} \langle \mathbf{v}, \mathbf{q}_1
    \rangle \\ \cdots \\ \langle \mathbf{v}, \mathbf{q}_m \rangle \end{pmatrix} \end{split}\]
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} Q^T \mathbf{v} = \begin{pmatrix} \langle \mathbf{v}, \mathbf{q}_1
    \rangle \\ \cdots \\ \langle \mathbf{v}, \mathbf{q}_m \rangle \end{pmatrix} \end{split}\]
- en: lists the coefficients in the expansion of \(\mathrm{proj}_U \mathbf{v}\) over
    the basis \(\mathbf{q}_1,\ldots,\mathbf{q}_m\).
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 列出了 \(\mathrm{proj}_U \mathbf{v}\) 在基 \(\mathbf{q}_1,\ldots,\mathbf{q}_m\) 上的展开中的系数。
- en: Hence we see that
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们看到
- en: \[ P = Q Q^T. \]
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: \[ P = Q Q^T. \]
- en: Indeed, for any vector \(\mathbf{v}\),
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 事实上，对于任何向量 \(\mathbf{v}\),
- en: \[ P \mathbf{v} = Q Q^T \mathbf{v} = Q [Q^T \mathbf{v}]. \]
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: \[ P \mathbf{v} = Q Q^T \mathbf{v} = Q [Q^T \mathbf{v}]. \]
- en: So the output is a linear combination of the columns of \(Q\) (i.e., the \(\mathbf{q}_i\)’s)
    where the coefficients are the entries of the vector in square brackets \(Q^T
    \mathbf{v}\).
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，输出是 \(Q\) 的列（即 \(\mathbf{q}_i\)）的线性组合，其中系数是方括号中向量的元素 \(Q^T \mathbf{v}\)。
- en: '**EXAMPLE:** **(continued)** Consider again the linear subspace \(W = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3)\),
    where \(\mathbf{w}_1 = (1,0,1)\), \(\mathbf{w}_2 = (0,1,1)\), and \(\mathbf{w}_3
    = (1,-1,0)\), with orthonormal basis'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例：** **（续）** 再次考虑线性子空间 \(W = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3)\)，其中
    \(\mathbf{w}_1 = (1,0,1)\)，\(\mathbf{w}_2 = (0,1,1)\)，和 \(\mathbf{w}_3 = (1,-1,0)\)，具有正交归一基'
- en: \[\begin{split} \mathbf{q}_1 = \frac{1}{\sqrt{2}} \begin{pmatrix} 1\\ 0\\ 1
    \end{pmatrix}, \quad \mathbf{q}_2 = \frac{1}{\sqrt{6}} \begin{pmatrix} -1\\ 2\\
    1 \end{pmatrix}. \end{split}\]
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{q}_1 = \frac{1}{\sqrt{2}} \begin{pmatrix} 1\\ 0\\ 1
    \end{pmatrix}, \quad \mathbf{q}_2 = \frac{1}{\sqrt{6}} \begin{pmatrix} -1\\ 2\\
    1 \end{pmatrix}. \end{split}\]
- en: Then orthogonal projection onto \(W\) can be written in matrix form as follows.
    The matrix \(Q\) is
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，\(W\) 上的正交投影可以写成以下矩阵形式。矩阵 \(Q\) 是
- en: \[\begin{split} Q = \begin{pmatrix} 1/\sqrt{2} & -1/\sqrt{6}\\ 0 & 2/\sqrt{6}\\
    1/\sqrt{2} & 1/\sqrt{6} \end{pmatrix}. \end{split}\]
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} Q = \begin{pmatrix} 1/\sqrt{2} & -1/\sqrt{6}\\ 0 & 2/\sqrt{6}\\
    1/\sqrt{2} & 1/\sqrt{6} \end{pmatrix}. \end{split}\]
- en: Then
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 然后
- en: \[\begin{align*} Q Q^T &= \begin{pmatrix} 1/\sqrt{2} & -1/\sqrt{6}\\ 0 & 2/\sqrt{6}\\
    1/\sqrt{2} & 1/\sqrt{6} \end{pmatrix} \begin{pmatrix} 1/\sqrt{2} & 0 & 1/\sqrt{2}\\
    -1/\sqrt{6} & 2/\sqrt{6} & 1/\sqrt{6} \end{pmatrix}\\ &= \begin{pmatrix} 2/3 &
    -1/3 & 1/3\\ -1/3 & 2/3 & 1/3\\ 1/3 & 1/3 & 2/3 \end{pmatrix}. \end{align*}\]
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} Q Q^T &= \begin{pmatrix} 1/\sqrt{2} & -1/\sqrt{6}\\ 0 & 2/\sqrt{6}\\
    1/\sqrt{2} & 1/\sqrt{6} \end{pmatrix} \begin{pmatrix} 1/\sqrt{2} & 0 & 1/\sqrt{2}\\
    -1/\sqrt{6} & 2/\sqrt{6} & 1/\sqrt{6} \end{pmatrix}\\ &= \begin{pmatrix} 2/3 &
    -1/3 & 1/3\\ -1/3 & 2/3 & 1/3\\ 1/3 & 1/3 & 2/3 \end{pmatrix}. \end{align*}\]
- en: So the projection of \(\mathbf{w}_4 = (0,0,2)\) is
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，向量 \(\mathbf{w}_4 = (0,0,2)\) 的投影是
- en: \[\begin{split} \begin{pmatrix} 2/3 & -1/3 & 1/3\\ -1/3 & 2/3 & 1/3\\ 1/3 &
    1/3 & 2/3 \end{pmatrix} \begin{pmatrix} 0\\ 0\\ 2 \end{pmatrix} = \begin{pmatrix}
    2/3\\ 2/3\\ 4/3 \end{pmatrix}, \end{split}\]
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} 2/3 & -1/3 & 1/3\\ -1/3 & 2/3 & 1/3\\ 1/3 &
    1/3 & 2/3 \end{pmatrix} \begin{pmatrix} 0\\ 0\\ 2 \end{pmatrix} = \begin{pmatrix}
    2/3\\ 2/3\\ 4/3 \end{pmatrix}, \end{split}\]
- en: as previously computed. \(\lhd\)
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述。 \(\lhd\)
- en: The matrix \(P= Q Q^T\) is not to be confused with
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 矩阵 \(P= Q Q^T\) 不应与
- en: \[\begin{split} Q^T Q = \begin{pmatrix} \langle \mathbf{q}_1, \mathbf{q}_1 \rangle
    & \cdots & \langle \mathbf{q}_1, \mathbf{q}_m \rangle \\ \langle \mathbf{q}_2,
    \mathbf{q}_1 \rangle & \cdots & \langle \mathbf{q}_2, \mathbf{q}_m \rangle \\
    \vdots & \ddots & \vdots \\ \langle \mathbf{q}_m, \mathbf{q}_1 \rangle & \cdots
    & \langle \mathbf{q}_m, \mathbf{q}_m \rangle \end{pmatrix} = I_{m \times m} \end{split}\]
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} Q^T Q = \begin{pmatrix} \langle \mathbf{q}_1, \mathbf{q}_1 \rangle
    & \cdots & \langle \mathbf{q}_1, \mathbf{q}_m \rangle \\ \langle \mathbf{q}_2,
    \mathbf{q}_1 \rangle & \cdots & \langle \mathbf{q}_2, \mathbf{q}_m \rangle \\
    \vdots & \ddots & \vdots \\ \langle \mathbf{q}_m, \mathbf{q}_1 \rangle & \cdots
    & \langle \mathbf{q}_m, \mathbf{q}_m \rangle \end{pmatrix} = I_{m \times m} \end{split}\]
- en: where \(I_{m \times m}\) denotes the \(m \times m\) identity matrix. This follows
    from the fact that the \(\mathbf{q}_i\)’s are orthonormal.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(I_{m \times m}\) 表示 \(m \times m\) 的单位矩阵。这源于 \(\mathbf{q}_i\) 是正交归一的事实。
- en: '**EXAMPLE:** Let \(\mathbf{q}_1,\ldots,\mathbf{q}_n\) be an orthonormal basis
    of \(\mathbb{R}^n\) and form the matrix'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例：** 设 \(\mathbf{q}_1,\ldots,\mathbf{q}_n\) 是 \(\mathbb{R}^n\) 的一个正交归一基，并形成矩阵'
- en: \[\begin{split} Q = \begin{pmatrix} | & & | \\ \mathbf{q}_1 & \ldots & \mathbf{q}_n
    \\ | & & | \end{pmatrix}. \end{split}\]
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} Q = \begin{pmatrix} | & & | \\ \mathbf{q}_1 & \ldots & \mathbf{q}_n
    \\ | & & | \end{pmatrix}. \end{split}\]
- en: We show that \(Q^{-1} = Q^T\).
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 我们证明了 \(Q^{-1} = Q^T\).
- en: We just pointed out that
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 我们刚才指出的是
- en: \[\begin{split} Q^T Q = \begin{pmatrix} \langle \mathbf{q}_1, \mathbf{q}_1 \rangle
    & \cdots & \langle \mathbf{q}_1, \mathbf{q}_n \rangle \\ \langle \mathbf{q}_2,
    \mathbf{q}_1 \rangle & \cdots & \langle \mathbf{q}_2, \mathbf{q}_n \rangle \\
    \vdots & \ddots & \vdots \\ \langle \mathbf{q}_n, \mathbf{q}_1 \rangle & \cdots
    & \langle \mathbf{q}_n, \mathbf{q}_n \rangle \end{pmatrix} = I_{n \times n} \end{split}\]
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} Q^T Q = \begin{pmatrix} \langle \mathbf{q}_1, \mathbf{q}_1 \rangle
    & \cdots & \langle \mathbf{q}_1, \mathbf{q}_n \rangle \\ \langle \mathbf{q}_2,
    \mathbf{q}_1 \rangle & \cdots & \langle \mathbf{q}_2, \mathbf{q}_n \rangle \\
    \vdots & \ddots & \vdots \\ \langle \mathbf{q}_n, \mathbf{q}_1 \rangle & \cdots
    & \langle \mathbf{q}_n, \mathbf{q}_n \rangle \end{pmatrix} = I_{n \times n} \end{split}\]
- en: where \(I_{n \times n}\) denotes the \(n \times n\) identity matrix.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(I_{n \times n}\) 表示 \(n \times n\) 的单位矩阵。
- en: In the other direction, we claim that \(Q Q^T = I_{n \times n}\) as well. Indeed
    the matrix \(Q Q^T\) is the orthogonal projection on the span of the \(\mathbf{q}_i\)’s,
    that is, \(\mathbb{R}^n\). By the *Orthogonal Projection Theorem*, the orthogonal
    projection \(Q Q^T \mathbf{v}\) finds the closest vector to \(\mathbf{v}\) in
    the span of the \(\mathbf{q}_i\)’s. But that span contains all vectors, including
    \(\mathbf{v}\), so we must have \(Q Q^T \mathbf{v} = \mathbf{v}\). Since this
    holds for all \(\mathbf{v} \in \mathbb{R}^n\), the matrix \(Q Q^T\) is the identity
    map and we have proved the claim. \(\lhd\)
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 在另一个方向上，我们声称 \(Q Q^T = I_{n \times n}\) 也成立。实际上，矩阵 \(Q Q^T\) 是 \(\mathbf{q}_i\)
    的张成的正交投影，即 \(\mathbb{R}^n\)。根据 *正交投影定理*，正交投影 \(Q Q^T \mathbf{v}\) 找到 \(\mathbf{v}\)
    在 \(\mathbf{q}_i\) 的张成中的最近向量。但是这个张成包含所有向量，包括 \(\mathbf{v}\)，因此我们必须有 \(Q Q^T \mathbf{v}
    = \mathbf{v}\)。由于这对所有 \(\mathbf{v} \in \mathbb{R}^n\) 都成立，矩阵 \(Q Q^T\) 是恒等映射，我们证明了这一说法。
    \(\lhd\)
- en: Matrices that satisfy
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 满足以下条件的矩阵
- en: \[ Q^T Q = Q Q^T = I_{n \times n} \]
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: \[ Q^T Q = Q Q^T = I_{n \times n} \]
- en: are called orthogonal matrices.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 被称为正交矩阵。
- en: '**DEFINITION** **(Orthogonal Matrix)** \(\idx{orthogonal matrix}\xdi\) A square
    matrix \(Q \in \mathbb{R}^{m\times m}\) is orthogonal if \(Q^T Q = Q Q^T = I_{m
    \times m}\). \(\natural\)'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: '**定义** **(正交矩阵)** \(\idx{orthogonal matrix}\xdi\) 如果一个方阵 \(Q \in \mathbb{R}^{m\times
    m}\) 满足 \(Q^T Q = Q Q^T = I_{m \times m}\)，则称其为正交矩阵。 \(\natural\)'
- en: '**KNOWLEDGE CHECK:** Let \(\mathcal{Z}\) be a linear subspace of \(\mathbb{R}^n\)
    and let \(\mathbf{v} \in \mathbb{R}^n\). Show that'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '**知识检查:** 设 \(\mathcal{Z}\) 为 \(\mathbb{R}^n\) 的一个线性子空间，设 \(\mathbf{v} \in
    \mathbb{R}^n\)。证明'
- en: \[ \|\mathrm{proj}_{\mathcal{Z}}\mathbf{v}\|_2 \leq \|\mathbf{v}\|_2. \]
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \|\mathrm{proj}_{\mathcal{Z}}\mathbf{v}\|_2 \leq \|\mathbf{v}\|_2. \]
- en: '[*Hint:* Use the geometric characterization.] \(\checkmark\)'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '[*提示:* 使用几何特征。] \(\checkmark\)'
- en: 2.3.3\. Orthogonal complement[#](#orthogonal-complement "Link to this heading")
  id: totrans-161
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.3.3\. 正交补[#](#orthogonal-complement "链接到这个标题")
- en: Before returning to overdetermined systems, we take a little detour to derive
    a consequence of the orthogonal projection that will be useful later. The *Orthogonal
    Projection Theorem* implies that any \(\mathbf{v} \in \mathbb{R}^n\) can be decomposed
    into its orthogonal projection onto \(U\) and a vector orthogonal to it.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 在返回到超定系统之前，我们稍微偏离一下，推导出正交投影的一个后果，这个后果在以后会很有用。*正交投影定理*表明，任何 \(\mathbf{v} \in
    \mathbb{R}^n\) 都可以分解为其在 \(U\) 上的正交投影和一个与它正交的向量。
- en: '**DEFINITION** **(Orthogonal Complement)** \(\idx{orthogonal complement}\xdi\)
    Let \(U \subseteq \mathbb{R}^n\) be a linear subspace. The orthogonal complement
    of \(U\), denoted \(U^\perp\), is defined as'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '**定义** **(正交补)** \(\idx{orthogonal complement}\xdi\) 设 \(U \subseteq \mathbb{R}^n\)
    为一个线性子空间。\(U\) 的正交补，记为 \(U^\perp\)，定义为'
- en: \[ U^\perp = \{\mathbf{w} \in \mathbb{R}^n\,:\, \langle \mathbf{w}, \mathbf{u}\rangle
    = 0, \forall \mathbf{u} \in U\}. \]
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: \[ U^\perp = \{\mathbf{w} \in \mathbb{R}^n\,:\, \langle \mathbf{w}, \mathbf{u}\rangle
    = 0, \forall \mathbf{u} \in U\}. \]
- en: \(\natural\)
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: \(\natural\)
- en: '**EXAMPLE:** Continuing a previous example, we compute the orthogonal complement
    of the linear subspace \(W = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3)\),
    where \(\mathbf{w}_1 = (1,0,1)\), \(\mathbf{w}_2 = (0,1,1)\), and \(\mathbf{w}_3
    = (1,-1,0)\). One way to proceed is to find all vectors that are orthogonal to
    the orthonormal basis'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例:** 继续上一个例子，我们计算线性子空间 \(W = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3)\)
    的正交补，其中 \(\mathbf{w}_1 = (1,0,1)\)，\(\mathbf{w}_2 = (0,1,1)\)，和 \(\mathbf{w}_3
    = (1,-1,0)\)。一种方法是找到所有与正交基'
- en: \[\begin{split} \mathbf{q}_1 = \frac{1}{\sqrt{2}} \begin{pmatrix} 1\\ 0\\ 1
    \end{pmatrix}, \quad \mathbf{q}_2 = \frac{1}{\sqrt{6}} \begin{pmatrix} -1\\ 2\\
    1 \end{pmatrix}. \end{split}\]
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{q}_1 = \frac{1}{\sqrt{2}} \begin{pmatrix} 1\\ 0\\ 1
    \end{pmatrix}, \quad \mathbf{q}_2 = \frac{1}{\sqrt{6}} \begin{pmatrix} -1\\ 2\\
    1 \end{pmatrix}. \end{split}\]
- en: We require
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要
- en: \[ 0 = \langle \mathbf{u}, \mathbf{q}_1 \rangle = u_1 \left(\frac{1}{\sqrt{2}}\right)
    + u_2 \left(\frac{0}{\sqrt{2}}\right) + u_3 \left(\frac{1}{\sqrt{2}}\right) =
    \frac{u_1 + u_3}{\sqrt{2}}, \]\[ 0= \langle \mathbf{u}, \mathbf{q}_2 \rangle =
    u_1 \left(-\frac{1}{\sqrt{6}}\right) + u_2 \left(\frac{2}{\sqrt{6}}\right) + u_3
    \left(\frac{1}{\sqrt{6}}\right) = \frac{-u_1 + 2 u_2 + u_3}{\sqrt{6}}. \]
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 0 = \langle \mathbf{u}, \mathbf{q}_1 \rangle = u_1 \left(\frac{1}{\sqrt{2}}\right)
    + u_2 \left(\frac{0}{\sqrt{2}}\right) + u_3 \left(\frac{1}{\sqrt{2}}\right) =
    \frac{u_1 + u_3}{\sqrt{2}}, \]\[ 0= \langle \mathbf{u}, \mathbf{q}_2 \rangle =
    u_1 \left(-\frac{1}{\sqrt{6}}\right) + u_2 \left(\frac{2}{\sqrt{6}}\right) + u_3
    \left(\frac{1}{\sqrt{6}}\right) = \frac{-u_1 + 2 u_2 + u_3}{\sqrt{6}}. \]
- en: The first equation implies \(u_3 = -u_1\), which after replacing into the second
    equation and rearranging gives \(u_2 = u_1\).
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个方程意味着 \(u_3 = -u_1\)，将其代入第二个方程并重新排列后得到 \(u_2 = u_1\)。
- en: So all vectors of the form \((u_1,u_1,-u_1)\) for some \(u_1 \in \mathbb{R}\)
    are orthogonal to all of \(W\). This is a one-dimensional linear subspace. We
    can choose an orthonormal basis by finding a solution to
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，所有形式为 \((u_1,u_1,-u_1)\) 的向量，其中 \(u_1 \in \mathbb{R}\)，都与 \(W\) 正交。这是一个一维线性子空间。我们可以通过找到一个解来选择一个正交基
- en: \[ 1 = (u_1)^2 + (u_1)^2 + (-u_1)^2 = 3 u_1^2, \]
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 1 = (u_1)^2 + (u_1)^2 + (-u_1)^2 = 3 u_1^2, \]
- en: Take \(u_1 = 1/\sqrt{3}\), that is, let
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 取 \(u_1 = 1/\sqrt{3}\)，即
- en: \[\begin{split} \mathbf{q}_3 = \frac{1}{\sqrt{3}} \begin{pmatrix} 1\\ 1\\ -1
    \end{pmatrix}. \end{split}\]
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{q}_3 = \frac{1}{\sqrt{3}} \begin{pmatrix} 1\\ 1\\ -1
    \end{pmatrix}. \end{split}\]
- en: Then we have
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们有
- en: \[ W^\perp = \mathrm{span}(\mathbf{q}_3). \]
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: \[ W^\perp = \mathrm{span}(\mathbf{q}_3). \]
- en: \(\lhd\)
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: \(\lhd\)
- en: '**LEMMA** **(Orthogonal Decomposition)** \(\idx{orthogonal decomposition lemma}\xdi\)
    Let \(U \subseteq \mathbb{R}^n\) be a linear subspace and let \(\mathbf{v} \in
    \mathbb{R}^n\). Then \(\mathbf{v}\) can be decomposed as \(\mathrm{proj}_U \mathbf{v}
    + (\mathbf{v} - \mathrm{proj}_U\mathbf{v})\) where \(\mathrm{proj}_U \mathbf{v}
    \in U\) and \((\mathbf{v} - \mathrm{proj}_U \mathbf{v}) \in U^\perp\). Moreover,
    this decomposition is unique in the following sense: if \(\mathbf{v} = \mathbf{u}
    + \mathbf{u}^\perp\) with \(\mathbf{u} \in U\) and \(\mathbf{u}^\perp \in U^\perp\),
    then \(\mathbf{u} = \mathrm{proj}_U \mathbf{v}\) and \(\mathbf{u}^\perp = \mathbf{v}
    - \mathrm{proj}_U \mathbf{v}\). \(\flat\)'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: '**引理** **(正交分解)** \(\idx{orthogonal decomposition lemma}\xdi\) 设 \(U \subseteq
    \mathbb{R}^n\) 是一个线性子空间，且 \(\mathbf{v} \in \mathbb{R}^n\)。那么 \(\mathbf{v}\) 可以分解为
    \(\mathrm{proj}_U \mathbf{v} + (\mathbf{v} - \mathrm{proj}_U\mathbf{v})\)，其中 \(\mathrm{proj}_U
    \mathbf{v} \in U\) 且 \((\mathbf{v} - \mathrm{proj}_U \mathbf{v}) \in U^\perp\)。此外，这种分解在以下意义上是唯一的：如果
    \(\mathbf{v} = \mathbf{u} + \mathbf{u}^\perp\)，其中 \(\mathbf{u} \in U\) 且 \(\mathbf{u}^\perp
    \in U^\perp\)，则 \(\mathbf{u} = \mathrm{proj}_U \mathbf{v}\) 且 \(\mathbf{u}^\perp
    = \mathbf{v} - \mathrm{proj}_U \mathbf{v}\)。 \(\flat\)'
- en: '*Proof:* The first part is an immediate consequence of the *Orthogonal Projection
    Theorem*. For the second part, assume \(\mathbf{v} = \mathbf{u} + \mathbf{u}^\perp\)
    with \(\mathbf{u} \in U\) and \(\mathbf{u}^\perp \in U^\perp\). Subtracting \(\mathbf{v}
    = \mathrm{proj}_U \mathbf{v} + (\mathbf{v} - \mathrm{proj}_U\mathbf{v})\), we
    see that'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明：* 第一部分是正交投影定理的直接结果。对于第二部分，假设 \(\mathbf{v} = \mathbf{u} + \mathbf{u}^\perp\)，其中
    \(\mathbf{u} \in U\) 且 \(\mathbf{u}^\perp \in U^\perp\)。从 \(\mathbf{v} = \mathrm{proj}_U
    \mathbf{v} + (\mathbf{v} - \mathrm{proj}_U\mathbf{v})\) 中减去 \(\mathbf{v}\)，我们得到'
- en: \[ (*) \qquad \mathbf{0} = \mathbf{w}_1 + \mathbf{w}_2 \]
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: \[ (*) \qquad \mathbf{0} = \mathbf{w}_1 + \mathbf{w}_2 \]
- en: with
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 其中
- en: \[ \mathbf{w}_1 = \mathbf{u} - \mathrm{proj}_U \mathbf{v} \in U, \qquad \mathbf{w}_2
    = \mathbf{u}^\perp - (\mathbf{v} - \mathrm{proj}_U\mathbf{v}) \in U^\perp. \]
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{w}_1 = \mathbf{u} - \mathrm{proj}_U \mathbf{v} \in U, \qquad \mathbf{w}_2
    = \mathbf{u}^\perp - (\mathbf{v} - \mathrm{proj}_U\mathbf{v}) \in U^\perp. \]
- en: If \(\mathbf{w}_1 = \mathbf{w}_2 = \mathbf{0}\), we are done. Otherwise, they
    must both be nonzero by \((*)\). Further, by the *Properties of Orthonormal Lists*,
    \(\mathbf{w}_1\) and \(\mathbf{w}_2\) must be linearly independent. But this is
    contradicted by the fact that \(\mathbf{w}_2 = - \mathbf{w}_1\) by \((*)\). \(\square\)
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 \(\mathbf{w}_1 = \mathbf{w}_2 = \mathbf{0}\)，则已完成。否则，根据 \((*)\)，它们都必须是非零的。此外，根据正交归一列表的
    *性质*，\(\mathbf{w}_1\) 和 \(\mathbf{w}_2\) 必须是线性无关的。但这与 \((*)\) 中的 \(\mathbf{w}_2
    = - \mathbf{w}_1\) 的事实相矛盾。 \(\square\)
- en: '**Figure:** Orthogonal decomposition ([Source](https://commons.wikimedia.org/wiki/File:Orthogonal_Decomposition_qtl1.svg))'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: '**图：** 正交分解 ([来源](https://commons.wikimedia.org/wiki/File:Orthogonal_Decomposition_qtl1.svg))'
- en: '![Orthogonal decomposition](../Images/0fbd201d54de3ed8d4d4cbf69a88afc2.png)'
  id: totrans-185
  prefs: []
  type: TYPE_IMG
  zh: '![正交分解](../Images/0fbd201d54de3ed8d4d4cbf69a88afc2.png)'
- en: \(\bowtie\)
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: \(\bowtie\)
- en: 'Formally, the *Orthogonal Decomposition Lemma* states that \(\mathbb{R}^n\)
    is a direct sum of any linear subspace \(U\) and of its orthogonal complement
    \(U^\perp\): that is, any vector \(\mathbf{v} \in \mathbb{R}^n\) can be written
    uniquely as \(\mathbf{v} = \mathbf{u} + \mathbf{u}^\perp\) with \(\mathbf{u} \in
    U\) and \(\mathbf{u}^\perp \in U^\perp\). This is denoted \(\mathbb{R}^n = U \oplus
    U^\perp\).'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 形式上，**正交分解引理**表明 \(\mathbb{R}^n\) 是任何线性子空间 \(U\) 和其正交补 \(U^\perp\) 的直和：也就是说，任何向量
    \(\mathbf{v} \in \mathbb{R}^n\) 可以唯一地表示为 \(\mathbf{v} = \mathbf{u} + \mathbf{u}^\perp\)，其中
    \(\mathbf{u} \in U\) 且 \(\mathbf{u}^\perp \in U^\perp\)。这表示为 \(\mathbb{R}^n =
    U \oplus U^\perp\)。
- en: Let \(\mathbf{a}_1,\ldots,\mathbf{a}_\ell\) be an orthonormal basis of \(U\)
    and \(\mathbf{b}_1,\ldots,\mathbf{b}_k\) be an orthonormal basis of \(U^\perp\).
    By definition of the orthogonal complement, the list
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 设 \(\mathbf{a}_1,\ldots,\mathbf{a}_\ell\) 是 \(U\) 的一个正交基，\(\mathbf{b}_1,\ldots,\mathbf{b}_k\)
    是 \(U^\perp\) 的一个正交基。根据正交补的定义，该列表
- en: \[ \mathcal{L} = \{\mathbf{a}_1,\ldots,\mathbf{a}_\ell, \mathbf{b}_1,\ldots,\mathbf{b}_k\}
    \]
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathcal{L} = \{\mathbf{a}_1,\ldots,\mathbf{a}_\ell, \mathbf{b}_1,\ldots,\mathbf{b}_k\}
    \]
- en: is orthonormal, so it forms a basis of its span. Because any vector in \(\mathbb{R}^n\)
    can be written as a sum of a vector from \(U\) and a vector from \(U^\perp\),
    all of \(\mathbb{R}^n\) is in the span of \(\mathcal{L}\). It follows from the
    *Dimension Theorem* that \(n = \ell + k\), that is,
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 是正交的，因此它形成了其张成的基。因为 \(\mathbb{R}^n\) 中的任何向量都可以写成 \(U\) 中的一个向量与 \(U^\perp\) 中的一个向量的和，所以整个
    \(\mathbb{R}^n\) 都在 \(\mathcal{L}\) 的张成中。根据**维度定理**，\(n = \ell + k\)，即，
- en: \[ \mathrm{dim}(U) + \mathrm{dim}(U^\perp) = n. \]
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathrm{dim}(U) + \mathrm{dim}(U^\perp) = n. \]
- en: 2.3.4\. Overdetermined systems[#](#overdetermined-systems "Link to this heading")
  id: totrans-192
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.3.4\. 过定系统[#](#overdetermined-systems "链接到这个标题")
- en: In this section, we discuss the least-squares problem. Let again \(A \in \mathbb{R}^{n\times
    m}\) be an \(n\times m\) matrix with linearly independent columns and let \(\mathbf{b}
    \in \mathbb{R}^n\) be a vector. We are looking to solve the system
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们讨论最小二乘问题。再次设 \(A \in \mathbb{R}^{n\times m}\) 是一个 \(n\times m\) 矩阵，其列线性无关，且
    \(\mathbf{b} \in \mathbb{R}^n\) 是一个向量。我们正在求解以下系统
- en: \[ A \mathbf{x} \approx \mathbf{b}. \]
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: \[ A \mathbf{x} \approx \mathbf{b}. \]
- en: 'If \(n=m\), we can use the matrix inverse to solve the system (provided \(A\)
    is nonsingular of course). But we are interested in the overdetermined case, i.e.
    when \(n > m\): there are more equations than variables. We cannot use the matrix
    inverse then. Indeed, because the columns do not span all of \(\mathbb{R}^n\),
    there is a vector \(\mathbf{b} \in \mathbb{R}^n\) that is not in the column space
    of \(A\).'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 \(n=m\)，我们可以使用矩阵逆来求解该系统（当然，前提是 \(A\) 是非奇异的）。但我们感兴趣的是过定情况，即当 \(n > m\) 时：方程多于变量。那时我们不能使用矩阵逆。实际上，因为列没有张成整个
    \(\mathbb{R}^n\)，存在一个向量 \(\mathbf{b} \in \mathbb{R}^n\) 不在 \(A\) 的列空间中。
- en: A natural way to make sense of the overdetermined problem is to cast it as the
    [linear least-squares problem](https://en.wikipedia.org/wiki/Least_squares)\(\idx{least
    squares problem}\xdi\)
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 使过定问题有意义的自然方法是将其视为[线性最小二乘问题](https://en.wikipedia.org/wiki/Least_squares)\(\idx{最小二乘问题}\xdi\)
- en: \[ \min_{\mathbf{x} \in \mathbb{R}^m} \|A \mathbf{x} - \mathbf{b}\|^2. \]
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \min_{\mathbf{x} \in \mathbb{R}^m} \|A \mathbf{x} - \mathbf{b}\|^2. \]
- en: In words, we look for the best-fitting solution under the squared Euclidean
    norm. Equivalently, writing
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 用话来说，我们寻找在平方欧几里得范数下的最佳拟合解。等价地，写作
- en: \[\begin{split} A = \begin{pmatrix} | & & | \\ \mathbf{a}_1 & \ldots & \mathbf{a}_m
    \\ | & & | \end{pmatrix} = \begin{pmatrix} a_{11} & \cdots & a_{1m} \\ a_{21}
    & \cdots & a_{2m} \\ \vdots & \ddots & \vdots \\ a_{n1} & \cdots & a_{nm} \end{pmatrix}
    \quad \text{and} \quad \mathbf{b} = \begin{pmatrix} b_1 \\ \vdots \\ b_n \end{pmatrix}
    \end{split}\]
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A = \begin{pmatrix} | & & | \\ \mathbf{a}_1 & \ldots & \mathbf{a}_m
    \\ | & & | \end{pmatrix} = \begin{pmatrix} a_{11} & \cdots & a_{1m} \\ a_{21}
    & \cdots & a_{2m} \\ \vdots & \ddots & \vdots \\ a_{n1} & \cdots & a_{nm} \end{pmatrix}
    \quad \text{和} \quad \mathbf{b} = \begin{pmatrix} b_1 \\ \vdots \\ b_n \end{pmatrix}
    \end{split}\]
- en: we seek a linear combination of the columns of \(A\) that minimizes the objective
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 我们寻求 \(A\) 的列的线性组合，以最小化目标
- en: \[ \left\|\,\sum_{j=1}^m x_j \mathbf{a}_j - \mathbf{b}\,\right\|^2 = \sum_{i=1}^n
    \left( \sum_{j=1}^m a_{ij} x_j - b_i \right)^2. \]
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \left\|\,\sum_{j=1}^m x_j \mathbf{a}_j - \mathbf{b}\,\right\|^2 = \sum_{i=1}^n
    \left( \sum_{j=1}^m a_{ij} x_j - b_i \right)^2. \]
- en: We have already solved a closely related problem when we introduced the orthogonal
    projection. We make the connection explicit next.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们引入正交投影时，我们已经解决了一个与之密切相关的问题。我们将在下面明确建立这种联系。
- en: '**THEOREM** **(Normal Equations)** \(\idx{normal equations}\xdi\) Let \(A \in
    \mathbb{R}^{n\times m}\) be an \(n\times m\) matrix with \(n \geq m\) and let
    \(\mathbf{b} \in \mathbb{R}^n\) be a vector. A solution \(\mathbf{x}^*\) to the
    linear least-squares problem'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: '**定理** **(正则方程)** \(\idx{normal equations}\xdi\) 设 \(A \in \mathbb{R}^{n\times
    m}\) 是一个 \(n\times m\) 矩阵，其中 \(n \geq m\)，并且设 \(\mathbf{b} \in \mathbb{R}^n\)
    是一个向量。线性最小二乘问题的解 \(\mathbf{x}^*\)'
- en: \[ \min_{\mathbf{x} \in \mathbb{R}^m} \|A \mathbf{x} - \mathbf{b}\|^2 \]
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \min_{\mathbf{x} \in \mathbb{R}^m} \|A \mathbf{x} - \mathbf{b}\|^2 \]
- en: satisfies the normal equations
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 满足正则方程
- en: \[ A^T A \mathbf{x}^* = A^T \mathbf{b}. \]
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: \[ A^T A \mathbf{x}^* = A^T \mathbf{b}. \]
- en: If further the columns of \(A\) are linearly independent, then there exists
    a unique solution \(\mathbf{x}^*\). \(\sharp\)
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 \(A\) 的列线性无关，那么存在唯一的解 \(\mathbf{x}^*\)。 \(\sharp\)
- en: '*Proof idea:* Apply our characterization of the orthogonal projection onto
    the column space of \(A\).'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明思路*: 应用我们对 \(A\) 的列空间正交投影的描述。'
- en: '*Proof:* Let \(U = \mathrm{col}(A) = \mathrm{span}(\mathbf{a}_1,\ldots,\mathbf{a}_m)\).
    By the *Orthogonal Projection Theorem*, the orthogonal projection \(\mathbf{p}^*
    = \mathrm{proj}_{U} \mathbf{b}\) of \(\mathbf{b}\) onto \(U\) is the unique, closest
    vector to \(\mathbf{b}\) in \(U\), that is,'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明*: 设 \(U = \mathrm{col}(A) = \mathrm{span}(\mathbf{a}_1,\ldots,\mathbf{a}_m)\)。根据
    *正交投影定理*，\(\mathbf{b}\) 在 \(U\) 上的正交投影 \(\mathbf{p}^* = \mathrm{proj}_{U} \mathbf{b}\)
    是 \(U\) 中与 \(\mathbf{b}\) 最接近的唯一向量，即，'
- en: \[ \mathbf{p}^* = \arg\min_{\mathbf{p} \in U} \|\mathbf{p} - \mathbf{b}\| =
    \arg\min_{\mathbf{p} \in U} \|\mathbf{p} - \mathbf{b}\|^2, \]
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{p}^* = \arg\min_{\mathbf{p} \in U} \|\mathbf{p} - \mathbf{b}\| =
    \arg\min_{\mathbf{p} \in U} \|\mathbf{p} - \mathbf{b}\|^2, \]
- en: where we used the *Composing with a Non-Decreasing Function Lemma* to justify
    taking a square in the rightmost expression. Because \(\mathbf{p}^*\) is in \(U
    = \mathrm{col}(A)\), it must be of the form \(\mathbf{p}^* = A \mathbf{x}^*\).
    This establishes that \(\mathbf{x}^*\) is a solution to the linear least-squares
    problem in the statement. By the *Orthogonal Projection Theorem*, it must satisfy
    \(\langle \mathbf{b} - A \mathbf{x}^*, \mathbf{u}\rangle = 0\) for all \(\mathbf{u}
    \in U\). Because the columns \(\mathbf{a}_i\) are in \(U\), that implies that
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 其中我们使用了 *与不减函数组合引理* 来证明在最后一个表达式中取平方的合理性。因为 \(\mathbf{p}^*\) 在 \(U = \mathrm{col}(A)\)
    中，所以它必须是形式 \(\mathbf{p}^* = A \mathbf{x}^*\)。这证明了 \(\mathbf{x}^*\) 是线性最小二乘问题中所述的解。根据
    *正交投影定理*，它必须对所有 \(\mathbf{u} \in U\) 满足 \(\langle \mathbf{b} - A \mathbf{x}^*,
    \mathbf{u}\rangle = 0\)。因为列 \(\mathbf{a}_i\) 在 \(U\) 中，这意味着
- en: \[ 0 = \langle \mathbf{b} - A \mathbf{x}^*, \mathbf{a}_i\rangle = \mathbf{a}_i^T
    (\mathbf{b} - A \mathbf{x}^*) ,\qquad \forall i\in [m]. \]
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 0 = \langle \mathbf{b} - A \mathbf{x}^*, \mathbf{a}_i\rangle = \mathbf{a}_i^T
    (\mathbf{b} - A \mathbf{x}^*) ,\qquad \forall i\in [m]. \]
- en: Stacking up these equations gives in matrix form
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 将这些方程堆叠起来，以矩阵形式给出
- en: \[ A^T (\mathbf{b} - A\mathbf{x}^*) = \mathbf{0}, \]
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: \[ A^T (\mathbf{b} - A\mathbf{x}^*) = \mathbf{0}, \]
- en: as claimed (after rearranging).
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 如预期（重新排列后）。
- en: 'Important observation: While we have shown that \(\mathbf{p}^*\) is unique
    (by the *Orthogonal Projection Theorem*), it is not clear at all that \(\mathbf{x}^*\)
    (i.e., the linear combination of columns of \(A\) corresponding to \(\mathbf{p}^*\))
    is unique. We have seen in a previous example that, when \(A\) has full column
    rank, the matrix \(A^T A\) is invertible. That implies the uniqueness claim. \(\square\)'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 重要观察：虽然我们已经通过 *正交投影定理* 证明了 \(\mathbf{p}^*\) 是唯一的，但 \(\mathbf{x}^*\)（即与 \(\mathbf{p}^*\)
    对应的 \(A\) 的列的线性组合）是否唯一并不清楚。我们已经在先前的例子中看到，当 \(A\) 具有满列秩时，矩阵 \(A^T A\) 是可逆的。这暗示了唯一性的断言。
    \(\square\)
- en: '**NUMERICAL CORNER:** To solve a linear system in NumPy, use [`numpy.linalg.solve`](https://numpy.org/doc/stable/reference/generated/numpy.linalg.solve.html).
    As an example, we consider the overdetermined system with'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: '**数值角**: 在 NumPy 中解决线性系统，请使用 `numpy.linalg.solve`（[numpy.linalg.solve](https://numpy.org/doc/stable/reference/generated/numpy.linalg.solve.html)）。例如，我们考虑超定系统'
- en: \[\begin{split} A = \begin{pmatrix} 1 & 0\\ 0 & 1\\ 1 & 1 \end{pmatrix} \quad
    \text{and} \quad \mathbf{b} = \begin{pmatrix} 0\\ 0\\ 2 \end{pmatrix}. \end{split}\]
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A = \begin{pmatrix} 1 & 0\\ 0 & 1\\ 1 & 1 \end{pmatrix} \quad
    \text{和} \quad \mathbf{b} = \begin{pmatrix} 0\\ 0\\ 2 \end{pmatrix}. \end{split}\]
- en: We use [`numpy.ndarray.T`](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.T.html)
    for the transpose and [`@`](https://numpy.org/doc/stable/reference/generated/numpy.matmul.html)
    for matrix-matrix or matrix-vector product.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用 `numpy.ndarray.T`（[numpy.ndarray.T](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.T.html)）进行转置，并使用
    `@`（[numpy.matmul](https://numpy.org/doc/stable/reference/generated/numpy.matmul.html)）进行矩阵-矩阵或矩阵-向量乘积。
- en: '[PRE0]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '[PRE1]'
  id: totrans-221
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: We can also use [`numpy.linalg.lstsq`](https://numpy.org/doc/stable/reference/generated/numpy.linalg.lstsq.html)
    directly on the overdetermined system to compute the least-square solution.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也可以直接在超定系统中使用 `numpy.linalg.lstsq`（https://numpy.org/doc/stable/reference/generated/numpy.linalg.lstsq.html）来计算最小二乘解。
- en: '[PRE2]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '[PRE3]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: \(\unlhd\)
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: '***Self-assessment quiz*** *(with help from Claude, Gemini, and ChatGPT)*'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: '***自我评估测验*** *(在克劳德、双子座和ChatGPT的帮助下)*'
- en: '**1** Let \(\mathbf{q}_1, \dots, \mathbf{q}_m\) be an orthonormal list of vectors
    in \(\mathbb{R}^n\). Which of the following is the orthogonal projection of a
    vector \(\mathbf{v} \in \mathbb{R}^n\) onto \(\mathrm{span}(\mathbf{q}_1, \dots,
    \mathbf{q}_m)\)?'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: '**1** 设 \(\mathbf{q}_1, \dots, \mathbf{q}_m\) 是 \(\mathbb{R}^n\) 中的一组正交归一向量。以下哪个是向量
    \(\mathbf{v} \in \mathbb{R}^n\) 在 \(\mathrm{span}(\mathbf{q}_1, \dots, \mathbf{q}_m)\)
    上的正交投影？'
- en: a) \(\sum_{i=1}^m \mathbf{q}_i\)
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: a) \(\sum_{i=1}^m \mathbf{q}_i\)
- en: b) \(\sum_{i=1}^m \langle \mathbf{v}, \mathbf{q}_i \rangle\)
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: b) \(\sum_{i=1}^m \langle \mathbf{v}, \mathbf{q}_i \rangle\)
- en: c) \(\sum_{i=1}^m \langle \mathbf{v}, \mathbf{q}_i \rangle \mathbf{q}_i\)
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: c) \(\sum_{i=1}^m \langle \mathbf{v}, \mathbf{q}_i \rangle \mathbf{q}_i\)
- en: d) \(\sum_{i=1}^m \langle \mathbf{q}_i, \mathbf{q}_i \rangle \mathbf{v}\)
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: d) \(\sum_{i=1}^m \langle \mathbf{q}_i, \mathbf{q}_i \rangle \mathbf{v}\)
- en: '**2** According to the Normal Equations Theorem, what condition must a solution
    \(\bx^*\) to the linear least squares problem satisfy?'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: '**2** 根据正则方程定理，线性最小二乘问题的解 \(\bx^*\) 必须满足什么条件？'
- en: a) \(A^T A\bx^* = \bb\)
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: a) \(A^T A\bx^* = \bb\)
- en: b) \(A^T A\bx^* = A^T \bb\)
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: b) \(A^T A\bx^* = A^T \bb\)
- en: c) \(A\bx^* = A^T \bb\)
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: c) \(A\bx^* = A^T \bb\)
- en: d) \(A\bx^* = \bb\)
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: d) \(A\bx^* = \bb\)
- en: '**3** Which property characterizes the orthogonal projection \(\mathrm{proj}_U
    \mathbf{v}\) of a vector \(\mathbf{v}\) onto a subspace \(U\)?'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: '**3** 哪个性质描述了向量 \(\mathbf{v}\) 在子空间 \(U\) 上的正交投影 \(\mathrm{proj}_U \mathbf{v}\)
    的特性？'
- en: a) \(\mathbf{v} - \mathrm{proj}_U \mathbf{v}\) is a scalar multiple of \(\mathbf{v}\).
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: a) \(\mathbf{v} - \mathrm{proj}_U \mathbf{v}\) 是 \(\mathbf{v}\) 的一个标量倍数。
- en: b) \(\mathbf{v} - \mathrm{proj}_U \mathbf{v}\) is orthogonal to \(\mathbf{v}\).
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: b) \(\mathbf{v} - \mathrm{proj}_U \mathbf{v}\) 与 \(\mathbf{v}\) 正交。
- en: c) \(\mathbf{v} - \mathrm{proj}_U \mathbf{v}\) is orthogonal to \(U\).
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: c) \(\mathbf{v} - \mathrm{proj}_U \mathbf{v}\) 是与 \(U\) 正交的。
- en: d) \(\mathrm{proj}_U \mathbf{v}\) is always the zero vector.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: d) \(\mathrm{proj}_U \mathbf{v}\) 总是零向量。
- en: '**4** What is the interpretation of the linear least squares problem \(A\mathbf{x}
    \approx \mathbf{b}\) in terms of the column space of \(A\)?'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: '**4** 从 \(A\) 的列空间的角度来看，线性最小二乘问题 \(A\mathbf{x} \approx \mathbf{b}\) 的解释是什么？'
- en: a) Finding the exact solution \(\mathbf{x}\) such that \(A\mathbf{x} = \mathbf{b}\).
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: a) 寻找精确解 \(\mathbf{x}\)，使得 \(A\mathbf{x} = \mathbf{b}\)。
- en: b) Finding the vector \(\mathbf{x}\) that makes the linear combination \(A\mathbf{x}\)
    of the columns of \(A\) as close as possible to \(\mathbf{b}\) in Euclidean norm.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: b) 寻找向量 \(\mathbf{x}\)，使得 \(A\) 的列向量的线性组合 \(A\mathbf{x}\) 在欧几里得范数下尽可能接近 \(\mathbf{b}\)。
- en: c) Finding the orthogonal projection of \(\mathbf{b}\) onto the column space
    of \(A\).
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: c) 寻找 \(\mathbf{b}\) 在 \(A\) 的列空间上的正交投影。
- en: d) Finding the orthogonal complement of the column space of \(A\).
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: d) 寻找 \(A\) 的列空间的正交补。
- en: '**5** Which matrix equation must hold true for a matrix \(Q\) to be orthogonal?'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: '**5** 对于一个正交矩阵 \(Q\)，必须满足哪个矩阵方程？'
- en: a) \(Q Q^T = 0\).
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: a) \(Q Q^T = 0\).
- en: b) \(Q Q^T = I\).
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: b) \(Q Q^T = I\).
- en: c) \(Q^T Q = 0\).
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: c) \(Q^T Q = 0\).
- en: d) \(Q^T = Q\).
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: d) \(Q^T = Q\).
- en: 'Answer for 1: c. Justification: This is the definition of the orthogonal projection
    onto an orthonormal list given in the text.'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 1题的答案：c. 理由：这是文本中给出的正交投影到正交归一向量组的定义。
- en: 'Answer for 2: b. Justification: The Normal Equations Theorem states that a
    solution \(\bx^*\) to the linear least squares problem satisfies \(A^T A\bx^*
    = A^T \bb\).'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 2题的答案：b. 理由：正则方程定理指出，线性最小二乘问题的解 \(\bx^*\) 满足 \(A^T A\bx^* = A^T \bb\)。
- en: 'Answer for 3: c. Justification: The text states that the orthogonal projection
    \(\mathrm{proj}_U \mathbf{v}\) has the property that “the difference \(\mathbf{v}
    - \mathrm{proj}_U \mathbf{v}\) is orthogonal to \(U\).”'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 3题的答案：c. 理由：文本指出正交投影 \(\mathrm{proj}_U \mathbf{v}\) 具有性质“差 \(\mathbf{v} - \mathrm{proj}_U
    \mathbf{v}\) 与 \(U\) 正交。”
- en: 'Answer for 4: b. Justification: The text defines the linear least squares problem
    as seeking a linear combination of the columns of \(A\) that minimizes the distance
    to \(\mathbf{b}\) in Euclidean norm.'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 4题的答案：b. 理由：文本将线性最小二乘问题定义为寻求 \(A\) 的列向量的一个线性组合，该组合在欧几里得范数下最小化到 \(\mathbf{b}\)
    的距离。
- en: 'Answer for 5: b. Justification: The text states that an orthogonal matrix \(Q\)
    must satisfy \(Q Q^T = I\).'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 5题的答案：b. 理由：文本指出正交矩阵 \(Q\) 必须满足 \(Q Q^T = I\)。
- en: '2.3.1\. A key concept: orthogonality[#](#a-key-concept-orthogonality "Link
    to this heading")'
  id: totrans-257
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.3.1\. 一个关键概念：正交性[#](#a-key-concept-orthogonality "链接到这个标题")
- en: Orthogonality plays a key role in linear algebra for data science thanks to
    its computational properties and its connection to the least-squares problem.
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 正交性在数据科学中的线性代数中起着关键作用，这得益于其计算特性和与最小二乘问题的联系。
- en: '**DEFINITION** **(Orthogonality)** \(\idx{orthogonality}\xdi\) Vectors \(\mathbf{u}\)
    and \(\mathbf{v}\) in \(\mathbb{R}^n\) (as column vectors) are orthogonal if their
    inner product is zero'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: '**定义** **(正交性)** \(\idx{orthogonality}\xdi\) 在 \(\mathbb{R}^n\) 中（作为列向量）的向量
    \(\mathbf{u}\) 和 \(\mathbf{v}\) 是正交的，如果它们的内积为零'
- en: \[ \langle \mathbf{u}, \mathbf{v} \rangle =\mathbf{u}^T \mathbf{v} = \sum_{i=1}^n
    u_i v_i = 0. \]
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \langle \mathbf{u}, \mathbf{v} \rangle =\mathbf{u}^T \mathbf{v} = \sum_{i=1}^n
    u_i v_i = 0. \]
- en: \(\natural\)
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: \(\natural\)
- en: Orthogonality has important implications. The following classical result will
    be useful below. Throughout, we use \(\|\mathbf{u}\|\) for the Euclidean norm
    of \(\mathbf{u}\).
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 正交性具有重要的意义。以下经典结果将在下面有用。在整个过程中，我们使用 \(\|\mathbf{u}\|\) 表示 \(\mathbf{u}\) 的欧几里得范数。
- en: '**THEOREM** **(Pythagoras)** \(\idx{Pythagoras'' theorem}\xdi\) Let \(\mathbf{u},
    \mathbf{v} \in \mathbb{R}^n\) be orthogonal. Then \(\|\mathbf{u} + \mathbf{v}\|^2
    = \|\mathbf{u}\|^2 + \|\mathbf{v}\|^2\). \(\sharp\)'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: '**定理** **(毕达哥拉斯)** \(\idx{Pythagoras'' theorem}\xdi\) 设 \(\mathbf{u}, \mathbf{v}
    \in \mathbb{R}^n\) 是正交的。那么 \(\|\mathbf{u} + \mathbf{v}\|^2 = \|\mathbf{u}\|^2
    + \|\mathbf{v}\|^2\). \(\sharp\)'
- en: '*Proof:* Using \(\|\mathbf{w}\|^2 = \langle \mathbf{w}, \mathbf{w}\rangle\),
    we get'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明* 使用 \(\|\mathbf{w}\|^2 = \langle \mathbf{w}, \mathbf{w}\rangle\)，我们得到'
- en: \[\begin{align*} \|\mathbf{u} + \mathbf{v}\|^2 &= \langle \mathbf{u} + \mathbf{v},
    \mathbf{u} + \mathbf{v}\rangle\\ &= \langle \mathbf{u}, \mathbf{u}\rangle + 2
    \,\langle \mathbf{u}, \mathbf{v}\rangle + \langle \mathbf{v}, \mathbf{v}\rangle\\
    &= \|\mathbf{u}\|^2 + \|\mathbf{v}\|^2. \end{align*}\]
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \|\mathbf{u} + \mathbf{v}\|^2 &= \langle \mathbf{u} + \mathbf{v},
    \mathbf{u} + \mathbf{v}\rangle\\ &= \langle \mathbf{u}, \mathbf{u}\rangle + 2
    \,\langle \mathbf{u}, \mathbf{v}\rangle + \langle \mathbf{v}, \mathbf{v}\rangle\\
    &= \|\mathbf{u}\|^2 + \|\mathbf{v}\|^2. \end{align*}\]
- en: \(\square\)
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: \(\square\)
- en: An application of *Pythagoras’ Theorem* is a proof of the *Cauchy-Schwarz Inequality*.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 毕达哥拉斯定理的应用是证明柯西-施瓦茨不等式。
- en: '*Proof:* *(Cauchy-Schwarz)* \(\idx{Cauchy-Schwarz inequality}\xdi\) Let \(\mathbf{q}
    = \frac{\mathbf{v}}{\|\mathbf{v}\|}\) be the unit vector in the direction of \(\mathbf{v}\).
    We want to show \(|\langle \mathbf{u}, \mathbf{q}\rangle| \leq \|\mathbf{u}\|\).
    Decompose \(\mathbf{u}\) as follows:'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明* *(柯西-施瓦茨不等式)* \(\idx{Cauchy-Schwarz inequality}\xdi\) 设 \(\mathbf{q} =
    \frac{\mathbf{v}}{\|\mathbf{v}\|}\) 是 \(\mathbf{v}\) 方向上的单位向量。我们要证明 \(|\langle
    \mathbf{u}, \mathbf{q}\rangle| \leq \|\mathbf{u}\|\)。如下分解 \(\mathbf{u}\)：'
- en: \[ \mathbf{u} = \left\langle \mathbf{u}, \mathbf{q}\right\rangle \mathbf{q}
    + \left\{\mathbf{u} - \left\langle \mathbf{u}, \mathbf{q}\right\rangle \mathbf{q}\right\}.
    \]
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{u} = \left\langle \mathbf{u}, \mathbf{q}\right\rangle \mathbf{q}
    + \left\{\mathbf{u} - \left\langle \mathbf{u}, \mathbf{q}\right\rangle \mathbf{q}\right\}.
    \]
- en: 'The two terms on the right-hand side are orthogonal:'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 右侧的两个项是正交的：
- en: \[ \left\langle \left\langle \mathbf{u}, \mathbf{q}\right\rangle \mathbf{q},
    \mathbf{u} - \left\langle \mathbf{u}, \mathbf{q}\right\rangle \mathbf{q} \right\rangle
    = \left\langle \mathbf{u}, \mathbf{q}\right\rangle^2 - \left\langle \mathbf{u},
    \mathbf{q}\right\rangle^2 \left\langle \mathbf{q}, \mathbf{q}\right\rangle = 0.
    \]
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \left\langle \left\langle \mathbf{u}, \mathbf{q}\right\rangle \mathbf{q},
    \mathbf{u} - \left\langle \mathbf{u}, \mathbf{q}\right\rangle \mathbf{q} \right\rangle
    = \left\langle \mathbf{u}, \mathbf{q}\right\rangle^2 - \left\langle \mathbf{u},
    \mathbf{q}\right\rangle^2 \left\langle \mathbf{q}, \mathbf{q}\right\rangle = 0.
    \]
- en: So *Pythagoras* gives
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，毕达哥拉斯定理给出
- en: \[ \|\mathbf{u}\|^2 = \left\|\left\langle \mathbf{u}, \mathbf{q}\right\rangle
    \mathbf{q}\right\|^2 + \left\|\mathbf{u} - \left\langle \mathbf{u}, \mathbf{q}\right\rangle
    \mathbf{q}\right\|^2 \geq \left\|\left\langle \mathbf{u}, \mathbf{q}\right\rangle
    \mathbf{q}\right\|^2 = \left\langle \mathbf{u}, \mathbf{q}\right\rangle^2. \]
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \|\mathbf{u}\|^2 = \left\|\left\langle \mathbf{u}, \mathbf{q}\right\rangle
    \mathbf{q}\right\|^2 + \left\|\mathbf{u} - \left\langle \mathbf{u}, \mathbf{q}\right\rangle
    \mathbf{q}\right\|^2 \geq \left\|\left\langle \mathbf{u}, \mathbf{q}\right\rangle
    \mathbf{q}\right\|^2 = \left\langle \mathbf{u}, \mathbf{q}\right\rangle^2. \]
- en: Taking a square root gives the claim. \(\square\)
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 取平方根给出所要求的结论。\(\square\)
- en: '**Orthonormal basis expansion** To begin to see the power of orthogonality,
    consider the following. A list of vectors \(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\)
    is an orthonormal list if the \(\mathbf{u}_i\)’s are pairwise orthogonal and each
    has norm 1, that is, for all \(i\) and all \(j \neq i\), we have \(\|\mathbf{u}_i\|
    = 1\) and \(\langle \mathbf{u}_i, \mathbf{u}_j \rangle = 0\). Alternatively,'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: '**正交基展开** 为了开始看到正交性的力量，考虑以下内容。向量列表 \(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\)
    是一个正交列表，如果 \(\mathbf{u}_i\) 之间两两正交，并且每个向量的范数为 1，即对于所有 \(i\) 和所有 \(j \neq i\)，我们有
    \(\|\mathbf{u}_i\| = 1\) 和 \(\langle \mathbf{u}_i, \mathbf{u}_j \rangle = 0\)。或者，'
- en: \[\begin{split} \langle \mathbf{u}_i, \mathbf{u}_j \rangle = \begin{cases} 1
    & \text{if $i=j$}\\ 0 & \text{if $i\neq j$}. \end{cases} \end{split}\]
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \langle \mathbf{u}_i, \mathbf{u}_j \rangle = \begin{cases} 1
    & \text{如果 } i=j\\ 0 & \text{如果 } i\neq j. \end{cases} \end{split}\]
- en: '**LEMMA** **(Properties of Orthonormal Lists)** \(\idx{properties of orthonormal
    lists}\xdi\) Let \(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\) be an orthonormal list.
    Then:'
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: '**引理** **(正交列表的性质)** \(\idx{properties of orthonormal lists}\xdi\) 设 \(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\)
    是一个正交列表。那么：'
- en: for any \(\alpha_j \in \mathbb{R}\), \(j=1,\ldots,m\), we have
  id: totrans-278
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于任意的 \(\alpha_j \in \mathbb{R}\)，\(j=1,\ldots,m\)，我们有
- en: \[ \left\|\sum_{j=1}^m \alpha_j \mathbf{u}_j\right\|^2 = \sum_{j=1}^m \alpha_j^2,
    \]
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \left\|\sum_{j=1}^m \alpha_j \mathbf{u}_j\right\|^2 = \sum_{j=1}^m \alpha_j^2,
    \]
- en: the vectors \(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\) are linearly independent.
  id: totrans-280
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向量 \(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\) 是线性无关的。
- en: \(\flat\)
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: \(\flat\)
- en: '*Proof:* For 1., using that \(\|\mathbf{x}\|^2 = \langle \mathbf{x}, \mathbf{x}
    \rangle\), we have'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明*：对于 1，使用 \(\|\mathbf{x}\|^2 = \langle \mathbf{x}, \mathbf{x} \rangle\)，我们有'
- en: \[\begin{align*} \left\|\sum_{j=1}^m \alpha_j \mathbf{u}_j\right\|^2 &= \left\langle
    \sum_{i=1}^m \alpha_i \mathbf{u}_i, \sum_{j=1}^m \alpha_j \mathbf{u}_j \right\rangle\\
    &= \sum_{i=1}^m \alpha_i \left\langle \mathbf{u}_i, \sum_{j=1}^m \alpha_j \mathbf{u}_j
    \right\rangle\\ &= \sum_{i=1}^m \sum_{j=1}^m \alpha_i \alpha_j \left\langle \mathbf{u}_i,
    \mathbf{u}_j \right\rangle\\ &= \sum_{i=1}^m \alpha_i^2 \end{align*}\]
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \left\|\sum_{j=1}^m \alpha_j \mathbf{u}_j\right\|^2 &= \left\langle
    \sum_{i=1}^m \alpha_i \mathbf{u}_i, \sum_{j=1}^m \alpha_j \mathbf{u}_j \right\rangle\\
    &= \sum_{i=1}^m \alpha_i \left\langle \mathbf{u}_i, \sum_{j=1}^m \alpha_j \mathbf{u}_j
    \right\rangle\\ &= \sum_{i=1}^m \sum_{j=1}^m \alpha_i \alpha_j \left\langle \mathbf{u}_i,
    \mathbf{u}_j \right\rangle\\ &= \sum_{i=1}^m \alpha_i^2 \end{align*}\]
- en: where we used orthonormality in the last equation, that is, \(\langle \mathbf{u}_i,
    \mathbf{u}_j \rangle\) is \(1\) if \(i=j\) and \(0\) otherwise.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 在最后一个等式中我们使用了正交性，即 \(\langle \mathbf{u}_i, \mathbf{u}_j \rangle\) 在 \(i=j\)
    时为 \(1\)，否则为 \(0\)。
- en: For 2., suppose \(\sum_{i=1}^m \beta_i \mathbf{u}_i = \mathbf{0}\), then we
    must have by 1\. that \(\sum_{i=1}^m \beta_i^2 = 0\). That implies \(\beta_i =
    0\) for all \(i\). Hence the \(\mathbf{u}_i\)’s are linearly independent. \(\square\)
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 2，假设 \(\sum_{i=1}^m \beta_i \mathbf{u}_i = \mathbf{0}\)，那么根据 1，我们必须有 \(\sum_{i=1}^m
    \beta_i^2 = 0\)。这表明对于所有 \(i\)，\(\beta_i = 0\)。因此，\(\mathbf{u}_i\) 是线性无关的。 \(\square\)
- en: 'Given a basis \(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\) of \(U\), we know that:
    for any \(\mathbf{w} \in U\), \(\mathbf{w} = \sum_{i=1}^m \alpha_i \mathbf{u}_i\)
    for some \(\alpha_i\)’s. It is not immediately obvious in general how to find
    the \(\alpha_i\)’s – one must solve a system of linear equations. In the orthonormal
    case, however, there is a formula. We say that the basis \(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\)
    is orthonormal if it forms an orthonormal list.'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 给定 \(U\) 的一个基 \(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\)，我们知道：对于任意的 \(\mathbf{w}
    \in U\)，\(\mathbf{w} = \sum_{i=1}^m \alpha_i \mathbf{u}_i\)，其中存在某些 \(\alpha_i\)。在一般情况下，如何找到
    \(\alpha_i\) 并不立即明显——必须解一个线性方程组。然而，在正交的情况下，存在一个公式。我们说基 \(\{\mathbf{u}_1,\ldots,\mathbf{u}_m\}\)
    是正交的，如果它形成一个正交列表。
- en: '**THEOREM** **(Orthonormal Expansion)** \(\idx{orthonormal expansion theorem}\xdi\)
    Let \(\mathbf{q}_1,\ldots,\mathbf{q}_m\) be an orthonormal basis of \(U\) and
    let \(\mathbf{w} \in U\). Then'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: '**定理** **(正交展开)** \(\idx{orthonormal expansion theorem}\xdi\) 设 \(\mathbf{q}_1,\ldots,\mathbf{q}_m\)
    是 \(U\) 的一个正交基，且 \(\mathbf{w} \in U\)。那么'
- en: \[ \mathbf{w} = \sum_{j=1}^m \langle \mathbf{w}, \mathbf{q}_j\rangle \,\mathbf{q}_j.
    \]
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{w} = \sum_{j=1}^m \langle \mathbf{w}, \mathbf{q}_j\rangle \,\mathbf{q}_j.
    \]
- en: \(\sharp\)
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: \(\sharp\)
- en: '*Proof:* Because \(\mathbf{w} \in U\), \(\mathbf{w} = \sum_{i=1}^m \alpha_i
    \mathbf{q}_i\) for some \(\alpha_i\). Take the inner product with \(\mathbf{q}_j\)
    and use orthonormality:'
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明*：因为 \(\mathbf{w} \in U\)，所以 \(\mathbf{w} = \sum_{i=1}^m \alpha_i \mathbf{q}_i\)，其中存在某些
    \(\alpha_i\)。与 \(\mathbf{q}_j\) 取内积并使用正交性：'
- en: \[ \langle \mathbf{w}, \mathbf{q}_j\rangle = \left\langle \sum_{i=1}^m \alpha_i
    \mathbf{q}_i, \mathbf{q}_j\right\rangle = \sum_{i=1}^m \alpha_i \langle \mathbf{q}_i,
    \mathbf{q}_j\rangle = \alpha_j. \]
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \langle \mathbf{w}, \mathbf{q}_j\rangle = \left\langle \sum_{i=1}^m \alpha_i
    \mathbf{q}_i, \mathbf{q}_j\right\rangle = \sum_{i=1}^m \alpha_i \langle \mathbf{q}_i,
    \mathbf{q}_j\rangle = \alpha_j. \]
- en: Hence, we have determined all \(\alpha_j\)’s in the basis expansion of \(\mathbf{w}\).
    \(\square\)
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们已经确定了 \(\mathbf{w}\) 的基展开中的所有 \(\alpha_j\)。 \(\square\)
- en: '**EXAMPLE:** Consider again the linear subspace \(W = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3)\),
    where \(\mathbf{w}_1 = (1,0,1)\), \(\mathbf{w}_2 = (0,1,1)\), and \(\mathbf{w}_3
    = (1,-1,0)\). We have shown that in fact'
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例：** 再次考虑线性子空间 \(W = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3)\)，其中
    \(\mathbf{w}_1 = (1,0,1)\)，\(\mathbf{w}_2 = (0,1,1)\)，和 \(\mathbf{w}_3 = (1,-1,0)\)。我们已经证明实际上'
- en: \[ \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3) = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2),
    \]
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3) = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2),
    \]
- en: as \(\mathbf{w}_1,\mathbf{w}_2\) form a basis of \(W\). On the other hand,
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 因为 \(\mathbf{w}_1,\mathbf{w}_2\) 形成了 \(W\) 的基。另一方面，
- en: \[ \langle\mathbf{w}_1,\mathbf{w}_2\rangle = (1)(0) + (0)(1) + (1)(1) = 0 +
    0 + 1 = 1 \neq 0 \]
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \langle\mathbf{w}_1,\mathbf{w}_2\rangle = (1)(0) + (0)(1) + (1)(1) = 0 +
    0 + 1 = 1 \neq 0 \]
- en: so this basis is not orthonormal. Indeed, an orthonormal list is necessarily
    an independent list, but the opposite may not hold.
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，这个基不是正交归一的。实际上，一个正交归一列表必然是一个独立的列表，但反之不一定成立。
- en: To produce an orthonormal basis of \(W\), we can first proceed by normalizing
    \(\mathbf{w}_1\)
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 为了生成 \(W\) 的正交归一基，我们首先可以通过归一化 \(\mathbf{w}_1\)
- en: \[ \mathbf{q}_1 = \frac{\mathbf{w}_1}{\|\mathbf{w}_1\|} = \frac{\mathbf{w}_1}{\sqrt{1^2
    + 0^2 + 1^2}} = \frac{1}{\sqrt{2}} \mathbf{w}_1. \]
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{q}_1 = \frac{\mathbf{w}_1}{\|\mathbf{w}_1\|} = \frac{\mathbf{w}_1}{\sqrt{1^2
    + 0^2 + 1^2}} = \frac{1}{\sqrt{2}} \mathbf{w}_1. \]
- en: Then \(\|\mathbf{q}_1\| = 1\) since, in general, by absolute homogeneity of
    the norm
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 然后 \(\|\mathbf{q}_1\| = 1\)，因为，一般来说，由范数的绝对齐次性
- en: \[ \left\|\frac{\mathbf{w}_1}{\|\mathbf{w}_1\|}\right\| = \frac{1}{\|\mathbf{w}_1\|}
    \|\mathbf{w}_1\| = 1. \]
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \left\|\frac{\mathbf{w}_1}{\|\mathbf{w}_1\|}\right\| = \frac{1}{\|\mathbf{w}_1\|}
    \|\mathbf{w}_1\| = 1. \]
- en: 'We then seek a second basis vector. It must satisfy two conditions in this
    case:'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们寻求第二个基向量。在这种情况下，它必须满足两个条件：
- en: it must be of unit norm and be orthogonal to \(\mathbf{q}_1\); and
  id: totrans-303
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它必须是单位范数并且与 \(\mathbf{q}_1\) 正交；并且
- en: \(\mathbf{w}_2\) must be a linear combination of \(\mathbf{q}_1\) and \(\mathbf{q}_2\).
  id: totrans-304
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: \(\mathbf{w}_2\) 必须是 \(\mathbf{q}_1\) 和 \(\mathbf{q}_2\) 的线性组合。
- en: The latter condition guarantees that \(\mathrm{span}(\mathbf{q}_1,\mathbf{q}_2)
    = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2)\). (Formally, that would imply only
    that \(\mathrm{span}(\mathbf{w}_1,\mathbf{w}_2) \subseteq \mathrm{span}(\mathbf{q}_1,\mathbf{q}_2)\).
    In this case, it is easy to see that the containment must go in the opposite direction
    as well. Why?)
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 后者条件保证了 \(\mathrm{span}(\mathbf{q}_1,\mathbf{q}_2) = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2)\)。
    (形式上，这只会意味着 \(\mathrm{span}(\mathbf{w}_1,\mathbf{w}_2) \subseteq \mathrm{span}(\mathbf{q}_1,\mathbf{q}_2)\)。在这种情况下，很容易看出包含关系必须相反。为什么？)
- en: The first condition translates into
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个条件可以转化为
- en: \[ 1 = \|\mathbf{q}_2\|^2 = q_{21}^2 + q_{22}^2 + q_{23}^2, \]
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 1 = \|\mathbf{q}_2\|^2 = q_{21}^2 + q_{22}^2 + q_{23}^2, \]
- en: where \(\mathbf{q}_2 = (q_{21}, q_{22}, q_{23})\), and
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(\mathbf{q}_2 = (q_{21}, q_{22}, q_{23})\)，并且
- en: \[ 0 = \langle\mathbf{q}_1, \mathbf{q}_2\rangle = \frac{1}{\sqrt{2}}\left[1\cdot
    q_{21} + 0 \cdot q_{22} + 1 \cdot q_{23}\right] = \frac{1}{\sqrt{2}}\left[q_{21}
    + q_{23}\right]. \]
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 0 = \langle\mathbf{q}_1, \mathbf{q}_2\rangle = \frac{1}{\sqrt{2}}\left[1\cdot
    q_{21} + 0 \cdot q_{22} + 1 \cdot q_{23}\right] = \frac{1}{\sqrt{2}}\left[q_{21}
    + q_{23}\right]. \]
- en: That is, simplifying the second display and plugging into the first, \(q_{23}
    = -q_{21}\) and \(q_{22} = \sqrt{1 - 2 q_{21}^2}\).
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 即，简化第二个公式并代入第一个，得到 \(q_{23} = -q_{21}\) 和 \(q_{22} = \sqrt{1 - 2 q_{21}^2}\)。
- en: 'The second condition translates into: there is \(\beta_1, \beta_2 \in \mathbb{R}\)
    such that'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 第二个条件可以转化为：存在 \(\beta_1, \beta_2 \in \mathbb{R}\) 使得
- en: \[\begin{split} \mathbf{w}_2 = \begin{pmatrix} 0 \\ 1 \\ 1 \end{pmatrix} = \beta_1
    \mathbf{q}_1 + \beta_2 \mathbf{q}_2 = \beta_1 \frac{1}{\sqrt{2}} \begin{pmatrix}
    1 \\ 0 \\ 1 \end{pmatrix} + \beta_2 \begin{pmatrix} q_{21} \\ \sqrt{1-2 q_{21}^2}
    \\ -q_{21} \end{pmatrix}. \end{split}\]
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{w}_2 = \begin{pmatrix} 0 \\ 1 \\ 1 \end{pmatrix} = \beta_1
    \mathbf{q}_1 + \beta_2 \mathbf{q}_2 = \beta_1 \frac{1}{\sqrt{2}} \begin{pmatrix}
    1 \\ 0 \\ 1 \end{pmatrix} + \beta_2 \begin{pmatrix} q_{21} \\ \sqrt{1-2 q_{21}^2}
    \\ -q_{21} \end{pmatrix}. \end{split}\]
- en: The first entry gives \(\beta_1/\sqrt{2} + \beta_2 q_{21} = 0\) while the third
    entry gives \(\beta_1/\sqrt{2} - \beta_2 q_{21} = 1\). Adding up the equations
    gives \(\beta_1 = 1/\sqrt{2}\). Plugging back into the first one gives \(\beta_2
    = -1/(2q_{21})\). Returning to the equation for \(\mathbf{w}_2\), we get from
    the second entry
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个元素给出 \(\beta_1/\sqrt{2} + \beta_2 q_{21} = 0\)，而第三个元素给出 \(\beta_1/\sqrt{2}
    - \beta_2 q_{21} = 1\)。将方程相加给出 \(\beta_1 = 1/\sqrt{2}\)。将这个值代入第一个方程给出 \(\beta_2
    = -1/(2q_{21})\)。回到 \(\mathbf{w}_2\) 的方程，从第二个元素得到
- en: \[ 1 = - \frac{1}{2 q_{21}} \sqrt{1 - 2 q_{21}^2}. \]
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 1 = - \frac{1}{2 q_{21}} \sqrt{1 - 2 q_{21}^2}. \]
- en: Rearranging and taking a square, we want the negative solution to
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 重新排列并取平方，我们希望得到负解
- en: \[ 4 q_{21}^2 = 1 - 2 q_{21}^2, \]
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 4 q_{21}^2 = 1 - 2 q_{21}^2, \]
- en: that is, \(q_{21} = - 1/\sqrt{6}\). Finally, we get \(q_{23} = - q_{21} = 1/\sqrt{6}\)
    and \(q_{22} = \sqrt{1 - 2 q_{21}^2} = \sqrt{1 - 1/3} = \sqrt{2/3} = 2/\sqrt{6}\).
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 即，\(q_{21} = - 1/\sqrt{6}\)。最后，我们得到 \(q_{23} = - q_{21} = 1/\sqrt{6}\) 和 \(q_{22}
    = \sqrt{1 - 2 q_{21}^2} = \sqrt{1 - 1/3} = \sqrt{2/3} = 2/\sqrt{6}\)。
- en: To summarize, we have
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 总结一下，我们有
- en: \[\begin{split} \mathbf{q}_1 = \frac{1}{\sqrt{2}} \begin{pmatrix} 1\\ 0\\ 1
    \end{pmatrix}, \quad \mathbf{q}_2 = \frac{1}{\sqrt{6}} \begin{pmatrix} -1\\ 2\\
    1 \end{pmatrix}. \end{split}\]
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{q}_1 = \frac{1}{\sqrt{2}} \begin{pmatrix} 1\\ 0\\ 1
    \end{pmatrix}, \quad \mathbf{q}_2 = \frac{1}{\sqrt{6}} \begin{pmatrix} -1\\ 2\\
    1 \end{pmatrix}. \end{split}\]
- en: We confirm that
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: 我们确认
- en: \[ \langle \mathbf{q}_1, \mathbf{q}_2\rangle = \frac{1}{\sqrt{2}\sqrt{6}}[(1)(-1)
    + (0)(2) + (1)(1)] = 0 \]
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \langle \mathbf{q}_1, \mathbf{q}_2\rangle = \frac{1}{\sqrt{2}\sqrt{6}}[(1)(-1)
    + (0)(2) + (1)(1)] = 0 \]
- en: and
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 并且
- en: \[ \|\mathbf{q}_2\|^2 = \left(-\frac{1}{\sqrt{6}}\right)^2 + \left(\frac{2}{\sqrt{6}}\right)^2
    + \left(\frac{1}{\sqrt{6}}\right)^2 = \frac{1}{6} + \frac{4}{6} + \frac{1}{6}
    = 1. \]
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \|\mathbf{q}_2\|^2 = \left(-\frac{1}{\sqrt{6}}\right)^2 + \left(\frac{2}{\sqrt{6}}\right)^2
    + \left(\frac{1}{\sqrt{6}}\right)^2 = \frac{1}{6} + \frac{4}{6} + \frac{1}{6}
    = 1. \]
- en: We can use the *Orthonormal Expansion Theorem* to write \(\mathbf{w}_2\) as
    a linear combination of \(\mathbf{q}_1\) and \(\mathbf{q}_2\). The inner products
    are
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用**正交归一展开定理**将 \(\mathbf{w}_2\) 写成 \(\mathbf{q}_1\) 和 \(\mathbf{q}_2\)
    的线性组合。内积为
- en: \[ \langle \mathbf{w}_2, \mathbf{q}_1 \rangle = 0 \left(\frac{1}{\sqrt{2}}\right)
    + 1 \left(\frac{0}{\sqrt{2}}\right) + 1 \left(\frac{1}{\sqrt{2}}\right) = \frac{1}{\sqrt{2}},
    \]\[ \langle \mathbf{w}_2, \mathbf{q}_2 \rangle = 0 \left(-\frac{1}{\sqrt{6}}\right)
    + 1 \left(\frac{2}{\sqrt{6}}\right) + 1 \left(\frac{1}{\sqrt{6}}\right) = \frac{3}{\sqrt{6}}.
    \]
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \langle \mathbf{w}_2, \mathbf{q}_1 \rangle = 0 \left(\frac{1}{\sqrt{2}}\right)
    + 1 \left(\frac{0}{\sqrt{2}}\right) + 1 \left(\frac{1}{\sqrt{2}}\right) = \frac{1}{\sqrt{2}},
    \]\[ \langle \mathbf{w}_2, \mathbf{q}_2 \rangle = 0 \left(-\frac{1}{\sqrt{6}}\right)
    + 1 \left(\frac{2}{\sqrt{6}}\right) + 1 \left(\frac{1}{\sqrt{6}}\right) = \frac{3}{\sqrt{6}}.
    \]
- en: So
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 因此
- en: \[ \mathbf{w}_2 = \frac{1}{\sqrt{2}} \mathbf{q}_1 + \frac{3}{\sqrt{6}} \mathbf{q}_2.
    \]
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{w}_2 = \frac{1}{\sqrt{2}} \mathbf{q}_1 + \frac{3}{\sqrt{6}} \mathbf{q}_2.
    \]
- en: Check it! Try \(\mathbf{w}_3\). \(\lhd\)
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 检查一下！尝试 \(\mathbf{w}_3\)。 \(\lhd\)
- en: '**Gram-Schmidt** We have shown that working with orthonormal bases is desirable.
    What if we do not have one? We could try to construct one by hand as we did in
    the previous example. But there are better ways. We review the [Gram-Schmidt algorithm](https://en.wikipedia.org/wiki/Gram%E2%80%93Schmidt_process)
    in an upcoming section, which will imply that every linear subspace has an orthonormal
    basis. That is, we will prove the following theorem.'
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: '**Gram-Schmidt** 我们已经证明使用正交基是可取的。如果我们没有正交基怎么办？我们可以尝试像上一个例子那样手动构建一个。但是，有更好的方法。我们将在下一节回顾
    [Gram-Schmidt 算法](https://en.wikipedia.org/wiki/Gram%E2%80%93Schmidt_process)，这将意味着每个线性子空间都有一个正交基。也就是说，我们将证明以下定理。'
- en: '**THEOREM** **(Gram-Schmidt)** \(\idx{Gram-Schmidt theorem}\xdi\) Let \(\mathbf{a}_1,\ldots,\mathbf{a}_m\)
    be linearly independent. Then there exists an orthonormal basis \(\mathbf{q}_1,\ldots,\mathbf{q}_m\)
    of \(\mathrm{span}(\mathbf{a}_1,\ldots,\mathbf{a}_m)\). \(\sharp\)'
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: '**定理** **(Gram-Schmidt)** \(\idx{Gram-Schmidt theorem}\xdi\) 设 \(\mathbf{a}_1,\ldots,\mathbf{a}_m\)
    是线性无关的。那么存在一个正交基 \(\mathbf{q}_1,\ldots,\mathbf{q}_m\)，它是 \(\mathrm{span}(\mathbf{a}_1,\ldots,\mathbf{a}_m)\)
    的基。 \(\sharp\)'
- en: But, first, we will need to define the orthogonal projection, which will play
    a key role in our applications. This is done next.
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 但是，首先，我们需要定义正交投影，这在我们的应用中将扮演关键角色。这将在下面完成。
- en: 2.3.2\. Orthogonal projection[#](#orthogonal-projection "Link to this heading")
  id: totrans-332
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.3.2\. 正交投影[#](#orthogonal-projection "链接到这个标题")
- en: To solve the overdetermined case, i.e., when \(n > m\), we consider the following
    more general problem first. We have a linear subspace \(U \subseteq \mathbb{R}^n\)
    and a vector \(\mathbf{v} \notin U\). We want to find the vector \(\mathbf{p}\)
    in \(U\) that is closest to \(\mathbf{v}\) in Euclidean norm, that is, we want
    to solve
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 要解决超定情况，即当 \(n > m\) 时，我们首先考虑以下更一般的问题。我们有一个线性子空间 \(U \subseteq \mathbb{R}^n\)
    和一个不在 \(U\) 中的向量 \(\mathbf{v}\)。我们想要找到 \(U\) 中与 \(\mathbf{v}\) 在欧几里得范数上最近的向量 \(\mathbf{p}\)，也就是说，我们想要求解
- en: \[ \min_{\mathbf{p} \in U} \|\mathbf{p} - \mathbf{v}\|. \]
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \min_{\mathbf{p} \in U} \|\mathbf{p} - \mathbf{v}\|. \]
- en: '**EXAMPLE:** Consider the two-dimensional case with a one-dimensional subspace,
    say \(U = \mathrm{span}(\mathbf{u}_1)\) with \(\|\mathbf{u}_1\|=1\). The geometrical
    intuition is in the following figure. The solution \(\mathbf{p} = \mathbf{v}^*\)
    has the property that the difference \(\mathbf{v} - \mathbf{v}^*\) makes a right
    angle with \(\mathbf{u}_1\), that is, it is orthogonal to it.'
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例：** 考虑二维情况，有一个一维子空间，例如 \(U = \mathrm{span}(\mathbf{u}_1)\)，其中 \(\|\mathbf{u}_1\|=1\)。几何直观如下图所示。解
    \(\mathbf{p} = \mathbf{v}^*\) 具有这样的性质，即 \(\mathbf{v} - \mathbf{v}^*\) 与 \(\mathbf{u}_1\)
    形成直角，即它与 \(\mathbf{u}_1\) 正交。'
- en: '![Orthogonal projection on a line (with help from ChatGPT and Claude; inspired
    by Source)](../Images/067d2c4143b5d805e9e1b2381a00c9db.png)'
  id: totrans-336
  prefs: []
  type: TYPE_IMG
  zh: '![在线性空间上的正交投影（得益于ChatGPT和Claude的帮助；灵感来源于来源）](../Images/067d2c4143b5d805e9e1b2381a00c9db.png)'
- en: Letting \(\mathbf{v}^* = \alpha^* \,\mathbf{u}_1\), the geometrical condition
    above translates into
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: 令 \(\mathbf{v}^* = \alpha^* \,\mathbf{u}_1\)，上述几何条件转化为
- en: \[ 0 = \langle \mathbf{u}_1, \mathbf{v} - \mathbf{v}^* \rangle = \langle \mathbf{u}_1,
    \mathbf{v} - \alpha^* \,\mathbf{u}_1 \rangle = \langle \mathbf{u}_1, \mathbf{v}
    \rangle - \alpha^* \,\langle \mathbf{u}_1, \mathbf{u}_1 \rangle = \langle \mathbf{u}_1,
    \mathbf{v} \rangle - \alpha^* \]
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 0 = \langle \mathbf{u}_1, \mathbf{v} - \mathbf{v}^* \rangle = \langle \mathbf{u}_1,
    \mathbf{v} - \alpha^* \,\mathbf{u}_1 \rangle = \langle \mathbf{u}_1, \mathbf{v}
    \rangle - \alpha^* \,\langle \mathbf{u}_1, \mathbf{u}_1 \rangle = \langle \mathbf{u}_1,
    \mathbf{v} \rangle - \alpha^* \]
- en: so
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 因此
- en: \[ \mathbf{v}^* = \langle \mathbf{u}_1, \mathbf{v} \rangle \,\mathbf{u}_1. \]
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{v}^* = \langle \mathbf{u}_1, \mathbf{v} \rangle \,\mathbf{u}_1. \]
- en: By *Pythagoras’ Theorem*, we then have for any \(\alpha \in \mathbb{R}\)
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 通过 **毕达哥拉斯定理**，我们得到对于任何 \(\alpha \in \mathbb{R}\)
- en: \[\begin{align*} \|\mathbf{v} - \alpha \,\mathbf{u}_1\|^2 &= \|\mathbf{v}- \mathbf{v}^*
    + \mathbf{v}^* - \alpha \,\mathbf{u}_1\|^2\\ &= \|\mathbf{v}- \mathbf{v}^* + (\alpha^*
    - \alpha) \,\mathbf{u}_1\|^2\\ &= \|\mathbf{v}- \mathbf{v}^*\|^2 + \| (\alpha^*
    - \alpha) \,\mathbf{u}_1\|^2\\ &\geq \|\mathbf{v}- \mathbf{v}^*\|^2, \end{align*}\]
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \|\mathbf{v} - \alpha \,\mathbf{u}_1\|^2 &= \|\mathbf{v}- \mathbf{v}^*
    + \mathbf{v}^* - \alpha \,\mathbf{u}_1\|^2\\ &= \|\mathbf{v}- \mathbf{v}^* + (\alpha^*
    - \alpha) \,\mathbf{u}_1\|^2\\ &= \|\mathbf{v}- \mathbf{v}^*\|^2 + \| (\alpha^*
    - \alpha) \,\mathbf{u}_1\|^2\\ &\geq \|\mathbf{v}- \mathbf{v}^*\|^2, \end{align*}\]
- en: where we used that \(\mathbf{v} - \mathbf{v}^*\) is orthogonal to \(\mathbf{u}_1\)
    (and therefore \((\alpha^* - \alpha) \mathbf{u}_1\)) on the third line.
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 其中我们在第三行使用了 \(\mathbf{v} - \mathbf{v}^*\) 与 \(\mathbf{u}_1\) 正交（因此与 \((\alpha^*
    - \alpha) \mathbf{u}_1\)）的事实。
- en: That confirms the optimality of \(\mathbf{v}^*\). The argument in this example
    carries through in higher dimension, as we show next. \(\lhd\)
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 这证实了 \(\mathbf{v}^*\) 的最优性。这个例子中的论证在更高维的情况下也成立，我们将在下文中展示。 \(\lhd\)
- en: '**DEFINITION** **(Orthogonal Projection on an Orthonormal List)** \(\idx{orthogonal
    projection on an orthonormal list}\xdi\) Let \(\mathbf{q}_1,\ldots,\mathbf{q}_m\)
    be an orthonormal list. The orthogonal projection of \(\mathbf{v} \in \mathbb{R}^n\)
    on \(\{\mathbf{q}_i\}_{i=1}^m\) is defined as'
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: '**定义** **（正交投影到正交列表）** \(\idx{orthogonal projection on an orthonormal list}\xdi\)
    设 \(\mathbf{q}_1,\ldots,\mathbf{q}_m\) 是一个正交列表。\(\mathbf{v} \in \mathbb{R}^n\)
    在 \(\{\mathbf{q}_i\}_{i=1}^m\) 上的正交投影定义为'
- en: \[ \mathrm{proj}_{\{\mathbf{q}_i\}_{i=1}^m} \mathbf{v} = \sum_{j=1}^m \langle
    \mathbf{v}, \mathbf{q}_j \rangle \,\mathbf{q}_j. \]
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathrm{proj}_{\{\mathbf{q}_i\}_{i=1}^m} \mathbf{v} = \sum_{j=1}^m \langle
    \mathbf{v}, \mathbf{q}_j \rangle \,\mathbf{q}_j. \]
- en: \(\natural\)
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: \(\natural\)
- en: '**THEOREM** **(Orthogonal Projection)** \(\idx{orthogonal projection theorem}\xdi\)
    Let \(U \subseteq V\) be a linear subspace and let \(\mathbf{v} \in \mathbb{R}^n\).
    Then:'
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: '**定理** **（正交投影）** \(\idx{orthogonal projection theorem}\xdi\) 设 \(U \subseteq
    V\) 是一个线性子空间，且 \(\mathbf{v} \in \mathbb{R}^n\)。那么：'
- en: a) There exists a unique solution \(\mathbf{p}^*\) to
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: a) 存在唯一的解 \(\mathbf{p}^*\) 满足
- en: \[ \min_{\mathbf{p} \in U} \|\mathbf{p} - \mathbf{v}\|. \]
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \min_{\mathbf{p} \in U} \|\mathbf{p} - \mathbf{v}\|. \]
- en: We denote it by \(\mathbf{p}^* = \mathrm{proj}_U \mathbf{v}\) and refer to it
    as the orthogonal projection of \(\mathbf{v}\) onto \(U\).
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 我们用 \(\mathbf{p}^* = \mathrm{proj}_U \mathbf{v}\) 表示它，并称其为 \(\mathbf{v}\) 投影到
    \(U\) 上的正交投影。
- en: b) The solution \(\mathbf{p}^* \in U\) is characterized geometrically by
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: b) 解 \(\mathbf{p}^* \in U\) 在几何上由
- en: \[ (*) \qquad \left\langle \mathbf{v} - \mathbf{p}^*, \mathbf{u}\right\rangle
    =0, \quad \forall \mathbf{u} \in U. \]
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: \[ (*) \qquad \left\langle \mathbf{v} - \mathbf{p}^*, \mathbf{u}\right\rangle
    =0, \quad \forall \mathbf{u} \in U. \]
- en: c) For any orthonormal basis \(\mathbf{q}_1,\ldots,\mathbf{q}_m\) of \(U\),
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: c) 对于 \(U\) 的任何正交归一基 \(\mathbf{q}_1,\ldots,\mathbf{q}_m\)，
- en: \[ \mathrm{proj}_U \mathbf{v} = \mathrm{proj}_{\{\mathbf{q}_i\}_{i=1}^m} \mathbf{v}.
    \]
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathrm{proj}_U \mathbf{v} = \mathrm{proj}_{\{\mathbf{q}_i\}_{i=1}^m} \mathbf{v}.
    \]
- en: \(\sharp\)
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: \(\sharp\)
- en: '*Proof:* Let \(\mathbf{p}^*\) be any vector in \(U\) satisfying \((*)\). We
    show first that it necessarily satisfies'
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明*: 设 \(\mathbf{p}^*\) 是 \(U\) 中满足 \((*)\) 的任意向量。我们首先证明它必然满足'
- en: \[ (**) \qquad \|\mathbf{p}^* - \mathbf{v}\| \leq \|\mathbf{p} - \mathbf{v}\|,
    \quad \forall \mathbf{p} \in U. \]
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: \[ (**) \qquad \|\mathbf{p}^* - \mathbf{v}\| \leq \|\mathbf{p} - \mathbf{v}\|,
    \quad \forall \mathbf{p} \in U. \]
- en: Note that for any \(\mathbf{p} \in U\) the vector \(\mathbf{u} = \mathbf{p}
    - \mathbf{p}^*\) is also in \(U\). Hence by \((*)\) and *Pythagoras*,
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，对于任何 \(\mathbf{p} \in U\)，向量 \(\mathbf{u} = \mathbf{p} - \mathbf{p}^*\) 也属于
    \(U\)。因此，根据 \((*)\) 和 *毕达哥拉斯* 定理，
- en: \[\begin{align*} \|\mathbf{p} - \mathbf{v}\|^2 &= \|\mathbf{p} - \mathbf{p}^*
    + \mathbf{p}^* - \mathbf{v}\|^2\\ &= \|\mathbf{p} - \mathbf{p}^*\|^2 + \|\mathbf{p}^*
    - \mathbf{v}\|^2\\ &\geq \|\mathbf{p}^* - \mathbf{v}\|^2. \end{align*}\]
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \|\mathbf{p} - \mathbf{v}\|^2 &= \|\mathbf{p} - \mathbf{p}^*
    + \mathbf{p}^* - \mathbf{v}\|^2\\ &= \|\mathbf{p} - \mathbf{p}^*\|^2 + \|\mathbf{p}^*
    - \mathbf{v}\|^2\\ &\geq \|\mathbf{p}^* - \mathbf{v}\|^2. \end{align*}\]
- en: Furthermore, equality holds only if \(\|\mathbf{p} - \mathbf{p}^*\|^2 = 0\)
    which holds only if \(\mathbf{p} = \mathbf{p}^*\) by the point-separating property
    of the Euclidean norm. Hence, if such a vector \(\mathbf{p}^*\) exists, it is
    unique.
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，等式仅在 \(\|\mathbf{p} - \mathbf{p}^*\|^2 = 0\) 时成立，这仅在 \(\mathbf{p} = \mathbf{p}^*\)
    时成立，这是由欧几里得范数的点分离性质决定的。因此，如果这样的向量 \(\mathbf{p}^*\) 存在，它是唯一的。
- en: 'Next, we show that any minimizer must satisfy \((*)\). Let \(\mathbf{p}^*\)
    be a minimizer and suppose, for contradiction, that \((*)\) does not hold. Then
    there exists \(\mathbf{u} \in U\) with \(\langle \mathbf{v} - \mathbf{p}^*, \mathbf{u}
    \rangle = c \neq 0\). Consider \(\mathbf{p}_t = \mathbf{p}^* + t\mathbf{u}\) for
    small \(t\). Then:'
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们证明任何最小化值必须满足 \((*)\)。设 \(\mathbf{p}^*\) 是一个最小化值，假设，为了矛盾，\((*)\) 不成立。那么存在
    \(\mathbf{u} \in U\)，使得 \(\langle \mathbf{v} - \mathbf{p}^*, \mathbf{u} \rangle
    = c \neq 0\)。考虑 \(\mathbf{p}_t = \mathbf{p}^* + t\mathbf{u}\) 对于小的 \(t\)。那么：
- en: \[\begin{align*} \|\mathbf{p}_t - \mathbf{v}\|^2 &= \|(\mathbf{p}^* - \mathbf{v})
    + t\mathbf{u}\|^2\\ &= \|\mathbf{p}^* - \mathbf{v}\|^2 + 2t\langle \mathbf{v}
    - \mathbf{p}^*, \mathbf{u} \rangle + t^2\|\mathbf{u}\|^2\\ &= \|\mathbf{p}^* -
    \mathbf{v}\|^2 + 2tc + t^2\|\mathbf{u}\|^2. \end{align*}\]
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \|\mathbf{p}_t - \mathbf{v}\|^2 &= \|(\mathbf{p}^* - \mathbf{v})
    + t\mathbf{u}\|^2\\ &= \|\mathbf{p}^* - \mathbf{v}\|^2 + 2t\langle \mathbf{v}
    - \mathbf{p}^*, \mathbf{u} \rangle + t^2\|\mathbf{u}\|^2\\ &= \|\mathbf{p}^* -
    \mathbf{v}\|^2 + 2tc + t^2\|\mathbf{u}\|^2. \end{align*}\]
- en: For small \(t\) with appropriate sign, this is smaller than \(\|\mathbf{p}^*
    - \mathbf{v}\|^2\), contradicting minimality.
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 对于小的 \(t\) 和适当的符号，这比 \(\|\mathbf{p}^* - \mathbf{v}\|^2\) 小，这与最小性相矛盾。
- en: It remains to show that there is at least one vector in \(U\) satisfying \((*)\).
    By the *Gram-Schmidt Theorem*, the linear subspace \(U\) has an orthonormal basis
    \(\mathbf{q}_1,\ldots,\mathbf{q}_m\). By definition, \(\mathrm{proj}_{\{\mathbf{q}_i\}_{i=1}^m}
    \mathbf{v} \in \mathrm{span}(\{\mathbf{q}_i\}_{i=1}^m) = U\). We show that \(\mathrm{proj}_{\{\mathbf{q}_i\}_{i=1}^m}
    \mathbf{v}\) satisfies \((*)\). We can write any \(\mathbf{u} \in U\) as \(\sum_{i=1}^m
    \alpha_i \mathbf{q}_i\) with \(\alpha_i = \langle \mathbf{u}, \mathbf{q}_i \rangle\).
    So, using this representation, we get
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: 剩下要证明至少存在一个向量在 \(U\) 中满足 \((*)\)。根据 *格拉姆-施密特定理*，线性子空间 \(U\) 有一个正交归一基 \(\mathbf{q}_1,\ldots,\mathbf{q}_m\)。根据定义，\(\mathrm{proj}_{\{\mathbf{q}_i\}_{i=1}^m}
    \mathbf{v} \in \mathrm{span}(\{\mathbf{q}_i\}_{i=1}^m) = U\)。我们证明 \(\mathrm{proj}_{\{\mathbf{q}_i\}_{i=1}^m}
    \mathbf{v}\) 满足 \((*)\)。我们可以将任何 \(\mathbf{u} \in U\) 写成 \(\sum_{i=1}^m \alpha_i
    \mathbf{q}_i\)，其中 \(\alpha_i = \langle \mathbf{u}, \mathbf{q}_i \rangle\)。所以，使用这种表示，我们得到
- en: \[\begin{align*} \left\langle \mathbf{v} - \sum_{j=1}^m \langle \mathbf{v},
    \mathbf{q}_j \rangle \,\mathbf{q}_j, \sum_{i=1}^m \alpha_i \mathbf{q}_i \right\rangle
    &= \sum_{i=1}^m \langle \mathbf{v}, \mathbf{q}_i \rangle \,\alpha_i - \sum_{j=1}^m
    \sum_{i=1}^m \alpha_i \langle \mathbf{v}, \mathbf{q}_j \rangle \langle \mathbf{q}_j,
    \mathbf{q}_i \rangle\\ &= \sum_{i=1}^m \langle \mathbf{v}, \mathbf{q}_i \rangle
    \,\alpha_i - \sum_{j=1}^m \alpha_j \langle \mathbf{v}, \mathbf{q}_j \rangle\\
    &= 0, \end{align*}\]
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \left\langle \mathbf{v} - \sum_{j=1}^m \langle \mathbf{v},
    \mathbf{q}_j \rangle \,\mathbf{q}_j, \sum_{i=1}^m \alpha_i \mathbf{q}_i \right\rangle
    &= \sum_{i=1}^m \langle \mathbf{v}, \mathbf{q}_i \rangle \,\alpha_i - \sum_{j=1}^m
    \sum_{i=1}^m \alpha_i \langle \mathbf{v}, \mathbf{q}_j \rangle \langle \mathbf{q}_j,
    \mathbf{q}_i \rangle\\ &= \sum_{i=1}^m \langle \mathbf{v}, \mathbf{q}_i \rangle
    \,\alpha_i - \sum_{j=1}^m \alpha_j \langle \mathbf{v}, \mathbf{q}_j \rangle\\
    &= 0, \end{align*}\]
- en: where we used the orthonormality of the \(\mathbf{q}_j\)’s on the second line.
    \(\square\)
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: 其中我们在第二行使用了 \(\mathbf{q}_j\) 的正交性。 \(\square\)
- en: '**EXAMPLE:** **(continued)** Consider again the linear subspace \(W = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3)\),
    where \(\mathbf{w}_1 = (1,0,1)\), \(\mathbf{w}_2 = (0,1,1)\), and \(\mathbf{w}_3
    = (1,-1,0)\). We have shown that'
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例：** **（继续）** 再次考虑线性子空间 \(W = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3)\)，其中
    \(\mathbf{w}_1 = (1,0,1)\)，\(\mathbf{w}_2 = (0,1,1)\)，和 \(\mathbf{w}_3 = (1,-1,0)\)。我们已经证明'
- en: \[\begin{split} \mathbf{q}_1 = \frac{1}{\sqrt{2}} \begin{pmatrix} 1\\ 0\\ 1
    \end{pmatrix}, \quad \mathbf{q}_2 = \frac{1}{\sqrt{6}} \begin{pmatrix} -1\\ 2\\
    1 \end{pmatrix}, \end{split}\]
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{q}_1 = \frac{1}{\sqrt{2}} \begin{pmatrix} 1\\ 0\\ 1
    \end{pmatrix}, \quad \mathbf{q}_2 = \frac{1}{\sqrt{6}} \begin{pmatrix} -1\\ 2\\
    1 \end{pmatrix}, \end{split}\]
- en: is an orthonormal basis. Let \(\mathbf{w}_4 = (0,0,2)\). It is immediate that
    \(\mathbf{w}_4 \notin \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2)\) since vectors
    in that span are of the form \((x,y,x+y)\) for some \(x,y \in \mathbb{R}\).
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: 是一个正交基。设 \(\mathbf{w}_4 = (0,0,2)\). 显然，\(\mathbf{w}_4 \notin \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2)\)，因为该张量中的向量形式为
    \((x,y,x+y)\)，其中 \(x,y \in \mathbb{R}\)。
- en: We can however compute the orthogonal projection \(\mathbf{w}_4\) onto \(W\).
    The inner products are
  id: totrans-371
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以计算 \(W\) 上的正交投影 \(\mathbf{w}_4\). 内积如下
- en: \[ \langle \mathbf{w}_4, \mathbf{q}_1 \rangle = 0 \left(\frac{1}{\sqrt{2}}\right)
    + 0 \left(\frac{0}{\sqrt{2}}\right) + 2 \left(\frac{1}{\sqrt{2}}\right) = \frac{2}{\sqrt{2}},
    \]\[ \langle \mathbf{w}_4, \mathbf{q}_2 \rangle = 0 \left(-\frac{1}{\sqrt{6}}\right)
    + 0 \left(\frac{2}{\sqrt{6}}\right) + 2 \left(\frac{1}{\sqrt{6}}\right) = \frac{2}{\sqrt{6}}.
    \]
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \langle \mathbf{w}_4, \mathbf{q}_1 \rangle = 0 \left(\frac{1}{\sqrt{2}}\right)
    + 0 \left(\frac{0}{\sqrt{2}}\right) + 2 \left(\frac{1}{\sqrt{2}}\right) = \frac{2}{\sqrt{2}},
    \]\[ \langle \mathbf{w}_4, \mathbf{q}_2 \rangle = 0 \left(-\frac{1}{\sqrt{6}}\right)
    + 0 \left(\frac{2}{\sqrt{6}}\right) + 2 \left(\frac{1}{\sqrt{6}}\right) = \frac{2}{\sqrt{6}}.
    \]
- en: So
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: 因此
- en: \[\begin{split} \mathrm{proj}_W \mathbf{w}_4 = \frac{2}{\sqrt{2}} \mathbf{q}_1
    + \frac{2}{\sqrt{6}} \mathbf{q}_2 = \begin{pmatrix} 2/3\\ 2/3\\ 4/3 \end{pmatrix}.
    \end{split}\]
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathrm{proj}_W \mathbf{w}_4 = \frac{2}{\sqrt{2}} \mathbf{q}_1
    + \frac{2}{\sqrt{6}} \mathbf{q}_2 = \begin{pmatrix} 2/3\\ 2/3\\ 4/3 \end{pmatrix}.
    \end{split}\]
- en: As a sanity check, note that \(\mathbf{w}_4 \in W\) since its third entry is
    equal to the sum of its first two entries. \(\lhd\)
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: 作为合理性检查，请注意，\(\mathbf{w}_4 \in W\)，因为它的第三个元素等于前两个元素的和。 \(\lhd\)
- en: The map \(\mathrm{proj}_U\) is linear, that is, \(\mathrm{proj}_U (\alpha \,\mathbf{x}
    + \mathbf{y}) = \alpha \,\mathrm{proj}_U \mathbf{x} + \mathrm{proj}_U\mathbf{y}\)
    for all \(\alpha \in \mathbb{R}\) and \(\mathbf{x}, \mathbf{y} \in \mathbb{R}^n\).
    Indeed,
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: 映射 \(\mathrm{proj}_U\) 是线性的，即对于所有 \(\alpha \in \mathbb{R}\) 和 \(\mathbf{x},
    \mathbf{y} \in \mathbb{R}^n\)，有 \(\mathrm{proj}_U (\alpha \,\mathbf{x} + \mathbf{y})
    = \alpha \,\mathrm{proj}_U \mathbf{x} + \mathrm{proj}_U\mathbf{y}\)。实际上，
- en: \[\begin{align*} \mathrm{proj}_U(\alpha \,\mathbf{x} + \mathbf{y}) &= \sum_{j=1}^m
    \langle \alpha \,\mathbf{x} + \mathbf{y}, \mathbf{q}_j \rangle \,\mathbf{q}_j\\
    &= \sum_{j=1}^m \left\{\alpha \, \langle \mathbf{x}, \mathbf{q}_j \rangle + \langle
    \mathbf{y}, \mathbf{q}_j \rangle\right\} \mathbf{q}_j\\ &= \alpha \,\mathrm{proj}_U
    \mathbf{x} + \mathrm{proj}_U \mathbf{y}. \end{align*}\]
  id: totrans-377
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \mathrm{proj}_U(\alpha \,\mathbf{x} + \mathbf{y}) &= \sum_{j=1}^m
    \langle \alpha \,\mathbf{x} + \mathbf{y}, \mathbf{q}_j \rangle \,\mathbf{q}_j\\
    &= \sum_{j=1}^m \left\{\alpha \, \langle \mathbf{x}, \mathbf{q}_j \rangle + \langle
    \mathbf{y}, \mathbf{q}_j \rangle\right\} \mathbf{q}_j\\ &= \alpha \,\mathrm{proj}_U
    \mathbf{x} + \mathrm{proj}_U \mathbf{y}. \end{align*}\]
- en: Any linear map from \(\mathbb{R}^n\) to \(\mathbb{R}^n\) can be encoded as an
    \(n \times n\) matrix \(P\).
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: 从 \(\mathbb{R}^n\) 到 \(\mathbb{R}^n\) 的任何线性映射都可以编码为一个 \(n \times n\) 矩阵 \(P\)。
- en: Let
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: 设
- en: \[\begin{split} Q = \begin{pmatrix} | & & | \\ \mathbf{q}_1 & \ldots & \mathbf{q}_m
    \\ | & & | \end{pmatrix} \end{split}\]
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} Q = \begin{pmatrix} | & & | \\ \mathbf{q}_1 & \ldots & \mathbf{q}_m
    \\ | & & | \end{pmatrix} \end{split}\]
- en: and note that computing
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: 并注意计算
- en: \[\begin{split} Q^T \mathbf{v} = \begin{pmatrix} \langle \mathbf{v}, \mathbf{q}_1
    \rangle \\ \cdots \\ \langle \mathbf{v}, \mathbf{q}_m \rangle \end{pmatrix} \end{split}\]
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} Q^T \mathbf{v} = \begin{pmatrix} \langle \mathbf{v}, \mathbf{q}_1
    \rangle \\ \cdots \\ \langle \mathbf{v}, \mathbf{q}_m \rangle \end{pmatrix} \end{split}\]
- en: lists the coefficients in the expansion of \(\mathrm{proj}_U \mathbf{v}\) over
    the basis \(\mathbf{q}_1,\ldots,\mathbf{q}_m\).
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: 列出了 \(\mathrm{proj}_U \mathbf{v}\) 在基 \(\mathbf{q}_1,\ldots,\mathbf{q}_m\) 上的展开式中的系数。
- en: Hence we see that
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们看到
- en: \[ P = Q Q^T. \]
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: \[ P = Q Q^T. \]
- en: Indeed, for any vector \(\mathbf{v}\),
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: 的确，对于任何向量 \(\mathbf{v}\)，
- en: \[ P \mathbf{v} = Q Q^T \mathbf{v} = Q [Q^T \mathbf{v}]. \]
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: \[ P \mathbf{v} = Q Q^T \mathbf{v} = Q [Q^T \mathbf{v}]. \]
- en: So the output is a linear combination of the columns of \(Q\) (i.e., the \(\mathbf{q}_i\)’s)
    where the coefficients are the entries of the vector in square brackets \(Q^T
    \mathbf{v}\).
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，输出是 \(Q\) 的列（即 \(\mathbf{q}_i\)）的线性组合，其中系数是方括号中向量的条目 \(Q^T \mathbf{v}\)。
- en: '**EXAMPLE:** **(continued)** Consider again the linear subspace \(W = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3)\),
    where \(\mathbf{w}_1 = (1,0,1)\), \(\mathbf{w}_2 = (0,1,1)\), and \(\mathbf{w}_3
    = (1,-1,0)\), with orthonormal basis'
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例：** **（继续）** 再次考虑线性子空间 \(W = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3)\)，其中
    \(\mathbf{w}_1 = (1,0,1)\)，\(\mathbf{w}_2 = (0,1,1)\)，和 \(\mathbf{w}_3 = (1,-1,0)\)，具有正交归一基'
- en: \[\begin{split} \mathbf{q}_1 = \frac{1}{\sqrt{2}} \begin{pmatrix} 1\\ 0\\ 1
    \end{pmatrix}, \quad \mathbf{q}_2 = \frac{1}{\sqrt{6}} \begin{pmatrix} -1\\ 2\\
    1 \end{pmatrix}. \end{split}\]
  id: totrans-390
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{q}_1 = \frac{1}{\sqrt{2}} \begin{pmatrix} 1\\ 0\\ 1
    \end{pmatrix}, \quad \mathbf{q}_2 = \frac{1}{\sqrt{6}} \begin{pmatrix} -1\\ 2\\
    1 \end{pmatrix}. \end{split}\]
- en: Then orthogonal projection onto \(W\) can be written in matrix form as follows.
    The matrix \(Q\) is
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，\(W\) 上的正交投影可以写成以下矩阵形式。矩阵 \(Q\) 是
- en: \[\begin{split} Q = \begin{pmatrix} 1/\sqrt{2} & -1/\sqrt{6}\\ 0 & 2/\sqrt{6}\\
    1/\sqrt{2} & 1/\sqrt{6} \end{pmatrix}. \end{split}\]
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} Q = \begin{pmatrix} 1/\sqrt{2} & -1/\sqrt{6}\\ 0 & 2/\sqrt{6}\\
    1/\sqrt{2} & 1/\sqrt{6} \end{pmatrix}. \end{split}\]
- en: Then
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
  zh: 然后
- en: \[\begin{align*} Q Q^T &= \begin{pmatrix} 1/\sqrt{2} & -1/\sqrt{6}\\ 0 & 2/\sqrt{6}\\
    1/\sqrt{2} & 1/\sqrt{6} \end{pmatrix} \begin{pmatrix} 1/\sqrt{2} & 0 & 1/\sqrt{2}\\
    -1/\sqrt{6} & 2/\sqrt{6} & 1/\sqrt{6} \end{pmatrix}\\ &= \begin{pmatrix} 2/3 &
    -1/3 & 1/3\\ -1/3 & 2/3 & 1/3\\ 1/3 & 1/3 & 2/3 \end{pmatrix}. \end{align*}\]
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} Q Q^T &= \begin{pmatrix} 1/\sqrt{2} & -1/\sqrt{6}\\ 0 & 2/\sqrt{6}\\
    1/\sqrt{2} & 1/\sqrt{6} \end{pmatrix} \begin{pmatrix} 1/\sqrt{2} & 0 & 1/\sqrt{2}\\
    -1/\sqrt{6} & 2/\sqrt{6} & 1/\sqrt{6} \end{pmatrix}\\ &= \begin{pmatrix} 2/3 &
    -1/3 & 1/3\\ -1/3 & 2/3 & 1/3\\ 1/3 & 1/3 & 2/3 \end{pmatrix}. \end{align*}\]
- en: So the projection of \(\mathbf{w}_4 = (0,0,2)\) is
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，\(\mathbf{w}_4 = (0,0,2)\) 的投影是
- en: \[\begin{split} \begin{pmatrix} 2/3 & -1/3 & 1/3\\ -1/3 & 2/3 & 1/3\\ 1/3 &
    1/3 & 2/3 \end{pmatrix} \begin{pmatrix} 0\\ 0\\ 2 \end{pmatrix} = \begin{pmatrix}
    2/3\\ 2/3\\ 4/3 \end{pmatrix}, \end{split}\]
  id: totrans-396
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} 2/3 & -1/3 & 1/3\\ -1/3 & 2/3 & 1/3\\ 1/3 &
    1/3 & 2/3 \end{pmatrix} \begin{pmatrix} 0\\ 0\\ 2 \end{pmatrix} = \begin{pmatrix}
    2/3\\ 2/3\\ 4/3 \end{pmatrix}, \end{split}\]
- en: as previously computed. \(\lhd\)
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述计算。\(\lhd\)
- en: The matrix \(P= Q Q^T\) is not to be confused with
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
  zh: 矩阵 \(P= Q Q^T\) 不要与
- en: \[\begin{split} Q^T Q = \begin{pmatrix} \langle \mathbf{q}_1, \mathbf{q}_1 \rangle
    & \cdots & \langle \mathbf{q}_1, \mathbf{q}_m \rangle \\ \langle \mathbf{q}_2,
    \mathbf{q}_1 \rangle & \cdots & \langle \mathbf{q}_2, \mathbf{q}_m \rangle \\
    \vdots & \ddots & \vdots \\ \langle \mathbf{q}_m, \mathbf{q}_1 \rangle & \cdots
    & \langle \mathbf{q}_m, \mathbf{q}_m \rangle \end{pmatrix} = I_{m \times m} \end{split}\]
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} Q^T Q = \begin{pmatrix} \langle \mathbf{q}_1, \mathbf{q}_1 \rangle
    & \cdots & \langle \mathbf{q}_1, \mathbf{q}_m \rangle \\ \langle \mathbf{q}_2,
    \mathbf{q}_1 \rangle & \cdots & \langle \mathbf{q}_2, \mathbf{q}_m \rangle \\
    \vdots & \ddots & \vdots \\ \langle \mathbf{q}_m, \mathbf{q}_1 \rangle & \cdots
    & \langle \mathbf{q}_m, \mathbf{q}_m \rangle \end{pmatrix} = I_{m \times m} \end{split}\]
- en: where \(I_{m \times m}\) denotes the \(m \times m\) identity matrix. This follows
    from the fact that the \(\mathbf{q}_i\)’s are orthonormal.
  id: totrans-400
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(I_{m \times m}\) 表示 \(m \times m\) 的单位矩阵。这是由于 \(\mathbf{q}_i\) 是正交归一的事实。
- en: '**EXAMPLE:** Let \(\mathbf{q}_1,\ldots,\mathbf{q}_n\) be an orthonormal basis
    of \(\mathbb{R}^n\) and form the matrix'
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例：** 设 \(\mathbf{q}_1,\ldots,\mathbf{q}_n\) 是 \(\mathbb{R}^n\) 的一个正交归一基，并形成矩阵'
- en: \[\begin{split} Q = \begin{pmatrix} | & & | \\ \mathbf{q}_1 & \ldots & \mathbf{q}_n
    \\ | & & | \end{pmatrix}. \end{split}\]
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} Q = \begin{pmatrix} | & & | \\ \mathbf{q}_1 & \ldots & \mathbf{q}_n
    \\ | & & | \end{pmatrix}. \end{split}\]
- en: We show that \(Q^{-1} = Q^T\).
  id: totrans-403
  prefs: []
  type: TYPE_NORMAL
  zh: 我们证明 \(Q^{-1} = Q^T\)。
- en: We just pointed out that
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: 我们刚才指出，
- en: \[\begin{split} Q^T Q = \begin{pmatrix} \langle \mathbf{q}_1, \mathbf{q}_1 \rangle
    & \cdots & \langle \mathbf{q}_1, \mathbf{q}_n \rangle \\ \langle \mathbf{q}_2,
    \mathbf{q}_1 \rangle & \cdots & \langle \mathbf{q}_2, \mathbf{q}_n \rangle \\
    \vdots & \ddots & \vdots \\ \langle \mathbf{q}_n, \mathbf{q}_1 \rangle & \cdots
    & \langle \mathbf{q}_n, \mathbf{q}_n \rangle \end{pmatrix} = I_{n \times n} \end{split}\]
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} Q^T Q = \begin{pmatrix} \langle \mathbf{q}_1, \mathbf{q}_1 \rangle
    & \cdots & \langle \mathbf{q}_1, \mathbf{q}_n \rangle \\ \langle \mathbf{q}_2,
    \mathbf{q}_1 \rangle & \cdots & \langle \mathbf{q}_2, \mathbf{q}_n \rangle \\
    \vdots & \ddots & \vdots \\ \langle \mathbf{q}_n, \mathbf{q}_1 \rangle & \cdots
    & \langle \mathbf{q}_n, \mathbf{q}_n \rangle \end{pmatrix} = I_{n \times n} \end{split}\]
- en: where \(I_{n \times n}\) denotes the \(n \times n\) identity matrix.
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(I_{n \times n}\) 表示 \(n \times n\) 的单位矩阵。
- en: In the other direction, we claim that \(Q Q^T = I_{n \times n}\) as well. Indeed
    the matrix \(Q Q^T\) is the orthogonal projection on the span of the \(\mathbf{q}_i\)’s,
    that is, \(\mathbb{R}^n\). By the *Orthogonal Projection Theorem*, the orthogonal
    projection \(Q Q^T \mathbf{v}\) finds the closest vector to \(\mathbf{v}\) in
    the span of the \(\mathbf{q}_i\)’s. But that span contains all vectors, including
    \(\mathbf{v}\), so we must have \(Q Q^T \mathbf{v} = \mathbf{v}\). Since this
    holds for all \(\mathbf{v} \in \mathbb{R}^n\), the matrix \(Q Q^T\) is the identity
    map and we have proved the claim. \(\lhd\)
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
  zh: 在相反的方向上，我们断言 \(Q Q^T = I_{n \times n}\) 也成立。实际上，矩阵 \(Q Q^T\) 是 \(\mathbf{q}_i\)
    的张成的正交投影，即 \(\mathbb{R}^n\)。根据**正交投影定理**，正交投影 \(Q Q^T \mathbf{v}\) 找到 \(\mathbf{v}\)
    在 \(\mathbf{q}_i\) 的张成中的最近向量。但是这个张成包含所有向量，包括 \(\mathbf{v}\)，因此我们必须有 \(Q Q^T \mathbf{v}
    = \mathbf{v}\)。由于这对所有 \(\mathbf{v} \in \mathbb{R}^n\) 都成立，矩阵 \(Q Q^T\) 是恒等映射，我们证明了这个断言。\(\lhd\)
- en: Matrices that satisfy
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
  zh: 满足
- en: \[ Q^T Q = Q Q^T = I_{n \times n} \]
  id: totrans-409
  prefs: []
  type: TYPE_NORMAL
  zh: \[ Q^T Q = Q Q^T = I_{n \times n} \]
- en: are called orthogonal matrices.
  id: totrans-410
  prefs: []
  type: TYPE_NORMAL
  zh: 的矩阵称为正交矩阵。
- en: '**DEFINITION** **(Orthogonal Matrix)** \(\idx{orthogonal matrix}\xdi\) A square
    matrix \(Q \in \mathbb{R}^{m\times m}\) is orthogonal if \(Q^T Q = Q Q^T = I_{m
    \times m}\). \(\natural\)'
  id: totrans-411
  prefs: []
  type: TYPE_NORMAL
  zh: '**定义** **(正交矩阵)** \(\idx{orthogonal matrix}\xdi\) 一个方阵 \(Q \in \mathbb{R}^{m\times
    m}\) 是正交的，如果 \(Q^T Q = Q Q^T = I_{m \times m}\)。\(\natural\)'
- en: '**KNOWLEDGE CHECK:** Let \(\mathcal{Z}\) be a linear subspace of \(\mathbb{R}^n\)
    and let \(\mathbf{v} \in \mathbb{R}^n\). Show that'
  id: totrans-412
  prefs: []
  type: TYPE_NORMAL
  zh: '**知识检查:** 设 \(\mathcal{Z}\) 是 \(\mathbb{R}^n\) 的一个线性子空间，且 \(\mathbf{v} \in
    \mathbb{R}^n\)。证明'
- en: \[ \|\mathrm{proj}_{\mathcal{Z}}\mathbf{v}\|_2 \leq \|\mathbf{v}\|_2. \]
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \|\mathrm{proj}_{\mathcal{Z}}\mathbf{v}\|_2 \leq \|\mathbf{v}\|_2. \]
- en: '[*Hint:* Use the geometric characterization.] \(\checkmark\)'
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
  zh: '[*提示:* 使用几何特征。] \(\checkmark\)'
- en: 2.3.3\. Orthogonal complement[#](#orthogonal-complement "Link to this heading")
  id: totrans-415
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.3.3\. 正交补[#](#orthogonal-complement "链接到本标题")
- en: Before returning to overdetermined systems, we take a little detour to derive
    a consequence of the orthogonal projection that will be useful later. The *Orthogonal
    Projection Theorem* implies that any \(\mathbf{v} \in \mathbb{R}^n\) can be decomposed
    into its orthogonal projection onto \(U\) and a vector orthogonal to it.
  id: totrans-416
  prefs: []
  type: TYPE_NORMAL
  zh: 在返回到超定系统之前，我们稍微偏离一下，推导出正交投影的一个后果，这个后果以后会很有用。**正交投影定理**表明，任何 \(\mathbf{v} \in
    \mathbb{R}^n\) 都可以分解为其在 \(U\) 上的正交投影和一个与它正交的向量。
- en: '**DEFINITION** **(Orthogonal Complement)** \(\idx{orthogonal complement}\xdi\)
    Let \(U \subseteq \mathbb{R}^n\) be a linear subspace. The orthogonal complement
    of \(U\), denoted \(U^\perp\), is defined as'
  id: totrans-417
  prefs: []
  type: TYPE_NORMAL
  zh: '**定义** **(正交补)** \(\idx{orthogonal complement}\xdi\) 设 \(U \subseteq \mathbb{R}^n\)
    是一个线性子空间。\(U\) 的正交补，记为 \(U^\perp\)，定义为'
- en: \[ U^\perp = \{\mathbf{w} \in \mathbb{R}^n\,:\, \langle \mathbf{w}, \mathbf{u}\rangle
    = 0, \forall \mathbf{u} \in U\}. \]
  id: totrans-418
  prefs: []
  type: TYPE_NORMAL
  zh: \[ U^\perp = \{\mathbf{w} \in \mathbb{R}^n\,:\, \langle \mathbf{w}, \mathbf{u}\rangle
    = 0, \forall \mathbf{u} \in U\}. \]
- en: \(\natural\)
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: \(\natural\)
- en: '**EXAMPLE:** Continuing a previous example, we compute the orthogonal complement
    of the linear subspace \(W = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3)\),
    where \(\mathbf{w}_1 = (1,0,1)\), \(\mathbf{w}_2 = (0,1,1)\), and \(\mathbf{w}_3
    = (1,-1,0)\). One way to proceed is to find all vectors that are orthogonal to
    the orthonormal basis'
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例:** 继续上一个例子，我们计算线性子空间 \(W = \mathrm{span}(\mathbf{w}_1,\mathbf{w}_2,\mathbf{w}_3)\)
    的正交补，其中 \(\mathbf{w}_1 = (1,0,1)\)，\(\mathbf{w}_2 = (0,1,1)\)，和 \(\mathbf{w}_3
    = (1,-1,0)\)。一种方法是找到所有与正交基'
- en: \[\begin{split} \mathbf{q}_1 = \frac{1}{\sqrt{2}} \begin{pmatrix} 1\\ 0\\ 1
    \end{pmatrix}, \quad \mathbf{q}_2 = \frac{1}{\sqrt{6}} \begin{pmatrix} -1\\ 2\\
    1 \end{pmatrix}. \end{split}\]
  id: totrans-421
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{q}_1 = \frac{1}{\sqrt{2}} \begin{pmatrix} 1\\ 0\\ 1
    \end{pmatrix}, \quad \mathbf{q}_2 = \frac{1}{\sqrt{6}} \begin{pmatrix} -1\\ 2\\
    1 \end{pmatrix}. \end{split}\]
- en: We require
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要
- en: \[ 0 = \langle \mathbf{u}, \mathbf{q}_1 \rangle = u_1 \left(\frac{1}{\sqrt{2}}\right)
    + u_2 \left(\frac{0}{\sqrt{2}}\right) + u_3 \left(\frac{1}{\sqrt{2}}\right) =
    \frac{u_1 + u_3}{\sqrt{2}}, \]\[ 0= \langle \mathbf{u}, \mathbf{q}_2 \rangle =
    u_1 \left(-\frac{1}{\sqrt{6}}\right) + u_2 \left(\frac{2}{\sqrt{6}}\right) + u_3
    \left(\frac{1}{\sqrt{6}}\right) = \frac{-u_1 + 2 u_2 + u_3}{\sqrt{6}}. \]
  id: totrans-423
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 0 = \langle \mathbf{u}, \mathbf{q}_1 \rangle = u_1 \left(\frac{1}{\sqrt{2}}\right)
    + u_2 \left(\frac{0}{\sqrt{2}}\right) + u_3 \left(\frac{1}{\sqrt{2}}\right) =
    \frac{u_1 + u_3}{\sqrt{2}}, \]\[ 0= \langle \mathbf{u}, \mathbf{q}_2 \rangle =
    u_1 \left(-\frac{1}{\sqrt{6}}\right) + u_2 \left(\frac{2}{\sqrt{6}}\right) + u_3
    \left(\frac{1}{\sqrt{6}}\right) = \frac{-u_1 + 2 u_2 + u_3}{\sqrt{6}}. \]
- en: The first equation implies \(u_3 = -u_1\), which after replacing into the second
    equation and rearranging gives \(u_2 = u_1\).
  id: totrans-424
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个方程意味着 \(u_3 = -u_1\)，将此代入第二个方程并重新排列后得到 \(u_2 = u_1\)。
- en: So all vectors of the form \((u_1,u_1,-u_1)\) for some \(u_1 \in \mathbb{R}\)
    are orthogonal to all of \(W\). This is a one-dimensional linear subspace. We
    can choose an orthonormal basis by finding a solution to
  id: totrans-425
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，所有形式为 \((u_1,u_1,-u_1)\) 的向量，其中 \(u_1 \in \mathbb{R}\)，都与 \(W\) 正交。这是一个一维线性子空间。我们可以通过找到一个解来选择一个正交基
- en: \[ 1 = (u_1)^2 + (u_1)^2 + (-u_1)^2 = 3 u_1^2, \]
  id: totrans-426
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 1 = (u_1)^2 + (u_1)^2 + (-u_1)^2 = 3 u_1^2, \]
- en: Take \(u_1 = 1/\sqrt{3}\), that is, let
  id: totrans-427
  prefs: []
  type: TYPE_NORMAL
  zh: 取 \(u_1 = 1/\sqrt{3}\)，即
- en: \[\begin{split} \mathbf{q}_3 = \frac{1}{\sqrt{3}} \begin{pmatrix} 1\\ 1\\ -1
    \end{pmatrix}. \end{split}\]
  id: totrans-428
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{q}_3 = \frac{1}{\sqrt{3}} \begin{pmatrix} 1\\ 1\\ -1
    \end{pmatrix}. \end{split}\]
- en: Then we have
  id: totrans-429
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们有
- en: \[ W^\perp = \mathrm{span}(\mathbf{q}_3). \]
  id: totrans-430
  prefs: []
  type: TYPE_NORMAL
  zh: \[ W^\perp = \mathrm{span}(\mathbf{q}_3). \]
- en: \(\lhd\)
  id: totrans-431
  prefs: []
  type: TYPE_NORMAL
  zh: \(\lhd\)
- en: '**LEMMA** **(Orthogonal Decomposition)** \(\idx{orthogonal decomposition lemma}\xdi\)
    Let \(U \subseteq \mathbb{R}^n\) be a linear subspace and let \(\mathbf{v} \in
    \mathbb{R}^n\). Then \(\mathbf{v}\) can be decomposed as \(\mathrm{proj}_U \mathbf{v}
    + (\mathbf{v} - \mathrm{proj}_U\mathbf{v})\) where \(\mathrm{proj}_U \mathbf{v}
    \in U\) and \((\mathbf{v} - \mathrm{proj}_U \mathbf{v}) \in U^\perp\). Moreover,
    this decomposition is unique in the following sense: if \(\mathbf{v} = \mathbf{u}
    + \mathbf{u}^\perp\) with \(\mathbf{u} \in U\) and \(\mathbf{u}^\perp \in U^\perp\),
    then \(\mathbf{u} = \mathrm{proj}_U \mathbf{v}\) and \(\mathbf{u}^\perp = \mathbf{v}
    - \mathrm{proj}_U \mathbf{v}\). \(\flat\)'
  id: totrans-432
  prefs: []
  type: TYPE_NORMAL
  zh: '**引理** **(正交分解)** \(\idx{orthogonal decomposition lemma}\xdi\) 设 \(U \subseteq
    \mathbb{R}^n\) 是一个线性子空间，且 \(\mathbf{v} \in \mathbb{R}^n\)。那么 \(\mathbf{v}\) 可以分解为
    \(\mathrm{proj}_U \mathbf{v} + (\mathbf{v} - \mathrm{proj}_U\mathbf{v})\)，其中 \(\mathrm{proj}_U
    \mathbf{v} \in U\) 且 \((\mathbf{v} - \mathrm{proj}_U \mathbf{v}) \in U^\perp\)。此外，这种分解在以下意义上是唯一的：如果
    \(\mathbf{v} = \mathbf{u} + \mathbf{u}^\perp\)，其中 \(\mathbf{u} \in U\) 且 \(\mathbf{u}^\perp
    \in U^\perp\)，那么 \(\mathbf{u} = \mathrm{proj}_U \mathbf{v}\) 且 \(\mathbf{u}^\perp
    = \mathbf{v} - \mathrm{proj}_U \mathbf{v}\)。\(\flat\)'
- en: '*Proof:* The first part is an immediate consequence of the *Orthogonal Projection
    Theorem*. For the second part, assume \(\mathbf{v} = \mathbf{u} + \mathbf{u}^\perp\)
    with \(\mathbf{u} \in U\) and \(\mathbf{u}^\perp \in U^\perp\). Subtracting \(\mathbf{v}
    = \mathrm{proj}_U \mathbf{v} + (\mathbf{v} - \mathrm{proj}_U\mathbf{v})\), we
    see that'
  id: totrans-433
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明:* 第一部分是正交投影定理的直接结果。对于第二部分，假设 \(\mathbf{v} = \mathbf{u} + \mathbf{u}^\perp\)，其中
    \(\mathbf{u} \in U\) 和 \(\mathbf{u}^\perp \in U^\perp\)。从 \(\mathbf{v} = \mathrm{proj}_U
    \mathbf{v} + (\mathbf{v} - \mathrm{proj}_U\mathbf{v})\) 中减去，我们得到'
- en: \[ (*) \qquad \mathbf{0} = \mathbf{w}_1 + \mathbf{w}_2 \]
  id: totrans-434
  prefs: []
  type: TYPE_NORMAL
  zh: \[ (*) \qquad \mathbf{0} = \mathbf{w}_1 + \mathbf{w}_2 \]
- en: with
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
  zh: 与
- en: \[ \mathbf{w}_1 = \mathbf{u} - \mathrm{proj}_U \mathbf{v} \in U, \qquad \mathbf{w}_2
    = \mathbf{u}^\perp - (\mathbf{v} - \mathrm{proj}_U\mathbf{v}) \in U^\perp. \]
  id: totrans-436
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{w}_1 = \mathbf{u} - \mathrm{proj}_U \mathbf{v} \in U, \qquad \mathbf{w}_2
    = \mathbf{u}^\perp - (\mathbf{v} - \mathrm{proj}_U\mathbf{v}) \in U^\perp. \]
- en: If \(\mathbf{w}_1 = \mathbf{w}_2 = \mathbf{0}\), we are done. Otherwise, they
    must both be nonzero by \((*)\). Further, by the *Properties of Orthonormal Lists*,
    \(\mathbf{w}_1\) and \(\mathbf{w}_2\) must be linearly independent. But this is
    contradicted by the fact that \(\mathbf{w}_2 = - \mathbf{w}_1\) by \((*)\). \(\square\)
  id: totrans-437
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 \(\mathbf{w}_1 = \mathbf{w}_2 = \mathbf{0}\)，则已完成。否则，根据 \((*)\)，它们都必须是非零的。此外，根据正交列表的性质，\(\mathbf{w}_1\)
    和 \(\mathbf{w}_2\) 必须是线性无关的。但这与 \((*)\) 中 \(\mathbf{w}_2 = - \mathbf{w}_1\) 的事实相矛盾。\(\square\)
- en: '**Figure:** Orthogonal decomposition ([Source](https://commons.wikimedia.org/wiki/File:Orthogonal_Decomposition_qtl1.svg))'
  id: totrans-438
  prefs: []
  type: TYPE_NORMAL
  zh: '**图:** 正交分解 ([来源](https://commons.wikimedia.org/wiki/File:Orthogonal_Decomposition_qtl1.svg))'
- en: '![Orthogonal decomposition](../Images/0fbd201d54de3ed8d4d4cbf69a88afc2.png)'
  id: totrans-439
  prefs: []
  type: TYPE_IMG
  zh: '![正交分解](../Images/0fbd201d54de3ed8d4d4cbf69a88afc2.png)'
- en: \(\bowtie\)
  id: totrans-440
  prefs: []
  type: TYPE_NORMAL
  zh: \(\bowtie\)
- en: 'Formally, the *Orthogonal Decomposition Lemma* states that \(\mathbb{R}^n\)
    is a direct sum of any linear subspace \(U\) and of its orthogonal complement
    \(U^\perp\): that is, any vector \(\mathbf{v} \in \mathbb{R}^n\) can be written
    uniquely as \(\mathbf{v} = \mathbf{u} + \mathbf{u}^\perp\) with \(\mathbf{u} \in
    U\) and \(\mathbf{u}^\perp \in U^\perp\). This is denoted \(\mathbb{R}^n = U \oplus
    U^\perp\).'
  id: totrans-441
  prefs: []
  type: TYPE_NORMAL
  zh: 正式地，**正交分解引理**表明 \(\mathbb{R}^n\) 是任何线性子空间 \(U\) 和其正交补 \(U^\perp\) 的直和：即，任何
    \(\mathbb{R}^n\) 中的向量 \(\mathbf{v}\) 可以唯一地写成 \(\mathbf{v} = \mathbf{u} + \mathbf{u}^\perp\)，其中
    \(\mathbf{u} \in U\) 且 \(\mathbf{u}^\perp \in U^\perp\)。这表示为 \(\mathbb{R}^n =
    U \oplus U^\perp\)。
- en: Let \(\mathbf{a}_1,\ldots,\mathbf{a}_\ell\) be an orthonormal basis of \(U\)
    and \(\mathbf{b}_1,\ldots,\mathbf{b}_k\) be an orthonormal basis of \(U^\perp\).
    By definition of the orthogonal complement, the list
  id: totrans-442
  prefs: []
  type: TYPE_NORMAL
  zh: 设 \(\mathbf{a}_1,\ldots,\mathbf{a}_\ell\) 是 \(U\) 的一个正交基，\(\mathbf{b}_1,\ldots,\mathbf{b}_k\)
    是 \(U^\perp\) 的一个正交基。根据正交补的定义，列表
- en: \[ \mathcal{L} = \{\mathbf{a}_1,\ldots,\mathbf{a}_\ell, \mathbf{b}_1,\ldots,\mathbf{b}_k\}
    \]
  id: totrans-443
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathcal{L} = \{\mathbf{a}_1,\ldots,\mathbf{a}_\ell, \mathbf{b}_1,\ldots,\mathbf{b}_k\}
    \]
- en: is orthonormal, so it forms a basis of its span. Because any vector in \(\mathbb{R}^n\)
    can be written as a sum of a vector from \(U\) and a vector from \(U^\perp\),
    all of \(\mathbb{R}^n\) is in the span of \(\mathcal{L}\). It follows from the
    *Dimension Theorem* that \(n = \ell + k\), that is,
  id: totrans-444
  prefs: []
  type: TYPE_NORMAL
  zh: 是正交归一的，因此它构成了其张成的基。因为 \(\mathbb{R}^n\) 中的任何向量都可以写成 \(U\) 中一个向量与 \(U^\perp\)
    中一个向量的和，所以整个 \(\mathbb{R}^n\) 都在 \(\mathcal{L}\) 的张成中。根据**维度定理**，\(n = \ell +
    k\)，即，
- en: \[ \mathrm{dim}(U) + \mathrm{dim}(U^\perp) = n. \]
  id: totrans-445
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathrm{dim}(U) + \mathrm{dim}(U^\perp) = n. \]
- en: 2.3.4\. Overdetermined systems[#](#overdetermined-systems "Link to this heading")
  id: totrans-446
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.3.4\. 过定系统[#](#overdetermined-systems "链接到本标题")
- en: In this section, we discuss the least-squares problem. Let again \(A \in \mathbb{R}^{n\times
    m}\) be an \(n\times m\) matrix with linearly independent columns and let \(\mathbf{b}
    \in \mathbb{R}^n\) be a vector. We are looking to solve the system
  id: totrans-447
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们讨论最小二乘问题。再次设 \(A \in \mathbb{R}^{n\times m}\) 是一个 \(n\times m\) 矩阵，其列线性无关，并且设
    \(\mathbf{b} \in \mathbb{R}^n\) 是一个向量。我们正在寻找解这个系统
- en: \[ A \mathbf{x} \approx \mathbf{b}. \]
  id: totrans-448
  prefs: []
  type: TYPE_NORMAL
  zh: \[ A \mathbf{x} \approx \mathbf{b}. \]
- en: 'If \(n=m\), we can use the matrix inverse to solve the system (provided \(A\)
    is nonsingular of course). But we are interested in the overdetermined case, i.e.
    when \(n > m\): there are more equations than variables. We cannot use the matrix
    inverse then. Indeed, because the columns do not span all of \(\mathbb{R}^n\),
    there is a vector \(\mathbf{b} \in \mathbb{R}^n\) that is not in the column space
    of \(A\).'
  id: totrans-449
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 \(n=m\)，我们可以使用矩阵逆来解这个系统（当然，前提是 \(A\) 是非奇异的）。但我们感兴趣的是过定情况，即当 \(n > m\) 时：方程多于变量。那时我们不能使用矩阵逆。实际上，因为列没有张成整个
    \(\mathbb{R}^n\)，存在一个不在 \(A\) 的列空间中的向量 \(\mathbf{b} \in \mathbb{R}^n\)。
- en: A natural way to make sense of the overdetermined problem is to cast it as the
    [linear least-squares problem](https://en.wikipedia.org/wiki/Least_squares)\(\idx{least
    squares problem}\xdi\)
  id: totrans-450
  prefs: []
  type: TYPE_NORMAL
  zh: 将过定问题视为[线性最小二乘问题](https://en.wikipedia.org/wiki/Least_squares)\(\idx{最小二乘问题}\xdi\)
- en: \[ \min_{\mathbf{x} \in \mathbb{R}^m} \|A \mathbf{x} - \mathbf{b}\|^2. \]
  id: totrans-451
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \min_{\mathbf{x} \in \mathbb{R}^m} \|A \mathbf{x} - \mathbf{b}\|^2. \]
- en: In words, we look for the best-fitting solution under the squared Euclidean
    norm. Equivalently, writing
  id: totrans-452
  prefs: []
  type: TYPE_NORMAL
  zh: 换句话说，我们寻找在平方欧几里得范数下的最佳拟合解。等价地，写作
- en: \[\begin{split} A = \begin{pmatrix} | & & | \\ \mathbf{a}_1 & \ldots & \mathbf{a}_m
    \\ | & & | \end{pmatrix} = \begin{pmatrix} a_{11} & \cdots & a_{1m} \\ a_{21}
    & \cdots & a_{2m} \\ \vdots & \ddots & \vdots \\ a_{n1} & \cdots & a_{nm} \end{pmatrix}
    \quad \text{and} \quad \mathbf{b} = \begin{pmatrix} b_1 \\ \vdots \\ b_n \end{pmatrix}
    \end{split}\]
  id: totrans-453
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A = \begin{pmatrix} | & & | \\ \mathbf{a}_1 & \ldots & \mathbf{a}_m
    \\ | & & | \end{pmatrix} = \begin{pmatrix} a_{11} & \cdots & a_{1m} \\ a_{21}
    & \cdots & a_{2m} \\ \vdots & \ddots & \vdots \\ a_{n1} & \cdots & a_{nm} \end{pmatrix}
    \quad \text{和} \quad \mathbf{b} = \begin{pmatrix} b_1 \\ \vdots \\ b_n \end{pmatrix}
    \end{split}\]
- en: we seek a linear combination of the columns of \(A\) that minimizes the objective
  id: totrans-454
  prefs: []
  type: TYPE_NORMAL
  zh: 我们寻求 \(A\) 的列的线性组合，以最小化目标
- en: \[ \left\|\,\sum_{j=1}^m x_j \mathbf{a}_j - \mathbf{b}\,\right\|^2 = \sum_{i=1}^n
    \left( \sum_{j=1}^m a_{ij} x_j - b_i \right)^2. \]
  id: totrans-455
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \left\|\,\sum_{j=1}^m x_j \mathbf{a}_j - \mathbf{b}\,\right\|^2 = \sum_{i=1}^n
    \left( \sum_{j=1}^m a_{ij} x_j - b_i \right)^2. \]
- en: We have already solved a closely related problem when we introduced the orthogonal
    projection. We make the connection explicit next.
  id: totrans-456
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在介绍正交投影时已经解决了一个与之密切相关的问题。我们将在下文中明确这一联系。
- en: '**THEOREM** **(Normal Equations)** \(\idx{normal equations}\xdi\) Let \(A \in
    \mathbb{R}^{n\times m}\) be an \(n\times m\) matrix with \(n \geq m\) and let
    \(\mathbf{b} \in \mathbb{R}^n\) be a vector. A solution \(\mathbf{x}^*\) to the
    linear least-squares problem'
  id: totrans-457
  prefs: []
  type: TYPE_NORMAL
  zh: '**定理** **（正则方程）** \(\idx{normal equations}\xdi\) 设 \(A \in \mathbb{R}^{n\times
    m}\) 是一个 \(n\times m\) 的矩阵，其中 \(n \geq m\)，并且设 \(\mathbf{b} \in \mathbb{R}^n\)
    是一个向量。线性最小二乘问题的解 \(\mathbf{x}^*\)'
- en: \[ \min_{\mathbf{x} \in \mathbb{R}^m} \|A \mathbf{x} - \mathbf{b}\|^2 \]
  id: totrans-458
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \min_{\mathbf{x} \in \mathbb{R}^m} \|A \mathbf{x} - \mathbf{b}\|^2 \]
- en: satisfies the normal equations
  id: totrans-459
  prefs: []
  type: TYPE_NORMAL
  zh: 满足正则方程
- en: \[ A^T A \mathbf{x}^* = A^T \mathbf{b}. \]
  id: totrans-460
  prefs: []
  type: TYPE_NORMAL
  zh: \[ A^T A \mathbf{x}^* = A^T \mathbf{b}. \]
- en: If further the columns of \(A\) are linearly independent, then there exists
    a unique solution \(\mathbf{x}^*\). \(\sharp\)
  id: totrans-461
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 \(A\) 的列线性无关，那么存在唯一的解 \(\mathbf{x}^*\)。 \(\sharp\)
- en: '*Proof idea:* Apply our characterization of the orthogonal projection onto
    the column space of \(A\).'
  id: totrans-462
  prefs: []
  type: TYPE_NORMAL
  zh: '**证明思路**：应用我们对 \(A\) 的列空间正交投影的描述。'
- en: '*Proof:* Let \(U = \mathrm{col}(A) = \mathrm{span}(\mathbf{a}_1,\ldots,\mathbf{a}_m)\).
    By the *Orthogonal Projection Theorem*, the orthogonal projection \(\mathbf{p}^*
    = \mathrm{proj}_{U} \mathbf{b}\) of \(\mathbf{b}\) onto \(U\) is the unique, closest
    vector to \(\mathbf{b}\) in \(U\), that is,'
  id: totrans-463
  prefs: []
  type: TYPE_NORMAL
  zh: '**证明**：设 \(U = \mathrm{col}(A) = \mathrm{span}(\mathbf{a}_1,\ldots,\mathbf{a}_m)\)。根据**正交投影定理**，\(\mathbf{b}\)
    在 \(U\) 上的正交投影 \(\mathbf{p}^* = \mathrm{proj}_{U} \mathbf{b}\) 是 \(U\) 中与 \(\mathbf{b}\)
    最接近的唯一向量，即，'
- en: \[ \mathbf{p}^* = \arg\min_{\mathbf{p} \in U} \|\mathbf{p} - \mathbf{b}\| =
    \arg\min_{\mathbf{p} \in U} \|\mathbf{p} - \mathbf{b}\|^2, \]
  id: totrans-464
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{p}^* = \arg\min_{\mathbf{p} \in U} \|\mathbf{p} - \mathbf{b}\| =
    \arg\min_{\mathbf{p} \in U} \|\mathbf{p} - \mathbf{b}\|^2, \]
- en: where we used the *Composing with a Non-Decreasing Function Lemma* to justify
    taking a square in the rightmost expression. Because \(\mathbf{p}^*\) is in \(U
    = \mathrm{col}(A)\), it must be of the form \(\mathbf{p}^* = A \mathbf{x}^*\).
    This establishes that \(\mathbf{x}^*\) is a solution to the linear least-squares
    problem in the statement. By the *Orthogonal Projection Theorem*, it must satisfy
    \(\langle \mathbf{b} - A \mathbf{x}^*, \mathbf{u}\rangle = 0\) for all \(\mathbf{u}
    \in U\). Because the columns \(\mathbf{a}_i\) are in \(U\), that implies that
  id: totrans-465
  prefs: []
  type: TYPE_NORMAL
  zh: 其中我们使用了**非递减函数组合引理**来证明在最后一个表达式中取平方的合理性。因为 \(\mathbf{p}^*\) 在 \(U = \mathrm{col}(A)\)
    中，它必须具有形式 \(\mathbf{p}^* = A \mathbf{x}^*\)。这证明了 \(\mathbf{x}^*\) 是线性最小二乘问题陈述中的解。根据**正交投影定理**，它必须满足对所有
    \(\mathbf{u} \in U\) 有 \(\langle \mathbf{b} - A \mathbf{x}^*, \mathbf{u}\rangle
    = 0\)。因为列 \(\mathbf{a}_i\) 在 \(U\) 中，这意味着
- en: \[ 0 = \langle \mathbf{b} - A \mathbf{x}^*, \mathbf{a}_i\rangle = \mathbf{a}_i^T
    (\mathbf{b} - A \mathbf{x}^*) ,\qquad \forall i\in [m]. \]
  id: totrans-466
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 0 = \langle \mathbf{b} - A \mathbf{x}^*, \mathbf{a}_i\rangle = \mathbf{a}_i^T
    (\mathbf{b} - A \mathbf{x}^*) ,\qquad \forall i\in [m]. \]
- en: Stacking up these equations gives in matrix form
  id: totrans-467
  prefs: []
  type: TYPE_NORMAL
  zh: 将这些方程堆叠起来，得到矩阵形式
- en: \[ A^T (\mathbf{b} - A\mathbf{x}^*) = \mathbf{0}, \]
  id: totrans-468
  prefs: []
  type: TYPE_NORMAL
  zh: \[ A^T (\mathbf{b} - A\mathbf{x}^*) = \mathbf{0}, \]
- en: as claimed (after rearranging).
  id: totrans-469
  prefs: []
  type: TYPE_NORMAL
  zh: 如所声称的（经过重新排列）。
- en: 'Important observation: While we have shown that \(\mathbf{p}^*\) is unique
    (by the *Orthogonal Projection Theorem*), it is not clear at all that \(\mathbf{x}^*\)
    (i.e., the linear combination of columns of \(A\) corresponding to \(\mathbf{p}^*\))
    is unique. We have seen in a previous example that, when \(A\) has full column
    rank, the matrix \(A^T A\) is invertible. That implies the uniqueness claim. \(\square\)'
  id: totrans-470
  prefs: []
  type: TYPE_NORMAL
  zh: '**重要观察**：虽然我们已经通过**正交投影定理**证明了 \(\mathbf{p}^*\) 是唯一的，但 \(\mathbf{x}^*\)（即与
    \(\mathbf{p}^*\) 对应的 \(A\) 的列的线性组合）是否唯一并不清楚。我们在先前的例子中看到，当 \(A\) 具有满列秩时，矩阵 \(A^T
    A\) 是可逆的。这暗示了唯一性的断言。 \(\square\)'
- en: '**NUMERICAL CORNER:** To solve a linear system in NumPy, use [`numpy.linalg.solve`](https://numpy.org/doc/stable/reference/generated/numpy.linalg.solve.html).
    As an example, we consider the overdetermined system with'
  id: totrans-471
  prefs: []
  type: TYPE_NORMAL
  zh: '**数值角**：在 NumPy 中解决线性系统，使用 `numpy.linalg.solve`。作为一个例子，我们考虑具有'
- en: \[\begin{split} A = \begin{pmatrix} 1 & 0\\ 0 & 1\\ 1 & 1 \end{pmatrix} \quad
    \text{and} \quad \mathbf{b} = \begin{pmatrix} 0\\ 0\\ 2 \end{pmatrix}. \end{split}\]
  id: totrans-472
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A = \begin{pmatrix} 1 & 0\\ 0 & 1\\ 1 & 1 \end{pmatrix} \quad
    \text{和} \quad \mathbf{b} = \begin{pmatrix} 0\\ 0\\ 2 \end{pmatrix}. \end{split}\]
- en: We use [`numpy.ndarray.T`](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.T.html)
    for the transpose and [`@`](https://numpy.org/doc/stable/reference/generated/numpy.matmul.html)
    for matrix-matrix or matrix-vector product.
  id: totrans-473
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用 `numpy.ndarray.T` 进行转置，使用 `@` 进行矩阵-矩阵或矩阵-向量乘积。
- en: '[PRE4]'
  id: totrans-474
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '[PRE5]'
  id: totrans-475
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: We can also use [`numpy.linalg.lstsq`](https://numpy.org/doc/stable/reference/generated/numpy.linalg.lstsq.html)
    directly on the overdetermined system to compute the least-square solution.
  id: totrans-476
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也可以直接在超定系统中使用 `numpy.linalg.lstsq`（https://numpy.org/doc/stable/reference/generated/numpy.linalg.lstsq.html）来计算最小二乘解。
- en: '[PRE6]'
  id: totrans-477
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '[PRE7]'
  id: totrans-478
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: \(\unlhd\)
  id: totrans-479
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: '***Self-assessment quiz*** *(with help from Claude, Gemini, and ChatGPT)*'
  id: totrans-480
  prefs: []
  type: TYPE_NORMAL
  zh: '***自我评估测验*** *(在 Claude、Gemini 和 ChatGPT 的帮助下)*'
- en: '**1** Let \(\mathbf{q}_1, \dots, \mathbf{q}_m\) be an orthonormal list of vectors
    in \(\mathbb{R}^n\). Which of the following is the orthogonal projection of a
    vector \(\mathbf{v} \in \mathbb{R}^n\) onto \(\mathrm{span}(\mathbf{q}_1, \dots,
    \mathbf{q}_m)\)?'
  id: totrans-481
  prefs: []
  type: TYPE_NORMAL
  zh: '**1** 设 \(\mathbf{q}_1, \dots, \mathbf{q}_m\) 是 \(\mathbb{R}^n\) 中的一组正交归一向量。以下哪个是向量
    \(\mathbf{v} \in \mathbb{R}^n\) 在 \(\mathrm{span}(\mathbf{q}_1, \dots, \mathbf{q}_m)\)
    上的正交投影？'
- en: a) \(\sum_{i=1}^m \mathbf{q}_i\)
  id: totrans-482
  prefs: []
  type: TYPE_NORMAL
  zh: a) \(\sum_{i=1}^m \mathbf{q}_i\)
- en: b) \(\sum_{i=1}^m \langle \mathbf{v}, \mathbf{q}_i \rangle\)
  id: totrans-483
  prefs: []
  type: TYPE_NORMAL
  zh: b) \(\sum_{i=1}^m \langle \mathbf{v}, \mathbf{q}_i \rangle\)
- en: c) \(\sum_{i=1}^m \langle \mathbf{v}, \mathbf{q}_i \rangle \mathbf{q}_i\)
  id: totrans-484
  prefs: []
  type: TYPE_NORMAL
  zh: c) \(\sum_{i=1}^m \langle \mathbf{v}, \mathbf{q}_i \rangle \mathbf{q}_i\)
- en: d) \(\sum_{i=1}^m \langle \mathbf{q}_i, \mathbf{q}_i \rangle \mathbf{v}\)
  id: totrans-485
  prefs: []
  type: TYPE_NORMAL
  zh: d) \(\sum_{i=1}^m \langle \mathbf{q}_i, \mathbf{q}_i \rangle \mathbf{v}\)
- en: '**2** According to the Normal Equations Theorem, what condition must a solution
    \(\bx^*\) to the linear least squares problem satisfy?'
  id: totrans-486
  prefs: []
  type: TYPE_NORMAL
  zh: '**2** 根据正则方程定理，线性最小二乘问题的解 \(\bx^*\) 必须满足什么条件？'
- en: a) \(A^T A\bx^* = \bb\)
  id: totrans-487
  prefs: []
  type: TYPE_NORMAL
  zh: a) \(A^T A\bx^* = \bb\)
- en: b) \(A^T A\bx^* = A^T \bb\)
  id: totrans-488
  prefs: []
  type: TYPE_NORMAL
  zh: b) \(A^T A\bx^* = A^T \bb\)
- en: c) \(A\bx^* = A^T \bb\)
  id: totrans-489
  prefs: []
  type: TYPE_NORMAL
  zh: c) \(A\bx^* = A^T \bb\)
- en: d) \(A\bx^* = \bb\)
  id: totrans-490
  prefs: []
  type: TYPE_NORMAL
  zh: d) \(A\bx^* = \bb\)
- en: '**3** Which property characterizes the orthogonal projection \(\mathrm{proj}_U
    \mathbf{v}\) of a vector \(\mathbf{v}\) onto a subspace \(U\)?'
  id: totrans-491
  prefs: []
  type: TYPE_NORMAL
  zh: '**3** 哪个性质描述了向量 \(\mathbf{v}\) 在子空间 \(U\) 上的正交投影 \(\mathrm{proj}_U \mathbf{v}\)？'
- en: a) \(\mathbf{v} - \mathrm{proj}_U \mathbf{v}\) is a scalar multiple of \(\mathbf{v}\).
  id: totrans-492
  prefs: []
  type: TYPE_NORMAL
  zh: a) \(\mathbf{v} - \mathrm{proj}_U \mathbf{v}\) 是 \(\mathbf{v}\) 的一个标量倍。
- en: b) \(\mathbf{v} - \mathrm{proj}_U \mathbf{v}\) is orthogonal to \(\mathbf{v}\).
  id: totrans-493
  prefs: []
  type: TYPE_NORMAL
  zh: b) \(\mathbf{v} - \mathrm{proj}_U \mathbf{v}\) 与 \(\mathbf{v}\) 正交。
- en: c) \(\mathbf{v} - \mathrm{proj}_U \mathbf{v}\) is orthogonal to \(U\).
  id: totrans-494
  prefs: []
  type: TYPE_NORMAL
  zh: c) \(\mathbf{v} - \mathrm{proj}_U \mathbf{v}\) 与 \(U\) 正交。
- en: d) \(\mathrm{proj}_U \mathbf{v}\) is always the zero vector.
  id: totrans-495
  prefs: []
  type: TYPE_NORMAL
  zh: d) \(\mathrm{proj}_U \mathbf{v}\) 总是零向量。
- en: '**4** What is the interpretation of the linear least squares problem \(A\mathbf{x}
    \approx \mathbf{b}\) in terms of the column space of \(A\)?'
  id: totrans-496
  prefs: []
  type: TYPE_NORMAL
  zh: '**4** 从 \(A\) 的列空间的角度来看，线性最小二乘问题 \(A\mathbf{x} \approx \mathbf{b}\) 的含义是什么？'
- en: a) Finding the exact solution \(\mathbf{x}\) such that \(A\mathbf{x} = \mathbf{b}\).
  id: totrans-497
  prefs: []
  type: TYPE_NORMAL
  zh: a) 找到精确解 \(\mathbf{x}\) 使得 \(A\mathbf{x} = \mathbf{b}\)。
- en: b) Finding the vector \(\mathbf{x}\) that makes the linear combination \(A\mathbf{x}\)
    of the columns of \(A\) as close as possible to \(\mathbf{b}\) in Euclidean norm.
  id: totrans-498
  prefs: []
  type: TYPE_NORMAL
  zh: b) 找到向量 \(\mathbf{x}\)，使得 \(A\) 的列向量的线性组合 \(A\mathbf{x}\) 在欧几里得范数下尽可能接近 \(\mathbf{b}\)。
- en: c) Finding the orthogonal projection of \(\mathbf{b}\) onto the column space
    of \(A\).
  id: totrans-499
  prefs: []
  type: TYPE_NORMAL
  zh: c) 找到 \(\mathbf{b}\) 在 \(A\) 的列空间上的正交投影。
- en: d) Finding the orthogonal complement of the column space of \(A\).
  id: totrans-500
  prefs: []
  type: TYPE_NORMAL
  zh: d) 找到 \(A\) 的列空间的正交补。
- en: '**5** Which matrix equation must hold true for a matrix \(Q\) to be orthogonal?'
  id: totrans-501
  prefs: []
  type: TYPE_NORMAL
  zh: '**5** 哪个矩阵方程对于矩阵 \(Q\) 是正交的必须成立？'
- en: a) \(Q Q^T = 0\).
  id: totrans-502
  prefs: []
  type: TYPE_NORMAL
  zh: a) \(Q Q^T = 0\).
- en: b) \(Q Q^T = I\).
  id: totrans-503
  prefs: []
  type: TYPE_NORMAL
  zh: b) \(Q Q^T = I\).
- en: c) \(Q^T Q = 0\).
  id: totrans-504
  prefs: []
  type: TYPE_NORMAL
  zh: c) \(Q^T Q = 0\).
- en: d) \(Q^T = Q\).
  id: totrans-505
  prefs: []
  type: TYPE_NORMAL
  zh: d) \(Q^T = Q\).
- en: 'Answer for 1: c. Justification: This is the definition of the orthogonal projection
    onto an orthonormal list given in the text.'
  id: totrans-506
  prefs: []
  type: TYPE_NORMAL
  zh: 答案 1：c. 理由：这是文本中给出的关于正交投影到正交归一列表的定义。
- en: 'Answer for 2: b. Justification: The Normal Equations Theorem states that a
    solution \(\bx^*\) to the linear least squares problem satisfies \(A^T A\bx^*
    = A^T \bb\).'
  id: totrans-507
  prefs: []
  type: TYPE_NORMAL
  zh: 答案 2：b. 理由：正则方程定理指出，线性最小二乘问题的解 \(\bx^*\) 满足 \(A^T A\bx^* = A^T \bb\)。
- en: 'Answer for 3: c. Justification: The text states that the orthogonal projection
    \(\mathrm{proj}_U \mathbf{v}\) has the property that “the difference \(\mathbf{v}
    - \mathrm{proj}_U \mathbf{v}\) is orthogonal to \(U\).”'
  id: totrans-508
  prefs: []
  type: TYPE_NORMAL
  zh: 答案 3：c. 理由：文本中提到，正交投影 \(\mathrm{proj}_U \mathbf{v}\) 的性质是“差 \(\mathbf{v} - \mathrm{proj}_U
    \mathbf{v}\) 与 \(U\) 正交。”
- en: 'Answer for 4: b. Justification: The text defines the linear least squares problem
    as seeking a linear combination of the columns of \(A\) that minimizes the distance
    to \(\mathbf{b}\) in Euclidean norm.'
  id: totrans-509
  prefs: []
  type: TYPE_NORMAL
  zh: 答案 4：b. 理由：文本中将线性最小二乘问题定义为寻找 \(A\) 的列向量的线性组合，以最小化到 \(\mathbf{b}\) 的欧几里得距离。
- en: 'Answer for 5: b. Justification: The text states that an orthogonal matrix \(Q\)
    must satisfy \(Q Q^T = I\).'
  id: totrans-510
  prefs: []
  type: TYPE_NORMAL
  zh: 答案 5：b. 理由：文本中提到，正交矩阵 \(Q\) 必须满足 \(Q Q^T = I\)。
