- en: Discrete Space
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 离散空间
- en: 原文：[https://phys-sim-book.github.io/lec17.1-discrete_space.html](https://phys-sim-book.github.io/lec17.1-discrete_space.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec17.1-discrete_space.html](https://phys-sim-book.github.io/lec17.1-discrete_space.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: To enable numerical evaluation of the integrals in the weak form, the first
    step is to discretize the smooth vector fields x and Q. This allows them to be
    represented by a finite set of samples, along with appropriate interpolation functions.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使弱形式中的积分能够进行数值评估，第一步是将光滑向量场x和Q进行离散化。这使得它们可以通过有限个样本以及适当的插值函数来表示。
- en: '****Example 17.1.1 (1D Function Interpolation).**** In 1D, to approximate a
    function f(x) using three sample points x1​=1, x2​=2, x3​=3 ([Figure 17.1.1](#fig:lec17:1d_interpolation)),
    we can use interpolation functions Ni​(x)=1−∣x−xi​∣ and form f(x)≈∑i​f(xi​)Ni​(x).'
  id: totrans-4
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '****例17.1.1（1D函数插值）。**** 在1D中，为了使用三个样本点x1=1，x2=2，x3=3 ([图17.1.1](#fig:lec17:1d_interpolation))来近似函数f(x)，我们可以使用插值函数Ni(x)=1−∣x−xi∣并形成f(x)≈∑i​f(xi​)Ni​(x)。'
- en: ''
  id: totrans-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![](../Images/6f8a7ab7f29fb6e103f6121f2165d66a.png)'
  id: totrans-6
  prefs:
  - PREF_BQ
  type: TYPE_IMG
  zh: '![](../Images/6f8a7ab7f29fb6e103f6121f2165d66a.png)'
- en: ''
  id: totrans-7
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Figure 17.1.1.** With interpolation functions N1​(x), N2​(x), N3​(x) and
    sample points x1​=1, x2​=2, x3​=3, a function f(x) can be approximated as ∑i​f(xi​)Ni​(x).'
  id: totrans-8
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**图17.1.1**。使用插值函数N1(x)，N2(x)，N3(x)和样本点x1=1，x2=2，x3=3，函数f(x)可以被近似为∑i​f(xi​)Ni​(x)。'
- en: 'Given a set of sample points indexed by a or b in the simulation domain, we
    can approximate the test function Q and the DOF x as: Qi​(X,tn)xi​(X,tn)​≈a∑​Qa∣i​(tn)Na​(X)=a∑​Qa∣in​Na​(X),≈b∑​xb∣i​(tn)Nb​(X)=b∑​xb∣in​Nb​(X),​
    where Qa∣in​=Qa∣i​(tn) refers to the i-th dimension of Q evaluated at sample point
    a at time tn, and Na​(X):Ω0→R is the interpolation function at sample point a.
    In this way, we similarly have: Ai​(X,tn)≈b∑​Ab∣i​(tn)Nb​(X)=b∑​Ab∣in​Nb​(X).(17.1.1)
    Plugging these discretizations into the weak form (Equation [(17.1)](lec17-disc_weak_form.html#eq:lec17:weakform_lagrangian_tn))
    and expressing summations with the index notation, we obtain: ​∫Ω0​R(X,0)Qa∣in​Na​(X)Ab∣in​Nb​(X)dX=∫∂Ω0​Qa∣in​Na​(X)Ti​(X,tn)ds(X)−∫Ω0​Qa∣in​Na,j​(X)Pij​(X,tn)dX.​
    On the left-hand side, we see that the sample values Qa∣in​ and Ab∣in​ are in
    fact independent of X, so we can move them out of the integral and obtain: ​Mab​Qa∣in​Ab∣in​=∫∂Ω0​Qa∣in​Na​(X)Ti​(X,tn)ds(X)−∫Ω0​Qa∣in​Na,j​(X)Pij​(X,tn)dX​
    where Mab​=∫Ω0​R(X,0)Na​(X)Nb​(X)dX(17.1.2) is the mass matrix.'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 给定一组由模拟域中的a或b索引的样本点，我们可以近似测试函数Q和自由度x如下：Qi(X,tn)xi(X,tn)≈a∑Qa∣i(tn)Na(X)=a∑Qa∣in(tn)Na(X),≈b∑xb∣i(tn)Nb(X)=b∑xb∣in(tn)Nb(X),
    其中Qa∣in=Qa∣i(tn)表示在时间tn时在样本点a评估的Q的第i维，Na(X):Ω0→R是在样本点a处的插值函数。这样，我们同样有：Ai(X,tn)≈b∑Ab∣i(tn)Nb(X)=b∑Ab∣in(tn)Nb(X).(17.1.1)
    将这些离散化形式代入弱形式（方程[(17.1)](lec17-disc_weak_form.html#eq:lec17:weakform_lagrangian_tn)）并用指标符号表示求和，我们得到：∫Ω0R(X,0)Qa∣inNa(X)Ab∣inNb(X)dX=∫∂Ω0Qa∣inNa(X)Ti(X,tn)ds(X)−∫Ω0Qa∣inNa,j(X)Pij(X,tn)dX.
    在等式左边，我们看到样本值Qa∣in和Ab∣in实际上与X无关，因此我们可以将它们移出积分，得到：MabQa∣inAb∣in=∫∂Ω0Qa∣inNa(X)Ti(X,tn)ds(X)−∫Ω0Qa∣inNa,j(X)Pij(X,tn)dX，其中Mab=∫Ω0R(X,0)Na(X)Nb(X)dX(17.1.2)是质量矩阵。
- en: '***Remark 17.1.1 (Mass Matrix Properties).*** The mass matrix M (Equation [(17.1.2)](#eq:lec17:mass_matrix))
    is symmetric and positive semi-definite because it can be expressed as: ∫Ω0​BBTdX,
    where Bi​=R(X,0)​Ni​(X). Thus, for any vector z, zTMz=∫Ω0​(zTB)2dX≥0. In practice,
    this mass matrix may be singular. To address this, we typically use a "mass lumping"
    strategy to approximate the mass matrix with a diagonal and positive definite
    form. This is achieved by summing each row and defining: Mablump​=δab​c∑​Mac​.'
  id: totrans-10
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '***注17.1.1（质量矩阵性质）。*** 质量矩阵M（方程[(17.1.2)](#eq:lec17:mass_matrix)）是对称和正半定的，因为它可以表示为：∫Ω0BBTdX，其中Bi=R(X,0)Ni(X)。因此，对于任何向量z，zTMz=∫Ω0(zTB)2dX≥0。在实践中，这个质量矩阵可能是奇异的。为了解决这个问题，我们通常使用“质量集中”策略来用对角和正定形式来近似质量矩阵。这是通过将每一行求和并定义：Mablump=δab​c∑Mac来实现的。'
- en: After spatial discretization, the solution of the weak form (Equation [(17.1)](lec17-disc_weak_form.html#eq:lec17:weakform_lagrangian_tn))
    is confined to d n-dimensional function spaces, where n represents the number
    of sample points, assuming all interpolation functions are mutually orthogonal.
    This means that there could be continuous solutions to the weak form outside of
    our solution space. In such cases, we can only provide an approximate solution
    based on the chosen sample points and interpolation functions.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在空间离散化之后，弱形式的解（方程 [(17.1)](lec17-disc_weak_form.html#eq:lec17:weakform_lagrangian_tn)）被限制在
    d n 维函数空间中，其中 n 代表样本点的数量，假设所有插值函数都是相互正交的。这意味着弱形式的连续解可能存在于我们的解空间之外。在这种情况下，我们只能基于所选样本点和插值函数提供一个近似解。
- en: '****Definition 17.1.1 (Orthogonal Functions).**** Similar to the orthogonality
    of two vectors a and b, defined as aTb=0, the orthogonality of two functions f(x)
    and g(x) is defined as: ∫f(x)g(x)dx=0. Just as a basis of vectors can span a finite-dimensional
    space, orthogonal functions can form an infinite basis for a function space. Conceptually,
    the integral above is analogous to a vector dot product.'
  id: totrans-12
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '****定义 17.1.1（正交函数）.**** 与两个向量 a 和 b 的正交性类似，定义为 aTb=0，两个函数 f(x) 和 g(x) 的正交性定义为：∫f(x)g(x)dx=0。正如向量基可以张成有限维空间一样，正交函数可以形成一个函数空间的无限基。从概念上讲，上述积分与向量点积类似。'
- en: 'That being said, to generate equations solvable for the unknowns, the arbitrary
    test function Q does not need to cover all possibilities to produce an infinite
    number of equations. Instead, we only need to produce a finite set of equations
    that spans the entire solution space. Therefore, for a^ traversing all sample
    points, and i^=1,2,…,d, we can assign the test function: Qa∣in​={1,0,​a=a^ and i=i^otherwise​
    to obtain nd equations: Ma^b​Ab∣i^n​=∫∂Ω0​Na^​(X)Ti^​(X,tn)ds(X)−∫Ω0​Na^,j​(X)Pi^j​(X,tn)dX,(17.1.3)
    resulting in nd unknowns and nd equations, bringing us closer to the discrete
    form.'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 话虽如此，为了生成可解未知数的方程，任意测试函数 Q 不必覆盖所有可能性以产生无限数量的方程。相反，我们只需要生成一个覆盖整个解空间的有限方程集。因此，对于
    a^ 遍历所有样本点，以及 i^=1,2,…,d，我们可以分配测试函数：Qa∣in={1,0,​a=a^ and i=i^otherwise​，从而获得 nd
    个方程：Ma^b​Ab∣i^n​=∫∂Ω0​Na^​(X)Ti^​(X,tn)ds(X)−∫Ω0​Na^,j​(X)Pi^j​(X,tn)dX，（17.1.3），从而产生
    nd 个未知数和 nd 个方程，使我们更接近离散形式。
- en: The two integrals on the right side of Equation [(17.1.3)](#eq:lec17:test_func_chosen)
    can be evaluated analytically or using quadrature rules, depending on the specific
    choice of interpolation functions. We will discuss these in detail in future lectures.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 方程 [(17.1.3)](#eq:lec17:test_func_chosen) 右侧的两个积分可以解析求解或使用求积规则求解，具体取决于插值函数的具体选择。我们将在未来的讲座中详细讨论这些内容。
