- en: Elasticity
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 弹性
- en: 原文：[https://phys-sim-book.github.io/lec23.3-elasticity.html](https://phys-sim-book.github.io/lec23.3-elasticity.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec23.3-elasticity.html](https://phys-sim-book.github.io/lec23.3-elasticity.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: For elasticity, similar to the 2D case, the deformation gradient F is also constant
    within each tetrahedron, and we can compute it as F=≈=​∂(β,γ,τ)∂x​(∂(β,γ,τ)∂X​)−1∂(β,γ,τ)∂x^​(∂(β,γ,τ)∂X​)−1[x2​−x1​,x3​−x1​,x4​−x1​][X2​−X1​,X3​−X1​,X4​−X1​]−1.​
    For force and Hessian computation, the required ∂F/∂x can be computed using ∇XN1​(X)​=∂X∂(1−β−γ−τ)​=(∂(β,γ,τ)∂(1−β−γ−τ)​(∂(β,γ,τ)∂X​)−1)T=([−1,−1,−1][X2​−X1​,X3​−X1​,X4​−X1​]−1)T​
    and similarly ∇XN2​(X)∇XN3​(X)∇XN3​(X)​=∂X∂β​=([1,0,0][X2​−X1​,X3​−X1​,X4​−X1​]−1)T,=∂X∂γ​=([0,1,0][X2​−X1​,X3​−X1​,X4​−X1​]−1)T,=∂X∂τ​=([0,0,1][X2​−X1​,X3​−X1​,X4​−X1​]−1)T.​
    With F, the computation of strain energy Ψ, stress P and stress derivative ∂P/∂F
    can all be found in [Strain Energy](./lec13-strain_energy.html) and [Stress and
    Its Derivatives](./lec14-stress_and_derivatives.html), and the computation of
    forces and Hessian matrices follow the same spirit as in 2D.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 对于弹性，类似于二维情况，变形梯度F在每个四面体内也是常数，我们可以将其计算为F=≈=∂(β,γ,τ)/∂x(∂(β,γ,τ)/∂X)−1∂(β,γ,τ)/∂x^(∂(β,γ,τ)/∂X)−1[x2−x1,x3−x1,x4−x1][X2−X1,X3−X1,X4−X1]−1.
    对于力和Hessian的计算，所需的∂F/∂x可以使用∇XN1(X)=∂X/∂(1−β−γ−τ)=(∂(β,γ,τ)/∂(1−β−γ−τ)(∂(β,γ,τ)/∂X)−1)^T=([−1,−1,−1][X2−X1,X3−X1,X4−X1]−1)^T和类似地∇XN2(X)∇XN3(X)∇XN3(X)=∂X/∂β=([1,0,0][X2−X1,X3−X1,X4−X1]−1)^T,=∂X/∂γ=([0,1,0][X2−X1,X3−X1,X4−X1]−1)^T,=∂X/∂τ=([0,0,1][X2−X1,X3−X1,X4−X1]−1)^T.
    使用F，应变能Ψ、应力P和应力导数∂P/∂F的计算都可以在[应变能](./lec13-strain_energy.html)和[应力和其导数](./lec14-stress_and_derivatives.html)中找到，力的计算和Hessian矩阵的计算遵循与二维相同的精神。
- en: 'To guarantee non-inversion of the tetrahedral elements during the simulation,
    the critical step size αI that first brings the volume of any tetrahedra to 0
    can be obtained by solving a 1D equation per tetrahedron V(xi​+αIpi​)=0, and then
    take the minimum of the solved step sizes. Here pi​ is the search direction of
    node i, and in 3D, this is equivalent to det([x21α​,x31α​,x41α​])≡(x21α​×x31α​)⋅x41α​=0(23.3.1)
    with xijα​=xij​+αIpij​ and xij​=xi​−xj​, pij​=pi​−pj​. Expanding Equation [(23.3.1)](#eq:lec23:det_tri_equals_0),
    we obtain the following cubic equation for αI:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 为了保证在模拟过程中四面体元素的非反转，可以通过求解每个四面体的1D方程V(xi+αIpi)=0，首先将任何四面体的体积降至0的临界步长αI可以找到，然后取解的步长中的最小值。这里pi是节点i的搜索方向，在3D中，这相当于det([x21α,x31α,x41α])≡(x21α×x31α)⋅x41α=0(23.3.1)
    with xijα=xij+αIpij and xij=xi−xj, pij=pi−pj. 展开方程[(23.3.1)](#eq:lec23:det_tri_equals_0)，我们得到以下关于αI的三次方程：
- en: ((p21​×p31​)⋅p41​)αI3+((x21​×p31​+p21​×x31​)⋅p41​+(p21​×p31​)⋅x41​)αI2+((x21​×p31​+p21​×x31​)⋅x41​+(x21​×x31​)⋅p41​)αI+(x21​×x31​)⋅x41​=0,​
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: ((p21×p31)⋅p41)αI3+((x21×p31+p21×x31)⋅p41+(p21×p31)⋅x41)αI2+((x21×p31+p21×x31)⋅x41+(x21×x31)⋅p41)αI+(x21×x31)⋅x41=0,​
- en: 'This cubic equation can sometimes degenerate into a quadratic or linear equation,
    particularly when node movements do not substantially alter the tetrahedron''s
    volume. To address potential numerical instability, we scale the equation terms
    based on the constant term coefficient:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 这个三次方程有时会退化成二次或线性方程，尤其是在节点移动没有显著改变四面体体积的情况下。为了解决潜在的数值不稳定性，我们根据常数项系数缩放方程项：
- en: ​(x21​×x31​)⋅x41​(p21​×p31​)⋅p41​​αI3+(x21​×x31​)⋅x41​(x21​×p31​+p21​×x31​)⋅p41​+(p21​×p31​)⋅x41​​αI2+(x21​×x31​)⋅x41​(x21​×p31​+p21​×x31​)⋅x41​+(x21​×x31​)⋅p41​​αI+1=0,​(23.3.2)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: (x21×x31)⋅x41(p21×p31)⋅p41αI3+(x21×x31)⋅x41(x21×p31+p21×x31)⋅p41+(p21×p31)⋅x41αI2+(x21×x31)⋅x41(x21×p31+p21×x31)⋅x41+(x21×x31)⋅p41αI+1=0,​(23.3.2)
- en: ensuring that magnitude checks can be safely performed with standard thresholds
    (e.g., 10−6).
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 确保可以使用标准阈值（例如，10−6）安全地进行量级检查。
- en: 'Practically, we also ensure some safety margin by solving for αI that reduces
    the volume of any tetrahedron by 80%, modifying the constant term coefficient
    in Equation [(23.3.2)](#eq:lec23:scaled_quad_eq_of_alphaI) from 1 to 0.8. If no
    positive real roots are found, the step size can be considered safe, and inversion
    will not occur. Here is the C++ code snippet for solving this scaled cubic equation:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，我们通过求解αI来确保一些安全余量，这可以减少任何四面体的体积80%，将方程[(23.3.2)](#eq:lec23:scaled_quad_eq_of_alphaI)中的常数项系数从1修改为0.8。如果没有找到正实根，步长可以被认为是安全的，并且不会发生反转。以下是解决此缩放三次方程的C++代码片段：
- en: '**Implementation 23.3.1 (Cubic Equation Solver).**'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现23.3.1（三次方程求解器）。**'
- en: '[PRE0]'
  id: totrans-11
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
