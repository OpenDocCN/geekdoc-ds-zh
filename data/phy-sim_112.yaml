- en: Discretization and Approximation
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 离散化和近似
- en: 原文：[https://phys-sim-book.github.io/lec22.1-disc_and_approx.html](https://phys-sim-book.github.io/lec22.1-disc_and_approx.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec22.1-disc_and_approx.html](https://phys-sim-book.github.io/lec22.1-disc_and_approx.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: From Equation [(18.4.2)](lec18.4-friction_force.html#eq:lec18:smooth-frict),
    the friction force per unit area is defined as
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 从方程 [(18.4.2)](lec18.4-friction_force.html#eq:lec18:smooth-frict) 中，单位面积的摩擦力定义为
- en: TF​(X,t)=−μ∥TC​(X,t)∥ f(∥VF​(X,t)∥) s(VF​(X,t)),
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: TF(X,t)=−μ∥TC(X,t)∥f(∥VF(X,t)∥)s(VF(X,t)),
- en: where μ is the friction coefficient, TC​ is the normal contact force, and VF​
    is the relative sliding velocity. Here s(VF​)=∥VF​∥VF​​ when ∥VF​∥>0, while s(VF​)
    takes any unit vector orthogonal to the normal N(X,t) when ∥VF​∥=0. Additionally,
    the friction scaling function f is also nonsmooth with respect to VF​, as f(∥VF​∥)=1
    when ∥VF​∥>0, and f(∥VF​∥)∈[0,1] when ∥VF​∥=0.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 μ 是摩擦系数，TC 是法向接触力，VF 是相对滑动速度。当 ∥VF∥>0 时，s(VF)=∥VF∥VF，而当 ∥VF∥=0 时，s(VF) 取与法向
    N(X,t) 正交的任何单位向量。此外，摩擦缩放函数 f 也相对于 VF 是非光滑的，因为当 ∥VF∥>0 时，f(∥VF∥)=1，而当 ∥VF∥=0 时，f(∥VF∥)∈[0,1]。
- en: It is important to note that without temporal discretization, there is no potential
    energy for friction. However, similar to [Frictional Contact](./lec9-friction.html),
    once we discretize the normal force magnitude and the tangent operator to the
    last time step and smoothly approximate the friction scaling function f, the friction
    force at the (n+1)-th time step becomes integrable with respect to x, and we obtain
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 需要注意的是，如果没有时间离散化，则不存在摩擦的势能。然而，类似于[摩擦接触](./lec9-friction.html)，一旦我们将法向力大小和切向算子离散化到最后一步，并平滑地近似摩擦缩放函数
    f，第 (n+1)-th 时间步的摩擦力相对于 x 变得可积，我们得到
- en: TFn+1​(X)≈−∂xn+1(X)∂Dn+1(X)​=−∂xn+1(X)∂(μ∥TCn​(X)∥f0​(∥VˉFn+1​(X)h^∥))​.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: TFn+1(X)≈−∂xn+1(X)∂Dn+1(X)​=−∂xn+1(X)∂(μ∥TCn​(X)∥f0​(∥VˉFn+1​(X)h^∥))​.
- en: Here, VˉFn+1​(X)=(I−Nn(X)Nn(X)T)(Vn+1(X)−Vn+1(X2​)) is the approximate relative
    sliding velocity, where Nn and X2​ are the normal direction and the point in contact
    with X in the last time step, h^I=(∂v/∂x)−1, and
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，VˉFn+1(X)=(I−Nn(X)Nn(X)T)(Vn+1(X)−Vn+1(X2)) 是近似相对滑动速度，其中 Nn 和 X2 是最后一步中与
    X 接触的法向和点，h^I=(∂v/∂x)−1，并且
- en: f0​(y)={−3ϵv2​h^2y3​+ϵv​h^y2​+3ϵv​h^​,y,​y∈[0,ϵv​h^);y≥ϵv​h^.​
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: f0(y)={−3ϵv2h^2y3+ϵvh^y2+3ϵvh^​,y,​y∈[0,ϵvh^);y≥ϵvh^.​
- en: Therefore, considering self-contact, the approximate friction potential over
    the entire boundary can be written as
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，考虑到自接触，整个边界的近似摩擦势可以写成
- en: ∫ΓC​​21​μ∥TCn​(X)∥f0​(∥VˉFn+1​(X)h^∥)ds(X),
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: ∫ΓC21μ∥TCn(X)∥f0(∥VˉFn+1(X)h^∥)ds(X),
- en: where the 21​ scaling comes from double counting the friction between each pair
    of contact points in the integral (similar to the normal contact forces in [Boundary
    Conditions and Frictional Contact](./lec18-BC_and_fric.html)).
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 21 的缩放来自积分中对每对接触点之间摩擦的双倍计数（类似于[边界条件和摩擦接触](./lec18-BC_and_fric.html)中的法向接触力）。
- en: 'After discretizing the boundary curves as polylines and approximating the max
    operator in the normal contact force component using summations ([Piecewise Linear
    Boundaries](./lec20-pw_linear_boundary.html)), we similarly obtain the spatially
    discretized friction potential:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在将边界曲线离散化为多边形并使用求和近似法向接触力分量中的最大运算符（[分段线性边界](./lec20-pw_linear_boundary.html)）之后，我们同样可以得到空间离散化的摩擦势：
- en: ∫ΓC​​e∈E−I(X)∑​21​μ(−∂d∂b(dPE(xn(X),e),d^)​)f0​(∥VˉFn+1​(X,e)h^∥)ds(X).
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: ∫ΓCe∈E−I(X)∑21μ(−∂d∂b(dPE(xn(X),e),d^)​)f0(∥VˉFn+1(X,e)h^∥)ds(X).
- en: Here, dPE(xn(X),e) is the point-edge distance between xn(X) and edge e in the
    last time step, and VˉFn+1​(X,e) is the approximate relative sliding velocity
    of the point-edge pair with contact normal and the closest point discretized to
    the last time step (see next section for details).
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，dPE(xn(X),e) 是 xn(X) 和最后一步中边 e 之间的点-边距离，VˉFn+1(X,e) 是具有接触法向和最近点离散化到最后一步的点-边对的近似相对滑动速度（参见下一节以获取详细信息）。
- en: 'If we choose boundary nodes as quadrature points to approximate the integral,
    we finally obtain our discrete friction potential:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们选择边界节点作为求积点来近似积分，我们最终得到我们的离散摩擦势：
- en: Pf​(x)​=a^∑​Aa^​e∈E−I(Xa^​)∑​21​μ(−∂d∂b(dPE(xa^n​,e),d^)​)f0​(∥VˉFn+1​(Xa^​,e)h^∥)=k∈{(a^,e)}∑​μλkn​f0​(∥vˉk​h^∥)​
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: Pf(x)​=a^∑Aa^​e∈E−I(Xa^​)∑21μ(−∂d∂b(dPE(xa^n​,e),d^)​)f0(∥VˉFn+1(Xa^​,e)h^∥)=k∈{(a^,e)}∑μλkn​f0(∥vˉk​h^∥)​
- en: where Aa^​=2∥Xa^​−Xa^−1​∥+∥Xa^​−Xa^+1​∥​ is the integration weight. Denoting
    vˉk​=VˉFn+1​(Xa^​,e) and λkn​=21​Aa^​(−∂d∂b(dPE(xa^n​,e),d^)​), the expression
    of Pf​ agrees with the discrete form of Equation [(9.2.1)](lec9.2-semi_imp_fric.html#eq:lec9:fric_potential)
    we directly derived, except that here k traverses all non-incident point-edge
    pairs on the boundary.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 其中，Aa^=2∥Xa^−Xa^−1∥+∥Xa^−Xa^+1∥是积分权重。令vˉk=VˉFn+1(Xa^,e)和λkn=21Aa^(-∂d/∂b(dPE(xa^n,
    e),d^))，Pf的表达式与直接导出的方程[(9.2.1)](lec9.2-semi_imp_fric.html#eq:lec9:fric_potential)的离散形式一致，只是这里的k遍历边界上的所有非入射点-边对。
- en: Based on this discrete form of the smoothed semi-implicit friction potential,
    we now need to determine how to calculate λ and vˉ for point-edge pairs, implement
    the computation of the value, gradient, and Hessian of Pf​(x), and then incorporate
    them into the optimization.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 基于此平滑半隐式摩擦势的离散形式，我们现在需要确定如何计算点-边对中的λ和vˉ，实现Pf(x)的值、梯度和Hessian的计算，然后将它们纳入优化过程。
