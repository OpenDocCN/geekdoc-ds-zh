- en: 11.1Â File Input and Output in PythonğŸ”—
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 11.1 Python ä¸­çš„æ–‡ä»¶è¾“å…¥å’Œè¾“å‡ºğŸ”—
- en: åŸæ–‡ï¼š[https://dcic-world.org/2025-08-27/python-fileio.html](https://dcic-world.org/2025-08-27/python-fileio.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://dcic-world.org/2025-08-27/python-fileio.html](https://dcic-world.org/2025-08-27/python-fileio.html)
- en: '| Â Â Â Â [11.1.1Â Basic File Operations](#%28part._.Basic_.File_.Operations%29)
    |'
  id: totrans-2
  prefs: []
  type: TYPE_TB
  zh: '|   [11.1.1 åŸºæœ¬æ–‡ä»¶æ“ä½œ](#%28part._.Basic_.File_.Operations%29) |'
- en: '| Â Â Â Â [11.1.2Â Reading CSV Files Step by Step](#%28part._.Reading_.C.S.V_.Files_.Step_by_.Step%29)
    |'
  id: totrans-3
  prefs: []
  type: TYPE_TB
  zh: '|   [11.1.2 é€æ­¥è¯»å– CSV æ–‡ä»¶](#%28part._.Reading_.C.S.V_.Files_.Step_by_.Step%29)
    |'
- en: '| Â Â Â Â [11.1.3Â Processing and Filtering Data](#%28part._.Processing_and_.Filtering_.Data%29)
    |'
  id: totrans-4
  prefs: []
  type: TYPE_TB
  zh: '|   [11.1.3 å¤„ç†å’Œè¿‡æ»¤æ•°æ®](#%28part._.Processing_and_.Filtering_.Data%29) |'
- en: '| Â Â Â Â [11.1.4Â Writing CSV Files](#%28part._.Writing_.C.S.V_.Files%29) |'
  id: totrans-5
  prefs: []
  type: TYPE_TB
  zh: '|   [11.1.4 å†™å…¥ CSV æ–‡ä»¶](#%28part._.Writing_.C.S.V_.Files%29) |'
- en: 'In [Introduction to Pandas](python-tables-Pandas.html), we loaded data from
    CSV (comma-separated value) files, but we let Pandas handle the low-level details:
    reading files and converting their contents into DataFrames.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ [Pandas ç®€ä»‹](python-tables-Pandas.html) ä¸­ï¼Œæˆ‘ä»¬åŠ è½½äº†æ¥è‡ª CSVï¼ˆé€—å·åˆ†éš”å€¼ï¼‰æ–‡ä»¶çš„æ•°æ®ï¼Œä½†æˆ‘ä»¬è®© Pandas
    å¤„ç†åº•å±‚ç»†èŠ‚ï¼šè¯»å–æ–‡ä»¶å¹¶å°†å†…å®¹è½¬æ¢ä¸º DataFrameã€‚
- en: In this chapter, weâ€™ll learn to read and write files using Pythonâ€™s basic file
    operations, using a simplified CSV processor as an example.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ ä½¿ç”¨ Python çš„åŸºæœ¬æ–‡ä»¶æ“ä½œæ¥è¯»å–å’Œå†™å…¥æ–‡ä»¶ï¼Œä»¥ç®€åŒ–çš„ CSV å¤„ç†å™¨ä¸ºä¾‹ã€‚
- en: While Pandas can certainly do all that we will do in this chapter (and more!),
    understanding how file operations work helps you become a more complete programmer,
    and to one day perhaps either create or work on libraries like Pandas.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: è™½ç„¶ Pandas å½“ç„¶å¯ä»¥å®Œæˆæˆ‘ä»¬å°†åœ¨æœ¬ç« ä¸­åšçš„ä¸€åˆ‡ï¼ˆä»¥åŠæ›´å¤šï¼‰ï¼Œä½†äº†è§£æ–‡ä»¶æ“ä½œæ˜¯å¦‚ä½•å·¥ä½œçš„æœ‰åŠ©äºä½ æˆä¸ºä¸€ä¸ªæ›´å…¨é¢çš„ç¨‹åºå‘˜ï¼Œä¹Ÿè®¸æœ‰ä¸€å¤©ä½ å¯èƒ½ä¼šåˆ›å»ºæˆ–å‚ä¸åƒ
    Pandas è¿™æ ·çš„åº“ã€‚
- en: 11.1.1Â Basic File Operations[ğŸ”—](#(part._.Basic_.File_.Operations) "Link to here")
  id: totrans-9
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 11.1.1 åŸºæœ¬æ–‡ä»¶æ“ä½œ[ğŸ”—](#(part._.Basic_.File_.Operations) "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'Python provides built-in functions for working with files. Before you can do
    anything else with a file, you must "open" it:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: Python æä¾›äº†ç”¨äºå¤„ç†æ–‡ä»¶çš„å†…ç½®å‡½æ•°ã€‚åœ¨ä½ å¯ä»¥å¯¹æ–‡ä»¶è¿›è¡Œä»»ä½•å…¶ä»–æ“ä½œä¹‹å‰ï¼Œä½ å¿…é¡»â€œæ‰“å¼€â€å®ƒï¼š
- en: '[PRE0]'
  id: totrans-11
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: This statement opens a file named `'data.csv'` in read mode (`'r'`). The `open`
    function returns a file object that we can use to read from or (if it were opened
    in the appropriate mode) write to the file.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ¡è¯­å¥ä»¥è¯»å–æ¨¡å¼ (`'r'`) æ‰“å¼€ä¸€ä¸ªåä¸º `'data.csv'` çš„æ–‡ä»¶ã€‚`open` å‡½æ•°è¿”å›ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥è¯»å–æ–‡ä»¶ï¼ˆå¦‚æœä»¥é€‚å½“çš„æ¨¡å¼æ‰“å¼€ï¼‰æˆ–å†™å…¥æ–‡ä»¶ã€‚
- en: Do Now!
  id: totrans-13
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç°åœ¨å°±åšï¼
- en: ''
  id: totrans-14
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: What do you think would happen if you tried to open a file that doesnâ€™t exist?
    Try it and see what error message you get.
  id: totrans-15
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä½ è®¤ä¸ºå¦‚æœä½ å°è¯•æ‰“å¼€ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿè¯•ä¸€è¯•ï¼Œçœ‹çœ‹ä½ ä¼šå¾—åˆ°ä»€ä¹ˆé”™è¯¯ä¿¡æ¯ã€‚
- en: 'Once we have a file object, we can read its contents in one of several ways:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦æˆ‘ä»¬æœ‰äº†æ–‡ä»¶å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‡ ç§æ–¹å¼è¯»å–å…¶å†…å®¹ï¼š
- en: 'Important: the file object remembers where in the file it is reading. This
    is how calling `.readline()` twice doesnâ€™t return the same line, it returns one
    line, and then the next. But, this also means that if you ran either `.read()`
    or `.readlines()`, you would have read the entire file, which means the position
    of the file object is now at the end, which means calling any of the other methods
    would return empty results â€“ empty strings for `.read()` or `.readline()`, and
    an empty list for `.readlines()`. You can move where the file object is pointing,
    with `.seek()`, but how that works is beyond our scope!'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: é‡è¦ï¼šæ–‡ä»¶å¯¹è±¡ä¼šè®°ä½å®ƒåœ¨æ–‡ä»¶ä¸­çš„ä½ç½®ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè°ƒç”¨ `.readline()` ä¸¤æ¬¡ä¸ä¼šè¿”å›ç›¸åŒçš„è¡Œï¼Œå®ƒä¼šè¿”å›ä¸€è¡Œï¼Œç„¶åæ˜¯ä¸‹ä¸€è¡Œã€‚ä½†æ˜¯ï¼Œè¿™ä¹Ÿæ„å‘³ç€å¦‚æœä½ è¿è¡Œäº†
    `.read()` æˆ– `.readlines()`ï¼Œä½ å°±å·²ç»è¯»å–äº†æ•´ä¸ªæ–‡ä»¶ï¼Œè¿™æ„å‘³ç€æ–‡ä»¶å¯¹è±¡çš„å½“å‰ä½ç½®ç°åœ¨åœ¨æ–‡ä»¶æœ«å°¾ï¼Œè¿™æ„å‘³ç€è°ƒç”¨ä»»ä½•å…¶ä»–æ–¹æ³•éƒ½ä¼šè¿”å›ç©ºç»“æœâ€”â€”`.read()`
    è¿”å›ç©ºå­—ç¬¦ä¸²ï¼Œ`.readline()` è¿”å›ç©ºåˆ—è¡¨ã€‚ä½ å¯ä»¥ä½¿ç”¨ `.seek()` ç§»åŠ¨æ–‡ä»¶å¯¹è±¡æŒ‡å‘çš„ä½ç½®ï¼Œä½†å®ƒçš„å…·ä½“å·¥ä½œåŸç†è¶…å‡ºäº†æˆ‘ä»¬çš„è®¨è®ºèŒƒå›´ï¼
- en: '[PRE1]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'When weâ€™re done using a file, we should always close it:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æˆ‘ä»¬å®Œæˆæ–‡ä»¶çš„ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å§‹ç»ˆåº”è¯¥å…³é—­å®ƒï¼š
- en: '[PRE2]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Do Now!
  id: totrans-21
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç°åœ¨å°±åšï¼
- en: ''
  id: totrans-22
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Why do you think it might be important to close files when youâ€™re done with
    them?
  id: totrans-23
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä½ è®¤ä¸ºä¸ºä»€ä¹ˆåœ¨å®Œæˆæ–‡ä»¶æ“ä½œåå…³é—­æ–‡ä»¶å¯èƒ½å¾ˆé‡è¦ï¼Ÿ
- en: 'Closing files is important because it frees up system resources and ensures
    that, if we were writing to the file (unlike in this example, where we are only
    reading) all pending writes actually get saved! However, manually remembering
    to close files can be error-prone. Python provides a more reliable way using the
    `with` statement:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: å…³é—­æ–‡ä»¶å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒå¯ä»¥é‡Šæ”¾ç³»ç»Ÿèµ„æºå¹¶ç¡®ä¿ï¼Œå¦‚æœæˆ‘ä»¬æ­£åœ¨å‘æ–‡ä»¶å†™å…¥ï¼ˆä¸è¿™ä¸ªä¾‹å­ä¸åŒï¼Œæˆ‘ä»¬åªæ˜¯åœ¨è¯»å–ï¼‰ï¼Œæ‰€æœ‰æŒ‚èµ·çš„å†™å…¥å®é™…ä¸Šéƒ½ä¼šè¢«ä¿å­˜ï¼ç„¶è€Œï¼Œæ‰‹åŠ¨è®°ä½å…³é—­æ–‡ä»¶å¯èƒ½ä¼šå‡ºé”™ã€‚Python
    æä¾›äº†ä¸€ç§æ›´å¯é çš„æ–¹æ³•ï¼Œä½¿ç”¨ `with` è¯­å¥ï¼š
- en: '[PRE3]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: In addition to not making us remember to close the files, it this approach also
    guarantees that the file will be closed even if an error occurs while processing
    it.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: é™¤äº†ä¸è®©æˆ‘ä»¬è®°ä½å…³é—­æ–‡ä»¶å¤–ï¼Œè¿™ç§æ–¹æ³•è¿˜ä¿è¯äº†å³ä½¿åœ¨å¤„ç†æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ï¼Œæ–‡ä»¶ä¹Ÿä¼šè¢«å…³é—­ã€‚
- en: 11.1.2Â Reading CSV Files Step by Step[ğŸ”—](#(part._.Reading_.C.S.V_.Files_.Step_by_.Step)
    "Link to here")
  id: totrans-27
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 11.1.2Â é€æ­¥è¯»å– CSV æ–‡ä»¶[ğŸ”—](#(part._.Reading_.C.S.V_.Files_.Step_by_.Step) "é“¾æ¥è‡³æ­¤")
- en: Letâ€™s work through reading a CSV file manually, as a way to practice using files
    for a practical (if small) example.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬æ‰‹åŠ¨å¤„ç†è¯»å– CSV æ–‡ä»¶ï¼Œä½œä¸ºç»ƒä¹ ä½¿ç”¨æ–‡ä»¶çš„ä¸€ä¸ªå®é™…ï¼ˆå°½ç®¡è§„æ¨¡è¾ƒå°ï¼‰çš„ä¾‹å­ã€‚
- en: 'Suppose we have a file called `orders.csv` with the following contents: (You
    can create this file with your editor of choice â€“ e.g., VSCode).'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º `orders.csv` çš„æ–‡ä»¶ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼šï¼ˆä½ å¯ä»¥ä½¿ç”¨ä½ é€‰æ‹©çš„ç¼–è¾‘å™¨åˆ›å»ºæ­¤æ–‡ä»¶ï¼Œä¾‹å¦‚ VSCodeï¼‰ã€‚
- en: '| dish,quantity,price,order_type |'
  id: totrans-30
  prefs: []
  type: TYPE_TB
  zh: '| èœå“ï¼Œæ•°é‡ï¼Œä»·æ ¼ï¼Œè®¢å•ç±»å‹ |'
- en: '| Pizza,2,25.0,dine-in |'
  id: totrans-31
  prefs: []
  type: TYPE_TB
  zh: '| æŠ«è¨ï¼Œ2ï¼Œ25.0ï¼Œå ‚é£Ÿ |'
- en: '| Salad,1,8.75,takeout |'
  id: totrans-32
  prefs: []
  type: TYPE_TB
  zh: '| æ²™æ‹‰ï¼Œ1ï¼Œ8.75ï¼Œå¤–å– |'
- en: '| Burger,3,30.0,dine-in |'
  id: totrans-33
  prefs: []
  type: TYPE_TB
  zh: '| æ±‰å ¡ï¼Œ3ï¼Œ30.0ï¼Œå ‚é£Ÿ |'
- en: '| Pizza,1,12.50,takeout |'
  id: totrans-34
  prefs: []
  type: TYPE_TB
  zh: '| æŠ«è¨ï¼Œ1ï¼Œ12.50ï¼Œå¤–å– |'
- en: 'Hereâ€™s how we can read and parse this file step by step:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯æˆ‘ä»¬å¯ä»¥é€æ­¥è¯»å–å’Œè§£ææ­¤æ–‡ä»¶çš„æ–¹æ³•ï¼š
- en: '[PRE4]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Letâ€™s break down what each step does:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬åˆ†è§£æ¯ä¸ªæ­¥éª¤çš„ä½œç”¨ï¼š
- en: '`file.readlines()` reads all lines from the file into a list of strings'
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`file.readlines()` å°†æ–‡ä»¶çš„æ‰€æœ‰è¡Œè¯»å–åˆ°å­—ç¬¦ä¸²åˆ—è¡¨ä¸­'
- en: We use a for loop to go through each line, using `line.strip()` to remove the
    newline character (`'\n'`) from the end of each line and then turning the line
    into a list of strings by `.split(',')`, which divides the string by the given
    string (which is not included).
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä½¿ç”¨ for å¾ªç¯éå†æ¯ä¸€è¡Œï¼Œä½¿ç”¨ `line.strip()` ä»æ¯è¡Œçš„æœ«å°¾ç§»é™¤æ¢è¡Œç¬¦ (`'\n'`)ï¼Œç„¶åé€šè¿‡ `.split(',')` å°†è¡Œè½¬æ¢ä¸ºå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œè¯¥å­—ç¬¦ä¸²é€šè¿‡ç»™å®šçš„å­—ç¬¦ä¸²ï¼ˆä¸åŒ…æ‹¬ï¼‰åˆ†å‰²ï¼š
- en: We separate the first row (header) from the data rows for easier processing
    â€“ the notation `data[1:]` is a special way of indicating we want "from index 1
    until as far as the list goes â€“ i.e., the end of the list.
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†ç¬¬ä¸€è¡Œï¼ˆæ ‡é¢˜ï¼‰ä¸æ•°æ®è¡Œåˆ†å¼€ï¼Œä»¥ä¾¿æ›´å®¹æ˜“å¤„ç†â€”â€”è¡¨ç¤º `data[1:]` æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–¹å¼ï¼Œè¡¨ç¤ºæˆ‘ä»¬æƒ³è¦ "ä»ç´¢å¼• 1 åˆ°åˆ—è¡¨çš„æœ«å°¾â€”â€”å³ï¼Œåˆ—è¡¨çš„æœ«å°¾"ã€‚
- en: Do Now!
  id: totrans-41
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç«‹åˆ»è¡ŒåŠ¨ï¼
- en: ''
  id: totrans-42
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: What would our code do if one of the cells in your CSV contained a comma? For
    example, what if a dish name was "Mac and cheese, deluxe"? How could you handle
    this?
  id: totrans-43
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å¦‚æœä½ çš„ CSV ä¸­çš„ä¸€ä¸ªå•å…ƒæ ¼åŒ…å«é€—å·ï¼Œä½ çš„ä»£ç ä¼šåšä»€ä¹ˆï¼Ÿä¾‹å¦‚ï¼Œå¦‚æœèœå“åç§°æ˜¯ "Mac and cheese, deluxe"ï¼Œä½ å°†å¦‚ä½•å¤„ç†è¿™ç§æƒ…å†µï¼Ÿ
- en: 11.1.3Â Processing and Filtering Data[ğŸ”—](#(part._.Processing_and_.Filtering_.Data)
    "Link to here")
  id: totrans-44
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 11.1.3Â å¤„ç†å’Œè¿‡æ»¤æ•°æ®[ğŸ”—](#(part._.Processing_and_.Filtering_.Data) "é“¾æ¥è‡³æ­¤")
- en: Once we have our data as a list of lists, we can process it using the same programming
    techniques weâ€™ve learned, by using the `.index()` method to return the numeric
    offset of the given string in a list of strings â€“ this is how we will find the
    columns we are interested in, and then use that to index into the row.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦æˆ‘ä»¬å°†æ•°æ®ä½œä¸ºåˆ—è¡¨çš„åˆ—è¡¨å½¢å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬å­¦è¿‡çš„ç›¸åŒç¼–ç¨‹æŠ€æœ¯æ¥å¤„ç†å®ƒï¼Œé€šè¿‡ä½¿ç”¨ `.index()` æ–¹æ³•æ¥è¿”å›ç»™å®šå­—ç¬¦ä¸²åœ¨å­—ç¬¦ä¸²åˆ—è¡¨ä¸­çš„æ•°å­—åç§»é‡â€”â€”è¿™å°±æ˜¯æˆ‘ä»¬å°†å¦‚ä½•æ‰¾åˆ°æˆ‘ä»¬æ„Ÿå…´è¶£çš„åˆ—ï¼Œç„¶åä½¿ç”¨å®ƒæ¥ç´¢å¼•è¡Œã€‚
- en: 'For example, letâ€™s filter for only takeout orders:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬è¿‡æ»¤å‡ºåªæœ‰å¤–å–è®¢å•ï¼š
- en: '[PRE5]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'We can also convert data types as needed. For instance, if we want to calculate
    total revenue, we need to not only find the quantity and price for each row, but
    convert the strings that are in the row (since the file was all strings!) to numbers
    before multiplying:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è¿˜å¯ä»¥æ ¹æ®éœ€è¦è½¬æ¢æ•°æ®ç±»å‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è®¡ç®—æ€»æ”¶å…¥ï¼Œæˆ‘ä»¬ä¸ä»…éœ€è¦æ‰¾åˆ°æ¯è¡Œçš„æ•°é‡å’Œä»·æ ¼ï¼Œè¿˜éœ€è¦åœ¨ä¹˜æ³•ä¹‹å‰å°†è¡Œä¸­çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—ï¼š
- en: '[PRE6]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Do Now!
  id: totrans-50
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç«‹åˆ»è¡ŒåŠ¨ï¼
- en: ''
  id: totrans-51
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: What would happen if one of the quantity cells contained invalid data, like
    the string "three" instead of the number 3? How could you make your code more
    robust to handle such errors?
  id: totrans-52
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å¦‚æœå…¶ä¸­ä¸€ä¸ªæ•°é‡å•å…ƒæ ¼åŒ…å«æ— æ•ˆæ•°æ®ï¼Œæ¯”å¦‚å­—ç¬¦ä¸² "three" è€Œä¸æ˜¯æ•°å­— 3ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä½ å¦‚ä½•ä½¿ä½ çš„ä»£ç æ›´åŠ å¥å£®ä»¥å¤„ç†æ­¤ç±»é”™è¯¯ï¼Ÿ
- en: 11.1.4Â Writing CSV Files[ğŸ”—](#(part._.Writing_.C.S.V_.Files) "Link to here")
  id: totrans-53
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 11.1.4Â å†™å…¥ CSV æ–‡ä»¶[ğŸ”—](#(part._.Writing_.C.S.V_.Files) "é“¾æ¥è‡³æ­¤")
- en: 'Writing CSV files follows a similar pattern. We need to:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: å†™å…¥ CSV æ–‡ä»¶éµå¾ªç±»ä¼¼çš„æ¨¡å¼ã€‚æˆ‘ä»¬éœ€è¦ï¼š
- en: Open a file in write mode
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä»¥å†™å…¥æ¨¡å¼æ‰“å¼€æ–‡ä»¶
- en: Convert our data to the proper string format
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å°†æˆ‘ä»¬çš„æ•°æ®è½¬æ¢ä¸ºé€‚å½“çš„å­—ç¬¦ä¸²æ ¼å¼
- en: Write the strings to the file
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å°†å­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶
- en: 'Hereâ€™s how to write our filtered takeout orders to a new file:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯å°†æˆ‘ä»¬çš„è¿‡æ»¤åçš„å¤–å–è®¢å•å†™å…¥æ–°æ–‡ä»¶çš„æ–¹æ³•ï¼š
- en: '[PRE7]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The key steps here are:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œå…³é”®æ­¥éª¤æ˜¯ï¼š
- en: '`'',''.join(row)` combines the list elements into a single string with commas
    between them'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`'',''.join(row)` å°†åˆ—è¡¨å…ƒç´ åˆå¹¶æˆä¸€ä¸ªå¸¦æœ‰é€—å·çš„å•ç‹¬å­—ç¬¦ä¸²'
- en: We add `'\n'` to create a new line after each row
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æ·»åŠ  `'\n'` ä»¥åœ¨æ¯è¡Œååˆ›å»ºä¸€ä¸ªæ–°è¡Œ
- en: '`file.write()` writes the string to the file'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`file.write()` å°†å­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶'
- en: Note that we call `.write()` once for each line â€“ we could have combined all
    the lines into a single string, and only called `.write()` once, but there is
    no need to â€“ just like how file objects remember where we are reading from them,
    they remember where we were writing, so the next call to `.write()` will add the
    next string after the previous one.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸€è¡Œè°ƒç”¨ä¸€æ¬¡ `.write()` â€”â€”æˆ‘ä»¬æœ¬å¯ä»¥å°†æ‰€æœ‰è¡Œåˆå¹¶æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶ååªè°ƒç”¨ä¸€æ¬¡ `.write()`ï¼Œä½†è¿™æ ·åšæ²¡æœ‰å¿…è¦â€”â€”å°±åƒæ–‡ä»¶å¯¹è±¡ä¼šè®°ä½æˆ‘ä»¬ä»å“ªé‡Œè¯»å–ä¸€æ ·ï¼Œå®ƒä»¬ä¹Ÿä¼šè®°ä½æˆ‘ä»¬æ›¾ç»åœ¨å“ªé‡Œå†™å…¥ï¼Œæ‰€ä»¥ä¸‹ä¸€æ¬¡è°ƒç”¨
    `.write()` å°†åœ¨ä¸Šä¸€è¡Œçš„å­—ç¬¦ä¸²ä¹‹åæ·»åŠ ä¸‹ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚
- en: Do Now!
  id: totrans-65
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç°åœ¨å°±åšï¼
- en: ''
  id: totrans-66
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Try writing a program that reads a CSV file, adds a new column with calculated
    values (like total price = quantity Ã— price), and writes the result to a new file.
  id: totrans-67
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å°è¯•ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œè¯»å– CSV æ–‡ä»¶ï¼Œæ·»åŠ ä¸€ä¸ªåŒ…å«è®¡ç®—å€¼çš„æ–°åˆ—ï¼ˆå¦‚æ€»ä»· = æ•°é‡ Ã— ä»·æ ¼ï¼‰ï¼Œå¹¶å°†ç»“æœå†™å…¥æ–°æ–‡ä»¶ã€‚
- en: 11.1.1Â Basic File Operations[ğŸ”—](#(part._.Basic_.File_.Operations) "Link to here")
  id: totrans-68
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 11.1.1 åŸºæœ¬æ–‡ä»¶æ“ä½œ[ğŸ”—](#(part._.Basic_.File_.Operations) "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'Python provides built-in functions for working with files. Before you can do
    anything else with a file, you must "open" it:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: Python æä¾›äº†ç”¨äºå¤„ç†æ–‡ä»¶çš„å†…ç½®å‡½æ•°ã€‚åœ¨ä½ å¯ä»¥å¯¹æ–‡ä»¶è¿›è¡Œä»»ä½•å…¶ä»–æ“ä½œä¹‹å‰ï¼Œä½ å¿…é¡»â€œæ‰“å¼€â€å®ƒï¼š
- en: '[PRE8]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: This statement opens a file named `'data.csv'` in read mode (`'r'`). The `open`
    function returns a file object that we can use to read from or (if it were opened
    in the appropriate mode) write to the file.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªè¯­å¥ä»¥è¯»å–æ¨¡å¼ï¼ˆ`'r'`ï¼‰æ‰“å¼€ä¸€ä¸ªåä¸º `'data.csv'` çš„æ–‡ä»¶ã€‚`open` å‡½æ•°è¿”å›ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥è¯»å–æ–‡ä»¶ï¼ˆå¦‚æœä»¥é€‚å½“çš„æ¨¡å¼æ‰“å¼€ï¼‰æˆ–å†™å…¥æ–‡ä»¶ã€‚
- en: Do Now!
  id: totrans-72
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç°åœ¨å°±åšï¼
- en: ''
  id: totrans-73
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: What do you think would happen if you tried to open a file that doesnâ€™t exist?
    Try it and see what error message you get.
  id: totrans-74
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä½ è®¤ä¸ºå¦‚æœä½ å°è¯•æ‰“å¼€ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿè¯•ä¸€è¯•ï¼Œçœ‹çœ‹ä½ ä¼šå¾—åˆ°ä»€ä¹ˆé”™è¯¯ä¿¡æ¯ã€‚
- en: 'Once we have a file object, we can read its contents in one of several ways:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦æˆ‘ä»¬æœ‰äº†æ–‡ä»¶å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‡ ç§æ–¹å¼è¯»å–å…¶å†…å®¹ï¼š
- en: 'Important: the file object remembers where in the file it is reading. This
    is how calling `.readline()` twice doesnâ€™t return the same line, it returns one
    line, and then the next. But, this also means that if you ran either `.read()`
    or `.readlines()`, you would have read the entire file, which means the position
    of the file object is now at the end, which means calling any of the other methods
    would return empty results â€“ empty strings for `.read()` or `.readline()`, and
    an empty list for `.readlines()`. You can move where the file object is pointing,
    with `.seek()`, but how that works is beyond our scope!'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: é‡è¦ï¼šæ–‡ä»¶å¯¹è±¡ä¼šè®°ä½å®ƒåœ¨æ–‡ä»¶ä¸­çš„è¯»å–ä½ç½®ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè°ƒç”¨ `.readline()` ä¸¤æ¬¡ä¸ä¼šè¿”å›ç›¸åŒçš„è¡Œï¼Œå®ƒä¼šè¿”å›ä¸€è¡Œï¼Œç„¶åæ˜¯ä¸‹ä¸€è¡Œã€‚ä½†æ˜¯ï¼Œè¿™ä¹Ÿæ„å‘³ç€å¦‚æœä½ è¿è¡Œäº†
    `.read()` æˆ– `.readlines()`ï¼Œä½ å°±å·²ç»è¯»å–äº†æ•´ä¸ªæ–‡ä»¶ï¼Œè¿™æ„å‘³ç€æ–‡ä»¶å¯¹è±¡çš„å½“å‰ä½ç½®ç°åœ¨åœ¨æ–‡ä»¶æœ«å°¾ï¼Œè¿™æ„å‘³ç€è°ƒç”¨ä»»ä½•å…¶ä»–æ–¹æ³•éƒ½ä¼šè¿”å›ç©ºç»“æœâ€”â€”`.read()`
    è¿”å›ç©ºå­—ç¬¦ä¸²ï¼Œ`.readline()` è¿”å›ç©ºåˆ—è¡¨ã€‚ä½ å¯ä»¥ä½¿ç”¨ `.seek()` ç§»åŠ¨æ–‡ä»¶å¯¹è±¡æŒ‡å‘çš„ä½ç½®ï¼Œä½†å®ƒçš„å…·ä½“å·¥ä½œåŸç†è¶…å‡ºäº†æˆ‘ä»¬çš„è®¨è®ºèŒƒå›´ï¼
- en: '[PRE9]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'When weâ€™re done using a file, we should always close it:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æˆ‘ä»¬å®Œæˆæ–‡ä»¶çš„ä½¿ç”¨åï¼Œæˆ‘ä»¬åº”å§‹ç»ˆå…³é—­å®ƒï¼š
- en: '[PRE10]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Do Now!
  id: totrans-80
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç°åœ¨å°±åšï¼
- en: ''
  id: totrans-81
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Why do you think it might be important to close files when youâ€™re done with
    them?
  id: totrans-82
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä½ è®¤ä¸ºä¸ºä»€ä¹ˆåœ¨å®Œæˆæ–‡ä»¶ä½¿ç”¨åå…³é—­æ–‡ä»¶å¯èƒ½å¾ˆé‡è¦ï¼Ÿ
- en: 'Closing files is important because it frees up system resources and ensures
    that, if we were writing to the file (unlike in this example, where we are only
    reading) all pending writes actually get saved! However, manually remembering
    to close files can be error-prone. Python provides a more reliable way using the
    `with` statement:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: å…³é—­æ–‡ä»¶å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒå¯ä»¥é‡Šæ”¾ç³»ç»Ÿèµ„æºï¼Œå¹¶ç¡®ä¿å¦‚æœæˆ‘ä»¬æ­£åœ¨å†™å…¥æ–‡ä»¶ï¼ˆä¸è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬åªè¯»å–ä¸åŒï¼‰ï¼Œæ‰€æœ‰æŒ‚èµ·çš„å†™å…¥å®é™…ä¸Šéƒ½ä¼šè¢«ä¿å­˜ï¼ç„¶è€Œï¼Œæ‰‹åŠ¨è®°ä½å…³é—­æ–‡ä»¶å¯èƒ½ä¼šå‡ºé”™ã€‚Python
    æä¾›äº†ä¸€ç§æ›´å¯é çš„æ–¹æ³•ï¼Œä½¿ç”¨ `with` è¯­å¥ï¼š
- en: '[PRE11]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: In addition to not making us remember to close the files, it this approach also
    guarantees that the file will be closed even if an error occurs while processing
    it.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: é™¤äº†ä¸éœ€è¦æˆ‘ä»¬è®°ä½å…³é—­æ–‡ä»¶å¤–ï¼Œè¿™ç§æ–¹æ³•è¿˜ä¿è¯äº†å³ä½¿åœ¨å¤„ç†æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ï¼Œæ–‡ä»¶ä¹Ÿä¼šè¢«å…³é—­ã€‚
- en: 11.1.2Â Reading CSV Files Step by Step[ğŸ”—](#(part._.Reading_.C.S.V_.Files_.Step_by_.Step)
    "Link to here")
  id: totrans-86
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 11.1.2 é€æ­¥è¯»å– CSV æ–‡ä»¶[ğŸ”—](#(part._.Reading_.C.S.V_.Files_.Step_by_.Step) "é“¾æ¥åˆ°æ­¤å¤„")
- en: Letâ€™s work through reading a CSV file manually, as a way to practice using files
    for a practical (if small) example.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬é€šè¿‡æ‰‹åŠ¨è¯»å– CSV æ–‡ä»¶æ¥ç»ƒä¹ ä½¿ç”¨æ–‡ä»¶ï¼Œä½œä¸ºä¸€ä¸ªå®é™…ï¼ˆå°½ç®¡è§„æ¨¡è¾ƒå°ï¼‰çš„ä¾‹å­ã€‚
- en: 'Suppose we have a file called `orders.csv` with the following contents: (You
    can create this file with your editor of choice â€“ e.g., VSCode).'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º `orders.csv` çš„æ–‡ä»¶ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼šï¼ˆä½ å¯ä»¥ä½¿ç”¨ä½ é€‰æ‹©çš„ç¼–è¾‘å™¨åˆ›å»ºæ­¤æ–‡ä»¶ï¼Œä¾‹å¦‚ VSCodeï¼‰ã€‚
- en: '| dish,quantity,price,order_type |'
  id: totrans-89
  prefs: []
  type: TYPE_TB
  zh: '| èœå“,æ•°é‡,ä»·æ ¼,è®¢å•ç±»å‹ |'
- en: '| Pizza,2,25.0,dine-in |'
  id: totrans-90
  prefs: []
  type: TYPE_TB
  zh: '| æŠ«è¨,2,25.0,å ‚é£Ÿ |'
- en: '| Salad,1,8.75,takeout |'
  id: totrans-91
  prefs: []
  type: TYPE_TB
  zh: '| æ²™æ‹‰,1,8.75,å¤–å– |'
- en: '| Burger,3,30.0,dine-in |'
  id: totrans-92
  prefs: []
  type: TYPE_TB
  zh: '| æ±‰å ¡,3,30.0,å ‚é£Ÿ |'
- en: '| Pizza,1,12.50,takeout |'
  id: totrans-93
  prefs: []
  type: TYPE_TB
  zh: '| æŠ«è¨,1,12.50,å¤–å– |'
- en: 'Hereâ€™s how we can read and parse this file step by step:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹é¢æ˜¯å¦‚ä½•é€æ­¥è¯»å–å’Œè§£æè¿™ä¸ªæ–‡ä»¶çš„æ­¥éª¤ï¼š
- en: '[PRE12]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Letâ€™s break down what each step does:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬åˆ†è§£æ¯ä¸ªæ­¥éª¤çš„ä½œç”¨ï¼š
- en: '`file.readlines()` reads all lines from the file into a list of strings'
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`file.readlines()` è¯»å–æ–‡ä»¶ä¸­çš„æ‰€æœ‰è¡Œåˆ°ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ä¸­'
- en: We use a for loop to go through each line, using `line.strip()` to remove the
    newline character (`'\n'`) from the end of each line and then turning the line
    into a list of strings by `.split(',')`, which divides the string by the given
    string (which is not included).
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä½¿ç”¨ for å¾ªç¯éå†æ¯ä¸€è¡Œï¼Œä½¿ç”¨ `line.strip()` ä»æ¯ä¸€è¡Œçš„æœ«å°¾ç§»é™¤æ¢è¡Œç¬¦ (`'\n'`)ï¼Œç„¶åé€šè¿‡ `.split(',')`
    å°†è¡Œè½¬æ¢ä¸ºå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œè¯¥æ“ä½œé€šè¿‡ç»™å®šçš„å­—ç¬¦ä¸²ï¼ˆä¸åŒ…æ‹¬ï¼‰æ¥åˆ†å‰²å­—ç¬¦ä¸²ã€‚
- en: We separate the first row (header) from the data rows for easier processing
    â€“ the notation `data[1:]` is a special way of indicating we want "from index 1
    until as far as the list goes â€“ i.e., the end of the list.
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†ç¬¬ä¸€è¡Œï¼ˆæ ‡é¢˜è¡Œï¼‰ä¸æ•°æ®è¡Œåˆ†å¼€ï¼Œä»¥ä¾¿æ›´å®¹æ˜“å¤„ç†â€”â€”è¡¨ç¤ºæ³• `data[1:]` æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–¹å¼ï¼Œè¡¨ç¤ºæˆ‘ä»¬æƒ³è¦ "ä»ç´¢å¼• 1 å¼€å§‹ç›´åˆ°åˆ—è¡¨çš„æœ«å°¾â€”â€”å³ï¼Œåˆ—è¡¨çš„æœ«å°¾ã€‚
- en: Do Now!
  id: totrans-100
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç«‹å³è¡ŒåŠ¨ï¼
- en: ''
  id: totrans-101
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: What would our code do if one of the cells in your CSV contained a comma? For
    example, what if a dish name was "Mac and cheese, deluxe"? How could you handle
    this?
  id: totrans-102
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å¦‚æœä½ çš„ CSV ä¸­çš„ä¸€ä¸ªå•å…ƒæ ¼åŒ…å«é€—å·ï¼Œæˆ‘ä»¬çš„ä»£ç ä¼šåšä»€ä¹ˆï¼Ÿä¾‹å¦‚ï¼Œå¦‚æœä¸€é“èœåæ˜¯ "Mac and cheese, deluxe"ï¼Œè¯¥å¦‚ä½•å¤„ç†è¿™ç§æƒ…å†µï¼Ÿ
- en: 11.1.3Â Processing and Filtering Data[ğŸ”—](#(part._.Processing_and_.Filtering_.Data)
    "Link to here")
  id: totrans-103
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 11.1.3Â å¤„ç†å’Œç­›é€‰æ•°æ®[ğŸ”—](#(part._.Processing_and_.Filtering_.Data) "é“¾æ¥åˆ°æ­¤å¤„")
- en: Once we have our data as a list of lists, we can process it using the same programming
    techniques weâ€™ve learned, by using the `.index()` method to return the numeric
    offset of the given string in a list of strings â€“ this is how we will find the
    columns we are interested in, and then use that to index into the row.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦æˆ‘ä»¬å°†æ•°æ®ä½œä¸ºåˆ—è¡¨çš„åˆ—è¡¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬å­¦åˆ°çš„ç›¸åŒç¼–ç¨‹æŠ€æœ¯æ¥å¤„ç†å®ƒï¼Œé€šè¿‡ä½¿ç”¨ `.index()` æ–¹æ³•è¿”å›ç»™å®šå­—ç¬¦ä¸²åœ¨å­—ç¬¦ä¸²åˆ—è¡¨ä¸­çš„æ•°å­—åç§»é‡â€”â€”è¿™å°±æ˜¯æˆ‘ä»¬å°†å¦‚ä½•æ‰¾åˆ°æˆ‘ä»¬æ„Ÿå…´è¶£çš„åˆ—ï¼Œç„¶åä½¿ç”¨å®ƒæ¥ç´¢å¼•è¡Œã€‚
- en: 'For example, letâ€™s filter for only takeout orders:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬ç­›é€‰å‡ºä»…å¤–å–è®¢å•ï¼š
- en: '[PRE13]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'We can also convert data types as needed. For instance, if we want to calculate
    total revenue, we need to not only find the quantity and price for each row, but
    convert the strings that are in the row (since the file was all strings!) to numbers
    before multiplying:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è¿˜å¯ä»¥æ ¹æ®éœ€è¦è½¬æ¢æ•°æ®ç±»å‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è®¡ç®—æ€»æ”¶å…¥ï¼Œæˆ‘ä»¬ä¸ä»…éœ€è¦æ‰¾åˆ°æ¯ä¸€è¡Œçš„æ•°é‡å’Œä»·æ ¼ï¼Œè¿˜éœ€è¦åœ¨ä¹˜æ³•ä¹‹å‰å°†è¡Œä¸­çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—ï¼š
- en: '[PRE14]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Do Now!
  id: totrans-109
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç«‹å³è¡ŒåŠ¨ï¼
- en: ''
  id: totrans-110
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: What would happen if one of the quantity cells contained invalid data, like
    the string "three" instead of the number 3? How could you make your code more
    robust to handle such errors?
  id: totrans-111
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å¦‚æœå…¶ä¸­ä¸€ä¸ªæ•°é‡å•å…ƒæ ¼åŒ…å«æ— æ•ˆæ•°æ®ï¼Œæ¯”å¦‚å­—ç¬¦ä¸² "three" è€Œä¸æ˜¯æ•°å­— 3ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä½ è¯¥å¦‚ä½•ä½¿ä½ çš„ä»£ç æ›´åŠ å¥å£®ä»¥å¤„ç†æ­¤ç±»é”™è¯¯ï¼Ÿ
- en: 11.1.4Â Writing CSV Files[ğŸ”—](#(part._.Writing_.C.S.V_.Files) "Link to here")
  id: totrans-112
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 11.1.4Â ç¼–å†™ CSV æ–‡ä»¶[ğŸ”—](#(part._.Writing_.C.S.V_.Files) "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'Writing CSV files follows a similar pattern. We need to:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: ç¼–å†™ CSV æ–‡ä»¶éµå¾ªç±»ä¼¼çš„æ¨¡å¼ã€‚æˆ‘ä»¬éœ€è¦ï¼š
- en: Open a file in write mode
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä»¥å†™å…¥æ¨¡å¼æ‰“å¼€æ–‡ä»¶
- en: Convert our data to the proper string format
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å°†æˆ‘ä»¬çš„æ•°æ®è½¬æ¢ä¸ºé€‚å½“çš„å­—ç¬¦ä¸²æ ¼å¼
- en: Write the strings to the file
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å°†å­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶
- en: 'Hereâ€™s how to write our filtered takeout orders to a new file:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯å°†æˆ‘ä»¬çš„ç­›é€‰å¤–å–è®¢å•å†™å…¥æ–°æ–‡ä»¶çš„æ–¹æ³•ï¼š
- en: '[PRE15]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'The key steps here are:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œå…³é”®æ­¥éª¤æ˜¯ï¼š
- en: '`'',''.join(row)` combines the list elements into a single string with commas
    between them'
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`'',''.join(row)` å°†åˆ—è¡¨å…ƒç´ åˆå¹¶æˆä¸€ä¸ªå¸¦æœ‰é€—å·çš„å•ä¸€å­—ç¬¦ä¸²'
- en: We add `'\n'` to create a new line after each row
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æ·»åŠ  `'\n'` åœ¨æ¯ä¸€è¡Œååˆ›å»ºä¸€ä¸ªæ–°è¡Œ
- en: '`file.write()` writes the string to the file'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`file.write()` å°†å­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶'
- en: Note that we call `.write()` once for each line â€“ we could have combined all
    the lines into a single string, and only called `.write()` once, but there is
    no need to â€“ just like how file objects remember where we are reading from them,
    they remember where we were writing, so the next call to `.write()` will add the
    next string after the previous one.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸€è¡Œè°ƒç”¨ `.write()` ä¸€æ¬¡â€”â€”æˆ‘ä»¬æœ¬å¯ä»¥å°†æ‰€æœ‰è¡Œåˆå¹¶æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶ååªè°ƒç”¨ä¸€æ¬¡ `.write()`ï¼Œä½†è¿™æ ·åšæ²¡æœ‰å¿…è¦â€”â€”å°±åƒæ–‡ä»¶å¯¹è±¡è®°å¾—æˆ‘ä»¬ä»å®ƒä»¬é‚£é‡Œè¯»å–çš„ä½ç½®ä¸€æ ·ï¼Œå®ƒä»¬ä¹Ÿè®°å¾—æˆ‘ä»¬å†™å…¥çš„ä½ç½®ï¼Œæ‰€ä»¥ä¸‹ä¸€æ¬¡è°ƒç”¨
    `.write()` å°†åœ¨ä¸Šä¸€æ¡å­—ç¬¦ä¸²ä¹‹åæ·»åŠ ä¸‹ä¸€æ¡å­—ç¬¦ä¸²ã€‚
- en: Do Now!
  id: totrans-124
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç«‹å³è¡ŒåŠ¨ï¼
- en: ''
  id: totrans-125
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Try writing a program that reads a CSV file, adds a new column with calculated
    values (like total price = quantity Ã— price), and writes the result to a new file.
  id: totrans-126
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å°è¯•ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œè¯¥ç¨‹åºè¯»å– CSV æ–‡ä»¶ï¼Œæ·»åŠ ä¸€ä¸ªåŒ…å«è®¡ç®—å€¼çš„æ–°åˆ—ï¼ˆå¦‚æ€»ä»· = æ•°é‡ Ã— ä»·æ ¼ï¼‰ï¼Œå¹¶å°†ç»“æœå†™å…¥æ–°æ–‡ä»¶ã€‚
