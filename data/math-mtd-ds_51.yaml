- en: 6.7\. Online supplementary materials#
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 6.7\. 在线补充材料#
- en: 原文：[https://mmids-textbook.github.io/chap06_prob/supp/roch-mmids-prob-supp.html](https://mmids-textbook.github.io/chap06_prob/supp/roch-mmids-prob-supp.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://mmids-textbook.github.io/chap06_prob/supp/roch-mmids-prob-supp.html](https://mmids-textbook.github.io/chap06_prob/supp/roch-mmids-prob-supp.html)
- en: 6.7.1\. Quizzes, solutions, code, etc.[#](#quizzes-solutions-code-etc "Link
    to this heading")
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 6.7.1\. 测验、解答、代码等.[#](#quizzes-solutions-code-etc "链接到本标题")
- en: 6.7.1.1\. Just the code[#](#just-the-code "Link to this heading")
  id: totrans-3
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.1.1\. 仅代码[#](#just-the-code "链接到本标题")
- en: An interactive Jupyter notebook featuring the code in this chapter can be accessed
    below (Google Colab recommended). You are encouraged to tinker with it. Some suggested
    computational exercises are scattered throughout. The notebook is also available
    as a slideshow.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 一个包含本章代码的交互式Jupyter笔记本可以在此访问（推荐使用Google Colab）。鼓励您对其进行尝试。一些建议的计算练习散布在其中。笔记本也可以作为幻灯片查看。
- en: '[Notebook](https://github.com/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/just_the_code/roch_mmids_chap_prob_notebook.ipynb)
    ([Open In Colab](https://colab.research.google.com/github/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/just_the_code/roch_mmids_chap_prob_notebook.ipynb))'
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[笔记本](https://github.com/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/just_the_code/roch_mmids_chap_prob_notebook.ipynb)
    ([在Colab中打开](https://colab.research.google.com/github/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/just_the_code/roch_mmids_chap_prob_notebook.ipynb))'
- en: '[Slideshow](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/just_the_code/roch_mmids_chap_prob_notebook_slides.slides.html)'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[幻灯片](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/just_the_code/roch_mmids_chap_prob_notebook_slides.slides.html)'
- en: 6.7.1.2\. Self-assessment quizzes[#](#self-assessment-quizzes "Link to this
    heading")
  id: totrans-7
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.1.2\. 自我评估测验[#](#self-assessment-quizzes "链接到本标题")
- en: A more extensive web version of the self-assessment quizzes is available by
    following the links below.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 通过以下链接可以获取更全面的自我评估测验的网页版本。
- en: '[Section 6.2](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_2.html)'
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第6.2节](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_2.html)'
- en: '[Section 6.3](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_3.html)'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第6.3节](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_3.html)'
- en: '[Section 6.4](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_4.html)'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第6.4节](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_4.html)'
- en: '[Section 6.5](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_5.html)'
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第6.5节](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_5.html)'
- en: 6.7.1.3\. Auto-quizzes[#](#auto-quizzes "Link to this heading")
  id: totrans-13
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.1.3\. 自动测验[#](#auto-quizzes "链接到本标题")
- en: Automatically generated quizzes for this chapter can be accessed here (Google
    Colab recommended).
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 可以在此处访问本章的自动生成的测验（推荐使用Google Colab）。
- en: '[Auto-quizzes](https://github.com/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/quizzes/auto_quizzes/roch-mmids-prob-autoquiz.ipynb)
    ([Open In Colab](https://colab.research.google.com/github/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/quizzes/auto_quizzes/roch-mmids-prob-autoquiz.ipynb))'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[自动测验](https://github.com/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/quizzes/auto_quizzes/roch-mmids-prob-autoquiz.ipynb)
    ([在Colab中打开](https://colab.research.google.com/github/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/quizzes/auto_quizzes/roch-mmids-prob-autoquiz.ipynb))'
- en: 6.7.1.4\. Solutions to odd-numbered warm-up exercises[#](#solutions-to-odd-numbered-warm-up-exercises
    "Link to this heading")
  id: totrans-16
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.1.4\. 奇数编号预热练习的解答[#](#solutions-to-odd-numbered-warm-up-exercises "链接到本标题")
- en: '*(with help from Claude, Gemini, and ChatGPT)*'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: '*(由Claude、Gemini和ChatGPT协助)*'
- en: '**E6.2.1** The probability of \(Y\) being in the second category is:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.2.1** \(Y\) 落在第二类中的概率是：'
- en: \[ \mathbb{P}(Y = e_2) = \pi_2 = 0.5. \]
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbb{P}(Y = e_2) = \pi_2 = 0.5. \]
- en: '**E6.2.3** Let \(X_1, \ldots, X_n\) be i.i.d. Bernoulli\((q^*)\). The MLE is
    \(\hat{q}_{\mathrm{MLE}} = \frac{1}{n} \sum_{i=1}^n X_i\). By the Law of Large
    Numbers, as \(n \to \infty\),'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.2.3** 设 \(X_1, \ldots, X_n\) 为独立同分布的伯努利\((q^*)\)。最大似然估计是 \(\hat{q}_{\mathrm{MLE}}
    = \frac{1}{n} \sum_{i=1}^n X_i\)。根据大数定律，当 \(n \to \infty\) 时，'
- en: \[ \hat{q}_{\mathrm{MLE}} \to \mathbb{E}[X_1] = q^* \]
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \hat{q}_{\mathrm{MLE}} \to \mathbb{E}[X_1] = q^* \]
- en: almost surely.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 几乎肯定。
- en: '**E6.2.5** The gradient at \(w = 0\) is:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.2.5** 在 \(w = 0\) 处的梯度是：'
- en: \[ \nabla_w L_4(0; \{(x_i, y_i)\}_{i=1}^4) = -\sum_{i=1}^4 x_i(y_i - \sigma(0))
    = -\frac{1}{2}(1 - 2 + 3 - 4) = 1. \]
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \nabla_w L_4(0; \{(x_i, y_i)\}_{i=1}^4) = -\sum_{i=1}^4 x_i(y_i - \sigma(0))
    = -\frac{1}{2}(1 - 2 + 3 - 4) = 1. \]
- en: 'The updated parameter after one step of gradient descent is:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 梯度下降一步后的更新参数是：
- en: \[ w' = w - \eta \nabla_w L_4(w; \{(x_i, y_i)\}_{i=1}^4) = 0 - 0.1 \cdot 1 =
    -0.1. \]
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: \[ w' = w - \eta \nabla_w L_4(w; \{(x_i, y_i)\}_{i=1}^4) = 0 - 0.1 \cdot 1 =
    -0.1. \]
- en: '**E6.2.7** We must have \(\sum_{x=-1}^1 \mathbb{P}(X=x) = 1\). This implies'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.2.7** 我们必须满足 \(\sum_{x=-1}^1 \mathbb{P}(X=x) = 1\)。这意味着'
- en: \[ \frac{1}{Z(\theta)} (h(-1)e^{-\theta} + h(0) + h(1)e^{\theta}) = 1. \]
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \frac{1}{Z(\theta)} (h(-1)e^{-\theta} + h(0) + h(1)e^{\theta}) = 1. \]
- en: Hence,
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，
- en: \[ Z(\theta) = h(-1)e^{-\theta} + h(0) + h(1)e^{\theta}. \]
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: \[ Z(\theta) = h(-1)e^{-\theta} + h(0) + h(1)e^{\theta}. \]
- en: '**E6.2.9** The empirical frequency for each category is given by:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.2.9** 每个类别的经验频率由以下给出：'
- en: \[ \hat{\pi}_i = \frac{N_i}{n}, \]
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \hat{\pi}_i = \frac{N_i}{n}, \]
- en: 'where \(N_i\) is the number of times category \(i\) appears in the sample.
    The counts are:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(N_i\) 是类别 \(i\) 在样本中出现的次数。计数如下：
- en: \[ N_1 = 1, \quad N_2 = 2, \quad N_3 = 1. \]
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: \[ N_1 = 1, \quad N_2 = 2, \quad N_3 = 1. \]
- en: 'Thus, the empirical frequencies are:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，经验频率如下：
- en: \[ \hat{\pi}_1 = \frac{1}{4} = 0.25, \quad \hat{\pi}_2 = \frac{2}{4} = 0.5,
    \quad \hat{\pi}_3 = \frac{1}{4} = 0.25. \]
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \hat{\pi}_1 = \frac{1}{4} = 0.25, \quad \hat{\pi}_2 = \frac{2}{4} = 0.5,
    \quad \hat{\pi}_3 = \frac{1}{4} = 0.25. \]
- en: '**E6.2.11** The log-likelihood for a multivariate Gaussian distribution is
    given by:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.2.11** 多元高斯分布的对数似然由以下给出：'
- en: \[ \log \mathcal{L}(\boldsymbol{\mu}, \boldsymbol{\Sigma}; \mathbf{X}) = -\frac{1}{2}
    \left[ (\mathbf{X} - \boldsymbol{\mu})^T \boldsymbol{\Sigma}^{-1} (\mathbf{X}
    - \boldsymbol{\mu}) + \log |\boldsymbol{\Sigma}| + 2 \log(2\pi) \right]. \]
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \log \mathcal{L}(\boldsymbol{\mu}, \boldsymbol{\Sigma}; \mathbf{X}) = -\frac{1}{2}
    \left[ (\mathbf{X} - \boldsymbol{\mu})^T \boldsymbol{\Sigma}^{-1} (\mathbf{X}
    - \boldsymbol{\mu}) + \log |\boldsymbol{\Sigma}| + 2 \log(2\pi) \right]. \]
- en: 'First, compute the inverse and determinant of \(\boldsymbol{\Sigma}\):'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，计算 \(\boldsymbol{\Sigma}\) 的逆和行列式：
- en: \[\begin{split} \boldsymbol{\Sigma}^{-1} = \frac{1}{3} \begin{pmatrix} 2 & -1
    \\ -1 & 2 \end{pmatrix}, \quad |\boldsymbol{\Sigma}| = 3. \end{split}\]
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \boldsymbol{\Sigma}^{-1} = \frac{1}{3} \begin{pmatrix} 2 & -1
    \\ -1 & 2 \end{pmatrix}, \quad |\boldsymbol{\Sigma}| = 3. \end{split}\]
- en: Then,
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，
- en: \[\begin{split} \mathbf{X} - \boldsymbol{\mu} = \begin{pmatrix} 1 \\ 3 \end{pmatrix}
    - \begin{pmatrix} 1 \\ 2 \end{pmatrix} = \begin{pmatrix} 0 \\ 1 \end{pmatrix}.
    \end{split}\]
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{X} - \boldsymbol{\mu} = \begin{pmatrix} 1 \\ 3 \end{pmatrix}
    - \begin{pmatrix} 1 \\ 2 \end{pmatrix} = \begin{pmatrix} 0 \\ 1 \end{pmatrix}.
    \end{split}\]
- en: Thus,
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，
- en: \[\begin{split} (\mathbf{X} - \boldsymbol{\mu})^T \boldsymbol{\Sigma}^{-1} (\mathbf{X}
    - \boldsymbol{\mu}) = \begin{pmatrix} 0 & 1 \end{pmatrix} \frac{1}{3} \begin{pmatrix}
    2 & -1 \\ -1 & 2 \end{pmatrix} \begin{pmatrix} 0 \\ 1 \end{pmatrix} = \frac{1}{3}
    \cdot 2 = \frac{2}{3}. \end{split}\]
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} (\mathbf{X} - \boldsymbol{\mu})^T \boldsymbol{\Sigma}^{-1} (\mathbf{X}
    - \boldsymbol{\mu}) = \begin{pmatrix} 0 & 1 \end{pmatrix} \frac{1}{3} \begin{pmatrix}
    2 & -1 \\ -1 & 2 \end{pmatrix} \begin{pmatrix} 0 \\ 1 \end{pmatrix} = \frac{1}{3}
    \cdot 2 = \frac{2}{3}. \end{split}\]
- en: 'So the log-likelihood is: $\( \log \mathcal{L} = -\frac{1}{2} \left[ \frac{2}{3}
    + \log 3 + 2 \log (2\pi) \right] \approx -3.178. \)$'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，对数似然为：$\( \log \mathcal{L} = -\frac{1}{2} \left[ \frac{2}{3} + \log 3 + 2
    \log (2\pi) \right] \approx -3.178. \)$
- en: '**E6.3.1** \(\mathbb{P}(A|B) = \frac{\mathbb{P}(A \cap B)}{\mathbb{P}(B)} =
    \frac{0.2}{0.5} = 0.4.\) This follows from the definition of conditional probability.'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.1** \(\mathbb{P}(A|B) = \frac{\mathbb{P}(A \cap B)}{\mathbb{P}(B)} =
    \frac{0.2}{0.5} = 0.4.\) 这是从条件概率的定义得出的。'
- en: '**E6.3.3** \(\mathbb{E}[X|Y=y] = 1 \cdot 0.3 + 2 \cdot 0.7 = 0.3 + 1.4 = 1.7.\)
    This is the definition of the conditional expectation for discrete random variables.'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.3** \(\mathbb{E}[X|Y=y] = 1 \cdot 0.3 + 2 \cdot 0.7 = 0.3 + 1.4 = 1.7.\)
    这就是离散随机变量的条件期望的定义。'
- en: '**E6.3.5**'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.5**'
- en: \[\begin{align*} \mathbb{P}[A \mid B \cap C] &= \frac{\mathbb{P}[A \cap (B \cap
    C)]}{\mathbb{P}[B \cap C]} \\ &= \frac{\mathbb{P}[A \cap B \cap C]}{\mathbb{P}[B
    \cap C]} \\ &= \frac{0.05}{0.1} \\ &= 0.5. \end{align*}\]
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \mathbb{P}[A \mid B \cap C] &= \frac{\mathbb{P}[A \cap (B \cap
    C)]}{\mathbb{P}[B \cap C]} \\ &= \frac{\mathbb{P}[A \cap B \cap C]}{\mathbb{P}[B
    \cap C]} \\ &= \frac{0.05}{0.1} \\ &= 0.5. \end{align*}\]
- en: '**E6.3.7** If \(A\), \(B\), and \(C\) are pairwise independent, then they are
    also mutually independent. Therefore,'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.7** 如果 \(A\)、\(B\) 和 \(C\) 是成对独立的，那么它们也是相互独立的。因此，'
- en: \[\begin{align*} \mathbb{P}[A \cap B \cap C] &= \mathbb{P}[A] \mathbb{P}[B]
    \mathbb{P}[C] \\ &= 0.8 \cdot 0.6 \cdot 0.5 \\ &= 0.24. \end{align*}\]
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \mathbb{P}[A \cap B \cap C] &= \mathbb{P}[A] \mathbb{P}[B]
    \mathbb{P}[C] \\ &= 0.8 \cdot 0.6 \cdot 0.5 \\ &= 0.24. \end{align*}\]
- en: '**E6.3.9**'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.9**'
- en: \[\begin{align*} (\mathbb{P}[X=x, Z=z])_{x,z} &= \sum_{y} (\mathbb{P}[X=x, Y
    = y, Z=z])_{x,z} \\ &= \sum_{y} [(\mathbb{P}[X=x])_x \odot (\mathbb{P}[Y = y \mid
    X=x])_x] (\mathbb{P}[Z=z \mid Y = y])_z \\ &= [(\mathbb{P}[X=x])_x \odot (\mathbb{P}[Y
    = 0 \mid X=x])_x] (\mathbb{P}[Z=z \mid Y = 0])_z\\ & \quad + [(\mathbb{P}[X=x])_x
    \odot (\mathbb{P}[Y = 1 \mid X=x])_x] (\mathbb{P}[Z=z \mid Y = 1])_z \\ &= \begin{pmatrix}
    0.3 \cdot 0.2 \cdot 0.5 & 0.3 \cdot 0.2 \cdot 0.5 \\ 0.7 \cdot 0.6 \cdot 0.5 &
    0.7 \cdot 0.6 \cdot 0.5 \end{pmatrix} + \begin{pmatrix} 0.3 \cdot 0.8 \cdot 0.1
    & 0.3 \cdot 0.8 \cdot 0.9 \\ 0.7 \cdot 0.4 \cdot 0.1 & 0.7 \cdot 0.4 \cdot 0.9
    \end{pmatrix} \\ &= \begin{pmatrix} 0.03 & 0.03 \\ 0.21 & 0.21 \end{pmatrix} +
    \begin{pmatrix} 0.024 & 0.216 \\ 0.028 & 0.252 \end{pmatrix} \\ &= \begin{pmatrix}
    0.054 & 0.246 \\ 0.238 & 0.462 \end{pmatrix}. \end{align*}\]
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} (\mathbb{P}[X=x, Z=z])_{x,z} &= \sum_{y} (\mathbb{P}[X=x, Y
    = y, Z=z])_{x,z} \\ &= \sum_{y} [(\mathbb{P}[X=x])_x \odot (\mathbb{P}[Y = y \mid
    X=x])_x] (\mathbb{P}[Z=z \mid Y = y])_z \\ &= [(\mathbb{P}[X=x])_x \odot (\mathbb{P}[Y
    = 0 \mid X=x])_x] (\mathbb{P}[Z=z \mid Y = 0])_z\\ & \quad + [(\mathbb{P}[X=x])_x
    \odot (\mathbb{P}[Y = 1 \mid X=x])_x] (\mathbb{P}[Z=z \mid Y = 1])_z \\ &= \begin{pmatrix}
    0.3 \cdot 0.2 \cdot 0.5 & 0.3 \cdot 0.2 \cdot 0.5 \\ 0.7 \cdot 0.6 \cdot 0.5 &
    0.7 \cdot 0.6 \cdot 0.5 \end{pmatrix} + \begin{pmatrix} 0.3 \cdot 0.8 \cdot 0.1
    & 0.3 \cdot 0.8 \cdot 0.9 \\ 0.7 \cdot 0.4 \cdot 0.1 & 0.7 \cdot 0.4 \cdot 0.9
    \end{pmatrix} \\ &= \begin{pmatrix} 0.03 & 0.03 \\ 0.21 & 0.21 \end{pmatrix} +
    \begin{pmatrix} 0.024 & 0.216 \\ 0.028 & 0.252 \end{pmatrix} \\ &= \begin{pmatrix}
    0.054 & 0.246 \\ 0.238 & 0.462 \end{pmatrix}. \end{align*}\]
- en: '**E6.3.11**'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.11**'
- en: \[\begin{align*} \hat{\pi}_1 &= \frac{N_1}{N_1 + N_2} = \frac{50}{50 + 100}
    = \frac{1}{3}, \\ \hat{p}_{1,1} &= \frac{N_{1,1}}{N_1} = \frac{10}{50} = 0.2,
    \\ \hat{p}_{2,1} &= \frac{N_{2,1}}{N_2} = \frac{40}{100} = 0.4. \end{align*}\]
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \hat{\pi}_1 &= \frac{N_1}{N_1 + N_2} = \frac{50}{50 + 100}
    = \frac{1}{3}, \\ \hat{p}_{1,1} &= \frac{N_{1,1}}{N_1} = \frac{10}{50} = 0.2,
    \\ \hat{p}_{2,1} &= \frac{N_{2,1}}{N_2} = \frac{40}{100} = 0.4. \end{align*}\]
- en: '**E6.3.13**'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.13**'
- en: \[ \mathbb{P}[X=x, Y=y, Z=z] = \mathbb{P}[X=x]\mathbb{P}[Y=y|X=x]\mathbb{P}[Z=z|X=x].
    \]
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbb{P}[X=x, Y=y, Z=z] = \mathbb{P}[X=x]\mathbb{P}[Y=y|X=x]\mathbb{P}[Z=z|X=x].
    \]
- en: '**E6.4.1**'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.1**'
- en: \[\begin{align*} \mathbb{P}(X = 1) &= \sum_{i=1}^2 \pi_i p_i \\ &= (0.6)(0.3)
    + (0.4)(0.8) \\ &= 0.5 \end{align*}\]
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \mathbb{P}(X = 1) &= \sum_{i=1}^2 \pi_i p_i \\ &= (0.6)(0.3)
    + (0.4)(0.8) \\ &= 0.5 \end{align*}\]
- en: '**E6.4.3** \(\mathbb{P}[X = (1, 0)] = \pi_1 p_{1,1} (1 - p_{1,2}) + \pi_2 p_{2,1}
    (1 - p_{2,2}) = 0.4 \cdot 0.7 \cdot 0.7 + 0.6 \cdot 0.2 \cdot 0.2 = 0.196 + 0.024
    = 0.22\).'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.3** \(\mathbb{P}[X = (1, 0)] = \pi_1 p_{1,1} (1 - p_{1,2}) + \pi_2 p_{2,1}
    (1 - p_{2,2}) = 0.4 \cdot 0.7 \cdot 0.7 + 0.6 \cdot 0.2 \cdot 0.2 = 0.196 + 0.024
    = 0.22\).'
- en: '**E6.4.5** \(r_{1,i} = \frac{\pi_1 p_{1,1} p_{1,2}}{\pi_1 p_{1,1} p_{1,2} +
    \pi_2 p_{2,1} p_{2,2}} = \frac{0.5 \cdot 0.8 \cdot 0.2}{0.5 \cdot 0.8 \cdot 0.2
    + 0.5 \cdot 0.1 \cdot 0.9} = \frac{0.08}{0.08 + 0.045} \approx 0.64\), \(r_{2,i}
    = 1 - r_{1,i} \approx 0.36\).'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.5** \(r_{1,i} = \frac{\pi_1 p_{1,1} p_{1,2}}{\pi_1 p_{1,1} p_{1,2} +
    \pi_2 p_{2,1} p_{2,2}} = \frac{0.5 \cdot 0.8 \cdot 0.2}{0.5 \cdot 0.8 \cdot 0.2
    + 0.5 \cdot 0.1 \cdot 0.9} = \frac{0.08}{0.08 + 0.045} \approx 0.64\), \(r_{2,i}
    = 1 - r_{1,i} \approx 0.36\).'
- en: '**E6.4.7** \(\pi_1 = \frac{\eta_1}{n} = \frac{r_{1,1} + r_{1,1}}{2} = \frac{0.8
    + 0.8}{2} = 0.8\), \(\pi_2 = 1 - \pi_1 = 0.2\).'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.7** \(\pi_1 = \frac{\eta_1}{n} = \frac{r_{1,1} + r_{1,1}}{2} = \frac{0.8
    + 0.8}{2} = 0.8\), \(\pi_2 = 1 - \pi_1 = 0.2\).'
- en: '**E6.4.9**'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.9**'
- en: \[\begin{align*} r_{1,2} &= \frac{\pi_1 \prod_{m=1}^3 p_{1,m}^{x_{2,m}} (1 -
    p_{1,m})^{1-x_{2,m}}}{\sum_{k=1}^2 \pi_k \prod_{m=1}^3 p_{k,m}^{x_{2,m}} (1 -
    p_{k,m})^{1-x_{2,m}}} \\ &= \frac{(0.4)(0.2)^0(0.8)^1(0.9)^0(0.1)^1}{(0.4)(0.2)^0(0.8)^1(0.9)^0(0.1)^1
    + (0.6)(0.8)^0(0.2)^1(0.5)^0(0.5)^1} \\ &= \frac{0.032}{0.032 + 0.06} \\ &= \frac{8}{23}
    \end{align*}\]
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} r_{1,2} &= \frac{\pi_1 \prod_{m=1}^3 p_{1,m}^{x_{2,m}} (1 -
    p_{1,m})^{1-x_{2,m}}}{\sum_{k=1}^2 \pi_k \prod_{m=1}^3 p_{k,m}^{x_{2,m}} (1 -
    p_{k,m})^{1-x_{2,m}}} \\ &= \frac{(0.4)(0.2)^0(0.8)^1(0.9)^0(0.1)^1}{(0.4)(0.2)^0(0.8)^1(0.9)^0(0.1)^1
    + (0.6)(0.8)^0(0.2)^1(0.5)^0(0.5)^1} \\ &= \frac{0.032}{0.032 + 0.06} \\ &= \frac{8}{23}
    \end{align*}\]
- en: '**E6.4.11**'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.11**'
- en: \[ \mathbb{E}[X] = \pi_1 \mu_1 + \pi_2 \mu_2 = 0.5 \times (-1) + 0.5 \times
    3 = -0.5 + 1.5 = 1. \]
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbb{E}[X] = \pi_1 \mu_1 + \pi_2 \mu_2 = 0.5 \times (-1) + 0.5 \times
    3 = -0.5 + 1.5 = 1. \]
- en: '**E6.4.13**'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.13**'
- en: \[ \mathrm{Var}(X) = \pi_1 (\sigma_1^2 + \mu_1^2) + \pi_2 (\sigma_2^2 + \mu_2^2)
    - \left(\pi_1 \mu_1 + \pi_2 \mu_2\right)^2, \]\[ \mathrm{Var}(X) = 0.4 (1 + 0^2)
    + 0.6 (2 + 4^2) - (0.4 \times 0 + 0.6 \times 4)^2 = 0.4 \times 1 + 0.6 \times
    18 - 2.4^2, \]\[ \mathrm{Var}(X) = 0.4 + 10.8 - 5.76 = 5.44. \]
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathrm{Var}(X) = \pi_1 (\sigma_1^2 + \mu_1^2) + \pi_2 (\sigma_2^2 + \mu_2^2)
    - \left(\pi_1 \mu_1 + \pi_2 \mu_2\right)^2, \]\[ \mathrm{Var}(X) = 0.4 (1 + 0^2)
    + 0.6 (2 + 4^2) - (0.4 \times 0 + 0.6 \times 4)^2 = 0.4 \times 1 + 0.6 \times
    18 - 2.4^2, \]\[ \mathrm{Var}(X) = 0.4 + 10.8 - 5.76 = 5.44. \]
- en: '**E6.5.1**'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.1**'
- en: \[ B / B_{11} = B_{22} - B_{12}^T B_{11}^{-1} B_{12} = 3 - 1 \cdot \frac{1}{2}
    \cdot 1 = \frac{5}{2}, \]
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: \[ B / B_{11} = B_{22} - B_{12}^T B_{11}^{-1} B_{12} = 3 - 1 \cdot \frac{1}{2}
    \cdot 1 = \frac{5}{2}, \]
- en: using the definition of the Schur complement.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Schur补的定义。
- en: '**E6.5.3** The Schur complement of \(A_{11}\) in \(A\) is given by'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.3** \(A\)中\(A_{11}\)的Schur补由以下给出'
- en: \[\begin{split} A/A_{11} = A_{22} - A_{21}A_{11}^{-1}A_{12} = 7 - \begin{pmatrix}
    0 & 6 \end{pmatrix} \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix}^{-1} \begin{pmatrix}
    0 \\ 5 \end{pmatrix}. \end{split}\]
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A/A_{11} = A_{22} - A_{21}A_{11}^{-1}A_{12} = 7 - \begin{pmatrix}
    0 & 6 \end{pmatrix} \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix}^{-1} \begin{pmatrix}
    0 \\ 5 \end{pmatrix}. \end{split}\]
- en: 'First, compute \(A_{11}^{-1}\):'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，计算 \(A_{11}^{-1}\)：
- en: \[\begin{split} A_{11}^{-1} = \frac{1}{1 \cdot 4 - 2 \cdot 3} \begin{pmatrix}
    4 & -2 \\ -3 & 1 \end{pmatrix} = \begin{pmatrix} -2 & 1 \\ 1.5 & -0.5 \end{pmatrix}.
    \end{split}\]
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A_{11}^{-1} = \frac{1}{1 \cdot 4 - 2 \cdot 3} \begin{pmatrix}
    4 & -2 \\ -3 & 1 \end{pmatrix} = \begin{pmatrix} -2 & 1 \\ 1.5 & -0.5 \end{pmatrix}.
    \end{split}\]
- en: Then,
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，
- en: \[\begin{split} A/A_{11} = 7 - \begin{pmatrix} 0 & 6 \end{pmatrix} \begin{pmatrix}
    -2 & 1 \\ 1.5 & -0.5 \end{pmatrix} \begin{pmatrix} 0 \\ 5 \end{pmatrix} = 7 +
    (6 \cdot 0.5 \cdot 5) = 22. \end{split}\]
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A/A_{11} = 7 - \begin{pmatrix} 0 & 6 \end{pmatrix} \begin{pmatrix}
    -2 & 1 \\ 1.5 & -0.5 \end{pmatrix} \begin{pmatrix} 0 \\ 5 \end{pmatrix} = 7 +
    (6 \cdot 0.5 \cdot 5) = 22. \end{split}\]
- en: '**E6.5.5** The conditional mean of \(X_1\) given \(X_2 = 3\) is'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.5** 在 \(X_2 = 3\) 的条件下，\(X_1\) 的条件均值是'
- en: \[ \mu_{1|2}(3) = \mu_1 + \bSigma_{12} \bSigma_{22}^{-1} (3 - \bmu_2) = 1 +
    1 \cdot \frac{1}{3} (3 - 2) = \frac{4}{3}, \]
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mu_{1|2}(3) = \mu_1 + \bSigma_{12} \bSigma_{22}^{-1} (3 - \bmu_2) = 1 +
    1 \cdot \frac{1}{3} (3 - 2) = \frac{4}{3}, \]
- en: using the formula for the conditional mean of multivariate Gaussians.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 使用多元高斯条件均值的公式。
- en: '**E6.5.7** The conditional distribution of \(X_1\) given \(X_2 = 1\) is Gaussian
    with mean \(\mu_{1|2} = \mu_1 + \bSigma_{12} \bSigma_{22}^{-1} (1 - \mu_2) = \frac{1}{2}\)
    and variance \(\bSigma_{1|2} = \bSigma_{11} - \bSigma_{12} \bSigma_{22}^{-1} \bSigma_{21}
    = \frac{7}{2}\).'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.7** 在 \(X_2 = 1\) 的条件下，\(X_1\) 的条件分布是高斯分布，均值为 \(\mu_{1|2} = \mu_1 +
    \bSigma_{12} \bSigma_{22}^{-1} (1 - \mu_2) = \frac{1}{2}\)，方差为 \(\bSigma_{1|2}
    = \bSigma_{11} - \bSigma_{12} \bSigma_{22}^{-1} \bSigma_{21} = \frac{7}{2}\)。'
- en: '**E6.5.9** The distribution of \(\bY\) is Gaussian with mean vector \(A\bmu
    = \begin{pmatrix} -3 \\ -3 \end{pmatrix}\) and covariance matrix \(A\bSigma A^T
    = \begin{pmatrix} 8 & 1 \\ 1 & 6 \end{pmatrix}\).'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.9** \(\bY\) 的分布是高斯分布，均值向量为 \(A\bmu = \begin{pmatrix} -3 \\ -3 \end{pmatrix}\)，协方差矩阵为
    \(A\bSigma A^T = \begin{pmatrix} 8 & 1 \\ 1 & 6 \end{pmatrix}\)。'
- en: '**E6.5.11** The mean of \(Y_t\) is'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.11** \(Y_t\) 的均值是'
- en: \[\begin{split} \mathbb{E}[Y_t] = \begin{pmatrix} 1 & 0 \end{pmatrix} \mathbb{E}[\bX_t]
    = \begin{pmatrix} 1 & 0 \end{pmatrix} \begin{pmatrix} 1 \\ 2 \end{pmatrix} = 1,
    \end{split}\]
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbb{E}[Y_t] = \begin{pmatrix} 1 & 0 \end{pmatrix} \mathbb{E}[\bX_t]
    = \begin{pmatrix} 1 & 0 \end{pmatrix} \begin{pmatrix} 1 \\ 2 \end{pmatrix} = 1,
    \end{split}\]
- en: and the variance of \(Y_t\) is
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 并且 \(Y_t\) 的方差是
- en: \[\begin{split} \mathrm{Var}[Y_t] = \begin{pmatrix} 1 & 0 \end{pmatrix} \mathrm{Cov}[\bX_t]
    \begin{pmatrix} 1 \\ 0 \end{pmatrix} + 1 = \begin{pmatrix} 1 & 0 \end{pmatrix}
    \begin{pmatrix} 1 \\ 0 \end{pmatrix} + 1 = 2, \end{split}\]
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathrm{Var}[Y_t] = \begin{pmatrix} 1 & 0 \end{pmatrix} \mathrm{Cov}[\bX_t]
    \begin{pmatrix} 1 \\ 0 \end{pmatrix} + 1 = \begin{pmatrix} 1 & 0 \end{pmatrix}
    \begin{pmatrix} 1 \\ 0 \end{pmatrix} + 1 = 2, \end{split}\]
- en: using the properties of linear-Gaussian systems.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 使用线性高斯系统的性质。
- en: '**E6.5.13** The innovation is'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.13** 创新是'
- en: \[\begin{split} e_t = Y_t - H \bmu_{\text{pred}} = 3 - \begin{pmatrix} 1 & 0
    \end{pmatrix} \begin{pmatrix} 3 \\ 1 \end{pmatrix} = 3 - 3 = 0. \end{split}\]
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} e_t = Y_t - H \bmu_{\text{pred}} = 3 - \begin{pmatrix} 1 & 0
    \end{pmatrix} \begin{pmatrix} 3 \\ 1 \end{pmatrix} = 3 - 3 = 0. \end{split}\]
- en: '**E6.5.15** The updated state estimate is'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.15** 更新后的状态估计是'
- en: \[\begin{split} \bmu_t = \bmu_{\text{pred}} + K_t e_t = \begin{pmatrix} 3 \\
    1 \end{pmatrix} + \begin{pmatrix} \frac{2}{3} \\ \frac{1}{3} \end{pmatrix} \cdot
    0 = \begin{pmatrix} 3 \\ 1 \end{pmatrix}. \end{split}\]
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bmu_t = \bmu_{\text{pred}} + K_t e_t = \begin{pmatrix} 3 \\
    1 \end{pmatrix} + \begin{pmatrix} \frac{2}{3} \\ \frac{1}{3} \end{pmatrix} \cdot
    0 = \begin{pmatrix} 3 \\ 1 \end{pmatrix}. \end{split}\]
- en: 6.7.1.5\. Learning outcomes[#](#learning-outcomes "Link to this heading")
  id: totrans-92
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.1.5\. 学习成果[#](#learning-outcomes "链接到这个标题")
- en: Define exponential families and give examples of common probability distributions
    that belong to this family.
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定义指数族，并给出属于此族的一些常见概率分布的例子。
- en: Derive the maximum likelihood estimator for exponential families and explain
    its properties.
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 推导指数族的极大似然估计量并解释其性质。
- en: Prove that, under certain conditions, the maximum likelihood estimator is statistically
    consistent.
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 证明在特定条件下，最大似然估计量是统计一致的。
- en: Formulate generalized linear models using exponential families and express linear
    and logistic regression as special cases.
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用指数族来制定广义线性模型，并将线性回归和逻辑回归表达为特殊情况。
- en: Compute the gradient and Hessian of the negative log-likelihood for generalized
    linear models.
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 计算广义线性模型的负对数似然函数的梯度和国值。
- en: Interpret the moment-matching equations for the maximum likelihood estimator
    in generalized linear models.
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 解释广义线性模型中最大似然估计的矩匹配方程。
- en: Apply the multiplication rule, the law of total probability, and Bayes’ rule
    to solve problems involving conditional probabilities.
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用乘法规则、全概率定律和贝叶斯定理来解决涉及条件概率的问题。
- en: Calculate conditional probability mass functions and conditional expectations
    for discrete random variables.
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 计算离散随机变量的条件概率质量函数和条件期望。
- en: Define conditional independence and express it mathematically in terms of conditional
    probabilities.
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定义条件独立性，并从条件概率的角度数学地表达它。
- en: Differentiate between the fork, chain, and collider configurations in graphical
    models representing conditional independence relations.
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 区分在表示条件独立性关系的图模型中，叉形、链形和碰撞形配置的不同。
- en: Derive the joint probability distribution for the Naive Bayes model under the
    assumption of conditional independence.
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在条件独立性的假设下，推导朴素贝叶斯模型的联合概率分布。
- en: Implement maximum likelihood estimation to fit the parameters of the Naive Bayes
    model.
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实现最大似然估计以拟合朴素贝叶斯模型的参数。
- en: Apply the Naive Bayes model for prediction and evaluate its accuracy.
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用朴素贝叶斯模型进行预测并评估其准确性。
- en: Implement Laplace smoothing to address the issue of unseen words in the training
    data when fitting a Naive Bayes model.
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在拟合朴素贝叶斯模型时，实现拉普拉斯平滑来解决训练数据中未见词语的问题。
- en: Apply the Naive Bayes model to perform sentiment analysis on a real-world dataset
    and interpret the results.
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将朴素贝叶斯模型应用于对实际数据集进行情感分析，并解释结果。
- en: Define mixtures as convex combinations of distributions and express the probability
    distribution of a mixture model using the law of total probability.
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定义混合为分布的凸组合，并使用全概率定律表达混合模型的概率分布。
- en: Identify examples of mixture models, such as mixtures of multinomials and Gaussian
    mixture models, and recognize their probability density functions.
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 识别混合模型的例子，如多项式混合和高斯混合模型，并识别它们的概率密度函数。
- en: Explain the concept of marginalizing out an unobserved random variable in the
    context of mixture models.
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 解释在混合模型中边际化未观察到的随机变量的概念。
- en: Formulate the objective function for parameter estimation in mixtures of multivariate
    Bernoullis using the negative log-likelihood.
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用负对数似然函数为多元伯努利混合的参数估计公式化目标函数。
- en: Describe the majorization-minimization principle and its application in the
    Expectation-Maximization (EM) algorithm.
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 描述极大化-极小化原理及其在期望-最大化（EM）算法中的应用。
- en: Derive the E-step and M-step updates for the EM algorithm in the context of
    mixtures of multivariate Bernoullis.
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在多元伯努利混合的EM算法的背景下推导E步和M步更新。
- en: Implement the EM algorithm for mixtures of multivariate Bernoullis and apply
    it to a real-world dataset, such as clustering handwritten digits from the MNIST
    dataset.
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实现多元伯努利混合的EM算法，并将其应用于实际数据集，例如从MNIST数据集中聚类手写数字。
- en: Identify and address numerical issues that may arise during the implementation
    of the EM algorithm, such as underflow, by applying techniques like the log-sum-exp
    trick.
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 识别并解决在实现EM算法过程中可能出现的数值问题，例如下溢，通过应用如对数和指数技巧等技术。
- en: Define block matrices and the Schur complement, and demonstrate their properties
    through examples and proofs.
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定义块矩阵和Schur补，并通过例子和证明展示它们的性质。
- en: Derive the marginal and conditional distributions of multivariate Gaussians
    using the properties of block matrices and the Schur complement.
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用块矩阵的性质和Schur补的性质推导多元高斯分布的边缘和条件分布。
- en: Describe the linear-Gaussian system model and its components, including the
    state evolution and observation processes.
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 描述线性高斯系统模型及其组成部分，包括状态演化和观测过程。
- en: Explain the purpose and key steps of the Kalman filter algorithm, including
    the prediction and update steps.
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 解释卡尔曼滤波算法的目的和关键步骤，包括预测和更新步骤。
- en: Implement the Kalman filter algorithm in code, given the state evolution and
    observation models, and the initial state distribution.
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在给定状态演化和观测模型以及初始状态分布的情况下，用代码实现卡尔曼滤波算法。
- en: Apply the Kalman filter to a location tracking problem, and interpret the results
    in terms of the estimated object path and the algorithm’s performance.
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将卡尔曼滤波应用于位置跟踪问题，并从估计的对象路径和算法性能的角度解释结果。
- en: \(\aleph\)
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: \(\aleph\)
- en: 6.7.2\. Additional sections[#](#additional-sections "Link to this heading")
  id: totrans-123
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 6.7.2\. 其他部分[#](#additional-sections "链接到这个标题")
- en: 6.7.2.1\. Sentiment analysis[#](#sentiment-analysis "Link to this heading")
  id: totrans-124
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.2.1\. 情感分析[#](#sentiment-analysis "链接到这个标题")
- en: 'As an application of the Naive Bayes model, we consider the task of sentiment
    analysis, which is a classification problem. We use a dataset available [here](https://www.kaggle.com/crowdflower/twitter-airline-sentiment).
    Quoting from there:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 作为朴素贝叶斯模型的应用，我们考虑情感分析的任务，这是一个分类问题。我们使用可在此处获得的[数据集](https://www.kaggle.com/crowdflower/twitter-airline-sentiment)。从那里引用：
- en: A sentiment analysis job about the problems of each major U.S. airline. Twitter
    data was scraped from February of 2015 and contributors were asked to first classify
    positive, negative, and neutral tweets, followed by categorizing negative reasons
    (such as “late flight” or “rude service”).
  id: totrans-126
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 一项关于美国各大航空公司问题的情感分析工作。从2015年2月开始抓取了Twitter数据，并要求参与者首先对积极、消极和中立的推文进行分类，然后对消极原因（如“航班延误”或“服务粗鲁”）进行分类。
- en: We first load a cleaned-up version of the data and look at its summary.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先加载一个清理过的数据版本，并查看其摘要。
- en: '[PRE0]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '|  | time | user | sentiment | text |'
  id: totrans-129
  prefs: []
  type: TYPE_TB
  zh: '|  | 时间 | 用户 | 情感 | 文本 |'
- en: '| --- | --- | --- | --- | --- |'
  id: totrans-130
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- |'
- en: '| 0 | 2/24/15 11:35 | cairdin | neutral | @VirginAmerica What @dhepburn said.
    |'
  id: totrans-131
  prefs: []
  type: TYPE_TB
  zh: '| 0 | 2/24/15 11:35 | cairdin | 中立 | @VirginAmerica @dhepburn说的。 |'
- en: '| 1 | 2/24/15 11:15 | jnardino | positive | @VirginAmerica plus you''ve added
    commercials t... |'
  id: totrans-132
  prefs: []
  type: TYPE_TB
  zh: '| 1 | 2/24/15 11:15 | jnardino | 积极 | @VirginAmerica 加上你增加了商业广告... |'
- en: '| 2 | 2/24/15 11:15 | yvonnalynn | neutral | @VirginAmerica I didn''t today...
    Must mean I n... |'
  id: totrans-133
  prefs: []
  type: TYPE_TB
  zh: '| 2 | 2/24/15 11:15 | yvonnalynn | 中立 | @VirginAmerica 我今天没有... 必须意味着我... |'
- en: '| 3 | 2/24/15 11:15 | jnardino | negative | @VirginAmerica it''s really aggressive
    to blast... |'
  id: totrans-134
  prefs: []
  type: TYPE_TB
  zh: '| 3 | 2/24/15 11:15 | jnardino | 消极 | @VirginAmerica 真是太具有侵略性了... |'
- en: '| 4 | 2/24/15 11:14 | jnardino | negative | @VirginAmerica and it''s a really
    big bad thing... |'
  id: totrans-135
  prefs: []
  type: TYPE_TB
  zh: '| 4 | 2/24/15 11:14 | jnardino | 消极 | @VirginAmerica 真的是一件非常糟糕的事情... |'
- en: '[PRE1]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '[PRE2]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: We extract the text information in this dataset.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从数据集中提取文本信息。
- en: '[PRE3]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '[PRE4]'
  id: totrans-140
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Next, we convert our dataset into a matrix by creating a document-term matrix
    using [`sklearn.feature_extraction.text.CountVectorizer`](https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html#sklearn.feature_extraction.text.CountVectorizer.fit_transform).
    Quoting [Wikipedia](https://en.wikipedia.org/wiki/Document-term_matrix):'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们通过使用`sklearn.feature_extraction.text.CountVectorizer`（[链接](https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html#sklearn.feature_extraction.text.CountVectorizer.fit_transform)）创建文档-词矩阵，将我们的数据集转换为矩阵。引用[维基百科](https://en.wikipedia.org/wiki/Document-term_matrix)：
- en: A document-term matrix or term-document matrix is a mathematical matrix that
    describes the frequency of terms that occur in a collection of documents. In a
    document-term matrix, rows correspond to documents in the collection and columns
    correspond to terms.
  id: totrans-142
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 文档-词矩阵或词-文档矩阵是一个数学矩阵，描述了在文档集合中出现的词的频率。在文档-词矩阵中，行对应于集合中的文档，列对应于术语。
- en: 'By default, it first preprocesses the data. In particular, it lower-cases all
    words and removes punctuation. A more careful pre-procsseing would also include
    stemming, although we do not do this here. Regarding the latter, quoting [Wikipedia](https://en.wikipedia.org/wiki/Stemming):'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，它首先对数据进行预处理。特别是，它将所有单词转换为小写并删除标点符号。更仔细的预处理还包括词干提取，尽管我们在这里没有这样做。关于后者，引用[维基百科](https://en.wikipedia.org/wiki/Stemming)：
- en: In linguistic morphology and information retrieval, stemming is the process
    of reducing inflected (or sometimes derived) words to their word stem, base or
    root form—generally a written word form. […] A computer program or subroutine
    that stems word may be called a stemming program, stemming algorithm, or stemmer.
    […] A stemmer for English operating on the stem cat should identify such strings
    as cats, catlike, and catty. A stemming algorithm might also reduce the words
    fishing, fished, and fisher to the stem fish. The stem need not be a word, for
    example the Porter algorithm reduces, argue, argued, argues, arguing, and argus
    to the stem argu.
  id: totrans-144
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 在语言学形态学和信息检索中，词干提取是将屈折（或有时是派生）词还原到它们的词干、词根或基本形式的过程——通常是一个书面词形式。[...] 一个可以提取词干的计算机程序或子程序可以称为词干程序、词干算法或词干提取器。[...]
    对于在stem cat上操作的英语词干提取器应识别出cats、catlike和catty这样的字符串。词干算法也可能将fishing、fished和fisher等词还原到词干fish。词干不一定是单词，例如，Porter算法将argue、argued、argues、arguing和argus还原到词干argu。
- en: '[PRE5]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '[PRE6]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '[PRE7]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: The list of all terms used can be accessed as follows.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 可以按以下方式访问所有术语的列表。
- en: '[PRE8]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '[PRE9]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Because of our use of the multivariate Bernoulli naive Bayes model, it will
    be more convenient to work with a variant of the document-term matrix where each
    word is either present or absent. Note that, in the context of tweet data which
    are very short documents with likely little word repetition, there is probably
    not much difference.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们使用了多元伯努利朴素贝叶斯模型，使用文档-词矩阵的一个变体会更方便，其中每个词要么存在要么不存在。请注意，在推文数据（非常短的文档，可能很少重复单词）的上下文中，可能没有太大的区别。
- en: '[PRE10]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '[PRE11]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: We also extract the labels (`neutral`, `postive`, `negative`) from the dataset.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还从数据集中提取标签（`neutral`、`positive`、`negative`）。
- en: '[PRE12]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '[PRE13]'
  id: totrans-156
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: We split the data into a training set and a test set using [`sklearn.model_selection.train_test_split`](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html).
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用[`sklearn.model_selection.train_test_split`](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html)将数据分为训练集和测试集。
- en: '[PRE14]'
  id: totrans-158
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '[PRE15]'
  id: totrans-159
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: We use the Naive Bayes method. We first construct the matrix \(N_{k,m}\) and
    the vector \(N_k\).
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用朴素贝叶斯方法。我们首先构建矩阵\(N_{k,m}\)和向量\(N_k\)。
- en: '[PRE16]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Above, the [`enumerate`](https://docs.python.org/3/library/functions.html#enumerate)
    function provides both the index and the value for each item in the `label_set`
    list during the loop. This allows the code to use the label’s value (`k`) and
    its numerical position (`i`) at the same time.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 上面的`[`enumerate`](https://docs.python.org/3/library/functions.html#enumerate)函数在循环期间为`label_set`列表中的每个项目提供索引和值。这使得代码能够在同一时间使用标签的值（`k`）和它的数值位置（`i`）。
- en: We are ready to train on the dataset.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经准备好在数据集上训练。
- en: '[PRE17]'
  id: totrans-164
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '[PRE18]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '[PRE19]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '[PRE20]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Next, we plot the vector \(p_{k,m}\) for each label \(k\).
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们为每个标签\(k\)绘制向量\(p_{k,m}\)。
- en: '[PRE21]'
  id: totrans-169
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '![../../_images/e75f50e0059a06f686e844c95d499bf2dbc3ef78367a3fc95c0ed8f7df2202b1.png](../Images/dc490453944015ef54f86c78956d449e.png)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![../../_images/e75f50e0059a06f686e844c95d499bf2dbc3ef78367a3fc95c0ed8f7df2202b1.png](../Images/dc490453944015ef54f86c78956d449e.png)'
- en: 'We can compute a prediction on the test tweets. For example, for the 5th test
    tweet:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以在测试推文中进行预测。例如，对于第5个测试推文：
- en: '[PRE22]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '[PRE23]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: The following computes the overall accuracy over the test data.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的代码计算了测试数据集的整体准确率。
- en: '[PRE24]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '[PRE25]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: To get a better understanding of the differences uncovered by Naive Bayes between
    the different labels, we identify words that are particularly common in one label,
    but not on the other. Recall that label `1` corresponds to `positive` while label
    `2` corresponds to `negative`.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更好地理解朴素贝叶斯在不同标签之间揭示的差异，我们识别出在某个标签中特别常见但在另一个标签中不常见的单词。回想一下，标签`1`对应`positive`，而标签`2`对应`negative`。
- en: '[PRE26]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '[PRE27]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'One notices that many positive words do appear in this list: `awesome`, `best`,
    `great`, `love`, `thank`.'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，许多积极的词汇确实出现在这个列表中：`awesome`、`best`、`great`、`love`、`thank`。
- en: '[PRE28]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '[PRE29]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'This time, we notice: `bag`, `cancelled`, `delayed`, `hours`, `phone`.'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 这次，我们注意到：`bag`、`cancelled`、`delayed`、`hours`、`phone`。
- en: '**CHAT & LEARN** The bag-of-words representation used in the sentiment analysis
    example is a simple but limited way to represent text data. More advanced representations
    such as word embeddings and transformer models can capture more semantic information.
    Ask your favorite AI chatbot to explain these representations and how they can
    be used for text classification tasks. \(\ddagger\)'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: '**CHAT & LEARN** 在情感分析示例中使用的词袋表示法是一种简单但有限的方式来表示文本数据。更高级的表示，如词嵌入和转换器模型，可以捕捉到更多的语义信息。请你的AI聊天机器人解释这些表示以及它们如何用于文本分类任务。\(\ddagger\)'
- en: '6.7.2.2\. Kalman filtering: missing data[#](#kalman-filtering-missing-data
    "Link to this heading")'
  id: totrans-185
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.2.2\. 卡尔曼滤波：缺失数据[#](#kalman-filtering-missing-data "链接到这个标题")
- en: In Kalman filtering, we can also allow for the possibility that some observations
    are missing. Imagine for instance losing GPS signal while going through a tunnel.
    The recursions above are still valid, with the only modification that the *Update*
    equations involving \(\bY_t\) are dropped at those times \(t\) where there is
    no observation. In Numpy, we can use [`NaN`](https://numpy.org/doc/stable/reference/constants.html#numpy.nan)
    to indicate the lack of observation. (Alternatively, one can use the [numpy.ma](https://numpy.org/doc/stable/reference/maskedarray.generic.html)
    module.)
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 在卡尔曼滤波中，我们还可以允许某些观测值缺失的可能性。想象一下，比如在穿过隧道时丢失了GPS信号。上面的递归仍然有效，唯一的修改是在没有观测值的时间\(t\)处，涉及\(\bY_t\)的*更新*方程被省略。在Numpy中，我们可以使用[`NaN`](https://numpy.org/doc/stable/reference/constants.html#numpy.nan)来表示观测值的缺失。（或者，也可以使用[numpy.ma](https://numpy.org/doc/stable/reference/maskedarray.generic.html)模块。）
- en: We use a same sample path as above, but mask observations at times \(t=10,\ldots,20\).
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用与上面相同的样本路径，但屏蔽了 \(t=10,\ldots,20\) 时刻的观测值。
- en: '[PRE30]'
  id: totrans-188
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '[PRE31]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: Here is the sample we are aiming to infer.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是我们试图推断的样本。
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格源代码
    隐藏代码单元格源代码</summary>
- en: '[PRE32]</details> ![../../_images/f50483a562aeab113e7a2c066e9f1df40a3734ae2dcc59b104875762494a3a7e.png](../Images/23e83372ecc5a5cde94ad7f021c21a15.png)'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE32][详情] ![../../_images/f50483a562aeab113e7a2c066e9f1df40a3734ae2dcc59b104875762494a3a7e.png](../Images/23e83372ecc5a5cde94ad7f021c21a15.png)'
- en: We modify the recursion accordingly, that is, skip the *Update* step when there
    is no observation to use for the update.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 我们相应地修改递归，即在没有可用于更新的观测值时跳过 *更新* 步骤。
- en: '[PRE33]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: '[PRE34]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格源代码
    隐藏代码单元格源代码</summary>
- en: '[PRE35]</details> ![../../_images/2e92c840f3a0f15546d76a33647bbdb2a46015c60b362e0062398e2de1579630.png](../Images/6633cdad5605633dacdc68a6a28fde12.png)'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE35][详情] ![../../_images/2e92c840f3a0f15546d76a33647bbdb2a46015c60b362e0062398e2de1579630.png](../Images/6633cdad5605633dacdc68a6a28fde12.png)'
- en: 6.7.2.3\. Cholesky decomposition[#](#cholesky-decomposition "Link to this heading")
  id: totrans-198
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.2.3. Cholesky 分解[#](#cholesky-decomposition "链接到这个标题")
- en: In this section, we derive an important matrix factorization and apply it to
    generating multivariate Gaussians. We also revisit the least-squares problem.
    We begin with the motivation.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们推导出一个重要的矩阵分解，并将其应用于生成多元高斯分布。我们还回顾了最小二乘问题。我们从动机开始。
- en: '**Generating multivariate Gaussians** Suppose we want to generate samples from
    a multivariate Gaussian \(\bX \sim N_d(\bmu, \bSigma)\) with given mean vector
    \(\bmu \in \mathbb{R}^d\) and positive definite covariance matrix \(\bSigma \in
    \mathbb{R}^{d \times d}\). Of course, in Numpy, we could use [`numpy.random.Generator.multivariate_normal`](https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.multivariate_normal.html).
    But what is behind it? More precisely, suppose we have access to unlimited samples
    \(U_1, U_2, U_3, etc.\) from uniform random variables in \([0,1]\). How do we
    transform them to obtain samples from \(N_d(\bmu, \bSigma)\).'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: '**生成多元高斯分布**: 假设我们想要从具有给定均值向量 \(\bmu \in \mathbb{R}^d\) 和正定协方差矩阵 \(\bSigma
    \in \mathbb{R}^{d \times d}\) 的多元高斯分布 \(\bX \sim N_d(\bmu, \bSigma)\) 中生成样本。当然，在
    Numpy 中，我们可以使用 `numpy.random.Generator.multivariate_normal`。[链接](https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.multivariate_normal.html).
    但它背后的原理是什么？更确切地说，假设我们能够从 \([0,1]\) 中的均匀随机变量中获得无限多的样本 \(U_1, U_2, U_3, \ldots\)。我们如何将它们转换以获得
    \(N_d(\bmu, \bSigma)\) 的样本。'
- en: 'We start with the simplest case: \(d=1\), \(\mu = 0\), and \(\sigma^2 = 1\).
    That is, we first generate a univariate standard Normal. We have seen a recipe
    for doing this before, the inverse transform sampling method. Specifically, recall
    that the cumulative distribution function (CDF) of a random variable \(Z\) is
    defined as'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从最简单的情况开始：\(d=1\)，\(\mu = 0\)，\(\sigma^2 = 1\)。也就是说，我们首先生成一个一元标准正态分布。我们之前已经看到了实现这一点的配方，即逆变换抽样方法。具体来说，回想一下，随机变量
    \(Z\) 的累积分布函数（CDF）定义为
- en: \[ F_Z(z) = \mathbb{P}[Z \leq z], \qquad \forall z \in \mathbb{R}. \]
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: \[ F_Z(z) = \mathbb{P}[Z \leq z], \qquad \forall z \in \mathbb{R}. \]
- en: Let \(\mathcal{Z}\) be the interval where \(F_Z(z) \in (0,1)\) and assume that
    \(F_X\) is strictly increasing on \(\mathcal{Z}\). Let \(U \sim \mathrm{U}[0,1]\).
    Then it can be shown that
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 令 \(\mathcal{Z}\) 为 \(F_Z(z) \in (0,1)\) 的区间，并假设 \(F_X\) 在 \(\mathcal{Z}\) 上是严格递增的。令
    \(U \sim \mathrm{U}[0,1]\)。然后可以证明
- en: \[ \mathbb{P}[F_X^{-1}(U) \leq z] = F_X(z). \]
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbb{P}[F_X^{-1}(U) \leq z] = F_X(z). \]
- en: So take \(F_Z = \Phi\), the CDF of the standard Normal. Then \(Z = \Phi^{-1}(U)\)
    is \(N(0,1)\).
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 因此取 \(F_Z = \Phi\)，标准正态分布的 CDF。那么 \(Z = \Phi^{-1}(U)\) 是 \(N(0,1)\)。
- en: How do we generate a \(N(\mu, \sigma^2)\) variable, for arbitrary \(\mu \in
    \mathbb{R}\) and \(\sigma^2 > 0\)? We use the fact that the linear transformation
    of Gaussian is still Gaussian. In particular, if \(Z \sim N(0,1)\), then
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 我们如何生成一个 \(N(\mu, \sigma^2)\) 的变量，对于任意的 \(\mu \in \mathbb{R}\) 和 \(\sigma^2
    > 0\)？我们使用线性变换的 Gaussian 仍然是 Gaussian 的这一事实。特别是，如果 \(Z \sim N(0,1)\)，那么
- en: \[ X = \mu + \sigma Z \]
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: \[ X = \mu + \sigma Z \]
- en: is \(N(\mu, \sigma^2)\).
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 是 \(N(\mu, \sigma^2)\)。
- en: '**NUMERICAL CORNER:** In Python, \(\Phi^{-1}\) can be accessed using [`scipy.stats.norm.ppf`](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html).
    We implement this next (with help from ChatGPT).'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: '**数值角**: 在 Python 中，\(\Phi^{-1}\) 可以通过使用 `scipy.stats.norm.ppf` 来访问。[链接](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html).
    我们接下来实现这个功能（在 ChatGPT 的帮助下）。'
- en: '[PRE36]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: We generate 1000 samples and plot the empirical distribution.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 我们生成1000个样本并绘制经验分布图。
- en: '[PRE37]'
  id: totrans-212
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格源代码 隐藏代码单元格源代码</summary>
- en: '[PRE38]</details> ![../../_images/648741740d20b45ce65b2b2791d1603ea77bd902d8873c497c1a1d5f0cc41bb6.png](../Images/c4d1f8c3493a1c88b3b5727f55a25bef.png)'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE38]</details> ![../../_images/648741740d20b45ce65b2b2791d1603ea77bd902d8873c497c1a1d5f0cc41bb6.png](../Images/c4d1f8c3493a1c88b3b5727f55a25bef.png)'
- en: \(\unlhd\)
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: '**CHAT & LEARN** It turns out there is a neat trick to generate *two* independent
    samples from \(N(0,1)\) that does not rely on access to \(\Phi^{-1}\). It is called
    the Box-Muller transform. Ask your favorite AI chatbot about it. Modify our code
    above to implement it. \(\ddagger\)'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: '**CHAT & LEARN** 事实证明，有一种巧妙的方法可以从 \(N(0,1)\) 中生成两个独立的样本，而不依赖于对 \(\Phi^{-1}\)
    的访问。这被称为Box-Muller变换。向您最喜欢的AI聊天机器人询问它。修改我们上面的代码以实现它。 \(\ddagger\)'
- en: We move on to the multivariate case. We proceed similarly as before. First,
    how do we generate a \(d\)-dimensional Gaussian with mean vector \(\bmu = \mathbf{0}\)
    and identity covariance matrix \(\bSigma = I_{d \times d}\)? Easy – it has \(d\)
    independent components, each of which is standard Normal. So letting \(U_1, \ldots,
    U_d\) be independent uniform \([0,1]\) variables, then
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 我们继续到多元情况。我们像以前一样进行。首先，我们如何生成一个 \(d\) 维高斯分布，其均值向量为 \(\bmu = \mathbf{0}\) 和单位协方差矩阵
    \(\bSigma = I_{d \times d}\)？很简单——它有 \(d\) 个独立的分量，每个分量都是标准正态分布。所以让 \(U_1, \ldots,
    U_d\) 是独立的均匀 \([0,1]\) 变量，那么
- en: \[ \mathbf{Z} = (\Phi^{-1}(U_1),\ldots,\Phi^{-1}(U_d)) \]
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{Z} = (\Phi^{-1}(U_1),\ldots,\Phi^{-1}(U_d)) \]
- en: is \(N(\mathbf{0}, I_{d \times d})\).
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 是 \(N(\mathbf{0}, I_{d \times d})\)。
- en: We now seek to generate a multivariate Gaussian with arbitrary mean vector \(\bmu\)
    and positive definite covariance matrix \(\bSigma\). Again, we use a linear transformation
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在寻求生成一个具有任意均值向量 \(\bmu\) 和正定协方差矩阵 \(\bSigma\) 的多元高斯分布。同样，我们使用线性变换
- en: \[ \mathbf{X} = \mathbf{a} + A \mathbf{Z}. \]
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{X} = \mathbf{a} + A \mathbf{Z}. \]
- en: What are the right choices for \(a \in \mathbb{R}^d\) and \(A \in \mathbb{R}^{d
    \times d}\)? We need to match the obtained and desired mean and covariance. We
    start with the mean. By linearity of expectation,
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 \(a \in \mathbb{R}^d\) 和 \(A \in \mathbb{R}^{d \times d}\) 的正确选择是什么？我们需要匹配获得和期望的均值和协方差。我们从均值开始。根据期望的线性，
- en: \[ \E[\mathbf{X}] = \E[\mathbf{a} + A \mathbf{Z}] = \mathbf{a} + A \,\E[\mathbf{Z}]
    = \mathbf{a}. \]
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \E[\mathbf{X}] = \E[\mathbf{a} + A \mathbf{Z}] = \mathbf{a} + A \,\E[\mathbf{Z}]
    = \mathbf{a}. \]
- en: Hence we pick \(\mathbf{a} := \bmu\).
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 因此我们选择 \(\mathbf{a} := \bmu\).
- en: As for the covariance, using the *Covariance of a Linear Transformation*, we
    get
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 至于协方差，使用**线性变换的协方差**，我们得到
- en: \[ \cov[\mathbf{X}] = A \,\cov[\mathbf{Z}] A^T = A A^T. \]
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \cov[\mathbf{X}] = A \,\cov[\mathbf{Z}] A^T = A A^T. \]
- en: 'Now we have a problem: what is a matrix \(A\) such that'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有一个问题：什么是一个矩阵 \(A\)，使得
- en: \[ A A^T = \bSigma? \]
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: \[ A A^T = \bSigma? \]
- en: In some sense, we are looking for a sort of “square root” of the covariance
    matrix. There are several ways of doing this. The Cholesky decomposition is one
    of them. We return to generating samples from \(N(\bmu, \bSigma)\) after introducing
    it.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 在某种意义上，我们正在寻找协方差矩阵的“平方根”。有几种方法可以做到这一点。Cholesky分解是其中之一。在介绍它之后，我们返回到从 \(N(\bmu,
    \bSigma)\) 生成样本。
- en: '**A matrix factorization** Our key linear-algebraic result of this section
    is the following. The matrix factorization in the next theorem is called a Cholesky
    decomposition. It has many [applications](https://en.wikipedia.org/wiki/Cholesky_decomposition#Applications).'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: '**矩阵分解** 本节的关键线性代数结果是以下内容。下一定理中的矩阵分解称为Cholesky分解。它有众多[应用](https://en.wikipedia.org/wiki/Cholesky_decomposition#Applications)。'
- en: '**THEOREM** **(Cholesky Decomposition)** Any positive definite matrix \(B \in
    \mathbb{R}^{n \times n}\) can be factorized uniquely as'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: '**定理** **(Cholesky分解)** 任何正定矩阵 \(B \in \mathbb{R}^{n \times n}\) 可以唯一分解为'
- en: \[ B = L L^T \]
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: \[ B = L L^T \]
- en: where \(L \in \mathbb{R}^{n \times n}\) is a lower triangular matrix with positive
    entries on the diagonal. \(\sharp\)
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(L \in \mathbb{R}^{n \times n}\) 是一个下三角矩阵，对角线上的元素为正。 \(\sharp\)
- en: 'The proof is provided below. It is based on deriving an algorithm for computing
    the Cholesky decomposition: we grow \(L\) starting from its top-left corner by
    successively computing its next row based on the previously constructed submatrix.
    Note that, because \(L\) is lower triangular, it suffices to compute its elements
    on and below the diagonal. We first give the algorithm, then establish that it
    is well-defined.'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 证明如下。它基于推导出计算 Cholesky 分解的算法：我们从 \(L\) 的左上角开始，通过依次计算其下一行基于之前构建的子矩阵来增长 \(L\)。请注意，因为
    \(L\) 是下三角矩阵，所以我们只需要计算其对角线及其以下的元素。我们首先给出算法，然后证明它是良定义的。
- en: '**Figure:** Access pattern ([Source](https://en.wikipedia.org/wiki/File:Chol.gif))'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: '**图示：** 访问模式 ([来源](https://en.wikipedia.org/wiki/File:Chol.gif))'
- en: '![Access pattern](../Images/20de5b823040500b0d04511959484e97.png)'
  id: totrans-236
  prefs: []
  type: TYPE_IMG
  zh: '![访问模式](../Images/20de5b823040500b0d04511959484e97.png)'
- en: \(\bowtie\)
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: \(\bowtie\)
- en: '**EXAMPLE:** Before proceeeding with the general method, we give a small example
    to provide some intuition as to how it operates. We need a positive definite matrix.
    Consider the matrix'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例：** 在进行一般方法之前，我们先给出一个小例子，以提供一些关于其操作方式的直观理解。我们需要一个正定矩阵。考虑以下矩阵'
- en: \[\begin{split} A = \begin{pmatrix} 1 & 2 & 1\\ 0 & -2 & 1\\ 0 & 0 & 1\\ 0 &
    0 & 0 \end{pmatrix}. \end{split}\]
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A = \begin{pmatrix} 1 & 2 & 1\\ 0 & -2 & 1\\ 0 & 0 & 1\\ 0 &
    0 & 0 \end{pmatrix}. \end{split}\]
- en: It has full column rank (why?). Recall that, in that case, the \(B = A^T A\)
    is positive definite.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 它具有满列秩（为什么？）。回想一下，在这种情况下，\(B = A^T A\) 是正定的。
- en: That is, the matrix
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 那就是矩阵
- en: \[\begin{split} B = A^T A = \begin{pmatrix} 1 & 2 & 1\\ 2 & 8 & 0\\ 1 & 0 &
    3 \end{pmatrix} \end{split}\]
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} B = A^T A = \begin{pmatrix} 1 & 2 & 1\\ 2 & 8 & 0\\ 1 & 0 &
    3 \end{pmatrix} \end{split}\]
- en: is positive definite.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 是正定的。
- en: Let \(L = (\ell_{i,j})_{i,j=1}^3\) be lower triangular. We seek to solve \(L
    L^T = B\) for the nonzero entries of \(L\). Observe that
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 设 \(L = (\ell_{i,j})_{i,j=1}^3\) 为下三角矩阵。我们寻求解 \(L L^T = B\) 对于 \(L\) 的非零元素。观察如下
- en: \[\begin{split} \begin{pmatrix} \ell_{1,1} & 0 & 0\\ \ell_{2,1} & \ell_{2,2}
    & 0\\ \ell_{3,1} & \ell_{3,2} & \ell_{3,3} \end{pmatrix} \begin{pmatrix} \ell_{1,1}
    & \ell_{2,1} & \ell_{3,1}\\ 0 & \ell_{2,2} & \ell_{3,2}\\ 0 & 0 & \ell_{3,3} \end{pmatrix}
    = \begin{pmatrix} \ell_{1,1}^2 & \ell_{1,1}\ell_{2,1} & \ell_{1,1}\ell_{3,1}\\
    \ell_{1,1}\ell_{2,1} & \ell_{2,1}^2 + \ell_{2,2}^2 & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2}\\
    \ell_{1,1}\ell_{3,1} & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2} & \ell_{3,1}^2
    + \ell_{3,2}^2 + \ell_{3,3} \end{pmatrix}. \end{split}\]
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} \ell_{1,1} & 0 & 0\\ \ell_{2,1} & \ell_{2,2}
    & 0\\ \ell_{3,1} & \ell_{3,2} & \ell_{3,3} \end{pmatrix} \begin{pmatrix} \ell_{1,1}
    & \ell_{2,1} & \ell_{3,1}\\ 0 & \ell_{2,2} & \ell_{3,2}\\ 0 & 0 & \ell_{3,3} \end{pmatrix}
    = \begin{pmatrix} \ell_{1,1}^2 & \ell_{1,1}\ell_{2,1} & \ell_{1,1}\ell_{3,1}\\
    \ell_{1,1}\ell_{2,1} & \ell_{2,1}^2 + \ell_{2,2}^2 & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2}\\
    \ell_{1,1}\ell_{3,1} & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2} & \ell_{3,1}^2
    + \ell_{3,2}^2 + \ell_{3,3} \end{pmatrix}. \end{split}\]
- en: The system
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 系统如下
- en: \[\begin{split} \begin{pmatrix} \ell_{1,1}^2 & \ell_{1,1}\ell_{2,1} & \ell_{1,1}\ell_{3,1}\\
    \ell_{1,1}\ell_{2,1} & \ell_{2,1}^2 + \ell_{2,2}^2 & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2}\\
    \ell_{1,1}\ell_{3,1} & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2} & \ell_{3,1}^2
    + \ell_{3,2}^2 + \ell_{3,3}^2 \end{pmatrix} = \begin{pmatrix} 1 & 2 & 1\\ 2 &
    8 & 0\\ 1 & 0 & 3 \end{pmatrix} \end{split}\]
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} \ell_{1,1}^2 & \ell_{1,1}\ell_{2,1} & \ell_{1,1}\ell_{3,1}\\
    \ell_{1,1}\ell_{2,1} & \ell_{2,1}^2 + \ell_{2,2}^2 & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2}\\
    \ell_{1,1}\ell_{3,1} & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2} & \ell_{3,1}^2
    + \ell_{3,2}^2 + \ell_{3,3}^2 \end{pmatrix} = \begin{pmatrix} 1 & 2 & 1\\ 2 &
    8 & 0\\ 1 & 0 & 3 \end{pmatrix} \end{split}\]
- en: turns out to be fairly simple to solve.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 竟然相当简单就能解决。
- en: From the first entry, we get \(\ell_{1,1} = 1\) (where we took the positive
    solution to \(\ell_{1,1}^2 = 1\)).
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从第一个元素，我们得到 \(\ell_{1,1} = 1\)（我们在 \(\ell_{1,1}^2 = 1\) 中取了正解）。
- en: Given that \(\ell_{1,1}\) is known, entry \(\ell_{2,1}\) is determined from
    \(\ell_{1,1}\ell_{2,1} =2\) in the first entry of the second row. That is, \(\ell_{2,1}
    =2\). Then the second entry of the second row gives \(\ell_{2,2}\) through \(\ell_{2,1}^2
    + \ell_{2,2}^2 = 8\). So \(\ell_{2,2} = 2\) (again we take the positive solution).
  id: totrans-250
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 既然 \(\ell_{1,1}\) 已知，从第二行的第一个元素 \(\ell_{1,1}\ell_{2,1} =2\) 可以确定 \(\ell_{2,1}\)。也就是说，\(\ell_{2,1}
    =2\)。然后第二行的第二个元素给出 \(\ell_{2,2}\) 通过 \(\ell_{2,1}^2 + \ell_{2,2}^2 = 8\)。所以 \(\ell_{2,2}
    = 2\)（我们再次取正解）。
- en: We move to the third row. The first entry gives \(\ell_{3,1} = 1\), the second
    entry gives \(\ell_{3,2} = -1\) and finally the third entry leads to \(\ell_{3,3}
    = 1\).
  id: totrans-251
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们转向第三行。第一个元素给出 \(\ell_{3,1} = 1\)，第二个元素给出 \(\ell_{3,2} = -1\)，最后第三个元素导致 \(\ell_{3,3}
    = 1\)。
- en: Hence we have
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 因此我们有
- en: \[\begin{split} L = \begin{pmatrix} \ell_{1,1} & 0 & 0\\ \ell_{2,1} & \ell_{2,2}
    & 0\\ \ell_{3,1} & \ell_{3,2} & \ell_{3,3} \end{pmatrix} = \begin{pmatrix} 1 &
    0 & 0\\ 2 & 2 & 0\\ 1 & -1 & 1 \end{pmatrix}. \end{split}\]
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} L = \begin{pmatrix} \ell_{1,1} & 0 & 0\\ \ell_{2,1} & \ell_{2,2}
    & 0\\ \ell_{3,1} & \ell_{3,2} & \ell_{3,3} \end{pmatrix} = \begin{pmatrix} 1 &
    0 & 0\\ 2 & 2 & 0\\ 1 & -1 & 1 \end{pmatrix}. \end{split}\]
- en: \(\lhd\)
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: \(\lhd\)
- en: To detail the computation of the Cholesky decomposition \(L L^T\) of \(B\),
    we will need some notation. Write \(B = (b_{i,j})_{i,j=1}^n\) and \(L = (\ell_{i,j})_{i,j=1}^n\).
    Let \(L_{(k)} = (\ell_{i,j})_{i,j=1}^k\) be the first \(k\) rows and columns of
    \(L\), let \(\bflambda_{(k)}^T = (\ell_{k,1},\ldots,\ell_{k,k-1})\) be the row
    vector corresponding to the first \(k-1\) entries of row \(k\) of \(L\), and let
    \(\bfbeta_{(k)}^T = (b_{k,1},\ldots,b_{k,k-1})\) be the row vector corresponding
    to the first \(k-1\) entries of row \(k\) of \(B\).
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 为了详细说明 \(B\) 的 Cholesky 分解 \(L L^T\) 的计算，我们需要一些符号。写出 \(B = (b_{i,j})_{i,j=1}^n\)
    和 \(L = (\ell_{i,j})_{i,j=1}^n\)。令 \(L_{(k)} = (\ell_{i,j})_{i,j=1}^k\) 为 \(L\)
    的前 \(k\) 行和列，令 \(\bflambda_{(k)}^T = (\ell_{k,1},\ldots,\ell_{k,k-1})\) 为 \(L\)
    的第 \(k\) 行的前 \(k-1\) 个元素的行向量，并令 \(\bfbeta_{(k)}^T = (b_{k,1},\ldots,b_{k,k-1})\)
    为 \(B\) 的第 \(k\) 行的前 \(k-1\) 个元素的行向量。
- en: The strategy is to compute \(L_{(1)}\), then \(L_{(2)}\), then \(L_{(3)}\) and
    so on. With the notation above, \(L_{(j)}\) can be written in block form as
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 策略是先计算 \(L_{(1)}\)，然后 \(L_{(2)}\)，然后 \(L_{(3)}\)，依此类推。根据上述符号，\(L_{(j)}\) 可以写成块形式为
- en: \[\begin{split} L_{(j)} = \begin{pmatrix} L_{(j-1)} & \mathbf{0}\\ \bflambda_{(j)}^T
    & \ell_{j,j}. \end{pmatrix} \end{split}\]
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} L_{(j)} = \begin{pmatrix} L_{(j-1)} & \mathbf{0}\\ \bflambda_{(j)}^T
    & \ell_{j,j}. \end{pmatrix} \end{split}\]
- en: Hence, once \(L_{(j-1)}\) is known, in order to compute \(L_{(j)}\) one only
    needs \(\bflambda_{(j)}\) and \(\ell_{j,j}\). We show next that they satisfy easily
    solvable systems of equations.
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，一旦 \(L_{(j-1)}\) 已知，为了计算 \(L_{(j)}\)，只需要 \(\bflambda_{(j)}\) 和 \(\ell_{j,j}\)。我们接下来将证明它们满足容易解决的方程组。
- en: We first note that the \((1,1)\) entry of the matrix equation \(L L^T = B\)
    implies that
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先注意到矩阵方程 \(L L^T = B\) 的 \((1,1)\) 个元素意味着
- en: \[ \ell_{1,1}^2 = b_{1,1}. \]
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \ell_{1,1}^2 = b_{1,1}. \]
- en: So we set
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们设置
- en: \[ L_{(1)} = \ell_{1,1} = \sqrt{b_{1,1}}. \]
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L_{(1)} = \ell_{1,1} = \sqrt{b_{1,1}}. \]
- en: 'For this step to be well-defined, it needs to be the case that \(b_{1,1} >
    0\). It is easy to see that it follows from the positive definiteness of \(B\):'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使这一步定义良好，需要满足 \(b_{1,1} > 0\)。很容易看出，这可以从 \(B\) 的正定性得出：
- en: \[ 0 < \langle \mathbf{e}_1, B \mathbf{e}_1\rangle = \mathbf{e}_1^T B_{\cdot,1}
    = b_{1,1}. \]
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 0 < \langle \mathbf{e}_1, B \mathbf{e}_1\rangle = \mathbf{e}_1^T B_{\cdot,1}
    = b_{1,1}. \]
- en: Proceeding by induction, assume \(L_{(j-1)}\) has been constructed. The first
    \(j-1\) elements of the \(j\)-th row of the matrix equation \(L L^T = B\) translate
    into
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 通过归纳法进行，假设 \(L_{(j-1)}\) 已被构造。矩阵方程 \(L L^T = B\) 的第 \(j\) 行的前 \(j-1\) 个元素转换为
- en: \[ L_{j,\cdot} (L^T)_{\cdot,1:j-1} = \bflambda_{(j)}^T L_{(j-1)}^T = \bfbeta_{(j)}^T,
    \]
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L_{j,\cdot} (L^T)_{\cdot,1:j-1} = \bflambda_{(j)}^T L_{(j-1)}^T = \bfbeta_{(j)}^T,
    \]
- en: where \((L^T)_{\cdot,1:j-1}\) denotes the first \(j-1\) columns of \(L^T\).
    In the first equality above, we used the fact that \(L^T\) is upper triangular.
    Taking a transpose, the resulting linear system of equations
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \((L^T)_{\cdot,1:j-1}\) 表示 \(L^T\) 的前 \(j-1\) 列。在上面的第一个等式中，我们使用了 \(L^T\)
    是上三角的事实。取转置，得到的线性方程组
- en: \[ L_{(j-1)} \bflambda_{(j)} = \bfbeta_{(j)} \]
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L_{(j-1)} \bflambda_{(j)} = \bfbeta_{(j)} \]
- en: can be solved by forward substitution (since \(\bfbeta_{(j)}\) is part of the
    input and \(L_{(j-1)}\) was previously computed). The fact that this system has
    a unique solution (more specifically, that the diagonal entries of \(L_{(j-1)}\)
    are strictly positive) is established in the proof of the *Cholesky Decomposition
    Theorem*.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 可以通过前向替换（因为 \(\bfbeta_{(j)}\) 是输入的一部分，且 \(L_{(j-1)}\) 已被先前计算）来解决。这个系统有唯一解的事实（更具体地说，\(L_{(j-1)}\)
    的对角线元素是严格正的）在 *Cholesky 分解定理* 的证明中得到了确立。
- en: The \((j,j)\)-th entry of the matrix equation \(L L^T = B\) translates into
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 矩阵方程 \((j,j)\)-th 项 \(L L^T = B\) 转换为
- en: \[ L_{j,\cdot} (L^T)_{\cdot,j} = \sum_{k=1}^j \ell_{j,k}^2 = b_{j,j}, \]
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L_{j,\cdot} (L^T)_{\cdot,j} = \sum_{k=1}^j \ell_{j,k}^2 = b_{j,j}, \]
- en: where again we used the fact that \(L^T\) is upper triangular. Since \(\ell_{j,1},
    \ldots, \ell_{j,j-1}\) are the elements of \(\bflambda_{(j)}\), they have already
    been determined. So we can set
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 其中再次使用了 \(L^T\) 是上三角的事实。由于 \(\ell_{j,1}, \ldots, \ell_{j,j-1}\) 是 \(\bflambda_{(j)}\)
    的元素，它们已经被确定。因此，我们可以设置
- en: \[ \ell_{j,j} = \sqrt{b_{j,j} - \sum_{k=1}^{j-1} \ell_{j,k}^2}. \]
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \ell_{j,j} = \sqrt{b_{j,j} - \sum_{k=1}^{j-1} \ell_{j,k}^2}. \]
- en: The fact that we are taking the square root of a positive quantity is established
    in the proof of the *Cholesky Decomposition Theorem*. Finally, from \(L_{(j-1)}\),
    \(\bflambda_{(j)}\), and \(\ell_{j,j}\), we construct \(L_{(j)}\).
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在 *Cholesky 分解定理* 的证明中确立了我们对正数取平方根的事实。最后，从 \(L_{(j-1)}\)，\(\bflambda_{(j)}\)
    和 \(\ell_{j,j}\) 中，我们构建 \(L_{(j)}\)。
- en: '**NUMERICAL CORNER:** We implement the algorithm above. In our naive implementation,
    we assume that \(B\) is positive definite, and therefore that all steps are well-defined.'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: '**数值角:** 我们实现了上述算法。在我们的原始实现中，我们假设 \(B\) 是正定的，因此所有步骤都是定义良好的。'
- en: '[PRE39]'
  id: totrans-276
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: Here is a simple example.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一个简单的例子。
- en: '[PRE40]'
  id: totrans-278
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: '[PRE41]'
  id: totrans-279
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: '[PRE42]'
  id: totrans-280
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: '[PRE43]'
  id: totrans-281
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: We can check that it produces the right factorization.
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以检查它是否产生正确的分解。
- en: '[PRE44]'
  id: totrans-283
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: '[PRE45]'
  id: totrans-284
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: \(\unlhd\)
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: '**Proof of Cholesky decomposition theorem** We give a proof of the *Cholesky
    Decomposition Theorem*.'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: '**Cholesky 分解定理的证明** 我们给出了 *Cholesky 分解定理* 的证明。'
- en: '*Proof idea:* Assuming by induction that the upper-left corner of the matrix
    \(B\) has a Cholesky decomposition, one finds equations for the remaining row
    that can be solved uniquely by the properties established in the previous subsection.'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明思路:* 假设通过归纳法，矩阵 \(B\) 的左上角具有 Cholesky 分解，那么可以找到剩余行的方程，这些方程可以通过前一小节中建立的性质唯一求解。'
- en: '*Proof:* If \(n=1\), we have shown previously that \(b_{1,1} > 0\), and hence
    we can take \(L = [\ell_{1,1}]\) where \(\ell_{1,1} = \sqrt{b_{1,1}}\). Assuming
    the result holds for positive definite matrices in \(\mathbb{R}^{(n-1) \times
    (n-1)}\), we first re-write \(B = L L^T\) in block form'
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明:* 如果 \(n=1\)，我们之前已经证明了 \(b_{1,1} > 0\)，因此我们可以取 \(L = [\ell_{1,1}]\)，其中
    \(\ell_{1,1} = \sqrt{b_{1,1}}\)。假设对于 \(\mathbb{R}^{(n-1) \times (n-1)}\) 中的正定矩阵，结果成立，我们首先将
    \(B = L L^T\) 以分块形式重写'
- en: \[\begin{split} \begin{pmatrix} B_{11} & \bfbeta_{12}\\ \bfbeta_{12}^T & \beta_{22}
    \end{pmatrix} = \begin{pmatrix} \Lambda_{11} & \mathbf{0}\\ \bflambda_{12}^T &
    \lambda_{22} \end{pmatrix} \begin{pmatrix} \Lambda_{11}^T & \bflambda_{12}\\ \mathbf{0}^T
    & \lambda_{22} \end{pmatrix} \end{split}\]
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} B_{11} & \bfbeta_{12}\\ \bfbeta_{12}^T & \beta_{22}
    \end{pmatrix} = \begin{pmatrix} \Lambda_{11} & \mathbf{0}\\ \bflambda_{12}^T &
    \lambda_{22} \end{pmatrix} \begin{pmatrix} \Lambda_{11}^T & \bflambda_{12}\\ \mathbf{0}^T
    & \lambda_{22} \end{pmatrix} \end{split}\]
- en: where \(B_{11}, \Lambda_{11} \in \mathbb{R}^{n-1 \times n-1}\), \(\bfbeta_{12},
    \bflambda_{12} \in \mathbb{R}^{n-1}\) and \(\beta_{22}, \lambda_{22} \in \mathbb{R}\).
    By block matrix algebra, we get the system
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(B_{11}, \Lambda_{11} \in \mathbb{R}^{n-1 \times n-1}\)，\(\bfbeta_{12},
    \bflambda_{12} \in \mathbb{R}^{n-1}\) 和 \(\beta_{22}, \lambda_{22} \in \mathbb{R}\)。通过分块矩阵代数，我们得到以下系统
- en: \[\begin{split} B_{11} = \Lambda_{11} \Lambda_{11}^T\\ \bfbeta_{12} = \Lambda_{11}
    \bflambda_{12}\\ \beta_{22} = \bflambda_{12}^T \bflambda_{12} + \lambda_{22}^2.
    \end{split}\]
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} B_{11} = \Lambda_{11} \Lambda_{11}^T\\ \bfbeta_{12} = \Lambda_{11}
    \bflambda_{12}\\ \beta_{22} = \bflambda_{12}^T \bflambda_{12} + \lambda_{22}^2.
    \end{split}\]
- en: By the *Principal Submatrices Lemma*, the principal submatrix \(B_{11}\) is
    positive definite. Hence, by induction, there is a unique lower-triangular matrix
    \(\Lambda_{11}\) with positive diagonal elements satisfying the first equation.
    We can then obtain \(\bfbeta_{12}\) from the second equation by forward substitution.
    And finally we get
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 根据主子矩阵引理，主子矩阵 \(B_{11}\) 是正定的。因此，通过归纳法，存在一个唯一的下三角矩阵 \(\Lambda_{11}\)，其对角线元素为正，满足第一个方程。然后我们可以通过前向替换从第二个方程中获取
    \(\bfbeta_{12}\)。最后我们得到
- en: \[ \lambda_{22} = \sqrt{\beta_{22} - \bflambda_{12}^T \bflambda_{12}}. \]
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \lambda_{22} = \sqrt{\beta_{22} - \bflambda_{12}^T \bflambda_{12}}. \]
- en: 'We do have to check that the square root above exists. That is, we need to
    argue that the expression inside the square root is non-negative. In fact, for
    the claim to go through, we need it to be strictly positive. We notice that the
    expression inside the square root is in fact the Schur complement of the block
    \(B_{11}\):'
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 我们确实需要检查上面的平方根是否存在。也就是说，我们需要论证平方根内的表达式是非负的。实际上，为了使这个断言成立，我们需要它严格为正。我们注意到平方根内的表达式实际上是块
    \(B_{11}\) 的 Schur 补：
- en: \[\begin{align*} \beta_{22} - \bflambda_{12}^T \bflambda_{12} &= \beta_{22}
    - (\Lambda_{11}^{-1} \bfbeta_{12})^T (\Lambda_{11}^{-1} \bfbeta_{12})\\ &= \beta_{22}
    - \bfbeta_{12}^T (\Lambda_{11}^{-1})^T \Lambda_{11}^{-1} \bfbeta_{12}\\ &= \beta_{22}
    - \bfbeta_{12}^T (\Lambda_{11} \Lambda_{11}^T)^{-1} \bfbeta_{12}\\ &= \beta_{22}
    - \bfbeta_{12}^T (B_{11})^{-1} \bfbeta_{12} \end{align*}\]
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \beta_{22} - \bflambda_{12}^T \bflambda_{12} &= \beta_{22}
    - (\Lambda_{11}^{-1} \bfbeta_{12})^T (\Lambda_{11}^{-1} \bfbeta_{12})\\ &= \beta_{22}
    - \bfbeta_{12}^T (\Lambda_{11}^{-1})^T \Lambda_{11}^{-1} \bfbeta_{12}\\ &= \beta_{22}
    - \bfbeta_{12}^T (\Lambda_{11} \Lambda_{11}^T)^{-1} \bfbeta_{12}\\ &= \beta_{22}
    - \bfbeta_{12}^T (B_{11})^{-1} \bfbeta_{12} \end{align*}\]
- en: where we used the equation \(\bfbeta_{12} = \Lambda_{11} \bflambda_{12}\) on
    the first line, the identities \((Q W)^{-1} = W^{-1} Q^{-1}\) and \((Q^T)^{-1}
    = (Q^{-1})^T\) (see the exercise below) on the third line and the equation \(B_{11}
    = \Lambda_{11} \Lambda_{11}^T\) on the fourth line. By the *Schur Complement Lemma*,
    the Schur complement is positive definite. Because it is a scalar in this case,
    it is strictly positive (prove it!), which concludes the proof. \(\square\)
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 在第一行我们使用了方程 \(\bfbeta_{12} = \Lambda_{11} \bflambda_{12}\)，在第三行使用了恒等式 \((Q W)^{-1}
    = W^{-1} Q^{-1}\) 和 \((Q^T)^{-1} = (Q^{-1})^T\)（见下面的练习），在第四行使用了方程 \(B_{11} = \Lambda_{11}
    \Lambda_{11}^T\)。根据 *Schur 补引理*，Schur 补是正定的。因为在这种情况下它是一个标量，所以它是严格正的（证明它！），这完成了证明。
    \(\square\)
- en: '**Back to multivariate Gaussians** Returning to our motivation, we can generate
    samples from a \(N(\bmu, \bSigma)\) by first generating'
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: '**回到多元高斯分布** 回到我们的动机，我们可以通过首先生成'
- en: \[ \mathbf{Z} = (\Phi^{-1}(U_1),\ldots,\Phi^{-1}(U_d)) \]
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{Z} = (\Phi^{-1}(U_1),\ldots,\Phi^{-1}(U_d)) \]
- en: where \(U_1, \ldots, U_d\) are independent uniform \([0,1]\) variables, then
    setting
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(U_1, \ldots, U_d\) 是独立的 \([0,1]\) 均匀变量，然后设置
- en: \[ \mathbf{X} = \bmu + L \mathbf{Z}, \]
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{X} = \bmu + L \mathbf{Z}, \]
- en: where \(\bSigma = L L^T\) is a Cholesky decomposition of \(\bSigma\).
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(\bSigma = L L^T\) 是 \(\bSigma\) 的 Cholesky 分解。
- en: '**NUMERICAL CORNER:** We implement this method.'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: '**数值角:** 我们实现了这个方法。'
- en: '[PRE46]'
  id: totrans-303
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: We generate some samples as an example.
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 我们生成一些样本作为示例。
- en: '[PRE47]'
  id: totrans-305
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格源代码 隐藏代码单元格源代码</summary>
- en: '[PRE48]</details>'
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE48]</details>'
- en: '[PRE49]'
  id: totrans-308
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: \(\unlhd\)
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: '**Using a Cholesky decomposition to solve the least squares problem** Another
    application of the Cholesky decomposition is to solving the least squares problem.
    In this section, we restrict ourselves to the case where \(A \in \mathbb{R}^{n\times
    m}\) has full column rank. By the *Least Squares and Positive Semidefiniteness
    Lemma*, we then have that \(A^T A\) is positive definite. By the *Cholesky Decomposition
    Theorem*, we can factorize this matrix as \(A^T A = L L^T\) where \(L\) is lower
    triangular with positive diagonal elements. The normal equations then reduce to'
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: '**使用 Cholesky 分解求解最小二乘问题** Cholesky 分解的另一个应用是求解最小二乘问题。在本节中，我们限制在 \(A \in \mathbb{R}^{n\times
    m}\) 具有满列秩的情况。根据 *最小二乘与正半定引理*，我们随后有 \(A^T A\) 是正定的。根据 *Cholesky 分解定理*，我们可以将这个矩阵分解为
    \(A^T A = L L^T\)，其中 \(L\) 是下三角矩阵，对角线元素为正。正则方程随后简化为'
- en: \[ L L^T \mathbf{x} = A^T \mathbf{b}. \]
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L L^T \mathbf{x} = A^T \mathbf{b}. \]
- en: This system can be solved in two steps. We first obtain the solution to
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 这个系统可以通过两个步骤求解。我们首先求解
- en: \[ L \mathbf{z} = A^T \mathbf{b} \]
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L \mathbf{z} = A^T \mathbf{b} \]
- en: by forward substitution. Then we obtain the solution to
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 通过前向替换求解。然后我们得到以下方程的解
- en: \[ L^T \mathbf{x} = \mathbf{z} \]
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L^T \mathbf{x} = \mathbf{z} \]
- en: by back-substitution. Note that \(L^T\) is indeed an upper triangular matrix.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 通过回代求解。注意，\(L^T\) 确实是一个上三角矩阵。
- en: '**NUMERICAL CORNER:** We implement this algorithm below. In our naive implementation,
    we assume that \(A\) has full column rank, and therefore that all steps are well-defined.'
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: '**数值角:** 我们在下面实现了这个算法。在我们的原始实现中，我们假设 \(A\) 具有满列秩，因此所有步骤都是定义良好的。'
- en: '[PRE50]'
  id: totrans-318
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: \(\unlhd\)
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: Other applications of the Cholesky decomposition are briefly described [here](https://en.wikipedia.org/wiki/Cholesky_decomposition#Applications).
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: Cholesky 分解的其他应用简要描述[在此](https://en.wikipedia.org/wiki/Cholesky_decomposition#Applications)。
- en: 6.7.1\. Quizzes, solutions, code, etc.[#](#quizzes-solutions-code-etc "Link
    to this heading")
  id: totrans-321
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 6.7.1\. 问答、解答、代码等。[#](#quizzes-solutions-code-etc "链接到这个标题")
- en: 6.7.1.1\. Just the code[#](#just-the-code "Link to this heading")
  id: totrans-322
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.1.1\. 只展示代码[#](#just-the-code "链接到这个标题")
- en: An interactive Jupyter notebook featuring the code in this chapter can be accessed
    below (Google Colab recommended). You are encouraged to tinker with it. Some suggested
    computational exercises are scattered throughout. The notebook is also available
    as a slideshow.
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 一个包含本章代码的交互式 Jupyter 笔记本可以在此访问（推荐使用 Google Colab）。鼓励您对其进行尝试。一些建议的计算练习散布在其中。笔记本也可以作为幻灯片查看。
- en: '[Notebook](https://github.com/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/just_the_code/roch_mmids_chap_prob_notebook.ipynb)
    ([Open In Colab](https://colab.research.google.com/github/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/just_the_code/roch_mmids_chap_prob_notebook.ipynb))'
  id: totrans-324
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[笔记本](https://github.com/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/just_the_code/roch_mmids_chap_prob_notebook.ipynb)
    ([在Colab中打开](https://colab.research.google.com/github/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/just_the_code/roch_mmids_chap_prob_notebook.ipynb))'
- en: '[Slideshow](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/just_the_code/roch_mmids_chap_prob_notebook_slides.slides.html)'
  id: totrans-325
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[幻灯片](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/just_the_code/roch_mmids_chap_prob_notebook_slides.slides.html)'
- en: 6.7.1.2\. Self-assessment quizzes[#](#self-assessment-quizzes "Link to this
    heading")
  id: totrans-326
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.1.2\. 自我评估测验[#](#self-assessment-quizzes "链接到本标题")
- en: A more extensive web version of the self-assessment quizzes is available by
    following the links below.
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 通过以下链接可以获取更广泛的自我评估测验版本。
- en: '[Section 6.2](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_2.html)'
  id: totrans-328
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第6.2节](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_2.html)'
- en: '[Section 6.3](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_3.html)'
  id: totrans-329
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第6.3节](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_3.html)'
- en: '[Section 6.4](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_4.html)'
  id: totrans-330
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第6.4节](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_4.html)'
- en: '[Section 6.5](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_5.html)'
  id: totrans-331
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第6.5节](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_5.html)'
- en: 6.7.1.3\. Auto-quizzes[#](#auto-quizzes "Link to this heading")
  id: totrans-332
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.1.3\. 自动测验[#](#auto-quizzes "链接到本标题")
- en: Automatically generated quizzes for this chapter can be accessed here (Google
    Colab recommended).
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 可以在此处访问本章的自动生成的测验（推荐使用Google Colab）。
- en: '[Auto-quizzes](https://github.com/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/quizzes/auto_quizzes/roch-mmids-prob-autoquiz.ipynb)
    ([Open In Colab](https://colab.research.google.com/github/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/quizzes/auto_quizzes/roch-mmids-prob-autoquiz.ipynb))'
  id: totrans-334
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[自动测验](https://github.com/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/quizzes/auto_quizzes/roch-mmids-prob-autoquiz.ipynb)
    ([在Colab中打开](https://colab.research.google.com/github/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/quizzes/auto_quizzes/roch-mmids-prob-autoquiz.ipynb))'
- en: 6.7.1.4\. Solutions to odd-numbered warm-up exercises[#](#solutions-to-odd-numbered-warm-up-exercises
    "Link to this heading")
  id: totrans-335
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.1.4\. 奇数编号预热练习的解答[#](#solutions-to-odd-numbered-warm-up-exercises "链接到本标题")
- en: '*(with help from Claude, Gemini, and ChatGPT)*'
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: '*(在Claude、Gemini和ChatGPT的帮助下)*'
- en: '**E6.2.1** The probability of \(Y\) being in the second category is:'
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.2.1** \(Y\) 在第二类中的概率是：'
- en: \[ \mathbb{P}(Y = e_2) = \pi_2 = 0.5. \]
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbb{P}(Y = e_2) = \pi_2 = 0.5. \]
- en: '**E6.2.3** Let \(X_1, \ldots, X_n\) be i.i.d. Bernoulli\((q^*)\). The MLE is
    \(\hat{q}_{\mathrm{MLE}} = \frac{1}{n} \sum_{i=1}^n X_i\). By the Law of Large
    Numbers, as \(n \to \infty\),'
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.2.3** 设 \(X_1, \ldots, X_n\) 为独立同分布的伯努利\((q^*)\)。最大似然估计是 \(\hat{q}_{\mathrm{MLE}}
    = \frac{1}{n} \sum_{i=1}^n X_i\)。根据大数定律，当 \(n \to \infty\) 时，'
- en: \[ \hat{q}_{\mathrm{MLE}} \to \mathbb{E}[X_1] = q^* \]
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \hat{q}_{\mathrm{MLE}} \to \mathbb{E}[X_1] = q^* \]
- en: almost surely.
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 几乎必然。
- en: '**E6.2.5** The gradient at \(w = 0\) is:'
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.2.5** 在 \(w = 0\) 处的梯度是：'
- en: \[ \nabla_w L_4(0; \{(x_i, y_i)\}_{i=1}^4) = -\sum_{i=1}^4 x_i(y_i - \sigma(0))
    = -\frac{1}{2}(1 - 2 + 3 - 4) = 1. \]
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \nabla_w L_4(0; \{(x_i, y_i)\}_{i=1}^4) = -\sum_{i=1}^4 x_i(y_i - \sigma(0))
    = -\frac{1}{2}(1 - 2 + 3 - 4) = 1. \]
- en: 'The updated parameter after one step of gradient descent is:'
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 梯度下降一步后的更新参数是：
- en: \[ w' = w - \eta \nabla_w L_4(w; \{(x_i, y_i)\}_{i=1}^4) = 0 - 0.1 \cdot 1 =
    -0.1. \]
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: \[ w' = w - \eta \nabla_w L_4(w; \{(x_i, y_i)\}_{i=1}^4) = 0 - 0.1 \cdot 1 =
    -0.1. \]
- en: '**E6.2.7** We must have \(\sum_{x=-1}^1 \mathbb{P}(X=x) = 1\). This implies'
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.2.7** 我们必须满足 \(\sum_{x=-1}^1 \mathbb{P}(X=x) = 1\)。这表明'
- en: \[ \frac{1}{Z(\theta)} (h(-1)e^{-\theta} + h(0) + h(1)e^{\theta}) = 1. \]
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \frac{1}{Z(\theta)} (h(-1)e^{-\theta} + h(0) + h(1)e^{\theta}) = 1. \]
- en: Hence,
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，
- en: \[ Z(\theta) = h(-1)e^{-\theta} + h(0) + h(1)e^{\theta}. \]
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: \[ Z(\theta) = h(-1)e^{-\theta} + h(0) + h(1)e^{\theta}. \]
- en: '**E6.2.9** The empirical frequency for each category is given by:'
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.2.9** 每个类别的经验频率如下：'
- en: \[ \hat{\pi}_i = \frac{N_i}{n}, \]
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \hat{\pi}_i = \frac{N_i}{n}, \]
- en: 'where \(N_i\) is the number of times category \(i\) appears in the sample.
    The counts are:'
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(N_i\) 是类别 \(i\) 在样本中出现的次数。计数如下：
- en: \[ N_1 = 1, \quad N_2 = 2, \quad N_3 = 1. \]
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: \[ N_1 = 1, \quad N_2 = 2, \quad N_3 = 1. \]
- en: 'Thus, the empirical frequencies are:'
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，经验频率为：
- en: \[ \hat{\pi}_1 = \frac{1}{4} = 0.25, \quad \hat{\pi}_2 = \frac{2}{4} = 0.5,
    \quad \hat{\pi}_3 = \frac{1}{4} = 0.25. \]
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \hat{\pi}_1 = \frac{1}{4} = 0.25, \quad \hat{\pi}_2 = \frac{2}{4} = 0.5,
    \quad \hat{\pi}_3 = \frac{1}{4} = 0.25. \]
- en: '**E6.2.11** The log-likelihood for a multivariate Gaussian distribution is
    given by:'
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.2.11** 多元高斯分布的对数似然由以下给出：'
- en: \[ \log \mathcal{L}(\boldsymbol{\mu}, \boldsymbol{\Sigma}; \mathbf{X}) = -\frac{1}{2}
    \left[ (\mathbf{X} - \boldsymbol{\mu})^T \boldsymbol{\Sigma}^{-1} (\mathbf{X}
    - \boldsymbol{\mu}) + \log |\boldsymbol{\Sigma}| + 2 \log(2\pi) \right]. \]
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \log \mathcal{L}(\boldsymbol{\mu}, \boldsymbol{\Sigma}; \mathbf{X}) = -\frac{1}{2}
    \left[ (\mathbf{X} - \boldsymbol{\mu})^T \boldsymbol{\Sigma}^{-1} (\mathbf{X}
    - \boldsymbol{\mu}) + \log |\boldsymbol{\Sigma}| + 2 \log(2\pi) \right]. \]
- en: 'First, compute the inverse and determinant of \(\boldsymbol{\Sigma}\):'
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，计算 \(\boldsymbol{\Sigma}\) 的逆和行列式：
- en: \[\begin{split} \boldsymbol{\Sigma}^{-1} = \frac{1}{3} \begin{pmatrix} 2 & -1
    \\ -1 & 2 \end{pmatrix}, \quad |\boldsymbol{\Sigma}| = 3. \end{split}\]
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \boldsymbol{\Sigma}^{-1} = \frac{1}{3} \begin{pmatrix} 2 & -1
    \\ -1 & 2 \end{pmatrix}, \quad |\boldsymbol{\Sigma}| = 3. \end{split}\]
- en: Then,
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，
- en: \[\begin{split} \mathbf{X} - \boldsymbol{\mu} = \begin{pmatrix} 1 \\ 3 \end{pmatrix}
    - \begin{pmatrix} 1 \\ 2 \end{pmatrix} = \begin{pmatrix} 0 \\ 1 \end{pmatrix}.
    \end{split}\]
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{X} - \boldsymbol{\mu} = \begin{pmatrix} 1 \\ 3 \end{pmatrix}
    - \begin{pmatrix} 1 \\ 2 \end{pmatrix} = \begin{pmatrix} 0 \\ 1 \end{pmatrix}.
    \end{split}\]
- en: Thus,
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，
- en: \[\begin{split} (\mathbf{X} - \boldsymbol{\mu})^T \boldsymbol{\Sigma}^{-1} (\mathbf{X}
    - \boldsymbol{\mu}) = \begin{pmatrix} 0 & 1 \end{pmatrix} \frac{1}{3} \begin{pmatrix}
    2 & -1 \\ -1 & 2 \end{pmatrix} \begin{pmatrix} 0 \\ 1 \end{pmatrix} = \frac{1}{3}
    \cdot 2 = \frac{2}{3}. \end{split}\]
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} (\mathbf{X} - \boldsymbol{\mu})^T \boldsymbol{\Sigma}^{-1} (\mathbf{X}
    - \boldsymbol{\mu}) = \begin{pmatrix} 0 & 1 \end{pmatrix} \frac{1}{3} \begin{pmatrix}
    2 & -1 \\ -1 & 2 \end{pmatrix} \begin{pmatrix} 0 \\ 1 \end{pmatrix} = \frac{1}{3}
    \cdot 2 = \frac{2}{3}. \end{split}\]
- en: 'So the log-likelihood is: $\( \log \mathcal{L} = -\frac{1}{2} \left[ \frac{2}{3}
    + \log 3 + 2 \log (2\pi) \right] \approx -3.178. \)$'
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，对数似然为：$\( \log \mathcal{L} = -\frac{1}{2} \left[ \frac{2}{3} + \log 3 + 2
    \log (2\pi) \right] \approx -3.178. \)$
- en: '**E6.3.1** \(\mathbb{P}(A|B) = \frac{\mathbb{P}(A \cap B)}{\mathbb{P}(B)} =
    \frac{0.2}{0.5} = 0.4.\) This follows from the definition of conditional probability.'
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.1** \(\mathbb{P}(A|B) = \frac{\mathbb{P}(A \cap B)}{\mathbb{P}(B)} =
    \frac{0.2}{0.5} = 0.4.\) 这遵循条件概率的定义。'
- en: '**E6.3.3** \(\mathbb{E}[X|Y=y] = 1 \cdot 0.3 + 2 \cdot 0.7 = 0.3 + 1.4 = 1.7.\)
    This is the definition of the conditional expectation for discrete random variables.'
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.3** \(\mathbb{E}[X|Y=y] = 1 \cdot 0.3 + 2 \cdot 0.7 = 0.3 + 1.4 = 1.7.\)
    这是离散随机变量的条件期望的定义。'
- en: '**E6.3.5**'
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.5**'
- en: \[\begin{align*} \mathbb{P}[A \mid B \cap C] &= \frac{\mathbb{P}[A \cap (B \cap
    C)]}{\mathbb{P}[B \cap C]} \\ &= \frac{\mathbb{P}[A \cap B \cap C]}{\mathbb{P}[B
    \cap C]} \\ &= \frac{0.05}{0.1} \\ &= 0.5. \end{align*}\]
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \mathbb{P}[A \mid B \cap C] &= \frac{\mathbb{P}[A \cap (B \cap
    C)]}{\mathbb{P}[B \cap C]} \\ &= \frac{\mathbb{P}[A \cap B \cap C]}{\mathbb{P}[B
    \cap C]} \\ &= \frac{0.05}{0.1} \\ &= 0.5. \end{align*}\]
- en: '**E6.3.7** If \(A\), \(B\), and \(C\) are pairwise independent, then they are
    also mutually independent. Therefore,'
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.7** 如果 \(A\)，\(B\) 和 \(C\) 是两两独立的，那么它们也是相互独立的。因此，'
- en: \[\begin{align*} \mathbb{P}[A \cap B \cap C] &= \mathbb{P}[A] \mathbb{P}[B]
    \mathbb{P}[C] \\ &= 0.8 \cdot 0.6 \cdot 0.5 \\ &= 0.24. \end{align*}\]
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \mathbb{P}[A \cap B \cap C] &= \mathbb{P}[A] \mathbb{P}[B]
    \mathbb{P}[C] \\ &= 0.8 \cdot 0.6 \cdot 0.5 \\ &= 0.24. \end{align*}\]
- en: '**E6.3.9**'
  id: totrans-371
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.9**'
- en: \[\begin{align*} (\mathbb{P}[X=x, Z=z])_{x,z} &= \sum_{y} (\mathbb{P}[X=x, Y
    = y, Z=z])_{x,z} \\ &= \sum_{y} [(\mathbb{P}[X=x])_x \odot (\mathbb{P}[Y = y \mid
    X=x])_x] (\mathbb{P}[Z=z \mid Y = y])_z \\ &= [(\mathbb{P}[X=x])_x \odot (\mathbb{P}[Y
    = 0 \mid X=x])_x] (\mathbb{P}[Z=z \mid Y = 0])_z\\ & \quad + [(\mathbb{P}[X=x])_x
    \odot (\mathbb{P}[Y = 1 \mid X=x])_x] (\mathbb{P}[Z=z \mid Y = 1])_z \\ &= \begin{pmatrix}
    0.3 \cdot 0.2 \cdot 0.5 & 0.3 \cdot 0.2 \cdot 0.5 \\ 0.7 \cdot 0.6 \cdot 0.5 &
    0.7 \cdot 0.6 \cdot 0.5 \end{pmatrix} + \begin{pmatrix} 0.3 \cdot 0.8 \cdot 0.1
    & 0.3 \cdot 0.8 \cdot 0.9 \\ 0.7 \cdot 0.4 \cdot 0.1 & 0.7 \cdot 0.4 \cdot 0.9
    \end{pmatrix} \\ &= \begin{pmatrix} 0.03 & 0.03 \\ 0.21 & 0.21 \end{pmatrix} +
    \begin{pmatrix} 0.024 & 0.216 \\ 0.028 & 0.252 \end{pmatrix} \\ &= \begin{pmatrix}
    0.054 & 0.246 \\ 0.238 & 0.462 \end{pmatrix}. \end{align*}\]
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} (\mathbb{P}[X=x, Z=z])_{x,z} &= \sum_{y} (\mathbb{P}[X=x, Y
    = y, Z=z])_{x,z} \\ &= \sum_{y} [(\mathbb{P}[X=x])_x \odot (\mathbb{P}[Y = y \mid
    X=x])_x] (\mathbb{P}[Z=z \mid Y = y])_z \\ &= [(\mathbb{P}[X=x])_x \odot (\mathbb{P}[Y
    = 0 \mid X=x])_x] (\mathbb{P}[Z=z \mid Y = 0])_z\\ & \quad + [(\mathbb{P}[X=x])_x
    \odot (\mathbb{P}[Y = 1 \mid X=x])_x] (\mathbb{P}[Z=z \mid Y = 1])_z \\ &= \begin{pmatrix}
    0.3 \cdot 0.2 \cdot 0.5 & 0.3 \cdot 0.2 \cdot 0.5 \\ 0.7 \cdot 0.6 \cdot 0.5 &
    0.7 \cdot 0.6 \cdot 0.5 \end{pmatrix} + \begin{pmatrix} 0.3 \cdot 0.8 \cdot 0.1
    & 0.3 \cdot 0.8 \cdot 0.9 \\ 0.7 \cdot 0.4 \cdot 0.1 & 0.7 \cdot 0.4 \cdot 0.9
    \end{pmatrix} \\ &= \begin{pmatrix} 0.03 & 0.03 \\ 0.21 & 0.21 \end{pmatrix} +
    \begin{pmatrix} 0.024 & 0.216 \\ 0.028 & 0.252 \end{pmatrix} \\ &= \begin{pmatrix}
    0.054 & 0.246 \\ 0.238 & 0.462 \end{pmatrix}. \end{align*}\]
- en: '**E6.3.11**'
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.11**'
- en: \[\begin{align*} \hat{\pi}_1 &= \frac{N_1}{N_1 + N_2} = \frac{50}{50 + 100}
    = \frac{1}{3}, \\ \hat{p}_{1,1} &= \frac{N_{1,1}}{N_1} = \frac{10}{50} = 0.2,
    \\ \hat{p}_{2,1} &= \frac{N_{2,1}}{N_2} = \frac{40}{100} = 0.4. \end{align*}\]
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \hat{\pi}_1 &= \frac{N_1}{N_1 + N_2} = \frac{50}{50 + 100}
    = \frac{1}{3}, \\ \hat{p}_{1,1} &= \frac{N_{1,1}}{N_1} = \frac{10}{50} = 0.2,
    \\ \hat{p}_{2,1} &= \frac{N_{2,1}}{N_2} = \frac{40}{100} = 0.4. \end{align*}\]
- en: '**E6.3.13**'
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.13**'
- en: \[ \mathbb{P}[X=x, Y=y, Z=z] = \mathbb{P}[X=x]\mathbb{P}[Y=y|X=x]\mathbb{P}[Z=z|X=x].
    \]
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbb{P}[X=x, Y=y, Z=z] = \mathbb{P}[X=x]\mathbb{P}[Y=y|X=x]\mathbb{P}[Z=z|X=x].
    \]
- en: '**E6.4.1**'
  id: totrans-377
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.1**'
- en: \[\begin{align*} \mathbb{P}(X = 1) &= \sum_{i=1}^2 \pi_i p_i \\ &= (0.6)(0.3)
    + (0.4)(0.8) \\ &= 0.5 \end{align*}\]
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \mathbb{P}(X = 1) &= \sum_{i=1}^2 \pi_i p_i \\ &= (0.6)(0.3)
    + (0.4)(0.8) \\ &= 0.5 \end{align*}\]
- en: '**E6.4.3** \(\mathbb{P}[X = (1, 0)] = \pi_1 p_{1,1} (1 - p_{1,2}) + \pi_2 p_{2,1}
    (1 - p_{2,2}) = 0.4 \cdot 0.7 \cdot 0.7 + 0.6 \cdot 0.2 \cdot 0.2 = 0.196 + 0.024
    = 0.22\).'
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.3** \(\mathbb{P}[X = (1, 0)] = \pi_1 p_{1,1} (1 - p_{1,2}) + \pi_2 p_{2,1}
    (1 - p_{2,2}) = 0.4 \cdot 0.7 \cdot 0.7 + 0.6 \cdot 0.2 \cdot 0.2 = 0.196 + 0.024
    = 0.22\).'
- en: '**E6.4.5** \(r_{1,i} = \frac{\pi_1 p_{1,1} p_{1,2}}{\pi_1 p_{1,1} p_{1,2} +
    \pi_2 p_{2,1} p_{2,2}} = \frac{0.5 \cdot 0.8 \cdot 0.2}{0.5 \cdot 0.8 \cdot 0.2
    + 0.5 \cdot 0.1 \cdot 0.9} = \frac{0.08}{0.08 + 0.045} \approx 0.64\), \(r_{2,i}
    = 1 - r_{1,i} \approx 0.36\).'
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.5** \(r_{1,i} = \frac{\pi_1 p_{1,1} p_{1,2}}{\pi_1 p_{1,1} p_{1,2} +
    \pi_2 p_{2,1} p_{2,2}} = \frac{0.5 \cdot 0.8 \cdot 0.2}{0.5 \cdot 0.8 \cdot 0.2
    + 0.5 \cdot 0.1 \cdot 0.9} = \frac{0.08}{0.08 + 0.045} \approx 0.64\), \(r_{2,i}
    = 1 - r_{1,i} \approx 0.36\).'
- en: '**E6.4.7** \(\pi_1 = \frac{\eta_1}{n} = \frac{r_{1,1} + r_{1,1}}{2} = \frac{0.8
    + 0.8}{2} = 0.8\), \(\pi_2 = 1 - \pi_1 = 0.2\).'
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.7** \(\pi_1 = \frac{\eta_1}{n} = \frac{r_{1,1} + r_{1,1}}{2} = \frac{0.8
    + 0.8}{2} = 0.8\), \(\pi_2 = 1 - \pi_1 = 0.2\).'
- en: '**E6.4.9**'
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.9**'
- en: \[\begin{align*} r_{1,2} &= \frac{\pi_1 \prod_{m=1}^3 p_{1,m}^{x_{2,m}} (1 -
    p_{1,m})^{1-x_{2,m}}}{\sum_{k=1}^2 \pi_k \prod_{m=1}^3 p_{k,m}^{x_{2,m}} (1 -
    p_{k,m})^{1-x_{2,m}}} \\ &= \frac{(0.4)(0.2)^0(0.8)^1(0.9)^0(0.1)^1}{(0.4)(0.2)^0(0.8)^1(0.9)^0(0.1)^1
    + (0.6)(0.8)^0(0.2)^1(0.5)^0(0.5)^1} \\ &= \frac{0.032}{0.032 + 0.06} \\ &= \frac{8}{23}
    \end{align*}\]
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} r_{1,2} &= \frac{\pi_1 \prod_{m=1}^3 p_{1,m}^{x_{2,m}} (1 -
    p_{1,m})^{1-x_{2,m}}}{\sum_{k=1}^2 \pi_k \prod_{m=1}^3 p_{k,m}^{x_{2,m}} (1 -
    p_{k,m})^{1-x_{2,m}}} \\ &= \frac{(0.4)(0.2)^0(0.8)^1(0.9)^0(0.1)^1}{(0.4)(0.2)^0(0.8)^1(0.9)^0(0.1)^1
    + (0.6)(0.8)^0(0.2)^1(0.5)^0(0.5)^1} \\ &= \frac{0.032}{0.032 + 0.06} \\ &= \frac{8}{23}
    \end{align*}\]
- en: '**E6.4.11**'
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.11**'
- en: \[ \mathbb{E}[X] = \pi_1 \mu_1 + \pi_2 \mu_2 = 0.5 \times (-1) + 0.5 \times
    3 = -0.5 + 1.5 = 1. \]
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbb{E}[X] = \pi_1 \mu_1 + \pi_2 \mu_2 = 0.5 \times (-1) + 0.5 \times
    3 = -0.5 + 1.5 = 1. \]
- en: '**E6.4.13**'
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.13**'
- en: \[ \mathrm{Var}(X) = \pi_1 (\sigma_1^2 + \mu_1^2) + \pi_2 (\sigma_2^2 + \mu_2^2)
    - \left(\pi_1 \mu_1 + \pi_2 \mu_2\right)^2, \]\[ \mathrm{Var}(X) = 0.4 (1 + 0^2)
    + 0.6 (2 + 4^2) - (0.4 \times 0 + 0.6 \times 4)^2 = 0.4 \times 1 + 0.6 \times
    18 - 2.4^2, \]\[ \mathrm{Var}(X) = 0.4 + 10.8 - 5.76 = 5.44. \]
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathrm{Var}(X) = \pi_1 (\sigma_1^2 + \mu_1^2) + \pi_2 (\sigma_2^2 + \mu_2^2)
    - \left(\pi_1 \mu_1 + \pi_2 \mu_2\right)^2, \]\[ \mathrm{Var}(X) = 0.4 (1 + 0^2)
    + 0.6 (2 + 4^2) - (0.4 \times 0 + 0.6 \times 4)^2 = 0.4 \times 1 + 0.6 \times
    18 - 2.4^2, \]\[ \mathrm{Var}(X) = 0.4 + 10.8 - 5.76 = 5.44. \]
- en: '**E6.5.1**'
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.1**'
- en: \[ B / B_{11} = B_{22} - B_{12}^T B_{11}^{-1} B_{12} = 3 - 1 \cdot \frac{1}{2}
    \cdot 1 = \frac{5}{2}, \]
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: \[ B / B_{11} = B_{22} - B_{12}^T B_{11}^{-1} B_{12} = 3 - 1 \cdot \frac{1}{2}
    \cdot 1 = \frac{5}{2}, \]
- en: using the definition of the Schur complement.
  id: totrans-390
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Schur补的定义。
- en: '**E6.5.3** The Schur complement of \(A_{11}\) in \(A\) is given by'
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.3** \(A\) 中 \(A_{11}\) 的Schur补为'
- en: \[\begin{split} A/A_{11} = A_{22} - A_{21}A_{11}^{-1}A_{12} = 7 - \begin{pmatrix}
    0 & 6 \end{pmatrix} \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix}^{-1} \begin{pmatrix}
    0 \\ 5 \end{pmatrix}. \end{split}\]
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A/A_{11} = A_{22} - A_{21}A_{11}^{-1}A_{12} = 7 - \begin{pmatrix}
    0 & 6 \end{pmatrix} \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix}^{-1} \begin{pmatrix}
    0 \\ 5 \end{pmatrix}. \end{split}\]
- en: 'First, compute \(A_{11}^{-1}\):'
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
  zh: '首先，计算 \(A_{11}^{-1}\):'
- en: \[\begin{split} A_{11}^{-1} = \frac{1}{1 \cdot 4 - 2 \cdot 3} \begin{pmatrix}
    4 & -2 \\ -3 & 1 \end{pmatrix} = \begin{pmatrix} -2 & 1 \\ 1.5 & -0.5 \end{pmatrix}.
    \end{split}\]
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A_{11}^{-1} = \frac{1}{1 \cdot 4 - 2 \cdot 3} \begin{pmatrix}
    4 & -2 \\ -3 & 1 \end{pmatrix} = \begin{pmatrix} -2 & 1 \\ 1.5 & -0.5 \end{pmatrix}.
    \end{split}\]
- en: Then,
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，
- en: \[\begin{split} A/A_{11} = 7 - \begin{pmatrix} 0 & 6 \end{pmatrix} \begin{pmatrix}
    -2 & 1 \\ 1.5 & -0.5 \end{pmatrix} \begin{pmatrix} 0 \\ 5 \end{pmatrix} = 7 +
    (6 \cdot 0.5 \cdot 5) = 22. \end{split}\]
  id: totrans-396
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A/A_{11} = 7 - \begin{pmatrix} 0 & 6 \end{pmatrix} \begin{pmatrix}
    -2 & 1 \\ 1.5 & -0.5 \end{pmatrix} \begin{pmatrix} 0 \\ 5 \end{pmatrix} = 7 +
    (6 \cdot 0.5 \cdot 5) = 22. \end{split}\]
- en: '**E6.5.5** The conditional mean of \(X_1\) given \(X_2 = 3\) is'
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.5** 在 \(X_2 = 3\) 的条件下，\(X_1\) 的条件均值为'
- en: \[ \mu_{1|2}(3) = \mu_1 + \bSigma_{12} \bSigma_{22}^{-1} (3 - \bmu_2) = 1 +
    1 \cdot \frac{1}{3} (3 - 2) = \frac{4}{3}, \]
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mu_{1|2}(3) = \mu_1 + \bSigma_{12} \bSigma_{22}^{-1} (3 - \bmu_2) = 1 +
    1 \cdot \frac{1}{3} (3 - 2) = \frac{4}{3}, \]
- en: using the formula for the conditional mean of multivariate Gaussians.
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: 使用多元高斯条件均值的公式。
- en: '**E6.5.7** The conditional distribution of \(X_1\) given \(X_2 = 1\) is Gaussian
    with mean \(\mu_{1|2} = \mu_1 + \bSigma_{12} \bSigma_{22}^{-1} (1 - \mu_2) = \frac{1}{2}\)
    and variance \(\bSigma_{1|2} = \bSigma_{11} - \bSigma_{12} \bSigma_{22}^{-1} \bSigma_{21}
    = \frac{7}{2}\).'
  id: totrans-400
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.7** 在 \(X_2 = 1\) 的条件下，\(X_1\) 的条件分布是高斯分布，均值为 \(\mu_{1|2} = \mu_1 +
    \bSigma_{12} \bSigma_{22}^{-1} (1 - \mu_2) = \frac{1}{2}\)，方差为 \(\bSigma_{1|2}
    = \bSigma_{11} - \bSigma_{12} \bSigma_{22}^{-1} \bSigma_{21} = \frac{7}{2}\)。'
- en: '**E6.5.9** The distribution of \(\bY\) is Gaussian with mean vector \(A\bmu
    = \begin{pmatrix} -3 \\ -3 \end{pmatrix}\) and covariance matrix \(A\bSigma A^T
    = \begin{pmatrix} 8 & 1 \\ 1 & 6 \end{pmatrix}\).'
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.9** \(\bY\) 的分布是高斯分布，其均值向量为 \(A\bmu = \begin{pmatrix} -3 \\ -3 \end{pmatrix}\)，协方差矩阵为
    \(A\bSigma A^T = \begin{pmatrix} 8 & 1 \\ 1 & 6 \end{pmatrix}\)。'
- en: '**E6.5.11** The mean of \(Y_t\) is'
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.11** \(Y_t\) 的均值为'
- en: \[\begin{split} \mathbb{E}[Y_t] = \begin{pmatrix} 1 & 0 \end{pmatrix} \mathbb{E}[\bX_t]
    = \begin{pmatrix} 1 & 0 \end{pmatrix} \begin{pmatrix} 1 \\ 2 \end{pmatrix} = 1,
    \end{split}\]
  id: totrans-403
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbb{E}[Y_t] = \begin{pmatrix} 1 & 0 \end{pmatrix} \mathbb{E}[\bX_t]
    = \begin{pmatrix} 1 & 0 \end{pmatrix} \begin{pmatrix} 1 \\ 2 \end{pmatrix} = 1,
    \end{split}\]
- en: and the variance of \(Y_t\) is
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: \(Y_t\) 的方差为
- en: \[\begin{split} \mathrm{Var}[Y_t] = \begin{pmatrix} 1 & 0 \end{pmatrix} \mathrm{Cov}[\bX_t]
    \begin{pmatrix} 1 \\ 0 \end{pmatrix} + 1 = \begin{pmatrix} 1 & 0 \end{pmatrix}
    \begin{pmatrix} 1 \\ 0 \end{pmatrix} + 1 = 2, \end{split}\]
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathrm{Var}[Y_t] = \begin{pmatrix} 1 & 0 \end{pmatrix} \mathrm{Cov}[\bX_t]
    \begin{pmatrix} 1 \\ 0 \end{pmatrix} + 1 = \begin{pmatrix} 1 & 0 \end{pmatrix}
    \begin{pmatrix} 1 \\ 0 \end{pmatrix} + 1 = 2, \end{split}\]
- en: using the properties of linear-Gaussian systems.
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
  zh: 利用线性高斯系统的性质。
- en: '**E6.5.13** The innovation is'
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.13** 创新为'
- en: \[\begin{split} e_t = Y_t - H \bmu_{\text{pred}} = 3 - \begin{pmatrix} 1 & 0
    \end{pmatrix} \begin{pmatrix} 3 \\ 1 \end{pmatrix} = 3 - 3 = 0. \end{split}\]
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} e_t = Y_t - H \bmu_{\text{pred}} = 3 - \begin{pmatrix} 1 & 0
    \end{pmatrix} \begin{pmatrix} 3 \\ 1 \end{pmatrix} = 3 - 3 = 0. \end{split}\]
- en: '**E6.5.15** The updated state estimate is'
  id: totrans-409
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.15** 更新后的状态估计为'
- en: \[\begin{split} \bmu_t = \bmu_{\text{pred}} + K_t e_t = \begin{pmatrix} 3 \\
    1 \end{pmatrix} + \begin{pmatrix} \frac{2}{3} \\ \frac{1}{3} \end{pmatrix} \cdot
    0 = \begin{pmatrix} 3 \\ 1 \end{pmatrix}. \end{split}\]
  id: totrans-410
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bmu_t = \bmu_{\text{pred}} + K_t e_t = \begin{pmatrix} 3 \\
    1 \end{pmatrix} + \begin{pmatrix} \frac{2}{3} \\ \frac{1}{3} \end{pmatrix} \cdot
    0 = \begin{pmatrix} 3 \\ 1 \end{pmatrix}. \end{split}\]
- en: 6.7.1.5\. Learning outcomes[#](#learning-outcomes "Link to this heading")
  id: totrans-411
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.1.5\. 学习成果[#](#learning-outcomes "链接到这个标题")
- en: Define exponential families and give examples of common probability distributions
    that belong to this family.
  id: totrans-412
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定义指数族，并给出属于此族的一些常见概率分布的例子。
- en: Derive the maximum likelihood estimator for exponential families and explain
    its properties.
  id: totrans-413
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 推导指数族的最大似然估计量并解释其性质。
- en: Prove that, under certain conditions, the maximum likelihood estimator is statistically
    consistent.
  id: totrans-414
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在一定条件下，证明最大似然估计量在统计上是一致的。
- en: Formulate generalized linear models using exponential families and express linear
    and logistic regression as special cases.
  id: totrans-415
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用指数族来制定广义线性模型，并将线性回归和逻辑回归作为特殊情况表达。
- en: Compute the gradient and Hessian of the negative log-likelihood for generalized
    linear models.
  id: totrans-416
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 计算广义线性模型中负对数似然函数的梯度和对Hessian矩阵。
- en: Interpret the moment-matching equations for the maximum likelihood estimator
    in generalized linear models.
  id: totrans-417
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 解释广义线性模型中最大似然估计量的矩匹配方程。
- en: Apply the multiplication rule, the law of total probability, and Bayes’ rule
    to solve problems involving conditional probabilities.
  id: totrans-418
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用乘法规则、全概率公式和贝叶斯公式来解决涉及条件概率的问题。
- en: Calculate conditional probability mass functions and conditional expectations
    for discrete random variables.
  id: totrans-419
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 计算离散随机变量的条件概率质量函数和条件期望。
- en: Define conditional independence and express it mathematically in terms of conditional
    probabilities.
  id: totrans-420
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定义条件独立性，并以条件概率的形式对其进行数学表达。
- en: Differentiate between the fork, chain, and collider configurations in graphical
    models representing conditional independence relations.
  id: totrans-421
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在图形模型中区分叉积、链式和碰撞配置，这些模型表示条件独立性关系。
- en: Derive the joint probability distribution for the Naive Bayes model under the
    assumption of conditional independence.
  id: totrans-422
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在条件独立性的假设下，推导朴素贝叶斯模型的联合概率分布。
- en: Implement maximum likelihood estimation to fit the parameters of the Naive Bayes
    model.
  id: totrans-423
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实施最大似然估计以拟合朴素贝叶斯模型的参数。
- en: Apply the Naive Bayes model for prediction and evaluate its accuracy.
  id: totrans-424
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用朴素贝叶斯模型进行预测并评估其准确性。
- en: Implement Laplace smoothing to address the issue of unseen words in the training
    data when fitting a Naive Bayes model.
  id: totrans-425
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在拟合朴素贝叶斯模型时，通过拉普拉斯平滑来解决训练数据中未见词的问题。
- en: Apply the Naive Bayes model to perform sentiment analysis on a real-world dataset
    and interpret the results.
  id: totrans-426
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将朴素贝叶斯模型应用于对实际数据集进行情感分析，并解释结果。
- en: Define mixtures as convex combinations of distributions and express the probability
    distribution of a mixture model using the law of total probability.
  id: totrans-427
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定义混合为分布的凸组合，并使用全概率定律表达混合模型的概率分布。
- en: Identify examples of mixture models, such as mixtures of multinomials and Gaussian
    mixture models, and recognize their probability density functions.
  id: totrans-428
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 识别混合模型的例子，例如多项式混合和高斯混合模型，并识别它们的概率密度函数。
- en: Explain the concept of marginalizing out an unobserved random variable in the
    context of mixture models.
  id: totrans-429
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 解释在混合模型中边际化未观察到的随机变量的概念。
- en: Formulate the objective function for parameter estimation in mixtures of multivariate
    Bernoullis using the negative log-likelihood.
  id: totrans-430
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用负对数似然函数为多元伯努利混合的参数估计制定目标函数。
- en: Describe the majorization-minimization principle and its application in the
    Expectation-Maximization (EM) algorithm.
  id: totrans-431
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 描述极大化-极小化原理及其在期望最大化（EM）算法中的应用。
- en: Derive the E-step and M-step updates for the EM algorithm in the context of
    mixtures of multivariate Bernoullis.
  id: totrans-432
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在多元伯努利混合的背景下，推导EM算法的E步和M步更新。
- en: Implement the EM algorithm for mixtures of multivariate Bernoullis and apply
    it to a real-world dataset, such as clustering handwritten digits from the MNIST
    dataset.
  id: totrans-433
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实现多元伯努利混合的EM算法，并将其应用于实际数据集，例如从MNIST数据集中聚类手写数字。
- en: Identify and address numerical issues that may arise during the implementation
    of the EM algorithm, such as underflow, by applying techniques like the log-sum-exp
    trick.
  id: totrans-434
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过应用如对数和指数技巧等技术，识别并解决在EM算法实现过程中可能出现的数值问题，例如下溢。
- en: Define block matrices and the Schur complement, and demonstrate their properties
    through examples and proofs.
  id: totrans-435
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定义块矩阵和Schur补，并通过示例和证明展示它们的性质。
- en: Derive the marginal and conditional distributions of multivariate Gaussians
    using the properties of block matrices and the Schur complement.
  id: totrans-436
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 利用块矩阵和Schur补的性质推导多元高斯分布的边缘和条件分布。
- en: Describe the linear-Gaussian system model and its components, including the
    state evolution and observation processes.
  id: totrans-437
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 描述线性高斯系统模型及其组成部分，包括状态演化和观测过程。
- en: Explain the purpose and key steps of the Kalman filter algorithm, including
    the prediction and update steps.
  id: totrans-438
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 解释卡尔曼滤波算法的目的和关键步骤，包括预测和更新步骤。
- en: Implement the Kalman filter algorithm in code, given the state evolution and
    observation models, and the initial state distribution.
  id: totrans-439
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在给定状态演化和观测模型以及初始状态分布的情况下，用代码实现卡尔曼滤波算法。
- en: Apply the Kalman filter to a location tracking problem, and interpret the results
    in terms of the estimated object path and the algorithm’s performance.
  id: totrans-440
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将卡尔曼滤波应用于位置跟踪问题，并从估计的对象路径和算法性能的角度解释结果。
- en: \(\aleph\)
  id: totrans-441
  prefs: []
  type: TYPE_NORMAL
  zh: \(\aleph\)
- en: 6.7.1.1\. Just the code[#](#just-the-code "Link to this heading")
  id: totrans-442
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.1.1\. 仅代码[#](#just-the-code "链接到这个标题")
- en: An interactive Jupyter notebook featuring the code in this chapter can be accessed
    below (Google Colab recommended). You are encouraged to tinker with it. Some suggested
    computational exercises are scattered throughout. The notebook is also available
    as a slideshow.
  id: totrans-443
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是可以访问的包含本章代码的交互式Jupyter笔记本（推荐使用Google Colab）。鼓励您对其进行实验。一些建议的计算练习散布在其中。笔记本也可以作为幻灯片使用。
- en: '[Notebook](https://github.com/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/just_the_code/roch_mmids_chap_prob_notebook.ipynb)
    ([Open In Colab](https://colab.research.google.com/github/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/just_the_code/roch_mmids_chap_prob_notebook.ipynb))'
  id: totrans-444
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[笔记本](https://github.com/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/just_the_code/roch_mmids_chap_prob_notebook.ipynb)
    ([在Colab中打开](https://colab.research.google.com/github/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/just_the_code/roch_mmids_chap_prob_notebook.ipynb))'
- en: '[Slideshow](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/just_the_code/roch_mmids_chap_prob_notebook_slides.slides.html)'
  id: totrans-445
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[幻灯片](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/just_the_code/roch_mmids_chap_prob_notebook_slides.slides.html)'
- en: 6.7.1.2\. Self-assessment quizzes[#](#self-assessment-quizzes "Link to this
    heading")
  id: totrans-446
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.1.2\. 自我评估测验[#](#self-assessment-quizzes "链接到这个标题")
- en: A more extensive web version of the self-assessment quizzes is available by
    following the links below.
  id: totrans-447
  prefs: []
  type: TYPE_NORMAL
  zh: 通过以下链接可以获得更广泛的自我评估测验的网页版本。
- en: '[Section 6.2](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_2.html)'
  id: totrans-448
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第6.2节](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_2.html)'
- en: '[Section 6.3](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_3.html)'
  id: totrans-449
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第6.3节](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_3.html)'
- en: '[Section 6.4](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_4.html)'
  id: totrans-450
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第6.4节](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_4.html)'
- en: '[Section 6.5](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_5.html)'
  id: totrans-451
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第6.5节](https://raw.githack.com/MMiDS-textbook/MMiDS-textbook.github.io/main/quizzes/self-assessment/quiz_6_5.html)'
- en: 6.7.1.3\. Auto-quizzes[#](#auto-quizzes "Link to this heading")
  id: totrans-452
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.1.3\. 自动测验[#](#auto-quizzes "链接到本标题")
- en: Automatically generated quizzes for this chapter can be accessed here (Google
    Colab recommended).
  id: totrans-453
  prefs: []
  type: TYPE_NORMAL
  zh: 本章自动生成的测验可以在此处访问（推荐使用Google Colab）。
- en: '[Auto-quizzes](https://github.com/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/quizzes/auto_quizzes/roch-mmids-prob-autoquiz.ipynb)
    ([Open In Colab](https://colab.research.google.com/github/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/quizzes/auto_quizzes/roch-mmids-prob-autoquiz.ipynb))'
  id: totrans-454
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[自动测验](https://github.com/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/quizzes/auto_quizzes/roch-mmids-prob-autoquiz.ipynb)
    ([在Colab中打开](https://colab.research.google.com/github/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/quizzes/auto_quizzes/roch-mmids-prob-autoquiz.ipynb))'
- en: 6.7.1.4\. Solutions to odd-numbered warm-up exercises[#](#solutions-to-odd-numbered-warm-up-exercises
    "Link to this heading")
  id: totrans-455
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.1.4\. 奇数编号的预热练习的解答[#](#solutions-to-odd-numbered-warm-up-exercises "链接到本标题")
- en: '*(with help from Claude, Gemini, and ChatGPT)*'
  id: totrans-456
  prefs: []
  type: TYPE_NORMAL
  zh: '*(在克劳德、双子星和ChatGPT的帮助下)*'
- en: '**E6.2.1** The probability of \(Y\) being in the second category is:'
  id: totrans-457
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.2.1** \(Y\) 落在第二类中的概率是：'
- en: \[ \mathbb{P}(Y = e_2) = \pi_2 = 0.5. \]
  id: totrans-458
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbb{P}(Y = e_2) = \pi_2 = 0.5. \]
- en: '**E6.2.3** Let \(X_1, \ldots, X_n\) be i.i.d. Bernoulli\((q^*)\). The MLE is
    \(\hat{q}_{\mathrm{MLE}} = \frac{1}{n} \sum_{i=1}^n X_i\). By the Law of Large
    Numbers, as \(n \to \infty\),'
  id: totrans-459
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.2.3** 设 \(X_1, \ldots, X_n\) 为独立同分布的伯努利分布 \((q^*)\)。最大似然估计为 \(\hat{q}_{\mathrm{MLE}}
    = \frac{1}{n} \sum_{i=1}^n X_i\)。根据大数定律，当 \(n \to \infty\) 时，'
- en: \[ \hat{q}_{\mathrm{MLE}} \to \mathbb{E}[X_1] = q^* \]
  id: totrans-460
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \hat{q}_{\mathrm{MLE}} \to \mathbb{E}[X_1] = q^* \]
- en: almost surely.
  id: totrans-461
  prefs: []
  type: TYPE_NORMAL
  zh: 几乎肯定。
- en: '**E6.2.5** The gradient at \(w = 0\) is:'
  id: totrans-462
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.2.5** 在 \(w = 0\) 处的梯度为：'
- en: \[ \nabla_w L_4(0; \{(x_i, y_i)\}_{i=1}^4) = -\sum_{i=1}^4 x_i(y_i - \sigma(0))
    = -\frac{1}{2}(1 - 2 + 3 - 4) = 1. \]
  id: totrans-463
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \nabla_w L_4(0; \{(x_i, y_i)\}_{i=1}^4) = -\sum_{i=1}^4 x_i(y_i - \sigma(0))
    = -\frac{1}{2}(1 - 2 + 3 - 4) = 1. \]
- en: 'The updated parameter after one step of gradient descent is:'
  id: totrans-464
  prefs: []
  type: TYPE_NORMAL
  zh: 梯度下降一步后的更新参数为：
- en: \[ w' = w - \eta \nabla_w L_4(w; \{(x_i, y_i)\}_{i=1}^4) = 0 - 0.1 \cdot 1 =
    -0.1. \]
  id: totrans-465
  prefs: []
  type: TYPE_NORMAL
  zh: \[ w' = w - \eta \nabla_w L_4(w; \{(x_i, y_i)\}_{i=1}^4) = 0 - 0.1 \cdot 1 =
    -0.1. \]
- en: '**E6.2.7** We must have \(\sum_{x=-1}^1 \mathbb{P}(X=x) = 1\). This implies'
  id: totrans-466
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.2.7** 我们必须满足 \(\sum_{x=-1}^1 \mathbb{P}(X=x) = 1\)。这意味着'
- en: \[ \frac{1}{Z(\theta)} (h(-1)e^{-\theta} + h(0) + h(1)e^{\theta}) = 1. \]
  id: totrans-467
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \frac{1}{Z(\theta)} (h(-1)e^{-\theta} + h(0) + h(1)e^{\theta}) = 1. \]
- en: Hence,
  id: totrans-468
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，
- en: \[ Z(\theta) = h(-1)e^{-\theta} + h(0) + h(1)e^{\theta}. \]
  id: totrans-469
  prefs: []
  type: TYPE_NORMAL
  zh: \[ Z(\theta) = h(-1)e^{-\theta} + h(0) + h(1)e^{\theta}. \]
- en: '**E6.2.9** The empirical frequency for each category is given by:'
  id: totrans-470
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.2.9** 每个类别的经验频率由以下给出：'
- en: \[ \hat{\pi}_i = \frac{N_i}{n}, \]
  id: totrans-471
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \hat{\pi}_i = \frac{N_i}{n}, \]
- en: 'where \(N_i\) is the number of times category \(i\) appears in the sample.
    The counts are:'
  id: totrans-472
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(N_i\) 是类别 \(i\) 在样本中出现的次数。计数如下：
- en: \[ N_1 = 1, \quad N_2 = 2, \quad N_3 = 1. \]
  id: totrans-473
  prefs: []
  type: TYPE_NORMAL
  zh: \[ N_1 = 1, \quad N_2 = 2, \quad N_3 = 1. \]
- en: 'Thus, the empirical frequencies are:'
  id: totrans-474
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，经验频率为：
- en: \[ \hat{\pi}_1 = \frac{1}{4} = 0.25, \quad \hat{\pi}_2 = \frac{2}{4} = 0.5,
    \quad \hat{\pi}_3 = \frac{1}{4} = 0.25. \]
  id: totrans-475
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \hat{\pi}_1 = \frac{1}{4} = 0.25, \quad \hat{\pi}_2 = \frac{2}{4} = 0.5,
    \quad \hat{\pi}_3 = \frac{1}{4} = 0.25. \]
- en: '**E6.2.11** The log-likelihood for a multivariate Gaussian distribution is
    given by:'
  id: totrans-476
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.2.11** 多元高斯分布的对数似然由以下给出：'
- en: \[ \log \mathcal{L}(\boldsymbol{\mu}, \boldsymbol{\Sigma}; \mathbf{X}) = -\frac{1}{2}
    \left[ (\mathbf{X} - \boldsymbol{\mu})^T \boldsymbol{\Sigma}^{-1} (\mathbf{X}
    - \boldsymbol{\mu}) + \log |\boldsymbol{\Sigma}| + 2 \log(2\pi) \right]. \]
  id: totrans-477
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \log \mathcal{L}(\boldsymbol{\mu}, \boldsymbol{\Sigma}; \mathbf{X}) = -\frac{1}{2}
    \left[ (\mathbf{X} - \boldsymbol{\mu})^T \boldsymbol{\Sigma}^{-1} (\mathbf{X}
    - \boldsymbol{\mu}) + \log |\boldsymbol{\Sigma}| + 2 \log(2\pi) \right]. \]
- en: 'First, compute the inverse and determinant of \(\boldsymbol{\Sigma}\):'
  id: totrans-478
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，计算 \(\boldsymbol{\Sigma}\) 的逆和行列式：
- en: \[\begin{split} \boldsymbol{\Sigma}^{-1} = \frac{1}{3} \begin{pmatrix} 2 & -1
    \\ -1 & 2 \end{pmatrix}, \quad |\boldsymbol{\Sigma}| = 3. \end{split}\]
  id: totrans-479
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \boldsymbol{\Sigma}^{-1} = \frac{1}{3} \begin{pmatrix} 2 & -1
    \\ -1 & 2 \end{pmatrix}, \quad |\boldsymbol{\Sigma}| = 3. \end{split}\]
- en: Then,
  id: totrans-480
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，
- en: \[\begin{split} \mathbf{X} - \boldsymbol{\mu} = \begin{pmatrix} 1 \\ 3 \end{pmatrix}
    - \begin{pmatrix} 1 \\ 2 \end{pmatrix} = \begin{pmatrix} 0 \\ 1 \end{pmatrix}.
    \end{split}\]
  id: totrans-481
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{X} - \boldsymbol{\mu} = \begin{pmatrix} 1 \\ 3 \end{pmatrix}
    - \begin{pmatrix} 1 \\ 2 \end{pmatrix} = \begin{pmatrix} 0 \\ 1 \end{pmatrix}.
    \end{split}\]
- en: Thus,
  id: totrans-482
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，
- en: \[\begin{split} (\mathbf{X} - \boldsymbol{\mu})^T \boldsymbol{\Sigma}^{-1} (\mathbf{X}
    - \boldsymbol{\mu}) = \begin{pmatrix} 0 & 1 \end{pmatrix} \frac{1}{3} \begin{pmatrix}
    2 & -1 \\ -1 & 2 \end{pmatrix} \begin{pmatrix} 0 \\ 1 \end{pmatrix} = \frac{1}{3}
    \cdot 2 = \frac{2}{3}. \end{split}\]
  id: totrans-483
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} (\mathbf{X} - \boldsymbol{\mu})^T \boldsymbol{\Sigma}^{-1} (\mathbf{X}
    - \boldsymbol{\mu}) = \begin{pmatrix} 0 & 1 \end{pmatrix} \frac{1}{3} \begin{pmatrix}
    2 & -1 \\ -1 & 2 \end{pmatrix} \begin{pmatrix} 0 \\ 1 \end{pmatrix} = \frac{1}{3}
    \cdot 2 = \frac{2}{3}. \end{split}\]
- en: 'So the log-likelihood is: $\( \log \mathcal{L} = -\frac{1}{2} \left[ \frac{2}{3}
    + \log 3 + 2 \log (2\pi) \right] \approx -3.178. \)$'
  id: totrans-484
  prefs: []
  type: TYPE_NORMAL
  zh: 所以对数似然为：$\( \log \mathcal{L} = -\frac{1}{2} \left[ \frac{2}{3} + \log 3 + 2
    \log (2\pi) \right] \approx -3.178. \)$
- en: '**E6.3.1** \(\mathbb{P}(A|B) = \frac{\mathbb{P}(A \cap B)}{\mathbb{P}(B)} =
    \frac{0.2}{0.5} = 0.4.\) This follows from the definition of conditional probability.'
  id: totrans-485
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.1** \(\mathbb{P}(A|B) = \frac{\mathbb{P}(A \cap B)}{\mathbb{P}(B)} =
    \frac{0.2}{0.5} = 0.4.\) 这遵循条件概率的定义。'
- en: '**E6.3.3** \(\mathbb{E}[X|Y=y] = 1 \cdot 0.3 + 2 \cdot 0.7 = 0.3 + 1.4 = 1.7.\)
    This is the definition of the conditional expectation for discrete random variables.'
  id: totrans-486
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.3** \(\mathbb{E}[X|Y=y] = 1 \cdot 0.3 + 2 \cdot 0.7 = 0.3 + 1.4 = 1.7.\)
    这是离散随机变量的条件期望的定义。'
- en: '**E6.3.5**'
  id: totrans-487
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.5**'
- en: \[\begin{align*} \mathbb{P}[A \mid B \cap C] &= \frac{\mathbb{P}[A \cap (B \cap
    C)]}{\mathbb{P}[B \cap C]} \\ &= \frac{\mathbb{P}[A \cap B \cap C]}{\mathbb{P}[B
    \cap C]} \\ &= \frac{0.05}{0.1} \\ &= 0.5. \end{align*}\]
  id: totrans-488
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \mathbb{P}[A \mid B \cap C] &= \frac{\mathbb{P}[A \cap (B \cap
    C)]}{\mathbb{P}[B \cap C]} \\ &= \frac{\mathbb{P}[A \cap B \cap C]}{\mathbb{P}[B
    \cap C]} \\ &= \frac{0.05}{0.1} \\ &= 0.5. \end{align*}\]
- en: '**E6.3.7** If \(A\), \(B\), and \(C\) are pairwise independent, then they are
    also mutually independent. Therefore,'
  id: totrans-489
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.7** 如果 \(A\)、\(B\) 和 \(C\) 是两两独立的，那么它们也是相互独立的。因此，'
- en: \[\begin{align*} \mathbb{P}[A \cap B \cap C] &= \mathbb{P}[A] \mathbb{P}[B]
    \mathbb{P}[C] \\ &= 0.8 \cdot 0.6 \cdot 0.5 \\ &= 0.24. \end{align*}\]
  id: totrans-490
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \mathbb{P}[A \cap B \cap C] &= \mathbb{P}[A] \mathbb{P}[B]
    \mathbb{P}[C] \\ &= 0.8 \cdot 0.6 \cdot 0.5 \\ &= 0.24. \end{align*}\]
- en: '**E6.3.9**'
  id: totrans-491
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.9**'
- en: \[\begin{align*} (\mathbb{P}[X=x, Z=z])_{x,z} &= \sum_{y} (\mathbb{P}[X=x, Y
    = y, Z=z])_{x,z} \\ &= \sum_{y} [(\mathbb{P}[X=x])_x \odot (\mathbb{P}[Y = y \mid
    X=x])_x] (\mathbb{P}[Z=z \mid Y = y])_z \\ &= [(\mathbb{P}[X=x])_x \odot (\mathbb{P}[Y
    = 0 \mid X=x])_x] (\mathbb{P}[Z=z \mid Y = 0])_z\\ & \quad + [(\mathbb{P}[X=x])_x
    \odot (\mathbb{P}[Y = 1 \mid X=x])_x] (\mathbb{P}[Z=z \mid Y = 1])_z \\ &= \begin{pmatrix}
    0.3 \cdot 0.2 \cdot 0.5 & 0.3 \cdot 0.2 \cdot 0.5 \\ 0.7 \cdot 0.6 \cdot 0.5 &
    0.7 \cdot 0.6 \cdot 0.5 \end{pmatrix} + \begin{pmatrix} 0.3 \cdot 0.8 \cdot 0.1
    & 0.3 \cdot 0.8 \cdot 0.9 \\ 0.7 \cdot 0.4 \cdot 0.1 & 0.7 \cdot 0.4 \cdot 0.9
    \end{pmatrix} \\ &= \begin{pmatrix} 0.03 & 0.03 \\ 0.21 & 0.21 \end{pmatrix} +
    \begin{pmatrix} 0.024 & 0.216 \\ 0.028 & 0.252 \end{pmatrix} \\ &= \begin{pmatrix}
    0.054 & 0.246 \\ 0.238 & 0.462 \end{pmatrix}. \end{align*}\]
  id: totrans-492
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} (\mathbb{P}[X=x, Z=z])_{x,z} &= \sum_{y} (\mathbb{P}[X=x, Y
    = y, Z=z])_{x,z} \\ &= \sum_{y} [(\mathbb{P}[X=x])_x \odot (\mathbb{P}[Y = y \mid
    X=x])_x] (\mathbb{P}[Z=z \mid Y = y])_z \\ &= [(\mathbb{P}[X=x])_x \odot (\mathbb{P}[Y
    = 0 \mid X=x])_x] (\mathbb{P}[Z=z \mid Y = 0])_z\\ & \quad + [(\mathbb{P}[X=x])_x
    \odot (\mathbb{P}[Y = 1 \mid X=x])_x] (\mathbb{P}[Z=z \mid Y = 1])_z \\ &= \begin{pmatrix}
    0.3 \cdot 0.2 \cdot 0.5 & 0.3 \cdot 0.2 \cdot 0.5 \\ 0.7 \cdot 0.6 \cdot 0.5 &
    0.7 \cdot 0.6 \cdot 0.5 \end{pmatrix} + \begin{pmatrix} 0.3 \cdot 0.8 \cdot 0.1
    & 0.3 \cdot 0.8 \cdot 0.9 \\ 0.7 \cdot 0.4 \cdot 0.1 & 0.7 \cdot 0.4 \cdot 0.9
    \end{pmatrix} \\ &= \begin{pmatrix} 0.03 & 0.03 \\ 0.21 & 0.21 \end{pmatrix} +
    \begin{pmatrix} 0.024 & 0.216 \\ 0.028 & 0.252 \end{pmatrix} \\ &= \begin{pmatrix}
    0.054 & 0.246 \\ 0.238 & 0.462 \end{pmatrix}. \end{align*}\]
- en: '**E6.3.11**'
  id: totrans-493
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.11**'
- en: \[\begin{align*} \hat{\pi}_1 &= \frac{N_1}{N_1 + N_2} = \frac{50}{50 + 100}
    = \frac{1}{3}, \\ \hat{p}_{1,1} &= \frac{N_{1,1}}{N_1} = \frac{10}{50} = 0.2,
    \\ \hat{p}_{2,1} &= \frac{N_{2,1}}{N_2} = \frac{40}{100} = 0.4. \end{align*}\]
  id: totrans-494
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \hat{\pi}_1 &= \frac{N_1}{N_1 + N_2} = \frac{50}{50 + 100}
    = \frac{1}{3}, \\ \hat{p}_{1,1} &= \frac{N_{1,1}}{N_1} = \frac{10}{50} = 0.2,
    \\ \hat{p}_{2,1} &= \frac{N_{2,1}}{N_2} = \frac{40}{100} = 0.4. \end{align*}\]
- en: '**E6.3.13**'
  id: totrans-495
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.3.13**'
- en: \[ \mathbb{P}[X=x, Y=y, Z=z] = \mathbb{P}[X=x]\mathbb{P}[Y=y|X=x]\mathbb{P}[Z=z|X=x].
    \]
  id: totrans-496
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbb{P}[X=x, Y=y, Z=z] = \mathbb{P}[X=x]\mathbb{P}[Y=y|X=x]\mathbb{P}[Z=z|X=x].
    \]
- en: '**E6.4.1**'
  id: totrans-497
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.1**'
- en: \[\begin{align*} \mathbb{P}(X = 1) &= \sum_{i=1}^2 \pi_i p_i \\ &= (0.6)(0.3)
    + (0.4)(0.8) \\ &= 0.5 \end{align*}\]
  id: totrans-498
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \mathbb{P}(X = 1) &= \sum_{i=1}^2 \pi_i p_i \\ &= (0.6)(0.3)
    + (0.4)(0.8) \\ &= 0.5 \end{align*}\]
- en: '**E6.4.3** \(\mathbb{P}[X = (1, 0)] = \pi_1 p_{1,1} (1 - p_{1,2}) + \pi_2 p_{2,1}
    (1 - p_{2,2}) = 0.4 \cdot 0.7 \cdot 0.7 + 0.6 \cdot 0.2 \cdot 0.2 = 0.196 + 0.024
    = 0.22\).'
  id: totrans-499
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.3** \(\mathbb{P}[X = (1, 0)] = \pi_1 p_{1,1} (1 - p_{1,2}) + \pi_2 p_{2,1}
    (1 - p_{2,2}) = 0.4 \cdot 0.7 \cdot 0.7 + 0.6 \cdot 0.2 \cdot 0.2 = 0.196 + 0.024
    = 0.22\).'
- en: '**E6.4.5** \(r_{1,i} = \frac{\pi_1 p_{1,1} p_{1,2}}{\pi_1 p_{1,1} p_{1,2} +
    \pi_2 p_{2,1} p_{2,2}} = \frac{0.5 \cdot 0.8 \cdot 0.2}{0.5 \cdot 0.8 \cdot 0.2
    + 0.5 \cdot 0.1 \cdot 0.9} = \frac{0.08}{0.08 + 0.045} \approx 0.64\), \(r_{2,i}
    = 1 - r_{1,i} \approx 0.36\).'
  id: totrans-500
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.5** \(r_{1,i} = \frac{\pi_1 p_{1,1} p_{1,2}}{\pi_1 p_{1,1} p_{1,2} +
    \pi_2 p_{2,1} p_{2,2}} = \frac{0.5 \cdot 0.8 \cdot 0.2}{0.5 \cdot 0.8 \cdot 0.2
    + 0.5 \cdot 0.1 \cdot 0.9} = \frac{0.08}{0.08 + 0.045} \approx 0.64\), \(r_{2,i}
    = 1 - r_{1,i} \approx 0.36\).'
- en: '**E6.4.7** \(\pi_1 = \frac{\eta_1}{n} = \frac{r_{1,1} + r_{1,1}}{2} = \frac{0.8
    + 0.8}{2} = 0.8\), \(\pi_2 = 1 - \pi_1 = 0.2\).'
  id: totrans-501
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.7** \(\pi_1 = \frac{\eta_1}{n} = \frac{r_{1,1} + r_{1,1}}{2} = \frac{0.8
    + 0.8}{2} = 0.8\), \(\pi_2 = 1 - \pi_1 = 0.2\).'
- en: '**E6.4.9**'
  id: totrans-502
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.9**'
- en: \[\begin{align*} r_{1,2} &= \frac{\pi_1 \prod_{m=1}^3 p_{1,m}^{x_{2,m}} (1 -
    p_{1,m})^{1-x_{2,m}}}{\sum_{k=1}^2 \pi_k \prod_{m=1}^3 p_{k,m}^{x_{2,m}} (1 -
    p_{k,m})^{1-x_{2,m}}} \\ &= \frac{(0.4)(0.2)^0(0.8)^1(0.9)^0(0.1)^1}{(0.4)(0.2)^0(0.8)^1(0.9)^0(0.1)^1
    + (0.6)(0.8)^0(0.2)^1(0.5)^0(0.5)^1} \\ &= \frac{0.032}{0.032 + 0.06} \\ &= \frac{8}{23}
    \end{align*}\]
  id: totrans-503
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} r_{1,2} &= \frac{\pi_1 \prod_{m=1}^3 p_{1,m}^{x_{2,m}} (1 -
    p_{1,m})^{1-x_{2,m}}}{\sum_{k=1}^2 \pi_k \prod_{m=1}^3 p_{k,m}^{x_{2,m}} (1 -
    p_{k,m})^{1-x_{2,m}}} \\ &= \frac{(0.4)(0.2)^0(0.8)^1(0.9)^0(0.1)^1}{(0.4)(0.2)^0(0.8)^1(0.9)^0(0.1)^1
    + (0.6)(0.8)^0(0.2)^1(0.5)^0(0.5)^1} \\ &= \frac{0.032}{0.032 + 0.06} \\ &= \frac{8}{23}
    \end{align*}\]
- en: '**E6.4.11**'
  id: totrans-504
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.11**'
- en: \[ \mathbb{E}[X] = \pi_1 \mu_1 + \pi_2 \mu_2 = 0.5 \times (-1) + 0.5 \times
    3 = -0.5 + 1.5 = 1. \]
  id: totrans-505
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbb{E}[X] = \pi_1 \mu_1 + \pi_2 \mu_2 = 0.5 \times (-1) + 0.5 \times
    3 = -0.5 + 1.5 = 1. \]
- en: '**E6.4.13**'
  id: totrans-506
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.4.13**'
- en: \[ \mathrm{Var}(X) = \pi_1 (\sigma_1^2 + \mu_1^2) + \pi_2 (\sigma_2^2 + \mu_2^2)
    - \left(\pi_1 \mu_1 + \pi_2 \mu_2\right)^2, \]\[ \mathrm{Var}(X) = 0.4 (1 + 0^2)
    + 0.6 (2 + 4^2) - (0.4 \times 0 + 0.6 \times 4)^2 = 0.4 \times 1 + 0.6 \times
    18 - 2.4^2, \]\[ \mathrm{Var}(X) = 0.4 + 10.8 - 5.76 = 5.44. \]
  id: totrans-507
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathrm{Var}(X) = \pi_1 (\sigma_1^2 + \mu_1^2) + \pi_2 (\sigma_2^2 + \mu_2^2)
    - \left(\pi_1 \mu_1 + \pi_2 \mu_2\right)^2, \]\[ \mathrm{Var}(X) = 0.4 (1 + 0^2)
    + 0.6 (2 + 4^2) - (0.4 \times 0 + 0.6 \times 4)^2 = 0.4 \times 1 + 0.6 \times
    18 - 2.4^2, \]\[ \mathrm{Var}(X) = 0.4 + 10.8 - 5.76 = 5.44. \]
- en: '**E6.5.1**'
  id: totrans-508
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.1**'
- en: \[ B / B_{11} = B_{22} - B_{12}^T B_{11}^{-1} B_{12} = 3 - 1 \cdot \frac{1}{2}
    \cdot 1 = \frac{5}{2}, \]
  id: totrans-509
  prefs: []
  type: TYPE_NORMAL
  zh: \[ B / B_{11} = B_{22} - B_{12}^T B_{11}^{-1} B_{12} = 3 - 1 \cdot \frac{1}{2}
    \cdot 1 = \frac{5}{2}, \]
- en: using the definition of the Schur complement.
  id: totrans-510
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Schur补的定义。
- en: '**E6.5.3** The Schur complement of \(A_{11}\) in \(A\) is given by'
  id: totrans-511
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.3** \(A_{11}\) 在 \(A\) 中的Schur补由以下给出'
- en: \[\begin{split} A/A_{11} = A_{22} - A_{21}A_{11}^{-1}A_{12} = 7 - \begin{pmatrix}
    0 & 6 \end{pmatrix} \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix}^{-1} \begin{pmatrix}
    0 \\ 5 \end{pmatrix}. \end{split}\]
  id: totrans-512
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A/A_{11} = A_{22} - A_{21}A_{11}^{-1}A_{12} = 7 - \begin{pmatrix}
    0 & 6 \end{pmatrix} \begin{pmatrix} 1 & 2 \\ 3 & 4 \end{pmatrix}^{-1} \begin{pmatrix}
    0 \\ 5 \end{pmatrix}. \end{split}\]
- en: 'First, compute \(A_{11}^{-1}\):'
  id: totrans-513
  prefs: []
  type: TYPE_NORMAL
  zh: '首先，计算 \(A_{11}^{-1}\):'
- en: \[\begin{split} A_{11}^{-1} = \frac{1}{1 \cdot 4 - 2 \cdot 3} \begin{pmatrix}
    4 & -2 \\ -3 & 1 \end{pmatrix} = \begin{pmatrix} -2 & 1 \\ 1.5 & -0.5 \end{pmatrix}.
    \end{split}\]
  id: totrans-514
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A_{11}^{-1} = \frac{1}{1 \cdot 4 - 2 \cdot 3} \begin{pmatrix}
    4 & -2 \\ -3 & 1 \end{pmatrix} = \begin{pmatrix} -2 & 1 \\ 1.5 & -0.5 \end{pmatrix}.
    \end{split}\]
- en: Then,
  id: totrans-515
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，
- en: \[\begin{split} A/A_{11} = 7 - \begin{pmatrix} 0 & 6 \end{pmatrix} \begin{pmatrix}
    -2 & 1 \\ 1.5 & -0.5 \end{pmatrix} \begin{pmatrix} 0 \\ 5 \end{pmatrix} = 7 +
    (6 \cdot 0.5 \cdot 5) = 22. \end{split}\]
  id: totrans-516
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A/A_{11} = 7 - \begin{pmatrix} 0 & 6 \end{pmatrix} \begin{pmatrix}
    -2 & 1 \\ 1.5 & -0.5 \end{pmatrix} \begin{pmatrix} 0 \\ 5 \end{pmatrix} = 7 +
    (6 \cdot 0.5 \cdot 5) = 22. \end{split}\]
- en: '**E6.5.5** The conditional mean of \(X_1\) given \(X_2 = 3\) is'
  id: totrans-517
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.5** 在 \(X_2 = 3\) 条件下 \(X_1\) 的条件均值是'
- en: \[ \mu_{1|2}(3) = \mu_1 + \bSigma_{12} \bSigma_{22}^{-1} (3 - \bmu_2) = 1 +
    1 \cdot \frac{1}{3} (3 - 2) = \frac{4}{3}, \]
  id: totrans-518
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mu_{1|2}(3) = \mu_1 + \bSigma_{12} \bSigma_{22}^{-1} (3 - \bmu_2) = 1 +
    1 \cdot \frac{1}{3} (3 - 2) = \frac{4}{3}, \]
- en: using the formula for the conditional mean of multivariate Gaussians.
  id: totrans-519
  prefs: []
  type: TYPE_NORMAL
  zh: 使用多元高斯条件均值的公式。
- en: '**E6.5.7** The conditional distribution of \(X_1\) given \(X_2 = 1\) is Gaussian
    with mean \(\mu_{1|2} = \mu_1 + \bSigma_{12} \bSigma_{22}^{-1} (1 - \mu_2) = \frac{1}{2}\)
    and variance \(\bSigma_{1|2} = \bSigma_{11} - \bSigma_{12} \bSigma_{22}^{-1} \bSigma_{21}
    = \frac{7}{2}\).'
  id: totrans-520
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.7** 在 \(X_2 = 1\) 条件下 \(X_1\) 的条件分布是高斯分布，均值为 \(\mu_{1|2} = \mu_1 + \bSigma_{12}
    \bSigma_{22}^{-1} (1 - \mu_2) = \frac{1}{2}\) 和方差 \(\bSigma_{1|2} = \bSigma_{11}
    - \bSigma_{12} \bSigma_{22}^{-1} \bSigma_{21} = \frac{7}{2}\).'
- en: '**E6.5.9** The distribution of \(\bY\) is Gaussian with mean vector \(A\bmu
    = \begin{pmatrix} -3 \\ -3 \end{pmatrix}\) and covariance matrix \(A\bSigma A^T
    = \begin{pmatrix} 8 & 1 \\ 1 & 6 \end{pmatrix}\).'
  id: totrans-521
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.9** \(\bY\) 的分布是高斯分布，均值向量为 \(A\bmu = \begin{pmatrix} -3 \\ -3 \end{pmatrix}\)
    和协方差矩阵 \(A\bSigma A^T = \begin{pmatrix} 8 & 1 \\ 1 & 6 \end{pmatrix}\).'
- en: '**E6.5.11** The mean of \(Y_t\) is'
  id: totrans-522
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.11** \(Y_t\) 的均值是'
- en: \[\begin{split} \mathbb{E}[Y_t] = \begin{pmatrix} 1 & 0 \end{pmatrix} \mathbb{E}[\bX_t]
    = \begin{pmatrix} 1 & 0 \end{pmatrix} \begin{pmatrix} 1 \\ 2 \end{pmatrix} = 1,
    \end{split}\]
  id: totrans-523
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbb{E}[Y_t] = \begin{pmatrix} 1 & 0 \end{pmatrix} \mathbb{E}[\bX_t]
    = \begin{pmatrix} 1 & 0 \end{pmatrix} \begin{pmatrix} 1 \\ 2 \end{pmatrix} = 1,
    \end{split}\]
- en: and the variance of \(Y_t\) is
  id: totrans-524
  prefs: []
  type: TYPE_NORMAL
  zh: \(Y_t\) 的方差是
- en: \[\begin{split} \mathrm{Var}[Y_t] = \begin{pmatrix} 1 & 0 \end{pmatrix} \mathrm{Cov}[\bX_t]
    \begin{pmatrix} 1 \\ 0 \end{pmatrix} + 1 = \begin{pmatrix} 1 & 0 \end{pmatrix}
    \begin{pmatrix} 1 \\ 0 \end{pmatrix} + 1 = 2, \end{split}\]
  id: totrans-525
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathrm{Var}[Y_t] = \begin{pmatrix} 1 & 0 \end{pmatrix} \mathrm{Cov}[\bX_t]
    \begin{pmatrix} 1 \\ 0 \end{pmatrix} + 1 = \begin{pmatrix} 1 & 0 \end{pmatrix}
    \begin{pmatrix} 1 \\ 0 \end{pmatrix} + 1 = 2, \end{split}\]
- en: using the properties of linear-Gaussian systems.
  id: totrans-526
  prefs: []
  type: TYPE_NORMAL
  zh: 利用线性高斯系统的性质。
- en: '**E6.5.13** The innovation is'
  id: totrans-527
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.13** 创新是'
- en: \[\begin{split} e_t = Y_t - H \bmu_{\text{pred}} = 3 - \begin{pmatrix} 1 & 0
    \end{pmatrix} \begin{pmatrix} 3 \\ 1 \end{pmatrix} = 3 - 3 = 0. \end{split}\]
  id: totrans-528
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} e_t = Y_t - H \bmu_{\text{pred}} = 3 - \begin{pmatrix} 1 & 0
    \end{pmatrix} \begin{pmatrix} 3 \\ 1 \end{pmatrix} = 3 - 3 = 0. \end{split}\]
- en: '**E6.5.15** The updated state estimate is'
  id: totrans-529
  prefs: []
  type: TYPE_NORMAL
  zh: '**E6.5.15** 更新的状态估计是'
- en: \[\begin{split} \bmu_t = \bmu_{\text{pred}} + K_t e_t = \begin{pmatrix} 3 \\
    1 \end{pmatrix} + \begin{pmatrix} \frac{2}{3} \\ \frac{1}{3} \end{pmatrix} \cdot
    0 = \begin{pmatrix} 3 \\ 1 \end{pmatrix}. \end{split}\]
  id: totrans-530
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bmu_t = \bmu_{\text{pred}} + K_t e_t = \begin{pmatrix} 3 \\
    1 \end{pmatrix} + \begin{pmatrix} \frac{2}{3} \\ \frac{1}{3} \end{pmatrix} \cdot
    0 = \begin{pmatrix} 3 \\ 1 \end{pmatrix}. \end{split}\]
- en: 6.7.1.5\. Learning outcomes[#](#learning-outcomes "Link to this heading")
  id: totrans-531
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.1.5\. 学习成果[#](#learning-outcomes "链接到这个标题")
- en: Define exponential families and give examples of common probability distributions
    that belong to this family.
  id: totrans-532
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定义指数族并给出属于此族的一些常见概率分布的例子。
- en: Derive the maximum likelihood estimator for exponential families and explain
    its properties.
  id: totrans-533
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 推导指数族的最大似然估计量并解释其性质。
- en: Prove that, under certain conditions, the maximum likelihood estimator is statistically
    consistent.
  id: totrans-534
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在一定条件下证明最大似然估计量是统计一致的。
- en: Formulate generalized linear models using exponential families and express linear
    and logistic regression as special cases.
  id: totrans-535
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用指数族来制定广义线性模型，并将线性回归和逻辑回归表示为特殊情况。
- en: Compute the gradient and Hessian of the negative log-likelihood for generalized
    linear models.
  id: totrans-536
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 计算广义线性模型负对数似然函数的梯度和Hessian矩阵。
- en: Interpret the moment-matching equations for the maximum likelihood estimator
    in generalized linear models.
  id: totrans-537
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 解释广义线性模型中最大似然估计量的矩匹配方程。
- en: Apply the multiplication rule, the law of total probability, and Bayes’ rule
    to solve problems involving conditional probabilities.
  id: totrans-538
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用乘法法则、全概率定律和贝叶斯法则来解决涉及条件概率的问题。
- en: Calculate conditional probability mass functions and conditional expectations
    for discrete random variables.
  id: totrans-539
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 计算离散随机变量的条件概率质量函数和条件期望。
- en: Define conditional independence and express it mathematically in terms of conditional
    probabilities.
  id: totrans-540
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定义条件独立性并用条件概率的数学术语表达。
- en: Differentiate between the fork, chain, and collider configurations in graphical
    models representing conditional independence relations.
  id: totrans-541
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在表示条件独立性关系的图模型中区分分支、链和碰撞配置。
- en: Derive the joint probability distribution for the Naive Bayes model under the
    assumption of conditional independence.
  id: totrans-542
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在条件独立性的假设下推导朴素贝叶斯模型的联合概率分布。
- en: Implement maximum likelihood estimation to fit the parameters of the Naive Bayes
    model.
  id: totrans-543
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实施最大似然估计来拟合朴素贝叶斯模型的参数。
- en: Apply the Naive Bayes model for prediction and evaluate its accuracy.
  id: totrans-544
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用朴素贝叶斯模型进行预测并评估其准确性。
- en: Implement Laplace smoothing to address the issue of unseen words in the training
    data when fitting a Naive Bayes model.
  id: totrans-545
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在拟合朴素贝叶斯模型时，使用拉普拉斯平滑来解决训练数据中未见词的问题。
- en: Apply the Naive Bayes model to perform sentiment analysis on a real-world dataset
    and interpret the results.
  id: totrans-546
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将朴素贝叶斯模型应用于对现实世界数据集进行情感分析并解释结果。
- en: Define mixtures as convex combinations of distributions and express the probability
    distribution of a mixture model using the law of total probability.
  id: totrans-547
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定义混合分布为分布的凸组合，并使用全概率定律表达混合模型的概率分布。
- en: Identify examples of mixture models, such as mixtures of multinomials and Gaussian
    mixture models, and recognize their probability density functions.
  id: totrans-548
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 识别混合模型的例子，如多项式混合和高斯混合模型，并识别它们的概率密度函数。
- en: Explain the concept of marginalizing out an unobserved random variable in the
    context of mixture models.
  id: totrans-549
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在混合模型背景下，解释消除未观察到的随机变量的概念。
- en: Formulate the objective function for parameter estimation in mixtures of multivariate
    Bernoullis using the negative log-likelihood.
  id: totrans-550
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用负对数似然函数，为多元伯努利混合的参数估计公式化目标函数。
- en: Describe the majorization-minimization principle and its application in the
    Expectation-Maximization (EM) algorithm.
  id: totrans-551
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 描述极大化-极小化原理及其在期望最大化（EM）算法中的应用。
- en: Derive the E-step and M-step updates for the EM algorithm in the context of
    mixtures of multivariate Bernoullis.
  id: totrans-552
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在多元伯努利混合的背景下，推导EM算法的E步和M步更新。
- en: Implement the EM algorithm for mixtures of multivariate Bernoullis and apply
    it to a real-world dataset, such as clustering handwritten digits from the MNIST
    dataset.
  id: totrans-553
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实现多元伯努利混合的EM算法，并将其应用于MNIST数据集中的手写数字聚类等实际数据集。
- en: Identify and address numerical issues that may arise during the implementation
    of the EM algorithm, such as underflow, by applying techniques like the log-sum-exp
    trick.
  id: totrans-554
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 识别并解决在EM算法实现过程中可能出现的数值问题，如下溢，通过应用如对数和指数技巧等技术。
- en: Define block matrices and the Schur complement, and demonstrate their properties
    through examples and proofs.
  id: totrans-555
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定义分块矩阵和Schur补，并通过示例和证明展示它们的性质。
- en: Derive the marginal and conditional distributions of multivariate Gaussians
    using the properties of block matrices and the Schur complement.
  id: totrans-556
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 利用分块矩阵的性质和Schur补的性质，推导多元高斯分布的边缘和条件分布。
- en: Describe the linear-Gaussian system model and its components, including the
    state evolution and observation processes.
  id: totrans-557
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 描述线性高斯系统模型及其组成部分，包括状态演化和观测过程。
- en: Explain the purpose and key steps of the Kalman filter algorithm, including
    the prediction and update steps.
  id: totrans-558
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 解释卡尔曼滤波算法的目的和关键步骤，包括预测和更新步骤。
- en: Implement the Kalman filter algorithm in code, given the state evolution and
    observation models, and the initial state distribution.
  id: totrans-559
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据状态演化和观测模型以及初始状态分布，用代码实现卡尔曼滤波算法。
- en: Apply the Kalman filter to a location tracking problem, and interpret the results
    in terms of the estimated object path and the algorithm’s performance.
  id: totrans-560
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将卡尔曼滤波应用于位置跟踪问题，并从估计的对象路径和算法性能的角度解释结果。
- en: \(\aleph\)
  id: totrans-561
  prefs: []
  type: TYPE_NORMAL
  zh: \(\aleph\)
- en: 6.7.2\. Additional sections[#](#additional-sections "Link to this heading")
  id: totrans-562
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 6.7.2. Additional sections[#](#additional-sections "链接到这个标题")
- en: 6.7.2.1\. Sentiment analysis[#](#sentiment-analysis "Link to this heading")
  id: totrans-563
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.2.1. Sentiment analysis[#](#sentiment-analysis "链接到这个标题")
- en: 'As an application of the Naive Bayes model, we consider the task of sentiment
    analysis, which is a classification problem. We use a dataset available [here](https://www.kaggle.com/crowdflower/twitter-airline-sentiment).
    Quoting from there:'
  id: totrans-564
  prefs: []
  type: TYPE_NORMAL
  zh: 作为朴素贝叶斯模型的应用，我们考虑情感分析的任务，这是一个分类问题。我们使用可在此处找到的数据集[这里](https://www.kaggle.com/crowdflower/twitter-airline-sentiment)。引用如下：
- en: A sentiment analysis job about the problems of each major U.S. airline. Twitter
    data was scraped from February of 2015 and contributors were asked to first classify
    positive, negative, and neutral tweets, followed by categorizing negative reasons
    (such as “late flight” or “rude service”).
  id: totrans-565
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 对美国各大航空公司的相关问题进行情感分析。从2015年2月开始抓取Twitter数据，并要求参与者首先对正面、负面和中性推文进行分类，然后对负面原因（如“航班延误”或“服务粗鲁”）进行分类。
- en: We first load a cleaned-up version of the data and look at its summary.
  id: totrans-566
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先加载一个清理过的数据版本，并查看其摘要。
- en: '[PRE51]'
  id: totrans-567
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: '|  | time | user | sentiment | text |'
  id: totrans-568
  prefs: []
  type: TYPE_TB
  zh: '|  | 时间 | 用户 | 情感 | 文本 |'
- en: '| --- | --- | --- | --- | --- |'
  id: totrans-569
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- |'
- en: '| 0 | 2/24/15 11:35 | cairdin | neutral | @VirginAmerica What @dhepburn said.
    |'
  id: totrans-570
  prefs: []
  type: TYPE_TB
  zh: '| 0 | 2/24/15 11:35 | cairdin | 中立 | @VirginAmerica @dhepburn说的。 |'
- en: '| 1 | 2/24/15 11:15 | jnardino | positive | @VirginAmerica plus you''ve added
    commercials t... |'
  id: totrans-571
  prefs: []
  type: TYPE_TB
  zh: '| 1 | 2/24/15 11:15 | jnardino | 正面 | @VirginAmerica 除此之外，你还增加了广告... |'
- en: '| 2 | 2/24/15 11:15 | yvonnalynn | neutral | @VirginAmerica I didn''t today...
    Must mean I n... |'
  id: totrans-572
  prefs: []
  type: TYPE_TB
  zh: '| 2 | 2/24/15 11:15 | yvonnalynn | 中立 | @VirginAmerica 我今天没有...肯定意味着我... |'
- en: '| 3 | 2/24/15 11:15 | jnardino | negative | @VirginAmerica it''s really aggressive
    to blast... |'
  id: totrans-573
  prefs: []
  type: TYPE_TB
  zh: '| 3 | 2/24/15 11:15 | jnardino | 负面 | @VirginAmerica 真的很具侵略性... |'
- en: '| 4 | 2/24/15 11:14 | jnardino | negative | @VirginAmerica and it''s a really
    big bad thing... |'
  id: totrans-574
  prefs: []
  type: TYPE_TB
  zh: '| 4 | 2/24/15 11:14 | jnardino | 负面 | @VirginAmerica 真的是一件非常糟糕的事情... |'
- en: '[PRE52]'
  id: totrans-575
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: '[PRE53]'
  id: totrans-576
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: We extract the text information in this dataset.
  id: totrans-577
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从该数据集中提取文本信息。
- en: '[PRE54]'
  id: totrans-578
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: '[PRE55]'
  id: totrans-579
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 'Next, we convert our dataset into a matrix by creating a document-term matrix
    using [`sklearn.feature_extraction.text.CountVectorizer`](https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html#sklearn.feature_extraction.text.CountVectorizer.fit_transform).
    Quoting [Wikipedia](https://en.wikipedia.org/wiki/Document-term_matrix):'
  id: totrans-580
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们通过使用 `sklearn.feature_extraction.text.CountVectorizer` 创建文档-词矩阵将我们的数据集转换为矩阵。引用
    [维基百科](https://en.wikipedia.org/wiki/Document-term_matrix)：
- en: A document-term matrix or term-document matrix is a mathematical matrix that
    describes the frequency of terms that occur in a collection of documents. In a
    document-term matrix, rows correspond to documents in the collection and columns
    correspond to terms.
  id: totrans-581
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 文档-词矩阵或词-文档矩阵是一个数学矩阵，描述了在文档集合中出现的术语的频率。在文档-词矩阵中，行对应于集合中的文档，列对应于术语。
- en: 'By default, it first preprocesses the data. In particular, it lower-cases all
    words and removes punctuation. A more careful pre-procsseing would also include
    stemming, although we do not do this here. Regarding the latter, quoting [Wikipedia](https://en.wikipedia.org/wiki/Stemming):'
  id: totrans-582
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，它首先预处理数据。特别是，它将所有单词转换为小写并删除标点符号。更仔细的预处理还包括词干提取，尽管我们在这里没有这样做。关于后者，引用 [维基百科](https://en.wikipedia.org/wiki/Stemming)：
- en: In linguistic morphology and information retrieval, stemming is the process
    of reducing inflected (or sometimes derived) words to their word stem, base or
    root form—generally a written word form. […] A computer program or subroutine
    that stems word may be called a stemming program, stemming algorithm, or stemmer.
    […] A stemmer for English operating on the stem cat should identify such strings
    as cats, catlike, and catty. A stemming algorithm might also reduce the words
    fishing, fished, and fisher to the stem fish. The stem need not be a word, for
    example the Porter algorithm reduces, argue, argued, argues, arguing, and argus
    to the stem argu.
  id: totrans-583
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 在语言学形态学和信息检索中，词干提取是将屈折（或有时是派生）词还原到其词干、词根或基本形式的过程——通常是一个书面词形式。 [...] 一个进行词干提取的计算机程序或子程序可以称为词干提取程序、词干提取算法或词干提取器。
    [...] 对于在 stem cat 上操作的英语词干提取器，应识别出这样的字符串，如 cats、catlike 和 catty。词干提取算法也可能将 fishing、fished
    和 fisher 等单词还原到词干 fish。词干不一定是单词，例如，Porter 算法将 argue、argued、argues、arguing 和 argus
    还原到词干 argu。
- en: '[PRE56]'
  id: totrans-584
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: '[PRE57]'
  id: totrans-585
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: '[PRE58]'
  id: totrans-586
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: The list of all terms used can be accessed as follows.
  id: totrans-587
  prefs: []
  type: TYPE_NORMAL
  zh: 所有术语的列表可以通过以下方式访问。
- en: '[PRE59]'
  id: totrans-588
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: '[PRE60]'
  id: totrans-589
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: Because of our use of the multivariate Bernoulli naive Bayes model, it will
    be more convenient to work with a variant of the document-term matrix where each
    word is either present or absent. Note that, in the context of tweet data which
    are very short documents with likely little word repetition, there is probably
    not much difference.
  id: totrans-590
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们使用了多元伯努利朴素贝叶斯模型，使用每个单词要么存在要么不存在的文档-词矩阵的变体将更方便。请注意，在推文数据（这些数据是可能很少单词重复的非常短的文档）的上下文中，可能没有太大的区别。
- en: '[PRE61]'
  id: totrans-591
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: '[PRE62]'
  id: totrans-592
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: We also extract the labels (`neutral`, `postive`, `negative`) from the dataset.
  id: totrans-593
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还从数据集中提取了标签（`neutral`、`positive`、`negative`）。
- en: '[PRE63]'
  id: totrans-594
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: '[PRE64]'
  id: totrans-595
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: We split the data into a training set and a test set using [`sklearn.model_selection.train_test_split`](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html).
  id: totrans-596
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用 `sklearn.model_selection.train_test_split` 将数据分为训练集和测试集。
- en: '[PRE65]'
  id: totrans-597
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: '[PRE66]'
  id: totrans-598
  prefs: []
  type: TYPE_PRE
  zh: '[PRE66]'
- en: We use the Naive Bayes method. We first construct the matrix \(N_{k,m}\) and
    the vector \(N_k\).
  id: totrans-599
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用朴素贝叶斯方法。我们首先构建矩阵 \(N_{k,m}\) 和向量 \(N_k\)。
- en: '[PRE67]'
  id: totrans-600
  prefs: []
  type: TYPE_PRE
  zh: '[PRE67]'
- en: Above, the [`enumerate`](https://docs.python.org/3/library/functions.html#enumerate)
    function provides both the index and the value for each item in the `label_set`
    list during the loop. This allows the code to use the label’s value (`k`) and
    its numerical position (`i`) at the same time.
  id: totrans-601
  prefs: []
  type: TYPE_NORMAL
  zh: 如上所示，`enumerate` 函数在循环中为 `label_set` 列表中的每个项目提供索引和值。这使得代码能够同时使用标签的值（`k`）及其数值位置（`i`）。
- en: We are ready to train on the dataset.
  id: totrans-602
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经准备好在数据集上训练。
- en: '[PRE68]'
  id: totrans-603
  prefs: []
  type: TYPE_PRE
  zh: '[PRE68]'
- en: '[PRE69]'
  id: totrans-604
  prefs: []
  type: TYPE_PRE
  zh: '[PRE69]'
- en: '[PRE70]'
  id: totrans-605
  prefs: []
  type: TYPE_PRE
  zh: '[PRE70]'
- en: '[PRE71]'
  id: totrans-606
  prefs: []
  type: TYPE_PRE
  zh: '[PRE71]'
- en: Next, we plot the vector \(p_{k,m}\) for each label \(k\).
  id: totrans-607
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们为每个标签 \(k\) 绘制向量 \(p_{k,m}\)。
- en: '[PRE72]'
  id: totrans-608
  prefs: []
  type: TYPE_PRE
  zh: '[PRE72]'
- en: '![../../_images/e75f50e0059a06f686e844c95d499bf2dbc3ef78367a3fc95c0ed8f7df2202b1.png](../Images/dc490453944015ef54f86c78956d449e.png)'
  id: totrans-609
  prefs: []
  type: TYPE_IMG
  zh: '![../../_images/e75f50e0059a06f686e844c95d499bf2dbc3ef78367a3fc95c0ed8f7df2202b1.png](../Images/dc490453944015ef54f86c78956d449e.png)'
- en: 'We can compute a prediction on the test tweets. For example, for the 5th test
    tweet:'
  id: totrans-610
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以在测试推文中进行预测。例如，对于第5个测试推文：
- en: '[PRE73]'
  id: totrans-611
  prefs: []
  type: TYPE_PRE
  zh: '[PRE73]'
- en: '[PRE74]'
  id: totrans-612
  prefs: []
  type: TYPE_PRE
  zh: '[PRE74]'
- en: The following computes the overall accuracy over the test data.
  id: totrans-613
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的代码计算了测试数据集的整体准确率。
- en: '[PRE75]'
  id: totrans-614
  prefs: []
  type: TYPE_PRE
  zh: '[PRE75]'
- en: '[PRE76]'
  id: totrans-615
  prefs: []
  type: TYPE_PRE
  zh: '[PRE76]'
- en: To get a better understanding of the differences uncovered by Naive Bayes between
    the different labels, we identify words that are particularly common in one label,
    but not on the other. Recall that label `1` corresponds to `positive` while label
    `2` corresponds to `negative`.
  id: totrans-616
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更好地理解朴素贝叶斯在不同标签之间的差异，我们识别出在某个标签中特别常见但在另一个标签中不常见的单词。回想一下，标签`1`对应`positive`，而标签`2`对应`negative`。
- en: '[PRE77]'
  id: totrans-617
  prefs: []
  type: TYPE_PRE
  zh: '[PRE77]'
- en: '[PRE78]'
  id: totrans-618
  prefs: []
  type: TYPE_PRE
  zh: '[PRE78]'
- en: 'One notices that many positive words do appear in this list: `awesome`, `best`,
    `great`, `love`, `thank`.'
  id: totrans-619
  prefs: []
  type: TYPE_NORMAL
  zh: 注意到这个列表中确实出现了许多积极的词汇：`awesome`、`best`、`great`、`love`、`thank`。
- en: '[PRE79]'
  id: totrans-620
  prefs: []
  type: TYPE_PRE
  zh: '[PRE79]'
- en: '[PRE80]'
  id: totrans-621
  prefs: []
  type: TYPE_PRE
  zh: '[PRE80]'
- en: 'This time, we notice: `bag`, `cancelled`, `delayed`, `hours`, `phone`.'
  id: totrans-622
  prefs: []
  type: TYPE_NORMAL
  zh: 这次，我们注意到：`bag`、`cancelled`、`delayed`、`hours`、`phone`。
- en: '**CHAT & LEARN** The bag-of-words representation used in the sentiment analysis
    example is a simple but limited way to represent text data. More advanced representations
    such as word embeddings and transformer models can capture more semantic information.
    Ask your favorite AI chatbot to explain these representations and how they can
    be used for text classification tasks. \(\ddagger\)'
  id: totrans-623
  prefs: []
  type: TYPE_NORMAL
  zh: '**CHAT & LEARN** 在情感分析示例中使用的词袋表示法是一种简单但有限的表示文本数据的方法。更高级的表示方法，如词嵌入和转换器模型，可以捕捉到更多的语义信息。请你的AI聊天机器人解释这些表示方法以及它们如何用于文本分类任务。\(\ddagger\)'
- en: '6.7.2.2\. Kalman filtering: missing data[#](#kalman-filtering-missing-data
    "Link to this heading")'
  id: totrans-624
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.2.2\. 卡尔曼滤波：缺失数据[#](#kalman-filtering-missing-data "链接到本标题")
- en: In Kalman filtering, we can also allow for the possibility that some observations
    are missing. Imagine for instance losing GPS signal while going through a tunnel.
    The recursions above are still valid, with the only modification that the *Update*
    equations involving \(\bY_t\) are dropped at those times \(t\) where there is
    no observation. In Numpy, we can use [`NaN`](https://numpy.org/doc/stable/reference/constants.html#numpy.nan)
    to indicate the lack of observation. (Alternatively, one can use the [numpy.ma](https://numpy.org/doc/stable/reference/maskedarray.generic.html)
    module.)
  id: totrans-625
  prefs: []
  type: TYPE_NORMAL
  zh: 在卡尔曼滤波中，我们还可以允许某些观测数据缺失的可能性。例如，想象一下在穿过隧道时丢失GPS信号的情况。上述递归仍然有效，唯一的修改是在没有观测数据的时间点\(t\)处，涉及\(\bY_t\)的*更新*方程被省略。在Numpy中，我们可以使用[`NaN`](https://numpy.org/doc/stable/reference/constants.html#numpy.nan)来表示观测数据的缺失。（或者，也可以使用[numpy.ma](https://numpy.org/doc/stable/reference/maskedarray.generic.html)模块。）
- en: We use a same sample path as above, but mask observations at times \(t=10,\ldots,20\).
  id: totrans-626
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用与上面相同的样本路径，但在时间点\(t=10,\ldots,20\)处屏蔽观测数据。
- en: '[PRE81]'
  id: totrans-627
  prefs: []
  type: TYPE_PRE
  zh: '[PRE81]'
- en: '[PRE82]'
  id: totrans-628
  prefs: []
  type: TYPE_PRE
  zh: '[PRE82]'
- en: Here is the sample we are aiming to infer.
  id: totrans-629
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是我们试图推断的样本。
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  id: totrans-630
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格源代码 隐藏代码单元格源代码</summary>
- en: '[PRE83]</details> ![../../_images/f50483a562aeab113e7a2c066e9f1df40a3734ae2dcc59b104875762494a3a7e.png](../Images/23e83372ecc5a5cde94ad7f021c21a15.png)'
  id: totrans-631
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE83]</details> ![../../_images/f50483a562aeab113e7a2c066e9f1df40a3734ae2dcc59b104875762494a3a7e.png](../Images/23e83372ecc5a5cde94ad7f021c21a15.png)'
- en: We modify the recursion accordingly, that is, skip the *Update* step when there
    is no observation to use for the update.
  id: totrans-632
  prefs: []
  type: TYPE_NORMAL
  zh: 我们相应地修改了递归过程，即在没有任何观测数据可用于更新时，跳过*更新*步骤。
- en: '[PRE84]'
  id: totrans-633
  prefs: []
  type: TYPE_PRE
  zh: '[PRE84]'
- en: '[PRE85]'
  id: totrans-634
  prefs: []
  type: TYPE_PRE
  zh: '[PRE85]'
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  id: totrans-635
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="切换隐藏内容">显示代码单元格源代码 隐藏代码单元格源代码</summary>
- en: '[PRE86]</details> ![../../_images/2e92c840f3a0f15546d76a33647bbdb2a46015c60b362e0062398e2de1579630.png](../Images/6633cdad5605633dacdc68a6a28fde12.png)'
  id: totrans-636
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE86]</details> ![../../_images/2e92c840f3a0f15546d76a33647bbdb2a46015c60b362e0062398e2de1579630.png](../Images/6633cdad5605633dacdc68a6a28fde12.png)'
- en: 6.7.2.3\. Cholesky decomposition[#](#cholesky-decomposition "Link to this heading")
  id: totrans-637
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.2.3\. 谷歌分解[#](#cholesky-decomposition "链接到本标题")
- en: In this section, we derive an important matrix factorization and apply it to
    generating multivariate Gaussians. We also revisit the least-squares problem.
    We begin with the motivation.
  id: totrans-638
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们推导出一个重要的矩阵分解，并将其应用于生成多元高斯分布。我们还回顾了最小二乘问题。我们从动机开始。
- en: '**Generating multivariate Gaussians** Suppose we want to generate samples from
    a multivariate Gaussian \(\bX \sim N_d(\bmu, \bSigma)\) with given mean vector
    \(\bmu \in \mathbb{R}^d\) and positive definite covariance matrix \(\bSigma \in
    \mathbb{R}^{d \times d}\). Of course, in Numpy, we could use [`numpy.random.Generator.multivariate_normal`](https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.multivariate_normal.html).
    But what is behind it? More precisely, suppose we have access to unlimited samples
    \(U_1, U_2, U_3, etc.\) from uniform random variables in \([0,1]\). How do we
    transform them to obtain samples from \(N_d(\bmu, \bSigma)\).'
  id: totrans-639
  prefs: []
  type: TYPE_NORMAL
  zh: '**生成多元高斯分布** 假设我们想要从具有给定均值向量 \(\bmu \in \mathbb{R}^d\) 和正定协方差矩阵 \(\bSigma \in
    \mathbb{R}^{d \times d}\) 的多元高斯分布 \(\bX \sim N_d(\bmu, \bSigma)\) 中生成样本。当然，在 Numpy
    中，我们可以使用 `numpy.random.Generator.multivariate_normal`。但它的原理是什么？更确切地说，假设我们能够从 \([0,1]\)
    区间内的均匀随机变量中获得无限多的样本 \(U_1, U_2, U_3, \ldots\)。我们如何将它们转换以获得 \(N_d(\bmu, \bSigma)\)
    的样本。'
- en: 'We start with the simplest case: \(d=1\), \(\mu = 0\), and \(\sigma^2 = 1\).
    That is, we first generate a univariate standard Normal. We have seen a recipe
    for doing this before, the inverse transform sampling method. Specifically, recall
    that the cumulative distribution function (CDF) of a random variable \(Z\) is
    defined as'
  id: totrans-640
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从最简单的情况开始：\(d=1\)，\(\mu = 0\)，\(\sigma^2 = 1\)。也就是说，我们首先生成一个一元标准正态分布。我们之前已经看到了实现这一点的配方，即逆变换抽样方法。具体来说，回想一下，随机变量
    \(Z\) 的累积分布函数（CDF）定义为
- en: \[ F_Z(z) = \mathbb{P}[Z \leq z], \qquad \forall z \in \mathbb{R}. \]
  id: totrans-641
  prefs: []
  type: TYPE_NORMAL
  zh: \[ F_Z(z) = \mathbb{P}[Z \leq z], \qquad \forall z \in \mathbb{R}. \]
- en: Let \(\mathcal{Z}\) be the interval where \(F_Z(z) \in (0,1)\) and assume that
    \(F_X\) is strictly increasing on \(\mathcal{Z}\). Let \(U \sim \mathrm{U}[0,1]\).
    Then it can be shown that
  id: totrans-642
  prefs: []
  type: TYPE_NORMAL
  zh: 设 \(\mathcal{Z}\) 为 \(F_Z(z) \in (0,1)\) 的区间，并假设 \(F_X\) 在 \(\mathcal{Z}\) 上严格递增。设
    \(U \sim \mathrm{U}[0,1]\)。然后可以证明：
- en: \[ \mathbb{P}[F_X^{-1}(U) \leq z] = F_X(z). \]
  id: totrans-643
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbb{P}[F_X^{-1}(U) \leq z] = F_X(z). \]
- en: So take \(F_Z = \Phi\), the CDF of the standard Normal. Then \(Z = \Phi^{-1}(U)\)
    is \(N(0,1)\).
  id: totrans-644
  prefs: []
  type: TYPE_NORMAL
  zh: 所以取 \(F_Z = \Phi\)，标准正态分布的 CDF。那么 \(Z = \Phi^{-1}(U)\) 是 \(N(0,1)\)。
- en: How do we generate a \(N(\mu, \sigma^2)\) variable, for arbitrary \(\mu \in
    \mathbb{R}\) and \(\sigma^2 > 0\)? We use the fact that the linear transformation
    of Gaussian is still Gaussian. In particular, if \(Z \sim N(0,1)\), then
  id: totrans-645
  prefs: []
  type: TYPE_NORMAL
  zh: 我们如何生成一个 \(N(\mu, \sigma^2)\) 变量，对于任意的 \(\mu \in \mathbb{R}\) 和 \(\sigma^2 >
    0\)？我们使用线性变换的 Gaussian 仍然是 Gaussian 的这一事实。特别是，如果 \(Z \sim N(0,1)\)，那么
- en: \[ X = \mu + \sigma Z \]
  id: totrans-646
  prefs: []
  type: TYPE_NORMAL
  zh: \[ X = \mu + \sigma Z \]
- en: is \(N(\mu, \sigma^2)\).
  id: totrans-647
  prefs: []
  type: TYPE_NORMAL
  zh: 是 \(N(\mu, \sigma^2)\)。
- en: '**NUMERICAL CORNER:** In Python, \(\Phi^{-1}\) can be accessed using [`scipy.stats.norm.ppf`](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html).
    We implement this next (with help from ChatGPT).'
  id: totrans-648
  prefs: []
  type: TYPE_NORMAL
  zh: '**NUMERICAL CORNER:** 在 Python 中，\(\Phi^{-1}\) 可以使用 `scipy.stats.norm.ppf`
    访问。[PRE89]。我们接下来实现它（在 ChatGPT 的帮助下）。'
- en: '[PRE87]'
  id: totrans-649
  prefs: []
  type: TYPE_PRE
  zh: '[PRE87]'
- en: We generate 1000 samples and plot the empirical distribution.
  id: totrans-650
  prefs: []
  type: TYPE_NORMAL
  zh: 我们生成 1000 个样本并绘制经验分布。
- en: '[PRE88]'
  id: totrans-651
  prefs: []
  type: TYPE_PRE
  zh: '[PRE88]'
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  id: totrans-652
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格源
    隐藏代码单元格源</summary>
- en: '[PRE89]</details> ![../../_images/648741740d20b45ce65b2b2791d1603ea77bd902d8873c497c1a1d5f0cc41bb6.png](../Images/c4d1f8c3493a1c88b3b5727f55a25bef.png)'
  id: totrans-653
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE89]</details> ![../../_images/648741740d20b45ce65b2b2791d1603ea77bd902d8873c497c1a1d5f0cc41bb6.png](../Images/c4d1f8c3493a1c88b3b5727f55a25bef.png)'
- en: \(\unlhd\)
  id: totrans-654
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: '**CHAT & LEARN** It turns out there is a neat trick to generate *two* independent
    samples from \(N(0,1)\) that does not rely on access to \(\Phi^{-1}\). It is called
    the Box-Muller transform. Ask your favorite AI chatbot about it. Modify our code
    above to implement it. \(\ddagger\)'
  id: totrans-655
  prefs: []
  type: TYPE_NORMAL
  zh: '**CHAT & LEARN** 事实证明，有一种巧妙的方法可以生成两个独立的 \(N(0,1)\) 样本，而不依赖于对 \(\Phi^{-1}\)
    的访问。它被称为 Box-Muller 变换。向您最喜欢的 AI 聊天机器人询问它。修改我们上面的代码以实现它。\(\ddagger\)'
- en: We move on to the multivariate case. We proceed similarly as before. First,
    how do we generate a \(d\)-dimensional Gaussian with mean vector \(\bmu = \mathbf{0}\)
    and identity covariance matrix \(\bSigma = I_{d \times d}\)? Easy – it has \(d\)
    independent components, each of which is standard Normal. So letting \(U_1, \ldots,
    U_d\) be independent uniform \([0,1]\) variables, then
  id: totrans-656
  prefs: []
  type: TYPE_NORMAL
  zh: 我们继续到多元情况。我们像以前一样进行。首先，我们如何生成一个均值向量为 \(\bmu = \mathbf{0}\) 和单位协方差矩阵 \(\bSigma
    = I_{d \times d}\) 的 \(d\) 维 Gaussian？很简单——它有 \(d\) 个独立的分量，每个分量都是标准正态分布。所以让 \(U_1,
    \ldots, U_d\) 是独立的 \([0,1]\) 均匀变量，那么
- en: \[ \mathbf{Z} = (\Phi^{-1}(U_1),\ldots,\Phi^{-1}(U_d)) \]
  id: totrans-657
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{Z} = (\Phi^{-1}(U_1),\ldots,\Phi^{-1}(U_d)) \]
- en: is \(N(\mathbf{0}, I_{d \times d})\).
  id: totrans-658
  prefs: []
  type: TYPE_NORMAL
  zh: 是 \(N(\mathbf{0}, I_{d \times d})\)。
- en: We now seek to generate a multivariate Gaussian with arbitrary mean vector \(\bmu\)
    and positive definite covariance matrix \(\bSigma\). Again, we use a linear transformation
  id: totrans-659
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在试图生成具有任意均值向量 \(\bmu\) 和正定协方差矩阵 \(\bSigma\) 的多元高斯分布。同样，我们使用线性变换
- en: \[ \mathbf{X} = \mathbf{a} + A \mathbf{Z}. \]
  id: totrans-660
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{X} = \mathbf{a} + A \mathbf{Z}. \]
- en: What are the right choices for \(a \in \mathbb{R}^d\) and \(A \in \mathbb{R}^{d
    \times d}\)? We need to match the obtained and desired mean and covariance. We
    start with the mean. By linearity of expectation,
  id: totrans-661
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 \(a \in \mathbb{R}^d\) 和 \(A \in \mathbb{R}^{d \times d}\) 的正确选择是什么？我们需要匹配获得和期望的均值和协方差。我们从均值开始。通过期望的线性，我们得到
- en: \[ \E[\mathbf{X}] = \E[\mathbf{a} + A \mathbf{Z}] = \mathbf{a} + A \,\E[\mathbf{Z}]
    = \mathbf{a}. \]
  id: totrans-662
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \E[\mathbf{X}] = \E[\mathbf{a} + A \mathbf{Z}] = \mathbf{a} + A \,\E[\mathbf{Z}]
    = \mathbf{a}. \]
- en: Hence we pick \(\mathbf{a} := \bmu\).
  id: totrans-663
  prefs: []
  type: TYPE_NORMAL
  zh: 因此我们选择 \(\mathbf{a} := \bmu\)。
- en: As for the covariance, using the *Covariance of a Linear Transformation*, we
    get
  id: totrans-664
  prefs: []
  type: TYPE_NORMAL
  zh: 至于协方差，使用**线性变换的协方差**，我们得到
- en: \[ \cov[\mathbf{X}] = A \,\cov[\mathbf{Z}] A^T = A A^T. \]
  id: totrans-665
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \cov[\mathbf{X}] = A \,\cov[\mathbf{Z}] A^T = A A^T. \]
- en: 'Now we have a problem: what is a matrix \(A\) such that'
  id: totrans-666
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有一个问题：什么是一个矩阵 \(A\)，使得
- en: \[ A A^T = \bSigma? \]
  id: totrans-667
  prefs: []
  type: TYPE_NORMAL
  zh: \[ A A^T = \bSigma? \]
- en: In some sense, we are looking for a sort of “square root” of the covariance
    matrix. There are several ways of doing this. The Cholesky decomposition is one
    of them. We return to generating samples from \(N(\bmu, \bSigma)\) after introducing
    it.
  id: totrans-668
  prefs: []
  type: TYPE_NORMAL
  zh: 在某种意义上，我们正在寻找协方差矩阵的某种“平方根”。有几种方法可以做到这一点。Cholesky分解是其中之一。在介绍它之后，我们将回到从 \(N(\bmu,
    \bSigma)\) 中生成样本。
- en: '**A matrix factorization** Our key linear-algebraic result of this section
    is the following. The matrix factorization in the next theorem is called a Cholesky
    decomposition. It has many [applications](https://en.wikipedia.org/wiki/Cholesky_decomposition#Applications).'
  id: totrans-669
  prefs: []
  type: TYPE_NORMAL
  zh: '**矩阵分解** 本节的关键线性代数结果是以下内容。下一定理中的矩阵分解称为Cholesky分解。它有许多[应用](https://en.wikipedia.org/wiki/Cholesky_decomposition#Applications)。'
- en: '**THEOREM** **(Cholesky Decomposition)** Any positive definite matrix \(B \in
    \mathbb{R}^{n \times n}\) can be factorized uniquely as'
  id: totrans-670
  prefs: []
  type: TYPE_NORMAL
  zh: '**定理** **(Cholesky分解)** 任何正定矩阵 \(B \in \mathbb{R}^{n \times n}\) 可以唯一分解为'
- en: \[ B = L L^T \]
  id: totrans-671
  prefs: []
  type: TYPE_NORMAL
  zh: \[ B = L L^T \]
- en: where \(L \in \mathbb{R}^{n \times n}\) is a lower triangular matrix with positive
    entries on the diagonal. \(\sharp\)
  id: totrans-672
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(L \in \mathbb{R}^{n \times n}\) 是一个对角线有正元素的 \(n \times n\) 的下三角矩阵。 \(\sharp\)
- en: 'The proof is provided below. It is based on deriving an algorithm for computing
    the Cholesky decomposition: we grow \(L\) starting from its top-left corner by
    successively computing its next row based on the previously constructed submatrix.
    Note that, because \(L\) is lower triangular, it suffices to compute its elements
    on and below the diagonal. We first give the algorithm, then establish that it
    is well-defined.'
  id: totrans-673
  prefs: []
  type: TYPE_NORMAL
  zh: 证明如下。它基于推导出计算Cholesky分解的算法：我们从左上角开始逐步计算下一行，基于之前构造的子矩阵。注意，因为 \(L\) 是下三角矩阵，所以我们只需要计算其对角线及其以下的元素。我们首先给出算法，然后证明它是良定义的。
- en: '**Figure:** Access pattern ([Source](https://en.wikipedia.org/wiki/File:Chol.gif))'
  id: totrans-674
  prefs: []
  type: TYPE_NORMAL
  zh: '**图示:** 访问模式 ([来源](https://en.wikipedia.org/wiki/File:Chol.gif))'
- en: '![Access pattern](../Images/20de5b823040500b0d04511959484e97.png)'
  id: totrans-675
  prefs: []
  type: TYPE_IMG
  zh: '![访问模式](../Images/20de5b823040500b0d04511959484e97.png)'
- en: \(\bowtie\)
  id: totrans-676
  prefs: []
  type: TYPE_NORMAL
  zh: \(\bowtie\)
- en: '**EXAMPLE:** Before proceeeding with the general method, we give a small example
    to provide some intuition as to how it operates. We need a positive definite matrix.
    Consider the matrix'
  id: totrans-677
  prefs: []
  type: TYPE_NORMAL
  zh: '**EXAMPLE:** 在介绍通用方法之前，我们先给出一个小例子，以提供一些关于其操作直觉。我们需要一个正定矩阵。考虑以下矩阵'
- en: \[\begin{split} A = \begin{pmatrix} 1 & 2 & 1\\ 0 & -2 & 1\\ 0 & 0 & 1\\ 0 &
    0 & 0 \end{pmatrix}. \end{split}\]
  id: totrans-678
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A = \begin{pmatrix} 1 & 2 & 1\\ 0 & -2 & 1\\ 0 & 0 & 1\\ 0 &
    0 & 0 \end{pmatrix}. \end{split}\]
- en: It has full column rank (why?). Recall that, in that case, the \(B = A^T A\)
    is positive definite.
  id: totrans-679
  prefs: []
  type: TYPE_NORMAL
  zh: 它具有满列秩（为什么？）。回想一下，在这种情况下，\(B = A^T A\) 是正定的。
- en: That is, the matrix
  id: totrans-680
  prefs: []
  type: TYPE_NORMAL
  zh: 那就是矩阵
- en: \[\begin{split} B = A^T A = \begin{pmatrix} 1 & 2 & 1\\ 2 & 8 & 0\\ 1 & 0 &
    3 \end{pmatrix} \end{split}\]
  id: totrans-681
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} B = A^T A = \begin{pmatrix} 1 & 2 & 1\\ 2 & 8 & 0\\ 1 & 0 &
    3 \end{pmatrix} \end{split}\]
- en: is positive definite.
  id: totrans-682
  prefs: []
  type: TYPE_NORMAL
  zh: 是正定的。
- en: Let \(L = (\ell_{i,j})_{i,j=1}^3\) be lower triangular. We seek to solve \(L
    L^T = B\) for the nonzero entries of \(L\). Observe that
  id: totrans-683
  prefs: []
  type: TYPE_NORMAL
  zh: 设 \(L = (\ell_{i,j})_{i,j=1}^3\) 为下三角矩阵。我们试图求解 \(L L^T = B\) 对于 \(L\) 的非零项。观察如下
- en: \[\begin{split} \begin{pmatrix} \ell_{1,1} & 0 & 0\\ \ell_{2,1} & \ell_{2,2}
    & 0\\ \ell_{3,1} & \ell_{3,2} & \ell_{3,3} \end{pmatrix} \begin{pmatrix} \ell_{1,1}
    & \ell_{2,1} & \ell_{3,1}\\ 0 & \ell_{2,2} & \ell_{3,2}\\ 0 & 0 & \ell_{3,3} \end{pmatrix}
    = \begin{pmatrix} \ell_{1,1}^2 & \ell_{1,1}\ell_{2,1} & \ell_{1,1}\ell_{3,1}\\
    \ell_{1,1}\ell_{2,1} & \ell_{2,1}^2 + \ell_{2,2}^2 & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2}\\
    \ell_{1,1}\ell_{3,1} & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2} & \ell_{3,1}^2
    + \ell_{3,2}^2 + \ell_{3,3} \end{pmatrix}. \end{split}\]
  id: totrans-684
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} \ell_{1,1} & 0 & 0\\ \ell_{2,1} & \ell_{2,2}
    & 0\\ \ell_{3,1} & \ell_{3,2} & \ell_{3,3} \end{pmatrix} \begin{pmatrix} \ell_{1,1}
    & \ell_{2,1} & \ell_{3,1}\\ 0 & \ell_{2,2} & \ell_{3,2}\\ 0 & 0 & \ell_{3,3} \end{pmatrix}
    = \begin{pmatrix} \ell_{1,1}^2 & \ell_{1,1}\ell_{2,1} & \ell_{1,1}\ell_{3,1}\\
    \ell_{1,1}\ell_{2,1} & \ell_{2,1}^2 + \ell_{2,2}^2 & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2}\\
    \ell_{1,1}\ell_{3,1} & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2} & \ell_{3,1}^2
    + \ell_{3,2}^2 + \ell_{3,3} \end{pmatrix}. \end{split}\]
- en: The system
  id: totrans-685
  prefs: []
  type: TYPE_NORMAL
  zh: 该系统
- en: \[\begin{split} \begin{pmatrix} \ell_{1,1}^2 & \ell_{1,1}\ell_{2,1} & \ell_{1,1}\ell_{3,1}\\
    \ell_{1,1}\ell_{2,1} & \ell_{2,1}^2 + \ell_{2,2}^2 & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2}\\
    \ell_{1,1}\ell_{3,1} & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2} & \ell_{3,1}^2
    + \ell_{3,2}^2 + \ell_{3,3}^2 \end{pmatrix} = \begin{pmatrix} 1 & 2 & 1\\ 2 &
    8 & 0\\ 1 & 0 & 3 \end{pmatrix} \end{split}\]
  id: totrans-686
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} \ell_{1,1}^2 & \ell_{1,1}\ell_{2,1} & \ell_{1,1}\ell_{3,1}\\
    \ell_{1,1}\ell_{2,1} & \ell_{2,1}^2 + \ell_{2,2}^2 & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2}\\
    \ell_{1,1}\ell_{3,1} & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2} & \ell_{3,1}^2
    + \ell_{3,2}^2 + \ell_{3,3}^2 \end{pmatrix} = \begin{pmatrix} 1 & 2 & 1\\ 2 &
    8 & 0\\ 1 & 0 & 3 \end{pmatrix} \end{split}\]
- en: turns out to be fairly simple to solve.
  id: totrans-687
  prefs: []
  type: TYPE_NORMAL
  zh: 解决起来相当简单。
- en: From the first entry, we get \(\ell_{1,1} = 1\) (where we took the positive
    solution to \(\ell_{1,1}^2 = 1\)).
  id: totrans-688
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从第一个元素，我们得到 \(\ell_{1,1} = 1\)（我们取了 \(\ell_{1,1}^2 = 1\) 的正解）。
- en: Given that \(\ell_{1,1}\) is known, entry \(\ell_{2,1}\) is determined from
    \(\ell_{1,1}\ell_{2,1} =2\) in the first entry of the second row. That is, \(\ell_{2,1}
    =2\). Then the second entry of the second row gives \(\ell_{2,2}\) through \(\ell_{2,1}^2
    + \ell_{2,2}^2 = 8\). So \(\ell_{2,2} = 2\) (again we take the positive solution).
  id: totrans-689
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 已知 \(\ell_{1,1}\) 后，从第二行的第一个元素 \(\ell_{1,1}\ell_{2,1} =2\) 可以确定 \(\ell_{2,1}\)。即，\(\ell_{2,1}
    =2\)。然后第二行的第二个元素通过 \(\ell_{2,1}^2 + \ell_{2,2}^2 = 8\) 给出 \(\ell_{2,2}\)。所以 \(\ell_{2,2}
    = 2\)（我们再次取正解）。
- en: We move to the third row. The first entry gives \(\ell_{3,1} = 1\), the second
    entry gives \(\ell_{3,2} = -1\) and finally the third entry leads to \(\ell_{3,3}
    = 1\).
  id: totrans-690
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们转向第三行。第一个元素给出 \(\ell_{3,1} = 1\)，第二个元素给出 \(\ell_{3,2} = -1\)，最后第三个元素导致 \(\ell_{3,3}
    = 1\)。
- en: Hence we have
  id: totrans-691
  prefs: []
  type: TYPE_NORMAL
  zh: 因此我们有
- en: \[\begin{split} L = \begin{pmatrix} \ell_{1,1} & 0 & 0\\ \ell_{2,1} & \ell_{2,2}
    & 0\\ \ell_{3,1} & \ell_{3,2} & \ell_{3,3} \end{pmatrix} = \begin{pmatrix} 1 &
    0 & 0\\ 2 & 2 & 0\\ 1 & -1 & 1 \end{pmatrix}. \end{split}\]
  id: totrans-692
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} L = \begin{pmatrix} \ell_{1,1} & 0 & 0\\ \ell_{2,1} & \ell_{2,2}
    & 0\\ \ell_{3,1} & \ell_{3,2} & \ell_{3,3} \end{pmatrix} = \begin{pmatrix} 1 &
    0 & 0\\ 2 & 2 & 0\\ 1 & -1 & 1 \end{pmatrix}. \end{split}\]
- en: \(\lhd\)
  id: totrans-693
  prefs: []
  type: TYPE_NORMAL
  zh: \(\lhd\)
- en: To detail the computation of the Cholesky decomposition \(L L^T\) of \(B\),
    we will need some notation. Write \(B = (b_{i,j})_{i,j=1}^n\) and \(L = (\ell_{i,j})_{i,j=1}^n\).
    Let \(L_{(k)} = (\ell_{i,j})_{i,j=1}^k\) be the first \(k\) rows and columns of
    \(L\), let \(\bflambda_{(k)}^T = (\ell_{k,1},\ldots,\ell_{k,k-1})\) be the row
    vector corresponding to the first \(k-1\) entries of row \(k\) of \(L\), and let
    \(\bfbeta_{(k)}^T = (b_{k,1},\ldots,b_{k,k-1})\) be the row vector corresponding
    to the first \(k-1\) entries of row \(k\) of \(B\).
  id: totrans-694
  prefs: []
  type: TYPE_NORMAL
  zh: 为了详细说明 \(B\) 的 Cholesky 分解 \(L L^T\) 的计算，我们需要一些符号。将 \(B\) 写成 \((b_{i,j})_{i,j=1}^n\)，将
    \(L\) 写成 \((\ell_{i,j})_{i,j=1}^n\)。令 \(L_{(k)} = (\ell_{i,j})_{i,j=1}^k\) 为 \(L\)
    的前 \(k\) 行和列，令 \(\bflambda_{(k)}^T = (\ell_{k,1},\ldots,\ell_{k,k-1})\) 为 \(L\)
    的第 \(k\) 行的前 \(k-1\) 个元素的行向量，并令 \(\bfbeta_{(k)}^T = (b_{k,1},\ldots,b_{k,k-1})\)
    为 \(B\) 的第 \(k\) 行的前 \(k-1\) 个元素的行向量。
- en: The strategy is to compute \(L_{(1)}\), then \(L_{(2)}\), then \(L_{(3)}\) and
    so on. With the notation above, \(L_{(j)}\) can be written in block form as
  id: totrans-695
  prefs: []
  type: TYPE_NORMAL
  zh: 策略是先计算 \(L_{(1)}\)，然后 \(L_{(2)}\)，接着 \(L_{(3)}\) 等等。根据上述符号，\(L_{(j)}\) 可以写成块形式。
- en: \[\begin{split} L_{(j)} = \begin{pmatrix} L_{(j-1)} & \mathbf{0}\\ \bflambda_{(j)}^T
    & \ell_{j,j}. \end{pmatrix} \end{split}\]
  id: totrans-696
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} L_{(j)} = \begin{pmatrix} L_{(j-1)} & \mathbf{0}\\ \bflambda_{(j)}^T
    & \ell_{j,j}. \end{pmatrix} \end{split}\]
- en: Hence, once \(L_{(j-1)}\) is known, in order to compute \(L_{(j)}\) one only
    needs \(\bflambda_{(j)}\) and \(\ell_{j,j}\). We show next that they satisfy easily
    solvable systems of equations.
  id: totrans-697
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，一旦 \(L_{(j-1)}\) 已知，为了计算 \(L_{(j)}\)，只需要 \(\bflambda_{(j)}\) 和 \(\ell_{j,j}\)。接下来我们将展示它们满足容易解决的方程组。
- en: We first note that the \((1,1)\) entry of the matrix equation \(L L^T = B\)
    implies that
  id: totrans-698
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先注意到矩阵方程 \(L L^T = B\) 的 \((1,1)\) 项意味着
- en: \[ \ell_{1,1}^2 = b_{1,1}. \]
  id: totrans-699
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \ell_{1,1}^2 = b_{1,1}. \]
- en: So we set
  id: totrans-700
  prefs: []
  type: TYPE_NORMAL
  zh: 因此我们设定
- en: \[ L_{(1)} = \ell_{1,1} = \sqrt{b_{1,1}}. \]
  id: totrans-701
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L_{(1)} = \ell_{1,1} = \sqrt{b_{1,1}}. \]
- en: 'For this step to be well-defined, it needs to be the case that \(b_{1,1} >
    0\). It is easy to see that it follows from the positive definiteness of \(B\):'
  id: totrans-702
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使这一步定义良好，需要满足 \(b_{1,1} > 0\)。很容易看出，这遵循 \(B\) 的正定性：
- en: \[ 0 < \langle \mathbf{e}_1, B \mathbf{e}_1\rangle = \mathbf{e}_1^T B_{\cdot,1}
    = b_{1,1}. \]
  id: totrans-703
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 0 < \langle \mathbf{e}_1, B \mathbf{e}_1\rangle = \mathbf{e}_1^T B_{\cdot,1}
    = b_{1,1}. \]
- en: Proceeding by induction, assume \(L_{(j-1)}\) has been constructed. The first
    \(j-1\) elements of the \(j\)-th row of the matrix equation \(L L^T = B\) translate
    into
  id: totrans-704
  prefs: []
  type: TYPE_NORMAL
  zh: 通过归纳法进行，假设 \(L_{(j-1)}\) 已经构建。矩阵方程 \(L L^T = B\) 的第 \(j\) 行的前 \(j-1\) 个元素转化为
- en: \[ L_{j,\cdot} (L^T)_{\cdot,1:j-1} = \bflambda_{(j)}^T L_{(j-1)}^T = \bfbeta_{(j)}^T,
    \]
  id: totrans-705
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L_{j,\cdot} (L^T)_{\cdot,1:j-1} = \bflambda_{(j)}^T L_{(j-1)}^T = \bfbeta_{(j)}^T,
    \]
- en: where \((L^T)_{\cdot,1:j-1}\) denotes the first \(j-1\) columns of \(L^T\).
    In the first equality above, we used the fact that \(L^T\) is upper triangular.
    Taking a transpose, the resulting linear system of equations
  id: totrans-706
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \((L^T)_{\cdot,1:j-1}\) 表示 \(L^T\) 的前 \(j-1\) 列。在上面的第一个等式中，我们使用了 \(L^T\)
    是上三角的事实。取转置，得到的线性方程组
- en: \[ L_{(j-1)} \bflambda_{(j)} = \bfbeta_{(j)} \]
  id: totrans-707
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L_{(j-1)} \bflambda_{(j)} = \bfbeta_{(j)} \]
- en: can be solved by forward substitution (since \(\bfbeta_{(j)}\) is part of the
    input and \(L_{(j-1)}\) was previously computed). The fact that this system has
    a unique solution (more specifically, that the diagonal entries of \(L_{(j-1)}\)
    are strictly positive) is established in the proof of the *Cholesky Decomposition
    Theorem*.
  id: totrans-708
  prefs: []
  type: TYPE_NORMAL
  zh: 可以通过前向替换（因为 \(\bfbeta_{(j)}\) 是输入的一部分，且 \(L_{(j-1)}\) 已先前计算）来解决。这个系统有唯一解（更具体地说，\(L_{(j-1)}\)
    的对角线元素是严格正的）的事实已在 *Cholesky 分解定理* 的证明中确立。
- en: The \((j,j)\)-th entry of the matrix equation \(L L^T = B\) translates into
  id: totrans-709
  prefs: []
  type: TYPE_NORMAL
  zh: 矩阵方程 \(L L^T = B\) 的 \((j,j)\) 个元素转化为
- en: \[ L_{j,\cdot} (L^T)_{\cdot,j} = \sum_{k=1}^j \ell_{j,k}^2 = b_{j,j}, \]
  id: totrans-710
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L_{j,\cdot} (L^T)_{\cdot,j} = \sum_{k=1}^j \ell_{j,k}^2 = b_{j,j}, \]
- en: where again we used the fact that \(L^T\) is upper triangular. Since \(\ell_{j,1},
    \ldots, \ell_{j,j-1}\) are the elements of \(\bflambda_{(j)}\), they have already
    been determined. So we can set
  id: totrans-711
  prefs: []
  type: TYPE_NORMAL
  zh: 其中再次使用了 \(L^T\) 是上三角的事实。由于 \(\ell_{j,1}, \ldots, \ell_{j,j-1}\) 是 \(\bflambda_{(j)}\)
    的元素，它们已经确定。因此我们可以设定
- en: \[ \ell_{j,j} = \sqrt{b_{j,j} - \sum_{k=1}^{j-1} \ell_{j,k}^2}. \]
  id: totrans-712
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \ell_{j,j} = \sqrt{b_{j,j} - \sum_{k=1}^{j-1} \ell_{j,k}^2}. \]
- en: The fact that we are taking the square root of a positive quantity is established
    in the proof of the *Cholesky Decomposition Theorem*. Finally, from \(L_{(j-1)}\),
    \(\bflambda_{(j)}\), and \(\ell_{j,j}\), we construct \(L_{(j)}\).
  id: totrans-713
  prefs: []
  type: TYPE_NORMAL
  zh: 我们取正数平方根的事实已在 *Cholesky 分解定理* 的证明中确立。最后，从 \(L_{(j-1)}\)，\(\bflambda_{(j)}\)
    和 \(\ell_{j,j}\) 中，我们构建 \(L_{(j)}\)。
- en: '**NUMERICAL CORNER:** We implement the algorithm above. In our naive implementation,
    we assume that \(B\) is positive definite, and therefore that all steps are well-defined.'
  id: totrans-714
  prefs: []
  type: TYPE_NORMAL
  zh: '**数值角:** 我们实现了上述算法。在我们的朴素实现中，我们假设 \(B\) 是正定的，因此所有步骤都是定义良好的。'
- en: '[PRE90]'
  id: totrans-715
  prefs: []
  type: TYPE_PRE
  zh: '[PRE90]'
- en: Here is a simple example.
  id: totrans-716
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一个简单的例子。
- en: '[PRE91]'
  id: totrans-717
  prefs: []
  type: TYPE_PRE
  zh: '[PRE91]'
- en: '[PRE92]'
  id: totrans-718
  prefs: []
  type: TYPE_PRE
  zh: '[PRE92]'
- en: '[PRE93]'
  id: totrans-719
  prefs: []
  type: TYPE_PRE
  zh: '[PRE93]'
- en: '[PRE94]'
  id: totrans-720
  prefs: []
  type: TYPE_PRE
  zh: '[PRE94]'
- en: We can check that it produces the right factorization.
  id: totrans-721
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以检查它是否产生正确的分解。
- en: '[PRE95]'
  id: totrans-722
  prefs: []
  type: TYPE_PRE
  zh: '[PRE95]'
- en: '[PRE96]'
  id: totrans-723
  prefs: []
  type: TYPE_PRE
  zh: '[PRE96]'
- en: \(\unlhd\)
  id: totrans-724
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: '**Proof of Cholesky decomposition theorem** We give a proof of the *Cholesky
    Decomposition Theorem*.'
  id: totrans-725
  prefs: []
  type: TYPE_NORMAL
  zh: '**Cholesky 分解定理的证明** 我们给出 *Cholesky 分解定理* 的证明。'
- en: '*Proof idea:* Assuming by induction that the upper-left corner of the matrix
    \(B\) has a Cholesky decomposition, one finds equations for the remaining row
    that can be solved uniquely by the properties established in the previous subsection.'
  id: totrans-726
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明思路:* 假设通过归纳法，矩阵 \(B\) 的左上角具有 Cholesky 分解，可以找到剩余行的方程，这些方程可以通过前一小节中建立的属性唯一解决。'
- en: '*Proof:* If \(n=1\), we have shown previously that \(b_{1,1} > 0\), and hence
    we can take \(L = [\ell_{1,1}]\) where \(\ell_{1,1} = \sqrt{b_{1,1}}\). Assuming
    the result holds for positive definite matrices in \(\mathbb{R}^{(n-1) \times
    (n-1)}\), we first re-write \(B = L L^T\) in block form'
  id: totrans-727
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明:* 如果 \(n=1\)，我们之前已经证明 \(b_{1,1} > 0\)，因此我们可以取 \(L = [\ell_{1,1}]\) 其中 \(\ell_{1,1}
    = \sqrt{b_{1,1}}\)。假设对于 \(\mathbb{R}^{(n-1) \times (n-1)}\) 中的正定矩阵，结果成立，我们首先将
    \(B = L L^T\) 重写为分块形式'
- en: \[\begin{split} \begin{pmatrix} B_{11} & \bfbeta_{12}\\ \bfbeta_{12}^T & \beta_{22}
    \end{pmatrix} = \begin{pmatrix} \Lambda_{11} & \mathbf{0}\\ \bflambda_{12}^T &
    \lambda_{22} \end{pmatrix} \begin{pmatrix} \Lambda_{11}^T & \bflambda_{12}\\ \mathbf{0}^T
    & \lambda_{22} \end{pmatrix} \end{split}\]
  id: totrans-728
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} B_{11} & \bfbeta_{12}\\ \bfbeta_{12}^T & \beta_{22}
    \end{pmatrix} = \begin{pmatrix} \Lambda_{11} & \mathbf{0}\\ \bflambda_{12}^T &
    \lambda_{22} \end{pmatrix} \begin{pmatrix} \Lambda_{11}^T & \bflambda_{12}\\ \mathbf{0}^T
    & \lambda_{22} \end{pmatrix} \end{split}\]
- en: where \(B_{11}, \Lambda_{11} \in \mathbb{R}^{n-1 \times n-1}\), \(\bfbeta_{12},
    \bflambda_{12} \in \mathbb{R}^{n-1}\) and \(\beta_{22}, \lambda_{22} \in \mathbb{R}\).
    By block matrix algebra, we get the system
  id: totrans-729
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(B_{11}, \Lambda_{11} \in \mathbb{R}^{n-1 \times n-1}\)，\(\bfbeta_{12},
    \bflambda_{12} \in \mathbb{R}^{n-1}\) 和 \(\beta_{22}, \lambda_{22} \in \mathbb{R}\)。通过分块矩阵代数，我们得到以下系统
- en: \[\begin{split} B_{11} = \Lambda_{11} \Lambda_{11}^T\\ \bfbeta_{12} = \Lambda_{11}
    \bflambda_{12}\\ \beta_{22} = \bflambda_{12}^T \bflambda_{12} + \lambda_{22}^2.
    \end{split}\]
  id: totrans-730
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} B_{11} = \Lambda_{11} \Lambda_{11}^T\\ \bfbeta_{12} = \Lambda_{11}
    \bflambda_{12}\\ \beta_{22} = \bflambda_{12}^T \bflambda_{12} + \lambda_{22}^2.
    \end{split}\]
- en: By the *Principal Submatrices Lemma*, the principal submatrix \(B_{11}\) is
    positive definite. Hence, by induction, there is a unique lower-triangular matrix
    \(\Lambda_{11}\) with positive diagonal elements satisfying the first equation.
    We can then obtain \(\bfbeta_{12}\) from the second equation by forward substitution.
    And finally we get
  id: totrans-731
  prefs: []
  type: TYPE_NORMAL
  zh: 通过**主子矩阵引理**，主子矩阵 \(B_{11}\) 是正定的。因此，通过归纳法，存在一个唯一的下三角矩阵 \(\Lambda_{11}\) 具有正的对角元素，满足第一个方程。然后我们可以通过前向替换从第二个方程中得到
    \(\bfbeta_{12}\)。最后我们得到
- en: \[ \lambda_{22} = \sqrt{\beta_{22} - \bflambda_{12}^T \bflambda_{12}}. \]
  id: totrans-732
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \lambda_{22} = \sqrt{\beta_{22} - \bflambda_{12}^T \bflambda_{12}}. \]
- en: 'We do have to check that the square root above exists. That is, we need to
    argue that the expression inside the square root is non-negative. In fact, for
    the claim to go through, we need it to be strictly positive. We notice that the
    expression inside the square root is in fact the Schur complement of the block
    \(B_{11}\):'
  id: totrans-733
  prefs: []
  type: TYPE_NORMAL
  zh: 我们确实需要检查上述平方根的存在性。也就是说，我们需要证明平方根内的表达式是非负的。实际上，为了使这个断言成立，我们需要它严格为正。我们注意到平方根内的表达式实际上是分块
    \(B_{11}\) 的 Schur 补：
- en: \[\begin{align*} \beta_{22} - \bflambda_{12}^T \bflambda_{12} &= \beta_{22}
    - (\Lambda_{11}^{-1} \bfbeta_{12})^T (\Lambda_{11}^{-1} \bfbeta_{12})\\ &= \beta_{22}
    - \bfbeta_{12}^T (\Lambda_{11}^{-1})^T \Lambda_{11}^{-1} \bfbeta_{12}\\ &= \beta_{22}
    - \bfbeta_{12}^T (\Lambda_{11} \Lambda_{11}^T)^{-1} \bfbeta_{12}\\ &= \beta_{22}
    - \bfbeta_{12}^T (B_{11})^{-1} \bfbeta_{12} \end{align*}\]
  id: totrans-734
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \beta_{22} - \bflambda_{12}^T \bflambda_{12} &= \beta_{22}
    - (\Lambda_{11}^{-1} \bfbeta_{12})^T (\Lambda_{11}^{-1} \bfbeta_{12})\\ &= \beta_{22}
    - \bfbeta_{12}^T (\Lambda_{11}^{-1})^T \Lambda_{11}^{-1} \bfbeta_{12}\\ &= \beta_{22}
    - \bfbeta_{12}^T (\Lambda_{11} \Lambda_{11}^T)^{-1} \bfbeta_{12}\\ &= \beta_{22}
    - \bfbeta_{12}^T (B_{11})^{-1} \bfbeta_{12} \end{align*}\]
- en: where we used the equation \(\bfbeta_{12} = \Lambda_{11} \bflambda_{12}\) on
    the first line, the identities \((Q W)^{-1} = W^{-1} Q^{-1}\) and \((Q^T)^{-1}
    = (Q^{-1})^T\) (see the exercise below) on the third line and the equation \(B_{11}
    = \Lambda_{11} \Lambda_{11}^T\) on the fourth line. By the *Schur Complement Lemma*,
    the Schur complement is positive definite. Because it is a scalar in this case,
    it is strictly positive (prove it!), which concludes the proof. \(\square\)
  id: totrans-735
  prefs: []
  type: TYPE_NORMAL
  zh: 其中我们在第一行使用了方程 \(\bfbeta_{12} = \Lambda_{11} \bflambda_{12}\)，在第三行使用了恒等式 \((Q
    W)^{-1} = W^{-1} Q^{-1}\) 和 \((Q^T)^{-1} = (Q^{-1})^T\)（见下面的练习），在第四行使用了方程 \(B_{11}
    = \Lambda_{11} \Lambda_{11}^T\)。根据**Schur 补引理**，Schur 补是正定的。因为在这种情况下它是一个标量，所以它是严格正的（证明它！），这完成了证明。
    \(\square\)
- en: '**Back to multivariate Gaussians** Returning to our motivation, we can generate
    samples from a \(N(\bmu, \bSigma)\) by first generating'
  id: totrans-736
  prefs: []
  type: TYPE_NORMAL
  zh: '**回到多元高斯分布** 回到我们的动机，我们可以通过首先生成'
- en: \[ \mathbf{Z} = (\Phi^{-1}(U_1),\ldots,\Phi^{-1}(U_d)) \]
  id: totrans-737
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{Z} = (\Phi^{-1}(U_1),\ldots,\Phi^{-1}(U_d)) \]
- en: where \(U_1, \ldots, U_d\) are independent uniform \([0,1]\) variables, then
    setting
  id: totrans-738
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(U_1, \ldots, U_d\) 是独立的均匀 \([0,1]\) 变量，然后设置
- en: \[ \mathbf{X} = \bmu + L \mathbf{Z}, \]
  id: totrans-739
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{X} = \bmu + L \mathbf{Z}, \]
- en: where \(\bSigma = L L^T\) is a Cholesky decomposition of \(\bSigma\).
  id: totrans-740
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(\bSigma = L L^T\) 是 \(\bSigma\) 的 Cholesky 分解。
- en: '**NUMERICAL CORNER:** We implement this method.'
  id: totrans-741
  prefs: []
  type: TYPE_NORMAL
  zh: '**数值角**: 我们实现了这种方法。'
- en: '[PRE97]'
  id: totrans-742
  prefs: []
  type: TYPE_PRE
  zh: '[PRE97]'
- en: We generate some samples as an example.
  id: totrans-743
  prefs: []
  type: TYPE_NORMAL
  zh: 我们生成一些样本作为示例。
- en: '[PRE98]'
  id: totrans-744
  prefs: []
  type: TYPE_PRE
  zh: '[PRE98]'
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  id: totrans-745
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格源代码
    隐藏代码单元格源代码</summary>
- en: '[PRE99]</details>'
  id: totrans-746
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE99]</details>'
- en: '[PRE100]'
  id: totrans-747
  prefs: []
  type: TYPE_PRE
  zh: '[PRE100]'
- en: \(\unlhd\)
  id: totrans-748
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: '**Using a Cholesky decomposition to solve the least squares problem** Another
    application of the Cholesky decomposition is to solving the least squares problem.
    In this section, we restrict ourselves to the case where \(A \in \mathbb{R}^{n\times
    m}\) has full column rank. By the *Least Squares and Positive Semidefiniteness
    Lemma*, we then have that \(A^T A\) is positive definite. By the *Cholesky Decomposition
    Theorem*, we can factorize this matrix as \(A^T A = L L^T\) where \(L\) is lower
    triangular with positive diagonal elements. The normal equations then reduce to'
  id: totrans-749
  prefs: []
  type: TYPE_NORMAL
  zh: '**使用Cholesky分解求解最小二乘问题** Cholesky分解的另一个应用是求解最小二乘问题。在本节中，我们限制 \(A \in \mathbb{R}^{n\times
    m}\) 具有满列秩的情况。根据**最小二乘与正半定引理**，我们随后有 \(A^T A\) 是正定的。根据**Cholesky分解定理**，我们可以将这个矩阵分解为
    \(A^T A = L L^T\)，其中 \(L\) 是下三角矩阵，对角线元素为正。然后正则方程简化为'
- en: \[ L L^T \mathbf{x} = A^T \mathbf{b}. \]
  id: totrans-750
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L L^T \mathbf{x} = A^T \mathbf{b}. \]
- en: This system can be solved in two steps. We first obtain the solution to
  id: totrans-751
  prefs: []
  type: TYPE_NORMAL
  zh: 这个系统可以通过两个步骤解决。我们首先获得以下方程的解
- en: \[ L \mathbf{z} = A^T \mathbf{b} \]
  id: totrans-752
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L \mathbf{z} = A^T \mathbf{b} \]
- en: by forward substitution. Then we obtain the solution to
  id: totrans-753
  prefs: []
  type: TYPE_NORMAL
  zh: 通过前向替换。然后我们获得以下方程的解
- en: \[ L^T \mathbf{x} = \mathbf{z} \]
  id: totrans-754
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L^T \mathbf{x} = \mathbf{z} \]
- en: by back-substitution. Note that \(L^T\) is indeed an upper triangular matrix.
  id: totrans-755
  prefs: []
  type: TYPE_NORMAL
  zh: 通过回代。注意 \(L^T\) 确实是一个上三角矩阵。
- en: '**NUMERICAL CORNER:** We implement this algorithm below. In our naive implementation,
    we assume that \(A\) has full column rank, and therefore that all steps are well-defined.'
  id: totrans-756
  prefs: []
  type: TYPE_NORMAL
  zh: '**数值角:** 我们在下面实现此算法。在我们的朴素实现中，我们假设 \(A\) 具有满列秩，因此所有步骤都是定义良好的。'
- en: '[PRE101]'
  id: totrans-757
  prefs: []
  type: TYPE_PRE
  zh: '[PRE101]'
- en: \(\unlhd\)
  id: totrans-758
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: Other applications of the Cholesky decomposition are briefly described [here](https://en.wikipedia.org/wiki/Cholesky_decomposition#Applications).
  id: totrans-759
  prefs: []
  type: TYPE_NORMAL
  zh: Cholesky分解的其他应用简要描述[在此](https://en.wikipedia.org/wiki/Cholesky_decomposition#Applications)。
- en: 6.7.2.1\. Sentiment analysis[#](#sentiment-analysis "Link to this heading")
  id: totrans-760
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.2.1\. 情感分析[#](#sentiment-analysis "链接到这个标题")
- en: 'As an application of the Naive Bayes model, we consider the task of sentiment
    analysis, which is a classification problem. We use a dataset available [here](https://www.kaggle.com/crowdflower/twitter-airline-sentiment).
    Quoting from there:'
  id: totrans-761
  prefs: []
  type: TYPE_NORMAL
  zh: 作为朴素贝叶斯模型的应用，我们考虑情感分析的任务，这是一个分类问题。我们使用可在此[获取](https://www.kaggle.com/crowdflower/twitter-airline-sentiment)的数据集。引用如下：
- en: A sentiment analysis job about the problems of each major U.S. airline. Twitter
    data was scraped from February of 2015 and contributors were asked to first classify
    positive, negative, and neutral tweets, followed by categorizing negative reasons
    (such as “late flight” or “rude service”).
  id: totrans-762
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 关于美国各大航空公司问题的情感分析工作。从2015年2月开始抓取Twitter数据，并要求贡献者首先对正面、负面和中立推文进行分类，然后对负面原因（如“晚班”或“粗鲁的服务”）进行分类。
- en: We first load a cleaned-up version of the data and look at its summary.
  id: totrans-763
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先加载一个清理后的数据版本，并查看其摘要。
- en: '[PRE102]'
  id: totrans-764
  prefs: []
  type: TYPE_PRE
  zh: '[PRE102]'
- en: '|  | time | user | sentiment | text |'
  id: totrans-765
  prefs: []
  type: TYPE_TB
  zh: '|  | 时间 | 用户 | 情感 | 文本 |'
- en: '| --- | --- | --- | --- | --- |'
  id: totrans-766
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- |'
- en: '| 0 | 2/24/15 11:35 | cairdin | neutral | @VirginAmerica What @dhepburn said.
    |'
  id: totrans-767
  prefs: []
  type: TYPE_TB
  zh: '| 0 | 2/24/15 11:35 | cairdin | 中立 | @VirginAmerica What @dhepburn said. |'
- en: '| 1 | 2/24/15 11:15 | jnardino | positive | @VirginAmerica plus you''ve added
    commercials t... |'
  id: totrans-768
  prefs: []
  type: TYPE_TB
  zh: '| 1 | 2/24/15 11:15 | jnardino | 正面 | @VirginAmerica plus you''ve added commercials
    t... |'
- en: '| 2 | 2/24/15 11:15 | yvonnalynn | neutral | @VirginAmerica I didn''t today...
    Must mean I n... |'
  id: totrans-769
  prefs: []
  type: TYPE_TB
  zh: '| 2 | 2/24/15 11:15 | yvonnalynn | 中立 | @VirginAmerica I didn''t today... Must
    mean I n... |'
- en: '| 3 | 2/24/15 11:15 | jnardino | negative | @VirginAmerica it''s really aggressive
    to blast... |'
  id: totrans-770
  prefs: []
  type: TYPE_TB
  zh: '| 3 | 2/24/15 11:15 | jnardino | 负面 | @VirginAmerica it''s really aggressive
    to blast... |'
- en: '| 4 | 2/24/15 11:14 | jnardino | negative | @VirginAmerica and it''s a really
    big bad thing... |'
  id: totrans-771
  prefs: []
  type: TYPE_TB
  zh: '| 4 | 2/24/15 11:14 | jnardino | 负面 | @VirginAmerica 和这是一件真正糟糕的事情... |'
- en: '[PRE103]'
  id: totrans-772
  prefs: []
  type: TYPE_PRE
  zh: '[PRE103]'
- en: '[PRE104]'
  id: totrans-773
  prefs: []
  type: TYPE_PRE
  zh: '[PRE104]'
- en: We extract the text information in this dataset.
  id: totrans-774
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从该数据集中提取文本信息。
- en: '[PRE105]'
  id: totrans-775
  prefs: []
  type: TYPE_PRE
  zh: '[PRE105]'
- en: '[PRE106]'
  id: totrans-776
  prefs: []
  type: TYPE_PRE
  zh: '[PRE106]'
- en: 'Next, we convert our dataset into a matrix by creating a document-term matrix
    using [`sklearn.feature_extraction.text.CountVectorizer`](https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html#sklearn.feature_extraction.text.CountVectorizer.fit_transform).
    Quoting [Wikipedia](https://en.wikipedia.org/wiki/Document-term_matrix):'
  id: totrans-777
  prefs: []
  type: TYPE_NORMAL
  zh: '接下来，我们通过创建文档-词矩阵将我们的数据集转换为矩阵，使用[`sklearn.feature_extraction.text.CountVectorizer`](https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html#sklearn.feature_extraction.text.CountVectorizer.fit_transform)。引用[维基百科](https://en.wikipedia.org/wiki/Document-term_matrix):'
- en: A document-term matrix or term-document matrix is a mathematical matrix that
    describes the frequency of terms that occur in a collection of documents. In a
    document-term matrix, rows correspond to documents in the collection and columns
    correspond to terms.
  id: totrans-778
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 文档-词矩阵或词-文档矩阵是一个数学矩阵，描述了在文档集合中出现的术语的频率。在文档-词矩阵中，行对应于集合中的文档，列对应于术语。
- en: 'By default, it first preprocesses the data. In particular, it lower-cases all
    words and removes punctuation. A more careful pre-procsseing would also include
    stemming, although we do not do this here. Regarding the latter, quoting [Wikipedia](https://en.wikipedia.org/wiki/Stemming):'
  id: totrans-779
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，它首先预处理数据。特别是，它将所有单词转换为小写并删除标点符号。更仔细的预处理还应包括词干提取，尽管我们在这里没有这样做。关于后者，引用 [维基百科](https://en.wikipedia.org/wiki/Stemming)：
- en: In linguistic morphology and information retrieval, stemming is the process
    of reducing inflected (or sometimes derived) words to their word stem, base or
    root form—generally a written word form. […] A computer program or subroutine
    that stems word may be called a stemming program, stemming algorithm, or stemmer.
    […] A stemmer for English operating on the stem cat should identify such strings
    as cats, catlike, and catty. A stemming algorithm might also reduce the words
    fishing, fished, and fisher to the stem fish. The stem need not be a word, for
    example the Porter algorithm reduces, argue, argued, argues, arguing, and argus
    to the stem argu.
  id: totrans-780
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 在语言学形态学和信息检索中，词干提取是将屈折（或有时是派生）词还原到其词干、词根或基本形式的过程——通常是一个书面词形式。[...] 一个可以提取词干的计算机程序或子程序可能被称为词干程序、词干算法或词干器。[...]
    对于在词干 cat 上操作的英语词干器，应识别出这样的字符串，如 cats、catlike 和 catty。词干算法也可能将 fishing、fished
    和 fisher 等词还原到词干 fish。词干不一定是单词，例如，Porter 算法将 argue、argued、argues、arguing 和 argus
    还原到词干 argu。
- en: '[PRE107]'
  id: totrans-781
  prefs: []
  type: TYPE_PRE
  zh: '[PRE107]'
- en: '[PRE108]'
  id: totrans-782
  prefs: []
  type: TYPE_PRE
  zh: '[PRE108]'
- en: '[PRE109]'
  id: totrans-783
  prefs: []
  type: TYPE_PRE
  zh: '[PRE109]'
- en: The list of all terms used can be accessed as follows.
  id: totrans-784
  prefs: []
  type: TYPE_NORMAL
  zh: 所有术语的列表可以通过以下方式访问。
- en: '[PRE110]'
  id: totrans-785
  prefs: []
  type: TYPE_PRE
  zh: '[PRE110]'
- en: '[PRE111]'
  id: totrans-786
  prefs: []
  type: TYPE_PRE
  zh: '[PRE111]'
- en: Because of our use of the multivariate Bernoulli naive Bayes model, it will
    be more convenient to work with a variant of the document-term matrix where each
    word is either present or absent. Note that, in the context of tweet data which
    are very short documents with likely little word repetition, there is probably
    not much difference.
  id: totrans-787
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们使用了多元伯努利朴素贝叶斯模型，使用文档-词矩阵的一个变体将更加方便，其中每个单词要么存在，要么不存在。请注意，在推文数据（这些是非常短的文档，可能几乎没有单词重复）的上下文中，可能没有太大的差异。
- en: '[PRE112]'
  id: totrans-788
  prefs: []
  type: TYPE_PRE
  zh: '[PRE112]'
- en: '[PRE113]'
  id: totrans-789
  prefs: []
  type: TYPE_PRE
  zh: '[PRE113]'
- en: We also extract the labels (`neutral`, `postive`, `negative`) from the dataset.
  id: totrans-790
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还从数据集中提取标签（`neutral`、`positive`、`negative`）。
- en: '[PRE114]'
  id: totrans-791
  prefs: []
  type: TYPE_PRE
  zh: '[PRE114]'
- en: '[PRE115]'
  id: totrans-792
  prefs: []
  type: TYPE_PRE
  zh: '[PRE115]'
- en: We split the data into a training set and a test set using [`sklearn.model_selection.train_test_split`](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html).
  id: totrans-793
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用 `sklearn.model_selection.train_test_split`（[链接](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html)）将数据分为训练集和测试集。
- en: '[PRE116]'
  id: totrans-794
  prefs: []
  type: TYPE_PRE
  zh: '[PRE116]'
- en: '[PRE117]'
  id: totrans-795
  prefs: []
  type: TYPE_PRE
  zh: '[PRE117]'
- en: We use the Naive Bayes method. We first construct the matrix \(N_{k,m}\) and
    the vector \(N_k\).
  id: totrans-796
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用朴素贝叶斯方法。我们首先构建矩阵 \(N_{k,m}\) 和向量 \(N_k\)。
- en: '[PRE118]'
  id: totrans-797
  prefs: []
  type: TYPE_PRE
  zh: '[PRE118]'
- en: Above, the [`enumerate`](https://docs.python.org/3/library/functions.html#enumerate)
    function provides both the index and the value for each item in the `label_set`
    list during the loop. This allows the code to use the label’s value (`k`) and
    its numerical position (`i`) at the same time.
  id: totrans-798
  prefs: []
  type: TYPE_NORMAL
  zh: 如上所述，`enumerate` 函数在循环期间为 `label_set` 列表中的每个项目提供索引和值。这使得代码能够在同一时间使用标签的值（`k`）及其数值位置（`i`）。
- en: We are ready to train on the dataset.
  id: totrans-799
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经准备好在数据集上训练。
- en: '[PRE119]'
  id: totrans-800
  prefs: []
  type: TYPE_PRE
  zh: '[PRE119]'
- en: '[PRE120]'
  id: totrans-801
  prefs: []
  type: TYPE_PRE
  zh: '[PRE120]'
- en: '[PRE121]'
  id: totrans-802
  prefs: []
  type: TYPE_PRE
  zh: '[PRE121]'
- en: '[PRE122]'
  id: totrans-803
  prefs: []
  type: TYPE_PRE
  zh: '[PRE122]'
- en: Next, we plot the vector \(p_{k,m}\) for each label \(k\).
  id: totrans-804
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们绘制每个标签 \(k\) 的向量 \(p_{k,m}\)。
- en: '[PRE123]'
  id: totrans-805
  prefs: []
  type: TYPE_PRE
  zh: '[PRE123]'
- en: '![../../_images/e75f50e0059a06f686e844c95d499bf2dbc3ef78367a3fc95c0ed8f7df2202b1.png](../Images/dc490453944015ef54f86c78956d449e.png)'
  id: totrans-806
  prefs: []
  type: TYPE_IMG
  zh: '![../../_images/e75f50e0059a06f686e844c95d499bf2dbc3ef78367a3fc95c0ed8f7df2202b1.png](../Images/dc490453944015ef54f86c78956d449e.png)'
- en: 'We can compute a prediction on the test tweets. For example, for the 5th test
    tweet:'
  id: totrans-807
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以对测试推文进行预测。例如，对于第 5 条测试推文：
- en: '[PRE124]'
  id: totrans-808
  prefs: []
  type: TYPE_PRE
  zh: '[PRE124]'
- en: '[PRE125]'
  id: totrans-809
  prefs: []
  type: TYPE_PRE
  zh: '[PRE125]'
- en: The following computes the overall accuracy over the test data.
  id: totrans-810
  prefs: []
  type: TYPE_NORMAL
  zh: 以下计算测试数据的整体准确率。
- en: '[PRE126]'
  id: totrans-811
  prefs: []
  type: TYPE_PRE
  zh: '[PRE126]'
- en: '[PRE127]'
  id: totrans-812
  prefs: []
  type: TYPE_PRE
  zh: '[PRE127]'
- en: To get a better understanding of the differences uncovered by Naive Bayes between
    the different labels, we identify words that are particularly common in one label,
    but not on the other. Recall that label `1` corresponds to `positive` while label
    `2` corresponds to `negative`.
  id: totrans-813
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更好地理解朴素贝叶斯在不同标签之间的差异，我们识别出在某个标签中特别常见但在另一个标签中不常见的单词。回想一下，标签 `1` 对应于 `positive`，而标签
    `2` 对应于 `negative`。
- en: '[PRE128]'
  id: totrans-814
  prefs: []
  type: TYPE_PRE
  zh: '[PRE128]'
- en: '[PRE129]'
  id: totrans-815
  prefs: []
  type: TYPE_PRE
  zh: '[PRE129]'
- en: 'One notices that many positive words do appear in this list: `awesome`, `best`,
    `great`, `love`, `thank`.'
  id: totrans-816
  prefs: []
  type: TYPE_NORMAL
  zh: 注意到这个列表中确实出现了许多积极的词汇：`awesome`、`best`、`great`、`love`、`thank`。
- en: '[PRE130]'
  id: totrans-817
  prefs: []
  type: TYPE_PRE
  zh: '[PRE130]'
- en: '[PRE131]'
  id: totrans-818
  prefs: []
  type: TYPE_PRE
  zh: '[PRE131]'
- en: 'This time, we notice: `bag`, `cancelled`, `delayed`, `hours`, `phone`.'
  id: totrans-819
  prefs: []
  type: TYPE_NORMAL
  zh: 这次，我们注意到：`bag`、`cancelled`、`delayed`、`hours`、`phone`。
- en: '**CHAT & LEARN** The bag-of-words representation used in the sentiment analysis
    example is a simple but limited way to represent text data. More advanced representations
    such as word embeddings and transformer models can capture more semantic information.
    Ask your favorite AI chatbot to explain these representations and how they can
    be used for text classification tasks. \(\ddagger\)'
  id: totrans-820
  prefs: []
  type: TYPE_NORMAL
  zh: '**CHAT & LEARN** 在情感分析示例中使用的词袋表示法是一种简单但有限的方式来表示文本数据。更高级的表示方法，如词嵌入和转换器模型，可以捕捉到更多的语义信息。请你的心仪AI聊天机器人解释这些表示方法以及它们如何用于文本分类任务。
    \(\ddagger\)'
- en: '6.7.2.2\. Kalman filtering: missing data[#](#kalman-filtering-missing-data
    "Link to this heading")'
  id: totrans-821
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.2.2\. 卡尔曼滤波：缺失数据[#](#kalman-filtering-missing-data "链接到这个标题")
- en: In Kalman filtering, we can also allow for the possibility that some observations
    are missing. Imagine for instance losing GPS signal while going through a tunnel.
    The recursions above are still valid, with the only modification that the *Update*
    equations involving \(\bY_t\) are dropped at those times \(t\) where there is
    no observation. In Numpy, we can use [`NaN`](https://numpy.org/doc/stable/reference/constants.html#numpy.nan)
    to indicate the lack of observation. (Alternatively, one can use the [numpy.ma](https://numpy.org/doc/stable/reference/maskedarray.generic.html)
    module.)
  id: totrans-822
  prefs: []
  type: TYPE_NORMAL
  zh: 在卡尔曼滤波中，我们还可以允许存在某些观测数据缺失的可能性。想象一下，例如在穿过隧道时丢失GPS信号的情况。上述递归仍然有效，唯一的修改是在没有观测数据的时间点
    \(t\)，涉及 \(\bY_t\) 的 *更新* 方程被省略。在NumPy中，我们可以使用 `NaN`（[https://numpy.org/doc/stable/reference/constants.html#numpy.nan](https://numpy.org/doc/stable/reference/constants.html#numpy.nan)）来表示观测数据的缺失。（或者，也可以使用
    [numpy.ma](https://numpy.org/doc/stable/reference/maskedarray.generic.html) 模块。）
- en: We use a same sample path as above, but mask observations at times \(t=10,\ldots,20\).
  id: totrans-823
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用与上面相同的样本路径，但在 \(t=10,\ldots,20\) 的时间点对观测数据进行掩码。
- en: '[PRE132]'
  id: totrans-824
  prefs: []
  type: TYPE_PRE
  zh: '[PRE132]'
- en: '[PRE133]'
  id: totrans-825
  prefs: []
  type: TYPE_PRE
  zh: '[PRE133]'
- en: Here is the sample we are aiming to infer.
  id: totrans-826
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是我们试图推断的样本。
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  id: totrans-827
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格源代码
    隐藏代码单元格源代码</summary>
- en: '[PRE134]</details> ![../../_images/f50483a562aeab113e7a2c066e9f1df40a3734ae2dcc59b104875762494a3a7e.png](../Images/23e83372ecc5a5cde94ad7f021c21a15.png)'
  id: totrans-828
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE134]</details> ![../../_images/f50483a562aeab113e7a2c066e9f1df40a3734ae2dcc59b104875762494a3a7e.png](../Images/23e83372ecc5a5cde94ad7f021c21a15.png)'
- en: We modify the recursion accordingly, that is, skip the *Update* step when there
    is no observation to use for the update.
  id: totrans-829
  prefs: []
  type: TYPE_NORMAL
  zh: 我们相应地修改了递归，即在没有可用于更新的观测数据时跳过 *更新* 步骤。
- en: '[PRE135]'
  id: totrans-830
  prefs: []
  type: TYPE_PRE
  zh: '[PRE135]'
- en: '[PRE136]'
  id: totrans-831
  prefs: []
  type: TYPE_PRE
  zh: '[PRE136]'
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  id: totrans-832
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格源代码
    隐藏代码单元格源代码</summary>
- en: '[PRE137]</details> ![../../_images/2e92c840f3a0f15546d76a33647bbdb2a46015c60b362e0062398e2de1579630.png](../Images/6633cdad5605633dacdc68a6a28fde12.png)'
  id: totrans-833
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE137]</details> ![../../_images/2e92c840f3a0f15546d76a33647bbdb2a46015c60b362e0062398e2de1579630.png](../Images/6633cdad5605633dacdc68a6a28fde12.png)'
- en: 6.7.2.3\. Cholesky decomposition[#](#cholesky-decomposition "Link to this heading")
  id: totrans-834
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 6.7.2.3\. Cholesky分解[#](#cholesky-decomposition "链接到这个标题")
- en: In this section, we derive an important matrix factorization and apply it to
    generating multivariate Gaussians. We also revisit the least-squares problem.
    We begin with the motivation.
  id: totrans-835
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们推导出一个重要的矩阵分解方法并将其应用于生成多元高斯分布。我们还回顾了最小二乘问题。我们从动机开始。
- en: '**Generating multivariate Gaussians** Suppose we want to generate samples from
    a multivariate Gaussian \(\bX \sim N_d(\bmu, \bSigma)\) with given mean vector
    \(\bmu \in \mathbb{R}^d\) and positive definite covariance matrix \(\bSigma \in
    \mathbb{R}^{d \times d}\). Of course, in Numpy, we could use [`numpy.random.Generator.multivariate_normal`](https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.multivariate_normal.html).
    But what is behind it? More precisely, suppose we have access to unlimited samples
    \(U_1, U_2, U_3, etc.\) from uniform random variables in \([0,1]\). How do we
    transform them to obtain samples from \(N_d(\bmu, \bSigma)\).'
  id: totrans-836
  prefs: []
  type: TYPE_NORMAL
  zh: '**生成多元高斯分布** 假设我们想要从具有给定均值向量 \(\bmu \in \mathbb{R}^d\) 和正定协方差矩阵 \(\bSigma \in
    \mathbb{R}^{d \times d}\) 的多元高斯分布 \(\bX \sim N_d(\bmu, \bSigma)\) 中生成样本。当然，在 Numpy
    中，我们可以使用 `numpy.random.Generator.multivariate_normal`（[链接](https://numpy.org/doc/stable/reference/random/generated/numpy.random.Generator.multivariate_normal.html)）。但它的原理是什么？更确切地说，假设我们能够从
    \([0,1]\) 区间内的均匀随机变量中获得无限多的样本 \(U_1, U_2, U_3, \ldots\)。我们如何将它们转换以获得 \(N_d(\bmu,
    \bSigma)\) 的样本。'
- en: 'We start with the simplest case: \(d=1\), \(\mu = 0\), and \(\sigma^2 = 1\).
    That is, we first generate a univariate standard Normal. We have seen a recipe
    for doing this before, the inverse transform sampling method. Specifically, recall
    that the cumulative distribution function (CDF) of a random variable \(Z\) is
    defined as'
  id: totrans-837
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从最简单的情况开始：\(d=1\)，\(\mu = 0\)，和 \(\sigma^2 = 1\)。也就是说，我们首先生成一个一元标准正态分布。我们之前已经看到了一个生成这种分布的方法，即逆变换抽样方法。具体来说，回忆一下，随机变量
    \(Z\) 的累积分布函数（CDF）定义为
- en: \[ F_Z(z) = \mathbb{P}[Z \leq z], \qquad \forall z \in \mathbb{R}. \]
  id: totrans-838
  prefs: []
  type: TYPE_NORMAL
  zh: \[ F_Z(z) = \mathbb{P}[Z \leq z], \qquad \forall z \in \mathbb{R}. \]
- en: Let \(\mathcal{Z}\) be the interval where \(F_Z(z) \in (0,1)\) and assume that
    \(F_X\) is strictly increasing on \(\mathcal{Z}\). Let \(U \sim \mathrm{U}[0,1]\).
    Then it can be shown that
  id: totrans-839
  prefs: []
  type: TYPE_NORMAL
  zh: 设 \(\mathcal{Z}\) 为 \(F_Z(z) \in (0,1)\) 的区间，并假设 \(F_X\) 在 \(\mathcal{Z}\) 上严格递增。设
    \(U \sim \mathrm{U}[0,1]\)。那么可以证明
- en: \[ \mathbb{P}[F_X^{-1}(U) \leq z] = F_X(z). \]
  id: totrans-840
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbb{P}[F_X^{-1}(U) \leq z] = F_X(z). \]
- en: So take \(F_Z = \Phi\), the CDF of the standard Normal. Then \(Z = \Phi^{-1}(U)\)
    is \(N(0,1)\).
  id: totrans-841
  prefs: []
  type: TYPE_NORMAL
  zh: 所以取 \(F_Z = \Phi\)，标准正态分布的 CDF。那么 \(Z = \Phi^{-1}(U)\) 是 \(N(0,1)\)。
- en: How do we generate a \(N(\mu, \sigma^2)\) variable, for arbitrary \(\mu \in
    \mathbb{R}\) and \(\sigma^2 > 0\)? We use the fact that the linear transformation
    of Gaussian is still Gaussian. In particular, if \(Z \sim N(0,1)\), then
  id: totrans-842
  prefs: []
  type: TYPE_NORMAL
  zh: 我们如何生成一个 \(N(\mu, \sigma^2)\) 的变量，对于任意的 \(\mu \in \mathbb{R}\) 和 \(\sigma^2
    > 0\)？我们利用线性变换后的高斯分布仍然是高斯分布的事实。特别是，如果 \(Z \sim N(0,1)\)，那么
- en: \[ X = \mu + \sigma Z \]
  id: totrans-843
  prefs: []
  type: TYPE_NORMAL
  zh: \[ X = \mu + \sigma Z \]
- en: is \(N(\mu, \sigma^2)\).
  id: totrans-844
  prefs: []
  type: TYPE_NORMAL
  zh: 是 \(N(\mu, \sigma^2)\)。
- en: '**NUMERICAL CORNER:** In Python, \(\Phi^{-1}\) can be accessed using [`scipy.stats.norm.ppf`](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html).
    We implement this next (with help from ChatGPT).'
  id: totrans-845
  prefs: []
  type: TYPE_NORMAL
  zh: '**NUMERICAL CORNER:** 在 Python 中，\(\Phi^{-1}\) 可以使用 `scipy.stats.norm.ppf`（[链接](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html)）访问。我们接下来实现这一点（在
    ChatGPT 的帮助下）。'
- en: '[PRE138]'
  id: totrans-846
  prefs: []
  type: TYPE_PRE
  zh: '[PRE138]'
- en: We generate 1000 samples and plot the empirical distribution.
  id: totrans-847
  prefs: []
  type: TYPE_NORMAL
  zh: 我们生成 1000 个样本并绘制经验分布。
- en: '[PRE139]'
  id: totrans-848
  prefs: []
  type: TYPE_PRE
  zh: '[PRE139]'
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  id: totrans-849
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格源代码
    隐藏代码单元格源代码</summary>
- en: '[PRE140]</details> ![../../_images/648741740d20b45ce65b2b2791d1603ea77bd902d8873c497c1a1d5f0cc41bb6.png](../Images/c4d1f8c3493a1c88b3b5727f55a25bef.png)'
  id: totrans-850
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE140]</details> ![../../_images/648741740d20b45ce65b2b2791d1603ea77bd902d8873c497c1a1d5f0cc41bb6.png](../Images/c4d1f8c3493a1c88b3b5727f55a25bef.png)'
- en: \(\unlhd\)
  id: totrans-851
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: '**CHAT & LEARN** It turns out there is a neat trick to generate *two* independent
    samples from \(N(0,1)\) that does not rely on access to \(\Phi^{-1}\). It is called
    the Box-Muller transform. Ask your favorite AI chatbot about it. Modify our code
    above to implement it. \(\ddagger\)'
  id: totrans-852
  prefs: []
  type: TYPE_NORMAL
  zh: '**CHAT & LEARN** 事实证明，有一种巧妙的方法可以生成两个独立的 \(N(0,1)\) 样本，而不依赖于对 \(\Phi^{-1}\)
    的访问。这被称为 Box-Muller 变换。向你的首选 AI 聊天机器人询问它。修改我们上面的代码以实现它。 \(\ddagger\)'
- en: We move on to the multivariate case. We proceed similarly as before. First,
    how do we generate a \(d\)-dimensional Gaussian with mean vector \(\bmu = \mathbf{0}\)
    and identity covariance matrix \(\bSigma = I_{d \times d}\)? Easy – it has \(d\)
    independent components, each of which is standard Normal. So letting \(U_1, \ldots,
    U_d\) be independent uniform \([0,1]\) variables, then
  id: totrans-853
  prefs: []
  type: TYPE_NORMAL
  zh: 我们继续到多元情况。我们像以前一样进行。首先，我们如何生成一个均值向量为 \(\bmu = \mathbf{0}\) 和单位协方差矩阵 \(\bSigma
    = I_{d \times d}\) 的 \(d\) 维高斯分布？很简单——它有 \(d\) 个独立的分量，每个分量都是标准正态分布。所以让 \(U_1,
    \ldots, U_d\) 是独立的 \([0,1]\) 均匀变量，那么
- en: \[ \mathbf{Z} = (\Phi^{-1}(U_1),\ldots,\Phi^{-1}(U_d)) \]
  id: totrans-854
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{Z} = (\Phi^{-1}(U_1),\ldots,\Phi^{-1}(U_d)) \]
- en: is \(N(\mathbf{0}, I_{d \times d})\).
  id: totrans-855
  prefs: []
  type: TYPE_NORMAL
  zh: 是 \(N(\mathbf{0}, I_{d \times d})\)。
- en: We now seek to generate a multivariate Gaussian with arbitrary mean vector \(\bmu\)
    and positive definite covariance matrix \(\bSigma\). Again, we use a linear transformation
  id: totrans-856
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在寻求生成具有任意均值向量 \(\bmu\) 和正定协方差矩阵 \(\bSigma\) 的多元高斯分布。同样，我们使用线性变换
- en: \[ \mathbf{X} = \mathbf{a} + A \mathbf{Z}. \]
  id: totrans-857
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{X} = \mathbf{a} + A \mathbf{Z}. \]
- en: What are the right choices for \(a \in \mathbb{R}^d\) and \(A \in \mathbb{R}^{d
    \times d}\)? We need to match the obtained and desired mean and covariance. We
    start with the mean. By linearity of expectation,
  id: totrans-858
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 \(a \in \mathbb{R}^d\) 和 \(A \in \mathbb{R}^{d \times d}\) 的正确选择是什么？我们需要匹配获得的和期望的均值和协方差。我们从均值开始。通过期望的线性，
- en: \[ \E[\mathbf{X}] = \E[\mathbf{a} + A \mathbf{Z}] = \mathbf{a} + A \,\E[\mathbf{Z}]
    = \mathbf{a}. \]
  id: totrans-859
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \E[\mathbf{X}] = \E[\mathbf{a} + A \mathbf{Z}] = \mathbf{a} + A \,\E[\mathbf{Z}]
    = \mathbf{a}. \]
- en: Hence we pick \(\mathbf{a} := \bmu\).
  id: totrans-860
  prefs: []
  type: TYPE_NORMAL
  zh: 因此我们选择 \(\mathbf{a} := \bmu\)。
- en: As for the covariance, using the *Covariance of a Linear Transformation*, we
    get
  id: totrans-861
  prefs: []
  type: TYPE_NORMAL
  zh: 对于协方差，使用**线性变换的协方差**，我们得到
- en: \[ \cov[\mathbf{X}] = A \,\cov[\mathbf{Z}] A^T = A A^T. \]
  id: totrans-862
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \cov[\mathbf{X}] = A \,\cov[\mathbf{Z}] A^T = A A^T. \]
- en: 'Now we have a problem: what is a matrix \(A\) such that'
  id: totrans-863
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有一个问题：什么是一个矩阵 \(A\)，使得
- en: \[ A A^T = \bSigma? \]
  id: totrans-864
  prefs: []
  type: TYPE_NORMAL
  zh: \[ A A^T = \bSigma? \]
- en: In some sense, we are looking for a sort of “square root” of the covariance
    matrix. There are several ways of doing this. The Cholesky decomposition is one
    of them. We return to generating samples from \(N(\bmu, \bSigma)\) after introducing
    it.
  id: totrans-865
  prefs: []
  type: TYPE_NORMAL
  zh: 在某种意义上，我们正在寻找协方差矩阵的“平方根”。有几种方法可以做到这一点。Cholesky分解是其中之一。在介绍它之后，我们返回到从 \(N(\bmu,
    \bSigma)\) 生成样本。
- en: '**A matrix factorization** Our key linear-algebraic result of this section
    is the following. The matrix factorization in the next theorem is called a Cholesky
    decomposition. It has many [applications](https://en.wikipedia.org/wiki/Cholesky_decomposition#Applications).'
  id: totrans-866
  prefs: []
  type: TYPE_NORMAL
  zh: '**矩阵分解** 本节的关键线性代数结果是以下内容。下一定理中的矩阵分解称为Cholesky分解。它有许多[应用](https://en.wikipedia.org/wiki/Cholesky_decomposition#Applications)。'
- en: '**THEOREM** **(Cholesky Decomposition)** Any positive definite matrix \(B \in
    \mathbb{R}^{n \times n}\) can be factorized uniquely as'
  id: totrans-867
  prefs: []
  type: TYPE_NORMAL
  zh: '**定理** **(Cholesky分解)** 任何正定矩阵 \(B \in \mathbb{R}^{n \times n}\) 可以唯一分解为'
- en: \[ B = L L^T \]
  id: totrans-868
  prefs: []
  type: TYPE_NORMAL
  zh: \[ B = L L^T \]
- en: where \(L \in \mathbb{R}^{n \times n}\) is a lower triangular matrix with positive
    entries on the diagonal. \(\sharp\)
  id: totrans-869
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(L \in \mathbb{R}^{n \times n}\) 是一个对角线有正元素的下三角矩阵。 \(\sharp\)
- en: 'The proof is provided below. It is based on deriving an algorithm for computing
    the Cholesky decomposition: we grow \(L\) starting from its top-left corner by
    successively computing its next row based on the previously constructed submatrix.
    Note that, because \(L\) is lower triangular, it suffices to compute its elements
    on and below the diagonal. We first give the algorithm, then establish that it
    is well-defined.'
  id: totrans-870
  prefs: []
  type: TYPE_NORMAL
  zh: 证明如下。它基于推导出计算Cholesky分解的算法：我们从左上角开始逐步计算下一行，基于之前构造的子矩阵。注意，因为 \(L\) 是下三角矩阵，所以只需计算其对角线及其以下的元素。我们首先给出算法，然后证明它是良定义的。
- en: '**Figure:** Access pattern ([Source](https://en.wikipedia.org/wiki/File:Chol.gif))'
  id: totrans-871
  prefs: []
  type: TYPE_NORMAL
  zh: '**图示：访问模式 ([来源](https://en.wikipedia.org/wiki/File:Chol.gif))**'
- en: '![Access pattern](../Images/20de5b823040500b0d04511959484e97.png)'
  id: totrans-872
  prefs: []
  type: TYPE_IMG
  zh: '![访问模式](../Images/20de5b823040500b0d04511959484e97.png)'
- en: \(\bowtie\)
  id: totrans-873
  prefs: []
  type: TYPE_NORMAL
  zh: \(\bowtie\)
- en: '**EXAMPLE:** Before proceeeding with the general method, we give a small example
    to provide some intuition as to how it operates. We need a positive definite matrix.
    Consider the matrix'
  id: totrans-874
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例** 在进行一般方法之前，我们给出一个小示例，以提供一些关于其操作方式的感觉。我们需要一个正定矩阵。考虑以下矩阵'
- en: \[\begin{split} A = \begin{pmatrix} 1 & 2 & 1\\ 0 & -2 & 1\\ 0 & 0 & 1\\ 0 &
    0 & 0 \end{pmatrix}. \end{split}\]
  id: totrans-875
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A = \begin{pmatrix} 1 & 2 & 1\\ 0 & -2 & 1\\ 0 & 0 & 1\\ 0 &
    0 & 0 \end{pmatrix}. \end{split}\]
- en: It has full column rank (why?). Recall that, in that case, the \(B = A^T A\)
    is positive definite.
  id: totrans-876
  prefs: []
  type: TYPE_NORMAL
  zh: 它具有满列秩（为什么？）。回想一下，在这种情况下，\(B = A^T A\) 是正定的。
- en: That is, the matrix
  id: totrans-877
  prefs: []
  type: TYPE_NORMAL
  zh: 那就是矩阵
- en: \[\begin{split} B = A^T A = \begin{pmatrix} 1 & 2 & 1\\ 2 & 8 & 0\\ 1 & 0 &
    3 \end{pmatrix} \end{split}\]
  id: totrans-878
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} B = A^T A = \begin{pmatrix} 1 & 2 & 1\\ 2 & 8 & 0\\ 1 & 0 &
    3 \end{pmatrix} \end{split}\]
- en: is positive definite.
  id: totrans-879
  prefs: []
  type: TYPE_NORMAL
  zh: 是正定的。
- en: Let \(L = (\ell_{i,j})_{i,j=1}^3\) be lower triangular. We seek to solve \(L
    L^T = B\) for the nonzero entries of \(L\). Observe that
  id: totrans-880
  prefs: []
  type: TYPE_NORMAL
  zh: 令 \(L = (\ell_{i,j})_{i,j=1}^3\) 为下三角矩阵。我们寻求求解 \(L L^T = B\) 的非零元素 \(L\)。观察如下
- en: \[\begin{split} \begin{pmatrix} \ell_{1,1} & 0 & 0\\ \ell_{2,1} & \ell_{2,2}
    & 0\\ \ell_{3,1} & \ell_{3,2} & \ell_{3,3} \end{pmatrix} \begin{pmatrix} \ell_{1,1}
    & \ell_{2,1} & \ell_{3,1}\\ 0 & \ell_{2,2} & \ell_{3,2}\\ 0 & 0 & \ell_{3,3} \end{pmatrix}
    = \begin{pmatrix} \ell_{1,1}^2 & \ell_{1,1}\ell_{2,1} & \ell_{1,1}\ell_{3,1}\\
    \ell_{1,1}\ell_{2,1} & \ell_{2,1}^2 + \ell_{2,2}^2 & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2}\\
    \ell_{1,1}\ell_{3,1} & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2} & \ell_{3,1}^2
    + \ell_{3,2}^2 + \ell_{3,3} \end{pmatrix}. \end{split}\]
  id: totrans-881
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} \ell_{1,1} & 0 & 0\\ \ell_{2,1} & \ell_{2,2}
    & 0\\ \ell_{3,1} & \ell_{3,2} & \ell_{3,3} \end{pmatrix} \begin{pmatrix} \ell_{1,1}
    & \ell_{2,1} & \ell_{3,1}\\ 0 & \ell_{2,2} & \ell_{3,2}\\ 0 & 0 & \ell_{3,3} \end{pmatrix}
    = \begin{pmatrix} \ell_{1,1}^2 & \ell_{1,1}\ell_{2,1} & \ell_{1,1}\ell_{3,1}\\
    \ell_{1,1}\ell_{2,1} & \ell_{2,1}^2 + \ell_{2,2}^2 & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2}\\
    \ell_{1,1}\ell_{3,1} & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2} & \ell_{3,1}^2
    + \ell_{3,2}^2 + \ell_{3,3} \end{pmatrix}. \end{split}\]
- en: The system
  id: totrans-882
  prefs: []
  type: TYPE_NORMAL
  zh: 该系统
- en: \[\begin{split} \begin{pmatrix} \ell_{1,1}^2 & \ell_{1,1}\ell_{2,1} & \ell_{1,1}\ell_{3,1}\\
    \ell_{1,1}\ell_{2,1} & \ell_{2,1}^2 + \ell_{2,2}^2 & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2}\\
    \ell_{1,1}\ell_{3,1} & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2} & \ell_{3,1}^2
    + \ell_{3,2}^2 + \ell_{3,3}^2 \end{pmatrix} = \begin{pmatrix} 1 & 2 & 1\\ 2 &
    8 & 0\\ 1 & 0 & 3 \end{pmatrix} \end{split}\]
  id: totrans-883
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} \ell_{1,1}^2 & \ell_{1,1}\ell_{2,1} & \ell_{1,1}\ell_{3,1}\\
    \ell_{1,1}\ell_{2,1} & \ell_{2,1}^2 + \ell_{2,2}^2 & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2}\\
    \ell_{1,1}\ell_{3,1} & \ell_{2,1}\ell_{3,1} + \ell_{2,2}\ell_{3,2} & \ell_{3,1}^2
    + \ell_{3,2}^2 + \ell_{3,3}^2 \end{pmatrix} = \begin{pmatrix} 1 & 2 & 1\\ 2 &
    8 & 0\\ 1 & 0 & 3 \end{pmatrix} \end{split}\]
- en: turns out to be fairly simple to solve.
  id: totrans-884
  prefs: []
  type: TYPE_NORMAL
  zh: 解决起来相当简单。
- en: From the first entry, we get \(\ell_{1,1} = 1\) (where we took the positive
    solution to \(\ell_{1,1}^2 = 1\)).
  id: totrans-885
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从第一个元素，我们得到 \(\ell_{1,1} = 1\)（我们取了 \(\ell_{1,1}^2 = 1\) 的正解）。
- en: Given that \(\ell_{1,1}\) is known, entry \(\ell_{2,1}\) is determined from
    \(\ell_{1,1}\ell_{2,1} =2\) in the first entry of the second row. That is, \(\ell_{2,1}
    =2\). Then the second entry of the second row gives \(\ell_{2,2}\) through \(\ell_{2,1}^2
    + \ell_{2,2}^2 = 8\). So \(\ell_{2,2} = 2\) (again we take the positive solution).
  id: totrans-886
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 假设 \(\ell_{1,1}\) 已知，从第二行的第一个元素 \(\ell_{1,1}\ell_{2,1} =2\) 可以确定 \(\ell_{2,1}\)。即，\(\ell_{2,1}
    =2\)。然后，第二行的第二个元素给出 \(\ell_{2,2}\) 通过 \(\ell_{2,1}^2 + \ell_{2,2}^2 = 8\)。所以 \(\ell_{2,2}
    = 2\)（再次取正解）。
- en: We move to the third row. The first entry gives \(\ell_{3,1} = 1\), the second
    entry gives \(\ell_{3,2} = -1\) and finally the third entry leads to \(\ell_{3,3}
    = 1\).
  id: totrans-887
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们转向第三行。第一个元素给出 \(\ell_{3,1} = 1\)，第二个元素给出 \(\ell_{3,2} = -1\)，最后第三个元素导致 \(\ell_{3,3}
    = 1\)。
- en: Hence we have
  id: totrans-888
  prefs: []
  type: TYPE_NORMAL
  zh: 因此我们有
- en: \[\begin{split} L = \begin{pmatrix} \ell_{1,1} & 0 & 0\\ \ell_{2,1} & \ell_{2,2}
    & 0\\ \ell_{3,1} & \ell_{3,2} & \ell_{3,3} \end{pmatrix} = \begin{pmatrix} 1 &
    0 & 0\\ 2 & 2 & 0\\ 1 & -1 & 1 \end{pmatrix}. \end{split}\]
  id: totrans-889
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} L = \begin{pmatrix} \ell_{1,1} & 0 & 0\\ \ell_{2,1} & \ell_{2,2}
    & 0\\ \ell_{3,1} & \ell_{3,2} & \ell_{3,3} \end{pmatrix} = \begin{pmatrix} 1 &
    0 & 0\\ 2 & 2 & 0\\ 1 & -1 & 1 \end{pmatrix}. \end{split}\]
- en: \(\lhd\)
  id: totrans-890
  prefs: []
  type: TYPE_NORMAL
  zh: \(\lhd\)
- en: To detail the computation of the Cholesky decomposition \(L L^T\) of \(B\),
    we will need some notation. Write \(B = (b_{i,j})_{i,j=1}^n\) and \(L = (\ell_{i,j})_{i,j=1}^n\).
    Let \(L_{(k)} = (\ell_{i,j})_{i,j=1}^k\) be the first \(k\) rows and columns of
    \(L\), let \(\bflambda_{(k)}^T = (\ell_{k,1},\ldots,\ell_{k,k-1})\) be the row
    vector corresponding to the first \(k-1\) entries of row \(k\) of \(L\), and let
    \(\bfbeta_{(k)}^T = (b_{k,1},\ldots,b_{k,k-1})\) be the row vector corresponding
    to the first \(k-1\) entries of row \(k\) of \(B\).
  id: totrans-891
  prefs: []
  type: TYPE_NORMAL
  zh: 为了详细说明 \(B\) 的 Cholesky 分解 \(L L^T\) 的计算，我们需要一些符号。将 \(B = (b_{i,j})_{i,j=1}^n\)
    和 \(L = (\ell_{i,j})_{i,j=1}^n\) 写下来。令 \(L_{(k)} = (\ell_{i,j})_{i,j=1}^k\) 为
    \(L\) 的前 \(k\) 行和列，令 \(\bflambda_{(k)}^T = (\ell_{k,1},\ldots,\ell_{k,k-1})\)
    为 \(L\) 的第 \(k\) 行的前 \(k-1\) 个元素的行向量，并令 \(\bfbeta_{(k)}^T = (b_{k,1},\ldots,b_{k,k-1})\)
    为 \(B\) 的第 \(k\) 行的前 \(k-1\) 个元素的行向量。
- en: The strategy is to compute \(L_{(1)}\), then \(L_{(2)}\), then \(L_{(3)}\) and
    so on. With the notation above, \(L_{(j)}\) can be written in block form as
  id: totrans-892
  prefs: []
  type: TYPE_NORMAL
  zh: 策略是先计算 \(L_{(1)}\)，然后 \(L_{(2)}\)，然后 \(L_{(3)}\)，依此类推。使用上述符号，\(L_{(j)}\) 可以写成块形式如下
- en: \[\begin{split} L_{(j)} = \begin{pmatrix} L_{(j-1)} & \mathbf{0}\\ \bflambda_{(j)}^T
    & \ell_{j,j}. \end{pmatrix} \end{split}\]
  id: totrans-893
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} L_{(j)} = \begin{pmatrix} L_{(j-1)} & \mathbf{0}\\ \bflambda_{(j)}^T
    & \ell_{j,j}. \end{pmatrix} \end{split}\]
- en: Hence, once \(L_{(j-1)}\) is known, in order to compute \(L_{(j)}\) one only
    needs \(\bflambda_{(j)}\) and \(\ell_{j,j}\). We show next that they satisfy easily
    solvable systems of equations.
  id: totrans-894
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，一旦 \(L_{(j-1)}\) 已知，为了计算 \(L_{(j)}\)，只需要 \(\bflambda_{(j)}\) 和 \(\ell_{j,j}\)。我们接下来将展示它们满足容易解决的方程组。
- en: We first note that the \((1,1)\) entry of the matrix equation \(L L^T = B\)
    implies that
  id: totrans-895
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先注意到矩阵方程 \(L L^T = B\) 的 \((1,1)\) 元素意味着
- en: \[ \ell_{1,1}^2 = b_{1,1}. \]
  id: totrans-896
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \ell_{1,1}^2 = b_{1,1}. \]
- en: So we set
  id: totrans-897
  prefs: []
  type: TYPE_NORMAL
  zh: 因此我们设置
- en: \[ L_{(1)} = \ell_{1,1} = \sqrt{b_{1,1}}. \]
  id: totrans-898
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L_{(1)} = \ell_{1,1} = \sqrt{b_{1,1}}. \]
- en: 'For this step to be well-defined, it needs to be the case that \(b_{1,1} >
    0\). It is easy to see that it follows from the positive definiteness of \(B\):'
  id: totrans-899
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使这一步定义良好，需要满足 \(b_{1,1} > 0\)。很容易看出，这源于 \(B\) 的正定性：
- en: \[ 0 < \langle \mathbf{e}_1, B \mathbf{e}_1\rangle = \mathbf{e}_1^T B_{\cdot,1}
    = b_{1,1}. \]
  id: totrans-900
  prefs: []
  type: TYPE_NORMAL
  zh: \[ 0 < \langle \mathbf{e}_1, B \mathbf{e}_1\rangle = \mathbf{e}_1^T B_{\cdot,1}
    = b_{1,1}. \]
- en: Proceeding by induction, assume \(L_{(j-1)}\) has been constructed. The first
    \(j-1\) elements of the \(j\)-th row of the matrix equation \(L L^T = B\) translate
    into
  id: totrans-901
  prefs: []
  type: TYPE_NORMAL
  zh: 通过归纳法进行，假设 \(L_{(j-1)}\) 已经构建。矩阵方程 \(L L^T = B\) 的第 \(j\) 行的前 \(j-1\) 个元素转化为
- en: \[ L_{j,\cdot} (L^T)_{\cdot,1:j-1} = \bflambda_{(j)}^T L_{(j-1)}^T = \bfbeta_{(j)}^T,
    \]
  id: totrans-902
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L_{j,\cdot} (L^T)_{\cdot,1:j-1} = \bflambda_{(j)}^T L_{(j-1)}^T = \bfbeta_{(j)}^T,
    \]
- en: where \((L^T)_{\cdot,1:j-1}\) denotes the first \(j-1\) columns of \(L^T\).
    In the first equality above, we used the fact that \(L^T\) is upper triangular.
    Taking a transpose, the resulting linear system of equations
  id: totrans-903
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \((L^T)_{\cdot,1:j-1}\) 表示 \(L^T\) 的前 \(j-1\) 列。在上面的第一个等式中，我们使用了 \(L^T\)
    是上三角的事实。取转置，得到的线性方程组
- en: \[ L_{(j-1)} \bflambda_{(j)} = \bfbeta_{(j)} \]
  id: totrans-904
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L_{(j-1)} \bflambda_{(j)} = \bfbeta_{(j)} \]
- en: can be solved by forward substitution (since \(\bfbeta_{(j)}\) is part of the
    input and \(L_{(j-1)}\) was previously computed). The fact that this system has
    a unique solution (more specifically, that the diagonal entries of \(L_{(j-1)}\)
    are strictly positive) is established in the proof of the *Cholesky Decomposition
    Theorem*.
  id: totrans-905
  prefs: []
  type: TYPE_NORMAL
  zh: 可以通过前向替换（因为 \(\bfbeta_{(j)}\) 是输入的一部分，且 \(L_{(j-1)}\) 之前已经计算过）来解决。这个系统有唯一解的事实（更具体地说，\(L_{(j-1)}\)
    的对角线元素是严格正的）在 *Cholesky 分解定理* 的证明中已经确立。
- en: The \((j,j)\)-th entry of the matrix equation \(L L^T = B\) translates into
  id: totrans-906
  prefs: []
  type: TYPE_NORMAL
  zh: 矩阵方程 \(L L^T = B\) 的 \((j,j)\)-th 项转化为
- en: \[ L_{j,\cdot} (L^T)_{\cdot,j} = \sum_{k=1}^j \ell_{j,k}^2 = b_{j,j}, \]
  id: totrans-907
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L_{j,\cdot} (L^T)_{\cdot,j} = \sum_{k=1}^j \ell_{j,k}^2 = b_{j,j}, \]
- en: where again we used the fact that \(L^T\) is upper triangular. Since \(\ell_{j,1},
    \ldots, \ell_{j,j-1}\) are the elements of \(\bflambda_{(j)}\), they have already
    been determined. So we can set
  id: totrans-908
  prefs: []
  type: TYPE_NORMAL
  zh: 其中我们再次使用了 \(L^T\) 是上三角的事实。由于 \(\ell_{j,1}, \ldots, \ell_{j,j-1}\) 是 \(\bflambda_{(j)}\)
    的元素，它们已经被确定。因此，我们可以设置
- en: \[ \ell_{j,j} = \sqrt{b_{j,j} - \sum_{k=1}^{j-1} \ell_{j,k}^2}. \]
  id: totrans-909
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \ell_{j,j} = \sqrt{b_{j,j} - \sum_{k=1}^{j-1} \ell_{j,k}^2}. \]
- en: The fact that we are taking the square root of a positive quantity is established
    in the proof of the *Cholesky Decomposition Theorem*. Finally, from \(L_{(j-1)}\),
    \(\bflambda_{(j)}\), and \(\ell_{j,j}\), we construct \(L_{(j)}\).
  id: totrans-910
  prefs: []
  type: TYPE_NORMAL
  zh: 我们取正量平方根的事实在 *Cholesky 分解定理* 的证明中已经确立。最后，从 \(L_{(j-1)}\)，\(\bflambda_{(j)}\)
    和 \(\ell_{j,j}\)，我们构建 \(L_{(j)}\)。
- en: '**NUMERICAL CORNER:** We implement the algorithm above. In our naive implementation,
    we assume that \(B\) is positive definite, and therefore that all steps are well-defined.'
  id: totrans-911
  prefs: []
  type: TYPE_NORMAL
  zh: '**数值角:** 我们实现了上述算法。在我们的朴素实现中，我们假设 \(B\) 是正定的，因此所有步骤都是定义良好的。'
- en: '[PRE141]'
  id: totrans-912
  prefs: []
  type: TYPE_PRE
  zh: '[PRE141]'
- en: Here is a simple example.
  id: totrans-913
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一个简单的例子。
- en: '[PRE142]'
  id: totrans-914
  prefs: []
  type: TYPE_PRE
  zh: '[PRE142]'
- en: '[PRE143]'
  id: totrans-915
  prefs: []
  type: TYPE_PRE
  zh: '[PRE143]'
- en: '[PRE144]'
  id: totrans-916
  prefs: []
  type: TYPE_PRE
  zh: '[PRE144]'
- en: '[PRE145]'
  id: totrans-917
  prefs: []
  type: TYPE_PRE
  zh: '[PRE145]'
- en: We can check that it produces the right factorization.
  id: totrans-918
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以检查它是否产生正确的分解。
- en: '[PRE146]'
  id: totrans-919
  prefs: []
  type: TYPE_PRE
  zh: '[PRE146]'
- en: '[PRE147]'
  id: totrans-920
  prefs: []
  type: TYPE_PRE
  zh: '[PRE147]'
- en: \(\unlhd\)
  id: totrans-921
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: '**Proof of Cholesky decomposition theorem** We give a proof of the *Cholesky
    Decomposition Theorem*.'
  id: totrans-922
  prefs: []
  type: TYPE_NORMAL
  zh: '**Cholesky 分解定理的证明** 我们给出 *Cholesky 分解定理* 的证明。'
- en: '*Proof idea:* Assuming by induction that the upper-left corner of the matrix
    \(B\) has a Cholesky decomposition, one finds equations for the remaining row
    that can be solved uniquely by the properties established in the previous subsection.'
  id: totrans-923
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明思路:* 假设通过归纳法，矩阵 \(B\) 的左上角具有 Cholesky 分解，然后找到剩余行的方程，这些方程可以通过前一小节中建立的属性唯一解决。'
- en: '*Proof:* If \(n=1\), we have shown previously that \(b_{1,1} > 0\), and hence
    we can take \(L = [\ell_{1,1}]\) where \(\ell_{1,1} = \sqrt{b_{1,1}}\). Assuming
    the result holds for positive definite matrices in \(\mathbb{R}^{(n-1) \times
    (n-1)}\), we first re-write \(B = L L^T\) in block form'
  id: totrans-924
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明:* 如果 \(n=1\)，我们之前已经证明 \(b_{1,1} > 0\)，因此我们可以取 \(L = [\ell_{1,1}]\)，其中 \(\ell_{1,1}
    = \sqrt{b_{1,1}}\)。假设对于 \(\mathbb{R}^{(n-1) \times (n-1)}\) 中的正定矩阵，结果成立，我们首先将
    \(B = L L^T\) 以分块形式重写'
- en: \[\begin{split} \begin{pmatrix} B_{11} & \bfbeta_{12}\\ \bfbeta_{12}^T & \beta_{22}
    \end{pmatrix} = \begin{pmatrix} \Lambda_{11} & \mathbf{0}\\ \bflambda_{12}^T &
    \lambda_{22} \end{pmatrix} \begin{pmatrix} \Lambda_{11}^T & \bflambda_{12}\\ \mathbf{0}^T
    & \lambda_{22} \end{pmatrix} \end{split}\]
  id: totrans-925
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} B_{11} & \bfbeta_{12}\\ \bfbeta_{12}^T & \beta_{22}
    \end{pmatrix} = \begin{pmatrix} \Lambda_{11} & \mathbf{0}\\ \bflambda_{12}^T &
    \lambda_{22} \end{pmatrix} \begin{pmatrix} \Lambda_{11}^T & \bflambda_{12}\\ \mathbf{0}^T
    & \lambda_{22} \end{pmatrix} \end{split}\]
- en: where \(B_{11}, \Lambda_{11} \in \mathbb{R}^{n-1 \times n-1}\), \(\bfbeta_{12},
    \bflambda_{12} \in \mathbb{R}^{n-1}\) and \(\beta_{22}, \lambda_{22} \in \mathbb{R}\).
    By block matrix algebra, we get the system
  id: totrans-926
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(B_{11}, \Lambda_{11} \in \mathbb{R}^{n-1 \times n-1}\), \(\bfbeta_{12},
    \bflambda_{12} \in \mathbb{R}^{n-1}\) 和 \(\beta_{22}, \lambda_{22} \in \mathbb{R}\)。通过分块矩阵代数，我们得到以下系统
- en: \[\begin{split} B_{11} = \Lambda_{11} \Lambda_{11}^T\\ \bfbeta_{12} = \Lambda_{11}
    \bflambda_{12}\\ \beta_{22} = \bflambda_{12}^T \bflambda_{12} + \lambda_{22}^2.
    \end{split}\]
  id: totrans-927
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} B_{11} = \Lambda_{11} \Lambda_{11}^T\\ \bfbeta_{12} = \Lambda_{11}
    \bflambda_{12}\\ \beta_{22} = \bflambda_{12}^T \bflambda_{12} + \lambda_{22}^2.
    \end{split}\]
- en: By the *Principal Submatrices Lemma*, the principal submatrix \(B_{11}\) is
    positive definite. Hence, by induction, there is a unique lower-triangular matrix
    \(\Lambda_{11}\) with positive diagonal elements satisfying the first equation.
    We can then obtain \(\bfbeta_{12}\) from the second equation by forward substitution.
    And finally we get
  id: totrans-928
  prefs: []
  type: TYPE_NORMAL
  zh: 通过**主子矩阵引理**，主子矩阵 \(B_{11}\) 是正定的。因此，通过归纳法，存在一个唯一的下三角矩阵 \(\Lambda_{11}\) 具有正的对角元素，满足第一个方程。然后我们可以通过前向替换从第二个方程中求得
    \(\bfbeta_{12}\)。最后我们得到
- en: \[ \lambda_{22} = \sqrt{\beta_{22} - \bflambda_{12}^T \bflambda_{12}}. \]
  id: totrans-929
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \lambda_{22} = \sqrt{\beta_{22} - \bflambda_{12}^T \bflambda_{12}}. \]
- en: 'We do have to check that the square root above exists. That is, we need to
    argue that the expression inside the square root is non-negative. In fact, for
    the claim to go through, we need it to be strictly positive. We notice that the
    expression inside the square root is in fact the Schur complement of the block
    \(B_{11}\):'
  id: totrans-930
  prefs: []
  type: TYPE_NORMAL
  zh: 我们确实需要检查上面的平方根是否存在。也就是说，我们需要证明平方根内的表达式是非负的。实际上，为了使这个陈述成立，我们需要它严格为正。我们注意到平方根内的表达式实际上是块
    \(B_{11}\) 的舒尔补：
- en: \[\begin{align*} \beta_{22} - \bflambda_{12}^T \bflambda_{12} &= \beta_{22}
    - (\Lambda_{11}^{-1} \bfbeta_{12})^T (\Lambda_{11}^{-1} \bfbeta_{12})\\ &= \beta_{22}
    - \bfbeta_{12}^T (\Lambda_{11}^{-1})^T \Lambda_{11}^{-1} \bfbeta_{12}\\ &= \beta_{22}
    - \bfbeta_{12}^T (\Lambda_{11} \Lambda_{11}^T)^{-1} \bfbeta_{12}\\ &= \beta_{22}
    - \bfbeta_{12}^T (B_{11})^{-1} \bfbeta_{12} \end{align*}\]
  id: totrans-931
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \beta_{22} - \bflambda_{12}^T \bflambda_{12} &= \beta_{22}
    - (\Lambda_{11}^{-1} \bfbeta_{12})^T (\Lambda_{11}^{-1} \bfbeta_{12})\\ &= \beta_{22}
    - \bfbeta_{12}^T (\Lambda_{11}^{-1})^T \Lambda_{11}^{-1} \bfbeta_{12}\\ &= \beta_{22}
    - \bfbeta_{12}^T (\Lambda_{11} \Lambda_{11}^T)^{-1} \bfbeta_{12}\\ &= \beta_{22}
    - \bfbeta_{12}^T (B_{11})^{-1} \bfbeta_{12} \end{align*}\]
- en: where we used the equation \(\bfbeta_{12} = \Lambda_{11} \bflambda_{12}\) on
    the first line, the identities \((Q W)^{-1} = W^{-1} Q^{-1}\) and \((Q^T)^{-1}
    = (Q^{-1})^T\) (see the exercise below) on the third line and the equation \(B_{11}
    = \Lambda_{11} \Lambda_{11}^T\) on the fourth line. By the *Schur Complement Lemma*,
    the Schur complement is positive definite. Because it is a scalar in this case,
    it is strictly positive (prove it!), which concludes the proof. \(\square\)
  id: totrans-932
  prefs: []
  type: TYPE_NORMAL
  zh: 其中我们在第一行使用了方程 \(\bfbeta_{12} = \Lambda_{11} \bflambda_{12}\)，在第三行使用了恒等式 \((Q
    W)^{-1} = W^{-1} Q^{-1}\) 和 \((Q^T)^{-1} = (Q^{-1})^T\)（见下面的练习），在第四行使用了方程 \(B_{11}
    = \Lambda_{11} \Lambda_{11}^T\)。通过**舒尔补引理**，舒尔补是正定的。因为在这种情况下它是一个标量，所以它是严格正的（证明它！），这完成了证明。
    \(\square\)
- en: '**Back to multivariate Gaussians** Returning to our motivation, we can generate
    samples from a \(N(\bmu, \bSigma)\) by first generating'
  id: totrans-933
  prefs: []
  type: TYPE_NORMAL
  zh: '**回到多元高斯分布** 回到我们的动机，我们可以通过首先生成'
- en: \[ \mathbf{Z} = (\Phi^{-1}(U_1),\ldots,\Phi^{-1}(U_d)) \]
  id: totrans-934
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{Z} = (\Phi^{-1}(U_1),\ldots,\Phi^{-1}(U_d)) \]
- en: where \(U_1, \ldots, U_d\) are independent uniform \([0,1]\) variables, then
    setting
  id: totrans-935
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(U_1, \ldots, U_d\) 是独立的均匀 \([0,1]\) 变量，然后设置
- en: \[ \mathbf{X} = \bmu + L \mathbf{Z}, \]
  id: totrans-936
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{X} = \bmu + L \mathbf{Z}, \]
- en: where \(\bSigma = L L^T\) is a Cholesky decomposition of \(\bSigma\).
  id: totrans-937
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(\bSigma = L L^T\) 是 \(\bSigma\) 的Cholesky分解。
- en: '**NUMERICAL CORNER:** We implement this method.'
  id: totrans-938
  prefs: []
  type: TYPE_NORMAL
  zh: '**数值角**：我们实现了这种方法。'
- en: '[PRE148]'
  id: totrans-939
  prefs: []
  type: TYPE_PRE
  zh: '[PRE148]'
- en: We generate some samples as an example.
  id: totrans-940
  prefs: []
  type: TYPE_NORMAL
  zh: 我们生成一些样本作为示例。
- en: '[PRE149]'
  id: totrans-941
  prefs: []
  type: TYPE_PRE
  zh: '[PRE149]'
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  id: totrans-942
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格源代码
    隐藏代码单元格源代码</summary>
- en: '[PRE150]</details>'
  id: totrans-943
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE150]'
- en: '[PRE151]'
  id: totrans-944
  prefs: []
  type: TYPE_PRE
  zh: '[PRE151]'
- en: \(\unlhd\)
  id: totrans-945
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: '**Using a Cholesky decomposition to solve the least squares problem** Another
    application of the Cholesky decomposition is to solving the least squares problem.
    In this section, we restrict ourselves to the case where \(A \in \mathbb{R}^{n\times
    m}\) has full column rank. By the *Least Squares and Positive Semidefiniteness
    Lemma*, we then have that \(A^T A\) is positive definite. By the *Cholesky Decomposition
    Theorem*, we can factorize this matrix as \(A^T A = L L^T\) where \(L\) is lower
    triangular with positive diagonal elements. The normal equations then reduce to'
  id: totrans-946
  prefs: []
  type: TYPE_NORMAL
  zh: '**使用Cholesky分解求解最小二乘问题** Cholesky分解的另一个应用是解决最小二乘问题。在本节中，我们限制自己考虑的情况是 \(A \in
    \mathbb{R}^{n\times m}\) 具有满列秩。根据**最小二乘与正半定引理**，我们随后有 \(A^T A\) 是正定的。根据**Cholesky分解定理**，我们可以将这个矩阵分解为
    \(A^T A = L L^T\)，其中 \(L\) 是下三角矩阵，对角线元素为正。然后正则方程简化为'
- en: \[ L L^T \mathbf{x} = A^T \mathbf{b}. \]
  id: totrans-947
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L \mathbf{z} = A^T \mathbf{b} \]
- en: This system can be solved in two steps. We first obtain the solution to
  id: totrans-948
  prefs: []
  type: TYPE_NORMAL
  zh: '**数值角:** 我们在下面实现这个算法。在我们的原始实现中，我们假设 \(A\) 具有满列秩，因此所有步骤都是定义良好的。'
- en: \[ L \mathbf{z} = A^T \mathbf{b} \]
  id: totrans-949
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们得到
- en: by forward substitution. Then we obtain the solution to
  id: totrans-950
  prefs: []
  type: TYPE_NORMAL
  zh: 通过前向替换。
- en: \[ L^T \mathbf{x} = \mathbf{z} \]
  id: totrans-951
  prefs: []
  type: TYPE_NORMAL
  zh: 这个系统可以通过两个步骤求解。我们首先得到
- en: by back-substitution. Note that \(L^T\) is indeed an upper triangular matrix.
  id: totrans-952
  prefs: []
  type: TYPE_NORMAL
  zh: 通过回代。注意 \(L^T\) 确实是一个上三角矩阵。
- en: '**NUMERICAL CORNER:** We implement this algorithm below. In our naive implementation,
    we assume that \(A\) has full column rank, and therefore that all steps are well-defined.'
  id: totrans-953
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L L^T \mathbf{x} = A^T \mathbf{b}. \]
- en: '[PRE152]'
  id: totrans-954
  prefs: []
  type: TYPE_PRE
  zh: '[PRE152]'
- en: \(\unlhd\)
  id: totrans-955
  prefs: []
  type: TYPE_NORMAL
  zh: \[ L^T \mathbf{x} = \mathbf{z} \]
- en: Other applications of the Cholesky decomposition are briefly described [here](https://en.wikipedia.org/wiki/Cholesky_decomposition#Applications).
  id: totrans-956
  prefs: []
  type: TYPE_NORMAL
  zh: Cholesky分解的其他应用简要描述[在此](https://en.wikipedia.org/wiki/Cholesky_decomposition#Applications)。
