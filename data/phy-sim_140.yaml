- en: Interpolating Functions
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 插值函数
- en: 原文：[https://phys-sim-book.github.io/lec26.2-interpolating_functions.html](https://phys-sim-book.github.io/lec26.2-interpolating_functions.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec26.2-interpolating_functions.html](https://phys-sim-book.github.io/lec26.2-interpolating_functions.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: In each time step of the Material Point Method (MPM), particles transfer their
    mass and momentum to the background grid, and later retrieve updated velocities
    from the grid to perform advection. Both transfers rely on **interpolating functions**
    to determine how each particle interacts with nearby grid nodes.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在材料点法（MPM）的每个时间步中，粒子将质量动量转移到背景网格，然后从网格检索更新的速度以执行对流。这两个转移都依赖于**插值函数**来确定每个粒子与附近网格节点的交互方式。
- en: 'We define the interpolating function associated with grid node i as Ni​(x).
    Here, i is a multi-index - (i,j) in 2D or (i,j,k) in 3D - and x is an arbitrary
    spatial position. When evaluating this function at a particle location xp​, we
    use the shorthand:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将关联于网格节点i的插值函数定义为Ni​(x)。在这里，i是一个多索引 - 2D中的(i,j)或3D中的(i,j,k) - ，而x是任意空间位置。当在粒子位置xp​评估此函数时，我们使用缩写：
- en: wip​=Ni​(xp​).
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: wip​=Ni​(xp​).
- en: 'This weight determines how strongly particle p influences grid node i: the
    closer the particle is to the node, the larger wip​ becomes.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 这个权重决定了粒子p对网格节点i的影响强度：粒子越接近节点，wip​变得越大。
- en: '**Example 27.2.1 (Linear Interpolation).** In 1D, the simplest choice of interpolating
    functions is the **linear (tent) function**: N(x)={1−∣x∣0​if 0≤∣x∣<1,otherwise.​
    To apply this in a grid-based setting, we scale the spatial coordinates relative
    to the **grid spacing** h (i.e., the distance between adjacent grid nodes along
    one axis). The scaled version becomes: N(hxp​−xi​​). In higher dimensions (2D,
    3D), we use the **tensor product** of 1D functions: Ni​(xp​)=N(hxp​−xi​​)⋅N(hyp​−yj​​)⋅N(hzp​−zk​​).'
  id: totrans-7
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**示例27.2.1（线性插值）**。在1D中，最简单的插值函数选择是**线性（帐篷）函数**：N(x)={1−∣x∣0​if 0≤∣x∣<1,otherwise.​
    要在基于网格的设置中应用此函数，我们按比例缩放空间坐标相对于**网格间距**h（即沿一个轴相邻网格节点之间的距离）。缩放后的版本变为：N(hxp​−xi​​)。在更高维（2D，3D）中，我们使用1D函数的**张量积**：Ni​(xp​)=N(hxp​−xi​​)⋅N(hyp​−yj​​)⋅N(hzp​−zk​​)。'
- en: 'Linear interpolation is computationally efficient and easy to implement, and
    is widely used in FLIP [[Brackbill et al. 1988]](bibliography.html#brackbill1988flip)
    [[Bridson 2015]](bibliography.html#bridson2015fluid) for fluid simulation. However,
    it suffers from two serious issues when applied in MPM:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 线性插值计算效率高，易于实现，在FLIP [[Brackbill et al. 1988]](bibliography.html#brackbill1988flip)
    [[Bridson 2015]](bibliography.html#bridson2015fluid) 流体模拟中得到广泛应用。然而，当应用于MPM时，它存在两个严重问题：
- en: Its gradient ∇N(x) is **discontinuous**, leading to unstable and noisy force
    evaluations.
  id: totrans-9
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 其梯度∇N(x)是**不连续的**，导致不稳定的噪声力评估。
- en: When particles are near cell boundaries, wip​ becomes small while ∇wip​ remains
    large, causing numerical instabilities known as **cell-crossing instability**.
  id: totrans-10
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当粒子接近单元格边界时，wip​变得很小，而∇wip​保持很大，导致称为**单元格交叉不稳定性**的数值不稳定性。
- en: The function’s support is too narrow, making it prone to **numerical fracture**
    when neighboring particles do not share enough grid nodes.
  id: totrans-11
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 函数的支持范围太窄，当相邻粒子没有共享足够的网格节点时，容易发生**数值断裂**。
- en: Because of these issues, linear interpolation is typically avoided in MPM, especially
    in solid simulation.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 由于这些问题，线性插值通常在MPM中避免，尤其是在固体模拟中。
- en: '**Example 27.2.2 (Quadratic B-Spline Interpolation).** A better choice is the
    **quadratic B-spline** interpolating functions, which is C1-continuous (with continuous
    gradients) and has wider support: N(x)=⎩⎨⎧​43​−x221​(23​−∣x∣)20​if ∣x∣<21​,if 21​≤∣x∣<23​,otherwise.​'
  id: totrans-13
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**示例27.2.2（二次B样条插值）**。更好的选择是**二次B样条**插值函数，它是C1-连续的（具有连续的梯度）并且支持范围更广：N(x)=⎩⎨⎧​43​−x221​(23​−∣x∣)20​if ∣x∣<21​,if 21​≤∣x∣<23​,otherwise.​'
- en: Quadratic B-splines have a support region of width 3h and provide smooth, stable
    interactions between particles and the grid. They are computationally efficient
    and require less memory than higher-order B-splines.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 二次B样条具有宽度为3h的支持区域，提供粒子与网格之间平滑、稳定的交互。它们计算效率高，比高阶B样条需要更少的内存。
- en: '**Example 27.2.3 (Cubic B-Spline Interpolation).** For even better smoothness
    and broader support, we can use the **cubic B-spline** interpolating functions:
    N(x)=⎩⎨⎧​21​∣x∣3−∣x∣2+32​61​(2−∣x∣)30​if 0≤∣x∣<1,if 1≤∣x∣<2,otherwise.​'
  id: totrans-15
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**示例27.2.3（三次B样条插值）**。为了获得更好的平滑性和更广泛的支持，我们可以使用**三次B样条**插值函数：N(x)=⎩⎨⎧​21​∣x∣3−∣x∣2+32​61​(2−∣x∣)30​if 0≤∣x∣<1,if 1≤∣x∣<2,otherwise.​'
- en: The cubic B-spline has support over [−2h,2h], making it more robust to numerical
    fracture and instabilities. However, the wider support also means that each particle
    interacts with more grid nodes, which increases the **computational overhead during
    transfers** (e.g., mass, momentum, and force). This trade-off between smoothness
    and efficiency should be considered when choosing an interpolation kernel.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 立方B样条的支持区间为[−2h,2h]，这使得它在数值断裂和不稳定性方面更加稳健。然而，更宽的支持区间也意味着每个粒子会与更多的网格节点相互作用，这增加了**传输过程中的计算开销**（例如，质量、动量和力）。在选择插值核时，应考虑这种在平滑性和效率之间的权衡。
- en: '[Gradient of the Interpolating Function](#gradient-of-the-interpolating-function)'
  id: totrans-17
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[插值函数的梯度](#gradient-of-the-interpolating-function)'
- en: 'Gradients are needed during force computation. For high-dimensional interpolating
    functions defined using tensor products, we compute their gradient using the chain
    rule: ∇Ni​(xp​)=​h1​N′(hxp​−xi​​)N(hyp​−yj​​)N(hzp​−zk​​)N(hxp​−xi​​)h1​N′(hyp​−yj​​)N(hzp​−zk​​)N(hxp​−xi​​)N(hyp​−yj​​)h1​N′(hzp​−zk​​)​​.
    Here, N′(x) is the derivative of the 1D interpolating function N(x).'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在力计算过程中需要梯度。对于使用张量积定义的高维插值函数，我们使用链式法则来计算它们的梯度：∇Ni(xp)=h1N′(hxp−xi)N(hyp−yj)N(hzp−zk)N(hxp−xi)h1N′(hyp−yj)N(hzp−zk)N(hxp−xi)N(hyp−yj)h1N′(hzp−zk)．在这里，N′(x)是1D插值函数N(x)的导数。
