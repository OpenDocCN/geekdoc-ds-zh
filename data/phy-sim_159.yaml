- en: Affine Particle-In-Cell Transfer
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 仿射粒子-网格转换
- en: 原文：[https://phys-sim-book.github.io/lec30.3-apic_transfer.html](https://phys-sim-book.github.io/lec30.3-apic_transfer.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec30.3-apic_transfer.html](https://phys-sim-book.github.io/lec30.3-apic_transfer.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: 'We defined the material point data following [Simulation Setup](./lec29.1-simulation_setup.html),
    extending it with two additional terms: the affine velocity field Cp​ used in
    the APIC transfer scheme and the scalar `log_J_diff` used for volume correction
    as described in [Drucker-Prager Elastoplasticity](./lec30.1-drucker_prager.html).'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 我们根据[模拟设置](./lec29.1-simulation_setup.html)定义了材料点数据，并添加了两个额外的项：用于APIC转换方案的仿射速度场
    Cp 和用于体积校正的标量 `log_J_diff`，如[Drucker-Prager弹塑性](./lec30.1-drucker_prager.html)中所述。
- en: 'During the particle-to-grid (P2G) transfer, we adopt the **APIC formulation**
    for momentum exchange. Instead of directly transferring particle velocity, we
    include the local affine velocity field Cp​. Specifically, momentum is transferred
    using the form:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在粒子到网格（P2G）转换过程中，我们采用**APIC公式**进行动量交换。我们不是直接传递粒子速度，而是包括局部仿射速度场 Cp。具体来说，动量是通过以下形式传递的：
- en: '**Implementation 31.3.1 (Affine Transfer in APIC Particle-to-Grid (P2G), simulator.py).**'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现 31.3.1（APIC粒子到网格（P2G）的仿射转换，simulator.py）**。'
- en: '[PRE0]'
  id: totrans-6
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Here, `dpos` is the offset from the particle to the grid node.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，`dpos`是粒子到网格节点的偏移量。
- en: During the grid-to-particle (G2P) transfer, we gather both the updated velocity
    and the **affine velocity matrix Cp​** from the background grid. The affine matrix
    is computed from the weighted outer product of grid velocities and position offsets.
    This allows each particle to retain local velocity variation, significantly reducing
    numerical dissipation compared to PIC.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 在网格到粒子（G2P）转换过程中，我们从背景网格中收集了更新的速度和**仿射速度矩阵 Cp**。仿射矩阵是通过网格速度和位置偏移的加权外积计算得出的。这允许每个粒子保留局部速度变化，与PIC相比，显著减少了数值耗散。
- en: '**Implementation 31.3.2 (Affine Transfer in APIC Grid-to-Particle (G2P), simulator.py).**'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现 31.3.2（APIC网格到粒子（G2P）的仿射转换，simulator.py）**。'
- en: '[PRE1]'
  id: totrans-10
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Here, D is a constant factor when using the Quadratic B-spline interpolation
    function:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，D是使用二次B样条插值函数时的一个常数因子：
- en: '**Implementation 31.3.3 (Constant D for Quadratic B-spline used for APIC, simulator.py).**'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现 31.3.3（用于APIC的二次B样条，simulator.py）**。'
- en: '[PRE2]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![](../Images/59983679509afb8a49f1db1670113e62.png)'
  id: totrans-14
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/59983679509afb8a49f1db1670113e62.png)'
- en: '**Figure 31.3.1.** Time sequence of a 2D sand block falling onto a static red
    sphere collider. The sand undergoes irreversible deformation and splashing upon
    impact, demonstrating granular flow and frictional boundary response.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '**图 31.3.1**。一个二维沙块落在静态红色球体碰撞器上的时间序列。沙子在撞击时发生不可逆变形并溅起，展示了颗粒流和摩擦边界响应。'
