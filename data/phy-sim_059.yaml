- en: 'Case Study: Compressing Square'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 案例研究：压缩正方形
- en: 原文：[https://phys-sim-book.github.io/lec11.2-compress_square.html](https://phys-sim-book.github.io/lec11.2-compress_square.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec11.2-compress_square.html](https://phys-sim-book.github.io/lec11.2-compress_square.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: We simulate compressing an elastic square using a ceiling. The excutable Python
    project for this section can be found at [https://github.com/phys-sim-book/solid-sim-tutorial](https://github.com/phys-sim-book/solid-sim-tutorial)
    under the `5_mov_dirichlet` folder. [MUDA](https://github.com/MuGdxy/muda) GPU
    implementations can be found at [https://github.com/phys-sim-book/solid-sim-tutorial-gpu](https://github.com/phys-sim-book/solid-sim-tutorial-gpu)
    under the `simulators/5_mov_dirichlet` folder.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用天花板模拟压缩弹性正方形。本节的可执行 Python 项目可以在 `5_mov_dirichlet` 文件夹下的 [https://github.com/phys-sim-book/solid-sim-tutorial](https://github.com/phys-sim-book/solid-sim-tutorial)
    找到。[MUDA](https://github.com/MuGdxy/muda) GPU 实现可以在 `simulators/5_mov_dirichlet`
    文件夹下的 [https://github.com/phys-sim-book/solid-sim-tutorial-gpu](https://github.com/phys-sim-book/solid-sim-tutorial-gpu)
    找到。
- en: The ceiling in our simulation is modeled as a half-space with a downward normal
    vector n=(0,−1). The distance from the ceiling to other simulated Degrees of Freedom
    (DOFs) can be calculated using Equation [(7.1.1)](lec7.1-signed_dists.html#eq:lec7:half_space_dist).
    To effectively apply the penalty method, it's necessary that the ceiling's height
    also serves as a DOF.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的模拟中，天花板被建模为一个向下法向量 n=(0,−1) 的半空间。天花板到其他模拟的自由度（DOFs）的距离可以使用方程 [(7.1.1)](lec7.1-signed_dists.html#eq:lec7:half_space_dist)
    来计算。为了有效地应用惩罚方法，天花板的高度也必须作为一个自由度。
- en: 'Following the approach used in the [Square on Slope](lec10-square_on_slope.html)
    project, we choose the origin o on the ceiling as the DOF and incorporate it into
    the variable x:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 沿着在 [斜坡上的正方形](lec10-square_on_slope.html) 项目中使用的方法，我们选择天花板上的原点 o 作为 DOF 并将其纳入变量
    x：
- en: '**Implementation 11.2.1 (Ceiling DOF setup, simulator.py).**'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现 11.2.1（天花板 DOF 设置，simulator.py）**。'
- en: '[PRE0]'
  id: totrans-7
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: The ceiling is initially positioned directly above the elastic square, as shown
    in the left image of [Figure 11.2.1](#fig:lec11:compress_square). By doing so,
    we ensure that the nodal mass of this newly added DOF is consistent with the other
    simulated nodes on the square, as per our implementation.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 天花板最初直接位于弹性正方形上方，如图 [图 11.2.1](#fig:lec11:compress_square) 左侧所示。通过这样做，我们确保这个新增加的
    DOF 的节点质量与正方形上其他模拟的节点一致，符合我们的实现。
- en: 'With this additional DOF, we can straightforwardly model the contact between
    the ceiling and the square. This is done by enhancing the existing functions that
    compute the barrier energy value, gradient, Hessian, and the initial step size:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 使用这个额外的自由度（DOF），我们可以直接模拟天花板和正方形之间的接触。这是通过增强现有的计算势能值、梯度、海森矩阵和初始步长的函数来实现的：
- en: '**Implementation 11.2.2 (Barrier energy value, BarrierEnergy.py).**'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现 11.2.2（势能值，BarrierEnergy.py）**。'
- en: '[PRE1]'
  id: totrans-11
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '**Implementation 11.2.3 (Barrier energy gradient, BarrierEnergy.py).**'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现 11.2.3（势能梯度，BarrierEnergy.py）**。'
- en: '[PRE2]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '**Implementation 11.2.4 (Barrier energy Hessian, BarrierEnergy.py).**'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现 11.2.4（势能海森矩阵，BarrierEnergy.py）**。'
- en: '[PRE3]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '**Implementation 11.2.5 (Initial step size calculation, BarrierEnergy.py).**'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现 11.2.5（初始步长计算，BarrierEnergy.py）**。'
- en: '[PRE4]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Here for the distance between the ceiling o and a node x, we have the stacked
    quantities locally: d(x,o)=nT(x−o),∇d(x,o)=[n−n​],∇2d(x,o)=0.'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，对于天花板 o 和节点 x 之间的距离，我们有局部堆叠的数量：d(x,o)=nT(x−o)，∇d(x,o)=[n−n​]，∇2d(x,o)=0。
- en: 'Now we apply the moving BC on the ceiling to compress the elastic square. We
    set the ceiling''s DOF, identified by the node index `(n_seg+1)*(n_seg+1)`, as
    the sole Dirichlet Boundary Condition (DBC) in this scene. We assign it a downward
    velocity of (0,−0.5). The movement is stopped when the ceiling reaches a height
    of −0.6:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将移动边界条件（BC）应用于天花板以压缩弹性正方形。我们将天花板的 DOF，通过节点索引 `(n_seg+1)*(n_seg+1)` 识别，设置为场景中的唯一
    Dirichlet 边界条件（DBC）。我们将其分配一个向下的速度 (0,−0.5)。当天花板达到高度 -0.6 时，运动停止：
- en: '**Implementation 11.2.6 (DBC setup, simulator.py).**'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现 11.2.6（DBC 设置，simulator.py）**。'
- en: '[PRE5]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Then we implement the penalty term according to Equation [(11.1.1)](lec11.1-penalty_method.html#eq:lec11:DBC_penalty),
    which is essentially a quadratic spring energy for controlling the motion of the
    ceiling:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们根据方程 [(11.1.1)](lec11.1-penalty_method.html#eq:lec11:DBC_penalty) 实现惩罚项，这本质上是一个用于控制天花板运动的二次弹簧能量：
- en: '**Implementation 11.2.7 (Spring energy computation, SpringEnergy.py).**'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现 11.2.7（弹簧能量计算，SpringEnergy.py）**。'
- en: '[PRE6]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Next, we focus on optimizing with the spring energies while properly handling
    the convergence check and penalty stiffness adjustments. At the start of each
    time step, the target position for each DBC node is computed, and the penalty
    stiffness, kM​, is initialized to 10. If certain nodes reach their preset limit,
    we then set the target as their current position:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们专注于在适当处理收敛性检查和罚刚度调整的同时优化弹簧能量。在每个时间步的开始，计算每个DBC节点的目标位置，并将罚刚度kM初始化为10。如果某些节点达到其预设的限制，我们将目标设置为它们的当前位置：
- en: '**Implementation 11.2.8 (DBC initialization, time_integrator.py).**'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现11.2.8（DBC初始化，time_integrator.py）**。'
- en: '[PRE7]'
  id: totrans-27
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Entering the Newton loop, in each iteration, just before computing the search
    direction, we assess how many DBC nodes are close enough to their target positions.
    We store these results in the variable `DBC_satisfied`:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 进入牛顿循环，在每次迭代中，在计算搜索方向之前，我们评估有多少DBC节点足够接近其目标位置。我们将这些结果存储在变量`DBC_satisfied`中：
- en: '**Implementation 11.2.9 (DBC satisfaction check, time_integrator.py).**'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现11.2.9（DBC满足性检查，time_integrator.py）**。'
- en: '[PRE8]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Then we only eliminate the DOFs of those DBC nodes that already satisfy the
    boundary condition:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们只消除那些已经满足边界条件的DBC节点的自由度：
- en: '**Implementation 11.2.10 (DOF elimination, time_integrator.py).**'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现11.2.10（自由度消除，time_integrator.py）**。'
- en: '[PRE9]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The BC satisfaction information stored in `DBC_satisfied` is also used to check
    convergence and update kM​ when needed:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 存储在`DBC_satisfied`中的BC满足性信息也用于检查收敛性，并在需要时更新kM：
- en: '**Implementation 11.2.11 (Convergence criteria, time_integrator.py).**'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现11.2.11（收敛标准，time_integrator.py）**。'
- en: '[PRE10]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Now, we proceed to run the simulation, which involves severely compressing the
    dropped elastic square as depicted in ([Figure 11.2.1](#fig:lec11:compress_square)).
    From the final static frame, we observe that the elastic springs on the edges
    are inverted due to extreme compression. This artifact is typical in mass-spring
    models of elasticity. In future chapters, we will explore how applying finite-element
    discretization to barrier-type elasticity models, such as the Neo-Hookean model,
    can prevent such issues. That approach is akin to the enforcement of non-interpenetrations
    in our current simulations.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们继续运行模拟，该模拟涉及将掉落的弹性正方形严重压缩，如图([图11.2.1](#fig:lec11:compress_square))所示。从最终静态帧中，我们可以观察到边缘的弹性弹簧由于极端压缩而反转。这种缺陷在质量-弹簧弹性模型中很典型。在未来的章节中，我们将探讨如何将有限元离散化应用于屏障型弹性模型，例如Neo-Hookean模型，以防止此类问题。这种方法类似于我们当前模拟中强制执行非穿透性。
- en: '![](../Images/ecfbf5f9f0ecec91763be32bf418d4c2.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/ecfbf5f9f0ecec91763be32bf418d4c2.png)'
- en: '**Figure 11.2.1.** A square is dropped onto the ground and compressed by a
    ceiling until inverted.'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: '**图11.2.1**。一个正方形被扔到地面上，并被天花板压缩直到反转。'
