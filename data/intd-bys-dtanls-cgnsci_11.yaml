- en: Chapter 3 Computational Bayesian data analysis
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第 3 章 计算贝叶斯数据分析
- en: 原文：[https://bruno.nicenboim.me/bayescogsci/ch-compbda.html](https://bruno.nicenboim.me/bayescogsci/ch-compbda.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://bruno.nicenboim.me/bayescogsci/ch-compbda.html](https://bruno.nicenboim.me/bayescogsci/ch-compbda.html)
- en: In the previous chapter, we learned how to analytically derive the posterior
    distribution of the parameters in our model. In practice, however, this is possible
    for only a very limited number of cases. Although the numerator in Bayes’ rule,
    the unnormalized posterior, is easy to calculate (by multiplying the likelihood
    and the probability density/mass function), the denominator, the marginal likelihood,
    requires us to carry out an integration; see Equation [(3.1)](ch-compbda.html#eq:bayesbrms).
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们学习了如何解析地推导出我们模型中参数的后验分布。然而，在实践中，这仅适用于非常有限的情况。尽管贝叶斯法则中的分子，即未归一化的后验，很容易计算（通过乘以似然和概率密度/质量函数），但分母，即边缘似然，需要我们进行积分；参见方程
    [(3.1)](ch-compbda.html#eq:bayesbrms)。
- en: \[\begin{equation} \begin{aligned} p(\boldsymbol{\Theta}|\boldsymbol{y}) &=
    \cfrac{ p(\boldsymbol{y}|\boldsymbol{\Theta}) \cdot p(\boldsymbol{\Theta}) }{p(\boldsymbol{y})}\\
    p(\boldsymbol{\Theta}|\boldsymbol{y}) &= \cfrac{ p(\boldsymbol{y}|\boldsymbol{\Theta})
    \cdot p(\boldsymbol{\Theta}) }{\int_{\boldsymbol{\Theta}} p(\boldsymbol{y}|\boldsymbol{\Theta})
    \cdot p(\boldsymbol{\Theta}) d\boldsymbol{\Theta} } \end{aligned} \tag{3.1} \end{equation}\]
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{equation} \begin{aligned} p(\boldsymbol{\Theta}|\boldsymbol{y}) &=
    \cfrac{ p(\boldsymbol{y}|\boldsymbol{\Theta}) \cdot p(\boldsymbol{\Theta}) }{p(\boldsymbol{y})}\\
    p(\boldsymbol{\Theta}|\boldsymbol{y}) &= \cfrac{ p(\boldsymbol{y}|\boldsymbol{\Theta})
    \cdot p(\boldsymbol{\Theta}) }{\int_{\boldsymbol{\Theta}} p(\boldsymbol{y}|\boldsymbol{\Theta})
    \cdot p(\boldsymbol{\Theta}) d\boldsymbol{\Theta} } \end{aligned} \tag{3.1} \end{equation}\]
- en: Unless we are dealing with conjugate distributions, the solution will be extremely
    hard to derive or there will be no analytical solution. This was the major bottleneck
    of Bayesian analysis in the past, and required Bayesian practitioners to program
    an approximation method by themselves before they could even begin the Bayesian
    analysis. Fortunately, many of the probabilistic programming languages freely
    available today (see the next section for a listing) allow us to define our models
    without having to acquire expert knowledge about the relevant numerical techniques.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 除非我们处理的是共轭分布，否则求解将极其困难，或者根本不存在解析解。这曾是过去贝叶斯分析的主要瓶颈，需要贝叶斯分析实践者自己编程实现近似方法，才能开始贝叶斯分析。幸运的是，今天许多免费可用的概率编程语言（下一节将列出）允许我们定义模型，而无需获得相关数值技术的专业知识。
- en: 3.1 Deriving the posterior through sampling
  id: totrans-5
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.1 通过采样推导后验
- en: 'Let’s say that we want to derive the posterior of the model from section [2.2](ch-introBDA.html#sec-analytical),
    that is, the posterior distribution of the cloze probability of “*umbrella*,”
    \(\theta\), given the following data: a word (e.g., “*umbrella*”) was answered
    80 out of 100 times, and assuming a binomial distribution as the likelihood function,
    and \(\mathit{Beta}(a=4,b=4)\) as a prior distribution for the cloze probability.
    If we can generate samples[⁹](#fn9) from the posterior distribution of \(\theta\),
    instead of an analytically derived posterior distribution, given enough samples
    we will have a good approximation of the posterior distribution. Obtaining samples
    from the posterior will be the only viable option in the models that we will discuss
    in this book. By “obtaining samples,” we are talking about a situation analogous
    to when we use `rbinom()` or `rnorm()` to obtain samples from a particular distribution.
    For more details about sampling algorithms, see the section Further Reading (section
    [3.10](ch-compbda.html#sec-ch3furtherreading)).'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们想要从第 [2.2](ch-introBDA.html#sec-analytical) 节推导出模型的后验分布，即“*雨伞*”的完形填空概率 \(\theta\)
    的后验分布，给定以下数据：一个单词（例如，“*雨伞*”）在100次中回答了80次，并且假设二项分布作为似然函数，以及 \(\mathit{Beta}(a=4,b=4)\)
    作为完形填空概率的先验分布。如果我们能从 \(\theta\) 的后验分布中生成样本[⁹](#fn9)，而不是通过解析方法得到后验分布，那么在足够多的样本下，我们将得到后验分布的良好近似。从后验分布中获取样本将是我们将在本书中讨论的模型中唯一可行的选项。当我们说“获取样本”时，我们是在谈论类似于我们使用
    `rbinom()` 或 `rnorm()` 从特定分布中获取样本的情况。有关采样算法的更多详细信息，请参阅进一步阅读部分（第 [3.10](ch-compbda.html#sec-ch3furtherreading)
    节）。
- en: 'Thanks to probabilistic programming languages, it will be relatively straightforward
    to get these samples, and we will discuss how we will do it in more detail in
    the next section. For now let’s assume that we used some probabilistic programming
    language to obtain 20000 samples from the posterior distribution of the cloze
    probability, \(\theta\): 0.782, 0.722, 0.782, 0.727, 0.839, 0.828, 0.769, 0.806,
    0.839, 0.832, 0.728, 0.805, 0.764, 0.756, 0.791, 0.739, 0.774, 0.758, 0.815, 0.808,
    . Figure [3.1](ch-compbda.html#fig:betapost) shows that the approximation of the
    posterior looks quite similar to the analytically derived posterior. The difference
    between the analytically computed and approximated mean and variance are \(-0.0001\)
    and \(0.000003\) respectively.'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 多亏了概率编程语言，获取这些样本将会相对简单，我们将在下一节中更详细地讨论如何实现。目前，让我们假设我们使用某种概率编程语言从闭合概率的后验分布中获得了20000个样本：0.782，0.722，0.782，0.727，0.839，0.828，0.769，0.806，0.839，0.832，0.728，0.805，0.764，0.756，0.791，0.739，0.774，0.758，0.815，0.808。图[3.1](ch-compbda.html#fig:betapost)显示后验的近似看起来与解析得到的后验非常相似。解析计算得到的均值和方差与近似值之间的差异分别是\(-0.0001\)和\(0.000003\)。
- en: '![Histogram of the samples of \(\theta\) from the posterior distribution generated
    via sampling. The black line shows the density plot of the analytically derived
    posterior.](../Images/ed657f238dd81d502c9e96e015f32093.png)'
  id: totrans-8
  prefs: []
  type: TYPE_IMG
  zh: '![通过采样生成的\(\theta\)后验分布样本的直方图。黑色线表示解析得到的后验密度图。](../Images/ed657f238dd81d502c9e96e015f32093.png)'
- en: 'FIGURE 3.1: Histogram of the samples of \(\theta\) from the posterior distribution
    generated via sampling. The black line shows the density plot of the analytically
    derived posterior.'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.1：通过采样生成的\(\theta\)后验分布样本的直方图。黑色线表示解析得到的后验密度图。
- en: '3.2 Bayesian Regression Models using Stan: brms'
  id: totrans-10
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.2 使用Stan的贝叶斯回归模型：brms
- en: The surge in popularity of Bayesian statistics is closely tied to the increase
    in computing power and the appearance of probabilistic programming languages,
    such as WinBUGS (Lunn et al. [2000](#ref-lunn2000winbugs)), JAGS (Plummer [2016](#ref-plummer2016jags)),
    PyMC3 (Salvatier, Wiecki, and Fonnesbeck [2016](#ref-Salvatier2016)), Turing (Ge,
    Xu, and Ghahramani [2018](#ref-turing)), and Stan (Carpenter et al. [2017](#ref-carpenter2017stan));
    for a historical review, see Plummer ([2022](#ref-plummer2022simulation)).
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 贝叶斯统计学的流行激增与计算能力的提升以及概率编程语言的出现密切相关，例如WinBUGS（Lunn等[2000](#ref-lunn2000winbugs)）、JAGS（Plummer
    [2016](#ref-plummer2016jags)）、PyMC3（Salvatier，Wiecki和Fonnesbeck [2016](#ref-Salvatier2016)）、Turing（Ge，Xu和Ghahramani
    [2018](#ref-turing)）和Stan（Carpenter等[2017](#ref-carpenter2017stan)）；有关历史回顾，请参阅Plummer
    ([2022](#ref-plummer2022simulation))。
- en: These probabilistic programming languages allow the user to define models without
    having to deal (for the most part) with the complexities of the sampling process.
    However, they require learning a new language since the user has to fully specify
    the statistical model using a particular syntax.[^(10)](#fn10) Furthermore, some
    knowledge of the sampling process is needed to correctly parameterize the models
    and to avoid convergence issues (these topics will be covered in detail in chapter
    [9](ch-complexstan.html#ch-complexstan)).
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 这些概率编程语言允许用户在不处理（大部分情况下）采样过程的复杂性定义模型。然而，由于用户必须使用特定的语法完全指定统计模型，因此需要学习一门新语言。[^(10)](#fn10)
    此外，为了正确参数化模型并避免收敛问题，需要了解采样过程的一些知识（这些内容将在第[9](ch-complexstan.html#ch-complexstan)章中详细讨论）。
- en: There are some alternatives that allow Bayesian inference in R without having
    to fully specify the model “by hand.” The R packages `rstanarm` (Goodrich et al.
    [2018](#ref-rstanarm)) and `brms` (Bürkner [2024](#ref-R-brms)) provide Bayesian
    equivalents of many popular R model-fitting functions, such as (g)lmer (Bates,
    Mächler, et al. [2015](#ref-R-lme4)) and many others; both `rstanarm` and `brms`
    use Stan as the back-end for estimation and sampling. The package R-INLA (Lindgren
    and Rue [2015](#ref-lindgren2015bayesian)) allows for fitting a limited selection
    of likelihood functions and priors in comparison to `rstanarm` and `brms` (R-INLA
    can fit models that can be expressed as latent Gaussian models). This package
    uses the integrated nested Laplace approximation (INLA) method for carrying out
    Bayesian inference, rather than a sampling algorithm as in the other probabilistic
    languages listed above. Another alternative is JASP (JASP Team [2019](#ref-JASP2019)),
    which provides a graphical user interface for both frequentist and Bayesian modeling,
    and is intended to be an open-source alternative to SPSS.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些替代方案允许在R中执行贝叶斯推理，而无需完全手动指定模型。R包`rstanarm`（Goodrich等人[2018](#ref-rstanarm)）和`brms`（Bürkner
    [2024](#ref-R-brms)）提供了许多流行R模型拟合函数的贝叶斯等价，例如(g)lmer（Bates，Mächler等人[2015](#ref-R-lme4)）等；`rstanarm`和`brms`都使用Stan作为估计和采样的后端。与`rstanarm`和`brms`相比，R包R-INLA（Lindgren和Rue
    [2015](#ref-lindgren2015bayesian)）允许拟合有限的选择似然函数和先验，R-INLA可以拟合可以表示为潜在高斯模型的模型）。此包使用集成嵌套拉普拉斯近似（INLA）方法进行贝叶斯推理，而不是像上述其他概率语言中的采样算法。另一个替代方案是JASP（JASP
    Team [2019](#ref-JASP2019)），它为频率派和贝叶斯建模提供图形用户界面，并旨在成为SPSS的开源替代品。
- en: We will focus on `brms` in this part of the book. This is because it can be
    useful for a smooth transition from frequentist models to their Bayesian equivalents.
    The package `brms` is not only powerful enough to satisfy the statistical needs
    of many cognitive scientists, it has the added benefit that the Stan code can
    be inspected (with the `brms` functions `make_stancode()` and `make_standata()`),
    allowing the user to customize their models or learn from the code produced internally
    by `brms` to eventually transition to writing the models entirely in Stan. In
    the introduction to Stan in chapter [8](ch-introstan.html#ch-introstan), we implement
    in Stan the models presented in the current and the following chapters.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在本书的这一部分将重点关注`brms`。这是因为它可以帮助从频率派模型平滑过渡到它们的贝叶斯等价模型。`brms`包不仅足够强大以满足许多认知科学家的统计需求，而且还有额外的优势，即Stan代码可以被检查（使用`brms`函数`make_stancode()`和`make_standata()`），使用户能够自定义他们的模型或从`brms`内部生成的代码中学习，最终完全用Stan编写模型。在第8章中关于Stan的介绍中，我们实现了当前章节和下一章中提出的模型。
- en: '3.2.1 A simple linear model: A single subject pressing a button repeatedly
    (a finger tapping task)'
  id: totrans-15
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.2.1 简单线性模型：单个受试者重复按按钮（手指敲击任务）
- en: 'To illustrate the basic steps for fitting a model using `brms`, consider the
    following example of a finger tapping task (for a review, see Hubel et al. [2013](#ref-hubel2013computerized)).
    Suppose that a subject first sees a blank screen. Then, after a certain amount
    of time (say \(200\) ms), the subject sees a cross in the middle of a screen,
    and as soon as they see the cross, they tap on the space bar as fast as they can
    until the experiment is over (\(361\) trials). The dependent measure here is the
    time it takes in milliseconds from one press of the space bar to the next one.
    The data in each trial are therefore finger tapping times in milliseconds. Suppose
    that the research question is: how long does it take for this particular subject
    to press a key?'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 为了说明使用`brms`拟合模型的基本步骤，考虑以下关于手指敲击任务的示例（参见Hubel等人[2013](#ref-hubel2013computerized)的综述）。假设一个受试者首先看到一片空白屏幕。然后，经过一段时间（比如说200毫秒），受试者会在屏幕中央看到一个十字，一旦他们看到十字，他们就会尽可能快地按下空格键，直到实验结束（361次试验）。这里的因变量是按下空格键到下一次按下所需的时间（以毫秒为单位）。因此，每个试验中的数据是手指敲击时间（以毫秒为单位）。假设研究问题是：这个特定受试者按下键需要多长时间？
- en: 'Let’s model the data with the following assumptions:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们基于以下假设对数据进行建模：
- en: There is a true (unknown) underlying time, \(\mu\) ms, that the subject needs
    to press the space bar.
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 存在一个真实的（未知的）基础时间，\(\mu\)毫秒，受试者需要按下空格键。
- en: There is some noise in this process.
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在这个过程中有一些噪声。
- en: The noise is normally distributed (this assumption is questionable given that
    finger tapping as also response times are generally skewed; we will fix this assumption
    later).[^(11)](#fn11)
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 噪声是正态分布的（考虑到手指敲击作为响应时间通常也是偏斜的，这个假设是有问题的；我们将在后面修正这个假设）。[^(11)](#fn11)
- en: 'This means that the likelihood for each observation \(n\) will be:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着每个观测值 \(n\) 的可能性将是：
- en: \[\begin{equation} t_n \sim \mathit{Normal}(\mu, \sigma) \tag{3.2} \end{equation}\]
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{equation} t_n \sim \mathit{Normal}(\mu, \sigma) \tag{3.2} \end{equation}\]
- en: where \(n =1, \ldots, N\), and \(t\) is the dependent variable (finger tapping
    times in milliseconds). The variable \(N\) indexes the total number of data points.
    The symbol \(\mu\) indicates the *location* of the normal distribution function;
    the location parameter shifts the distribution left or right on the horizontal
    axis. For the normal distribution, the location is also the mean of the distribution.
    The symbol \(\sigma\) indicates the *scale* of the distribution; as the scale
    decreases, the distribution gets narrower. This compressing approaches a spike
    (all the probability mass get concentrated near one point) as the scale parameter
    approaches zero. For the normal distribution, the scale is also its standard deviation.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(n =1, \ldots, N\)，\(t\) 是因变量（以毫秒为单位的手指敲击时间）。变量 \(N\) 表示数据点的总数。符号 \(\mu\)
    表示正态分布函数的 *位置*；位置参数将分布沿水平轴左移或右移。对于正态分布，位置也是分布的均值。符号 \(\sigma\) 表示分布的 *尺度*；当尺度减小时，分布变窄。这种压缩随着尺度参数趋近于零而趋近于尖峰（所有概率质量都集中在一点附近）。对于正态分布，尺度也是其标准差。
- en: 'The reader may have encountered the model shown in Equation [(3.2)](ch-compbda.html#eq:rtlik)
    in the form shown in Equation [(3.3)](ch-compbda.html#eq:rtlikLM):'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 读者可能已经遇到了方程 [(3.2)](ch-compbda.html#eq:rtlik) 中所示的形式，在方程 [(3.3)](ch-compbda.html#eq:rtlikLM)
    中呈现：
- en: \[\begin{equation} t_n = \mu + \varepsilon_n \hbox{, where } \varepsilon_n \stackrel{iid}{\sim}
    \mathit{Normal}(0,\sigma) \tag{3.3} \end{equation}\]
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{equation} t_n = \mu + \varepsilon_n \hbox{, 其中 } \varepsilon_n \stackrel{iid}{\sim}
    \mathit{Normal}(0,\sigma) \tag{3.3} \end{equation}\]
- en: When the model is written in this way, it should be understood as meaning that
    each data point \(t_n\) has some variability around a mean value \(\mu\), and
    that variability has standard deviation \(\sigma\). The term “iid” (independent
    and identically distributed) implies that the residuals are independently generated
    (they are not correlated with any of the other residual values). The statement
    of the model in Equation [(3.3)](ch-compbda.html#eq:rtlikLM) is exactly the same
    as saying that the observed data points \(t_n\) are iid and are coming from the
    \(Normal(\mu,\sigma)\) distribution.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 当模型以这种方式编写时，应理解为每个数据点 \(t_n\) 都围绕一个均值 \(\mu\) 有一定的变异性，这种变异性具有标准差 \(\sigma\)。术语“iid”（独立同分布）意味着残差是独立生成的（它们与任何其他残差值都不相关）。模型在方程
    [(3.3)](ch-compbda.html#eq:rtlikLM) 中的表述与说观测数据点 \(t_n\) 是iid并且来自 \(Normal(\mu,\sigma)\)
    分布的表述完全相同。
- en: 'For a frequentist model that will give us the maximum likelihood estimate (the
    sample mean) of the time it takes to press the space bar, this would be enough
    information to write the formula in R, `t ~ 1`, and plug it into the function
    `lm()` together with the data: `lm(t ~ 1, data)`. The meaning of the `1` here
    is that `lm()` will estimate the intercept in the model, which is the estimate
    of \(\mu\) in our example. If the reader is completely unfamiliar with linear
    models, the references in section [4.5](ch-reg.html#sec-ch4furtherreading) will
    be helpful.'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 对于一个频率派模型，它将给出我们按空格键所需时间的最大似然估计（样本均值），这将足够的信息来在R中编写公式 `t ~ 1`，并将其与数据一起插入 `lm()`
    函数：`lm(t ~ 1, data)`。这里的 `1` 的含义是 `lm()` 将估计模型中的截距，即我们例子中的 \(\mu\) 的估计。如果读者对线性模型完全不熟悉，章节
    [4.5](ch-reg.html#sec-ch4furtherreading) 中的参考文献将会有所帮助。
- en: 'For a Bayesian linear model, we will also need to define priors for the two
    parameters in our model. Let’s say that we know for sure that the time it takes
    to press a key will be positive and lower than a minute (or \(60000\) ms), but
    we don’t want to make a commitment regarding which values are more likely. We
    encode what we know about the noise in the task in \(\sigma\): we know that this
    parameter must be positive and we’ll assume that any value below \(2000\) ms is
    equally likely. These priors are in general strongly discouraged: A flat (or very
    wide) prior will almost never be the best approximation of what we know. Prior
    specification is discussed in detail in the online chapter [E](ch-priors.html#ch-priors).'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 对于贝叶斯线性模型，我们还需要为模型中的两个参数定义先验。假设我们确信按下键所需的时间将是正的并且低于一分钟（或 \(60000\) 毫秒），但我们不希望就哪些值更有可能做出承诺。我们在
    \(\sigma\) 中编码我们对任务噪声的了解：我们知道这个参数必须是正的，我们假设任何低于 \(2000\) 毫秒的值可能性相同。这些先验通常强烈不建议使用：平坦（或非常宽）的先验几乎永远不会是我们所知道的最佳近似。先验规格将在在线章节
    [E](ch-priors.html#ch-priors) 中详细讨论。
- en: In this case, even if we know very little about the task, we know that pressing
    the spacebar will take at most a couple of seconds. We’ll start with flat priors
    in this section for pedagogical purposes; the next sections will already show
    more realistic uses of priors.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，即使我们对任务了解很少，我们也知道按下空格键最多只需要几秒钟。为了教学目的，本节将使用平坦先验；下一节将展示更现实的先验使用。
- en: \[\begin{equation} \begin{aligned} \mu &\sim \mathit{Uniform}(0, 60000) \\ \sigma
    &\sim \mathit{Uniform}(0, 2000) \end{aligned} \tag{3.4} \end{equation}\]
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{equation} \begin{aligned} \mu &\sim \mathit{Uniform}(0, 60000) \\ \sigma
    &\sim \mathit{Uniform}(0, 2000) \end{aligned} \tag{3.4} \end{equation}\]
- en: 'First, load the data frame `df_spacebar` from the `bcogsci` package:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，从 `bcogsci` 包中加载数据框 `df_spacebar`：
- en: '[PRE0]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '[PRE1]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: It is always a good idea to plot the data before doing anything else; see Figure
    [3.2](ch-compbda.html#fig:m1visualize). As we suspected, the data look a bit skewed,
    but we ignore this for the moment.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在做任何事情之前总是绘制数据是一个好主意；参见图 [3.2](ch-compbda.html#fig:m1visualize)。正如我们所怀疑的，数据看起来有点偏斜，但我们暂时忽略这一点。
- en: '[PRE2]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![Visualizing the button-press data.](../Images/b14a590009b985b0df7a58a9b31ed27c.png)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![可视化按钮点击数据。](../Images/b14a590009b985b0df7a58a9b31ed27c.png)'
- en: 'FIGURE 3.2: Visualizing the button-press data.'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.2：可视化按钮点击数据。
- en: 3.2.1.1 Specifying the model in `brms`
  id: totrans-38
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 3.2.1.1 在 `brms` 中指定模型
- en: Fit the model defined by equations [(3.2)](ch-compbda.html#eq:rtlik) and [(3.4)](ch-compbda.html#eq:rtpriors)
    with `brms` in the following way.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下方式使用 `brms` 拟合由方程 [(3.2)](ch-compbda.html#eq:rtlik) 和 [(3.4)](ch-compbda.html#eq:rtpriors)
    定义的模型。
- en: '[PRE3]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The `brms` code has some differences from a model fit with `lm()`. At this
    beginning stage, we’ll focus on the following options:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '`brms` 代码与使用 `lm()` 拟合的模型有一些不同。在这个初始阶段，我们将关注以下选项：'
- en: The term `family = gaussian()` makes it explicit that the underlying likelihood
    function is a normal distribution (Gaussian and normal are synonyms). This detail
    is implicit in the R function `lm()`. Other linking functions are possible, exactly
    as in the `glm()` function in R. The default for `brms` that corresponds to the
    `lm()` function is `family = gaussian()`.
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 术语 `family = gaussian()` 明确指出底层似然函数是正态分布（高斯和正态是同义词）。这个细节在 R 函数 `lm()` 中是隐含的。其他链接函数也是可能的，正如
    R 中的 `glm()` 函数一样。对于 `brms`，与 `lm()` 函数对应的默认值是 `family = gaussian()`。
- en: The term `prior` takes as argument a list of prior specifications. Although
    this specification of priors is optional, the researcher should always explicitly
    specify each prior. Otherwise, `brms` will define priors by default, which may
    or may not be appropriate for the research area. In cases where the distribution
    has a restricted coverage, that is, not every value is valid (e.g., smaller than
    \(0\) or larger than \(60000\) are not valid for the intercept), we need to set
    lower and upper boundaries with `lb` and `ub`.[^(12)](#fn12)
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 术语 `prior` 将一个先验规格列表作为参数。尽管这种先验规格是可选的，但研究人员应该始终明确指定每个先验。否则，`brms` 将默认定义先验，这些先验可能或可能不适合研究领域。在分布有受限覆盖范围的情况下，也就是说，不是每个值都是有效的（例如，小于
    \(0\) 或大于 \(60000\) 的截距不是有效的），我们需要使用 `lb` 和 `ub` 设置上下边界。[^(12)](#fn12)
- en: The term `chains` refers to the number of independent runs for sampling (by
    default four).
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 术语 `chains` 指的是采样（默认为四个）的独立运行次数。
- en: The term `iter` refers to the number of iterations that the sampler makes to
    sample from the posterior distribution of each parameter (by default `2000`).
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 术语`iter`指的是采样器为从每个参数的后验分布中采样所进行的迭代次数（默认为`2000`）。
- en: The term `warmup` refers to the number of iterations from the start of sampling
    that are eventually discarded (by default half of `iter`).
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 术语`warmup`指的是从采样开始到最终被丢弃的迭代次数（默认为`iter`的一半）。
- en: 'The last three options, `chains`, `iter`, `warmup` determine the behavior of
    the sampling algorithm: the No-U-Turn Sampler (NUTS; Hoffman and Gelman [2014](#ref-hoffmanNoUTurnSamplerAdaptively2014))
    extension of Hamiltonian Monte Carlo (Duane et al. [1987](#ref-duaneHybridMonteCarlo1987);
    Neal [2011](#ref-nealMCMCUsingHamiltonian2011)). We will discuss sampling in a
    bit more depth in chapter [8](ch-introstan.html#ch-introstan), but the basic process
    is explained next.'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 最后三个选项`chains`、`iter`、`warmup`决定了采样算法的行为：汉密尔顿蒙特卡洛（Hamiltonian Monte Carlo）的No-U-Turn
    Sampler（NUTS；Hoffman和Gelman [2014](#ref-hoffmanNoUTurnSamplerAdaptively2014)）扩展。我们将在第[8](ch-introstan.html#ch-introstan)章中更深入地讨论采样，但基本过程将在下面解释。
- en: 3.2.1.2 Sampling and convergence in a nutshell
  id: totrans-48
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 3.2.1.2 简要概述采样和收敛
- en: 'The following is a gross oversimplification of the sampling process: The code
    specification starts (by default) four chains independently from each other. Each
    chain “searches” for samples of the posterior distribution in a multidimensional
    space, where each parameter corresponds to a dimension. The shape of this space
    is determined by the priors and the likelihood. The chains start at random locations,
    and in each iteration they take one sample each for all the parameters. When sampling
    begins, the samples may or may not belong to the posterior distributions of the
    parameters. Eventually, the chains end up in the vicinity of the posterior distribution,
    and from that point onward the samples will belong to the posterior.'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是对采样过程的极度简化：代码规范默认从四个独立链开始。每个链在多维空间中“搜索”后验分布的样本，其中每个参数对应一个维度。这个空间的大小由先验和似然决定。链从随机位置开始，在每个迭代中为所有参数各自取一个样本。当采样开始时，样本可能属于也可能不属于参数的后验分布。最终，链将结束在后验分布的附近，从那时起，样本将属于后验。
- en: Thus, when sampling begins, the samples from the different chains can be far
    from each other, but at some point they will “converge” and start delivering samples
    from the posterior distributions. Although there are no guarantees that the number
    of iterations we run the chains for will be sufficient for obtaining samples from
    the posteriors, the default values of `brms` (and Stan) are in many cases sufficient
    to achieve convergence. When the default number of iterations does not suffice,
    `brms` (actually, Stan) will print out warnings, with suggestions for fixing the
    convergence problems. If all the chains converge to the same distribution, by
    removing the “warmup” samples, we make sure that we do not get samples from the
    initial path to the posterior distributions. The default in `brms` is that half
    of the total number of iterations in each chain (which default to 2000) will count
    as “warmup”. So, if one runs a model with four chains and the default number of
    iterations, we will obtain a total of 4000 samples from the four chains, after
    discarding the warmup iterations.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，当采样开始时，来自不同链的样本可能彼此相距甚远，但最终它们将“收敛”并开始从后验分布中提供样本。尽管我们无法保证运行链的迭代次数足以从后验分布中获得样本，但`brms`（以及Stan）的默认值在许多情况下足以实现收敛。当默认的迭代次数不足时，`brms`（实际上是Stan）将打印出警告，并提供解决收敛问题的建议。如果所有链都收敛到相同的分布，通过移除“预热”样本，我们确保不会从初始路径到后验分布中获得样本。在`brms`中，默认情况下，每个链中总迭代次数的一半（默认为2000）将计入“预热”。因此，如果使用四个链和默认迭代次数运行模型，我们将从四个链中获得总共4000个样本，在丢弃预热迭代后。
- en: Figure [3.3](ch-compbda.html#fig:fwarmup)(a) shows the path of the chains from
    the warmup phase onwards. Such plots are called traceplots. The warmup is shown
    only for illustration purposes; generally, one should only inspect the chains
    after the point where convergence has (presumably) been achieved (i.e., after
    the dashed line). After convergence has occurred, a visual diagnostic check is
    that chains should look like a “fat hairy caterpillar.” Compare the traceplots
    of our model in Figure [3.3](ch-compbda.html#fig:fwarmup)(a) with the traceplots
    of a model that did not converge, shown in Figure [3.3](ch-compbda.html#fig:fwarmup)(b).
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 图 [3.3](ch-compbda.html#fig:fwarmup)(a) 显示了从预热阶段开始的链的路径。这样的图称为轨迹图。预热只是为了说明目的；通常，应该在（假设）收敛已经达到的点之后（即虚线之后）检查链。收敛发生后，一个视觉诊断检查是链应该看起来像“胖毛毛虫”。比较图
    [3.3](ch-compbda.html#fig:fwarmup)(a) 中我们模型的轨迹图与图 [3.3](ch-compbda.html#fig:fwarmup)(b)
    中未收敛的模型的轨迹图。
- en: Traceplots are not always diagnostic as regards convergence. The traceplots
    might look fine, but the model may not have converged. Fortunately, Stan automatically
    runs several diagnostics with the information from the chains, and if there are
    no warnings after fitting the model and the traceplots look fine, we can be reasonably
    sure that the model converged, and assume that our samples are from the true posterior
    distribution. However, it is necessary to run more than one chain (preferably
    four), with a couple of thousands of iterations (at least) in order for the diagnostics
    to work.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 轨迹图并不总是关于收敛的诊断。轨迹图可能看起来很好，但模型可能没有收敛。幸运的是，Stan 会自动使用链的信息运行几个诊断，如果在拟合模型后没有警告信息，并且轨迹图看起来正常，我们可以合理地确信模型已经收敛，并假设我们的样本来自真实的后验分布。然而，为了使诊断工作，有必要运行多个链（最好是四个），并且至少有几千次迭代。
- en: '![(a) Traceplots of our brms model for the button-pressing data. All the chains
    start from initial values above 200 and are outside of the plot. (b) Traceplots
    of a model that did not converge. We can diagnose the non-convergence by the observing
    that the chains do not overlap—each chain seems to be sampling from a different
    distribution.](../Images/88e39ee2135d22bfbf43d3e82f42d9f6.png)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![（a）按钮点击数据的 brms 模型的轨迹图。所有链的起始值都高于 200，并且位于图表之外。（b）未收敛的模型的轨迹图。我们可以通过观察链没有重叠——每个链似乎是从不同的分布中进行采样的——来诊断非收敛。](../Images/88e39ee2135d22bfbf43d3e82f42d9f6.png)'
- en: 'FIGURE 3.3: (a) Traceplots of our `brms` model for the button-pressing data.
    All the chains start from initial values above `200` and are outside of the plot.
    (b) Traceplots of a model that **did not** converge. We can diagnose the non-convergence
    by the observing that the chains do not overlap—each chain seems to be sampling
    from a different distribution.'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '图 3.3: (a) 按钮点击数据的 `brms` 模型的轨迹图。所有链的起始值都高于 `200`，并且位于图表之外。(b) 未收敛的模型的轨迹图。我们可以通过观察链没有重叠——每个链似乎是从不同的分布中进行采样的——来诊断非收敛。'
- en: 3.2.1.3 Output of `brms`
  id: totrans-55
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 3.2.1.3 `brms` 的输出
- en: 'Once the model has been fit (and assuming that we got no warning messages about
    convergence problems), we can print out the samples of the posterior distributions
    of each of the parameters using `as_draws_df()` (which stores metadata about the
    chains) or with `as.data.frame()`:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦模型已经拟合（并且假设我们没有收到关于收敛问题的警告信息），我们可以使用 `as_draws_df()`（它存储有关链的元数据）或使用 `as.data.frame()`
    打印出每个参数的后验分布的样本：
- en: '[PRE4]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '[PRE5]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The term `b_Intercept` in the `brms` output corresponds to our \(\mu\). We
    can ignore the last three columns: `Intercept` is an auxiliary intercept assuming
    centered predictors, which coincides here with `b_Intercept` and is discussed
    in online section [A.3](regression-models-with-brms---extended.html#app-intercept),
    `lprior` is the log-density of the (joint) prior distribution and it is there
    for compatibility with the package `priorsense` ([https://github.com/n-kall/priorsense](https://github.com/n-kall/priorsense)),
    and `lp` is not really part of the posterior, it’s the log-density of the unnormalized
    posterior for each iteration (`lp` is discussed in online section [B.1](advanced-models-with-stan---extended.html#app-target),
    which sould be read in the context of chapter [8](ch-introstan.html#ch-introstan)).'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '`brms`输出中的`b_Intercept`项对应于我们的\(\mu\)。我们可以忽略最后三列：`Intercept`是一个假设中心预测器的辅助截距，在这里与`b_Intercept`一致，并在在线部分[A.3](regression-models-with-brms---extended.html#app-intercept)中讨论，`lprior`是（联合）先验分布的对数密度，它存在于与`priorsense`包的兼容性中（[https://github.com/n-kall/priorsense](https://github.com/n-kall/priorsense)），而`lp`实际上不是后验的一部分，它是每个迭代的未归一化后验的对数密度（`lp`在在线部分[B.1](advanced-models-with-stan---extended.html#app-target)中讨论，应在第[8](ch-introstan.html#ch-introstan)章的上下文中阅读）。'
- en: Plot the density and traceplots of each parameter after the warmup with `plot(fit_press)`
    (Figure [3.4](ch-compbda.html#fig:densitytrace)).
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`plot(fit_press)`绘制预热后的每个参数的密度和迹图（图[3.4](ch-compbda.html#fig:densitytrace)）。
- en: '![Density and traceplots of our brms model for the button-pressing data.](../Images/2921e1da57361c328e8e5cbf2e062094.png)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![按钮按压数据的`brms`模型的密度和迹图](../Images/2921e1da57361c328e8e5cbf2e062094.png)'
- en: 'FIGURE 3.4: Density and traceplots of our `brms` model for the button-pressing
    data.'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.4：按钮按压数据的`brms`模型的密度和迹图。
- en: 'Printing the object with the `brms` fit provides a nice, if somewhat verbose,
    summary:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`brms`拟合打印对象提供了一个相当详尽的总结：
- en: '[PRE6]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '[PRE7]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The `Estimate` is just the mean of the posterior samples, `Est.Error` is the
    standard deviation of the posterior and the CIs mark the lower and upper bounds
    of the 95% credible intervals (to distinguish credible intervals from frequentist
    confidence intervals, the former will be abbreviated as CrIs):'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '`Estimate`只是后验样本的均值，`Est.Error`是后验的标准差，置信区间（CIs）标记了95%可信区间的下限和上限（为了区分可信区间和频率主义置信区间，前者将缩写为CrIs）：'
- en: '[PRE8]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '[PRE9]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '[PRE10]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '[PRE11]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '[PRE12]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '[PRE13]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Furthermore, the summary provides the `Rhat`, `Bulk_ESS`, and `Tail_ESS` of
    each parameter. R-hat compares the between- and within-chain estimates of each
    parameter. R-hat is larger than 1 when chains have not mixed well, one can only
    rely on the model if the R-hats for all the parameters are less than 1.05\. (R
    warnings will appear otherwise). Bulk ESS (bulk effective sample size) is a measure
    of sampling efficiency in the bulk of the posterior distribution, that is the
    effective sample size for the mean and median estimates, whereas tail ESS (tail
    effective sample size) indicates the sampling efficiency at the tails of the distribution,
    that is the minimum of effective sample sizes for 5% and 95% quantiles. The effective
    sample size is generally smaller than the number of post-warmup samples, because
    the samples from the chains are not independent (they are correlated to some extent),
    and carry less information about the posterior distribution in comparison to independent
    samples. In some cases, however, the effective sample size is actually larger
    than the number of post-warmup samples. This might happen for parameters with
    a normally distributed posterior (in the unconstrained space, see online section
    [B.1](advanced-models-with-stan---extended.html#app-target)) and low dependence
    on the other parameters (Vehtari et al. [2021](#ref-vehtari2019ranknormalization)).
    A very low effective sample size indicates sampling problems (and is accompanied
    by R warnings) and in general appears together with chains that are not properly
    mixed. As a rule of thumb, Vehtari et al. ([2021](#ref-vehtari2019ranknormalization))
    suggest that a minimum effective sample size of \(400\) is required for statistical
    summaries.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，摘要提供了每个参数的`Rhat`、`Bulk_ESS`和`Tail_ESS`。R-hat比较了每个参数的链间和链内估计。当链没有很好地混合时，R-hat大于1，只有当所有参数的R-hats都小于1.05时，才能依赖模型。（否则将出现R警告）。Bulk
    ESS（bulk effective sample size）是后验分布主体部分的采样效率的度量，即均值和中位数估计的有效样本量，而tail ESS（tail
    effective sample size）表示分布尾部的采样效率，即5%和95%分位数的最小有效样本量。有效样本量通常小于预热后的样本数量，因为链的样本不是独立的（它们在一定程度上是相关的），并且与独立样本相比，携带有关后验分布的信息较少。然而，在某些情况下，有效样本量实际上可能大于预热后的样本数量。这可能发生在后验分布呈正态分布的参数（在无约束空间中，见在线部分[B.1](advanced-models-with-stan---extended.html#app-target)）并且对其他参数的依赖性较低（Vehtari等人[2021](#ref-vehtari2019ranknormalization)）。非常低的有效样本量表明采样问题（并伴随R警告），通常与未正确混合的链一起出现。作为经验法则，Vehtari等人([2021](#ref-vehtari2019ranknormalization))建议统计摘要至少需要有效样本量\(400\)。
- en: 'We see that we can fit our model without problems, and we get some posterior
    distributions for our parameters. However, we should ask ourselves the following
    questions before we can interpret the posterior distributions of the model:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到我们可以无问题地拟合我们的模型，并得到一些参数的后验分布。然而，在我们能够解释模型的后验分布之前，我们应该问自己以下问题：
- en: What information are the priors encoding? Do the priors make sense?
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 先验编码了哪些信息？先验有意义吗？
- en: Does the likelihood assumed in the model make sense for the data?
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 模型中假设的似然对于数据来说有意义吗？
- en: We’ll try to answer these questions by looking at the *prior and posterior predictive
    distributions*, and by doing sensitivity analyses. This is explained in the sections
    that follow.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将通过查看*先验和后验预测分布*以及进行敏感性分析来尝试回答这些问题。这将在接下来的章节中解释。
- en: 3.3 Prior predictive distribution
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.3 先验预测分布
- en: 'We had defined the following priors for our linear model:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经为我们的线性模型定义了以下先验：
- en: \[\begin{equation} \begin{aligned} \mu &\sim \mathit{Uniform}(0, 60000) \\ \sigma
    &\sim \mathit{Uniform}(0, 2000) \end{aligned} \tag{3.5} \end{equation}\]
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{equation} \begin{aligned} \mu &\sim \mathit{Uniform}(0, 60000) \\ \sigma
    &\sim \mathit{Uniform}(0, 2000) \end{aligned} \tag{3.5} \end{equation}\]
- en: These priors encode assumptions about the kind of data we would expect to see
    in a future study. To understand these assumptions, we are going to generate data
    from the model; such distribution of data, which is generated entirely by the
    prior distributions, is called the prior predictive distribution. Generating prior
    predictive distributions repeatedly helps us to check whether the priors make
    sense. What we want to know here is, do the priors generate realistic-looking
    data?
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 这些先验编码了我们对于未来研究中预期看到的数据类型的假设。为了理解这些假设，我们将从模型中生成数据；这种完全由先验分布生成的数据分布称为先验预测分布。重复生成先验预测分布有助于我们检查先验是否合理。我们在这里想了解的是，先验是否能够生成看起来真实的数据？
- en: 'Formally, we want to know the density \(p(\cdot)\) of data points \(y_{pred_1},\dots,y_{pred_N}\)
    from a data set \(\boldsymbol{y_{pred}}\) of length \(N\), given a vector of priors
    \(\boldsymbol{\Theta}\) and our likelihood \(p(\cdot|\boldsymbol{\Theta})\); (in
    our example, \(\boldsymbol{\Theta}=\langle\mu,\sigma \rangle\)). The prior predictive
    density is written as follows:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 形式上，我们想了解数据点 \(y_{pred_1},\dots,y_{pred_N}\) 的密度 \(p(\cdot)\)，这些数据点来自长度为 \(N\)
    的数据集 \(\boldsymbol{y_{pred}}\)，给定一个先验向量 \(\boldsymbol{\Theta}\) 和我们的似然函数 \(p(\cdot|\boldsymbol{\Theta})\)；（在我们的例子中，\(\boldsymbol{\Theta}=\langle\mu,\sigma
    \rangle\)）。先验预测密度如下所示：
- en: \[\begin{equation} \begin{aligned} p(\boldsymbol{y_{pred}}) &= p(y_{pred_1},\dots,y_{pred_n})\\
    &= \int_{\boldsymbol{\Theta}} p(y_{pred_1}|\boldsymbol{\Theta})\cdot p(y_{pred_2}|\boldsymbol{\Theta})\cdots
    p(y_{pred_N}|\boldsymbol{\Theta}) p(\boldsymbol{\Theta}) \, \mathrm{d}\boldsymbol{\Theta}
    \end{aligned} \end{equation}\]
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{equation} \begin{aligned} p(\boldsymbol{y_{pred}}) &= p(y_{pred_1},\dots,y_{pred_n})\\
    &= \int_{\boldsymbol{\Theta}} p(y_{pred_1}|\boldsymbol{\Theta})\cdot p(y_{pred_2}|\boldsymbol{\Theta})\cdots
    p(y_{pred_N}|\boldsymbol{\Theta}) p(\boldsymbol{\Theta}) \, \mathrm{d}\boldsymbol{\Theta}
    \end{aligned} \end{equation}\]
- en: In essence, the vector of parameters is integrated out (see section [1.7](ch-intro.html#sec-marginal)).
    This yields the probability distribution of possible data sets given the priors
    and the likelihood, *before any observations are taken into account*.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 从本质上讲，参数向量被积分出去（参见第[1.7](ch-intro.html#sec-marginal)节）。这给出了在考虑任何观察结果之前，给定先验和似然函数的可能数据集的概率分布，*在没有任何观察结果被考虑之前*。
- en: The integration can be carried out computationally by generating samples from
    the prior distribution.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 通过从先验分布中生成样本，可以通过计算方法执行积分。
- en: 'Here is one way to generate prior predictive distributions:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是生成先验预测分布的一种方法：
- en: 'Repeat the following many times:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 重复以下操作多次：
- en: Take one sample from each of the priors.
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从每个先验中取一个样本。
- en: Plug those samples into the probability density/mass function used as the likelihood
    in the model to generate a data set \(y_{pred_1},\ldots,y_{pred_n}\).
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将这些样本插入模型中用作似然函数的概率密度/质量函数，以生成数据集 \(y_{pred_1},\ldots,y_{pred_n}\)。
- en: Each sample is an imaginary or potential data set.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 每个样本是一个想象中的或潜在的数据集。
- en: 'Create a function that does this:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个执行此操作的函数：
- en: '[PRE14]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: The following code produces \(1000\) samples of the prior predictive distribution
    of the model that we defined in section [3.2.1](ch-compbda.html#sec-simplenormal).
    This means that it will produce \(361000\) predicted values (\(361\) predicted
    observations for each of the \(1000\) simulations). Although this approach works,
    it’s quite slow (a couple of seconds). See the online section [A.1](regression-models-with-brms---extended.html#app-efficientpriorpd)
    for a more efficient version of this function. Section [3.7.2](ch-compbda.html#sec-lognormal)
    will show that it’s possible to use `brms` to sample from the priors, ignoring
    the `t` in the data by setting `sample_prior = "only"`. However, since `brms`
    still depends on Stan’s sampler, which uses Hamiltonian Monte Carlo, the prior
    sampling process can also fail to converge, especially when one uses very uninformative
    priors, like the ones used in this example. In contrast, our function above, which
    uses `rnorm()`, cannot have convergence issues and will always produce multiple
    sets of prior predictive data \(y_{pred_1},\ldots,y_{pred_n}\).
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码生成了我们定义在 [3.2.1](ch-compbda.html#sec-simplenormal) 节中的模型的 \(1000\) 个先验预测分布样本。这意味着它将生成
    \(361000\) 个预测值（每个 \(1000\) 次模拟的 \(361\) 个预测观测值）。尽管这种方法可行，但它相当慢（几秒钟）。请参阅在线部分 [A.1](regression-models-with-brms---extended.html#app-efficientpriorpd)，以获取此函数的更有效版本。第
    [3.7.2](ch-compbda.html#sec-lognormal) 节将展示使用 `brms` 从先验中采样的可能性，通过设置 `sample_prior
    = "only"` 来忽略数据中的 `t`。然而，由于 `brms` 仍然依赖于 Stan 的采样器，该采样器使用汉密尔顿蒙特卡洛方法，先验采样过程也可能无法收敛，尤其是在使用非常不提供信息的先验时，例如本例中使用的先验。相比之下，我们上面使用的
    `rnorm()` 函数不会出现收敛问题，并且总是会生成多组先验预测数据 \(y_{pred_1},\ldots,y_{pred_n}\)。
- en: The code below uses the `tic()` and `toc()` functions from the `tictoc` package
    to print out the time it takes to run the code.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码使用了 `tic()` 和 `toc()` 函数从 `tictoc` 包中打印出运行代码所需的时间。
- en: '[PRE15]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '[PRE16]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '[PRE17]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '[PRE18]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '[PRE19]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Figure [3.5](ch-compbda.html#fig:priorpred-simple) shows the first 18 samples
    of the prior predictive distribution (i.e., 18 independently generated prior predicted
    data sets) with the code below.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 图 [3.5](ch-compbda.html#fig:priorpred-simple) 展示了先验预测分布的前 18 个样本（即 18 个独立生成的先验预测数据集），下面是相应的代码。
- en: '[PRE20]'
  id: totrans-101
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '![Eighteen samples from the prior predictive distribution of the model defined
    in section 3.2.1.](../Images/29726df01a7c3d4fd9275f104415874b.png)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.2.1 节中定义的模型先验预测分布的 18 个样本。](../Images/29726df01a7c3d4fd9275f104415874b.png)'
- en: 'FIGURE 3.5: Eighteen samples from the prior predictive distribution of the
    model defined in section [3.2.1](ch-compbda.html#sec-simplenormal).'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.5：[3.2.1](ch-compbda.html#sec-simplenormal) 节中定义的模型先验预测分布的 18 个样本。
- en: 'The prior predictive distribution in Figure [3.5](ch-compbda.html#fig:priorpred-simple)
    shows data sets generated from the model that are not realistic: Apart from the
    fact that the data sets show that finger tapping times distributions are symmetrical–and
    we know from prior experience with such data that they are generally right-skewed–some
    data sets present finger tapping times that are unrealistically long. Worse yet,
    if we inspect enough samples from the prior predicted data, it will become clear
    that a few data sets have negative finger tapping time values.'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 图 [3.5](ch-compbda.html#fig:priorpred-simple) 中的先验预测分布显示了由模型生成的不太现实的数据集：除了数据集显示手指敲击时间分布是对称的——我们知道从先前对这类数据的经验来看，它们通常是右偏斜的——一些数据集显示了不切实际的长手指敲击时间。更糟糕的是，如果我们检查足够的先验预测数据样本，将变得明显，有几个数据集的手指敲击时间值为负。
- en: We can also look at the distribution of summary statistics in the prior predictive
    data. Even if we don’t know beforehand what the data should look like, it’s very
    likely that we have some expectations for possible mean, minimum, or maximum values.
    For example, in the button-pressing example, it seems reasonable to assume that
    average finger tapping times are between \(200\)-\(600\) ms; finger tapping times
    are very unlikely to be below \(50\) ms, and even long lapses of attention won’t
    be greater than a couple of seconds.[^(13)](#fn13) Three distributions of summary
    statistics are shown in Figure [3.6](ch-compbda.html#fig:priorpred-stats).
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以查看先验预测数据中汇总统计量的分布。即使我们事先不知道数据应该是什么样子，我们很可能对可能的均值、最小值或最大值有一些预期。例如，在按钮按压示例中，平均手指敲击时间在
    \(200\)-\(600\) 毫秒之间似乎是合理的假设；手指敲击时间不太可能低于 \(50\) 毫秒，即使长时间的注意力分散也不会超过几秒钟。[^(13)](#fn13)
    图 [3.6](ch-compbda.html#fig:priorpred-stats) 展示了三个汇总统计量的分布。
- en: '![The prior predictive distributions of the mean, minimum, and maximum values
    of the button-pressing model defined in section 3.2.1.](../Images/6582c96d95048d11a69bd66a87b88252.png)'
  id: totrans-106
  prefs: []
  type: TYPE_IMG
  zh: '![3.2.1节中定义的按钮按压模型均值、最小值和最大值的先验预测分布](../Images/6582c96d95048d11a69bd66a87b88252.png)'
- en: 'FIGURE 3.6: The prior predictive distributions of the mean, minimum, and maximum
    values of the button-pressing model defined in section [3.2.1](ch-compbda.html#sec-simplenormal).'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.6：[3.2.1](ch-compbda.html#sec-simplenormal)节中定义的按钮按压模型均值、最小值和最大值的先验预测分布。
- en: 'Figure [3.6](ch-compbda.html#fig:priorpred-stats) shows that we used much less
    prior information than what we could have: Our priors were encoding the information
    that any mean between \(0\) and \(60000\) ms is equally likely. It seems clear
    that a value close to \(0\) or to \(60000\) ms would be extremely surprising.
    This wide range of mean values occurs because of the uniform prior on \(\mu\).
    Similarly, maximum values are quite “uniform”, spanning a much wider range than
    what one would expect. Finally, in the distribution of minimum values, negative
    finger tapping times occur. This might seem surprising (our prior for \(\mu\)
    excluded negative values), but the reason that negative values appear is that
    the prior is interpreted together with the likelihood (Gelman, Simpson, and Betancourt
    [2017](#ref-gelmanPriorCanOften2017)), and the likelihood is a normal distribution,
    which will allow for negative samples even if the location parameter \(\mu\) is
    constrained to have only positive values.'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 图[3.6](ch-compbda.html#fig:priorpred-stats)显示，我们使用的先验信息比可能有的要少得多：我们的先验编码了任何在\(0\)到\(60000\)毫秒之间的均值都是等可能的信息。显然，接近\(0\)或\(60000\)毫秒的值会非常令人惊讶。这种广泛的均值范围是由于\(\mu\)上的均匀先验造成的。同样，最大值也非常“均匀”，其范围比预期的要宽得多。最后，在最小值的分布中，出现了负的指节敲击时间。这可能会令人惊讶（我们的\(\mu\)先验排除了负值），但负值出现的原因是先验与似然性一起被解释（Gelman,
    Simpson, and Betancourt [2017](#ref-gelmanPriorCanOften2017))，而似然性是一个正态分布，即使位置参数\(\mu\)被限制为只有正值，它也会允许负样本的存在。
- en: 'To summarize the above discussion, the priors used in the example are clearly
    not very realistic given what we might know about finger tapping times for such
    a button-pressing task. This raises the question: what priors should we have chosen?
    In the next section, we consider this question.'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 总结上述讨论，示例中使用的先验显然并不非常现实，考虑到我们可能了解的此类按钮按压任务的指节敲击时间。这引发了一个问题：我们应该选择什么样的先验？在下一节中，我们将考虑这个问题。
- en: '3.4 The influence of priors: sensitivity analysis'
  id: totrans-110
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.4 先验的影响：敏感性分析
- en: For most cases that we will encounter in this book, there are four main classes
    of priors that we can choose from. Among Bayesians, there is no fixed nomenclature
    for classifying different kinds of priors. For this book, we have chosen specific
    names for each type of prior, but this is just a convention that we follow for
    consistency. There are also other classes of prior that we do not discuss in this
    book. An example is improper priors such as \(\mathit{Uniform}(-\infty,+\infty)\),
    which are not proper probability distributions because the area under the curve
    does not sum to one.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 在本书中我们将遇到的大多数情况下，我们可以从四种主要的先验类别中进行选择。在贝叶斯统计中，并没有固定的命名法来对不同的先验进行分类。对于本书，我们为每种类型的先验选择了特定的名称，但这只是一种为了保持一致性的惯例。本书中也没有讨论其他类别的先验。一个例子是不恰当的先验，如\(\mathit{Uniform}(-\infty,+\infty)\)，这些不是合适的概率分布，因为曲线下的面积不等于1。
- en: When thinking about priors, the reader should not get hung up on what precisely
    the name is for a particular type of prior; they should rather focus on what that
    prior means in the context of the research problem.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 当思考先验时，读者不应该纠结于特定类型的先验的确切名称；他们更应该关注该先验在研究问题背景下的含义。
- en: 3.4.1 Flat, uninformative priors
  id: totrans-113
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.4.1 平坦、无信息的先验
- en: 'One option is to choose priors that are as uninformative as possible. The idea
    behind this approach is to let the data “speak for itself” and to not bias the
    statistical inference with “subjective” priors. There are several issues with
    this approach: First, the prior is as subjective as the likelihood, and in fact,
    different choices of likelihood might have a much stronger impact on the posterior
    than different choices of priors. Second, uninformative priors are in general
    unrealistic because they give equal weight to all values within the support of
    the prior distribution, ignoring the fact that usually there is some minimal information
    about the parameters of interest. Usually, at the very least, the order of magnitude
    is known (response times or finger tapping times will be in milliseconds and not
    days, EEG signals some microvolts and not volts, etc.). Third, uninformative priors
    make the sampling slower and might lead to convergence problems. Unless there
    is a large amount of data, it would be wise to avoid such priors. Fourth, it is
    not always clear which parameterization of a given distribution the flat priors
    should be assigned to. For example, the normal distribution is sometimes defined
    based on its standard deviation (\(\sigma\)), variance (\(\sigma^2\)), or precision
    (\(1/\sigma^2\)): a flat prior for the standard deviation is not flat for the
    precision of the distribution. Although it is sometimes possible to find an uninformative
    prior that is invariant under a change of parameters (also called Jeffreys priors;
    Jaynes [2003](#ref-jaynes2003probability), sec. 6.15; Jeffreys [1939](#ref-jeffreys1939theory),
    Chapter 3), this is not always the case. Finally, if Bayes factors need to be
    computed, uninformative priors can lead to very misleading conclusions (chapter
    [13](ch-bf.html#ch-bf)).'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 一种选择是尽可能选择无信息的先验。这种方法的理念是让数据“自己说话”，并且不使用“主观”的先验来偏置统计推断。这种方法存在几个问题：首先，先验与似然一样主观，实际上，不同似然的选择可能对后验的影响比不同先验的选择要大得多。其次，无信息先验在一般情况下是不现实的，因为它们在先验分布的支持范围内对所有值给予相同的权重，忽略了通常对感兴趣参数有一些最小信息的事实。通常，至少，我们知道数量级（反应时间或手指敲击时间将是毫秒而不是天，脑电图信号是微伏而不是伏特等）。第三，无信息先验会使采样变慢，并可能导致收敛问题。除非有大量数据，否则明智的做法是避免这样的先验。第四，并不总是清楚给定的分布的哪种参数化应该分配平坦的先验。例如，正态分布有时是根据其标准差（\(\sigma\)）、方差（\(\sigma^2\)）或精度（\(1/\sigma^2\)）定义的：标准差的平坦先验对分布的精度来说不是平坦的。尽管有时可以找到一个无信息的先验，它在参数变化下是不变的（也称为杰弗里斯先验；Jaynes
    [2003](#ref-jaynes2003probability)，第6.15节；Jeffreys [1939](#ref-jeffreys1939theory)，第三章），但这并不总是如此。最后，如果需要计算贝叶斯因子，无信息先验可能导致非常误导性的结论（第[13](ch-bf.html#ch-bf)章）。
- en: 'In the button-pressing example discussed in this chapter, an example of a flat,
    uninformative prior would be \(\mu \sim \mathit{Uniform}(-10^{20},10^{20})\).
    On the millisecond scale, this is a very strange prior to use for a parameter
    representing mean button-pressing time: it allows for impossibly large positive
    values, and it also allows negative button-pressing times, which is of course
    impossible. It is technically possible to use such a prior, but it wouldn’t make
    much sense.'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章讨论的按钮按压示例中，一个平坦的无信息先验的例子将是 \(\mu \sim \mathit{Uniform}(-10^{20},10^{20})\)。在毫秒尺度上，这是一个非常奇怪的先验，用于表示平均按钮按压时间的参数：它允许不可能的大正值，同时也允许负的按钮按压时间，这当然是不可行的。技术上可以使用这样的先验，但这没有太多意义。
- en: 3.4.2 Regularizing priors
  id: totrans-116
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.4.2 正则化先验
- en: If there does not exist much prior information (and if this information cannot
    be worked out through reasoning about the problem), and there is enough data (what
    “enough” means here will presently become clear when we look at specific examples),
    it is fine to use *regularizing priors*. These are priors that down-weight extreme
    values (that is, they provide regularization), they are usually not very informative,
    and mostly let the likelihood dominate in determining the posteriors. These priors
    are theory-neutral; that is, they usually do not bias the parameters to values
    supported by any prior belief or theory. The idea behind this type of prior is
    to help to stabilize computation. These priors are sometimes called *weakly informative*
    or *mildly informative* priors in the Bayesian literature. For many applications,
    they perform well, but as discussed in chapter [13](ch-bf.html#ch-bf), they tend
    to be problematic if Bayes factors need to be computed.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 如果没有太多先验信息（并且这些信息不能通过关于问题的推理来得出），并且有足够的数据（“足够”的含义将在我们查看具体例子时变得清晰），使用 *正则化先验*
    是可以的。这些先验会降低极端值的权重（即，它们提供正则化），它们通常不是非常有信息量，并且主要让似然在确定后验时起主导作用。这些先验是理论中立的；也就是说，它们通常不会将参数偏向任何先验信念或理论支持的价值。这种先验背后的想法是帮助稳定计算。这些先验有时在贝叶斯文献中被称为
    *弱信息先验* 或 *温和信息先验*。对于许多应用，它们表现良好，但如第 [13](ch-bf.html#ch-bf) 章所述，如果需要计算贝叶斯因子，它们往往会有问题。
- en: In the button-pressing example, an example of a regularizing prior would be
    \(\mu \sim \mathit{Normal}_{+}(0,1000)\). This is a normal distribution prior
    truncated at \(0\) ms, and allows a relatively constrained range of positive values
    for button-pressing times (roughly, up to \(2000\) ms or so). This is a regularizing
    prior because it rules out negative button-pressing times and down-weights extreme
    values over \(2000\) ms. Here, one could assume a non-truncated prior like \(\mathit{Normal}(0,1000)\).
    This could still be seen as a regularizing prior even though we don’t expect \(\mu\)
    to be negative; the data would ensure that the posterior distribution has positive
    values (because we would have no negative button-pressing times in the data).
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 在按钮按压的例子中，一个正则化先验的例子是 \(\mu \sim \mathit{Normal}_{+}(0,1000)\)。这是一个截断在 \(0\)
    毫秒处的正态分布先验，允许按钮按压时间有相对受限的正值范围（大约，达到 \(2000\) 毫秒左右）。这是一个正则化先验，因为它排除了负的按钮按压时间，并降低了
    \(2000\) 毫秒以上的极端值。在这里，可以假设一个非截断的先验，如 \(\mathit{Normal}(0,1000)\)。即使我们不期望 \(\mu\)
    为负，这也可以被视为一个正则化先验；数据将确保后验分布具有正值（因为我们不会有负的按钮按压时间）。
- en: 3.4.3 Principled priors
  id: totrans-119
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.4.3 原则先验
- en: The idea here is to have priors that encode all (or most of) the theory-neutral
    information that the researcher has. Since one generally knows what one’s data
    do and do not look like, it is possible to build priors that truly reflect the
    properties of potential data sets, using prior predictive checks. In this book,
    many examples of this class of priors will come up.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 这里提出的想法是拥有先验，这些先验包含了研究者所拥有的所有（或大部分）与理论无关的信息。由于通常人们知道自己的数据是什么样的，以及不是什么样的，因此可以使用先验预测检查来构建真正反映潜在数据集特性的先验。在这本书中，将会出现许多这类先验的例子。
- en: In the button-pressing data, an example of a principled prior would be \(\mu
    \sim \mathit{Normal}_{+}(250,100)\). This prior is not overly restrictive, but
    represents a guess about plausible button-pressing times. Prior predictive checks
    using principled priors should produce realistic distributions of the dependent
    variable.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 在按钮按压数据中，一个原则先验的例子是 \(\mu \sim \mathit{Normal}_{+}(250,100)\)。这个先验并不过于严格，但代表了对可能的按钮按压时间的猜测。使用原则先验进行的先验预测检查应该产生依赖变量的现实分布。
- en: 3.4.4 Informative priors
  id: totrans-122
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.4.4 信息先验
- en: There are cases where a lot of prior knowledge exists. In general, unless there
    are very good reasons for having relatively informative priors (see chapter [13](ch-bf.html#ch-bf)),
    it is not a good idea to let the priors have too much influence on the posterior.
    An example where informative priors would be important is when investigating a
    language-impaired population from which we can’t get many subjects, but a lot
    of previously published papers exist on the research topic.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 存在一些情况，其中存在大量的先验知识。一般来说，除非有很好的理由使用相对信息丰富的先验（参见第 [13](ch-bf.html#ch-bf) 章），否则让先验对后验有太多影响不是一个好主意。一个信息先验很重要的例子是，当调查一个我们无法获得许多受试者的语言受损人群时，但关于研究主题已经存在大量先前发表的论文。
- en: In the button-pressing data, an informative prior could be based on a meta-analysis
    of previously published or existing data, or the result of prior elicitation from
    an expert (or multiple experts) on the topic under investigation. An example of
    an informative prior would be \(\mu \sim \mathit{Normal}_{+}(200,20)\). This prior
    will have some influence on the posterior for \(\mu\), especially when one has
    relatively sparse data.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 在按钮点击数据中，一个信息性先验可以基于先前发表或现有数据的荟萃分析，或者基于对研究主题的专家（或多位专家）进行先验提取的结果。一个信息性先验的例子是\(\mu
    \sim \mathit{Normal}_{+}(200,20)\)。这个先验将对\(\mu\)的后验产生一些影响，尤其是在数据相对稀疏的情况下。
- en: These four options constitute a continuum. The uniform prior from the last model
    (section [3.2.1](ch-compbda.html#sec-simplenormal)) falls between flat, uninformative
    and regularizing priors. In practical data analysis situations, we are mostly
    going to choose priors that fall between regularizing and principled. Informative
    priors, in the sense defined above, will be used only relatively rarely; but they
    become more important to consider when doing Bayes factor analyses (chapter [13](ch-bf.html#ch-bf)).
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 这四个选项构成一个连续体。从最后一个模型（[3.2.1](ch-compbda.html#sec-simplenormal)节）中的均匀先验位于平坦、无信息性和正则化先验之间。在实际数据分析情况下，我们大多数情况下会选择介于正则化和原则性之间的先验。按照上述定义的信息性先验将相对较少地使用；但在进行贝叶斯因子分析（第[13](ch-bf.html#ch-bf)章）时，它们变得更为重要考虑。
- en: 3.5 Revisiting the button-pressing example with different priors
  id: totrans-126
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.5 使用不同先验重新审视按钮点击示例
- en: 'What would happen if even wider priors were used for the model defined previously
    (in section [3.2.1](ch-compbda.html#sec-simplenormal))? Suppose that every value
    between \(-10^{6}\) and \(10^{6}\) ms is assumed to be equally likely for the
    location parameter \(\mu\). This prior is clearly unrealistic and actually makes
    no sense at all: we are not expecting negative finger tapping times. Regarding
    the standard deviation, one could assume that any value between \(0\) and \(10^{6}\)
    is equally likely.[^(14)](#fn14) The likelihood remains unchanged.'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 如果对之前定义的模型（在[3.2.1](ch-compbda.html#sec-simplenormal)节中）使用更宽的先验，会发生什么？假设认为\(-10^{6}\)到\(10^{6}\)毫秒之间的每个值对位置参数\(\mu\)来说都是等可能的。这个先验显然是不现实的，实际上完全没有意义：我们并不期望出现负的指节敲击时间。至于标准差，可以假设\(0\)到\(10^{6}\)之间的任何值都是等可能的。[^(14)](#fn14)似然值保持不变。
- en: \[\begin{equation} \begin{aligned} \mu &\sim \mathit{Uniform}(-10^{6}, 10^{6})
    \\ \sigma &\sim \mathit{Uniform}(0, 10^{6}) \end{aligned} \tag{3.6} \end{equation}\]
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{equation} \begin{aligned} \mu &\sim \mathit{Uniform}(-10^{6}, 10^{6})
    \\ \sigma &\sim \mathit{Uniform}(0, 10^{6}) \end{aligned} \tag{3.6} \end{equation}\]
- en: '[PRE21]'
  id: totrans-129
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: Even with these extremely unrealistic priors, which require us to change the
    number of iterations,`iter`, and `adapt_delta` and `max_treedepth` default values
    to achieve convergence, the output of the model is virtually identical to the
    previous one (see Figure [3.7](ch-compbda.html#fig:postcomp)).
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 即使使用这些极端不现实的先验，这些先验要求我们改变迭代次数`iter`以及`adapt_delta`和`max_treedepth`的默认值以实现收敛，模型的输出几乎与之前的一个相同（见图[3.7](ch-compbda.html#fig:postcomp)）。
- en: '[PRE22]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '[PRE23]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Next, consider what happens if very informative priors are used. Assume that
    mean values very close to \(400\) ms are the most likely, and that the standard
    deviation of the finger tapping times is very close to \(100\) ms. Given that
    this is a model of button-pressing times, such an informative prior seems wrong—\(200\)
    ms seems like a more realistic mean button-pressing time, not \(400\) ms. You
    can check this by doing an experiment yourself and looking at the recorded times;
    software like Linger ([http://tedlab.mit.edu/~dr/Linger/](http://tedlab.mit.edu/~dr/Linger/))
    makes it easy to set up such an experiment.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，考虑如果使用非常信息性的先验会发生什么。假设最可能的均值非常接近\(400\)毫秒，而指节敲击时间的标准差非常接近\(100\)毫秒。鉴于这是一个按钮点击时间的模型，这样的信息性先验似乎是不正确的——\(200\)毫秒似乎是一个更现实的平均按钮点击时间，而不是\(400\)毫秒。你可以通过亲自进行实验并查看记录的时间来检查这一点；Linger
    ([http://tedlab.mit.edu/~dr/Linger/](http://tedlab.mit.edu/~dr/Linger/))这样的软件使得设置这样的实验变得容易。
- en: The \(\mathit{Normal}_+\) notation indicates a normal distribution truncated
    at zero such that only positive values are allowed (see online section [A.2](regression-models-with-brms---extended.html#app-truncation)
    discusses this type of distribution in detail). Even though the prior for the
    standard deviation is restricted to be positive, we are not required to add `lb
    = 0` to the prior, and it is automatically taken into account by `brms`.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: \(\mathit{Normal}_+\) 符号表示截断在零的正态分布，只允许正值（参见在线部分 [A.2](regression-models-with-brms---extended.html#app-truncation)
    详细讨论了这种类型的分布）。尽管标准差先验被限制为正值，但我们不需要在先验中添加 `lb = 0`，`brms` 会自动考虑这一点。
- en: \[\begin{equation} \begin{aligned} \mu &\sim \mathit{Normal}(400, 10) \\ \sigma
    &\sim \mathit{Normal}_+(100, 10) \end{aligned} \tag{3.7} \end{equation}\]
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{equation} \begin{aligned} \mu &\sim \mathit{Normal}(400, 10) \\ \sigma
    &\sim \mathit{Normal}_+(100, 10) \end{aligned} \tag{3.7} \end{equation}\]
- en: '[PRE24]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Despite these unrealistic but informative priors, the likelihood mostly dominates
    and the new posterior means and credible intervals are just a couple of milliseconds
    away from the previous estimates (see Figure [3.7](ch-compbda.html#fig:postcomp)):'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管这些先验分布不切实际但富有信息性，但似然函数主要起主导作用，新的后验均值和可信区间仅比之前的估计值多出几毫秒（见图 [3.7](ch-compbda.html#fig:postcomp)）：
- en: '[PRE25]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '[PRE26]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'As a final example of a sensitivity analysis, choose some principled priors.
    Assuming that we have some prior experience with previous similar experiments,
    suppose the mean response time is expected to be around \(200\) ms, with a 95%
    probability of the mean ranging from \(0\) to \(400\) ms. This uncertainty is
    perhaps unreasonably large, but one might want to allow a bit more uncertainty
    than one really thinks is reasonable (this kind of conservativity in allowing
    somewhat more uncertainty is sometimes called Cromwell’s rule in Bayesian statistics;
    see O’Hagan and Forster [2004](#ref-kendall2004), sec. 3.19). In such a case,
    one can decide on the prior \(\mathit{Normal}(200, 100)\). Given that the experiment
    involves only one subject and the task is very simple, one might not expect the
    residual standard deviation \(\sigma\) to be very large: As an example, one can
    settle on a location of \(50\) ms for a truncated normal distribution, but still
    allow for relatively large uncertainty: \(Normal_{+}(50,50)\). The prior specifications
    are summarized below.'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 作为敏感性分析的最终示例，选择一些原则性的先验。假设我们有一些先前类似实验的经验，假设平均响应时间预计在 \(200\) 毫秒左右，平均值的 95% 置信区间从
    \(0\) 到 \(400\) 毫秒。这种不确定性可能过大，但可能希望允许比实际认为合理的更多的不确定性（这种在允许更多不确定性方面的保守性有时在贝叶斯统计中被称为克罗默尔规则；参见
    O’Hagan 和 Forster [2004](#ref-kendall2004)，第 3.19 节）。在这种情况下，可以选择先验 \(\mathit{Normal}(200,
    100)\)。鉴于实验只涉及一个受试者且任务非常简单，可能不会期望残差标准差 \(\sigma\) 很大：例如，可以选择截断正态分布的位置为 \(50\)
    毫秒，但仍允许相对较大的不确定性：\(Normal_{+}(50,50)\)。先验规格总结如下。
- en: \[\begin{equation} \begin{aligned} \mu &\sim \mathit{Normal}(200, 100) \\ \sigma
    &\sim \mathit{Normal}_+(50, 50) \end{aligned} \end{equation}\]
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{equation} \begin{aligned} \mu &\sim \mathit{Normal}(200, 100) \\ \sigma
    &\sim \mathit{Normal}_+(50, 50) \end{aligned} \end{equation}\]
- en: Why are these priors principled? The designation “principled” here largely depends
    on our domain knowledge. The online chapter [E](ch-priors.html#ch-priors) discusses
    how one can use domain knowledge when specifying priors.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 为什么这些先验是原则性的？这里的“原则性”在很大程度上取决于我们的领域知识。在线章节 [E](ch-priors.html#ch-priors) 讨论了在指定先验时如何使用领域知识。
- en: One can achieve a better understanding of what a particular set of priors implies
    by visualizing the priors graphically, and carrying out prior predictive checks.
    These steps are skipped here, but these issues are discussed in detail in the
    online chapters [E](ch-priors.html#ch-priors) and [F](ch-workflow.html#ch-workflow).
    These chapters will give more detailed information about choosing priors and on
    developing a principled workflow for Bayesian data analysis.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 通过图形化地展示先验分布并进行先验预测检验，可以更好地理解特定一组先验分布的含义。这些步骤在这里被省略了，但这些内容在在线章节 [E](ch-priors.html#ch-priors)
    和 [F](ch-workflow.html#ch-workflow) 中有详细讨论。这些章节将提供更多关于选择先验和开发贝叶斯数据分析的原理性工作流程的详细信息。
- en: '[PRE27]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'The new estimates are virtually the same as before (see Figure [3.7](ch-compbda.html#fig:postcomp)):'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 新的估计值几乎与之前相同（见图 [3.7](ch-compbda.html#fig:postcomp)）：
- en: '[PRE28]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '[PRE29]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: The above examples of using different priors should not be misunderstood to
    mean that priors never matter. When there is enough data, the likelihood will
    dominate in determining the posterior distributions. What constitutes “enough”
    data is also a function of the complexity of the model; as a general rule, more
    complex models require more data.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 上述使用不同先验的例子不应被误解为先验从不重要。当有足够的数据时，似然函数将在确定后验分布中占主导地位。构成“足够”数据的标准也是模型复杂性的函数；一般来说，更复杂的模型需要更多的数据。
- en: '![Comparison of the posterior distributions from the model with “realistically”
    bounded uniform prior distribution (though still not recommended), fit_press,
    against the model with extremely unrealistically wide priors, fit_press_unif,
    the model with misspecified informative priors, fit_press_inf, and the model with
    principled priors, fit_press_prin. All the posteriors virtually overlap except
    for the posterior of fit_press_inf, which is shifted by a few milliseconds.](../Images/6b8b133fb6c8ee6ae69b7a0aaea21ef2.png)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![比较具有“现实”上界均匀先验分布（尽管仍不推荐）的模型后验分布 fit_press 与具有极不切实际宽泛先验的模型 fit_press_unif、具有误指定信息先验的模型
    fit_press_inf 和具有原则性先验的模型 fit_press_prin。所有后验几乎重叠，除了 fit_press_inf 的后验，它被移动了几毫秒。](../Images/6b8b133fb6c8ee6ae69b7a0aaea21ef2.png)'
- en: 'FIGURE 3.7: Comparison of the posterior distributions from the model with “realistically”
    bounded uniform prior distribution (though still not recommended), `fit_press`,
    against the model with extremely unrealistically wide priors, `fit_press_unif`,
    the model with misspecified informative priors, `fit_press_inf`, and the model
    with principled priors, `fit_press_prin`. All the posteriors virtually overlap
    except for the posterior of `fit_press_inf`, which is shifted by a few milliseconds.'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.7：比较具有“现实”上界均匀先验分布（尽管仍不推荐）的模型后验分布 `fit_press` 与具有极不切实际宽泛先验的模型 `fit_press_unif`、具有误指定信息先验的模型
    `fit_press_inf` 和具有原则性先验的模型 `fit_press_prin`。所有后验几乎重叠，除了 `fit_press_inf` 的后验，它被移动了几毫秒。
- en: Even in cases where there is enough data and the likelihood dominates in determining
    the posteriors, regularizing, principled priors (i.e., priors that are more consistent
    with our a priori beliefs about the data) will in general speed-up model convergence.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 即使在数据足够且似然函数在确定后验分布中占主导地位的情况下，正则化、原则性的先验（即与我们关于数据的先验信念更一致的先验）通常可以加速模型收敛。
- en: 'In order to determine the extent to which the posterior is influenced by the
    priors, it is a good practice to carry out a sensitivity analysis: try different
    priors and either verify that the posterior doesn’t change drastically, or report
    how the posterior is affected by some specific priors (for examples from psycholinguistics,
    see Vasishth et al. [2013](#ref-VasishthetalPLoSOne2013); Vasishth and Engelmann
    [2022](#ref-VasishthEngelmann2022)). Chapter [13](ch-bf.html#ch-bf) will demonstrate
    that sensitivity analysis becomes crucial for reporting Bayes factors; even in
    cases where the choice of priors does not affect the posterior distribution, it
    generally affects the Bayes factor.'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 为了确定后验受到先验影响的程度，进行敏感性分析是一个好习惯：尝试不同的先验，要么验证后验没有发生剧烈变化，要么报告后验如何受到某些特定先验的影响（例如，从心理语言学中，参见
    Vasishth 等人 [2013](#ref-VasishthetalPLoSOne2013)；Vasishth 和 Engelmann [2022](#ref-VasishthEngelmann2022)）。第
    [13](ch-bf.html#ch-bf) 章将演示敏感性分析对于报告贝叶斯因子至关重要；即使在先验的选择不影响后验分布的情况下，它通常也会影响贝叶斯因子。
- en: 3.6 Posterior predictive distribution
  id: totrans-153
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.6 后验预测分布
- en: The posterior predictive distribution is a collection of data sets generated
    from the model (the likelihood and the priors). Having obtained the posterior
    distributions of the parameters after taking into account the data, the posterior
    distributions can be used to generate future data from the model. In other words,
    given the posterior distributions of the parameters of the model, the posterior
    predictive distribution gives us some indication of what future data might look
    like.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 后验预测分布是从模型（似然函数和先验）生成的数据集的集合。在考虑数据后获得参数的后验分布后，可以使用后验分布从模型生成未来的数据。换句话说，给定模型参数的后验分布，后验预测分布为我们提供了关于未来数据可能看起来像什么的某些指示。
- en: 'Once the posterior distributions \(p(\boldsymbol{\Theta}\mid \boldsymbol{y})\)
    are available, the predictions based on these distributions can be generated by
    integrating out the parameters:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦得到后验分布 \(p(\boldsymbol{\Theta}\mid \boldsymbol{y})\)，可以通过积分参数来生成基于这些分布的预测：
- en: \[\begin{equation} p(\boldsymbol{y_{pred}}\mid \boldsymbol{y} ) = \int_{\boldsymbol{\Theta}}
    p(\boldsymbol{y_{pred}}, \boldsymbol{\Theta}\mid \boldsymbol{y})\, \mathrm{d}\boldsymbol{\Theta}=
    \int_{\boldsymbol{\Theta}} p(\boldsymbol{y_{pred}}\mid \boldsymbol{\Theta},\boldsymbol{y})p(\boldsymbol{\Theta}\mid
    \boldsymbol{y})\, \mathrm{d}\boldsymbol{\Theta} \end{equation}\]
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{equation} p(\boldsymbol{y_{pred}}\mid \boldsymbol{y} ) = \int_{\boldsymbol{\Theta}}
    p(\boldsymbol{y_{pred}}, \boldsymbol{\Theta}\mid \boldsymbol{y})\, \mathrm{d}\boldsymbol{\Theta}=
    \int_{\boldsymbol{\Theta}} p(\boldsymbol{y_{pred}}\mid \boldsymbol{\Theta},\boldsymbol{y})p(\boldsymbol{\Theta}\mid
    \boldsymbol{y})\, \mathrm{d}\boldsymbol{\Theta} \end{equation}\]
- en: 'Assuming that past and future observations are conditionally independent[^(15)](#fn15)
    given \(\boldsymbol{\Theta}\), i.e., \(p(\boldsymbol{y_{pred}}\mid \boldsymbol{\Theta},\boldsymbol{y})=
    p(\boldsymbol{y_{pred}}\mid \boldsymbol{\Theta})\), the above equation can be
    written as:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 假设给定 \(\boldsymbol{\Theta}\) 的条件下，过去和未来的观测是条件独立的[^(15)](#fn15)，即 \(p(\boldsymbol{y_{pred}}\mid
    \boldsymbol{\Theta},\boldsymbol{y})= p(\boldsymbol{y_{pred}}\mid \boldsymbol{\Theta})\)，则上述方程可以写为：
- en: \[\begin{equation} p(\boldsymbol{y_{pred}}\mid \boldsymbol{y} )=\int_{\boldsymbol{\Theta}}
    p(\boldsymbol{y_{pred}}\mid \boldsymbol{\Theta}) p(\boldsymbol{\Theta}\mid \boldsymbol{y})\,
    \mathrm{d}\boldsymbol{\Theta} \tag{3.8} \end{equation}\]
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{equation} p(\boldsymbol{y_{pred}}\mid \boldsymbol{y} )=\int_{\boldsymbol{\Theta}}
    p(\boldsymbol{y_{pred}}\mid \boldsymbol{\Theta}) p(\boldsymbol{\Theta}\mid \boldsymbol{y})\,
    \mathrm{d}\boldsymbol{\Theta} \tag{3.8} \end{equation}\]
- en: In Equation [(3.8)](ch-compbda.html#eq:postpp), we are conditioning \(\boldsymbol{y_{pred}}\)
    only on \(\boldsymbol{y}\), we do not condition on what we don’t know (\(\boldsymbol{\Theta}\));
    the unknown parameters have been integrated out. This posterior predictive distribution
    has important differences from predictions obtained with the frequentist approach.
    The frequentist approach gives a point estimate of each predicted observation
    given the maximum likelihood estimate of \(\boldsymbol{\Theta}\) (a point value),
    whereas the Bayesian approach gives a distribution of values for each predicted
    observation. As with the prior predictive distribution, the integration can be
    carried out computationally by generating samples from the posterior predictive
    distribution. The same function that we created before, `normal_predictive_distribution()`,
    can be used here. The only difference is that instead of sampling `mu` and `sigma`
    from the priors, the samples come from the posterior.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 在方程 [(3.8)](ch-compbda.html#eq:postpp) 中，我们只对 \(\boldsymbol{y_{pred}}\) 进行了关于
    \(\boldsymbol{y}\) 的条件化，我们没有对未知的内容（\(\boldsymbol{\Theta}\)）进行条件化；未知参数已经被积分掉了。这个后验预测分布与使用频率主义方法获得的预测有重要区别。频率主义方法给出了每个预测观测的最大似然估计
    \(\boldsymbol{\Theta}\)（一个点值）的点估计，而贝叶斯方法给出了每个预测观测的值分布。与先验预测分布一样，积分可以通过从后验预测分布中生成样本来计算。我们之前创建的相同函数
    `normal_predictive_distribution()` 可以在这里使用。唯一的区别是，我们不是从先验中采样 `mu` 和 `sigma`，而是从后验中采样。
- en: '[PRE30]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '[PRE31]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: The `brms` function `posterior_predict()` is a convenient function that delivers
    samples from the posterior predictive distribution. Using the command `posterior_predict(fit_press)`
    yields the predicted finger tapping times in a matrix, with the samples as rows
    and the observations (data-points) as columns. (Bear in mind that if a model is
    fit with `sample_prior = "only"`, the dependent variable is ignored and `posterior_predict()`
    will yield samples from the prior predictive distribution).
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: '`brms` 函数中的 `posterior_predict()` 是一个方便的函数，它提供了后验预测分布的样本。使用 `posterior_predict(fit_press)`
    命令可以得到矩阵形式的预测指关节敲击时间，其中样本作为行，观测值（数据点）作为列。请注意，如果模型使用 `sample_prior = "only"` 进行拟合，则因变量将被忽略，`posterior_predict()`
    将从先验预测分布中产生样本）。'
- en: The posterior predictive distribution can be used to examine the “descriptive
    adequacy” of the model under consideration (Gelman et al. [2014](#ref-Gelman14),
    Chapter 6; Shiffrin et al. [2008](#ref-shiffrinSurveyModelEvaluation2008)). Examining
    the posterior predictive distribution to establish descriptive adequacy is called
    posterior predictive checking. The goal here is to establish that the posterior
    predictive data look more or less similar to the observed data. Achieving descriptive
    adequacy means that the current data could have been generated by the model. Although
    passing a test of descriptive adequacy is not strong evidence in favor of a model,
    a major failure in descriptive adequacy can be interpreted as strong evidence
    against a model (Shiffrin et al. [2008](#ref-shiffrinSurveyModelEvaluation2008)).
    For this reason, comparing the descriptive adequacy of different models is not
    enough to differentiate between their relative performance.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 后验预测分布可用于检验所考虑模型的“描述性充分性”（Gelman 等人 [2014](#ref-Gelman14)，第 6 章；Shiffrin 等人
    [2008](#ref-shiffrinSurveyModelEvaluation2008)）。通过检验后验预测分布以建立描述性充分性被称为后验预测检验。此处的目标是建立后验预测数据与观察数据大致相似。实现描述性充分性意味着当前数据可能是由该模型生成的。尽管通过描述性充分性测试并不是支持模型的强有力证据，但描述性充分性方面的重大失败可以解释为反对该模型的强有力证据（Shiffrin
    等人 [2008](#ref-shiffrinSurveyModelEvaluation2008)）。因此，比较不同模型的描述性充分性不足以区分它们的相对性能。
- en: When doing model comparison, it is important to consider the criteria that Roberts
    and Pashler ([2000](#ref-rp)) define. Although Roberts and Pashler ([2000](#ref-rp))
    are more interested in process models and not necessarily Bayesian models, their
    criteria are important for any kind of model comparison. Their main point is that
    it is not enough to have a good fit to the data for a model to be convincing.
    One should check that the range of predictions that the model makes is reasonably
    constrained; if a model can capture any possible outcome, then the model fit to
    a particular data set is not so informative. In the Bayesian modeling context,
    although posterior predictive checks are important, they should been as only sanity
    checks to assess whether the model behavior is reasonable (for more on this point,
    see the online chapter [F](ch-workflow.html#ch-workflow)).
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行模型比较时，考虑 Roberts 和 Pashler ([2000](#ref-rp)) 定义的准则很重要。尽管 Roberts 和 Pashler
    ([2000](#ref-rp)) 对过程模型更感兴趣，而不一定是贝叶斯模型，但他们的准则对任何类型的模型比较都很重要。他们的主要观点是，一个模型仅仅与数据拟合良好是不够的。应该检查模型做出的预测范围是否合理约束；如果一个模型可以捕捉任何可能的结果，那么该模型对特定数据集的拟合就不那么有信息量了。在贝叶斯建模的背景下，尽管后验预测检验很重要，但它们应被视为仅作为合理性检查来评估模型行为是否合理（关于这一点，请参阅在线章节
    [F](ch-workflow.html#ch-workflow)）。
- en: In many cases, one can simply use the plotting functions provided with `brms`
    (these act as wrappers for `bayesplot` functions). For example, the plotting function
    `pp_check()` takes as arguments the model, the number of predicted data sets,
    and the type of visualization, and it can display different visualizations of
    posterior predictive checks. In these type of plots, the observed data are plotted
    as \(y\) and predicted data as \(y_{rep}\). Below, we use `pp_check()` to investigate
    how well the observed distribution of finger tapping times fit our model based
    on some number (\(11\) and \(100\)) of samples of the posterior predictive distributions
    (that is, simulated data sets); see Figures [3.8](ch-compbda.html#fig:normalppc)
    and [3.9](ch-compbda.html#fig:normalppc2).
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多情况下，可以简单地使用 `brms` 提供的绘图函数（这些函数作为 `bayesplot` 函数的包装器）。例如，绘图函数 `pp_check()`
    以模型、预测数据集的数量和可视化类型为参数，可以显示后验预测检验的不同可视化。在这些类型的图表中，观察数据被绘制为 \(y\)，预测数据被绘制为 \(y_{rep}\)。下面，我们使用
    `pp_check()` 来调查观察到的手指敲击时间分布与基于某些数量（\(11\) 和 \(100\)）的后验预测分布样本（即模拟数据集）的模型拟合情况；请参阅图
    [3.8](ch-compbda.html#fig:normalppc) 和 [3.9](ch-compbda.html#fig:normalppc2)。
- en: '[PRE32]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: '![Histograms of eleven samples from the posterior predictive distribution of
    the model fit_press (\(y_{rep}\)).](../Images/6950f5f2641ead399d16632ff5700d14.png)'
  id: totrans-167
  prefs: []
  type: TYPE_IMG
  zh: '![模型 fit_press (\(y_{rep}\)) 后验预测分布的十一样本直方图。](../Images/6950f5f2641ead399d16632ff5700d14.png)'
- en: 'FIGURE 3.8: Histograms of eleven samples from the posterior predictive distribution
    of the model `fit_press` (\(y_{rep}\)).'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.8：模型 `fit_press` (\(y_{rep}\)) 后验预测分布的十一样本直方图。
- en: '[PRE33]'
  id: totrans-169
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: '![A posterior predictive check that shows the fit of the model fit_press in
    comparison to data sets from the posterior predictive distribution using an overlay
    of density plots.](../Images/d76b604646bdfb12fbc2a645d03546f6.png)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![后验预测检查图，显示了模型 fit_press 与后验预测分布数据集的拟合情况，使用密度图叠加。](../Images/d76b604646bdfb12fbc2a645d03546f6.png)'
- en: 'FIGURE 3.9: A posterior predictive check that shows the fit of the model `fit_press`
    in comparison to data sets from the posterior predictive distribution using an
    overlay of density plots.'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.9：后验预测检查图，显示了模型 `fit_press` 与后验预测分布数据集的拟合情况，使用密度图叠加。
- en: The data is slightly skewed and has no values smaller than \(100\) ms, but the
    predictive distributions are centered and symmetrical; see Figures [3.8](ch-compbda.html#fig:normalppc)
    and [3.9](ch-compbda.html#fig:normalppc2). This posterior predictive check shows
    a slight mismatch between the observed and predicted data. Can we build a better
    model? We’ll come back to this issue in the next section.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 数据略微偏斜，且没有小于 \(100\) 毫秒的值，但预测分布是中心对称的；参见图 [3.8](ch-compbda.html#fig:normalppc)
    和 [3.9](ch-compbda.html#fig:normalppc2)。这个后验预测检查显示了观察数据和预测数据之间有轻微的不匹配。我们能否构建一个更好的模型？我们将在下一节回到这个问题。
- en: 3.7 The influence of the likelihood
  id: totrans-173
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.7 似然的影响
- en: Finger tapping times (and response times in general) are not usually normally
    distributed. A more realistic distribution is the log-normal. A random variable
    (such as time) that is log-normally distributed takes only positive real values
    and is right-skewed. Although other distributions can also produce data with such
    properties, the log-normal will turn out to be a pretty reasonable distribution
    for finger tapping times and response times.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 手指敲击时间（以及一般响应时间）通常不是正态分布。更现实的分布是对数正态分布。一个对数正态分布的随机变量（如时间）只取正实数值，并且是右偏的。尽管其他分布也可以产生具有这种特性的数据，但对数正态分布对于手指敲击时间和响应时间来说将是一个非常合理的分布。
- en: 3.7.1 The log-normal likelihood
  id: totrans-175
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.7.1 对数似然
- en: If \(\boldsymbol{y}\) is log-normally distributed, this means that \(\log(\boldsymbol{y})\)
    is normally distributed.[^(16)](#fn16) The log-normal distribution is also defined
    using the parameters location, \(\mu\), and scale, \(\sigma\), but these are on
    the log ms scale; they correspond to the mean and standard deviation of the logarithm
    of the data \(\boldsymbol{y}\), \(\log(\boldsymbol{y})\), which will be normally
    distributed. Thus, when we model some data \(\boldsymbol{y}\) using the log-normal
    likelihood, the parameters \(\mu\) and \(\sigma\) are on a different scale than
    the data \(\boldsymbol{y}\). Equation [(3.9)](ch-compbda.html#eq:lognormalequations)
    shows the relationship between the log-normal and the normal.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 \(\boldsymbol{y}\) 是对数正态分布的，这意味着 \(\log(\boldsymbol{y})\) 是正态分布的。[^(16)](#fn16)
    对数正态分布也是通过位置参数 \(\mu\) 和尺度参数 \(\sigma\) 定义的，但这些参数是在对数毫秒尺度上；它们对应于数据 \(\boldsymbol{y}\)
    的对数 \(\log(\boldsymbol{y})\) 的均值和标准差，这将服从正态分布。因此，当我们使用对数正态似然模型来建模一些数据 \(\boldsymbol{y}\)
    时，参数 \(\mu\) 和 \(\sigma\) 的尺度与数据 \(\boldsymbol{y}\) 不同。方程 [(3.9)](ch-compbda.html#eq:lognormalequations)
    展示了对数正态分布和正态分布之间的关系。
- en: \[\begin{equation} \begin{aligned} \log(\boldsymbol{y}) &\sim \mathit{Normal}(
    \mu, \sigma)\\ \boldsymbol{y} &\sim \mathit{LogNormal}( \mu, \sigma) \end{aligned}
    \tag{3.9} \end{equation}\]
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{equation} \begin{aligned} \log(\boldsymbol{y}) &\sim \mathit{Normal}(
    \mu, \sigma)\\ \boldsymbol{y} &\sim \mathit{LogNormal}( \mu, \sigma) \end{aligned}
    \tag{3.9} \end{equation}\]
- en: We can obtain samples from the log-normal distribution, using the normal distribution
    by first setting an auxiliary variable \(z\), so that \(z = \log(y)\). This means
    that \(z \sim \mathit{Normal}(\mu, \sigma)\). Then we can just use \(exp(z)\)
    as samples from the \(\mathit{LogNormal}(\mu, \sigma)\), since \(\exp(z) =\exp(\log(y))
    = y\). The code below produces Figure [3.10](ch-compbda.html#fig:logndemo).
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过首先设置一个辅助变量 \(z\)，使得 \(z = \log(y)\)，然后使用正态分布来从对数正态分布中获取样本。这意味着 \(z \sim
    \mathit{Normal}(\mu, \sigma)\)。然后我们可以使用 \(exp(z)\) 作为 \(\mathit{LogNormal}(\mu,
    \sigma)\) 的样本，因为 \(\exp(z) =\exp(\log(y)) = y\)。下面的代码生成了图 [3.10](ch-compbda.html#fig:logndemo)。
- en: '[PRE34]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: '![Two log-normal distributions with the same parameters generated by either
    generating samples from a log-normal distribution or exponentiating samples from
    a normal distribution.](../Images/318135851e5c540b9fc30bb9b6f93ee6.png)![Two log-normal
    distributions with the same parameters generated by either generating samples
    from a log-normal distribution or exponentiating samples from a normal distribution.](../Images/081dffb48f09a996b139aad827733364.png)'
  id: totrans-180
  prefs: []
  type: TYPE_IMG
  zh: '![由生成来自对数正态分布的样本或对来自正态分布的样本进行指数运算生成的具有相同参数的两个对数正态分布](../Images/318135851e5c540b9fc30bb9b6f93ee6.png)![由生成来自对数正态分布的样本或对来自正态分布的样本进行指数运算生成的具有相同参数的两个对数正态分布](../Images/081dffb48f09a996b139aad827733364.png)'
- en: 'FIGURE 3.10: Two log-normal distributions with the same parameters generated
    by either generating samples from a log-normal distribution or exponentiating
    samples from a normal distribution.'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.10：由生成来自对数正态分布的样本或对来自正态分布的样本进行指数运算生成的具有相同参数的两个对数正态分布。
- en: 3.7.2 Using a log-normal likelihood to fit data from a single subject pressing
    a button repeatedly
  id: totrans-182
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.7.2 使用对数正态似然拟合单个受试者重复按按钮的数据
- en: 'If we assume that finger tapping times are log-normally distributed, the likelihood
    function changes as follows:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们假设手指敲击时间是按对数正态分布的，似然函数将按以下方式变化：
- en: \[\begin{equation} t_n \sim \mathit{LogNormal}(\mu,\sigma) \end{equation}\]
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{equation} t_n \sim \mathit{LogNormal}(\mu,\sigma) \end{equation}\]
- en: But now the scale of the priors needs to change! Let’s start with uniform priors
    for ease of exposition, even though, as we mentioned earlier, these are not really
    appropriate here. (More realistic priors are discussed below.)
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 但现在先验的尺度需要改变！为了便于说明，让我们从均匀先验开始，尽管我们之前提到，这些在这里实际上并不合适。（更现实的先验将在下面讨论。）
- en: \[\begin{equation} \begin{aligned} \mu &\sim \mathit{Uniform}(0, 11) \\ \sigma
    &\sim \mathit{Uniform}(0, 1) \\ \end{aligned} \tag{3.10} \end{equation}\]
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{equation} \begin{aligned} \mu &\sim \mathit{Uniform}(0, 11) \\ \sigma
    &\sim \mathit{Uniform}(0, 1) \\ \end{aligned} \tag{3.10} \end{equation}\]
- en: 'Because the parameters are on a different scale than the dependent variable,
    their interpretation changes and it is more complex than if we were dealing with
    a linear model that assumes a normal likelihood (location and scale do not coincide
    with the mean and standard deviation of the log-normal):'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 因为参数的尺度与因变量不同，它们的解释方式发生变化，并且比我们处理假设正态似然（位置和尺度与对数正态分布的均值和标准差不一致）的线性模型更为复杂：
- en: '*The location \(\mu\)*: In our previous linear model, \(\mu\) represented the
    mean (in a normal distribution, the mean happens to be identical to the median
    and the mode). But now, the mean needs to be calculated by computing \(\exp(\mu
    +\sigma ^{2}/2)\). In other words, in the log-normal, the mean is dependent on
    both \(\mu\) and \(\sigma\). The median is just \(\exp(\mu)\). Notice that the
    prior of \(\mu\) is not on the milliseconds scale, but rather on the log milliseconds
    scale.'
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*位置 \(\mu\)*：在我们之前的线性模型中，\(\mu\) 代表均值（在正态分布中，均值恰好与中位数和众数相同）。但现在，均值需要通过计算 \(\exp(\mu
    +\sigma ^{2}/2)\) 来得出。换句话说，在对数正态分布中，均值依赖于 \(\mu\) 和 \(\sigma\)。中位数仅仅是 \(\exp(\mu)\)。请注意，\(\mu\)
    的先验不是以毫秒为尺度，而是以对数毫秒为尺度。'
- en: '*The scale \(\sigma\)*: This is the standard deviation of the normal distribution
    of \(\log(\boldsymbol{y})\). The standard deviation of a log-normal distribution
    with *location* \(\mu\) and *scale* \(\sigma\) will be \(\exp(\mu +\sigma ^{2}/2)\times
    \sqrt{\exp(\sigma^2)- 1}\). Unlike the normal distribution, the spread of the
    log-normal distribution depends on both \(\mu\) and \(\sigma\).'
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*尺度 \(\sigma\)*：这是 \(\log(\boldsymbol{y})\) 的正态分布的标准差。具有 *位置* \(\mu\) 和 *尺度*
    \(\sigma\) 的对数正态分布的标准差将是 \(\exp(\mu +\sigma ^{2}/2)\times \sqrt{\exp(\sigma^2)-
    1}\)。与正态分布不同，对数正态分布的分散程度依赖于 \(\mu\) 和 \(\sigma\)。'
- en: To understand the meaning of the priors on the millisecond scale, both the priors
    and the likelihood need to be taken into account. Generating a prior predictive
    distribution will help in interpreting the priors. This distribution can be generated
    by just exponentiating the samples produced by `normal_predictive_distribution()`
    (or, alternatively, edit the function by replacing `rnorm()` with `rlnorm()`).
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 为了理解毫秒尺度上先验的意义，需要考虑先验和似然。生成先验预测分布将有助于解释先验。这个分布可以通过仅对 `normal_predictive_distribution()`
    生成的样本进行指数运算来生成（或者，也可以通过替换 `rnorm()` 为 `rlnorm()` 来编辑该函数）。
- en: '[PRE35]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: Next, plot the distribution of some representative statistics; see Figure [3.11](ch-compbda.html#fig:priorpredlogunif).
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，绘制一些代表性统计量的分布；见图 [3.11](ch-compbda.html#fig:priorpredlogunif)。
- en: '![The prior predictive distribution of the mean, median, minimum, and maximum
    value of the log-normal model with priors defined in Equation (3.10), that is
    \(\mu \sim \mathit{Uniform}(0, 11)\) and \(\sigma \sim \mathit{Uniform}(0, 1)\).
    The x-axis shows values back-transformed from the log-scale.](../Images/50718c6c0e8d62a9daf6747ae835b69d.png)'
  id: totrans-193
  prefs: []
  type: TYPE_IMG
  zh: '![具有在方程 (3.10) 中定义的先验的对数正态模型均值、中位数、最小值和最大值的前验预测分布，即 \(\mu \sim \mathit{Uniform}(0,
    11)\) 和 \(\sigma \sim \mathit{Uniform}(0, 1)\)。x 轴显示从对数尺度转换回来的值。](../Images/50718c6c0e8d62a9daf6747ae835b69d.png)'
- en: 'FIGURE 3.11: The prior predictive distribution of the mean, median, minimum,
    and maximum value of the log-normal model with priors defined in Equation [(3.10)](ch-compbda.html#eq:logpriorsunif),
    that is \(\mu \sim \mathit{Uniform}(0, 11)\) and \(\sigma \sim \mathit{Uniform}(0,
    1)\). The x-axis shows values back-transformed from the log-scale.'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.11：具有在方程 [(3.10)](ch-compbda.html#eq:logpriorsunif) 中定义的先验的对数正态模型均值、中位数、最小值和最大值的前验预测分布，即
    \(\mu \sim \mathit{Uniform}(0, 11)\) 和 \(\sigma \sim \mathit{Uniform}(0, 1)\)。x
    轴显示从对数尺度转换回来的值。
- en: 'We cannot generate negative values any more, since \(\exp(\)any finite real
    number\() > 0\). These priors might work in the sense that the model might converge;
    but it would be better to have regularizing priors for the model. An example of
    regularizing priors:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 \(\exp(\)任何有限实数\() > 0\)，我们不能再生成负值。这些先验可能在模型收敛的意义上起作用；但最好为模型提供正则化先验。正则化先验的一个例子：
- en: \[\begin{equation} \begin{aligned} \mu &\sim \mathit{Normal}(6, 1.5) \\ \sigma
    &\sim \mathit{Normal}_+(0, 1) \\ \end{aligned} \tag{3.11} \end{equation}\]
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{equation} \begin{aligned} \mu &\sim \mathit{Normal}(6, 1.5) \\ \sigma
    &\sim \mathit{Normal}_+(0, 1) \\ \end{aligned} \tag{3.11} \end{equation}\]
- en: 'The prior for \(\sigma\) here is a truncated distribution, and although its
    location is zero, this is not its mean. We can calculate its approximate mean
    from a large number of random samples of the prior distribution using the function
    `rtnorm()` from the package `extraDistr`. In this function, we have to set the
    parameter `a = 0` to express the fact that the normal distribution is truncated
    from the left at 0\. (Online section [A.2](regression-models-with-brms---extended.html#app-truncation)
    discusses this type of distribution in detail):'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 这里 \(\sigma\) 的先验是一个截断分布，尽管其位置是零，但这不是它的均值。我们可以使用 `extraDistr` 包中的 `rtnorm()`
    函数从先验分布的大量随机样本中计算出其近似均值。在这个函数中，我们必须将参数 `a = 0` 设置为表达正态分布从左侧截断在 0 的事实。（在线部分 [A.2](regression-models-with-brms---extended.html#app-truncation)
    详细讨论了这种类型的分布）：
- en: '[PRE36]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: '[PRE37]'
  id: totrans-199
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'Even before generating the prior predictive distributions, we can calculate
    the range within which we are 95% sure that the expected median of the observations
    will lie. We do this by looking at what happens at two standard deviations away
    from the mean of the prior, \(\mu\), that is \(6 - 2\times 1.5\) and \(6 + 2\times
    1.5\), and exponentiating these values:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 在生成先验预测分布之前，我们可以计算出我们 95% 确信观察值的期望中位数将落在的范围。我们通过查看先验均值 \(\mu\) 的两个标准差处发生的情况来完成此操作，即
    \(6 - 2\times 1.5\) 和 \(6 + 2\times 1.5\)，并对这些值进行指数化：
- en: '[PRE38]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: '[PRE39]'
  id: totrans-202
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: This means that the prior for \(\mu\) is still not too informative (these are
    medians; the actual values generated by the log-normal distribution can be much
    more spread out). Next, plot the distribution of some representative statistics
    of the prior predictive distributions. `brms` allows one to sample from the priors,
    ignoring the observed data `t` , by setting `sample_prior = "only"` in the `brm`
    function.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着 \(\mu\) 的先验信息仍然不是很丰富（这些是中位数；由对数正态分布生成的实际值可能分布得更广）。接下来，绘制先验预测分布的一些代表性统计量的分布。`brms`
    允许通过在 `brm` 函数中设置 `sample_prior = "only"` 来从先验中采样，忽略观察到的数据 `t`。
- en: If we want to use `brms` to generate prior predictive data in this manner even
    before we have any data, we do need to include a data frame with the relevant
    dependent variable (`y` in this case). Setting `sample_prior = "only"` will ignore
    the values of the dependent variable.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们想在没有任何数据的情况下，使用 `brms` 以这种方式生成先验预测数据，我们确实需要包含一个包含相关因变量的数据框（在这种情况下是 `y`）。设置
    `sample_prior = "only"` 将忽略因变量的值。
- en: '[PRE40]'
  id: totrans-205
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: To avoid the warnings, increase the `adapt_delta` parameter’s default value
    from \(0.8\) to \(0.9\) to simulate the data. Since Stan samples from the prior
    distributions in the same way that it samples from the posterior distribution,
    one should not ignore warnings; always ensure that the model converges. In that
    respect, the custom function `normal_predictive_distribution()` defined in section
    [3.3](ch-compbda.html#sec-priorpred) has the advantage that it will always yield
    independent samples from the prior distribution and will not experience any convergence
    problems. This is because it just relies on the `rnorm()` function in R.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 要避免警告，将 `adapt_delta` 参数的默认值从 \(0.8\) 增加到 \(0.9\) 来模拟数据。由于 Stan 以与从后验分布采样相同的方式从先验分布中采样，因此不应忽略警告；始终确保模型收敛。在这方面，第
    [3.3](ch-compbda.html#sec-priorpred) 节中定义的自定义函数 `normal_predictive_distribution()`
    有优势，因为它将始终从先验分布中产生独立的样本，并且不会遇到任何收敛问题。这是因为它仅依赖于 R 中的 `rnorm()` 函数。
- en: Plot the prior predictive distribution of means with the following code. In
    a prior predictive distribution, we generally want to ignore the data; this requires
    setting `prefix = "ppd"` in `pp_check()`.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下代码绘制均值的先验预测分布。在先验预测分布中，我们通常想要忽略数据；这需要将 `prefix = "ppd"` 设置在 `pp_check()`
    中。
- en: To plot the distribution of minimum, and maximum values, just replace `mean`
    with `min`, and `max` respectively. The distributions of the three statistics
    are displayed in Figure [3.12](ch-compbda.html#fig:priorpredlognorm).
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 要绘制最小值和最大值的分布，只需将 `mean` 分别替换为 `min` 和 `max`。这三个统计量的分布显示在图 [3.12](ch-compbda.html#fig:priorpredlognorm)
    中。
- en: '[PRE41]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: '![The prior predictive distributions of the mean, maximum, and minimum values
    of the log-normal model with priors defined in Equation (3.11). The prior predictive
    distributions are labeled \(y_{pred}\). The x-axis shows values back-transformed
    from the log-scale.](../Images/a571b72cfab0ec71b0f7f70982434c37.png)'
  id: totrans-210
  prefs: []
  type: TYPE_IMG
  zh: '![定义在方程 (3.11) 中的对数正态模型的均值、最大值和最小值的先验预测分布。先验预测分布标记为 \(y_{pred}\)。x 轴显示从对数尺度反变换的值。](../Images/a571b72cfab0ec71b0f7f70982434c37.png)'
- en: 'FIGURE 3.12: The prior predictive distributions of the mean, maximum, and minimum
    values of the log-normal model with priors defined in Equation [(3.11)](ch-compbda.html#eq:logpriorsnorm).
    The prior predictive distributions are labeled \(y_{pred}\). The x-axis shows
    values back-transformed from the log-scale.'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.12：定义在方程 [(3.11)](ch-compbda.html#eq:logpriorsnorm) 中的对数正态模型的均值、最大值和最小值的先验预测分布。先验预测分布标记为
    \(y_{pred}\)。x 轴显示从对数尺度反变换的值。
- en: Figure [3.12](ch-compbda.html#fig:priorpredlognorm) shows that the priors used
    here are still quite uninformative. The tails of the prior predictive distributions
    that correspond to our normal priors shown in Figure [3.12](ch-compbda.html#fig:priorpredlognorm)
    are even further to the right, reaching more extreme values than for the prior
    predictive distributions generated by uniform priors (shown in Figure [3.11](ch-compbda.html#fig:priorpredlogunif)).
    The new priors are still far from representing our prior knowledge. We could run
    more iterations of choosing priors and generating prior predictive distributions
    until we have priors that generate realistic data. However, given that the bulk
    of the distributions of the mean, maximum, minimum values lies roughly in the
    correct order of magnitude, these priors are going to be acceptable. In general,
    summary statistics (e.g., mean, median, min, max) can be used to test whether
    the priors are in a plausible range. This can be done by defining, for the particular
    research problem under study, the extreme data that would be very implausible
    to ever observe (e.g., reading times at a word larger than one minute) and choosing
    priors such that such extreme finger tapping times occur only very rarely in the
    prior predictive distribution.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 图 [3.12](ch-compbda.html#fig:priorpredlognorm) 显示，这里使用的先验仍然相当不具信息量。与图 [3.12](ch-compbda.html#fig:priorpredlognorm)
    中显示的我们的正态先验对应的先验预测分布的尾部甚至更靠右，达到比由均匀先验生成的先验预测分布（如图 [3.11](ch-compbda.html#fig:priorpredlogunif)
    所示）更极端的值。新的先验仍然远未代表我们的先验知识。我们可以运行更多次选择先验和生成先验预测分布的迭代，直到我们得到可以生成真实数据的先验。然而，鉴于均值、最大值和最小值的分布的大部分大致位于正确的数量级顺序，这些先验将被接受。一般来说，总结统计量（例如，均值、中位数、最小值、最大值）可以用来测试先验是否在合理的范围内。这可以通过定义特定研究问题的极端数据来实现，这些数据在观察中非常不可能出现（例如，一个单词的阅读时间超过一分钟），并选择先验，使得这种极端的手指敲击时间在先验预测分布中只非常罕见地发生。
- en: Next, fit the model; recall that both the distribution family and prior change
    in comparison to the previous example.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，拟合模型；回想一下，与之前的例子相比，分布族和先验都发生了变化。
- en: '[PRE42]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'When we look at the summary of the posterior, the parameters are on the log-scale:'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们查看后验的总结时，参数位于对数尺度上：
- en: '[PRE43]'
  id: totrans-216
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: '[PRE44]'
  id: totrans-217
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'If the research goal is to find out how long it takes to press the space bar
    in milliseconds, we need to transform the \(\mu\) (or `Intercept` in the model)
    to milliseconds. Because the median of the log-normal distribution is \(\exp(\mu)\),
    the following returns the median estimate in milliseconds (recall that for the
    mean we would need to calculate \(\exp(\mu +\sigma ^{2}/2)\)):'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 如果研究目标是找出按下空格键需要多长时间（以毫秒为单位），我们需要将 \(\mu\)（或模型中的“截距”）转换为毫秒。因为对数正态分布的中位数是 \(\exp(\mu)\)，以下返回的是中位数估计值（记住，对于均值，我们需要计算
    \(\exp(\mu +\sigma ^{2}/2)\)）：
- en: '[PRE45]'
  id: totrans-219
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'To display the mean and 95% credible interval of these samples, type:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 要显示这些样本的均值和 95% 似然区间，请输入：
- en: '[PRE46]'
  id: totrans-221
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: '[PRE47]'
  id: totrans-222
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: Next, check whether the predicted data sets look similar to the observed data
    set. See Figure [3.13](ch-compbda.html#fig:logppc); compare this with the earlier
    Figure [3.9](ch-compbda.html#fig:normalppc2).
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，检查预测数据集是否与观测数据集相似。见图 [3.13](ch-compbda.html#fig:logppc)；将其与早期的图 [3.9](ch-compbda.html#fig:normalppc2)
    进行比较。
- en: '[PRE48]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: '![The posterior predictive distribution of fit_press_ln.](../Images/1ca36e870d3ba5a0f7a25fa6fcd8f79d.png)'
  id: totrans-225
  prefs: []
  type: TYPE_IMG
  zh: '![拟合_press_ln 的后验预测分布。](../Images/1ca36e870d3ba5a0f7a25fa6fcd8f79d.png)'
- en: 'FIGURE 3.13: The posterior predictive distribution of `fit_press_ln`.'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.13：`fit_press_ln` 的后验预测分布。
- en: 'The key question is: Are the posterior predicted data now more similar to the
    observed data, compared to the case where we had a normal likelihood? According
    to Figure [3.13](ch-compbda.html#fig:logppc), it seems so, but it’s not easy to
    tell.'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 关键问题是：与具有正态似然的情况相比，后验预测数据现在是否更接近观测数据？根据图 [3.13](ch-compbda.html#fig:logppc)，似乎是这样的，但并不容易判断。
- en: Another way to examine the extent to which the predicted data looks similar
    to the observed data would be to look at the distribution of some summary statistic.
    As with prior predictive distributions, examine the distribution of representative
    summary statistics for the data sets generated by different models. However, in
    contrast with what occurs with prior predictive distributions, at this point we
    have a clear reference, our observations, and this means that we can compare the
    summary statistics with the observed statistics from our data. We suspect that
    the normal distribution would generate finger tapping times that are too fast
    (since the normal distribution is symmetrical) and that the log-normal distribution
    may capture the long tail better than the normal model. Based on this supposition,
    compute the distribution of minimum and maximum values for the posterior predictive
    distributions, and compare them with the minimum and maximum value respectively
    in the data. The function `pp_check()` implements this by specifying `stat` either
    `"min"` or `"max"` for both `fit_press`, and `fit_press_ln`; an example is shown
    below. The plots are shown in Figures [3.14](ch-compbda.html#fig:ppcheckmin) and
    [3.15](ch-compbda.html#fig:ppcheckmax).
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种检查预测数据与观测数据相似程度的方法是查看某些汇总统计量的分布。与先验预测分布一样，检查由不同模型生成的数据集的代表性汇总统计量的分布。然而，与先验预测分布不同，此时我们有一个明确的参考，即我们的观测数据，这意味着我们可以将汇总统计量与我们的数据中的观测统计量进行比较。我们怀疑正态分布会生成过快的指关节敲击时间（因为正态分布是对称的），而对数正态分布可能比正态模型更好地捕捉长尾。基于这个假设，计算后验预测分布的最小值和最大值分布，并将它们与数据中的最小值和最大值分别进行比较。函数
    `pp_check()` 通过为 `fit_press` 和 `fit_press_ln` 指定 `stat` 为 `"min"` 或 `"max"` 来实现这一点；以下是一个示例。图示见
    [3.14](ch-compbda.html#fig:ppcheckmin) 和 [3.15](ch-compbda.html#fig:ppcheckmax)。
- en: '[PRE49]'
  id: totrans-229
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: '![The distributions of minimum values in a posterior predictive check, using
    the normal and log-normal probability density functions. The minimum in the data
    is \(110\) ms.](../Images/f10b6153131b979898dabaad91a0a780.png)![The distributions
    of minimum values in a posterior predictive check, using the normal and log-normal
    probability density functions. The minimum in the data is \(110\) ms.](../Images/f0447b734f05ef191a54add024b56cc2.png)'
  id: totrans-230
  prefs: []
  type: TYPE_IMG
  zh: '![后验预测检查中最小值的分布，使用正态和对数正态概率密度函数。数据中的最小值是 \(110\) 毫秒。](../Images/f10b6153131b979898dabaad91a0a780.png)![后验预测检查中最小值的分布，使用正态和对数正态概率密度函数。数据中的最小值是
    \(110\) 毫秒。](../Images/f0447b734f05ef191a54add024b56cc2.png)'
- en: 'FIGURE 3.14: The distributions of minimum values in a posterior predictive
    check, using the normal and log-normal probability density functions. The minimum
    in the data is \(110\) ms. ![The distributions of maximum values in a posterior
    predictive check using the normal and log-normal. The maximum in the data is \(409\)
    ms.](../Images/c14cf134aa05b971b7fae86ae1bfb405.png)![The distributions of maximum
    values in a posterior predictive check using the normal and log-normal. The maximum
    in the data is \(409\) ms.](../Images/04012bec32a6cee12702b3a0c85a1e01.png)'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.14：使用正态和对数正态概率密度函数进行后验预测检查的最小值分布。数据的最大值是 \(110\) 毫秒。![使用正态和对数正态进行后验预测检查的最大值分布。数据的最大值是
    \(409\) 毫秒。](../Images/c14cf134aa05b971b7fae86ae1bfb405.png)![使用正态和对数正态进行后验预测检查的最大值分布。数据的最大值是
    \(409\) 毫秒。](../Images/04012bec32a6cee12702b3a0c85a1e01.png)
- en: 'FIGURE 3.15: The distributions of maximum values in a posterior predictive
    check using the normal and log-normal. The maximum in the data is \(409\) ms.'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.15：使用正态和对数正态进行后验预测检查的最大值分布。数据的最大值是 \(409\) 毫秒。
- en: Figure [3.14](ch-compbda.html#fig:ppcheckmin) shows that the log-normal likelihood
    does a slightly better job since the minimum value is contained in the bulk of
    the log-normal distribution and in the tail of the normal one. Figure [3.15](ch-compbda.html#fig:ppcheckmax)
    shows that both models are unable to capture the maximum value of the observed
    data. One explanation for this is that the log-normal-ish observations in our
    data are being generated by the task of pressing as fast as possible, whereas
    the observations with long finger tapping times are possibly being generated by
    lapses of attention. If this assumption is correct, this would mean that the distribution
    of button pressing times is a mixture of two distributions; modeling such a mixture
    process involves more complex tools that we will take up in chapter [17](ch-mixture.html#ch-mixture).
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 图 [3.14](ch-compbda.html#fig:ppcheckmin) 显示，对数正态似然函数做得稍微好一些，因为最小值包含在对数正态分布的大部分和正态分布的尾部。图
    [3.15](ch-compbda.html#fig:ppcheckmax) 显示，这两个模型都无法捕捉到观测数据的最大值。一种解释是，我们数据中的对数正态似然观测值可能是由尽可能快地按下的任务生成的，而长指节拍时间的观测值可能是由于注意力分散造成的。如果这个假设是正确的，这意味着按钮按压力度的分布是两个分布的混合；对这种混合过程进行建模需要更复杂的工具，我们将在第
    [17](ch-mixture.html#ch-mixture) 章节中探讨。
- en: This completes our introduction to `brms`. We are now ready to learn more about
    regression models.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 这完成了我们对`brms`的介绍。我们现在可以学习更多关于回归模型的知识了。
- en: 3.8 List of the most important commands
  id: totrans-235
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.8 最重要命令列表
- en: Here is a list of the most important commands we learned in this chapter.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是我们在本章中学到的最重要命令的列表。
- en: 'The core `brms` function for fitting models, for generating prior predictive
    and posterior predictive data:'
  id: totrans-237
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用于拟合模型、生成先验预测和后验预测数据的`brms`核心函数：
- en: '[PRE50]'
  id: totrans-238
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'Extract samples from fitted model:'
  id: totrans-239
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从拟合模型中提取样本：
- en: '[PRE51]'
  id: totrans-240
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: Basic plot of posteriors
  id: totrans-241
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 后验的基本绘图
- en: '[PRE52]'
  id: totrans-242
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: Plot prior predictive/posterior predictive data
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 绘制先验预测/后验预测数据
- en: '[PRE53]'
  id: totrans-244
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: 3.9 Summary
  id: totrans-245
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.9 总结
- en: This chapter showed how to fit and interpret a Bayesian model with a normal
    likelihood. We looked at the effect of priors by investigating prior predictive
    distributions and by carrying out a sensitivity analysis. We also looked at the
    fit of the posterior, by inspecting the posterior predictive distribution (which
    gives us some idea about the descriptive adequacy of the model). We also showed
    how to fit a Bayesian model with a log-normal likelihood, and how to compare the
    predictive accuracy of different models.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 本章展示了如何使用正态似然函数拟合和解释贝叶斯模型。我们通过调查先验预测分布和进行敏感性分析来研究先验的影响。我们还通过检查后验预测分布（这让我们对模型的描述性充分性有一些了解）来查看后验的拟合情况。我们还展示了如何使用对数正态似然函数拟合贝叶斯模型，以及如何比较不同模型的预测准确性。
- en: 3.10 Further reading
  id: totrans-247
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.10 进一步阅读
- en: 'Sampling algorithms are discussed in detail in Gamerman and Lopes ([2006](#ref-gamerman)).
    Also helpful are the sections on sampling from the short open-source book by Bob
    Carpenter, *Probability and Statistics: a simulation-based introduction* ([https://github.com/bob-carpenter/prob-stats](https://github.com/bob-carpenter/prob-stats)),
    and the sections on sampling algorithms in Lambert ([2018](#ref-lambert2018student))
    and Lynch ([2007](#ref-lynch2007introduction)). The evolution of probabilistic
    programming languages for Bayesian inference is discussed in Štrumbelj et al.
    ([2024](#ref-vstrumbelj2024past)). Introductory linear modeling theory is covered
    in Dobson and Barnett ([2011](#ref-dobson2011introduction)); more advanced treatments
    are in Montgomery, Peck, and Vining ([2012](#ref-monty)) and Seber and Lee ([2003](#ref-seber)).
    Generalized linear models are covered in detail in McCullagh and Nelder ([2019](#ref-mccullagh2019generalized)).
    The reader may also benefit from our own freely available online lecture notes
    on linear modeling: [https://github.com/vasishth/LM](https://github.com/vasishth/LM).'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Gamerman 和 Lopes ([2006](#ref-gamerman)) 的著作中详细讨论了采样算法。Bob Carpenter 的开源书籍
    *《概率与统计：基于模拟的导论》* ([https://github.com/bob-carpenter/prob-stats](https://github.com/bob-carpenter/prob-stats))
    中的采样部分以及 Lambert ([2018](#ref-lambert2018student)) 和 Lynch ([2007](#ref-lynch2007introduction))
    关于采样算法的部分也非常有帮助。贝叶斯推理的概率编程语言的演变在 Štrumbelj 等人 ([2024](#ref-vstrumbelj2024past))
    的著作中讨论。Dobson 和 Barnett ([2011](#ref-dobson2011introduction)) 覆盖了线性建模理论的入门内容；更高级的处理可以在
    Montgomery, Peck, 和 Vining ([2012](#ref-monty)) 以及 Seber 和 Lee ([2003](#ref-seber))
    的著作中找到。广义线性模型在 McCullagh 和 Nelder ([2019](#ref-mccullagh2019generalized)) 的著作中有详细的介绍。读者还可以从我们免费提供的在线线性建模讲义中受益：[https://github.com/vasishth/LM](https://github.com/vasishth/LM).
- en: References
  id: totrans-249
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 参考文献
- en: 'Bates, Douglas M., Martin Mächler, Ben Bolker, and Steve Walker. 2015\. “Fitting
    Linear Mixed-Effects Models Using lme4.” *Journal of Statistical Software* 67
    (1): 1–48\. [https://doi.org/10.18637/jss.v067.i01](https://doi.org/10.18637/jss.v067.i01).'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 'Bates, Douglas M., Martin Mächler, Ben Bolker, 和 Steve Walker. 2015\. “使用 lme4
    拟合线性混合效应模型。” *《统计软件杂志》* 67 (1): 1–48\. [https://doi.org/10.18637/jss.v067.i01](https://doi.org/10.18637/jss.v067.i01).'
- en: Blitzstein, Joseph K., and Jessica Hwang. 2014\. *Introduction to Probability*.
    Chapman; Hall/CRC.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: Blitzstein, Joseph K., 和 Jessica Hwang. 2014\. *《概率论导论》*. Chapman; Hall/CRC.
- en: 'Bürkner, Paul-Christian. 2017\. “brms: An R Package for Bayesian Multilevel
    Models Using Stan.” *Journal of Statistical Software* 80 (1): 1–28\. [https://doi.org/10.18637/jss.v080.i01](https://doi.org/10.18637/jss.v080.i01).'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 'Bürkner, Paul-Christian. 2017\. “brms: 使用 Stan 的贝叶斯多级模型 R 包。” *《统计软件杂志》* 80
    (1): 1–28\. [https://doi.org/10.18637/jss.v080.i01](https://doi.org/10.18637/jss.v080.i01).'
- en: 'Bürkner, Paul-Christian. 2024\. *brms: Bayesian Regression Models Using “Stan”*.
    [https://github.com/paul-buerkner/brms](https://github.com/paul-buerkner/brms).'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: Bürkner, Paul-Christian. 2024\. *《使用“Stan”的贝叶斯回归模型：brms》*. [https://github.com/paul-buerkner/brms](https://github.com/paul-buerkner/brms).
- en: 'Carpenter, Bob, Andrew Gelman, Matthew D. Hoffman, Daniel Lee, Ben Goodrich,
    Michael J. Betancourt, Marcus Brubaker, Jiqiang Guo, Peter Li, and Allen Riddell.
    2017\. “Stan: A Probabilistic Programming Language.” *Journal of Statistical Software*
    76 (1).'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 'Carpenter, Bob, Andrew Gelman, Matthew D. Hoffman, Daniel Lee, Ben Goodrich,
    Michael J. Betancourt, Marcus Brubaker, Jiqiang Guo, Peter Li, 和 Allen Riddell.
    2017\. “Stan: 一种概率编程语言。” *《统计软件杂志》* 76 (1).'
- en: Dobson, Annette J., and Adrian Barnett. 2011\. *An Introduction to Generalized
    Linear Models*. CRC Press.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: Dobson, Annette J., 和 Adrian Barnett. 2011\. *《广义线性模型导论》*. CRC Press.
- en: 'Duane, Simon, A. D. Kennedy, Brian J. Pendleton, and Duncan Roweth. 1987\.
    “Hybrid Monte Carlo.” *Physics Letters B* 195 (2): 216–22\. [https://doi.org/10.1016/0370-2693(87)91197-X](https://doi.org/10.1016/0370-2693(87)91197-X).'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 'Duane, Simon, A. D. Kennedy, Brian J. Pendleton, 和 Duncan Roweth. 1987\. “混合蒙特卡洛。”
    *《物理快报 B》* 195 (2): 216–22\. [https://doi.org/10.1016/0370-2693(87)91197-X](https://doi.org/10.1016/0370-2693(87)91197-X).'
- en: 'Gamerman, Dani, and Hedibert F. Lopes. 2006\. *Markov chain Monte Carlo: Stochastic
    simulation for Bayesian inference*. CRC Press.'
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: Gamerman, Dani, 和 Hedibert F. Lopes. 2006\. *《马尔可夫链蒙特卡洛：贝叶斯推理的随机模拟》*. CRC Press.
- en: 'Ge, Hong, Kai Xu, and Zoubin Ghahramani. 2018\. “Turing: A Language for Flexible
    Probabilistic Inference.” In *Proceedings of Machine Learning Research*, edited
    by Amos Storkey and Fernando Perez-Cruz, 84:1682–90\. Playa Blanca, Lanzarote,
    Canary Islands: PMLR. [http://proceedings.mlr.press/v84/ge18b.html](http://proceedings.mlr.press/v84/ge18b.html).'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 'Ge, Hong, Kai Xu, 和 Zoubin Ghahramani. 2018\. “Turing: 一种用于灵活概率推理的语言。” 在 *《机器学习研究论文集》*
    中，由 Amos Storkey 和 Fernando Perez-Cruz 编辑，第 84 卷，第 1682–90 页。兰萨罗特群岛，帕莱亚·布兰卡，加那利群岛：PMLR.
    [http://proceedings.mlr.press/v84/ge18b.html](http://proceedings.mlr.press/v84/ge18b.html).'
- en: 'Gelman, Andrew, John B. Carlin, Hal S. Stern, David B. Dunson, Aki Vehtari,
    and Donald B. Rubin. 2014\. *Bayesian Data Analysis*. Third Edition. Boca Raton,
    FL: Chapman; Hall/CRC Press.'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 'Gelman, Andrew, John B. Carlin, Hal S. Stern, David B. Dunson, Aki Vehtari,
    和 Donald B. Rubin. 2014\. *贝叶斯数据分析*. 第三版. 佛罗里达州博卡拉顿, FL: 查普曼; 哈尔/CRC出版社.'
- en: 'Gelman, Andrew, Daniel P. Simpson, and Michael J. Betancourt. 2017\. “The Prior
    Can Often Only Be Understood in the Context of the Likelihood.” *Entropy* 19 (10):
    555\. [https://doi.org/10.3390/e19100555](https://doi.org/10.3390/e19100555).'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 'Gelman, Andrew, Daniel P. Simpson, 和 Michael J. Betancourt. 2017\. “先验通常只能在似然性的背景下理解。”
    *熵* 19 (10): 555\. [https://doi.org/10.3390/e19100555](https://doi.org/10.3390/e19100555).'
- en: 'Goodrich, Ben, Jonah Gabry, Imad Ali, and Sam Brilleman. 2018\. “Rstanarm:
    Bayesian Applied Regression Modeling via Stan.” [http://mc-stan.org/](http://mc-stan.org/).'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 'Goodrich, Ben, Jonah Gabry, Imad Ali, 和 Sam Brilleman. 2018\. “Rstanarm: 通过Stan进行贝叶斯应用回归建模。”
    [http://mc-stan.org/](http://mc-stan.org/).'
- en: 'Hoffman, Matthew D., and Andrew Gelman. 2014\. “The No-U-Turn Sampler: Adaptively
    Setting Path Lengths in Hamiltonian Monte Carlo.” *Journal of Machine Learning
    Research* 15 (1): 1593–1623\. [http://dl.acm.org/citation.cfm?id=2627435.2638586](http://dl.acm.org/citation.cfm?id=2627435.2638586).'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 'Hoffman, Matthew D., 和 Andrew Gelman. 2014\. “无转弯采样器：在哈密顿蒙特卡洛中自适应设置路径长度。” *机器学习研究杂志*
    15 (1): 1593–1623\. [http://dl.acm.org/citation.cfm?id=2627435.2638586](http://dl.acm.org/citation.cfm?id=2627435.2638586).'
- en: 'Hubel, Kerry A., Bruce Reed, E. William Yund, Timothy J. Herron, and David
    L. Woods. 2013\. “Computerized Measures of Finger Tapping: Effects of Hand Dominance,
    Age, and Sex.” *Perceptual and Motor Skills* 116 (3): 929–52\. [https://doi.org/https://doi.org/10.2466/25.29.PMS.116.3.929-952](https://doi.org/https://doi.org/10.2466/25.29.PMS.116.3.929-952).'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 'Hubel, Kerry A., Bruce Reed, E. William Yund, Timothy J. Herron, 和 David L.
    Woods. 2013\. “计算机化手指敲击测量：手优势、年龄和性别的影响。” *感知与运动技能* 116 (3): 929–52\. [https://doi.org/https://doi.org/10.2466/25.29.PMS.116.3.929-952](https://doi.org/https://doi.org/10.2466/25.29.PMS.116.3.929-952).'
- en: JASP Team. 2019\. “JASP (Version 0.11.1)[Computer software].” [https://jasp-stats.org/](https://jasp-stats.org/).
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: JASP Team. 2019\. “JASP (版本 0.11.1)[计算机软件].” [https://jasp-stats.org/](https://jasp-stats.org/).
- en: 'Jaynes, Edwin T. 2003\. *Probability Theory: The Logic of Science*. Cambridge
    University Press.'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: Jaynes, Edwin T. 2003\. *概率论：科学的逻辑*. 剑桥大学出版社.
- en: 'Jeffreys, Harold. 1939\. *Theory of Probability*. Oxford: Clarendon Press.'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 'Jeffreys, Harold. 1939\. *概率论理论*. 牛津: 克拉伦登出版社.'
- en: 'Lambert, Ben. 2018\. *A Student’s Guide to Bayesian Statistics*. London, UK:
    Sage.'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 'Lambert, Ben. 2018\. *贝叶斯统计学生指南*. 英国伦敦: 萨奇出版社.'
- en: 'Lindgren, Finn, and Håvard Rue. 2015\. “Bayesian Spatial Modelling with R-INLA.”
    *Journal of Statistical Software* 63 (1): 1–25\. [https://doi.org/ 10.18637/jss.v063.i19](https://doi.org/%2010.18637/jss.v063.i19).'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 'Lindgren, Finn, 和 Håvard Rue. 2015\. “使用R-INLA进行贝叶斯空间建模。” *统计软件杂志* 63 (1):
    1–25\. [https://doi.org/ 10.18637/jss.v063.i19](https://doi.org/%2010.18637/jss.v063.i19).'
- en: 'Luce, R. Duncan. 1991\. *Response Times: Their Role in Inferring Elementary
    Mental Organization*. Oxford University Press.'
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: Luce, R. Duncan. 1991\. *反应时间：在推断基本心理组织中的作用*. 牛津大学出版社.
- en: 'Lunn, David J., Andrew Thomas, Nichola G. Best, and David J. Spiegelhalter.
    2000\. “WinBUGS-A Bayesian Modelling Framework: Concepts, Structure, and Extensibility.”
    *Statistics and Computing* 10 (4): 325–37.'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 'Lunn, David J., Andrew Thomas, Nichola G. Best, 和 David J. Spiegelhalter. 2000\.
    “WinBUGS-贝叶斯建模框架：概念、结构和可扩展性。” *统计学与计算* 10 (4): 325–37.'
- en: 'Lynch, Scott Michael. 2007\. *Introduction to Applied Bayesian Statistics and
    Estimation for Social Scientists*. New York, NY: Springer.'
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 'Lynch, Scott Michael. 2007\. *应用贝叶斯统计和社会科学家估计导论*. 纽约, NY: 斯普林格.'
- en: 'McCullagh, Peter, and J. A. Nelder. 2019\. *Generalized Linear Models*. Second
    Edition. Boca Raton, Florida: Chapman; Hall/CRC.'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 'McCullagh, Peter, 和 J. A. Nelder. 2019\. *广义线性模型*. 第二版. 佛罗里达州博卡拉顿: 查普曼; 哈尔/CRC.'
- en: 'Montgomery, D. C., E. A. Peck, and G. G. Vining. 2012\. *An Introduction to
    Linear Regression Analysis*. 5th ed. Hoboken, NJ: Wiley.'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 'Montgomery, D. C., E. A. Peck, 和 G. G. Vining. 2012\. *线性回归分析导论*. 第5版. 新泽西州霍博肯:
    威利出版社.'
- en: Neal, Radford M. 2011\. “MCMC Using Hamiltonian Dynamics.” In *Handbook of Markov
    Chain Monte Carlo*, edited by Steve Brooks, Andrew Gelman, Galin Jones, and Xiao-Li
    Meng. Taylor & Francis. [https://doi.org/10.1201/b10905-10](https://doi.org/10.1201/b10905-10).
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: Neal, Radford M. 2011\. “使用哈密顿动力学进行MCMC。” 在 *马尔可夫链蒙特卡洛手册* 中，由Steve Brooks, Andrew
    Gelman, Galin Jones, 和 Xiao-Li Meng 编辑。泰勒弗朗西斯出版社. [https://doi.org/10.1201/b10905-10](https://doi.org/10.1201/b10905-10).
- en: 'O’Hagan, Anthony, and Jonathan J. Forster. 2004\. “Kendall’s Advanced Theory
    of Statistics, Vol. 2B: Bayesian Inference.” Wiley.'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: O’Hagan, Anthony, 和 Jonathan J. Forster. 2004\. “肯德尔高级统计学理论，第2B卷：贝叶斯推断。” 威廉姆斯出版社.
- en: Plummer, Martin. 2016\. “JAGS Version 4.2.0 User Manual.”
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: Plummer, Martin. 2016. “JAGS版本4.2.0用户手册。”
- en: Plummer, Martin. 2022\. “Simulation-Based Bayesian Analysis.” *Annual Review
    of Statistics and Its Application*.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: Plummer, Martin. 2022. “基于模拟的贝叶斯分析。” *统计科学年度评论*。
- en: 'Roberts, Seth, and Harold Pashler. 2000\. “How Persuasive Is a Good Fit? A
    Comment on Theory Testing.” *Psychological Review* 107 (2): 358–67\. [https://doi.org/https://doi.org/10.1037/0033-295X.107.2.358](https://doi.org/https://doi.org/10.1037/0033-295X.107.2.358).'
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 'Roberts, Seth, 和 Harold Pashler. 2000. “良好的拟合有多有说服力？对理论测试的评论。” *心理学评论* 107
    (2): 358–67\. [https://doi.org/https://doi.org/10.1037/0033-295X.107.2.358](https://doi.org/https://doi.org/10.1037/0033-295X.107.2.358).'
- en: 'Salvatier, John, Thomas V. Wiecki, and Christopher Fonnesbeck. 2016\. “Probabilistic
    Programming in Python Using PyMC3.” *PeerJ Computer Science* 2 (April): e55\.
    [https://doi.org/10.7717/peerj-cs.55](https://doi.org/10.7717/peerj-cs.55).'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 'Salvatier, John, Thomas V. Wiecki, 和 Christopher Fonnesbeck. 2016. “使用PyMC3在Python中进行概率编程。”
    *PeerJ计算机科学* 2 (四月): e55\. [https://doi.org/https://doi.org/10.7717/peerj-cs.55](https://doi.org/https://doi.org/10.7717/peerj-cs.55).'
- en: 'Seber, George A. F., and Allen J. Lee. 2003\. *Linear Regression Analysis*.
    2nd Edition. Hoboken, NJ: John Wiley; Sons.'
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: Seber, George A. F., 和 Allen J. Lee. 2003. *线性回归分析*. 第二版. 新泽西州霍博肯：John Wiley
    & Sons.
- en: 'Shiffrin, Richard M, Michael D Lee, Woojae Kim, and Eric-Jan Wagenmakers. 2008\.
    “A Survey of Model Evaluation Approaches with a Tutorial on Hierarchical Bayesian
    Methods.” *Cognitive Science: A Multidisciplinary Journal* 32 (8): 1248–84\. [https://doi.org/10.1080/03640210802414826](https://doi.org/10.1080/03640210802414826).'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 'Shiffrin, Richard M, Michael D Lee, Woojae Kim, 和 Eric-Jan Wagenmakers. 2008.
    “模型评估方法的综述：关于分层贝叶斯方法的教程。” *认知科学：多学科杂志* 32 (8): 1248–84\. [https://doi.org/https://doi.org/10.1080/03640210802414826](https://doi.org/https://doi.org/10.1080/03640210802414826).'
- en: 'Štrumbelj, Erik, Alexandre Bouchard-Côté, Jukka Corander, Andrew Gelman, Håvard
    Rue, Lawrence Murray, Henri Pesonen, Martin Plummer, and Aki Vehtari. 2024\. “Past,
    Present and Future of Software for Bayesian Inference.” *Statistical Science*
    39 (1): 46–61.'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 'Štrumbelj, Erik, Alexandre Bouchard-Côté, Jukka Corander, Andrew Gelman, Håvard
    Rue, Lawrence Murray, Henri Pesonen, Martin Plummer, 和 Aki Vehtari. 2024. “贝叶斯推理软件的过去、现在和未来。”
    *统计科学* 39 (1): 46–61.'
- en: 'Vasishth, Shravan, Zhong Chen, Qiang Li, and Gueilan Guo. 2013\. “Processing
    Chinese Relative Clauses: Evidence for the Subject-Relative Advantage.” *PLoS
    ONE* 8 (10): 1–14\. [https://doi.org/https://doi.org/10.1371/journal.pone.0077006](https://doi.org/https://doi.org/10.1371/journal.pone.0077006).'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 'Vasishth, Shravan, Zhong Chen, Qiang Li, 和 Gueilan Guo. 2013. “处理中文相对从句：支持主语-相对优势的证据。”
    *PLoS ONE* 8 (10): 1–14\. [https://doi.org/https://doi.org/10.1371/journal.pone.0077006](https://doi.org/https://doi.org/10.1371/journal.pone.0077006).'
- en: 'Vasishth, Shravan, and Felix Engelmann. 2022\. *Sentence Comprehension as a
    Cognitive Process: A Computational Approach*. Cambridge, UK: Cambridge University
    Press. [https://books.google.de/books?id=6KZKzgEACAAJ](https://books.google.de/books?id=6KZKzgEACAAJ).'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: Vasishth, Shravan, 和 Felix Engelmann. 2022. *句子理解作为一种认知过程：一种计算方法*. 英国剑桥：剑桥大学出版社.
    [https://books.google.de/books?id=6KZKzgEACAAJ](https://books.google.de/books?id=6KZKzgEACAAJ).
- en: 'Vehtari, Aki, Andrew Gelman, Daniel P. Simpson, Bob Carpenter, and Paul-Christian
    Bürkner. 2021\. “Rank-Normalization, Folding, and Localization: An Improved \(\widehat{R}\)
    for Assessing Convergence of MCMC.” *Bayesian Analysis* 16 (2): 667–718\. [https://doi.org/10.1214/20-BA1221](https://doi.org/10.1214/20-BA1221).'
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 'Vehtari, Aki, Andrew Gelman, Daniel P. Simpson, Bob Carpenter, 和 Paul-Christian
    Bürkner. 2021. “排名归一化、折叠和定位：改进的\(\widehat{R}\)用于评估MCMC的收敛性。” *贝叶斯分析* 16 (2): 667–718\.
    [https://doi.org/10.1214/20-BA1221](https://doi.org/10.1214/20-BA1221).'
- en: '* * *'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: In the `brms` package (Bürkner [2017](#ref-R-brms_a)), samples from the posterior
    are referred to as draws.[↩︎](ch-compbda.html#fnref9)
  id: totrans-287
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`brms`包（Bürkner [2017](#ref-R-brms_a)）中，后验分布的样本被称为抽取。[↩︎](ch-compbda.html#fnref9)
- en: The Python package PyMC3 and the Julia library Turing are recent exceptions
    since they are fully integrated into their respective languages.[↩︎](ch-compbda.html#fnref10)
  id: totrans-288
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Python包PyMC3和Julia库Turing是最近的例外，因为它们完全集成到各自的语言中。[↩︎](ch-compbda.html#fnref10)
- en: We refer to the time it takes for a subject to respond or react to a stimulus
    as response time (response and reaction times are often used interchangeably,
    cf. Luce [1991](#ref-luce1986response)). In this case, however, there are no stimuli
    other than the cross on the screen, and the subject only taps the space bar as
    soon as they see the cross.[↩︎](ch-compbda.html#fnref11)
  id: totrans-289
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将一个受试者对刺激做出反应或反应所需的时间称为反应时间（反应时间和反应时间通常可以互换使用，参看Luce [1991](#ref-luce1986response)）。然而，在这种情况下，除了屏幕上的十字之外，没有其他刺激，受试者一看到十字就立即按下空格键。[↩︎](ch-compbda.html#fnref11)
- en: There is an additional problem here. Although the parameter for the intercept
    is assigned a uniform distribution bounded between \(0\) and \(60000\) ms, the
    sampler might start sampling from an initial value outside this range producing
    warnings. The sampler can start from an initial value that is outside the \(0\)-\(60000\)
    range because the initial value is chosen randomly (unless the user specifies
    an initial value explicitly). [↩︎](ch-compbda.html#fnref12)
  id: totrans-290
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这里还有一个额外的问题。尽管截距参数被分配了一个介于 \(0\) 和 \(60000\) 毫秒之间的均匀分布，但采样器可能会从这个范围之外的初始值开始采样，从而产生警告。由于初始值是随机选择的（除非用户明确指定初始值），采样器可以从
    \(0\)-\(60000\) 范围之外的初始值开始。 [↩︎](ch-compbda.html#fnref12)
- en: We’ll see later how to generate prior predictive distributions of statistics
    such as mean, minimum, or maximum value in section [3.7.2](ch-compbda.html#sec-lognormal)
    using `brms` and `pp_check()`.[↩︎](ch-compbda.html#fnref13)
  id: totrans-291
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将在第 [3.7.2](ch-compbda.html#sec-lognormal) 节中看到如何使用 `brms` 和 `pp_check()`
    生成先验预测分布，例如均值、最小值或最大值。 [↩︎](ch-compbda.html#fnref13)
- en: Even though, in theory, one could use even wider priors, in practice, these
    are the widest priors that achieve convergence using `brms`.[↩︎](ch-compbda.html#fnref14)
  id: totrans-292
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 尽管在理论上可以使用更宽的先验，但在实践中，这些是使用 `brms` 实现收敛的最宽先验。 [↩︎](ch-compbda.html#fnref14)
- en: Two events A and B are defined to be conditionally independent given some event
    E if \(P(A\cap B | E) = P(A|E) P(B|E)\). See chapter 2 of Blitzstein and Hwang
    ([2014](#ref-blitzstein2014introduction)) for examples and more discussion of
    conditional independence.[↩︎](ch-compbda.html#fnref15)
  id: totrans-293
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果两个事件 A 和 B 在给定某个事件 E 的条件下是条件独立的，那么 \(P(A\cap B | E) = P(A|E) P(B|E)\)。参见 Blitzstein
    和 Hwang 的第 2 章 ([2014](#ref-blitzstein2014introduction)) 以获取示例和更多关于条件独立性的讨论。 [↩︎](ch-compbda.html#fnref15)
- en: More precisely, \(\log_e(\boldsymbol{y})\) or \(\ln(\boldsymbol{y})\), but we’ll
    write it as just \(\log(\boldsymbol{y})\).[↩︎](ch-compbda.html#fnref16)
  id: totrans-294
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更确切地说，是 \(\log_e(\boldsymbol{y})\) 或 \(\ln(\boldsymbol{y})\)，但我们将它写作 \(\log(\boldsymbol{y})\)。
    [↩︎](ch-compbda.html#fnref16)
