- en: Collision Constraints
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 碰撞约束
- en: 原文：[https://phys-sim-book.github.io/lec32.2-pbd_collisions_constraints.html](https://phys-sim-book.github.io/lec32.2-pbd_collisions_constraints.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec32.2-pbd_collisions_constraints.html](https://phys-sim-book.github.io/lec32.2-pbd_collisions_constraints.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: In any physical simulation, preventing the interpenetration of objects is paramount
    for achieving plausible results. Position-Based Dynamics provides a unified approach
    to this challenge. Collisions are not treated as a separate post-processing step
    involving impulses or penalty forces; instead, they are formulated as unilateral
    inequality constraints, just like [IPC](./lec7-dist_barrier.html) [[Li et al.
    2020]](bibliography.html#li2020incremental) and integrated directly into the core
    PBD solver loop.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在任何物理模拟中，防止物体相互穿透是获得合理结果的关键。基于位置的动力学提供了一种统一的解决方案来应对这一挑战。碰撞不是作为一个涉及冲量或惩罚力的单独后处理步骤来处理；相反，它们被表述为单边不等式约束，就像[IPC](./lec7-dist_barrier.html)
    [[Li et al. 2020]](bibliography.html#li2020incremental) 一样，并直接集成到核心PBD求解器循环中。
- en: '[Triangle Self-Collisions](#triangle-self-collisions)'
  id: totrans-4
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[三角形自碰撞](#triangle-self-collisions)'
- en: For thin-shell objects like cloth or other deformable surfaces, a primary challenge
    is handling self-collision, where the object folds and interacts with itself.
    The most common scenario is a vertex penetrating a triangle from another part
    of the mesh. This interaction is modeled with a unilateral constraint involving
    all four participating particles.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 对于像布料或其他可变形表面这样的薄壳对象，一个主要挑战是处理自碰撞，其中对象折叠并与其自身相互作用。最常见的情况是一个顶点从网格的另一部分穿透三角形。这种相互作用通过涉及所有四个参与粒子的单边约束来建模。
- en: 'Consider a vertex with position q and a triangle with vertices p1​,p2​,p3​.
    A collision constraint can be formulated by defining a minimum separation distance,
    or thickness h, from the triangle plane. The unilateral constraint function is:
    C(q,p1​,p2​,p3​)=(q−p1​)⋅n−h≥0(33.2.1) where n=(p2,1​×p3,1​)/∥p2,1​×p3,1​∥ is
    the unit normal of the triangle. In case of C<0, all four particles (q,p1​,p2​,p3​)
    are involved, and their positions are corrected according to their respective
    inverse masses to resolve the penetration while conserving momentum. It is also
    essential to check the barycentric coordinates of the vertex''s projection onto
    the triangle plane to ensure the contact point lies within the triangle''s boundaries
    before applying the correction.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑一个位置为q的顶点和一个由顶点p1、p2、p3组成的三角形。可以通过定义一个最小分离距离，或厚度h，从三角形平面来表述碰撞约束。单边约束函数是：C(q,p1,p2,p3)=(q−p1)⋅n−h≥0(33.2.1)，其中n=(p2,1×p3,1)/∥p2,1×p3,1∥是三角形的单位法线。如果C<0，所有四个粒子(q,p1,p2,p3)都参与其中，并且它们的位姿会根据各自的逆质量进行校正，以解决穿透问题同时保持动量。在应用校正之前，检查顶点在三角形平面上的重心坐标也是至关重要的，以确保接触点位于三角形的边界内。
- en: '[Particle-Environment Collisions](#particle-environment-collisions)'
  id: totrans-7
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[粒子-环境碰撞](#particle-environment-collisions)'
- en: The simplest collision scenario involves a dynamic particle interacting with
    a static, immovable piece of geometry, such as a floor plane or a convex container.
    This geometry acts as a boundary for the simulation domain. For a particle at
    position p interacting with a static plane, the non-penetration condition can
    be formulated as a constraint on the particle's signed distance from the plane.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 最简单的碰撞场景涉及一个动态粒子与一个静态、不可移动的几何体相互作用，例如地板平面或凸容器。这个几何体作为模拟域的边界。对于一个位于位置p的粒子与一个静态平面相互作用，非穿透条件可以表述为粒子与平面之间有符号距离的约束。
- en: 'Let the plane be defined such that nTp−drest​=0 for any point p on it, where
    n is the unit normal and drest​ is an offset. A non-penetration constraint for
    a particle p is then written as an inequality: C(p)=nTp−drest​≥0(33.2.2) When
    a particle violates this constraint (i.e., C(p)<0), the PBD solver projects its
    position back to the surface. Since only one particle is dynamic, its inverse
    mass is effectively infinite compared to the static geometry, so it receives the
    full position correction required to satisfy C(p)=0. The correction simply moves
    the particle along the plane normal n to resolve the penetration. You can imagine
    how this can be simply extended to more complex shapes.'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 让平面定义为，对于它上面的任何点 p，有 nTp−drest​=0，其中 n 是单位法线，drest 是一个偏移量。一个粒子 p 的非穿透约束可以写成不等式：C(p)=nTp−drest​≥0(33.2.2)。当一个粒子违反这个约束（即，C(p)<0）时，PBD
    求解器将其位置投影回表面。由于只有一个粒子是动态的，与静态几何相比，其逆质量实际上是无限的，因此它接收满足 C(p)=0 所需的全部位置校正。校正简单地沿着平面法线
    n 移动粒子以解决穿透。你可以想象这如何简单地扩展到更复杂的形状。
- en: '[Particle-Particle Collisions](#particle-particle-collisions)'
  id: totrans-10
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[粒子-粒子碰撞](#particle-particle-collisions)'
- en: For simulating systems composed of discrete elements, such as granular materials,
    we have to consider direct particle-particle collision. This constraint prevents
    any two particles from overlapping.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 对于由离散元素组成的系统（如颗粒材料）的模拟，我们必须考虑直接的粒子-粒子碰撞。这个约束防止任何两个粒子重叠。
- en: 'For two particles at positions pi​ and pj​ with corresponding radii ri​ and
    rj​, the non-penetration constraint is a simple inequality based on their center-to-center
    distance: C(pi​,pj​)=∥pi​−pj​∥−(ri​+rj​)≥0(33.2.3) Unlike the linear plane constraint,
    this function is non-linear. This can be solved similarly to the stretching constraints
    considered in the previous section. The solver calculates a correction that pushes
    the two particles apart along the vector connecting their centers, distributing
    the correction based on their inverse masses to conserve linear momentum.'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 对于位于位置 pi 和 pj 的两个粒子，它们对应的半径为 ri 和 rj，非穿透约束是一个基于它们中心到中心距离的简单不等式：C(pi​,pj​)=∥pi​−pj​∥−(ri​+rj​)≥0(33.2.3)。与线性平面约束不同，这个函数是非线性的。这可以通过与上一节中考虑的拉伸约束类似的方法来解决。求解器计算一个校正，将两个粒子沿连接它们中心的向量推开，根据它们的逆质量分布校正，以保持线性动量守恒。
- en: '[Frictional Effects at the Position Level](#frictional-effects-at-the-position-level)'
  id: totrans-13
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[位置级别的摩擦效应](#frictional-effects-at-the-position-level)'
- en: Friction is a dissipative contact force that opposes relative tangential motion
    between surfaces. To be more robust we can incorporate friction directly into
    the position-level constraint solve. This method is applied after an interpenetration
    constraint between two particles, i and j, has been resolved.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 摩擦是一种耗散接触力，它反对表面之间的相对切向运动。为了更稳健，我们可以将摩擦直接纳入位置级约束求解。这种方法是在两个粒子 i 和 j 之间的穿透约束被解决之后应用的。
- en: Let pi​ and pj​ be the particle positions at the start of the time step. Let
    p∗i​ and p∗j​ be the current candidate positions, which have already been corrected
    to resolve penetration. The core idea is to compute a frictional position correction
    that opposes the tangential component of the particles' relative displacement
    during the timestep.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 让 pi 和 pj 分别是时间步长开始时的粒子位置。让 p∗i 和 p∗j 是当前的候选位置，这些位置已经校正以解决穿透。核心思想是计算一个摩擦位置校正，该校正反对粒子在时间步长内相对位移的切向分量。
- en: 'First, we determine the relative displacement vector over the timestep, Δprel​:
    Δprel​=(p∗i​−pi​)−(p∗j​−pj​) Next, we find the tangential component of this displacement,
    Δpt​, by projecting it onto the contact plane defined by the contact normal n.
    Δpt​=Δprel​−(Δprel​⋅n)n(33.2.4) The friction model determines the magnitude of
    the correction based on a comparison between the tangential displacement ∥Δpt​∥
    and the static friction threshold, which is proportional to the penetration depth
    d and the coefficient of static friction μs​.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们确定时间步长内的相对位移向量 Δprel：Δprel=(p∗i​−pi​)−(p∗j​−pj​)。接下来，我们通过将其投影到由接触法线 n 定义的接触平面上来找到这个位移的切向分量
    Δpt：Δpt=Δprel−(Δprel⋅n)n(33.2.4)。摩擦模型根据切向位移 ∥Δpt∥ 与静摩擦阈值之间的比较来确定校正的幅度，静摩擦阈值与穿透深度
    d 和静摩擦系数 μs 成正比。
- en: 'A position correction vector, Δpfriction​, is calculated to oppose Δpt​. This
    correction is then distributed between the two particles. The correction for particle
    i is given by: Δpi​=−wi​+wj​wi​​×{Δpt​Δpt​min(∥Δpt​∥μk​d​,1)​if ∥Δpt​∥≤μs​dotherwise​(Static Friction)(Kinetic Friction)​(33.2.5)
    where wi​=1/mi​ is the inverse mass and μk​ is the coefficient of kinetic friction.
    The negative sign is crucial, as friction must oppose the tangential displacement.
    In the static case, the correction fully cancels out the relative tangential movement.
    In the kinetic case, the correction is limited by the kinetic friction force (Coulomb''s
    law).'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 一个位置校正向量，Δpfriction，被计算出来以对抗Δpt。这个校正随后在两个粒子之间分配。粒子i的校正由以下公式给出：Δpi=−wi+wjwi×{ΔptΔptmin(∥Δpt∥μk​d​,1)if ∥Δpt∥≤μs​dotherwise}(Static
    Friction)(Kinetic Friction)(33.2.5) 其中 wi=1/mi 是质量的倒数，μk 是动摩擦系数。负号是至关重要的，因为摩擦必须对抗切向位移。在静态情况下，校正完全抵消了相对切向运动。在动态情况下，校正受到动摩擦力（库仑定律）的限制。
