["```py\ndef pca(X, l):\n    mean = np.mean(X, axis=0)\n    Y = X - mean\n    U, S, Vt = LA.svd(Y, full_matrices=False)\n    return U[:, :l] @ np.diag(S[:l]) \n```", "```py\nseed = 535\nrng = np.random.default_rng(seed)\nd, n, w = 1000, 100, 3.\nX = mmids.two_mixed_clusters(rng, d, n, w)\nT = pca(X, 2) \n```", "```py\nfig = plt.figure()\nax = fig.add_subplot(111,aspect='equal')\nax.scatter(T[:,0], T[:,1], s=5, c='k')\nplt.show() \n```", "```py\ndata = pd.read_csv('h3n2-snp.csv') \n```", "```py\nA = data[[data.columns[i] for i in range(1,len(data.columns))]].to_numpy()\nn_dims = 10\nT = pca(A, n_dims) \n```", "```py\nplt.figure(figsize=(5,3))\nplt.scatter(T[:,0], T[:,1], s=10, c='k')\nplt.axis([-3,6,-3,3])\nplt.show() \n```", "```py\nfrom sklearn.cluster import KMeans\n\nn_clusters = 8\nkmeans = KMeans(n_clusters=n_clusters, init='k-means++', \n                random_state=seed, n_init=10).fit(T)\nassign = kmeans.labels_ \n```", "```py\ndata_oth = pd.read_csv('h3n2-other.csv')\ndata_oth.head() \n```", "```py\nyear = data_oth['year'].to_numpy() \n```", "```py\nfig, ax = plt.subplots(figsize=(6,4))\n\nfor i in range(n_clusters):\n    unique, counts = np.unique(year[assign == i], return_counts=True)\n    ax.bar(unique, counts, label=i)\n\nax.set(xlim=(2001, 2007), xticks=np.arange(2002, 2007))\nax.legend()\nplt.show() \n```", "```py\nfig = plt.figure(figsize=(5,3))\nax = fig.add_subplot(111, aspect='equal')\nscatter = ax.scatter(T[:,0], T[:,1], s=10,  c=year, label=year)\nplt.legend(*scatter.legend_elements())\nplt.show() \n```", "```py\ncorr = np.zeros(n_dims)\nfor i in range(n_dims):\n    corr[i] = np.corrcoef(np.stack((T[:,i], year)))[0,1]\n\nprint(corr) \n```", "```py\n[-0.7905001  -0.42806325  0.0870437  -0.16839491  0.05757342 -0.06046913\n -0.07920042  0.01436618 -0.02544749  0.04314641] \n```", "```py\ndef pca(X, l):\n    mean = np.mean(X, axis=0)\n    Y = X - mean\n    U, S, Vt = LA.svd(Y, full_matrices=False)\n    return U[:, :l] @ np.diag(S[:l]) \n```", "```py\nseed = 535\nrng = np.random.default_rng(seed)\nd, n, w = 1000, 100, 3.\nX = mmids.two_mixed_clusters(rng, d, n, w)\nT = pca(X, 2) \n```", "```py\nfig = plt.figure()\nax = fig.add_subplot(111,aspect='equal')\nax.scatter(T[:,0], T[:,1], s=5, c='k')\nplt.show() \n```", "```py\ndata = pd.read_csv('h3n2-snp.csv') \n```", "```py\nA = data[[data.columns[i] for i in range(1,len(data.columns))]].to_numpy()\nn_dims = 10\nT = pca(A, n_dims) \n```", "```py\nplt.figure(figsize=(5,3))\nplt.scatter(T[:,0], T[:,1], s=10, c='k')\nplt.axis([-3,6,-3,3])\nplt.show() \n```", "```py\nfrom sklearn.cluster import KMeans\n\nn_clusters = 8\nkmeans = KMeans(n_clusters=n_clusters, init='k-means++', \n                random_state=seed, n_init=10).fit(T)\nassign = kmeans.labels_ \n```", "```py\ndata_oth = pd.read_csv('h3n2-other.csv')\ndata_oth.head() \n```", "```py\nyear = data_oth['year'].to_numpy() \n```", "```py\nfig, ax = plt.subplots(figsize=(6,4))\n\nfor i in range(n_clusters):\n    unique, counts = np.unique(year[assign == i], return_counts=True)\n    ax.bar(unique, counts, label=i)\n\nax.set(xlim=(2001, 2007), xticks=np.arange(2002, 2007))\nax.legend()\nplt.show() \n```", "```py\nfig = plt.figure(figsize=(5,3))\nax = fig.add_subplot(111, aspect='equal')\nscatter = ax.scatter(T[:,0], T[:,1], s=10,  c=year, label=year)\nplt.legend(*scatter.legend_elements())\nplt.show() \n```", "```py\ncorr = np.zeros(n_dims)\nfor i in range(n_dims):\n    corr[i] = np.corrcoef(np.stack((T[:,i], year)))[0,1]\n\nprint(corr) \n```", "```py\n[-0.7905001  -0.42806325  0.0870437  -0.16839491  0.05757342 -0.06046913\n -0.07920042  0.01436618 -0.02544749  0.04314641] \n```"]