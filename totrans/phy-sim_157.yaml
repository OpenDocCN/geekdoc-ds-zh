- en: Drucker-Prager Elastoplasticity
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec30.1-drucker_prager.html](https://phys-sim-book.github.io/lec30.1-drucker_prager.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: 'The **Drucker-Prager** plasticity model is widely used for simulating granular
    materials such as sand and soil. It generalizes the von Mises model by incorporating
    a **friction angle**, which governs how much shear stress the material can sustain
    relative to the normal stress. Physically, this corresponds to Coulomb-like friction
    between particles: the material yields when the shear stress exceeds a friction-dependent
    bound based on pressure.'
  prefs: []
  type: TYPE_NORMAL
- en: 'In stress space, the Drucker-Prager yield surface takes the shape of a **cone**,
    with three distinct cases to handle:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Case I (Elastic)**: The stress lies strictly inside the cone, and no plasticity
    occurs.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Case II (Expansion)**: The stress corresponds to a configuration where the
    material expands volumetrically (positive trace), and no resistance is applied—this
    maps to the cone tip.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Case III (Shearing)**: The stress lies outside the cone but with compressive
    pressure and must be projected back to the cone surface.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This model is best implemented in the **log-strain (Hencky strain)** space using
    the SVD of the deformation gradient, which we have already introduced in the previous
    section.
  prefs: []
  type: TYPE_NORMAL
- en: '**Example 31.1.1 (Drucker-Prager Yield Criterion, Log-Strain Formulation).**
    We define the **logarithmic strain** as:'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ϵ=log(Σ)+d1​log(Jvol​)I.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'The deviatoric part is:'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ϵ^=ϵ−d1​tr(ϵ)I.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'The plastic multiplier is computed as:'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Δγ=∥ϵ^∥+2μ(dλ+2μ)​⋅tr(ϵ)⋅α.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Here, α=32​​⋅3−sinϕ2sinϕ​ is the Drucker-Prager friction coefficient derived
    from the friction angle ϕ.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Then we apply the return mapping:'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'If tr(ϵ)>0 (Case II), we project to the cone tip: set ϵ=0.'
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
- en: 'If Δγ≤0, we are inside the cone (Case I): no change.'
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Otherwise (Case III), we project back to the cone surface:'
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ϵn+1=ϵ−∥ϵ^∥Δγ​ϵ^.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Finally, we compute the updated singular values:'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ΣEn+1​=exp(ϵn+1),
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'and reconstruct the elastic deformation:'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: FEn+1​=Udiag(ΣEn+1​)VT.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Example 31.1.2 (Drucker-Prager Plasticity with Volume Correction).**'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: In granular materials like sand, volumetric expansion can result in **non-physical
    volume gain** if not properly handled. The standard Drucker-Prager projection
    maps stress to the tip of the cone under expansion (positive trace), which corresponds
    to a **stress-free state**. However, this may unrealistically "lock in" expanded
    configurations as new rest shapes.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: This effect can cause persistent volume inflation when a particle experiences
    elastic expansion followed by plastic projection. Any future compression then
    incurs artificial elastic penalties, resulting in incorrect material response.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'To correct this, we follow the volume correction treatment described by [[Tampubolon
    et al. 2017]](bibliography.html#tampubolon2017multi) by introducing a per-particle
    scalar accumulator vvol​ that tracks **log-volume changes** induced by plastic
    projection:'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: vvoln+1​=vvoln​−logdetFEn+1​+logdetFtrial​.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'This correction is naturally integrated into the **log-strain formulation**
    by adjusting the strain before return mapping:'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ϵcorrected​=ϵtrial​+dvvol​​I,
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: where d is the spatial dimension. This allows future compression to **neutralize
    previous volume gain** rather than being resisted elastically. In the code below,
    `diff_log_J` provides this volume correction term, computed as the accumulation
    of log-difference of determinants.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Implementation 31.1.1 (Drucker-Prager Elastoplasticity Return Mapping, simulator.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'The return mapping is enforced during particle state update:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 31.1.2 (Particle State Update, simulator.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
