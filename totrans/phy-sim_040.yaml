- en: Distance Barrier
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec7.2-dist_barrier_formulation.html](https://phys-sim-book.github.io/lec7.2-dist_barrier_formulation.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: '[Constrained Optimization](#constrained-optimization)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In scenarios like a solid interacting with a planar ground, where the signed
    distance function \( d(\mathbf{x}) \) is smooth outside the obstacle, we can approach
    the modeling of contact by incorporating non-interpenetration constraints. These
    constraints are formulated using \( d(\mathbf{x}) \), while we also aim to minimize
    the Incremental Potential of the system.
  prefs: []
  type: TYPE_NORMAL
- en: 'Assuming that the solids are densely sampled with nodes \(\mathbf{x}\), we
    apply these constraints at the level of nodal Degrees of Freedom (DOFs) in relation
    to the obstacles:'
  prefs: []
  type: TYPE_NORMAL
- en: xmin​E(x)s.t.dij​≥0  ∀ node i and obstacle j.(7.2.1)
  prefs: []
  type: TYPE_NORMAL
- en: In this equation, \( d_{ij} \) represents the signed distance between node \(
    i \) and obstacle \( j \). By ensuring that \( d_{ij} \) is non-negative, we effectively
    prevent the solids from intersecting with the obstacles^([1](#1)).
  prefs: []
  type: TYPE_NORMAL
- en: '[Logarithm Barrier Potential in Contact Modeling](#logarithm-barrier-potential-in-contact-modeling)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'To address the inequality constraints in our contact modeling, we introduce
    a barrier potential \( P_b(\mathbf{x}) \). This potential transforms the constrained
    problem, as described in Equation [(7.2.1)](#eq:lec7:constrained_IP), into an
    "unconstrained" optimization problem:'
  prefs: []
  type: TYPE_NORMAL
- en: xmin​E(x)+h2Pb​(x).(7.2.2)
  prefs: []
  type: TYPE_NORMAL
- en: 'The barrier potential is defined as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Pb​(x)=i,j∑​Ai​d^b(dij​(x))andb(dij​(x))={2κ​(d^dij​​−1)lnd^dij​​0​dij​<d^dij​≥d^.​(7.2.3)
  prefs: []
  type: TYPE_NORMAL
- en: In this formulation, \( b() \) represents the barrier energy density function.
    As the distance approaches zero, this function tends to infinity, thereby providing
    a strong repulsion force to prevent interpenetration (refer to [Figure 7.2.1](#fig:lec7:barrier_func)).
    The distance threshold \( \hat{d} \) above which no contact force is exerted,
    the contact stiffness \( \kappa \) which controls the rate of change of the contact
    forces with respect to distance, and \( A_i \), the contact area of node \( i
    \), are key parameters in this setup. By integrating the energy density over the
    solid boundary, the barrier formulation effectively models a potential energy
    field that is of thickness \( \hat{d} \).
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/7b7e341815511cccbbeb32ed6ab5878d.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 7.2.1.** The barrier energy density function plotted with different
    d^. Decreasing d^ asymptotically matches the discontinuous definition of the contact
    condition.'
  prefs: []
  type: TYPE_NORMAL
- en: '***Remark 7.2.1 (Contact Layer Interpretation).*** Imagine the barrier potential
    \( P_b(\mathbf{x}) \) as representing the elasticity of an ultra-thin layer of
    virtual material that exists just outside the boundaries of the solids. This virtual
    layer has an effective thickness of \( \hat{d} \), which correlates with the distance
    threshold in the barrier function.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Consequently, the integration or summation used in computing \( P_b(\mathbf{x})
    \) is weighted by the volume element \( w_i = A_i \hat{d} \), where \( A_i \)
    represents the contact area of each node. As solids approach and begin to compress
    this virtual elastic layer, contact forces arise. These forces, akin to a unique
    type of elasticity force, serve to prevent interpenetration by providing a repulsion
    effect whenever the solids come too close to each other. This model allows us
    to simulate the physical response of contact without actual penetration of the
    solids.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Applying chain rules with distance being the intermediate variables, we can
    derive the gradient and Hessian of \(P_b(\mathbf{x})\) as ∇Pb​(x)=i,j∑​wi​∂d∂b​(dij​(x))∇dij​(x)(7.2.4)
    and ∇2Pb​(x)=i,j∑​wi​(∂d2∂2b​(dij​(x))∇dij​(x)∇dij​(x)T+∂d∂b​(dij​(x))∇2dij​(x)).(7.2.5)
  prefs: []
  type: TYPE_NORMAL
- en: ¹
  prefs: []
  type: TYPE_NORMAL
- en: As we are using signed distances here, the inequality constraints can be defined
    without introducing an \(\epsilon\) as in Equation [(2.3.1)](lec2.3-contact.html#eq:lec2:IC)
    with unsigned distances.
  prefs: []
  type: TYPE_NORMAL
