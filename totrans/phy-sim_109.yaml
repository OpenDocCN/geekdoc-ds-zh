- en: Continuous Collision Detection
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 连续碰撞检测
- en: 原文：[https://phys-sim-book.github.io/lec21.4-ccd.html](https://phys-sim-book.github.io/lec21.4-ccd.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec21.4-ccd.html](https://phys-sim-book.github.io/lec21.4-ccd.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: Now, we have all the ingredients to solve for the search direction in a simulation
    with self-contact. After obtaining the search direction, we perform line search
    filtering for the point-edge pairs.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们有了解决具有自接触的模拟中搜索方向的所有要素。在获得搜索方向后，我们对点-边对执行线搜索过滤。
- en: '**Implementation 21.4.1 (Line search filtering, BarrierEnergy.py).**'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现21.4.1（线搜索过滤，BarrierEnergy.py）。**'
- en: '[PRE0]'
  id: totrans-5
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Here, we perform an overlap check on the bounding boxes of the spans of the
    point and edge first to narrow down the number of point-edge pairs for which we
    need to compute the time of impact:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们首先对点和边的跨度边界框执行重叠检查，以缩小需要计算碰撞时间的点-边对的数量：
- en: '**Implementation 21.4.2 (Bounding box overlap check, CCD.py).**'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现21.4.2（边界框重叠检查，CCD.py）。**'
- en: '[PRE1]'
  id: totrans-8
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: To calculate a sufficiently large conservative estimation of the time of impact
    (TOI), we cannot directly calculate the TOI and take a proportion of it as we
    did for point-ground contact in [Filter Line Search](./lec8-filter_line_search.html).
    Directly calculating the TOI for contact primitive pairs requires solving quadratic
    or cubic root-finding problems in 2D and 3D, which are prone to numerical errors,
    especially when distances are tiny and configurations are numerically degenerate
    (e.g., nearly parallel edge-edge pairs in 3D).
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 为了计算足够大的保守估计的碰撞时间（TOI），我们不能像在[Filter Line Search](./lec8-filter_line_search.html)中处理点-地面接触那样直接计算TOI并取其一部分。直接计算接触原语对的TOI需要解决2D和3D中的二次或三次根查找问题，这些方法容易产生数值误差，尤其是在距离极小且配置数值退化时（例如，3D中的几乎平行的边-边对）。
- en: Thus, we implement the additive CCD method (ACCD) [[Li et al. 2021]](bibliography.html#li2021codimensional),
    which iteratively moves the contact pairs along the search direction until the
    minimum separation distance is reached, to robustly estimate the TOI.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们实现了加法连续碰撞检测方法（ACCD）[[Li et al. 2021]](bibliography.html#li2021codimensional)，该方法迭代地将接触对沿搜索方向移动，直到达到最小分离距离，以稳健地估计TOI。
- en: Taking a point-edge pair as an example, the key insight of ACCD is that, given
    the current positions p, e0​, e1​ and search directions dp​, de0​, de1​, its TOI
    can be calculated as
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 以点-边对为例，ACCD的关键洞察是，给定当前位置p、e0、e1和搜索方向dp、de0、de1，其TOI可以计算为
- en: αTOI​=∥dp​−((1−λ)de0​+λde1​)∥∥p−((1−λ)e0​+λe1​)∥​
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: αTOI=∥dp−((1−λ)de0+λde1)∥∥p−((1−λ)e0+λe1)∥
- en: assuming (1−λ)e0​+λe1​ is the point on the edge that p will first collide with.
    The issue is that we do not know λ a priori. However, we can derive a lower bound
    for αTOI​ as
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 假设(1−λ)e0+λe1是p将首先与之碰撞的边上的点。问题是，我们事先不知道λ。然而，我们可以推导出αTOI的下界作为
- en: αTOI​​≥∥dp​∥+∥(1−λ)de0​+λde1​∥minλ∈[0,1]​∥p−((1−λ)e0​+λe1​)∥​≥∥dp​∥+max(∥de0​∥,∥de1​∥)dPE(p,e0​,e1​)​=αl​​​
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: αTOI≥∥dp∥+∥(1−λ)de0+λde1∥minλ∈[0,1]∥p−((1−λ)e0+λe1)∥≥∥dp∥+max(∥de0∥,∥de1∥)dPE(p,e0,e1)​=αl
- en: By taking a step with this lower bound αl​, we are guaranteed to have no interpenetration
    for this pair. However, although straightforward to compute, αl​ can be much smaller
    than αTOI​. Therefore, we iteratively calculate αl​ and advance a copy of the
    participating nodes by this amount, accumulating all αl​ to monotonically improve
    the estimate of αTOI​ until the point-edge pair reaches a distance smaller than
    the minimum separation, e.g., 0.1× the original distance. The implementation is
    as follows, where we first remove the shared components of the search directions
    so that they have smaller magnitudes to achieve earlier termination of the algorithm.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 通过取一个步长αl，我们保证这对没有穿透。然而，尽管计算简单，αl可能远小于αTOI。因此，我们迭代地计算αl，并按此量移动参与节点的副本，累积所有αl以单调地提高αTOI的估计，直到点-边对达到小于最小分离距离，例如，原始距离的0.1倍。实现如下，我们首先移除搜索方向中的共享部分，以便它们具有较小的幅度，从而实现算法的早期终止。
- en: '**Implementation 21.4.3 (ACCD method implementation, CCD.py).**'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现21.4.3（ACCD方法实现，CCD.py）。**'
- en: '[PRE2]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: The final simulation results are demonstrated in [Figure 21.4.1](#fig:lec21:compress_2_squares).
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 最终的模拟结果在[图21.4.1](#fig:lec21:compress_2_squares)中展示。
- en: '![](../Images/4fc528d88153a0359b2bddfa6c2330f4.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/4fc528d88153a0359b2bddfa6c2330f4.png)'
- en: '**Figure 21.4.1.** Two squares dropped onto the ground and compressed by a
    ceiling. The ground has friction coefficient 0.4 but there is no friction between
    the squares so that the top square slides down to the ground without significantly
    changing the position of the bottom one.'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '**图21.4.1**。两个正方形被扔到地面上并被天花板压缩。地面有摩擦系数0.4，但两个正方形之间没有摩擦，因此上面的正方形滑到地面上，而没有显著改变下面一个的位置。'
