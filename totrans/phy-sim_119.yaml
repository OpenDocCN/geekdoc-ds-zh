- en: Elasticity
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec23.3-elasticity.html](https://phys-sim-book.github.io/lec23.3-elasticity.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: For elasticity, similar to the 2D case, the deformation gradient F is also constant
    within each tetrahedron, and we can compute it as F=≈=​∂(β,γ,τ)∂x​(∂(β,γ,τ)∂X​)−1∂(β,γ,τ)∂x^​(∂(β,γ,τ)∂X​)−1[x2​−x1​,x3​−x1​,x4​−x1​][X2​−X1​,X3​−X1​,X4​−X1​]−1.​
    For force and Hessian computation, the required ∂F/∂x can be computed using ∇XN1​(X)​=∂X∂(1−β−γ−τ)​=(∂(β,γ,τ)∂(1−β−γ−τ)​(∂(β,γ,τ)∂X​)−1)T=([−1,−1,−1][X2​−X1​,X3​−X1​,X4​−X1​]−1)T​
    and similarly ∇XN2​(X)∇XN3​(X)∇XN3​(X)​=∂X∂β​=([1,0,0][X2​−X1​,X3​−X1​,X4​−X1​]−1)T,=∂X∂γ​=([0,1,0][X2​−X1​,X3​−X1​,X4​−X1​]−1)T,=∂X∂τ​=([0,0,1][X2​−X1​,X3​−X1​,X4​−X1​]−1)T.​
    With F, the computation of strain energy Ψ, stress P and stress derivative ∂P/∂F
    can all be found in [Strain Energy](./lec13-strain_energy.html) and [Stress and
    Its Derivatives](./lec14-stress_and_derivatives.html), and the computation of
    forces and Hessian matrices follow the same spirit as in 2D.
  prefs: []
  type: TYPE_NORMAL
- en: 'To guarantee non-inversion of the tetrahedral elements during the simulation,
    the critical step size αI that first brings the volume of any tetrahedra to 0
    can be obtained by solving a 1D equation per tetrahedron V(xi​+αIpi​)=0, and then
    take the minimum of the solved step sizes. Here pi​ is the search direction of
    node i, and in 3D, this is equivalent to det([x21α​,x31α​,x41α​])≡(x21α​×x31α​)⋅x41α​=0(23.3.1)
    with xijα​=xij​+αIpij​ and xij​=xi​−xj​, pij​=pi​−pj​. Expanding Equation [(23.3.1)](#eq:lec23:det_tri_equals_0),
    we obtain the following cubic equation for αI:'
  prefs: []
  type: TYPE_NORMAL
- en: ((p21​×p31​)⋅p41​)αI3+((x21​×p31​+p21​×x31​)⋅p41​+(p21​×p31​)⋅x41​)αI2+((x21​×p31​+p21​×x31​)⋅x41​+(x21​×x31​)⋅p41​)αI+(x21​×x31​)⋅x41​=0,​
  prefs: []
  type: TYPE_NORMAL
- en: 'This cubic equation can sometimes degenerate into a quadratic or linear equation,
    particularly when node movements do not substantially alter the tetrahedron''s
    volume. To address potential numerical instability, we scale the equation terms
    based on the constant term coefficient:'
  prefs: []
  type: TYPE_NORMAL
- en: ​(x21​×x31​)⋅x41​(p21​×p31​)⋅p41​​αI3+(x21​×x31​)⋅x41​(x21​×p31​+p21​×x31​)⋅p41​+(p21​×p31​)⋅x41​​αI2+(x21​×x31​)⋅x41​(x21​×p31​+p21​×x31​)⋅x41​+(x21​×x31​)⋅p41​​αI+1=0,​(23.3.2)
  prefs: []
  type: TYPE_NORMAL
- en: ensuring that magnitude checks can be safely performed with standard thresholds
    (e.g., 10−6).
  prefs: []
  type: TYPE_NORMAL
- en: 'Practically, we also ensure some safety margin by solving for αI that reduces
    the volume of any tetrahedron by 80%, modifying the constant term coefficient
    in Equation [(23.3.2)](#eq:lec23:scaled_quad_eq_of_alphaI) from 1 to 0.8. If no
    positive real roots are found, the step size can be considered safe, and inversion
    will not occur. Here is the C++ code snippet for solving this scaled cubic equation:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 23.3.1 (Cubic Equation Solver).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
