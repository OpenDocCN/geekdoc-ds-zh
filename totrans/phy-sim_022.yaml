- en: Inertia Term
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec4.2-inertia.html](https://phys-sim-book.github.io/lec4.2-inertia.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: 'For the inertia term, with \(\tilde{x}^n = x^n + h v^n\), we have \[ E_I(x)
    = \frac{1}{2}\|x - \tilde{x}^n \|_M^2, \quad \nabla E_I(x) = M(x - \tilde{x}^n),
    \quad \text{and} \quad \nabla^2 E_I(x) = M, \] which is straightforward to implement:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 4.2.1 (InertiaEnergy.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'The functions `val()`, `grad()`, and `hess()` are designed to compute different
    components of the inertia term. Specifically:'
  prefs: []
  type: TYPE_NORMAL
- en: '`val()`: Computes the value of the inertia term.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`grad()`: Calculates the gradient of the inertia term.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`hess()`: Determines the Hessian of the inertia term.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Regarding the Hessian matrix, a memory-efficient approach is employed. Rather
    than allocating a large two-dimensional array to store all entries of the Hessian
    matrix, only the nonzero entries are kept. This is achieved using the `IJV` structure,
    which consists of three lists:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Row Index**: Identifies the row position of each nonzero entry.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Column Index**: Indicates the column position of each nonzero entry.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Value**: The actual nonzero value at the specified row and column.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: This method significantly reduces memory usage and computational costs associated
    with downstream processing.
  prefs: []
  type: TYPE_NORMAL
