["```r\ndata_allbus <- read_dta(\"data/allbus2021_reduziert.dta\") \n # Here all cases are deleted, which have missing values on any of the variables. This is only recommended for reduced data sets with few variables, otherwise you would \"throw out\" observations based on non-relevant variables\ndata_allbus <- [na.omit](https://rdrr.io/r/stats/na.fail.html)(data_allbus)\n # We also delete three observations that indicated \"diverse\" for the gender variable, as this simplifies hypothesis generation\ndata_allbus<-[subset](https://rdrr.io/r/base/subset.html)(data_allbus, sex!=3)\n # We now recode variables\ndata_allbus$income <- data_allbus$incc\n data_allbus <- data_allbus %>% \n mutate(female =\n case_when(sex == 1 ~ 0,\n sex == 2 ~ 1))\n data_allbus <- data_allbus %>% \n mutate(east =\n case_when(eastwest == 1 ~ 0,\n eastwest == 2 ~ 1))\n data_allbus <- data_allbus %>% \n mutate(unemployed =\n case_when(dw18 == 1 ~ 1,\n dw18 == 2 ~ 0))\n # Summarize and overview data\n[summary](https://rdrr.io/r/base/summary.html)(data_allbus)\n```", "```r\n##     eastwest          sex             im19            im20           im21      \n##  Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.00   Min.   :1.000  \n##  1st Qu.:1.000   1st Qu.:1.000   1st Qu.:2.000   1st Qu.:2.00   1st Qu.:2.000  \n##  Median :1.000   Median :1.000   Median :3.000   Median :3.00   Median :3.000  \n##  Mean   :1.308   Mean   :1.486   Mean   :2.771   Mean   :2.82   Mean   :2.984  \n##  3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:3.000   3rd Qu.:3.00   3rd Qu.:4.000  \n##  Max.   :2.000   Max.   :2.000   Max.   :4.000   Max.   :4.00   Max.   :4.000  \n##       dw18            incc          income         female      \n##  Min.   :1.000   Min.   : 1.0   Min.   : 1.0   Min.   :0.0000  \n##  1st Qu.:2.000   1st Qu.:13.0   1st Qu.:13.0   1st Qu.:0.0000  \n##  Median :2.000   Median :15.0   Median :15.0   Median :0.0000  \n##  Mean   :1.812   Mean   :15.3   Mean   :15.3   Mean   :0.4859  \n##  3rd Qu.:2.000   3rd Qu.:19.0   3rd Qu.:19.0   3rd Qu.:1.0000  \n##  Max.   :2.000   Max.   :26.0   Max.   :26.0   Max.   :1.0000  \n##       east          unemployed    \n##  Min.   :0.0000   Min.   :0.0000  \n##  1st Qu.:0.0000   1st Qu.:0.0000  \n##  Median :0.0000   Median :0.0000  \n##  Mean   :0.3079   Mean   :0.1884  \n##  3rd Qu.:1.0000   3rd Qu.:0.0000  \n##  Max.   :1.0000   Max.   :1.0000\n```", "```r\nkable([head](https://rdrr.io/r/utils/head.html)(data_allbus, 10), format = \"html\", booktabs = TRUE, caption = \"ALLBUS survey data\") %>%\n kable_paper() %>% #Font scheme of the table\n scroll_box(width = \"100%\", height = \"100%\") #Scrollable box\n```", "```r\n# Do the items correlate sufficiently high for the index? (>.4 would be desirable)\n# Calculate correlation and output \nvars <- [c](https://rdrr.io/r/base/c.html)(\"im19\", \"im20\", \"im21\")\ncor.vars <- data_allbus[vars]\nrcorr([as.matrix](https://rdrr.io/r/base/matrix.html)(cor.vars))\n```", "```r\n##      im19 im20 im21\n## im19 1.00 0.46 0.33\n## im20 0.46 1.00 0.51\n## im21 0.33 0.51 1.00\n## \n## n= 2595 \n## \n## \n## P\n##      im19 im20 im21\n## im19       0    0  \n## im20  0         0  \n## im21  0    0\n```", "```r\n# Index creation\ndata_allbus$morejustice <- (data_allbus$im19 + data_allbus$im20 + data_allbus$im21)/3\n[hist](https://rdrr.io/r/graphics/hist.html)(data_allbus$morejustice)\n```", "```r\ndata_nrw <- [read_excel](https://readxl.tidyverse.org/reference/read_excel.html)(\"data/inkar_nrw.xls\") \nmodel1 <- [lm](https://rdrr.io/r/stats/lm.html)(crimerate ~ 1 + unemp, data = data_nrw)\nstargazer(model1, type = \"text\")\n```", "```r\n## \n## ===============================================\n##                         Dependent variable:    \n##                     ---------------------------\n##                              crimerate         \n## -----------------------------------------------\n## unemp                       517.460***         \n##                              (69.412)          \n##                                                \n## Constant                   2,398.594***        \n##                              (543.248)         \n##                                                \n## -----------------------------------------------\n## Observations                    53             \n## R2                             0.521           \n## Adjusted R2                    0.512           \n## Residual Std. Error     1,240.129 (df = 51)    \n## F Statistic           55.575*** (df = 1; 51)   \n## ===============================================\n## Note:               *p<0.1; **p<0.05; ***p<0.01\n```", "```r\nmodel_biv <- [lm](https://rdrr.io/r/stats/lm.html)(morejustice ~ 1 + income, data = data_allbus) # 1 refers to the constant or intercept \n[summary](https://rdrr.io/r/base/summary.html)(model_biv)\n```", "```r\n## \n## Call:\n## lm(formula = morejustice ~ 1 + income, data = data_allbus)\n## \n## Residuals:\n##      Min       1Q   Median       3Q      Max \n## -2.12251 -0.49371  0.06216  0.46936  1.33916 \n## \n## Coefficients:\n##              Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)  3.140981   0.045227  69.449  < 2e-16 ***\n## income      -0.018467   0.002833  -6.518 8.53e-11 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 0.6574 on 2593 degrees of freedom\n## Multiple R-squared:  0.01612,    Adjusted R-squared:  0.01574 \n## F-statistic: 42.48 on 1 and 2593 DF,  p-value: 8.532e-11\n```", "```r\nstargazer(model_biv, type = \"text\")\n```", "```r\n## \n## ===============================================\n##                         Dependent variable:    \n##                     ---------------------------\n##                             morejustice        \n## -----------------------------------------------\n## income                       -0.018***         \n##                               (0.003)          \n##                                                \n## Constant                     3.141***          \n##                               (0.045)          \n##                                                \n## -----------------------------------------------\n## Observations                   2,595           \n## R2                             0.016           \n## Adjusted R2                    0.016           \n## Residual Std. Error      0.657 (df = 2593)     \n## F Statistic          42.484*** (df = 1; 2593)  \n## ===============================================\n## Note:               *p<0.1; **p<0.05; ***p<0.01\n```", "```r\n# Standardized regression coefficient by hand\nsdx <- [sd](https://rdrr.io/r/stats/sd.html)(data_allbus$income)\nsdy <- [sd](https://rdrr.io/r/stats/sd.html)(data_allbus$morejustice)\n beta_s <- (-0.018281*sdx)/sdy\nbeta_s\n```", "```r\n## [1] -0.1256859\n```", "```r\n# Standardized regression coefficient with model\nmodel_biv_s <- [lm](https://rdrr.io/r/stats/lm.html)([scale](https://rdrr.io/r/base/scale.html)(morejustice) ~ 1 + [scale](https://rdrr.io/r/base/scale.html)(income), data = data_allbus)\n[summary](https://rdrr.io/r/base/summary.html)(model_biv_s)\n```", "```r\n## \n## Call:\n## lm(formula = scale(morejustice) ~ 1 + scale(income), data = data_allbus)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -3.2030 -0.7450  0.0938  0.7083  2.0209 \n## \n## Coefficients:\n##                 Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)    2.553e-17  1.948e-02   0.000        1    \n## scale(income) -1.270e-01  1.948e-02  -6.518 8.53e-11 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 0.9921 on 2593 degrees of freedom\n## Multiple R-squared:  0.01612,    Adjusted R-squared:  0.01574 \n## F-statistic: 42.48 on 1 and 2593 DF,  p-value: 8.532e-11\n```", "```r\n# Calculate correlation\nvars <- [c](https://rdrr.io/r/base/c.html)(\"income\", \"morejustice\")\ncor.vars <- data_allbus[vars]\nrcorr([as.matrix](https://rdrr.io/r/base/matrix.html)(cor.vars))\n```", "```r\n##             income morejustice\n## income        1.00       -0.13\n## morejustice  -0.13        1.00\n## \n## n= 2595 \n## \n## \n## P\n##             income morejustice\n## income              0         \n## morejustice  0\n```", "```r\nUnemployment: East Germany:\n```", "```r\nIncome H_0: H_A: Female H_0: H_A: Unemployed H_0: H_A: East Germany H_0: H_A:\n```", "```r\nmodel_mult <- [lm](https://rdrr.io/r/stats/lm.html)(morejustice ~ 1 + income + female + unemployed + east, data = data_allbus)\n stargazer(model_biv, model_mult, type = \"text\")\n```", "```r\n## \n## =====================================================================\n##                                    Dependent variable:               \n##                     -------------------------------------------------\n##                                        morejustice                   \n##                               (1)                      (2)           \n## ---------------------------------------------------------------------\n## income                     -0.018***                -0.011***        \n##                             (0.003)                  (0.003)         \n##                                                                      \n## female                                               0.128***        \n##                                                      (0.028)         \n##                                                                      \n## unemployed                                           0.066**         \n##                                                      (0.033)         \n##                                                                      \n## east                                                 0.075***        \n##                                                      (0.028)         \n##                                                                      \n## Constant                    3.141***                 2.936***        \n##                             (0.045)                  (0.059)         \n##                                                                      \n## ---------------------------------------------------------------------\n## Observations                 2,595                    2,595          \n## R2                           0.016                    0.027          \n## Adjusted R2                  0.016                    0.026          \n## Residual Std. Error    0.657 (df = 2593)        0.654 (df = 2590)    \n## F Statistic         42.484*** (df = 1; 2593) 18.263*** (df = 4; 2590)\n## =====================================================================\n## Note:                                     *p<0.1; **p<0.05; ***p<0.01\n```", "```r\nIncome Female Unemployed East Germany\n```", "```r\n##Regression diagnostics\nvif(model_mult)\n```", "```r\n##     income     female unemployed       east \n##   1.215933   1.175482   1.037561   1.014182\n```", "```r\npredict.model <- [fitted](https://rdrr.io/r/stats/fitted.values.html)(model_mult)\nerror.model <- [residuals](https://rdrr.io/r/stats/residuals.html)(model_mult)\n [hist](https://rdrr.io/r/graphics/hist.html)(error.model)\n```", "```r\nqqPlot(error.model)\n```", "```r\n## [1]  741 1011\n```", "```r\nscatterplot(error.model~predict.model, regLine=TRUE, smooth=FALSE, boxplots=FALSE)\n```", "```r\nbptest(model_mult)\n```", "```r\n## \n##  studentized Breusch-Pagan test\n## \n## data:  model_mult\n## BP = 5.4228, df = 4, p-value = 0.2466\n```", "```r\n#Create and print scatter plot\nsc1 <- ggplot(data=data_allbus, aes(income, morejustice)) +\n geom_point() \nsc1\n```", "```r\nsc2 <- ggplot(data=data_allbus, aes(income, morejustice)) +\n geom_jitter(aes(income = morejustice), size = 0.5) + geom_smooth()\nsc2\n```", "```r\ndata_allbus$income_squared <-  data_allbus$income*data_allbus$income\n model_nlin <- [lm](https://rdrr.io/r/stats/lm.html)(morejustice ~ 1 + income + income_squared + female + unemployed + east, data = data_allbus)\n stargazer(model_biv, model_mult, model_nlin, type = \"text\")\n```", "```r\n## \n## ==============================================================================================\n##                                                Dependent variable:                            \n##                     --------------------------------------------------------------------------\n##                                                    morejustice                                \n##                               (1)                      (2)                      (3)           \n## ----------------------------------------------------------------------------------------------\n## income                     -0.018***                -0.011***                 0.048***        \n##                             (0.003)                  (0.003)                  (0.013)         \n##                                                                                               \n## income_squared                                                               -0.002***        \n##                                                                               (0.0004)        \n##                                                                                               \n## female                                               0.128***                 0.125***        \n##                                                      (0.028)                  (0.028)         \n##                                                                                               \n## unemployed                                           0.066**                   0.055*         \n##                                                      (0.033)                  (0.033)         \n##                                                                                               \n## east                                                 0.075***                 0.058**         \n##                                                      (0.028)                  (0.028)         \n##                                                                                               \n## Constant                    3.141***                 2.936***                 2.546***        \n##                             (0.045)                  (0.059)                  (0.101)         \n##                                                                                               \n## ----------------------------------------------------------------------------------------------\n## Observations                 2,595                    2,595                    2,595          \n## R2                           0.016                    0.027                    0.036          \n## Adjusted R2                  0.016                    0.026                    0.034          \n## Residual Std. Error    0.657 (df = 2593)        0.654 (df = 2590)        0.651 (df = 2589)    \n## F Statistic         42.484*** (df = 1; 2593) 18.263*** (df = 4; 2590) 19.189*** (df = 5; 2589)\n## ==============================================================================================\n## Note:                                                              *p<0.1; **p<0.05; ***p<0.01\n```", "```r\n# Letting R know that the two nominal variables \"female\" and \"east\" are indeed nominal or \"factor variables\" is important for the graphical representation of the interaction below\n data_allbus$female <- [factor](https://rdrr.io/r/base/factor.html)(data_allbus$female)\ndata_allbus$east <- [factor](https://rdrr.io/r/base/factor.html)(data_allbus$east)\n # The interactions can be specified with \":\" or \"*\".\nmodel_interaktion <- [lm](https://rdrr.io/r/stats/lm.html)(morejustice ~ 1 + income + unemployed + female + east + female : east , data = data_allbus)\n stargazer(model_interaktion, type = \"text\")\n```", "```r\n## \n## ===============================================\n##                         Dependent variable:    \n##                     ---------------------------\n##                             morejustice        \n## -----------------------------------------------\n## income                       -0.011***         \n##                               (0.003)          \n##                                                \n## unemployed                    0.065*           \n##                               (0.033)          \n##                                                \n## female1                      0.163***          \n##                               (0.033)          \n##                                                \n## east1                        0.128***          \n##                               (0.040)          \n##                                                \n## female1:east1                 -0.106*          \n##                               (0.056)          \n##                                                \n## Constant                     2.912***          \n##                               (0.060)          \n##                                                \n## -----------------------------------------------\n## Observations                   2,595           \n## R2                             0.029           \n## Adjusted R2                    0.027           \n## Residual Std. Error      0.654 (df = 2589)     \n## F Statistic          15.351*** (df = 5; 2589)  \n## ===============================================\n## Note:               *p<0.1; **p<0.05; ***p<0.01\n```", "```r\ncat_plot(model_interaktion, pred = female, modx = east, geom = \"line\", point.shape = TRUE,\n vary.lty = TRUE)\n```"]