["```cpp\nvoid prefix(int *a, int n) {  for (int i = 1; i < n; i++) a[i] += a[i - 1]; } \n```", "```cpp\nloop:  add     edx, DWORD PTR [rax] mov     DWORD PTR [rax-4], edx add     rax, 4 cmp     rax, rcx jne     loop \n```", "```cpp\nfor (int l = 0; l < logn; l++)  // (atomically and in parallel): for (int i = (1 << l); i < n; i++) a[i] += a[i - (1 << l)]; \n```", "```cpp\ntypedef __m128i v4i;   v4i prefix(v4i x) {  // x = 1, 2, 3, 4 x = _mm_add_epi32(x, _mm_slli_si128(x, 4)); // x = 1, 2, 3, 4 //   + 0, 1, 2, 3 //   = 1, 3, 5, 7 x = _mm_add_epi32(x, _mm_slli_si128(x, 8)); // x = 1, 3, 5, 7 //   + 0, 0, 1, 3 //   = 1, 3, 6, 10 return x; } \n```", "```cpp\ntypedef __m256i v8i;   v8i prefix(v8i x) {  // x = 1, 2, 3, 4, 5, 6, 7, 8 x = _mm256_add_epi32(x, _mm256_slli_si256(x, 4)); x = _mm256_add_epi32(x, _mm256_slli_si256(x, 8)); x = _mm256_add_epi32(x, _mm256_slli_si256(x, 16)); // <- this does nothing // x = 1, 3, 6, 10, 5, 11, 18, 26 return x; } \n```", "```cpp\nvoid prefix(int *p) {  v8i x = _mm256_load_si256((v8i*) p); x = _mm256_add_epi32(x, _mm256_slli_si256(x, 4)); x = _mm256_add_epi32(x, _mm256_slli_si256(x, 8)); _mm256_store_si256((v8i*) p, x); } \n```", "```cpp\nv4i accumulate(int *p, v4i s) {  v4i d = (v4i) _mm_broadcast_ss((float*) &p[3]); v4i x = _mm_load_si128((v4i*) p); x = _mm_add_epi32(s, x); _mm_store_si128((v4i*) p, x); return _mm_add_epi32(s, d); } \n```", "```cpp\nvoid prefix(int *a, int n) {  for (int i = 0; i < n; i += 8) prefix(&a[i]);  v4i s = _mm_setzero_si128();  for (int i = 4; i < n; i += 4) s = accumulate(&a[i], s); } \n```", "```cpp\nconst int B = 4096; // <- ideally should be slightly less or equal to the L1 cache  v4i local_prefix(int *a, v4i s) {  for (int i = 0; i < B; i += 8) prefix(&a[i]);  for (int i = 0; i < B; i += 4) s = accumulate(&a[i], s);   return s; }   void prefix(int *a, int n) {  v4i s = _mm_setzero_si128(); for (int i = 0; i < n; i += B) s = local_prefix(a + i, s); } \n```", "```cpp\nv4i accumulate(int *p, v4i s) {  __builtin_prefetch(p + B); // <-- prefetch the next block // ... return s; } \n```", "```cpp\nconst int B = 64; //        ^ small sizes cause pipeline stalls //          large sizes cause cache system inefficiencies  void prefix(int *a, int n) {  v4i s = _mm_setzero_si128();   for (int i = 0; i < B; i += 8) prefix(&a[i]);   for (int i = B; i < n; i += 8) { prefix(&a[i]); s = accumulate(&a[i - B], s); s = accumulate(&a[i - B + 4], s); }   for (int i = n - B; i < n; i += 4) s = accumulate(&a[i], s); } \n```"]