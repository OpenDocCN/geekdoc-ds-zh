["```py\nlibrary(cancensus)\nlibrary(canlang)\nlibrary(maps)\nlibrary(tidycensus)\nlibrary(tidyverse)\nlibrary(tinytable)\n```", "```py\nset.seed(853)\n\nnewborn_weight <-\n tibble(\n weight = rep(\n x = rnorm(n = 1000, mean = 3.5, sd = 0.5), \n times = 3),\n measurement = rep(\n x = c(\"Actual\", \"Censored\", \"Truncated\"),\n each = 1000)\n )\n\nnewborn_weight <-\n newborn_weight |>\n mutate(\n weight = case_when(\n weight <= 2.75 & measurement == \"Censored\" ~ 2.75,\n weight >= 4.25 & measurement == \"Truncated\" ~ NA_real_,\n TRUE ~ weight\n )\n )\n\nnewborn_weight |>\n ggplot(aes(x = weight)) +\n geom_histogram(bins = 50) +\n facet_wrap(vars(measurement)) +\n theme_minimal()\n```", "```py\nnewborn_weight |>\n summarise(mean = mean(weight, na.rm = TRUE),\n .by = measurement) |> \n tt() |> \n style_tt(j = 1:2, align = \"lr\") |> \n format_tt(digits = 3, num_fmt = \"decimal\") |> \n setNames(c(\"Measurement\", \"Mean\"))\n```", "```py\ncan_lang\n```", "```py\n# A tibble: 214 × 6\n   category          language mother_tongue most_at_home most_at_work lang_known\n   <chr>             <chr>            <dbl>        <dbl>        <dbl>      <dbl>\n 1 Aboriginal langu… Aborigi…           590          235           30        665\n 2 Non-Official & N… Afrikaa…         10260         4785           85      23415\n 3 Non-Official & N… Afro-As…          1150          445           10       2775\n 4 Non-Official & N… Akan (T…         13460         5985           25      22150\n 5 Non-Official & N… Albanian         26895        13135          345      31930\n 6 Aboriginal langu… Algonqu…            45           10            0        120\n 7 Aboriginal langu… Algonqu…          1260          370           40       2480\n 8 Non-Official & N… America…          2685         3020         1145      21930\n 9 Non-Official & N… Amharic          22465        12785          200      33670\n10 Non-Official & N… Arabic          419890       223535         5585     629055\n# ℹ 204 more rows\n```", "```py\ncan_lang |>\n slice_max(mother_tongue, n = 10) |>\n select(language, mother_tongue)\n```", "```py\n# A tibble: 10 × 2\n   language                     mother_tongue\n   <chr>                                <dbl>\n 1 English                           19460850\n 2 French                             7166700\n 3 Mandarin                            592040\n 4 Cantonese                           565270\n 5 Punjabi (Panjabi)                   501680\n 6 Spanish                             458850\n 7 Tagalog (Pilipino, Filipino)        431385\n 8 Arabic                              419890\n 9 German                              384040\n10 Italian                             375635\n```", "```py\nregion_lang |>\n left_join(region_data, by = \"region\") |>\n slice_max(c(population)) |>\n slice_max(mother_tongue, n = 5) |>\n select(region, language, mother_tongue, population) |>\n mutate(prop = mother_tongue / population)\n```", "```py\n# A tibble: 5 × 5\n  region  language          mother_tongue population   prop\n  <chr>   <chr>                     <dbl>      <dbl>  <dbl>\n1 Toronto English                 3061820    5928040 0.516 \n2 Toronto Cantonese                247710    5928040 0.0418\n3 Toronto Mandarin                 227085    5928040 0.0383\n4 Toronto Punjabi (Panjabi)        171225    5928040 0.0289\n5 Toronto Italian                  151415    5928040 0.0255\n```", "```py\nregion_lang |>\n left_join(region_data, by = \"region\") |>\n slice_min(c(population)) |>\n slice_max(mother_tongue, n = 5) |>\n select(region, language, mother_tongue, population) |>\n mutate(prop = mother_tongue / population)\n```", "```py\n# A tibble: 5 × 5\n  region     language mother_tongue population    prop\n  <chr>      <chr>            <dbl>      <dbl>   <dbl>\n1 Belleville English          93655     103472 0.905  \n2 Belleville French            2675     103472 0.0259 \n3 Belleville German             635     103472 0.00614\n4 Belleville Dutch              600     103472 0.00580\n5 Belleville Spanish            350     103472 0.00338\n```", "```py\nset_api_key(\"ADD_YOUR_API_KEY_HERE\", install = TRUE)\n\nontario_population <-\n get_census(\n dataset = \"CA16\",\n level = \"Regions\",\n vectors = \"v_CA16_1\",\n regions = list(PR = c(\"35\"))\n )\n\nontario_population\n```", "```py\n# A tibble: 1 × 9\n  GeoUID Type  `Region Name` `Area (sq km)` Population Dwellings Households\n  <chr>  <fct> <fct>                  <dbl>      <dbl>     <dbl>      <dbl>\n1 35     PR    Ontario              986722\\.   13448494   5598391    5169174\n# ℹ 2 more variables: C_UID <chr>, `v_CA16_1: Age Stats` <dbl>\n```", "```py\ncensus_api_key(\"ADD_YOUR_API_KEY_HERE\")\n\nus_ave_household_size_2010 <-\n get_decennial(\n geography = \"state\",\n variables = c(\"H012001\", \"H012002\", \"H012003\"),\n year = 2010\n )\n\nus_ave_household_size_2010 |>\n filter(NAME %in% c(\"District of Columbia\", \"Utah\", \"Massachusetts\")) |>\n ggplot(aes(y = NAME, x = value, color = variable)) +\n geom_point() +\n theme_minimal() +\n labs(\n x = \"Average household size\", y = \"State\", color = \"Household type\"\n ) +\n scale_color_brewer(\n palette = \"Set1\", labels = c(\"Total\", \"Owner occupied\", \"Renter occupied\")\n )\n```", "```py\n@misc{ipumsusa,\n  author       = {Ruggles,  Steven and Flood,  Sarah and Foster,  Sophia and Goeken,  Ronald and Pacas,  Jose and Schouweiler,  Megan and Sobek,  Matthew},\n  year         = 2021,\n  title        = {IPUMS USA: Version 11.0},\n  publisher    = {Minneapolis,  MN: IPUMS},\n  doi          = {10.18128/d010.v11.0},\n  url          = {https://usa.ipums.org},\n  language     = {en},\n}\n```", "```py\nipums_extract <- read_dta(\"usa_00015.dta\")\n\nipums_extract <- \n ipums_extract |>\n select(stateicp, sex, age, educd) |>\n to_factor()\n\nipums_extract\n```", "```py\n# A tibble: 500,221 × 4\n   stateicp sex    age   educd                                       \n * <fct>    <fct>  <fct> <fct>                                       \n 1 alabama  male   77    grade 9                                     \n 2 alabama  male   62    1 or more years of college credit, no degree\n 3 alabama  male   25    ged or alternative credential               \n 4 alabama  female 20    1 or more years of college credit, no degree\n 5 alabama  male   37    1 or more years of college credit, no degree\n 6 alabama  female 19    regular high school diploma                 \n 7 alabama  female 67    regular high school diploma                 \n 8 alabama  female 20    1 or more years of college credit, no degree\n 9 alabama  male   66    grade 8                                     \n10 alabama  male   58    regular high school diploma                 \n# ℹ 500,211 more rows\n```", "```py\ncleaned_ipums <-\n ipums_extract |>\n mutate(age = as.numeric(age)) |>\n filter(age >= 18) |>\n rename(gender = sex) |>\n mutate(\n age_group = case_when(\n age <= 29 ~ \"18-29\",\n age <= 44 ~ \"30-44\",\n age <= 59 ~ \"45-59\",\n age >= 60 ~ \"60+\",\n TRUE ~ \"Trouble\"\n ),\n education_level = case_when(\n educd %in% c(\n \"nursery school, preschool\", \"kindergarten\", \"grade 1\",\n \"grade 2\", \"grade 3\", \"grade 4\", \"grade 5\", \"grade 6\",\n \"grade 7\", \"grade 8\", \"grade 9\", \"grade 10\", \"grade 11\",\n \"12th grade, no diploma\", \"regular high school diploma\",\n \"ged or alternative credential\", \"no schooling completed\"\n ) ~ \"High school or less\",\n educd %in% c(\n \"some college, but less than 1 year\",\n \"1 or more years of college credit, no degree\"\n ) ~ \"Some post sec\",\n educd  %in% c(\"associate's degree, type not specified\",\n \"bachelor's degree\") ~ \"Post sec +\",\n educd %in% c(\n \"master's degree\",\n \"professional degree beyond a bachelor's degree\",\n \"doctoral degree\"\n ) ~ \"Grad degree\",\n TRUE ~ \"Trouble\"\n )\n ) |>\n select(gender, age_group, education_level, stateicp) |>\n mutate(across(c(\n gender, stateicp, education_level, age_group),\n as_factor)) |>\n mutate(age_group =\n factor(age_group, levels = c(\"18-29\", \"30-44\", \"45-59\", \"60+\")))\n\ncleaned_ipums\n```", "```py\n# A tibble: 407,354 × 4\n   gender age_group education_level     stateicp\n   <fct>  <fct>     <fct>               <fct>   \n 1 male   60+       High school or less alabama \n 2 male   60+       Some post sec       alabama \n 3 male   18-29     High school or less alabama \n 4 female 18-29     Some post sec       alabama \n 5 male   30-44     Some post sec       alabama \n 6 female 18-29     High school or less alabama \n 7 female 60+       High school or less alabama \n 8 female 18-29     Some post sec       alabama \n 9 male   60+       High school or less alabama \n10 male   45-59     High school or less alabama \n# ℹ 407,344 more rows\n```", "```py\nwrite_csv(x = cleaned_ipums,\n file = \"cleaned_ipums.csv\")\n```", "```py\ncleaned_ipums |>\n ggplot(mapping = aes(x = age_group, fill = gender)) +\n geom_bar(position = \"dodge2\") +\n theme_minimal() +\n labs(\n x = \"Age-group of respondent\",\n y = \"Number of respondents\",\n fill = \"Education\"\n ) +\n facet_wrap(vars(education_level)) +\n guides(x = guide_axis(angle = 90)) +\n theme(legend.position = \"bottom\") +\n scale_fill_brewer(palette = \"Set1\")\n```", "```py\nset.seed(853)\n\nillustrative_sampling <- tibble(\n unit = 1:100,\n simple_random_sampling =\n sample(x = c(\"In\", \"Out\"), \n size = 100, \n replace = TRUE, \n prob = c(0.2, 0.8))\n )\n\nillustrative_sampling |>\n count(simple_random_sampling)\n```", "```py\n# A tibble: 2 × 2\n  simple_random_sampling     n\n  <chr>                  <int>\n1 In                        14\n2 Out                       86\n```", "```py\nset.seed(853)\n\nstarting_point <- sample(x = c(1:5), size = 1)\n\nillustrative_sampling <-\n illustrative_sampling |>\n mutate(\n systematic_sampling =\n if_else(unit %in% seq.int(from = starting_point, to = 100, by = 5), \n \"In\", \n \"Out\"\n )\n )\n\nillustrative_sampling |>\n count(systematic_sampling)\n```", "```py\n# A tibble: 2 × 2\n  systematic_sampling     n\n  <chr>               <int>\n1 In                     20\n2 Out                    80\n```", "```py\nset.seed(853)\n\npicked_in_strata <-\n illustrative_sampling |>\n mutate(strata = (unit - 1) %/% 10) |>\n slice_sample(n = 2, by = strata) |>\n pull(unit)\n\nillustrative_sampling <-\n illustrative_sampling |>\n mutate(stratified_sampling = \n if_else(unit %in% picked_in_strata, \"In\", \"Out\"))\n\nillustrative_sampling |>\n count(stratified_sampling)\n```", "```py\n# A tibble: 2 × 2\n  stratified_sampling     n\n  <chr>               <int>\n1 In                     20\n2 Out                    80\n```", "```py\nset.seed(853)\n\npicked_clusters <-\n sample(x = c(0:9), size = 2)\n\nillustrative_sampling <-\n illustrative_sampling |>\n mutate(\n cluster = (unit - 1) %/% 10,\n cluster_sampling = if_else(cluster %in% picked_clusters, \"In\", \"Out\")\n ) |>\n select(-cluster)\n\nillustrative_sampling |>\n count(cluster_sampling)\n```", "```py\n# A tibble: 2 × 2\n  cluster_sampling     n\n  <chr>            <int>\n1 In                  20\n2 Out                 80\n```", "```py\nnew_labels <- c(\n simple_random_sampling = \"Simple random sampling\",\n systematic_sampling = \"Systematic sampling\",\n stratified_sampling = \"Stratified sampling\",\n cluster_sampling = \"Cluster sampling\"\n)\n\nillustrative_sampling_long <-\n illustrative_sampling |>\n pivot_longer(\n cols = names(new_labels), names_to = \"sampling_method\",\n values_to = \"in_sample\"\n ) |>\n mutate(sampling_method = \n factor(sampling_method,levels = names(new_labels)))\n\nillustrative_sampling_long |>\n filter(in_sample == \"In\") |>\n ggplot(aes(x = unit, y = in_sample)) +\n geom_point() +\n facet_wrap(vars(sampling_method), dir = \"v\", ncol = 1, \n labeller = labeller(sampling_method = new_labels)\n ) +\n theme_minimal() +\n labs(x = \"Unit\", y = \"Is included in sample\") +\n theme(axis.text.y = element_blank())\n```", "```py\nset.seed(853)\n\nsleep <-\n tibble(\n toddler_sleep = sample(x = c(2:14), size = 30, replace = TRUE),\n difference = sample(x = c(0:3), size = 30, replace = TRUE),\n parent_sleep = toddler_sleep - difference\n ) |>\n select(toddler_sleep, parent_sleep, difference)\n\nsleep\n```", "```py\n# A tibble: 30 × 3\n   toddler_sleep parent_sleep difference\n           <int>        <int>      <int>\n 1            10            9          1\n 2            11           11          0\n 3            14           12          2\n 4             2            0          2\n 5             6            5          1\n 6            14           12          2\n 7             3            3          0\n 8             5            3          2\n 9             4            1          3\n10             4            3          1\n# ℹ 20 more rows\n```"]