- en: Mass-Spring Potential Energy
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec4.3-mass_spring_energy.html](https://phys-sim-book.github.io/lec4.3-mass_spring_energy.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: 'In this case study, we focus exclusively on incorporating the mass-spring elasticity
    potential into our system. The concept of mass-spring elasticity is akin to treating
    each edge of the mesh as if it were a spring. This approach is inspired by Hooke''s
    Law, allowing us to formulate the potential energy on edge e as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Pe​(x)=l221​k(l2∥x1​−x2​∥2​−1)2,(4.3.1)
  prefs: []
  type: TYPE_NORMAL
- en: Here, x1​ and x2​ represent the current positions of the two endpoints of the
    edge. The variable l denotes the original length of the edge, and k is a parameter
    controlling the spring's stiffness. Notably, when the distance between the two
    endpoints ∥x1​−x2​∥ equals the original length l, the potential energy Pe​(x)
    attains its global minimum value of 0, indicating no force is exerted.
  prefs: []
  type: TYPE_NORMAL
- en: An important aspect of this formulation is the inclusion of l2 at the beginning.
    This is analogous to integrating the spring energy across the solid and choosing
    edges as quadrature points. This integration helps maintain a consistent relationship
    between the stiffness behavior and the parameter k, regardless of mesh resolution
    variations.
  prefs: []
  type: TYPE_NORMAL
- en: 'Another deviation from standard spring energy formulations is our avoidance
    of the square root operation. We directly use ∥x1​−x2​∥2, making our model polynomial
    in nature. This simplification yields more streamlined expressions for the gradient
    and Hessian:'
  prefs: []
  type: TYPE_NORMAL
- en: ∂x1​∂Pe​​(x)=−∂x2​∂Pe​​(x)=2k(l2∥x1​−x2​∥2​−1)(x1​−x2​),
  prefs: []
  type: TYPE_NORMAL
- en: ∂x12​∂2Pe​​(x)​=∂x22​∂2Pe​​(x)=−∂x1​x2​∂2Pe​​(x)=−∂x2​x1​∂2Pe​​(x)=l24k​(x1​−x2​)(x1​−x2​)T+2k(l2∥x1​−x2​∥2​−1)I=l22k​(2(x1​−x2​)(x1​−x2​)T+(∥x1​−x2​∥2−l2)I).​
  prefs: []
  type: TYPE_NORMAL
- en: 'The total potential energy of the system, denoted as P(x), can be derived by
    summing the potential energy across all edges. This is calculated using Equation
    [(4.3.1)](#eq:lec4:mass_sprint_E). Thus, the total potential energy is expressed
    as: P(x)=e∑​Pe​(x) where the summation is taken over all edges in the mesh.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 4.3.1 (MassSpringEnergy.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'In dealing with the Hessian matrix of the mass-spring energy, a key consideration
    is its non-symmetric positive definite (SPD) nature. To address this, a specific
    modification is employed: we neutralize the negative eigenvalues of the local
    Hessian corresponding to each edge. This is done prior to incorporating these
    local Hessians into the global matrix. The process involves setting negative eigenvalues
    to zero, thus ensuring that the resulting global Hessian matrix adheres more closely
    to the desired SPD properties. This modification is crucial for Newton''s method.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 4.3.2 (Positive Semi-Definite Projection).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
