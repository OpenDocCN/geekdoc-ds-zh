["```py\ndata BinT:\n  | leaf\n  | node(v, l :: ( -> BinT), r :: ( -> BinT))\nend\n```", "```py\nrec tr = node(\"rec\", lam(): tr end, lam(): tr end)\nt0 = node(0, lam(): leaf end, lam(): leaf end)\nt1 = node(1, lam(): t0 end, lam(): t0 end)\nt2 = node(2, lam(): t1 end, lam(): t1 end)\n```", "```py\nfun sizeinf(t :: BinT) -> Number:\n  cases (BinT) t:\n    | leaf => 0\n    | node(v, l, r) =>\n      ls = sizeinf(l())\n      rs = sizeinf(r())\n      1 + ls + rs\n  end\nend\n```", "```py\ncheck:\n  size(tr) is 1\n  size(t0) is 1\n  size(t1) is 2\n  size(t2) is 3\nend\n```", "```py\nfun sizect(t :: BinT) -> Number:\n  fun szacc(shadow t :: BinT, seen :: List<BinT>) -> Number:\n    if has-id(seen, t):\n      0\n    else:\n      cases (BinT) t:\n        | leaf => 0\n        | node(v, l, r) =>\n          ns = link(t, seen)\n          ls = szacc(l(), ns)\n          rs = szacc(r(), ns)\n          1 + ls + rs\n      end\n    end\n  end\n  szacc(t, empty)\nend\n```", "```py\nfun has-id<A>(seen :: List<A>, t :: A):\n  cases (List) seen:\n    | empty => false\n    | link(f, r) =>\n      if f <=> t: true\n      else: has-id(r, t)\n      end\n  end\nend\n```", "```py\nls = szacc(l(), ns)\nrs = szacc(r(), ns) \n```", "```py\nfun size(t :: BinT) -> Number:\n  fun szacc(shadow t :: BinT, seen :: List<BinT>)\n    -> {n :: Number, s :: List<BinT>}:\n    if has-id(seen, t):\n      {n: 0, s: seen}\n    else:\n      cases (BinT) t:\n        | leaf => {n: 0, s: seen}\n        | node(v, l, r) =>\n          ns = link(t, seen)\n          ls = szacc(l(), ns)\n          rs = szacc(r(), ls.s)\n          {n: 1 + ls.n + rs.n, s: rs.s}\n      end\n    end\n  end\n  szacc(t, empty).n\nend\n```", "```py\ntype Key = String\n\ndata KeyedNode:\n  | keyed-node(key :: Key, content, adj :: List<Key>)\nend\n\ntype KNGraph = List<KeyedNode>\n\ntype Node = KeyedNode\ntype Graph = KNGraph\n```", "```py\nkn-cities :: Graph = block:\n  knWAS = keyed-node(\"was\", \"Washington\", [list: \"chi\", \"den\", \"saf\", \"hou\", \"pvd\"])\n  knORD = keyed-node(\"chi\", \"Chicago\", [list: \"was\", \"saf\", \"pvd\"])\n  knBLM = keyed-node(\"bmg\", \"Bloomington\", [list: ])\n  knHOU = keyed-node(\"hou\", \"Houston\", [list: \"was\", \"saf\"])\n  knDEN = keyed-node(\"den\", \"Denver\", [list: \"was\", \"saf\"])\n  knSFO = keyed-node(\"saf\", \"San Francisco\", [list: \"was\", \"den\", \"chi\", \"hou\"])\n  knPVD = keyed-node(\"pvd\", \"Providence\", [list: \"was\", \"chi\"])\n  [list: knWAS, knORD, knBLM, knHOU, knDEN, knSFO, knPVD]\nend\n```", "```py\nfun find-kn(key :: Key, graph :: Graph) -> Node:\n  matches = for filter(n from graph):\n    n.key == key\n  end\n  matches.first # there had better be exactly one!\nend\n```", "```py\nfun kn-neighbors(city :: Key,  graph :: Graph) -> List<Key>:\n  city-node = find-kn(city, graph)\n  city-node.adj\nend\n```", "```py\ncheck:\n  ns = kn-neighbors(\"hou\", kn-cities)\n\n  ns is [list: \"was\", \"saf\"]\n\n  map(_.content, map(find-kn(_, kn-cities), ns)) is\n    [list: \"Washington\", \"San Francisco\"]\nend\n```", "```py\ndata IndexedNode:\n  | idxed-node(content, adj :: List<Number>)\nend\n\ntype IXGraph = List<IndexedNode>\n\ntype Node = IndexedNode\ntype Graph = IXGraph\n```", "```py\nix-cities :: Graph = block:\n  inWAS = idxed-node(\"Washington\", [list: 1, 4, 5, 3, 6])\n  inORD = idxed-node(\"Chicago\", [list: 0, 5, 6])\n  inBLM = idxed-node(\"Bloomington\", [list: ])\n  inHOU = idxed-node(\"Houston\", [list: 0, 5])\n  inDEN = idxed-node(\"Denver\", [list: 0, 5])\n  inSFO = idxed-node(\"San Francisco\", [list: 0, 4, 3])\n  inPVD = idxed-node(\"Providence\", [list: 0, 1])\n  [list: inWAS, inORD, inBLM, inHOU, inDEN, inSFO, inPVD]\nend\n```", "```py\nfun find-ix(idx :: Key, graph :: Graph) -> Node:\n  lists.get(graph, idx)\nend\n```", "```py\nfun ix-neighbors(city :: Key,  graph :: Graph) -> List<Key>:\n  city-node = find-ix(city, graph)\n  city-node.adj\nend\n```", "```py\ncheck:\n  ns = ix-neighbors(3, ix-cities)\n\n  ns is [list: 0, 5]\n\n  map(_.content, map(find-ix(_, ix-cities), ns)) is\n    [list: \"Washington\", \"San Francisco\"]\nend\n```", "```py\ndata Edge:\n  | edge(src :: String, dst :: String)\nend\n\ntype LEGraph = List<Edge>\n\ntype Graph = LEGraph\n```", "```py\nle-cities :: Graph =\n  [list:\n    edge(\"Washington\", \"Chicago\"),\n    edge(\"Washington\", \"Denver\"),\n    edge(\"Washington\", \"San Francisco\"),\n    edge(\"Washington\", \"Houston\"),\n    edge(\"Washington\", \"Providence\"),\n    edge(\"Chicago\", \"Washington\"),\n    edge(\"Chicago\", \"San Francisco\"),\n    edge(\"Chicago\", \"Providence\"),\n    edge(\"Houston\", \"Washington\"),\n    edge(\"Houston\", \"San Francisco\"),\n    edge(\"Denver\", \"Washington\"),\n    edge(\"Denver\", \"San Francisco\"),\n    edge(\"San Francisco\", \"Washington\"),\n    edge(\"San Francisco\", \"Denver\"),\n    edge(\"San Francisco\", \"Houston\"),\n    edge(\"Providence\", \"Washington\"),\n    edge(\"Providence\", \"Chicago\") ]\n```", "```py\nfun le-neighbors(city :: Key, graph :: Graph) -> List<Key>:\n  neighboring-edges = for filter(e from graph):\n    city == e.src\n  end\n  names = for map(e from neighboring-edges): e.dst end\n  names\nend\n```", "```py\ncheck:\n  le-neighbors(\"Houston\", le-cities) is\n    [list: \"Washington\", \"San Francisco\"]\nend\n```", "```py\ndata BinT:\n  | leaf\n  | node(v, l :: ( -> BinT), r :: ( -> BinT))\nend\n```", "```py\nrec tr = node(\"rec\", lam(): tr end, lam(): tr end)\nt0 = node(0, lam(): leaf end, lam(): leaf end)\nt1 = node(1, lam(): t0 end, lam(): t0 end)\nt2 = node(2, lam(): t1 end, lam(): t1 end)\n```", "```py\nfun sizeinf(t :: BinT) -> Number:\n  cases (BinT) t:\n    | leaf => 0\n    | node(v, l, r) =>\n      ls = sizeinf(l())\n      rs = sizeinf(r())\n      1 + ls + rs\n  end\nend\n```", "```py\ncheck:\n  size(tr) is 1\n  size(t0) is 1\n  size(t1) is 2\n  size(t2) is 3\nend\n```", "```py\nfun sizect(t :: BinT) -> Number:\n  fun szacc(shadow t :: BinT, seen :: List<BinT>) -> Number:\n    if has-id(seen, t):\n      0\n    else:\n      cases (BinT) t:\n        | leaf => 0\n        | node(v, l, r) =>\n          ns = link(t, seen)\n          ls = szacc(l(), ns)\n          rs = szacc(r(), ns)\n          1 + ls + rs\n      end\n    end\n  end\n  szacc(t, empty)\nend\n```", "```py\nfun has-id<A>(seen :: List<A>, t :: A):\n  cases (List) seen:\n    | empty => false\n    | link(f, r) =>\n      if f <=> t: true\n      else: has-id(r, t)\n      end\n  end\nend\n```", "```py\nls = szacc(l(), ns)\nrs = szacc(r(), ns) \n```", "```py\nfun size(t :: BinT) -> Number:\n  fun szacc(shadow t :: BinT, seen :: List<BinT>)\n    -> {n :: Number, s :: List<BinT>}:\n    if has-id(seen, t):\n      {n: 0, s: seen}\n    else:\n      cases (BinT) t:\n        | leaf => {n: 0, s: seen}\n        | node(v, l, r) =>\n          ns = link(t, seen)\n          ls = szacc(l(), ns)\n          rs = szacc(r(), ls.s)\n          {n: 1 + ls.n + rs.n, s: rs.s}\n      end\n    end\n  end\n  szacc(t, empty).n\nend\n```", "```py\ntype Key = String\n\ndata KeyedNode:\n  | keyed-node(key :: Key, content, adj :: List<Key>)\nend\n\ntype KNGraph = List<KeyedNode>\n\ntype Node = KeyedNode\ntype Graph = KNGraph\n```", "```py\nkn-cities :: Graph = block:\n  knWAS = keyed-node(\"was\", \"Washington\", [list: \"chi\", \"den\", \"saf\", \"hou\", \"pvd\"])\n  knORD = keyed-node(\"chi\", \"Chicago\", [list: \"was\", \"saf\", \"pvd\"])\n  knBLM = keyed-node(\"bmg\", \"Bloomington\", [list: ])\n  knHOU = keyed-node(\"hou\", \"Houston\", [list: \"was\", \"saf\"])\n  knDEN = keyed-node(\"den\", \"Denver\", [list: \"was\", \"saf\"])\n  knSFO = keyed-node(\"saf\", \"San Francisco\", [list: \"was\", \"den\", \"chi\", \"hou\"])\n  knPVD = keyed-node(\"pvd\", \"Providence\", [list: \"was\", \"chi\"])\n  [list: knWAS, knORD, knBLM, knHOU, knDEN, knSFO, knPVD]\nend\n```", "```py\nfun find-kn(key :: Key, graph :: Graph) -> Node:\n  matches = for filter(n from graph):\n    n.key == key\n  end\n  matches.first # there had better be exactly one!\nend\n```", "```py\nfun kn-neighbors(city :: Key,  graph :: Graph) -> List<Key>:\n  city-node = find-kn(city, graph)\n  city-node.adj\nend\n```", "```py\ncheck:\n  ns = kn-neighbors(\"hou\", kn-cities)\n\n  ns is [list: \"was\", \"saf\"]\n\n  map(_.content, map(find-kn(_, kn-cities), ns)) is\n    [list: \"Washington\", \"San Francisco\"]\nend\n```", "```py\ndata IndexedNode:\n  | idxed-node(content, adj :: List<Number>)\nend\n\ntype IXGraph = List<IndexedNode>\n\ntype Node = IndexedNode\ntype Graph = IXGraph\n```", "```py\nix-cities :: Graph = block:\n  inWAS = idxed-node(\"Washington\", [list: 1, 4, 5, 3, 6])\n  inORD = idxed-node(\"Chicago\", [list: 0, 5, 6])\n  inBLM = idxed-node(\"Bloomington\", [list: ])\n  inHOU = idxed-node(\"Houston\", [list: 0, 5])\n  inDEN = idxed-node(\"Denver\", [list: 0, 5])\n  inSFO = idxed-node(\"San Francisco\", [list: 0, 4, 3])\n  inPVD = idxed-node(\"Providence\", [list: 0, 1])\n  [list: inWAS, inORD, inBLM, inHOU, inDEN, inSFO, inPVD]\nend\n```", "```py\nfun find-ix(idx :: Key, graph :: Graph) -> Node:\n  lists.get(graph, idx)\nend\n```", "```py\nfun ix-neighbors(city :: Key,  graph :: Graph) -> List<Key>:\n  city-node = find-ix(city, graph)\n  city-node.adj\nend\n```", "```py\ncheck:\n  ns = ix-neighbors(3, ix-cities)\n\n  ns is [list: 0, 5]\n\n  map(_.content, map(find-ix(_, ix-cities), ns)) is\n    [list: \"Washington\", \"San Francisco\"]\nend\n```", "```py\ndata Edge:\n  | edge(src :: String, dst :: String)\nend\n\ntype LEGraph = List<Edge>\n\ntype Graph = LEGraph\n```", "```py\nle-cities :: Graph =\n  [list:\n    edge(\"Washington\", \"Chicago\"),\n    edge(\"Washington\", \"Denver\"),\n    edge(\"Washington\", \"San Francisco\"),\n    edge(\"Washington\", \"Houston\"),\n    edge(\"Washington\", \"Providence\"),\n    edge(\"Chicago\", \"Washington\"),\n    edge(\"Chicago\", \"San Francisco\"),\n    edge(\"Chicago\", \"Providence\"),\n    edge(\"Houston\", \"Washington\"),\n    edge(\"Houston\", \"San Francisco\"),\n    edge(\"Denver\", \"Washington\"),\n    edge(\"Denver\", \"San Francisco\"),\n    edge(\"San Francisco\", \"Washington\"),\n    edge(\"San Francisco\", \"Denver\"),\n    edge(\"San Francisco\", \"Houston\"),\n    edge(\"Providence\", \"Washington\"),\n    edge(\"Providence\", \"Chicago\") ]\n```", "```py\nfun le-neighbors(city :: Key, graph :: Graph) -> List<Key>:\n  neighboring-edges = for filter(e from graph):\n    city == e.src\n  end\n  names = for map(e from neighboring-edges): e.dst end\n  names\nend\n```", "```py\ncheck:\n  le-neighbors(\"Houston\", le-cities) is\n    [list: \"Washington\", \"San Francisco\"]\nend\n```", "```py\ntype Key = String\n\ndata KeyedNode:\n  | keyed-node(key :: Key, content, adj :: List<Key>)\nend\n\ntype KNGraph = List<KeyedNode>\n\ntype Node = KeyedNode\ntype Graph = KNGraph\n```", "```py\nkn-cities :: Graph = block:\n  knWAS = keyed-node(\"was\", \"Washington\", [list: \"chi\", \"den\", \"saf\", \"hou\", \"pvd\"])\n  knORD = keyed-node(\"chi\", \"Chicago\", [list: \"was\", \"saf\", \"pvd\"])\n  knBLM = keyed-node(\"bmg\", \"Bloomington\", [list: ])\n  knHOU = keyed-node(\"hou\", \"Houston\", [list: \"was\", \"saf\"])\n  knDEN = keyed-node(\"den\", \"Denver\", [list: \"was\", \"saf\"])\n  knSFO = keyed-node(\"saf\", \"San Francisco\", [list: \"was\", \"den\", \"chi\", \"hou\"])\n  knPVD = keyed-node(\"pvd\", \"Providence\", [list: \"was\", \"chi\"])\n  [list: knWAS, knORD, knBLM, knHOU, knDEN, knSFO, knPVD]\nend\n```", "```py\nfun find-kn(key :: Key, graph :: Graph) -> Node:\n  matches = for filter(n from graph):\n    n.key == key\n  end\n  matches.first # there had better be exactly one!\nend\n```", "```py\nfun kn-neighbors(city :: Key,  graph :: Graph) -> List<Key>:\n  city-node = find-kn(city, graph)\n  city-node.adj\nend\n```", "```py\ncheck:\n  ns = kn-neighbors(\"hou\", kn-cities)\n\n  ns is [list: \"was\", \"saf\"]\n\n  map(_.content, map(find-kn(_, kn-cities), ns)) is\n    [list: \"Washington\", \"San Francisco\"]\nend\n```", "```py\ndata IndexedNode:\n  | idxed-node(content, adj :: List<Number>)\nend\n\ntype IXGraph = List<IndexedNode>\n\ntype Node = IndexedNode\ntype Graph = IXGraph\n```", "```py\nix-cities :: Graph = block:\n  inWAS = idxed-node(\"Washington\", [list: 1, 4, 5, 3, 6])\n  inORD = idxed-node(\"Chicago\", [list: 0, 5, 6])\n  inBLM = idxed-node(\"Bloomington\", [list: ])\n  inHOU = idxed-node(\"Houston\", [list: 0, 5])\n  inDEN = idxed-node(\"Denver\", [list: 0, 5])\n  inSFO = idxed-node(\"San Francisco\", [list: 0, 4, 3])\n  inPVD = idxed-node(\"Providence\", [list: 0, 1])\n  [list: inWAS, inORD, inBLM, inHOU, inDEN, inSFO, inPVD]\nend\n```", "```py\nfun find-ix(idx :: Key, graph :: Graph) -> Node:\n  lists.get(graph, idx)\nend\n```", "```py\nfun ix-neighbors(city :: Key,  graph :: Graph) -> List<Key>:\n  city-node = find-ix(city, graph)\n  city-node.adj\nend\n```", "```py\ncheck:\n  ns = ix-neighbors(3, ix-cities)\n\n  ns is [list: 0, 5]\n\n  map(_.content, map(find-ix(_, ix-cities), ns)) is\n    [list: \"Washington\", \"San Francisco\"]\nend\n```", "```py\ndata Edge:\n  | edge(src :: String, dst :: String)\nend\n\ntype LEGraph = List<Edge>\n\ntype Graph = LEGraph\n```", "```py\nle-cities :: Graph =\n  [list:\n    edge(\"Washington\", \"Chicago\"),\n    edge(\"Washington\", \"Denver\"),\n    edge(\"Washington\", \"San Francisco\"),\n    edge(\"Washington\", \"Houston\"),\n    edge(\"Washington\", \"Providence\"),\n    edge(\"Chicago\", \"Washington\"),\n    edge(\"Chicago\", \"San Francisco\"),\n    edge(\"Chicago\", \"Providence\"),\n    edge(\"Houston\", \"Washington\"),\n    edge(\"Houston\", \"San Francisco\"),\n    edge(\"Denver\", \"Washington\"),\n    edge(\"Denver\", \"San Francisco\"),\n    edge(\"San Francisco\", \"Washington\"),\n    edge(\"San Francisco\", \"Denver\"),\n    edge(\"San Francisco\", \"Houston\"),\n    edge(\"Providence\", \"Washington\"),\n    edge(\"Providence\", \"Chicago\") ]\n```", "```py\nfun le-neighbors(city :: Key, graph :: Graph) -> List<Key>:\n  neighboring-edges = for filter(e from graph):\n    city == e.src\n  end\n  names = for map(e from neighboring-edges): e.dst end\n  names\nend\n```", "```py\ncheck:\n  le-neighbors(\"Houston\", le-cities) is\n    [list: \"Washington\", \"San Francisco\"]\nend\n```"]