- en: Line Search
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 线搜索
- en: 原文：[https://phys-sim-book.github.io/lec3.2-line_search.html](https://phys-sim-book.github.io/lec3.2-line_search.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec3.2-line_search.html](https://phys-sim-book.github.io/lec3.2-line_search.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: In iterative minimization methods, line search is a technique used to select
    a fraction of the step in each iteration, ensuring the objective energy decreases
    at the new point.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在迭代最小化方法中，线搜索是一种技术，用于在每次迭代中选择步长的一部分，确保目标能量在新点处减少。
- en: 'Specifically, for Newton''s method, line 4 in [Algorithm 1.5.1](lec1.5-implicit_time_integration.html#alg:lec1:newton_method_IE)
    is modified from \(x^i \leftarrow x\) to \(x^i \leftarrow x^i + \alpha (x - x^i)\),
    where \(\alpha \in (0,1]\) is the step size, essential for the reduction of energy.
    This leads to two critical questions: Does such an \(\alpha\) always exist? And
    how is \(\alpha\) calculated?'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '**具体来说，对于牛顿法，算法 1.5.1 中的第 4 行从 \(x^i \leftarrow x\) 修改为 \(x^i \leftarrow x^i
    + \alpha (x - x^i)\)，其中 \(\alpha \in (0,1]\) 是步长，对于减少能量是必不可少的。这导致两个关键问题：这样的 \(\alpha\)
    是否总是存在？\(\alpha\) 是如何计算的？**'
- en: '***Remark 3.2.1 (Existence of \(\alpha\)).*** For a smooth objective energy
    \(E(x)\) at \(x^i\) where \(\nabla E(x^i) \neq 0\), if a search direction \(p=x-x^i\)
    is descent, namely \(p^T \nabla E(x^i) < 0\), then there exists \(\alpha > 0\)
    such that \(E(x^i + \alpha p) < E(x^i)\).'
  id: totrans-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '***注 3.2.1（\(\alpha\) 的存在性）。*** 对于在 \(x^i\) 处的平滑目标能量 \(E(x)\)，其中 \(\nabla E(x^i)
    \neq 0\)，如果搜索方向 \(p=x-x^i\) 是下降的，即 \(p^T \nabla E(x^i) < 0\)，则存在 \(\alpha > 0\)
    使得 \(E(x^i + \alpha p) < E(x^i)\)。'
- en: '****Method 3.2.1 (Backtracking Line Search).**** Given a descent direction,
    we can find a reasonably large \(\alpha\) by simply halving it starting from \(1\)
    until the energy at the new location is smaller than the current (see [Algorithm
    3.2.1](#alg:lec3:line_search)).'
  id: totrans-6
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '****方法 3.2.1（回溯线搜索）。**** 给定一个下降方向，我们可以通过从 1 开始简单地将其减半，直到新位置的能量小于当前能量，来找到一个合理的大的
    \(\alpha\)（参见 [算法 3.2.1](#alg:lec3:line_search)）。'
- en: ''
  id: totrans-7
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Algorithm 3.2.1 (The Backtracking Line Search Algorithm).** ![](../Images/96bdc037c056131ae782deef044fb16b.png)'
  id: totrans-8
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**算法 3.2.1（回溯线搜索算法）。** ![](../Images/96bdc037c056131ae782deef044fb16b.png)'
- en: '***Remark 3.2.2 (Other Line Search Methods).*** There are other line search
    methods that attempt to apply polynomial interpolations to find an \(\alpha\)
    such that the energy at the new location is closer to a local minimum on the line
    segment \(x^i + s p\), (\(s\in(0,1]\)). However, these methods generally incur
    higher computational costs and may not necessarily enhance the overall wall-clock
    timing of the optimization.'
  id: totrans-9
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '***注 3.2.2（其他线搜索方法）。*** 有其他线搜索方法尝试将多项式插值应用于找到 \(\alpha\)，使得新位置的能量更接近线段 \(x^i
    + s p\)（\(s\in(0,1]\)）上的局部最小值。然而，这些方法通常会产生更高的计算成本，并且不一定能提高整体优化时间的wall-clock计时。'
- en: Now, with line search, if Newton's method consistently generates a descent search
    direction, then the method is guaranteed to converge for any initial configuration
    on any smooth energy with a lower bound. We know that in iteration \(i\), \(p
    = -(\nabla^2 E(x^i))^{-1} \nabla E(x^i)\), so \(p^T \nabla E(x^i)\) equals \(-\nabla
    E(x^i)^T (\nabla^2 E(x^i))^{-T} \nabla E(x^i)\). For convex energies, \(\nabla^2
    E(x^i)\) is always Symmetric Positive Definite (SPD), and so is \((\nabla^2 E(x^i))^{-T}\),
    making \(p\) always a descent direction. However, for non-convex energies, this
    assurance does not always hold. One approach to address this issue is to approximate
    the energies locally using convex energy proxies.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，使用线搜索，如果牛顿法始终生成下降搜索方向，那么该方法对于任何初始配置和任何具有下界的平滑能量都是保证收敛的。我们知道在迭代 \(i\) 中，\(p
    = -(\nabla^2 E(x^i))^{-1} \nabla E(x^i)\)，因此 \(p^T \nabla E(x^i)\) 等于 \(-\nabla
    E(x^i)^T (\nabla^2 E(x^i))^{-T} \nabla E(x^i)\)。对于凸能量，\(\nabla^2 E(x^i)\) 总是对称正定的，\((\nabla^2
    E(x^i))^{-T}\) 也是，这使得 \(p\) 总是下降方向。然而，对于非凸能量，这种保证并不总是成立。解决此问题的一种方法是在局部使用凸能量代理来近似能量。
