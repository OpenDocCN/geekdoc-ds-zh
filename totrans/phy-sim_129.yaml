- en: Affine Body Dynamics
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 拓扑刚体动力学
- en: 原文：[https://phys-sim-book.github.io/lec25.3-affine_body_dynamics.html](https://phys-sim-book.github.io/lec25.3-affine_body_dynamics.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec25.3-affine_body_dynamics.html](https://phys-sim-book.github.io/lec25.3-affine_body_dynamics.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: Previously, we reviewed rigid body dynamics and implemented a simple solver
    using explicit integration.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 之前，我们回顾了刚体动力学，并使用显式积分实现了一个简单的求解器。
- en: 'When dealing with many rigid bodies — especially with complex geometry and
    dense contact — it’s natural to attempt IPC for contact resolution. However, representing
    a rigid body by its position x and rotation q creates a challenge: step size filtering
    in Newton’s method becomes nonlinear in α, due to the nonlinearity of quaternion
    update.'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 当处理许多刚体——特别是具有复杂几何和密集接触时——自然地会尝试IPC进行接触求解。然而，用位置 x 和旋转 q 来表示刚体会带来挑战：由于四元数更新的非线性，牛顿法中的步长滤波在
    α 上变得非线性。
- en: 'Let the state of a rigid body be denoted by y=(x,q), where x is the center
    of mass and q is a unit quaternion representing orientation. During a Newton iteration,
    let the update direction be p=(px​,pq​) with step size α, so that the updated
    state is given by y~​=y+αp. The position of a vertex initially located at xv(0)​
    is then transformed to:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 设刚体的状态为 y=(x,q)，其中 x 是质心，q 是表示方向的单位四元数。在牛顿迭代过程中，设更新方向为 p=(px​,pq​)，步长为 α，则更新后的状态为
    y~​=y+αp。初始位于 xv(0)​ 的顶点位置随后转换为：
- en: xv​=q​(xv(0)​−x(0))q​−1+x
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: xv​=q​(xv(0)​−x(0))q​−1+x
- en: 'Expanding this shows x~v​ is nonlinear in α:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 展开这个表达式，可以看出 x~v​ 在 α 上是非线性的：
- en: xv​=(q+αpq​)(xv(0)​−x(0))(q+αpq​)−1+x+αpx​ and since q​ depends nonlinearly
    on α, so does x~v​. Hence, linear CCD may fail to guarantee intersection-free
    motion.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: xv​=(q+αpq​)(xv(0)​−x(0))(q+αpq​)−1+x+αpx​，由于 q​ 非线性地依赖于 α，因此 x~v​ 也是。因此，线性CCD可能无法保证无交错的运动。
- en: We could model rigid bodies as very stiff soft bodies (e.g., mass-spring or
    hyperelastic), but this is inefficient and negates the DOF-reduction benefit.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以将刚体建模为非常刚性的软体（例如，质量-弹簧或超弹性），但这既不高效也抵消了自由度减少的好处。
- en: 'Affine Body Dynamics (ABD) [[Lan et al. 2022]](bibliography.html#lan2022affine)
    addresses this: instead of strict rigidity, we allow tiny affine deformations
    xˉ↦x=Ax+b for each vertex x of the body where xˉ denotes the rest position. The
    body state is y=(bT,a1T​,a2T​,a3T​) where A=(a1​,a2​,a3​)T, so the vertex position
    x becomes:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 拓扑刚体动力学（ABD）[[Lan et al. 2022]](bibliography.html#lan2022affine) 解决了这个问题：我们不是严格地要求刚性，而是允许每个刚体顶点
    x 有微小的仿射变形 xˉ↦x=Ax+b，其中 xˉ 表示静止位置。刚体状态为 y=(bT,a1T​,a2T​,a3T​)，其中 A=(a1​,a2​,a3​)T，因此顶点位置
    x 变为：
- en: x=Jy​
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: x=Jy​
- en: with J=(I3×3​,I3×3​⊗xˉT) where ⊗ denotes the Kronecker product.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 J=(I3×3​,I3×3​⊗xˉT)，其中 ⊗ 表示克罗内克积。
- en: This linearity makes x linearly dependent on the optimization step size α, enabling
    robust linear CCD.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 这一线性特性使得 x 线性依赖于优化步长 α，从而实现了鲁棒的线性CCD。
- en: 'Let E(x) be the augmented IPC energy. Original IPC solves: ∇x​E(x)=0​'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 设 E(x) 为扩展的IPC能量。原始IPC求解：∇x​E(x)=0​
- en: 'ABD solves in a reduced subspace:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: ABD 在一个降维子空间中求解：
- en: ∇y​E(Jy)=0​
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: ∇y​E(Jy)=0​
- en: 'Using the chain rule:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 使用链式法则：
- en: ∇y​E(Jy)Dy2​E(Jy)​=JT∇x​E(x)=JTDx2​E(x)J​(25.3.1) , we can solve Newton Optimization
    direction by solving the linear system JTDx2​E(x)J=−JT∇x​E(x).
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: ∇y​E(Jy)Dy2​E(Jy)​=JT∇x​E(x)=JTDx2​E(x)J​(25.3.1) ，我们可以通过求解线性系统 JTDx2​E(x)J=−JT∇x​E(x)
    来求解牛顿优化方向。
- en: With these, we can implement ABD using implicit Euler integration for a simple
    2D case.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 使用这些方法，我们可以通过隐式欧拉积分实现简单的二维ABD。
- en: 'Before implementation, consider this geometric view: in 2D, an affine transformation
    is determined by 3 points. Choosing a triangle per rigid body, we can interpolate
    all vertices via barycentric coordinates. The triangle drives the simulation;
    the original mesh is used for collisions. This yields a reduced DOF system where
    the triangle controls motion—essentially what ABD does.'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 在实现之前，考虑以下几何视图：在二维中，仿射变换由3个点确定。为每个刚体选择一个三角形，我们可以通过重心坐标插值所有顶点。三角形驱动模拟；原始网格用于碰撞。这产生了一个降维的自由度系统，其中三角形控制运动——这正是ABD所做的事情。
