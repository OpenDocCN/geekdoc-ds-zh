- en: Self-Contact
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec20.3-self_contact.html](https://phys-sim-book.github.io/lec20.3-self_contact.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: 'With triangle discretization, the boundary of the domain is approximated as
    a polyline formed by a set of edges. Let us denote this set of boundary edges
    as E, and the barrier potential becomes:'
  prefs: []
  type: TYPE_NORMAL
- en: ≈=​∫ΓC​​21​b(X2​∈ΓC​−N(X)min​∥x(X,t)−x(X2​,t)∥,d^)ds(X)∫ΓC​​21​b(e∈E−I(X)min​X2​∈emin​∥x(X,t)−x(X2​,t)∥,d^)ds(X)∫ΓC​​21​b(e∈E−I(X)min​dPE(x(X,t),e),d^)ds(X).​
  prefs: []
  type: TYPE_NORMAL
- en: Here, I(X) is the set of edges that contain X. Completely ignoring these edges
    is a specific choice of N(X) under the current discretization. The term minX2​∈e​∥x(X,t)−x(X2​,t)∥
    is simply the point-edge distance dPE(x(X,t),e), which can be calculated as either
    a point-point distance or a point-line distance depending on the relative positions
    of the point and the edge.
  prefs: []
  type: TYPE_NORMAL
- en: As we know, the barrier energy density function b is already a smooth approximation
    to the discontinuous normal contact forces that prevent interpenetration between
    two colliding points. However, when considering self-contact between discrete
    surfaces (piecewise linear here), the non-smooth min operator on point-edge distances
    is inevitable. This non-smoothness can still pose challenges for optimization
    time integrators.
  prefs: []
  type: TYPE_NORMAL
- en: 'To obtain a smooth barrier potential even in the case of piecewise linear boundaries,
    we first transform the min operator to a max operator, as the energy density function
    b is a non-ascending function everywhere in the domain. This gives us:'
  prefs: []
  type: TYPE_NORMAL
- en: ∫ΓC​​21​e∈E−I(X)max​b(dPE(x(X,t),e),d^)ds(X).
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, we need to smoothly approximate the max operator. A straightforward choice
    is to use the smooth max function, such as the p-norm function:'
  prefs: []
  type: TYPE_NORMAL
- en: max(a1​,a2​,...,an​)≈(a1p​+a2p​+…+anp​)p1​,
  prefs: []
  type: TYPE_NORMAL
- en: with p>0 sufficiently large. However, the exponent p1​ will couple multiple
    inputs together, increasing the stencil size and making the Hessian less sparse,
    which will make the simulation more computationally expensive.
  prefs: []
  type: TYPE_NORMAL
- en: Fortunately, due to the local support of b, where the contact force only exists
    for distances smaller than d^, using p=1 is sufficient. With a relatively small
    d^, there will only be some redundant contact forces at the interface of boundary
    elements ([Figure 20.3.1](#fig:lec20:corner)).
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/f3d49d706392ea533a897a7d202d1ac9.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 20.3.1.** In this simple two-edge illustration, the yellow and green
    regions are only counted once by the summation, but the blue region and the yellow-green
    overlap are counted twice. If we subtract once the blue region, then for the right-top
    boundary (convex), it becomes perfect, but for the left-bottom boundary (concave),
    we can still see some overlap that are counted twice.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Since the overlapping supports of b from multiple boundary elements can be
    clearly identified, it is also possible to subtract the redundant barrier potentials
    in those regions, as discussed in detail in [[Li et al. 2023]](bibliography.html#li2023convergent).
    For this book, let us keep it simple by using p=1 with the p-norm formulation,
    which is just summation:'
  prefs: []
  type: TYPE_NORMAL
- en: ​∫ΓC​​21​e∈E−I(X)max​b(dPE(x(X,t),e),d^)ds(X)≈∫ΓC​​21​e∈E−I(X)∑​b(dPE(x(X,t),e),d^)ds(X).​
  prefs: []
  type: TYPE_NORMAL
- en: 'Approximating the integral under triangle discretization and picking the end
    points of each boundary edge as the quadrature points, we obtain the fully discrete
    form:'
  prefs: []
  type: TYPE_NORMAL
- en: ≈​∫ΓC​​21​e∈E−I(X)∑​b(dPE(x(X,t),e),d^)ds(X)a^∑​4∥Xa^​−Xa^−1​∥+∥Xa^​−Xa^+1​∥​e∈E−I(Xa^​)∑​b(dPE(xa^​,e),d^).​(20.3.1)
  prefs: []
  type: TYPE_NORMAL
- en: Similar to the solid-obstacle contact cases, TC​ can be derived by taking the
    derivative of the whole contact potential with respect to the nodal degrees of
    freedom (DOFs).
  prefs: []
  type: TYPE_NORMAL
