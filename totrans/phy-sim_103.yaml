- en: Self-Contact
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 自接触
- en: 原文：[https://phys-sim-book.github.io/lec20.3-self_contact.html](https://phys-sim-book.github.io/lec20.3-self_contact.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec20.3-self_contact.html](https://phys-sim-book.github.io/lec20.3-self_contact.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '`<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">`'
- en: 'With triangle discretization, the boundary of the domain is approximated as
    a polyline formed by a set of edges. Let us denote this set of boundary edges
    as E, and the barrier potential becomes:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 使用三角形离散化，域的边界被近似为由一组边形成的折线。让我们将这个边界边的集合表示为E，势垒势能变为：
- en: ≈=​∫ΓC​​21​b(X2​∈ΓC​−N(X)min​∥x(X,t)−x(X2​,t)∥,d^)ds(X)∫ΓC​​21​b(e∈E−I(X)min​X2​∈emin​∥x(X,t)−x(X2​,t)∥,d^)ds(X)∫ΓC​​21​b(e∈E−I(X)min​dPE(x(X,t),e),d^)ds(X).​
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ≈=∫ΓC21b(X2∈ΓC−N(X)min∥x(X,t)−x(X2,t)∥,d^)ds(X)∫ΓC21b(e∈E−I(X)minX2∈emin∥x(X,t)−x(X2,t)∥,d^)ds(X)∫ΓC21b(e∈E−I(X)mindPE(x(X,t),e),d^)ds(X)。
- en: Here, I(X) is the set of edges that contain X. Completely ignoring these edges
    is a specific choice of N(X) under the current discretization. The term minX2​∈e​∥x(X,t)−x(X2​,t)∥
    is simply the point-edge distance dPE(x(X,t),e), which can be calculated as either
    a point-point distance or a point-line distance depending on the relative positions
    of the point and the edge.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，I(X)是包含X的边的集合。在当前离散化下，完全忽略这些边是N(X)的一个特定选择。术语minX2∈e∥x(X,t)−x(X2,t)∥简单地是点-边距离dPE(x(X,t),e)，这可以根据点和边的相对位置计算为点-点距离或点-线距离。
- en: As we know, the barrier energy density function b is already a smooth approximation
    to the discontinuous normal contact forces that prevent interpenetration between
    two colliding points. However, when considering self-contact between discrete
    surfaces (piecewise linear here), the non-smooth min operator on point-edge distances
    is inevitable. This non-smoothness can still pose challenges for optimization
    time integrators.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所知，势垒能量密度函数b已经是防止两个碰撞点之间相互穿透的不连续法向接触力的平滑近似。然而，当考虑离散表面（此处为分段线性）之间的自接触时，点-边距离上的非平滑min运算符是不可避免的。这种非平滑性仍然会对优化时间积分器提出挑战。
- en: 'To obtain a smooth barrier potential even in the case of piecewise linear boundaries,
    we first transform the min operator to a max operator, as the energy density function
    b is a non-ascending function everywhere in the domain. This gives us:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 为了在分段线性边界的情况下获得平滑的势垒势能，我们首先将min运算符转换为max运算符，因为能量密度函数b在整个域内都是非递增的。这给我们：
- en: ∫ΓC​​21​e∈E−I(X)max​b(dPE(x(X,t),e),d^)ds(X).
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: ∫ΓC21e∈E−I(X)maxb(dPE(x(X,t),e),d^)ds(X)。
- en: 'Next, we need to smoothly approximate the max operator. A straightforward choice
    is to use the smooth max function, such as the p-norm function:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们需要平滑地近似max运算符。一个直接的选择是使用平滑的max函数，例如p-范数函数：
- en: max(a1​,a2​,...,an​)≈(a1p​+a2p​+…+anp​)p1​,
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: max(a1,a2,...,an)≈(a1p+a2p+…+anp)p1，
- en: with p>0 sufficiently large. However, the exponent p1​ will couple multiple
    inputs together, increasing the stencil size and making the Hessian less sparse,
    which will make the simulation more computationally expensive.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 当p>0足够大时。然而，指数p1将多个输入耦合在一起，增加模板大小，使Hessian矩阵变得不那么稀疏，这将使模拟更加计算密集。
- en: Fortunately, due to the local support of b, where the contact force only exists
    for distances smaller than d^, using p=1 is sufficient. With a relatively small
    d^, there will only be some redundant contact forces at the interface of boundary
    elements ([Figure 20.3.1](#fig:lec20:corner)).
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 幸运的是，由于b在局部支持下的作用，当接触力仅存在于小于d^的距离时，使用p=1是足够的。在相对较小的d^下，边界元素界面（[图20.3.1](#fig:lec20:corner)）上只会存在一些冗余的接触力。
- en: '![](../Images/f3d49d706392ea533a897a7d202d1ac9.png)'
  id: totrans-13
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/f3d49d706392ea533a897a7d202d1ac9.png)'
- en: '**Figure 20.3.1.** In this simple two-edge illustration, the yellow and green
    regions are only counted once by the summation, but the blue region and the yellow-green
    overlap are counted twice. If we subtract once the blue region, then for the right-top
    boundary (convex), it becomes perfect, but for the left-bottom boundary (concave),
    we can still see some overlap that are counted twice.'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '**图20.3.1**。在这个简单的双边示意图中，黄色和绿色区域只被求和计算一次，但蓝色区域和黄色-绿色重叠部分被计算了两次。如果我们减去一次蓝色区域，那么对于右上边界（凸形），它就变得完美，但对于左下边界（凹形），我们仍然可以看到一些重叠部分被计算了两次。'
- en: 'Since the overlapping supports of b from multiple boundary elements can be
    clearly identified, it is also possible to subtract the redundant barrier potentials
    in those regions, as discussed in detail in [[Li et al. 2023]](bibliography.html#li2023convergent).
    For this book, let us keep it simple by using p=1 with the p-norm formulation,
    which is just summation:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 由于多个边界元素的重叠支持可以清楚地识别，因此也可以从这些区域减去冗余的势垒势，如[[Li et al. 2023]](bibliography.html#li2023convergent)中详细讨论的那样。对于这本书，我们使用p=1和p-范数公式来简化，这只是一个求和：
- en: ​∫ΓC​​21​e∈E−I(X)max​b(dPE(x(X,t),e),d^)ds(X)≈∫ΓC​​21​e∈E−I(X)∑​b(dPE(x(X,t),e),d^)ds(X).​
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: ∫ΓC21e∈E−I(X)maxb(dPE(x(X,t),e),d^)ds(X)≈∫ΓC21e∈E−I(X)∑b(dPE(x(X,t),e),d^)ds(X).
- en: 'Approximating the integral under triangle discretization and picking the end
    points of each boundary edge as the quadrature points, we obtain the fully discrete
    form:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在三角形离散化下对积分进行近似，并选取每个边界边的端点作为求积点，我们得到完全离散的形式：
- en: ≈​∫ΓC​​21​e∈E−I(X)∑​b(dPE(x(X,t),e),d^)ds(X)a^∑​4∥Xa^​−Xa^−1​∥+∥Xa^​−Xa^+1​∥​e∈E−I(Xa^​)∑​b(dPE(xa^​,e),d^).​(20.3.1)
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: ≈∫ΓC21e∈E−I(X)∑b(dPE(x(X,t),e),d^)ds(X)a^∑4∥Xa^−Xa^−1∥+∥Xa^−Xa^+1∥e∈E−I(Xa^)∑b(dPE(xa^,e),d^).(20.3.1)
- en: Similar to the solid-obstacle contact cases, TC​ can be derived by taking the
    derivative of the whole contact potential with respect to the nodal degrees of
    freedom (DOFs).
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 与固体障碍物接触情况类似，TC可以通过对整个接触势相对于节点自由度（DOFs）的导数来推导。
