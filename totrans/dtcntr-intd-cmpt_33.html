<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>11.1Â File Input and Output in PythonðŸ”—</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>11.1Â File Input and Output in PythonðŸ”—</h1>
<blockquote>åŽŸæ–‡ï¼š<a href="https://dcic-world.org/2025-08-27/python-fileio.html">https://dcic-world.org/2025-08-27/python-fileio.html</a></blockquote><table cellspacing="0" cellpadding="0"><tr><td><p>Â Â Â Â <a href="#%28part._.Basic_.File_.Operations%29" class="toclink" data-pltdoc="x">11.1.1Â Basic File Operations</a></p></td></tr><tr><td><p>Â Â Â Â <a href="#%28part._.Reading_.C.S.V_.Files_.Step_by_.Step%29" class="toclink" data-pltdoc="x">11.1.2Â Reading CSV Files Step by Step</a></p></td></tr><tr><td><p>Â Â Â Â <a href="#%28part._.Processing_and_.Filtering_.Data%29" class="toclink" data-pltdoc="x">11.1.3Â Processing and Filtering Data</a></p></td></tr><tr><td><p>Â Â Â Â <a href="#%28part._.Writing_.C.S.V_.Files%29" class="toclink" data-pltdoc="x">11.1.4Â Writing CSV Files</a></p></td></tr></table><p>In <a href="python-tables-Pandas.html" data-pltdoc="x">Introduction to Pandas</a>, we loaded data from CSV (comma-separated value) files, but we let Pandas handle the low-level details: reading files and converting their contents into DataFrames.</p><p>In this chapter, weâ€™ll learn to read and write files using Pythonâ€™s basic file operations, using a simplified CSV processor as an example.</p><p>While Pandas can certainly do all that we will do in this chapter (and more!), understanding how file operations work helps you become a more complete programmer, and to one day perhaps either create or work on libraries like Pandas.</p><section class="SsectionLevel4" id="section 11.1.1"><h4 class="heading">11.1.1Â <a name="(part._.Basic_.File_.Operations)"/>Basic File Operations<a href="#(part._.Basic_.File_.Operations)" class="heading-anchor" title="Link to here">ðŸ”—</a> </h4><p>Python provides built-in functions for working with files. Before you can do anything else with a file, you must "open" it:</p><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">file = open('data.csv', 'r')</code></pre><p>This statement opens a file named <code data-lang="text/x-python" class="sourceCode">'data.csv'</code> in read mode (<code data-lang="text/x-python" class="sourceCode">'r'</code>).
The <code data-lang="text/x-python" class="sourceCode">open</code> function returns a file object that we can use to read from or (if it were opened in the appropriate mode) write to the file.</p><blockquote class="Incercise"><p class="IncerciseHeader">Do Now!</p><blockquote class="IncerciseBody"><p>What do you think would happen if you tried to open a file that doesnâ€™t exist? Try it and see what error message you get.</p></blockquote></blockquote><p>Once we have a file object, we can read its contents in one of several ways:</p><p>Important: the file object remembers where in the file it is reading.
This is how calling <code data-lang="text/x-python" class="sourceCode">.readline()</code> twice doesnâ€™t return the same line, it returns one line,
and then the next. But, this also means that if you ran either <code data-lang="text/x-python" class="sourceCode">.read()</code> or <code data-lang="text/x-python" class="sourceCode">.readlines()</code>,
you would have read the entire file, which means the position of the file object is now at the end, which means
calling any of the other methods would return empty results â€“ empty strings for <code data-lang="text/x-python" class="sourceCode">.read()</code> or <code data-lang="text/x-python" class="sourceCode">.readline()</code>, and an
empty list for <code data-lang="text/x-python" class="sourceCode">.readlines()</code>. You can move where the file object is pointing, with <code data-lang="text/x-python" class="sourceCode">.seek()</code>, but how that
works is beyond our scope!</p><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode"># Read the entire file as one string
content = file.read()

# Or, we can read one line at a time
line = file.readline()
another_line = file.readline()

# We can also read all remaining lines into a list of strings
all_lines = file.readlines()</code></pre><p>When weâ€™re done using a file, we should always close it:</p><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">file.close()</code></pre><blockquote class="Incercise"><p class="IncerciseHeader">Do Now!</p><blockquote class="IncerciseBody"><p>Why do you think it might be important to close files when youâ€™re done with them?</p></blockquote></blockquote><p>Closing files is important because it frees up system resources and ensures that,
if we were writing to the file (unlike in this example, where we are only reading)
all pending writes actually get saved! However, manually remembering to close files
can be error-prone. Python provides a more reliable way using the <code data-lang="text/x-python" class="sourceCode">with</code>
statement:</p><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">with open('data.csv', 'r') as file:
    content = file.read()
    # file is automatically closed when this block ends</code></pre><p>In addition to not making us remember to close the files, it this approach also guarantees
that the file will be closed even if an error occurs while processing it.</p></section><section class="SsectionLevel4" id="section 11.1.2"><h4 class="heading">11.1.2Â <a name="(part._.Reading_.C.S.V_.Files_.Step_by_.Step)"/>Reading CSV Files Step by Step<a href="#(part._.Reading_.C.S.V_.Files_.Step_by_.Step)" class="heading-anchor" title="Link to here">ðŸ”—</a> </h4><p>Letâ€™s work through reading a CSV file manually, as a way to practice using files for a practical (if small) example.</p><p>Suppose we have a file called <code data-lang="text/x-python" class="sourceCode">orders.csv</code> with the following contents:
(You can create this file with your editor of choice â€“ e.g., VSCode).</p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p>dish,quantity,price,order_type</p></td></tr><tr><td><p>Pizza,2,25.0,dine-in</p></td></tr><tr><td><p>Salad,1,8.75,takeout</p></td></tr><tr><td><p>Burger,3,30.0,dine-in</p></td></tr><tr><td><p>Pizza,1,12.50,takeout</p></td></tr></table><p>Hereâ€™s how we can read and parse this file step by step:</p><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode"># Step 1: Open and read the file into variable `lines`
with open('orders.csv', 'r') as file:
    lines = file.readlines()

# Step 2: Clean data: remove newline characters and split by commas
data = []
for line in lines:
    cells = line.strip().split(',')
    data.append(cells)

# Step 3: Separate header (first row) from data rows (rest of file)
header = data[0]
rows = data[1:]

print("Header:", header)
print("First row:", rows[0])</code></pre><p>Letâ€™s break down what each step does:</p><ol><li><p><code data-lang="text/x-python" class="sourceCode">file.readlines()</code> reads all lines from the file into a list of strings</p></li><li><p>We use a for loop to go through each line, using <code data-lang="text/x-python" class="sourceCode">line.strip()</code> to remove the newline character (<code data-lang="text/x-python" class="sourceCode">'\n'</code>)
from the end of each line and then turning the line into a list of strings by <code data-lang="text/x-python" class="sourceCode">.split(',')</code>,
which divides the string by the given string (which is not included).</p></li><li><p>We separate the first row (header) from the data rows for easier processing â€“
the notation <code data-lang="text/x-python" class="sourceCode">data[1:]</code> is a special way of indicating we want "from index 1 until as far as the
list goes â€“ i.e., the end of the list.</p></li></ol><blockquote class="Incercise"><p class="IncerciseHeader">Do Now!</p><blockquote class="IncerciseBody"><p>What would our code do if one of the cells in your CSV contained a comma?
For example, what if a dish name was "Mac and cheese, deluxe"? How could you handle this?</p></blockquote></blockquote></section><section class="SsectionLevel4" id="section 11.1.3"><h4 class="heading">11.1.3Â <a name="(part._.Processing_and_.Filtering_.Data)"/>Processing and Filtering Data<a href="#(part._.Processing_and_.Filtering_.Data)" class="heading-anchor" title="Link to here">ðŸ”—</a> </h4><p>Once we have our data as a list of lists, we can process it using the same programming
techniques weâ€™ve learned, by using the <code data-lang="text/x-python" class="sourceCode">.index()</code> method to return the numeric
offset of the given string in a list of strings â€“ this is how we will find the columns
we are interested in, and then use that to index into the row.</p><p>For example, letâ€™s filter for only takeout orders:</p><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode"># Returns the index (i.e., offset, base 0) where 'order_type' exists in the header list.
order_type_index = header.index('order_type')

# Filter for takeout orders
takeout_orders = []
for row in rows:
    if row[order_type_index] == 'takeout':
        takeout_orders.append(row)

print("Found " + str(len(takeout_orders)) + " takeout orders")</code></pre><p>We can also convert data types as needed. For instance, if we want to calculate total revenue,
we need to not only find the quantity and price for each row, but convert the strings that are in
the row (since the file was all strings!) to numbers before multiplying:</p><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">quantity_index = header.index('quantity')
price_index = header.index('price')

total_revenue = 0
for row in rows:
    quantity = int(row[quantity_index])
    price = float(row[price_index])
    total_revenue += quantity * price

print("Total revenue: $" + str(total_revenue))</code></pre><blockquote class="Incercise"><p class="IncerciseHeader">Do Now!</p><blockquote class="IncerciseBody"><p>What would happen if one of the quantity cells contained invalid data, like the string "three" instead of the number 3? How could you make your code more robust to handle such errors?</p></blockquote></blockquote></section><section class="SsectionLevel4" id="section 11.1.4"><h4 class="heading">11.1.4Â <a name="(part._.Writing_.C.S.V_.Files)"/>Writing CSV Files<a href="#(part._.Writing_.C.S.V_.Files)" class="heading-anchor" title="Link to here">ðŸ”—</a> </h4><p>Writing CSV files follows a similar pattern. We need to:</p><ol><li><p>Open a file in write mode</p></li><li><p>Convert our data to the proper string format</p></li><li><p>Write the strings to the file</p></li></ol><p>Hereâ€™s how to write our filtered takeout orders to a new file:</p><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode"># Prepare data to write (header + filtered rows)
output_data = [header] + takeout_orders

# Write to file
with open('takeout_orders.csv', 'w') as file:
    for row in output_data:
        # Join the row elements with commas and add a newline
        line = ','.join(row) + '\n'
        file.write(line)</code></pre><p>The key steps here are:</p><ul><li><p><code data-lang="text/x-python" class="sourceCode">','.join(row)</code> combines the list elements into a single string with commas between them</p></li><li><p>We add <code data-lang="text/x-python" class="sourceCode">'\n'</code> to create a new line after each row</p></li><li><p><code data-lang="text/x-python" class="sourceCode">file.write()</code> writes the string to the file</p></li></ul><p>Note that we call <code data-lang="text/x-python" class="sourceCode">.write()</code> once for each line â€“ we could have combined all the lines into a single
string, and only called <code data-lang="text/x-python" class="sourceCode">.write()</code> once, but there is no need to â€“ just like how file objects remember
where we are reading from them, they remember where we were writing, so the next call to <code data-lang="text/x-python" class="sourceCode">.write()</code> will
add the next string after the previous one.</p><blockquote class="Incercise"><p class="IncerciseHeader">Do Now!</p><blockquote class="IncerciseBody"><p>Try writing a program that reads a CSV file, adds a new column with calculated values (like total price = quantity Ã— price), and writes the result to a new file.</p></blockquote></blockquote></section>&#13;
<h4 class="heading">11.1.1Â <a name="(part._.Basic_.File_.Operations)"/>Basic File Operations<a href="#(part._.Basic_.File_.Operations)" class="heading-anchor" title="Link to here">ðŸ”—</a> </h4><p>Python provides built-in functions for working with files. Before you can do anything else with a file, you must "open" it:</p><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">file = open('data.csv', 'r')</code></pre><p>This statement opens a file named <code data-lang="text/x-python" class="sourceCode">'data.csv'</code> in read mode (<code data-lang="text/x-python" class="sourceCode">'r'</code>).
The <code data-lang="text/x-python" class="sourceCode">open</code> function returns a file object that we can use to read from or (if it were opened in the appropriate mode) write to the file.</p><blockquote class="Incercise"><p class="IncerciseHeader">Do Now!</p><blockquote class="IncerciseBody"><p>What do you think would happen if you tried to open a file that doesnâ€™t exist? Try it and see what error message you get.</p></blockquote></blockquote><p>Once we have a file object, we can read its contents in one of several ways:</p><p>Important: the file object remembers where in the file it is reading.
This is how calling <code data-lang="text/x-python" class="sourceCode">.readline()</code> twice doesnâ€™t return the same line, it returns one line,
and then the next. But, this also means that if you ran either <code data-lang="text/x-python" class="sourceCode">.read()</code> or <code data-lang="text/x-python" class="sourceCode">.readlines()</code>,
you would have read the entire file, which means the position of the file object is now at the end, which means
calling any of the other methods would return empty results â€“ empty strings for <code data-lang="text/x-python" class="sourceCode">.read()</code> or <code data-lang="text/x-python" class="sourceCode">.readline()</code>, and an
empty list for <code data-lang="text/x-python" class="sourceCode">.readlines()</code>. You can move where the file object is pointing, with <code data-lang="text/x-python" class="sourceCode">.seek()</code>, but how that
works is beyond our scope!</p><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode"># Read the entire file as one string
content = file.read()

# Or, we can read one line at a time
line = file.readline()
another_line = file.readline()

# We can also read all remaining lines into a list of strings
all_lines = file.readlines()</code></pre><p>When weâ€™re done using a file, we should always close it:</p><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">file.close()</code></pre><blockquote class="Incercise"><p class="IncerciseHeader">Do Now!</p><blockquote class="IncerciseBody"><p>Why do you think it might be important to close files when youâ€™re done with them?</p></blockquote></blockquote><p>Closing files is important because it frees up system resources and ensures that,
if we were writing to the file (unlike in this example, where we are only reading)
all pending writes actually get saved! However, manually remembering to close files
can be error-prone. Python provides a more reliable way using the <code data-lang="text/x-python" class="sourceCode">with</code>
statement:</p><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">with open('data.csv', 'r') as file:
    content = file.read()
    # file is automatically closed when this block ends</code></pre><p>In addition to not making us remember to close the files, it this approach also guarantees
that the file will be closed even if an error occurs while processing it.</p>&#13;
<h4 class="heading">11.1.2Â <a name="(part._.Reading_.C.S.V_.Files_.Step_by_.Step)"/>Reading CSV Files Step by Step<a href="#(part._.Reading_.C.S.V_.Files_.Step_by_.Step)" class="heading-anchor" title="Link to here">ðŸ”—</a> </h4><p>Letâ€™s work through reading a CSV file manually, as a way to practice using files for a practical (if small) example.</p><p>Suppose we have a file called <code data-lang="text/x-python" class="sourceCode">orders.csv</code> with the following contents:
(You can create this file with your editor of choice â€“ e.g., VSCode).</p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p>dish,quantity,price,order_type</p></td></tr><tr><td><p>Pizza,2,25.0,dine-in</p></td></tr><tr><td><p>Salad,1,8.75,takeout</p></td></tr><tr><td><p>Burger,3,30.0,dine-in</p></td></tr><tr><td><p>Pizza,1,12.50,takeout</p></td></tr></table><p>Hereâ€™s how we can read and parse this file step by step:</p><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode"># Step 1: Open and read the file into variable `lines`
with open('orders.csv', 'r') as file:
    lines = file.readlines()

# Step 2: Clean data: remove newline characters and split by commas
data = []
for line in lines:
    cells = line.strip().split(',')
    data.append(cells)

# Step 3: Separate header (first row) from data rows (rest of file)
header = data[0]
rows = data[1:]

print("Header:", header)
print("First row:", rows[0])</code></pre><p>Letâ€™s break down what each step does:</p><ol><li><p><code data-lang="text/x-python" class="sourceCode">file.readlines()</code> reads all lines from the file into a list of strings</p></li><li><p>We use a for loop to go through each line, using <code data-lang="text/x-python" class="sourceCode">line.strip()</code> to remove the newline character (<code data-lang="text/x-python" class="sourceCode">'\n'</code>)
from the end of each line and then turning the line into a list of strings by <code data-lang="text/x-python" class="sourceCode">.split(',')</code>,
which divides the string by the given string (which is not included).</p></li><li><p>We separate the first row (header) from the data rows for easier processing â€“
the notation <code data-lang="text/x-python" class="sourceCode">data[1:]</code> is a special way of indicating we want "from index 1 until as far as the
list goes â€“ i.e., the end of the list.</p></li></ol><blockquote class="Incercise"><p class="IncerciseHeader">Do Now!</p><blockquote class="IncerciseBody"><p>What would our code do if one of the cells in your CSV contained a comma?
For example, what if a dish name was "Mac and cheese, deluxe"? How could you handle this?</p></blockquote></blockquote>&#13;
<h4 class="heading">11.1.3Â <a name="(part._.Processing_and_.Filtering_.Data)"/>Processing and Filtering Data<a href="#(part._.Processing_and_.Filtering_.Data)" class="heading-anchor" title="Link to here">ðŸ”—</a> </h4><p>Once we have our data as a list of lists, we can process it using the same programming
techniques weâ€™ve learned, by using the <code data-lang="text/x-python" class="sourceCode">.index()</code> method to return the numeric
offset of the given string in a list of strings â€“ this is how we will find the columns
we are interested in, and then use that to index into the row.</p><p>For example, letâ€™s filter for only takeout orders:</p><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode"># Returns the index (i.e., offset, base 0) where 'order_type' exists in the header list.
order_type_index = header.index('order_type')

# Filter for takeout orders
takeout_orders = []
for row in rows:
    if row[order_type_index] == 'takeout':
        takeout_orders.append(row)

print("Found " + str(len(takeout_orders)) + " takeout orders")</code></pre><p>We can also convert data types as needed. For instance, if we want to calculate total revenue,
we need to not only find the quantity and price for each row, but convert the strings that are in
the row (since the file was all strings!) to numbers before multiplying:</p><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">quantity_index = header.index('quantity')
price_index = header.index('price')

total_revenue = 0
for row in rows:
    quantity = int(row[quantity_index])
    price = float(row[price_index])
    total_revenue += quantity * price

print("Total revenue: $" + str(total_revenue))</code></pre><blockquote class="Incercise"><p class="IncerciseHeader">Do Now!</p><blockquote class="IncerciseBody"><p>What would happen if one of the quantity cells contained invalid data, like the string "three" instead of the number 3? How could you make your code more robust to handle such errors?</p></blockquote></blockquote>&#13;
<h4 class="heading">11.1.4Â <a name="(part._.Writing_.C.S.V_.Files)"/>Writing CSV Files<a href="#(part._.Writing_.C.S.V_.Files)" class="heading-anchor" title="Link to here">ðŸ”—</a> </h4><p>Writing CSV files follows a similar pattern. We need to:</p><ol><li><p>Open a file in write mode</p></li><li><p>Convert our data to the proper string format</p></li><li><p>Write the strings to the file</p></li></ol><p>Hereâ€™s how to write our filtered takeout orders to a new file:</p><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode"># Prepare data to write (header + filtered rows)
output_data = [header] + takeout_orders

# Write to file
with open('takeout_orders.csv', 'w') as file:
    for row in output_data:
        # Join the row elements with commas and add a newline
        line = ','.join(row) + '\n'
        file.write(line)</code></pre><p>The key steps here are:</p><ul><li><p><code data-lang="text/x-python" class="sourceCode">','.join(row)</code> combines the list elements into a single string with commas between them</p></li><li><p>We add <code data-lang="text/x-python" class="sourceCode">'\n'</code> to create a new line after each row</p></li><li><p><code data-lang="text/x-python" class="sourceCode">file.write()</code> writes the string to the file</p></li></ul><p>Note that we call <code data-lang="text/x-python" class="sourceCode">.write()</code> once for each line â€“ we could have combined all the lines into a single
string, and only called <code data-lang="text/x-python" class="sourceCode">.write()</code> once, but there is no need to â€“ just like how file objects remember
where we are reading from them, they remember where we were writing, so the next call to <code data-lang="text/x-python" class="sourceCode">.write()</code> will
add the next string after the previous one.</p><blockquote class="Incercise"><p class="IncerciseHeader">Do Now!</p><blockquote class="IncerciseBody"><p>Try writing a program that reads a CSV file, adds a new column with calculated values (like total price = quantity Ã— price), and writes the result to a new file.</p></blockquote></blockquote>    
</body>
</html>