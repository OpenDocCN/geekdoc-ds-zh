- en: Barrier and Distances
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 障碍和距离
- en: 原文：[https://phys-sim-book.github.io/lec24.1-barrier_and_dist.html](https://phys-sim-book.github.io/lec24.1-barrier_and_dist.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec24.1-barrier_and_dist.html](https://phys-sim-book.github.io/lec24.1-barrier_and_dist.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: With triangle mesh discretization, the barrier potential in the continuous settings
    (Equation [(18.3.5)](lec18.3-barrier_potential.html#eq:lec18:barrier_potential))
    can be approximated as ≈==​∫ΓC​​21​b(X2​∈ΓC​−N(X)min​∥x(X,t)−x(X2​,t)∥,d^)ds(X)∫ΓC​​21​b(e∈T−I(X)min​X2​∈emin​∥x(X,t)−x(X2​,t)∥,d^)ds(X)∫ΓC​​21​b(e∈T−I(X)min​dPT(x(X,t),e),d^)ds(X)∫ΓC​​21​e∈T−I(X)max​b(dPT(x(X,t),e),d^)ds(X),​(24.1.1)
    where T is the set of all surface triangles, I(X) is the set of all surface triangles
    that hold point X, and dPT is the point-triangle distance. Further approximating
    the max operator with summations and use mesh surface nodes a^ as quadrature points,
    we have ≈≈​∫ΓC​​21​e∈T−I(X)max​b(dPT(x(X,t),e),d^)ds(X)∫ΓC​​21​e∈T−I(X)∑​b(dPT(x(X,t),e),d^)ds(X)a^∑​21​wa^​e∈T−I(Xa^​)∑​b(dPT(xa^​,e),d^),​(24.1.2)
    where wa^​=d^31​∑j∈I(Xa^​)​Aj​ is the integration weight and Aj​ is the area of
    node a^'s incident surface triangle j.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 使用三角形网格离散化，连续设置中的势垒势（方程[(18.3.5)](lec18.3-barrier_potential.html#eq:lec18:barrier_potential)）可以近似为
    ≈==∫ΓC21b(X2∈ΓC−N(X)min∥x(X,t)−x(X2,t)∥,d^)ds(X)∫ΓC21b(e∈T−I(X)minX2∈emin∥x(X,t)−x(X2,t)∥,d^)ds(X)∫ΓC21b(e∈T−I(X)mindPT(x(X,t),e),d^)ds(X)∫ΓC21e∈T−I(X)maxb(dPT(x(X,t),e),d^)ds(X)，(24.1.1)
    其中T是所有表面三角形的集合，I(X)是包含点X的所有表面三角形的集合，dPT是点-三角形距离。进一步用求和来近似最大运算符，并使用网格表面节点a^作为求积点，我们有
    ≈≈∫ΓC21e∈T−I(X)maxb(dPT(x(X,t),e),d^)ds(X)∫ΓC21e∈T−I(X)∑b(dPT(x(X,t),e),d^)ds(X)a^∑21wa^e∈T−I(Xa^)∑b(dPT(xa^,e),d^)，(24.1.2)
    其中wa^=d^31∑j∈I(Xa^)Aj是积分权重，Aj是节点a^的入射表面三角形j的面积。
- en: Now, getting back to the second line of Equation [(24.1.1)](#eq:lec24:tri_disc_barrier_pot),
    if we only use points on the edges to approximate the minimum distance, we obtain
    ≈=​∫ΓC​​21​b(X2​∈ΓC​−N(X)min​∥x(X,t)−x(X2​,t)∥,d^)ds(X)∫ΓC​​21​b(e∈E−I(X)min​X2​∈emin​∥x(X,t)−x(X2​,t)∥,d^)ds(X)∫ΓC​​21​e∈E−I(X)max​b(X2​∈emin​∥x(X,t)−x(X2​,t)∥,d^)ds(X).​
    Then if we choose a special quadrature point Xe1​​ per surface edge e1​ and approximate
    the max operators with summations, we get ≈​∫ΓC​​21​e∈E−I(X)max​b(X2​∈emin​∥x(X,t)−x(X2​,t)∥,d^)ds(X)e1​∈E∑​21​we1​​e∈E−I(Xe1​​)∑​b(X2​∈emin​∥x(Xe1​​,t)−x(X2​,t)∥,d^),​
    where we1​​=d^31​∑j∈I(e1​)​Aj​ is the integration weight and Aj​ is the area of
    e1​'s incident surface triangle j. Next, if we always select Xe1​​ to be the closest
    point to X2​ on e1​, we will get ≈=​e1​∈E∑​21​we1​​e∈E−I(Xe1​​)∑​b(X2​∈emin​∥x(Xe1​​,t)−x(X2​,t)∥,d^)e1​∈E∑​21​we1​​e∈E−N(e1​)∑​b(X2​∈e,X∈e1​min​∥x(X,t)−x(X2​,t)∥,d^)e1​∈E∑​21​we1​​e∈E−N(e1​)∑​b(dEE(e,e1​),d^),​(24.1.3)
    where N(e1​) is the set of all the surface edge neighbors of e1​ plus itself.
    For the summation over all surface edges in Equation [(24.1.3)](#eq:lec24:edge_barrier),
    if we only account for (e1​,e) with e1​<e or the other way around, then the coefficient
    1/2 can be omitted.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，回到方程式[(24.1.1)](#eq:lec24:tri_disc_barrier_pot)的第二行，如果我们只使用边上的点来近似最小距离，我们得到
    ≈=∫ΓC21b(X2∈ΓC−N(X)min∥x(X,t)−x(X2,t)∥,d^)ds(X)∫ΓC21b(e∈E−I(X)minX2∈emin∥x(X,t)−x(X2,t)∥,d^)ds(X)∫ΓC21e∈E−I(X)maxb(X2∈emin∥x(X,t)−x(X2,t)∥,d^)ds(X).
    然后，如果我们为每个表面边e1选择一个特殊的求积点Xe1，并用求和来近似最大运算符，我们得到 ≈∫ΓC21e∈E−I(X)maxb(X2∈emin∥x(Xe1,t)−x(X2,t)∥,d^)ds(X)e1∈E∑21we1e∈E−I(Xe1)∑b(X2∈emin∥x(Xe1,t)−x(X2,t)∥,d^)，其中we1=d^31∑j∈I(e1)Aj是积分权重，Aj是e1的入射表面三角形j的面积。接下来，如果我们始终选择Xe1作为e1上最接近X2的点，我们将得到
    ≈=e1∈E∑21we1e∈E−I(Xe1)∑b(X2∈emin∥x(Xe1,t)−x(X2,t)∥,d^)e1∈E∑21we1e∈E−N(e1)∑b(X2∈e,X∈e1min∥x(X,t)−x(X2,t)∥,d^)e1∈E∑21we1e∈E−N(e1)∑b(dEE(e,e1),d^)，(24.1.3)
    其中N(e1)是e1的所有表面边邻居的集合加上它自己。对于方程[(24.1.3)](#eq:lec24:edge_barrier)中所有表面边的求和，如果我们只考虑(e1,e)中e1<e或相反的情况，那么系数1/2可以省略。
- en: Now we have two kinds of discretizations for the 3D barrier potential energy.
    To use them together in practice, we can take advantage of a linear combination
    of them, and the coefficient could usually be set to 1/2.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有三种3D势垒势能的离散化方法。为了在实际中同时使用它们，我们可以利用它们的线性组合，并且系数通常可以设置为1/2。
- en: For point-triangle and edge-edge distances, they are also both small optimization
    problems with analytical solutions, which can be represented as piecewise smooth
    functions like the 2D Point-Edge distance in Equation [(21.2.1)](lec21.2-point_edge_dist.html#eq:lec21:pw_pe_dist).
    For example, in the point-triangle case, the expression can be determined by checking
    which region the projection of the point onto the triangle plane is located.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 对于点-三角形和边-边距离，它们也都是具有解析解的小优化问题，可以表示为分段光滑函数，如方程 [(21.2.1)](lec21.2-point_edge_dist.html#eq:lec21:pw_pe_dist)
    中的 2D 点-边距离。例如，在点-三角形的情况下，可以通过检查点在三角形平面上的投影位于哪个区域来确定表达式。
- en: '**Definition 24.1.1 (3D Point-Triangle Distance).** The distance between point
    xp​ and triangle with vertices xt1​, xt2​, and xt3​ can be defined as argβ1​,β2​min​∥xp​−(xt1​+β1​(xt2​−xt1​)+β2​(xt3​−xt1​))∥s.t.β1​,β2​≥0, β1​+β2​≤1'
  id: totrans-7
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**定义 24.1.1 (3D 点-三角形距离).** 点 xp 与顶点为 xt1, xt2, xt3 的三角形之间的距离可以定义为 argβ1,β2
    min ∥xp − (xt1 + β1(xt2 − xt1) + β2(xt3 − xt1))∥，其中 β1,β2 ≥ 0, β1 + β2 ≤ 1'
- en: '**Definition 24.1.2 (3D Edge-Edge Distance).** The distance between edge with
    end nodes xe1a​ and xe1b​ and edge with end nodes xe2a​ and xe2b​ can be defined
    as argβ1​,β2​min​∥xe1a​+β1​(xe1b​−xe1a​)−(xe2a​+β2​(xe2b​−xe2a​))∥s.t.β1​,β2​∈[0,1]'
  id: totrans-8
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**定义 24.1.2 (3D 边-边距离).** 具有端点 xe1a 和 xe1b 的边与具有端点 xe2a 和 xe2b 的边之间的距离可以定义为
    argβ1,β2 min ∥xe1a + β1(xe1b − xe1a) − (xe2a + β2(xe2b − xe2a))∥，其中 β1,β2 ∈ [0,1]'
- en: '***Remark 24.1.1 (Smoothness of 3D Distance Functions).*** Note that the point-triangle
    distance is at least C1 continuous everywhere. This means that even when the projected
    point is located on the borders of the piecewise function, the distance gradient
    still exists and is continuous. However, for edge-edge distance, when the edges
    are parallel, the distance function is only C0 continuous, as the gradient of
    the expressions in adjacent regions do not agree. To address this issue, IPC [[Li
    et al. 2020]](bibliography.html#li2020incremental) proposed multiplying a mollifier
    to the edge-edge barrier energy density function to make the potential C1 continuous
    everywhere. This mollifier smoothly decreases to zero when the edges are parallel.
    This ensures that gradient-based optimization methods can still be applied efficiently
    to solve the problem.'
  id: totrans-9
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '***备注 24.1.1 (3D 距离函数的平滑性).*** 注意到点-三角形距离在所有地方至少是 C1 连续的。这意味着即使投影点位于分段函数的边界上，距离梯度仍然存在且是连续的。然而，对于边-边距离，当边平行时，距离函数仅是
    C0 连续的，因为相邻区域表达式的梯度不一致。为了解决这个问题，IPC [[Li 等人 2020]](bibliography.html#li2020incremental)
    提出将一个磨光器乘以边-边障碍能密度函数，以使势能在所有地方都是 C1 连续的。当边平行时，这个磨光器平滑地减小到零。这确保了基于梯度的优化方法仍然可以有效地应用于解决问题。'
