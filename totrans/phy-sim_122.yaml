- en: Barrier and Distances
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec24.1-barrier_and_dist.html](https://phys-sim-book.github.io/lec24.1-barrier_and_dist.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: With triangle mesh discretization, the barrier potential in the continuous settings
    (Equation [(18.3.5)](lec18.3-barrier_potential.html#eq:lec18:barrier_potential))
    can be approximated as ≈==​∫ΓC​​21​b(X2​∈ΓC​−N(X)min​∥x(X,t)−x(X2​,t)∥,d^)ds(X)∫ΓC​​21​b(e∈T−I(X)min​X2​∈emin​∥x(X,t)−x(X2​,t)∥,d^)ds(X)∫ΓC​​21​b(e∈T−I(X)min​dPT(x(X,t),e),d^)ds(X)∫ΓC​​21​e∈T−I(X)max​b(dPT(x(X,t),e),d^)ds(X),​(24.1.1)
    where T is the set of all surface triangles, I(X) is the set of all surface triangles
    that hold point X, and dPT is the point-triangle distance. Further approximating
    the max operator with summations and use mesh surface nodes a^ as quadrature points,
    we have ≈≈​∫ΓC​​21​e∈T−I(X)max​b(dPT(x(X,t),e),d^)ds(X)∫ΓC​​21​e∈T−I(X)∑​b(dPT(x(X,t),e),d^)ds(X)a^∑​21​wa^​e∈T−I(Xa^​)∑​b(dPT(xa^​,e),d^),​(24.1.2)
    where wa^​=d^31​∑j∈I(Xa^​)​Aj​ is the integration weight and Aj​ is the area of
    node a^'s incident surface triangle j.
  prefs: []
  type: TYPE_NORMAL
- en: Now, getting back to the second line of Equation [(24.1.1)](#eq:lec24:tri_disc_barrier_pot),
    if we only use points on the edges to approximate the minimum distance, we obtain
    ≈=​∫ΓC​​21​b(X2​∈ΓC​−N(X)min​∥x(X,t)−x(X2​,t)∥,d^)ds(X)∫ΓC​​21​b(e∈E−I(X)min​X2​∈emin​∥x(X,t)−x(X2​,t)∥,d^)ds(X)∫ΓC​​21​e∈E−I(X)max​b(X2​∈emin​∥x(X,t)−x(X2​,t)∥,d^)ds(X).​
    Then if we choose a special quadrature point Xe1​​ per surface edge e1​ and approximate
    the max operators with summations, we get ≈​∫ΓC​​21​e∈E−I(X)max​b(X2​∈emin​∥x(X,t)−x(X2​,t)∥,d^)ds(X)e1​∈E∑​21​we1​​e∈E−I(Xe1​​)∑​b(X2​∈emin​∥x(Xe1​​,t)−x(X2​,t)∥,d^),​
    where we1​​=d^31​∑j∈I(e1​)​Aj​ is the integration weight and Aj​ is the area of
    e1​'s incident surface triangle j. Next, if we always select Xe1​​ to be the closest
    point to X2​ on e1​, we will get ≈=​e1​∈E∑​21​we1​​e∈E−I(Xe1​​)∑​b(X2​∈emin​∥x(Xe1​​,t)−x(X2​,t)∥,d^)e1​∈E∑​21​we1​​e∈E−N(e1​)∑​b(X2​∈e,X∈e1​min​∥x(X,t)−x(X2​,t)∥,d^)e1​∈E∑​21​we1​​e∈E−N(e1​)∑​b(dEE(e,e1​),d^),​(24.1.3)
    where N(e1​) is the set of all the surface edge neighbors of e1​ plus itself.
    For the summation over all surface edges in Equation [(24.1.3)](#eq:lec24:edge_barrier),
    if we only account for (e1​,e) with e1​<e or the other way around, then the coefficient
    1/2 can be omitted.
  prefs: []
  type: TYPE_NORMAL
- en: Now we have two kinds of discretizations for the 3D barrier potential energy.
    To use them together in practice, we can take advantage of a linear combination
    of them, and the coefficient could usually be set to 1/2.
  prefs: []
  type: TYPE_NORMAL
- en: For point-triangle and edge-edge distances, they are also both small optimization
    problems with analytical solutions, which can be represented as piecewise smooth
    functions like the 2D Point-Edge distance in Equation [(21.2.1)](lec21.2-point_edge_dist.html#eq:lec21:pw_pe_dist).
    For example, in the point-triangle case, the expression can be determined by checking
    which region the projection of the point onto the triangle plane is located.
  prefs: []
  type: TYPE_NORMAL
- en: '**Definition 24.1.1 (3D Point-Triangle Distance).** The distance between point
    xp​ and triangle with vertices xt1​, xt2​, and xt3​ can be defined as argβ1​,β2​min​∥xp​−(xt1​+β1​(xt2​−xt1​)+β2​(xt3​−xt1​))∥s.t.β1​,β2​≥0, β1​+β2​≤1'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Definition 24.1.2 (3D Edge-Edge Distance).** The distance between edge with
    end nodes xe1a​ and xe1b​ and edge with end nodes xe2a​ and xe2b​ can be defined
    as argβ1​,β2​min​∥xe1a​+β1​(xe1b​−xe1a​)−(xe2a​+β2​(xe2b​−xe2a​))∥s.t.β1​,β2​∈[0,1]'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '***Remark 24.1.1 (Smoothness of 3D Distance Functions).*** Note that the point-triangle
    distance is at least C1 continuous everywhere. This means that even when the projected
    point is located on the borders of the piecewise function, the distance gradient
    still exists and is continuous. However, for edge-edge distance, when the edges
    are parallel, the distance function is only C0 continuous, as the gradient of
    the expressions in adjacent regions do not agree. To address this issue, IPC [[Li
    et al. 2020]](bibliography.html#li2020incremental) proposed multiplying a mollifier
    to the edge-edge barrier energy density function to make the potential C1 continuous
    everywhere. This mollifier smoothly decreases to zero when the edges are parallel.
    This ensures that gradient-based optimization methods can still be applied efficiently
    to solve the problem.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
