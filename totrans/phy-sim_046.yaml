- en: 'Case Study: Square Drop'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 案例研究：正方形下落
- en: 原文：[https://phys-sim-book.github.io/lec8.3-square_drop.html](https://phys-sim-book.github.io/lec8.3-square_drop.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec8.3-square_drop.html](https://phys-sim-book.github.io/lec8.3-square_drop.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '`<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">`'
- en: To conclude, let's consider a case study where we simulate a square dropped
    onto a fixed planar ground. Building on our previous mass-spring model for an
    elastic square, we augment a barrier potential into its Incremental Potential
    and apply the filter line search scheme to manage the contact between the square's
    degrees of freedom (DOFs) and the ground.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 为了总结，让我们考虑一个案例研究，其中我们模拟一个正方形落在固定的平面地面上。基于我们之前为弹性正方形建立的质点-弹簧模型，我们将其增量势能中加入势垒势，并应用滤波线搜索方案来管理正方形的自由度（DOFs）与地面之间的接触。
- en: The excutable Python project for this section can be found at [https://github.com/phys-sim-book/solid-sim-tutorial](https://github.com/phys-sim-book/solid-sim-tutorial)
    under the `3_contact` folder. [MUDA](https://github.com/MuGdxy/muda) GPU implementations
    can be found at [https://github.com/phys-sim-book/solid-sim-tutorial-gpu](https://github.com/phys-sim-book/solid-sim-tutorial-gpu)
    under the `simulators/3_contact` folder.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本节的可执行 Python 项目可在 `3_contact` 文件夹下的 [https://github.com/phys-sim-book/solid-sim-tutorial](https://github.com/phys-sim-book/solid-sim-tutorial)
    找到。[MUDA](https://github.com/MuGdxy/muda) GPU 实现可在 `simulators/3_contact` 文件夹下的
    [https://github.com/phys-sim-book/solid-sim-tutorial-gpu](https://github.com/phys-sim-book/solid-sim-tutorial-gpu)
    找到。
- en: 'If we further limit the planar ground to be horizontal, e.g. at \(y=y_0\),
    its signed distance function can be made even simpler than Equation [(7.1.1)](lec7.1-signed_dists.html#eq:lec7:half_space_dist):
    d(x)=xy​−y0​,∇d(x)=[01​],∇2d(x)=0.(8.3.1) Combining it with Equation [(7.2.4)](lec7.2-dist_barrier_formulation.html#eq:lec7:barrier_grad)
    and Equation [(7.2.5)](lec7.2-dist_barrier_formulation.html#eq:lec7:barrier_hess),
    we can conveniently implement the gradient and Hessian computation for the barrier
    potential of this horizontal ground:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们进一步将平面地面限制为水平，例如在 \(y=y_0\) 处，其符号距离函数可以比方程 [(7.1.1)](lec7.1-signed_dists.html#eq:lec7:half_space_dist)
    更简单：\(d(x)=xy-y_0\)，\(\nabla d(x)=[0 1]\)，\(\nabla^2d(x)=0\)。（8.3.1）结合方程 [(7.2.4)](lec7.2-dist_barrier_formulation.html#eq:lec7:barrier_grad)
    和方程 [(7.2.5)](lec7.2-dist_barrier_formulation.html#eq:lec7:barrier_hess)，我们可以方便地实现此水平地面的势垒势的梯度和Hessian计算：
- en: '**Implementation 8.3.1 (Barrier energy value, gradient, and Hessian, BarrierEnergy.py).**'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现 8.3.1 (势垒能量值、梯度及Hessian，BarrierEnergy.py)**。'
- en: '[PRE0]'
  id: totrans-7
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'For the filter line search, with the position in the last iteration \(\mathbf{x}\)
    and a search direction \(\mathbf{p}\) of a specific node, the signed distance
    function is simply \[ d(\mathbf{x} + \alpha \mathbf{p}) = \mathbf{x}_y + \alpha
    \mathbf{p}_y - y_0, \] where \(\alpha\) is the step size, and there is only one
    positive real root \(\alpha = (y_0 - \mathbf{x}_y) / \mathbf{p}_y\) when \(\mathbf{p}_y
    < 0\) since \(\mathbf{x}_y > y_0\) (no interpenetration up to current iteration).
    Taking the minimum of the positive real root per node then gives us the step size
    upper bound \(\alpha_C\) defined in Equation [(8.2.1)](lec8.2-nonpenetration_traj.html#eq:lec8:alpha_CCD):'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 对于滤波线搜索，在上一迭代的位置 \(\mathbf{x}\) 和一个特定节点的搜索方向 \(\mathbf{p}\)，符号距离函数简单地是 \[ d(\mathbf{x}
    + \alpha \mathbf{p}) = \mathbf{x}_y + \alpha \mathbf{p}_y - y_0, \] 其中 \(\alpha\)
    是步长，当 \(\mathbf{p}_y < 0\) 时（因为 \(\mathbf{x}_y > y_0\)，当前迭代没有穿透），存在唯一的正实根 \(\alpha
    = (y_0 - \mathbf{x}_y) / \mathbf{p}_y\)。对每个节点取正实根的最小值，然后给出方程 [(8.2.1)](lec8.2-nonpenetration_traj.html#eq:lec8:alpha_CCD)
    中定义的步长上限 \(\alpha_C\)：
- en: '**Implementation 8.3.2 (Ground CCD, BarrierEnergy.py).**'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现 8.3.2 (地面 CCD，BarrierEnergy.py)**。'
- en: '[PRE1]'
  id: totrans-10
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Here we scale the upper bound by \(0.9\times\) so that exact touching configurations
    with \(d=0\) and \(b = \infty\) (floating-point number overflow) can be avoided.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 这里我们将上限乘以 \(0.9\times\)，以避免精确接触配置 \(d=0\) 和 \(b = \infty\)（浮点数溢出）。
- en: Then once we make sure the step size upper bound is used to initialize the line
    search
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 然后一旦我们确保使用步长上限来初始化线搜索
- en: '**Implementation 8.3.3 (Filter line search, time_integrator.py).**'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现 8.3.3 (滤波线搜索，time_integrator.py)**。'
- en: '[PRE2]'
  id: totrans-14
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: and that the contact area weights for all nodes are calculated
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 并且计算了所有节点的接触面积权重
- en: '**Implementation 8.3.4 (Contact area, simulator.py).**'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现 8.3.4 (接触面积，simulator.py)**。'
- en: '[PRE3]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: and passed to our simulator, we can simulate the square drop with mass-spring
    stiffness `k=2e4` and time step size `h=0.01` as shown in [Figure 8.3.1](#fig:lec8:square_drop).
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 将其传递给我们的模拟器，我们可以模拟质量-弹簧刚度为`k=2e4`和时间步长为`h=0.01`的正方形下落，如图[图8.3.1](#fig:lec8:square_drop)所示。
- en: '![](../Images/fe71ac94bc531fb47471684d96a9cc21.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/fe71ac94bc531fb47471684d96a9cc21.png)'
- en: '**Figure 8.3.1.** A mass-spring elastic square is dropped onto the ground with
    0 initial velocity under gravity. Here we show the frames when the square is:
    just dropped, first touching the ground, compressed to the maximum in this simulation,
    and becoming static.'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '**图8.3.1**。一个质量-弹簧弹性正方形以0初始速度在重力作用下被扔到地面上。这里展示了正方形：刚刚被扔下，第一次接触地面，在这个模拟中压缩到最大，以及变为静态时的帧。'
- en: '***Remark 8.3.1 (Contact Layer Integration).*** Since in practice, contact
    forces are only exerted on the boundary of the solids, the barrier potential should
    be integrated only on the boundary as well. This also explains why in our case
    study the contact area weight per node is simply calculated as the diameter of
    the square evenly distributed onto each boundary node. However, as mass-spring
    elasticity cannot guarantee that all interior nodes will stay inside the boundary
    of the solid, we simply apply the barrier potential to all nodal DOFs of the square.'
  id: totrans-21
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '***备注8.3.1（接触层集成）***。由于在实际中，接触力仅作用于固体的边界，因此势垒电势也应仅集成在边界上。这也解释了为什么在我们的案例研究中，接触面积权重简单地按正方形的直径均匀分配到每个边界节点上计算。然而，由于质量-弹簧弹性不能保证所有内部节点都保持在固体的边界内，我们简单地应用势垒电势到正方形的所有节点自由度上。'
