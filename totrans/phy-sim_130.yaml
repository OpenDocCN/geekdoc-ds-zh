- en: 'Case Study: ABD Square Drop*'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec25.4-dropping_block.html](https://phys-sim-book.github.io/lec25.4-dropping_block.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: Let’s now implement Affine Body Dynamics (ABD) in 2D for a neo-Hookean version
    of the [square drop](./lec8.3-square_drop.html) simulation. This requires only
    minor modifications to the standard IPC simulation code. The full implementation
    is available in the `9_reduced_DOF` folder of our [solid simulation tutorial](https://github.com/phys-sim-book/solid-sim-tutorial).
  prefs: []
  type: TYPE_NORMAL
- en: 'We begin by introducing a function to compute the reduced basis. In ABD, we
    consider only affine deformations. Therefore, we use `method=1` (polynomial basis)
    and `order=1` (linear basis) to extract the linear basis:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 25.4.1 (Compute reduced basis, utils.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Here, `method=0` refers to full-space simulation and returns immediately without
    computing a basis.
  prefs: []
  type: TYPE_NORMAL
- en: '`method=1` computes polynomial bases, including linear, quadratic, and cubic
    functions. For each basis vector, the displacement components at each node are
    expressed as polynomial functions of the node’s material-space coordinates. `method=2`
    computes bases via linear modal analysis, which solves the eigensystem of the
    elasticity Hessian and extracts displacement fields that correspond to the deformation
    modes that increases the least amount of energy. This will be discussed in more
    detail in [the next lecture](./lec25.6-modal_reductions.html).'
  prefs: []
  type: TYPE_NORMAL
- en: 'After computing the basis, we restrict the simulation to the corresponding
    subspace by projecting the Hessian matrix and the gradient vector. This projection
    follows the chain rule, as described in Equation [(25.3.1)](lec25.3-affine_body_dynamics.html#eq:lec25:newton_chain_rules).
    The relevant implementation is:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 25.4.2 (Compute reduced search direction, time_integrator.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'These changes enable us to run the ABD version of the square-drop simulation:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/12b5ff77c25680a147f38d6c8769cc5f.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 25.4.1.** ABD simulation of a square dropped onto the ground.'
  prefs: []
  type: TYPE_NORMAL
- en: In this example, we reduce the stiffness parameter to make the body softer,
    emphasizing the difference between ABD and standard IPC. The blue mesh is the
    original mesh (also used for collision), while the red triangle visualizes the
    reduced degrees of freedom.
  prefs: []
  type: TYPE_NORMAL
