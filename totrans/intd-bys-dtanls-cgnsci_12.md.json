["```r\ndata(\"df_pupil_pilot\")\ndf_pupil_pilot$p_size %>%  summary()\n```", "```r\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##     852     856     862     861     866     868\n```", "```r\nqnorm(c(.025, .975), mean = 1000, sd = 500)\n```", "```r\n## [1]   20 1980\n```", "```r\nqtnorm(c(0.025, 0.975), mean = 0, sd = 1000, a = 0)\n```", "```r\n## [1]   31.3 2241.4\n```", "```r\nsamples <-  rtnorm(20000, mean = 0, sd = 1000, a = 0)\nc(mean = mean(samples), sd = sd(samples))\n```", "```r\n## mean   sd \n##  801  601\n```", "```r\nqnorm(c(0.025, 0.975), mean = 0, sd = 100)\n```", "```r\n## [1] -196  196\n```", "```r\ndata(\"df_pupil\")\n(df_pupil <-  df_pupil %>%\n mutate(c_load = load -  mean(load)))\n```", "```r\n## # A tibble: 41 × 5\n##    subj trial  load p_size c_load\n##   <int> <int> <int>  <dbl>  <dbl>\n## 1   701     1     2  1021\\. -0.439\n## 2   701     2     1   951\\. -1.44 \n## 3   701     3     5  1064\\.  2.56 \n## # ℹ 38 more rows\n```", "```r\nfit_pupil <-\n brm(p_size ~  1 +  c_load,\n data = df_pupil,\n family = gaussian(),\n prior = c(prior(normal(1000, 500), class = Intercept),\n prior(normal(0, 1000), class = sigma),\n prior(normal(0, 100), class = b, coef = c_load)))\n```", "```r\nplot(fit_pupil)\n```", "```r\nfit_pupil\n```", "```r\n## ...\n## Population-Level Effects: \n##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\n## Intercept   702.30     19.92   664.39   741.46 1.00     3737     2987\n## c_load       33.74     11.40    11.74    56.71 1.00     3672     2808\n## \n## Family Specific Parameters: \n##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\n## sigma   128.34     14.75   103.13   160.52 1.00     3881     2903\n## \n## ...\n```", "```r\nmean(as_draws_df(fit_pupil)$b_c_load >  0)\n```", "```r\n## [1] 0.998\n```", "```r\nfor (l in 0:4) {\n df_sub_pupil <-  filter(df_pupil, load ==  l)\n p <-  pp_check(fit_pupil,\n type = \"dens_overlay\",\n ndraws = 100,\n newdata = df_sub_pupil) +\n geom_point(data = df_sub_pupil, aes(x = p_size, y = 0.0001)) +\n ggtitle(paste(\"load: \", l)) +\n coord_cartesian(xlim = c(400, 1000))\n print(p)\n}\n```", "```r\nfor (l in 0:4) {\n df_sub_pupil <-  filter(df_pupil, load ==  l)\n p <-  pp_check(fit_pupil,\n type = \"stat\",\n ndraws = 1000,\n newdata = df_sub_pupil,\n stat = \"mean\") +\n geom_point(data = df_sub_pupil, aes(x = p_size, y = 0.9)) +\n ggtitle(paste(\"load: \", l)) +\n coord_cartesian(xlim = c(400, 1000))\n print(p)\n}\n```", "```r\ndf_spacebar <-  df_spacebar %>%\n mutate(c_trial = trial -  mean(trial))\n```", "```r\n# Ignore the dependent variable,\n# use a vector of ones a placeholder.\ndf_spacebar_ref <-  df_spacebar %>%\n mutate(t = rep(1, n()))\nfit_prior_press_trial <-\n brm(t ~  1 +  c_trial,\n data = df_spacebar_ref,\n family = lognormal(),\n prior = c(prior(normal(6, 1.5), class = Intercept),\n prior(normal(0, 1), class = sigma),\n prior(normal(0, 1), class = b, coef = c_trial)),\n sample_prior = \"only\",\n control = list(adapt_delta = .9))\n```", "```r\nmedian_diff <-  function(x) {\n median(x -  lag(x), na.rm = TRUE)\n}\npp_check(fit_prior_press_trial,\n type = \"stat\",\n stat = \"median_diff\",\n # show only prior predictive distributions \n prefix = \"ppd\",\n # each bin has a width of 500 ms \n binwidth = 500) +\n # cut the top of the plot to improve its scale\n coord_cartesian(ylim = c(0, 50))\n```", "```r\nfit_press_trial <-\n brm(t ~  1 +  c_trial,\n data = df_spacebar,\n family = lognormal(),\n prior = c(prior(normal(6, 1.5), class = Intercept),\n prior(normal(0, 1), class = sigma),\n prior(normal(0, 0.01), class = b, coef = c_trial)))\n```", "```r\nposterior_summary(fit_press_trial,\n variable = c(\"b_Intercept\",\n \"b_c_trial\",\n \"sigma\"))\n```", "```r\n##             Estimate Est.Error     Q2.5    Q97.5\n## b_Intercept 5.118340 0.0064256 5.105460 5.130953\n## b_c_trial   0.000524 0.0000616 0.000399 0.000646\n## sigma       0.123360 0.0046777 0.114539 0.132888\n```", "```r\nplot(fit_press_trial)\n```", "```r\nalpha_samples <-  as_draws_df(fit_press_trial)$b_Intercept\nbeta_samples <-  as_draws_df(fit_press_trial)$b_c_trial\neffect_middle_ms <-  exp(alpha_samples) -\n exp(alpha_samples -  1 *  beta_samples)\n## ms effect in the middle of the expt\n## (mean trial vs. mean trial - 1)\nc(mean = mean(effect_middle_ms),\n quantile(effect_middle_ms, c(0.025, 0.975)))\n```", "```r\n##   mean   2.5%  97.5% \n## 0.0875 0.0668 0.1075\n```", "```r\nfirst_trial <-  min(df_spacebar$c_trial)\nsecond_trial <-  min(df_spacebar$c_trial) +  1\neffect_beginning_ms <-\n exp(alpha_samples +  second_trial *  beta_samples) -\n exp(alpha_samples +  first_trial *  beta_samples)\n## ms effect from first to second trial:\nc(mean = mean(effect_beginning_ms),\n quantile(effect_beginning_ms, c(0.025, 0.975)))\n```", "```r\n##   mean   2.5%  97.5% \n## 0.0796 0.0622 0.0958\n```", "```r\nnewdata_1 <-  data.frame(c_trial = c(first_trial, second_trial))\n```", "```r\nbeginning <-  fitted(fit_press_trial,\n newdata = newdata_1,\n summary = FALSE)\nhead(beginning, 3)\n```", "```r\n##      [,1] [,2]\n## [1,]  157  157\n## [2,]  153  153\n## [3,]  153  153\n```", "```r\neffect_beginning_ms <-  beginning[, 2] -  beginning[,1]\nc(mean = mean(effect_beginning_ms),\n quantile(effect_beginning_ms, c(0.025, 0.975)))\n```", "```r\n##   mean   2.5%  97.5% \n## 0.0802 0.0626 0.0966\n```", "```r\neffect_100 <-\n exp(alpha_samples +  100 *  beta_samples) -\n exp(alpha_samples)\nc(mean = mean(effect_100),\n quantile(effect_100, c(0.025, 0.975)))\n```", "```r\n##  mean  2.5% 97.5% \n##  8.99  6.81 11.11\n```", "```r\nmedian_diff100 <-  function(x) median(x -  lag(x, 100), na.rm = TRUE)\npp_check(fit_press_trial,\n type = \"stat\",\n stat = \"median_diff100\")\n```", "```r\ndata(\"df_recall\")\ndf_recall <-  df_recall %>%\n mutate(c_set_size = set_size -  mean(set_size))\n# Set sizes in the data set:\ndf_recall$set_size %>%\n unique() %>%  sort()\n```", "```r\n## [1] 2 4 6 8\n```", "```r\n# Trials by set size\ndf_recall %>%\n group_by(set_size) %>%\n count()\n```", "```r\n## # A tibble: 4 × 2\n## # Groups:   set_size [4]\n##   set_size     n\n##      <int> <int>\n## 1        2    23\n## 2        4    23\n## 3        6    23\n## # ℹ 1 more row\n```", "```r\ndf_recall\n```", "```r\n## # A tibble: 92 × 8\n##   subj  set_size correct trial session block tested c_set_size\n##   <chr>    <int>   <int> <int>   <int> <int>  <int>      <dbl>\n## 1 10           4       1     1       1     1      2         -1\n## 2 10           8       0     4       1     1      8          3\n## 3 10           2       1     9       1     1      2         -3\n## # ℹ 89 more rows\n```", "```r\nrbern(10, prob = 0.5)\n```", "```r\n##  [1] 0 1 1 1 0 0 1 0 0 1\n```", "```r\nsamples_log_odds <-  tibble(log_odds = rnorm(100000, 0, 4))\nsamples_p <-  tibble(p = plogis(rnorm(100000, 0, 4)))\nggplot(samples_log_odds, aes(log_odds)) +\n geom_density()\nggplot(samples_p, aes(p)) +\n geom_density()\n```", "```r\nfit_recall <-\n brm(correct ~  1 +  c_set_size,\n data = df_recall,\n family = bernoulli(link = logit),\n prior = c(prior(normal(0, 1.5), class = Intercept),\n prior(normal(0, 0.1), class = b, coef = c_set_size)))\n```", "```r\nposterior_summary(fit_recall,\n variable = c(\"b_Intercept\", \"b_c_set_size\"))\n```", "```r\n##              Estimate Est.Error   Q2.5   Q97.5\n## b_Intercept     1.934    0.3145  1.345  2.5808\n## b_c_set_size   -0.188    0.0852 -0.353 -0.0205\n```", "```r\nplot(fit_recall)\n```", "```r\nalpha_samples <-  as_draws_df(fit_recall)$b_Intercept\nav_accuracy <-  plogis(alpha_samples)\nc(mean = mean(av_accuracy), quantile(av_accuracy, c(0.025, 0.975)))\n```", "```r\n##  mean  2.5% 97.5% \n## 0.870 0.793 0.930\n```", "```r\nbeta_samples <-  as_draws_df(fit_recall)$b_c_set_size\neffect_middle <-  plogis(alpha_samples) -\n plogis(alpha_samples -  beta_samples)\nc(mean = mean(effect_middle),\n quantile(effect_middle, c(0.025, 0.975)))\n```", "```r\n##     mean     2.5%    97.5% \n## -0.01910 -0.03746 -0.00236\n```", "```r\nfour <-  4 -  mean(df_recall$set_size)\ntwo <-  2 -  mean(df_recall$set_size)\neffect_4m2 <-\n plogis(alpha_samples +  four *  beta_samples) -\n plogis(alpha_samples +  two *  beta_samples)\nc(mean = mean(effect_4m2), \n quantile(effect_4m2, c(0.025, 0.975)))\n```", "```r\n##     mean     2.5%    97.5% \n## -0.02963 -0.05429 -0.00461\n```", "```r\nfitted(fit_recall,\n newdata = data.frame(c_set_size = 0),\n summary = TRUE)[,c(\"Estimate\", \"Q2.5\",\"Q97.5\")]\n```", "```r\n## Estimate     Q2.5    Q97.5 \n##    0.870    0.793    0.930\n```", "```r\nnew_sets <-  data.frame(c_set_size = c(0, -1, four, two))\nset_sizes <-  fitted(fit_recall,\n newdata = new_sets,\n summary = FALSE)\n```", "```r\neffect_middle <-  set_sizes[, 1] -  set_sizes[, 2] \neffect_4m2 <-  set_sizes[, 3] -  set_sizes[, 4] \n```", "```r\nc(mean = mean(effect_middle), quantile(effect_middle, \n c(0.025, 0.975)))\n```", "```r\n##     mean     2.5%    97.5% \n## -0.01910 -0.03746 -0.00236\n```", "```r\nc(mean = mean(effect_4m2), quantile(effect_4m2, \n c(0.025, 0.975)))\n```", "```r\n##     mean     2.5%    97.5% \n## -0.02963 -0.05429 -0.00461\n```", "```r\ndf_recall_ext <-  df_recall %>%\n bind_rows(tibble(set_size = rep(c(3, 5, 7), 23),\n c_set_size = set_size -\n mean(df_recall$set_size),\n correct = 0))\n# nicer label for the facets:\nset_size <-  paste(\"set size\", 2:8) %>%\n setNames(-3:3)\npp_check(fit_recall,\n type = \"stat_grouped\",\n stat = \"mean\",\n group = \"c_set_size\",\n newdata = df_recall_ext,\n facet_args = list(ncol = 1, scales = \"fixed\",\n labeller = as_labeller(set_size)),\n binwidth = 0.02)\n```"]