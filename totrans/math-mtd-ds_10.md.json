["```py\ndata = pd.read_csv('advertising.csv')\ndata.head() \n```", "```py\nTV = data['TV'].to_numpy()\nsales = data['sales'].to_numpy() \n```", "```py\nplt.scatter(TV, sales, s=5, c='k')\nplt.xlabel('TV'), plt.ylabel('sales')\nplt.show() \n```", "```py\ndef knnregression(x,y,k,xnew):\n    n = len(x)\n    closest = np.argsort([np.absolute(x[i]-xnew) for i in range(n)])\n    return np.mean(y[closest[0:k]]) \n```", "```py\nk = 3\nxgrid = np.linspace(TV.min(), TV.max(), num=1000)\nyhat = [knnregression(TV,sales,k,xnew) for xnew in xgrid]\n\nplt.scatter(TV, sales, s=5, c='b', alpha=0.5)\nplt.plot(xgrid, yhat, 'r')\nplt.xlabel('TV'), plt.ylabel('sales')\nplt.show() \n```", "```py\nk = 10\nxgrid = np.linspace(TV.min(), TV.max(), num=1000)\nyhat = [knnregression(TV,sales,k,xnew) for xnew in xgrid]\n\nplt.scatter(TV, sales, s=5, c='b', alpha=0.5)\nplt.plot(xgrid, yhat, 'r')\nplt.xlabel('TV'), plt.ylabel('sales')\nplt.show() \n```"]