["```py\nG_tree = nx.random_labeled_tree(n=6, seed=111)\n\nnx.draw_networkx(G_tree, pos=nx.circular_layout(G_tree), \n                 node_color='black', font_color='white')\nplt.axis('off')\nplt.show() \n```", "```py\nphi_G = 1/3\nmax_deg = 3 \n```", "```py\nL_tree = nx.laplacian_matrix(G_tree).toarray()\nprint(L_tree) \n```", "```py\n[[ 1 -1  0  0  0  0]\n [-1  3  0 -1  0 -1]\n [ 0  0  2 -1 -1  0]\n [ 0 -1 -1  2  0  0]\n [ 0  0 -1  0  1  0]\n [ 0 -1  0  0  0  1]] \n```", "```py\nw, v = LA.eigh(L_tree) \nmu_2 = np.sort(w)[1]\nprint(mu_2) \n```", "```py\n0.32486912943335317 \n```", "```py\n(phi_G ** 2) / (2 * max_deg) \n```", "```py\n0.018518518518518517 \n```", "```py\n2 * phi_G \n```", "```py\n0.6666666666666666 \n```", "```py\ndef cut_ratio(A, order, k):\n\n    n = A.shape[0]\n    edge_boundary = 0\n    for i in range(k+1):\n        for j in range(k+1,n):\n            edge_boundary += A[order[i],order[j]]\n\n    denominator = np.minimum(k+1, n-k-1)\n\n    return edge_boundary/denominator \n```", "```py\ndef spectral_cut2(A):\n    n = A.shape[0]\n\n    degrees = A.sum(axis=1)\n    D = np.diag(degrees)\n    L = D - A\n    w, v = LA.eigh(L) \n    order = np.argsort(v[:,np.argsort(w)[1]])\n\n    phi = np.zeros(n-1)\n    for k in range(n-1):\n        phi[k] = cut_ratio(A, order, k)\n    imin = np.argmin(phi)\n\n    return order[0:imin+1], order[imin+1:n] \n```", "```py\ndef viz_cut(G, s, pos, node_size=100, with_labels=False):\n    n = G.number_of_nodes()\n    assign = np.zeros(n)\n    assign[s] = 1\n    nx.draw(G, node_color=assign, pos=pos, with_labels=with_labels, \n            cmap='spring', node_size=node_size, font_color='k')\n    plt.show() \n```", "```py\nn = 10\nG = nx.path_graph(n)\n\nnx.draw_networkx(G, pos=nx.spectral_layout(G), \n                 node_color='black', font_color='white')\nplt.axis('off')\nplt.show() \n```", "```py\nA = nx.adjacency_matrix(G).toarray()\ns, sc = spectral_cut2(A)\nprint(s)\nprint(sc) \n```", "```py\n[0 1 2 3 4]\n[5 6 7 8 9] \n```", "```py\npos = nx.spectral_layout(G)\nviz_cut(G, s, pos) \n```", "```py\nG = nx.grid_2d_graph(4,7)\nA = nx.adjacency_matrix(G).toarray()\ns, sc = spectral_cut2(A)\npos = nx.spectral_layout(G)\nviz_cut(G, s, pos) \n```", "```py\nG = nx.karate_club_graph()\nn = G.number_of_nodes()\nA = nx.adjacency_matrix(G).toarray() \n```", "```py\ns, sc = spectral_cut2(A)\nprint(s)\nprint(sc) \n```", "```py\n[18 26 20 14 29 22 24 15 23 25 32 27  9 33 31 28 30  8]\n[ 2 13  1 19  7  3 12  0 21 17 11  4 10  6  5 16] \n```", "```py\nplt.figure(figsize=(6,6))\npos = nx.spring_layout(G, k=0.7, iterations=50, seed=42)\nviz_cut(G, s, pos, node_size=300, with_labels=True) \n```", "```py\ntruth = np.array([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, \n                  0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])\ns_truth = np.nonzero(truth)\nplt.figure(figsize=(6,6))\nviz_cut(G, s_truth, pos, node_size=300, with_labels=True) \n```", "```py\nG_tree = nx.random_labeled_tree(n=6, seed=111)\n\nnx.draw_networkx(G_tree, pos=nx.circular_layout(G_tree), \n                 node_color='black', font_color='white')\nplt.axis('off')\nplt.show() \n```", "```py\nphi_G = 1/3\nmax_deg = 3 \n```", "```py\nL_tree = nx.laplacian_matrix(G_tree).toarray()\nprint(L_tree) \n```", "```py\n[[ 1 -1  0  0  0  0]\n [-1  3  0 -1  0 -1]\n [ 0  0  2 -1 -1  0]\n [ 0 -1 -1  2  0  0]\n [ 0  0 -1  0  1  0]\n [ 0 -1  0  0  0  1]] \n```", "```py\nw, v = LA.eigh(L_tree) \nmu_2 = np.sort(w)[1]\nprint(mu_2) \n```", "```py\n0.32486912943335317 \n```", "```py\n(phi_G ** 2) / (2 * max_deg) \n```", "```py\n0.018518518518518517 \n```", "```py\n2 * phi_G \n```", "```py\n0.6666666666666666 \n```", "```py\ndef cut_ratio(A, order, k):\n\n    n = A.shape[0]\n    edge_boundary = 0\n    for i in range(k+1):\n        for j in range(k+1,n):\n            edge_boundary += A[order[i],order[j]]\n\n    denominator = np.minimum(k+1, n-k-1)\n\n    return edge_boundary/denominator \n```", "```py\ndef spectral_cut2(A):\n    n = A.shape[0]\n\n    degrees = A.sum(axis=1)\n    D = np.diag(degrees)\n    L = D - A\n    w, v = LA.eigh(L) \n    order = np.argsort(v[:,np.argsort(w)[1]])\n\n    phi = np.zeros(n-1)\n    for k in range(n-1):\n        phi[k] = cut_ratio(A, order, k)\n    imin = np.argmin(phi)\n\n    return order[0:imin+1], order[imin+1:n] \n```", "```py\ndef viz_cut(G, s, pos, node_size=100, with_labels=False):\n    n = G.number_of_nodes()\n    assign = np.zeros(n)\n    assign[s] = 1\n    nx.draw(G, node_color=assign, pos=pos, with_labels=with_labels, \n            cmap='spring', node_size=node_size, font_color='k')\n    plt.show() \n```", "```py\nn = 10\nG = nx.path_graph(n)\n\nnx.draw_networkx(G, pos=nx.spectral_layout(G), \n                 node_color='black', font_color='white')\nplt.axis('off')\nplt.show() \n```", "```py\nA = nx.adjacency_matrix(G).toarray()\ns, sc = spectral_cut2(A)\nprint(s)\nprint(sc) \n```", "```py\n[0 1 2 3 4]\n[5 6 7 8 9] \n```", "```py\npos = nx.spectral_layout(G)\nviz_cut(G, s, pos) \n```", "```py\nG = nx.grid_2d_graph(4,7)\nA = nx.adjacency_matrix(G).toarray()\ns, sc = spectral_cut2(A)\npos = nx.spectral_layout(G)\nviz_cut(G, s, pos) \n```", "```py\nG = nx.karate_club_graph()\nn = G.number_of_nodes()\nA = nx.adjacency_matrix(G).toarray() \n```", "```py\ns, sc = spectral_cut2(A)\nprint(s)\nprint(sc) \n```", "```py\n[18 26 20 14 29 22 24 15 23 25 32 27  9 33 31 28 30  8]\n[ 2 13  1 19  7  3 12  0 21 17 11  4 10  6  5 16] \n```", "```py\nplt.figure(figsize=(6,6))\npos = nx.spring_layout(G, k=0.7, iterations=50, seed=42)\nviz_cut(G, s, pos, node_size=300, with_labels=True) \n```", "```py\ntruth = np.array([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, \n                  0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])\ns_truth = np.nonzero(truth)\nplt.figure(figsize=(6,6))\nviz_cut(G, s_truth, pos, node_size=300, with_labels=True) \n```"]