- en: Point-Edge Distance
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 点-边距离
- en: 原文：[https://phys-sim-book.github.io/lec21.2-point_edge_dist.html](https://phys-sim-book.github.io/lec21.2-point_edge_dist.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec21.2-point_edge_dist.html](https://phys-sim-book.github.io/lec21.2-point_edge_dist.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: Next, we calculate the point-edge distance and its derivatives. These will be
    used to solve for the contact forces. For a node p and an edge e0​e1​, their squared
    distance is defined as
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们计算点-边距离及其导数。这些将被用于求解接触力。对于一个节点p和一个边e0e1，它们的平方距离定义为
- en: dsqPE​(p,e0​,e1​)=λmin​∥p−((1−λ)e0​+λe1​)∥2s.t.λ∈[0,1],
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: dsqPE(p,e0,e1)=λmin∥p−((1−λ)e0+λe1)∥2s.t.λ∈[0,1],
- en: which is the closest squared distance between p and any point on e0​e1​.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 这是p和e0e1上任意点之间的最近平方距离。
- en: '***Remark 21.2.1 (Distance Calculation Optimization).*** Here, we use the squared
    unsigned distances for evaluating the contact energies. This approach avoids taking
    square roots, which can complicate the expression of the derivatives and increase
    numerical rounding errors during computation. Additionally, unsigned distances
    can be directly extended for codimensional pairs, such as point-point pairs, which
    are useful when simulating particle contacts in 2D. They also do not suffer from
    locking issues, as signed distances do, when there are large displacements.'
  id: totrans-6
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '***备注21.2.1（距离计算优化）***。在这里，我们使用平方无符号距离来评估接触能。这种方法避免了取平方根，这可能会使导数的表达式复杂化，并在计算过程中增加数值舍入误差。此外，无符号距离可以直接扩展到共维数对，例如点-点对，这在模拟二维中的粒子接触时很有用。它们也不像有符号距离那样在有大位移时出现锁定问题。'
- en: 'Fortunately, dsqPE​(p,e0​,e1​) is a piece-wise smooth function w.r.t. the DOFs:
    dsqPE​(p,e0​,e1​)=⎩⎨⎧​∥p−e0​∥2if (e1​−e0​)⋅(p−e0​)<0,∥p−e1​∥2if (e1​−e0​)⋅(p−e0​)>∥e1​−e0​∥2,∥e1​−e0​∥21​(det([p−e0​,e1​−e0​]))2otherwise,​(21.2.1)
    where the smooth expression can be determined by checking whether the node is
    inside the orthogonal span of the edge. Given these smooth expressions, we can
    differentiate each of them and obtain the derivatives of the point-edge distance
    function. The implementations are as follows:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 幸运的是，dsqPE(p,e0,e1)相对于自由度（DOFs）是一个分段光滑函数：dsqPE(p,e0,e1)=⎩⎨⎧∥p−e0∥2if (e1−e0)⋅(p−e0)<0,∥p−e1∥2if
    (e1−e0)⋅(p−e0)>∥e1−e0∥2,∥e1−e0∥21(det([p−e0,e1−e0]))2otherwise,​(21.2.1) 其中，平滑表达式可以通过检查节点是否位于边的正交补中来确定。有了这些平滑表达式，我们可以对每个表达式进行微分，从而获得点-边距离函数的导数。实现如下：
- en: '**Implementation 21.2.1 (Point-Edge distance calculation (Hessian omitted),
    PointEdgeDistance.py).**'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现21.2.1（点-边距离计算（省略Hessian），PointEdgeDistance.py）**。'
- en: '[PRE0]'
  id: totrans-9
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'It can be verified that the point-edge distance function is C1-continuous everywhere,
    including at the interfaces between different segments. For the point-point case,
    we have:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 可以验证，点-边距离函数在所有地方都是C1-连续的，包括不同段之间的接口。对于点-点情况，我们有：
- en: '**Implementation 21.2.2 (Point-Point distance calculation, PointPointDistance.py).**'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现21.2.2（点-点距离计算，PointPointDistance.py）**。'
- en: '[PRE1]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: For the point-line case, the distance evaluations can be implemented as follows,
    and the derivatives can be obtained using symbolic differentiation tools.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 对于点-线情况，距离评估可以按以下方式实现，导数可以使用符号微分工具获得。
- en: '**Implementation 21.2.3 (Point-Line distance calculation (Hessian omitted),
    PointLineDistance.py).**'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现21.2.3（点-线距离计算（省略Hessian），PointLineDistance.py）**。'
- en: '[PRE2]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
