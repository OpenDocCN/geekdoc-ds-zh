- en: Point-Edge Distance
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec21.2-point_edge_dist.html](https://phys-sim-book.github.io/lec21.2-point_edge_dist.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: Next, we calculate the point-edge distance and its derivatives. These will be
    used to solve for the contact forces. For a node p and an edge e0​e1​, their squared
    distance is defined as
  prefs: []
  type: TYPE_NORMAL
- en: dsqPE​(p,e0​,e1​)=λmin​∥p−((1−λ)e0​+λe1​)∥2s.t.λ∈[0,1],
  prefs: []
  type: TYPE_NORMAL
- en: which is the closest squared distance between p and any point on e0​e1​.
  prefs: []
  type: TYPE_NORMAL
- en: '***Remark 21.2.1 (Distance Calculation Optimization).*** Here, we use the squared
    unsigned distances for evaluating the contact energies. This approach avoids taking
    square roots, which can complicate the expression of the derivatives and increase
    numerical rounding errors during computation. Additionally, unsigned distances
    can be directly extended for codimensional pairs, such as point-point pairs, which
    are useful when simulating particle contacts in 2D. They also do not suffer from
    locking issues, as signed distances do, when there are large displacements.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Fortunately, dsqPE​(p,e0​,e1​) is a piece-wise smooth function w.r.t. the DOFs:
    dsqPE​(p,e0​,e1​)=⎩⎨⎧​∥p−e0​∥2if (e1​−e0​)⋅(p−e0​)<0,∥p−e1​∥2if (e1​−e0​)⋅(p−e0​)>∥e1​−e0​∥2,∥e1​−e0​∥21​(det([p−e0​,e1​−e0​]))2otherwise,​(21.2.1)
    where the smooth expression can be determined by checking whether the node is
    inside the orthogonal span of the edge. Given these smooth expressions, we can
    differentiate each of them and obtain the derivatives of the point-edge distance
    function. The implementations are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 21.2.1 (Point-Edge distance calculation (Hessian omitted),
    PointEdgeDistance.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'It can be verified that the point-edge distance function is C1-continuous everywhere,
    including at the interfaces between different segments. For the point-point case,
    we have:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 21.2.2 (Point-Point distance calculation, PointPointDistance.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: For the point-line case, the distance evaluations can be implemented as follows,
    and the derivatives can be obtained using symbolic differentiation tools.
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 21.2.3 (Point-Line distance calculation (Hessian omitted),
    PointLineDistance.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
