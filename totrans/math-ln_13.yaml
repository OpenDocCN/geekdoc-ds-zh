- en: 13\. Integration and Measure Theory
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://leanprover-community.github.io/mathematics_in_lean/C13_Integration_and_Measure_Theory.html](https://leanprover-community.github.io/mathematics_in_lean/C13_Integration_and_Measure_Theory.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '*[Mathematics in Lean](index.html)* **   13\. Integration and Measure Theory'
  prefs: []
  type: TYPE_NORMAL
- en: '[View page source](_sources/C13_Integration_and_Measure_Theory.rst.txt)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: '## 13.1\. Elementary Integration[](#elementary-integration "Link to this heading")'
  prefs: []
  type: TYPE_NORMAL
- en: We first focus on integration of functions on finite intervals in `ℝ`. We can
    integrate elementary functions.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: The fundamental theorem of calculus relates integration and differentiation.
    Below we give simplified statements of the two parts of this theorem. The first
    part says that integration provides an inverse to differentiation and the second
    one specifies how to compute integrals of derivatives. (These two parts are very
    closely related, but their optimal versions, which are not shown here, are not
    equivalent.)
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Convolution is also defined in Mathlib and its basic properties are proved.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]  ## 13.2\. Measure Theory[](#measure-theory "Link to this heading")'
  prefs: []
  type: TYPE_NORMAL
- en: The general context for integration in Mathlib is measure theory. Even the elementary
    integrals of the previous section are in fact Bochner integrals. Bochner integration
    is a generalization of Lebesgue integration where the target space can be any
    Banach space, not necessarily finite dimensional.
  prefs: []
  type: TYPE_NORMAL
- en: The first component in the development of measure theory is the notion of a
    \(\sigma\)-algebra of sets, which are called the *measurable* sets. The type class
    `MeasurableSpace` serves to equip a type with such a structure. The sets `empty`
    and `univ` are measurable, the complement of a measurable set is measurable, and
    a countable union or intersection of measurable sets is measurable. Note that
    these axioms are redundant; if you `#print MeasurableSpace`, you will see the
    ones that Mathlib uses. As the examples below show, countability assumptions can
    be expressed using the `Encodable` type class.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Once a type is measurable, we can measure it. On paper, a measure on a set (or
    type) equipped with a \(\sigma\)-algebra is a function from the measurable sets
    to the extended non-negative reals that is additive on countable disjoint unions.
    In Mathlib, we don’t want to carry around measurability assumptions every time
    we write an application of the measure to a set. So we extend the measure to any
    set `s` as the infimum of measures of measurable sets containing `s`. Of course,
    many lemmas still require measurability assumptions, but not all.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: Once a type has a measure associated with it, we say that a property `P` holds
    *almost everywhere* if the set of elements where the property fails has measure
    0. The collection of properties that hold almost everywhere form a filter, but
    Mathlib introduces special notation for saying that a property holds almost everywhere.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]  ## 13.3\. Integration[](#integration "Link to this heading")'
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have measurable spaces and measures we can consider integrals. As
    explained above, Mathlib uses a very general notion of integration that allows
    any Banach space as the target. As usual, we don’t want our notation to carry
    around assumptions, so we define integration in such a way that an integral is
    equal to zero if the function in question is not integrable. Most lemmas having
    to do with integrals have integrability assumptions.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'As an example of the complex interactions between our various conventions,
    let us see how to integrate constant functions. Recall that a measure `μ` takes
    values in `ℝ≥0∞`, the type of extended non-negative reals. There is a function
    `ENNReal.toReal : ℝ≥0∞ → ℝ` which sends `⊤`, the point at infinity, to zero. For
    any `s : Set α`, if `μ s = ⊤`, then nonzero constant functions are not integrable
    on `s`. In that case, their integrals are equal to zero by definition, as is `(μ
    s).toReal`. So in all cases we have the following lemma.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: We now quickly explain how to access the most important theorems in integration
    theory, starting with the dominated convergence theorem. There are several versions
    in Mathlib, and here we only show the most basic one.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: Then we have Fubini’s theorem for integrals on product type.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: There is a very general version of convolution that applies to any continuous
    bilinear form.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: Finally, Mathlib has a very general version of the change-of-variables formula.
    In the statement below, `BorelSpace E` means the \(\sigma\)-algebra on `E` is
    generated by the open sets of `E`, and `IsAddHaarMeasure μ` means that the measure
    `μ` is left-invariant, gives finite mass to compact sets, and give positive mass
    to open sets.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11] [Previous](C12_Differential_Calculus.html "12\. Differential Calculus")
    [Next](genindex.html "Index")'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: © Copyright 2020-2025, Jeremy Avigad, Patrick Massot. Text licensed under CC
    BY 4.0.
  prefs: []
  type: TYPE_NORMAL
- en: 'Built with [Sphinx](https://www.sphinx-doc.org/) using a [theme](https://github.com/readthedocs/sphinx_rtd_theme)
    provided by [Read the Docs](https://readthedocs.org). ## 13.1\. Elementary Integration[](#elementary-integration
    "Link to this heading")'
  prefs: []
  type: TYPE_NORMAL
- en: We first focus on integration of functions on finite intervals in `ℝ`. We can
    integrate elementary functions.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: The fundamental theorem of calculus relates integration and differentiation.
    Below we give simplified statements of the two parts of this theorem. The first
    part says that integration provides an inverse to differentiation and the second
    one specifies how to compute integrals of derivatives. (These two parts are very
    closely related, but their optimal versions, which are not shown here, are not
    equivalent.)
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: Convolution is also defined in Mathlib and its basic properties are proved.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]  ## 13.2\. Measure Theory[](#measure-theory "Link to this heading")'
  prefs: []
  type: TYPE_NORMAL
- en: The general context for integration in Mathlib is measure theory. Even the elementary
    integrals of the previous section are in fact Bochner integrals. Bochner integration
    is a generalization of Lebesgue integration where the target space can be any
    Banach space, not necessarily finite dimensional.
  prefs: []
  type: TYPE_NORMAL
- en: The first component in the development of measure theory is the notion of a
    \(\sigma\)-algebra of sets, which are called the *measurable* sets. The type class
    `MeasurableSpace` serves to equip a type with such a structure. The sets `empty`
    and `univ` are measurable, the complement of a measurable set is measurable, and
    a countable union or intersection of measurable sets is measurable. Note that
    these axioms are redundant; if you `#print MeasurableSpace`, you will see the
    ones that Mathlib uses. As the examples below show, countability assumptions can
    be expressed using the `Encodable` type class.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: Once a type is measurable, we can measure it. On paper, a measure on a set (or
    type) equipped with a \(\sigma\)-algebra is a function from the measurable sets
    to the extended non-negative reals that is additive on countable disjoint unions.
    In Mathlib, we don’t want to carry around measurability assumptions every time
    we write an application of the measure to a set. So we extend the measure to any
    set `s` as the infimum of measures of measurable sets containing `s`. Of course,
    many lemmas still require measurability assumptions, but not all.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: Once a type has a measure associated with it, we say that a property `P` holds
    *almost everywhere* if the set of elements where the property fails has measure
    0. The collection of properties that hold almost everywhere form a filter, but
    Mathlib introduces special notation for saying that a property holds almost everywhere.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]  ## 13.3\. Integration[](#integration "Link to this heading")'
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have measurable spaces and measures we can consider integrals. As
    explained above, Mathlib uses a very general notion of integration that allows
    any Banach space as the target. As usual, we don’t want our notation to carry
    around assumptions, so we define integration in such a way that an integral is
    equal to zero if the function in question is not integrable. Most lemmas having
    to do with integrals have integrability assumptions.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: 'As an example of the complex interactions between our various conventions,
    let us see how to integrate constant functions. Recall that a measure `μ` takes
    values in `ℝ≥0∞`, the type of extended non-negative reals. There is a function
    `ENNReal.toReal : ℝ≥0∞ → ℝ` which sends `⊤`, the point at infinity, to zero. For
    any `s : Set α`, if `μ s = ⊤`, then nonzero constant functions are not integrable
    on `s`. In that case, their integrals are equal to zero by definition, as is `(μ
    s).toReal`. So in all cases we have the following lemma.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: We now quickly explain how to access the most important theorems in integration
    theory, starting with the dominated convergence theorem. There are several versions
    in Mathlib, and here we only show the most basic one.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: Then we have Fubini’s theorem for integrals on product type.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: There is a very general version of convolution that applies to any continuous
    bilinear form.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: Finally, Mathlib has a very general version of the change-of-variables formula.
    In the statement below, `BorelSpace E` means the \(\sigma\)-algebra on `E` is
    generated by the open sets of `E`, and `IsAddHaarMeasure μ` means that the measure
    `μ` is left-invariant, gives finite mass to compact sets, and give positive mass
    to open sets.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE23]  ## 13.1\. Elementary Integration[](#elementary-integration "Link
    to this heading")'
  prefs: []
  type: TYPE_NORMAL
- en: We first focus on integration of functions on finite intervals in `ℝ`. We can
    integrate elementary functions.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE24]'
  prefs: []
  type: TYPE_PRE
- en: The fundamental theorem of calculus relates integration and differentiation.
    Below we give simplified statements of the two parts of this theorem. The first
    part says that integration provides an inverse to differentiation and the second
    one specifies how to compute integrals of derivatives. (These two parts are very
    closely related, but their optimal versions, which are not shown here, are not
    equivalent.)
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE25]'
  prefs: []
  type: TYPE_PRE
- en: Convolution is also defined in Mathlib and its basic properties are proved.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE26]'
  prefs: []
  type: TYPE_PRE
- en: '## 13.2\. Measure Theory[](#measure-theory "Link to this heading")'
  prefs: []
  type: TYPE_NORMAL
- en: The general context for integration in Mathlib is measure theory. Even the elementary
    integrals of the previous section are in fact Bochner integrals. Bochner integration
    is a generalization of Lebesgue integration where the target space can be any
    Banach space, not necessarily finite dimensional.
  prefs: []
  type: TYPE_NORMAL
- en: The first component in the development of measure theory is the notion of a
    \(\sigma\)-algebra of sets, which are called the *measurable* sets. The type class
    `MeasurableSpace` serves to equip a type with such a structure. The sets `empty`
    and `univ` are measurable, the complement of a measurable set is measurable, and
    a countable union or intersection of measurable sets is measurable. Note that
    these axioms are redundant; if you `#print MeasurableSpace`, you will see the
    ones that Mathlib uses. As the examples below show, countability assumptions can
    be expressed using the `Encodable` type class.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE27]'
  prefs: []
  type: TYPE_PRE
- en: Once a type is measurable, we can measure it. On paper, a measure on a set (or
    type) equipped with a \(\sigma\)-algebra is a function from the measurable sets
    to the extended non-negative reals that is additive on countable disjoint unions.
    In Mathlib, we don’t want to carry around measurability assumptions every time
    we write an application of the measure to a set. So we extend the measure to any
    set `s` as the infimum of measures of measurable sets containing `s`. Of course,
    many lemmas still require measurability assumptions, but not all.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE28]'
  prefs: []
  type: TYPE_PRE
- en: Once a type has a measure associated with it, we say that a property `P` holds
    *almost everywhere* if the set of elements where the property fails has measure
    0. The collection of properties that hold almost everywhere form a filter, but
    Mathlib introduces special notation for saying that a property holds almost everywhere.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE29]'
  prefs: []
  type: TYPE_PRE
- en: '## 13.3\. Integration[](#integration "Link to this heading")'
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have measurable spaces and measures we can consider integrals. As
    explained above, Mathlib uses a very general notion of integration that allows
    any Banach space as the target. As usual, we don’t want our notation to carry
    around assumptions, so we define integration in such a way that an integral is
    equal to zero if the function in question is not integrable. Most lemmas having
    to do with integrals have integrability assumptions.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE30]'
  prefs: []
  type: TYPE_PRE
- en: 'As an example of the complex interactions between our various conventions,
    let us see how to integrate constant functions. Recall that a measure `μ` takes
    values in `ℝ≥0∞`, the type of extended non-negative reals. There is a function
    `ENNReal.toReal : ℝ≥0∞ → ℝ` which sends `⊤`, the point at infinity, to zero. For
    any `s : Set α`, if `μ s = ⊤`, then nonzero constant functions are not integrable
    on `s`. In that case, their integrals are equal to zero by definition, as is `(μ
    s).toReal`. So in all cases we have the following lemma.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE31]'
  prefs: []
  type: TYPE_PRE
- en: We now quickly explain how to access the most important theorems in integration
    theory, starting with the dominated convergence theorem. There are several versions
    in Mathlib, and here we only show the most basic one.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE32]'
  prefs: []
  type: TYPE_PRE
- en: Then we have Fubini’s theorem for integrals on product type.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE33]'
  prefs: []
  type: TYPE_PRE
- en: There is a very general version of convolution that applies to any continuous
    bilinear form.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE34]'
  prefs: []
  type: TYPE_PRE
- en: Finally, Mathlib has a very general version of the change-of-variables formula.
    In the statement below, `BorelSpace E` means the \(\sigma\)-algebra on `E` is
    generated by the open sets of `E`, and `IsAddHaarMeasure μ` means that the measure
    `μ` is left-invariant, gives finite mass to compact sets, and give positive mass
    to open sets.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE35]*'
  prefs: []
  type: TYPE_NORMAL
