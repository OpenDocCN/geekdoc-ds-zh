- en: Gradient-based Optimization
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 基于梯度的优化
- en: 原文：[https://phys-sim-book.github.io/lec3.3-grad_based_opt.html](https://phys-sim-book.github.io/lec3.3-grad_based_opt.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec3.3-grad_based_opt.html](https://phys-sim-book.github.io/lec3.3-grad_based_opt.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: 'The search direction of the standard Newton''s method is calculated by minimizing
    the local quadratic approximation of the objective energy: p=argΔxmin​(E(xi)+ΔxT∇E(xi)+21​ΔxTPΔx)(3.3.1)
    where \(P = \nabla^2 E(x^i)\). In general gradient-based optimization methods,
    \(p\) can be calculated by Equation [(3.3.1)](#eq:lec3:search_direction) with
    any proxy matrix \(P\). Setting \(P = I\) results in \(p = -\nabla E(x^i)\), as
    used in the standard gradient descent method. This approach converges more slowly
    than Newton''s method, as the energy approximation is of a lower order. The closer
    the proxy matrix \(P\) is to the Hessian matrix \(\nabla^2 E(x^i)\), the faster
    the convergence. Hence, using an SPD approximation of the Hessian matrix as the
    proxy ensures that the search direction is always descent, while maintaining a
    convergence rate close to quadratic. This is akin to approximating non-convex
    energies locally using a convex energy proxy.'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 标准牛顿法的搜索方向是通过最小化目标能量的局部二次近似来计算的：p=argΔxmin​(E(xi)+ΔxT∇E(xi)+21​ΔxTPΔx)(3.3.1)
    其中 \(P = \nabla^2 E(x^i)\)。在一般基于梯度的优化方法中，\(p\) 可以通过方程 [(3.3.1)](#eq:lec3:search_direction)
    使用任何代理矩阵 \(P\) 来计算。将 \(P = I\) 设置为 \(p = -\nabla E(x^i)\)，正如在标准梯度下降法中使用的那样。这种方法比牛顿法收敛得慢，因为能量近似是低阶的。代理矩阵
    \(P\) 越接近 Hessian 矩阵 \(\nabla^2 E(x^i)\)，收敛速度越快。因此，使用 Hessian 矩阵的 SPD 近似作为代理，确保搜索方向始终是下降的，同时保持接近二次的收敛速度。这类似于在局部使用凸能量代理来近似非凸能量。
- en: A straightforward method to obtain such an SPD approximation involves first
    projecting \(\nabla^2 E(x^i)\) onto its closest semi-definite matrix by solving
    Pmin​∥P−∇2E(xi)∥F​s.t.vTPv≥0  ∀v=0, and then introducing perturbations to ensure
    that \(P\) is invertible. The solution in this case is \(P = Q \hat{\Lambda} Q^{-1}\),
    where \(P = Q \Lambda Q^{-1}\) is the eigendecomposition, and Λ^ij​=Λij​ if \(\Lambda_{ij}
    > 0\), otherwise \(\hat{\Lambda}_{ij} = 0\). Intuitively, \(P\) is obtained by
    zeroing out all the negative eigenvalues of \(\nabla^2 E(x^i)\).
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 获取这种 SPD 近似的一个直接方法首先是将 \(\nabla^2 E(x^i)\) 投影到其最近的半正定矩阵上，通过求解 Pmin∥P−∇2E(xi)∥F​s.t.vTPv≥0  ∀v=0，然后引入扰动以确保
    \(P\) 是可逆的。在这种情况下，解是 \(P = Q \hat{\Lambda} Q^{-1}\)，其中 \(P = Q \Lambda Q^{-1}\)
    是特征分解，且 \(\hat{\Lambda}_{ij} = \Lambda_{ij}\) 如果 \(\Lambda_{ij} > 0\)，否则 \(\hat{\Lambda}_{ij}
    = 0\)。直观地说，\(P\) 是通过将 \(\nabla^2 E(x^i)\) 的所有负特征值置零来获得的。
- en: '****Definition 3.3.1 (Eigendecomposition).**** The eigendecomposition of a
    square matrix \(A \in \mathbb{R}^{n \times n}\) is A=QΛQ−1 where \(Q = [q_1, q_2,
    ..., q_n]\) is composed of the eigenvectors \(q_i\) of \(A\), ∥qi​∥=1; \(\Lambda
    = [\lambda_1, \lambda_2, ..., \lambda_n]\), with \(\lambda_1 \geq \lambda_2 \geq
    ..., \lambda_n\) being the eigenvalues of \(A\); and \(Aq_i = \lambda_i q_i\).'
  id: totrans-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '****定义 3.3.1 (特征分解).**** 矩阵 \(A \in \mathbb{R}^{n \times n}\) 的特征分解为 A=QΛQ−1，其中
    \(Q = [q_1, q_2, ..., q_n]\) 由 \(A\) 的特征向量 \(q_i\) 组成，∥qi∥=1；\(\Lambda = [\lambda_1,
    \lambda_2, ..., \lambda_n]\)，其中 \(\lambda_1 \geq \lambda_2 \geq ..., \lambda_n\)
    是 \(A\) 的特征值；且 \(Aq_i = \lambda_i q_i\)。'
- en: 'However, in simulation, \(\nabla^2 E(x^i)\) is usually a large sparse matrix,
    and performing eigendecomposition on it would be prohibitively expensive. Fortunately,
    we will discover later in this book that the Incremental Potential in solids simulation
    can be expressed as a separable sum of energies defined on local stencils, such
    as a triangle in the 2D Finite Element Method (FEM) mesh: E(x)=j∑​Ej​(xj1​,xj2​,...),
    where \(\mathbf{x}_{jk}\) are the nodes associated with the energy \(E_j\). Consequently,
    we can conveniently obtain a reasonably good SPD approximation by zeroing out
    the negative eigenvalues of each \(\nabla^2 E_i\) defined on a small number of
    nodes and aggregating them.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，在模拟中，\(\nabla^2 E(x^i)\) 通常是一个大型稀疏矩阵，对其进行特征分解将非常昂贵。幸运的是，我们将在本书的后面发现，在固体模拟中，增量势可以表示为在局部模板上定义的能量之和的可分离总和，例如在二维有限元方法
    (FEM) 网格中的三角形：E(x)=j∑​Ej​(xj1​,xj2​,...)，其中 \(\mathbf{x}_{jk}\) 是与能量 \(E_j\) 相关的节点。因此，我们可以通过将每个在少量节点上定义的
    \(\nabla^2 E_i\) 的负特征值置零，并将它们聚合起来，方便地获得一个相当合理的 SPD 近似。
- en: '****Example 3.3.1 (Local Projection Method).**** To simulate elasticity in
    2D on a triangle mesh with 10,201 nodes and 20,000 triangles, the Hessian matrix
    \(\nabla^2 E(x)\) is \(20,402 \times 20,402\). For the local projection method
    described above, it requires 20,000 eigendecompositions on \(6 \times 6\) matrices.
    Considering the computational complexity of eigendecomposition on an \(n \times
    n\) matrix is worse than \(O(n^2)\), this rough estimation already suggests a
    more than \(500\times\) speedup for this medium-sized problem when employing the
    local projection methods.'
  id: totrans-7
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '****示例3.3.1（局部投影方法）.**** 要在具有10,201个节点和20,000个三角形的三角形网格上模拟2D弹性，Hessian矩阵 \(\nabla^2
    E(x)\) 是 \(20,402 \times 20,402\)。对于上述描述的局部投影方法，它需要在 \(6 \times 6\) 矩阵上进行20,000次特征值分解。考虑到在
    \(n \times n\) 矩阵上特征值分解的计算复杂度比 \(O(n^2)\) 差，这种粗略估计已经表明，当采用局部投影方法时，对于这个中等规模的问题，速度可以提升超过
    \(500\times\)。'
- en: In addition, since the mass matrix in \(\nabla^2 E(x^i)\) is Symmetric Positive
    Definite (SPD) and the sum of SPD matrices remains SPD, there is no need for perturbations
    when projecting other matrices. We now summarize the globally convergent projected
    Newton method for backward Euler time integration in [Algorithm 3.3.1](#alg:lec3:PN_method_IE).
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，由于 \(\nabla^2 E(x^i)\) 中的质量矩阵是对称正定（SPD）的，并且对称正定矩阵的和仍然是SPD，因此在投影其他矩阵时不需要扰动。我们现在总结全局收敛的投影牛顿法在向后Euler时间积分中的[算法3.3.1](#alg:lec3:PN_method_IE)。
- en: '**Algorithm 3.3.1 (Projected Newton Method for Backward Euler Time Integration).**
    ![](../Images/28f589b04982d7e3b4712b1b05a5579d.png)'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '**算法3.3.1（向后Euler时间积分的投影牛顿法）。** ![](../Images/28f589b04982d7e3b4712b1b05a5579d.png)'
- en: '***Remark 3.3.1 (Stopping Criteria).*** From Equation [(3.3.1)](#eq:lec3:search_direction),
    we understand that ∥p∥ can be interpreted as a quadratic approximation of the
    distance from the current estimate \(x^i\) to the optimal solution. Hence, we
    utilize ∥p∥∞​/Δt as a more intuitive measure for the stopping criteria. This approach
    transforms it into a velocity unit and takes the maximum magnitude across every
    node.'
  id: totrans-10
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '***注3.3.1（停止准则）.*** 从方程[(3.3.1)](#eq:lec3:search_direction)中，我们了解到 ∥p∥ 可以解释为从当前估计
    \(x^i\) 到最优解的距离的二次近似。因此，我们利用 ∥p∥∞/Δt 作为停止准则的更直观的度量。这种方法将其转换为速度单位，并取每个节点的最大幅度。'
