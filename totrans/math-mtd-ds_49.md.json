["```py\ndef lgSamplePath(rng, ss, os, F, H, Q, R, init_mu, init_Sig, T):\n    x = np.zeros((ss,T)) \n    y = np.zeros((os,T))\n\n    x[:,0] = rng.multivariate_normal(init_mu, init_Sig)\n    for t in range(1,T):\n        x[:,t] = rng.multivariate_normal(F @ x[:,t-1],Q)\n        y[:,t] = rng.multivariate_normal(H @ x[:,t],R)\n\n    return x, y \n```", "```py\nseed = 535\nrng = np.random.default_rng(seed)\nss = 4 # state size\nos = 2 # observation size\nF = np.array([[1., 0., 1., 0.],\n              [0., 1., 0., 1.],\n              [0., 0., 1., 0.],\n              [0., 0., 0., 1.]]) \nH = np.array([[1., 0., 0., 0.],\n              [0., 1, 0., 0.]])\nQ = 0.1 * np.diag(np.ones(ss))\nR = 10 * np.diag(np.ones(os))\ninit_mu = np.array([0., 0., 1., 1.])\ninit_Sig = 1 * np.diag(np.ones(ss))\nT = 50\nx, y = lgSamplePath(rng, ss, os, F, H, Q, R, init_mu, init_Sig, T) \n```", "```py\nplt.scatter(y[0,:], y[1,:], s=5, c='r', alpha=0.5)\nplt.plot(x[0,:], x[1,:], c='g', linestyle='dotted')\nplt.xlim((np.min(y[0,:])-5, np.max(y[0,:])+5)) \nplt.ylim((np.min(y[1,:])-5, np.max(y[1,:])+5))\nplt.show() \n```", "```py\ndef kalmanUpdate(ss, F, H, Q, R, y_t, mu_prev, Sig_prev):\n\n    mu_pred = F @ mu_prev\n    Sig_pred = F @ Sig_prev @ F.T + Q\n\n    e_t = y_t - H @ mu_pred\n    S = H @ Sig_pred @ H.T + R\n    Sinv = LA.inv(S)\n    K = Sig_pred @ H.T @ Sinv\n\n    mu_new = mu_pred + K @ e_t\n    Sig_new = (np.diag(np.ones(ss)) - K @ H) @ Sig_pred\n\n    return mu_new, Sig_new \n```", "```py\ndef kalmanFilter(ss, os, y, F, H, Q, R, init_mu, init_Sig, T):\n\n    mu = np.zeros((ss, T))\n    Sig = np.zeros((ss, ss, T))\n    mu[:,0] = init_mu\n    Sig[:,:,0] = init_Sig\n    for t in range(1,T):\n        mu[:,t], Sig[:,:,t] = kalmanUpdate(ss, F, H, Q, R, y[:,t], mu[:,t-1], Sig[:,:,t-1])\n\n    return mu, Sig \n```", "```py\ninit_mu = np.array([0., 0., 1., 1.])\ninit_Sig = 1 * np.diag(np.ones(ss))\nmu, Sig = kalmanFilter(ss, os, y, F, H, Q, R, init_mu, init_Sig, T)\nplt.plot(mu[0,:], mu[1,:], c='b', marker='s', markersize=2, linewidth=1)\nplt.scatter(y[0,:], y[1,:], s=5, c='r', alpha=0.5)\nplt.plot(x[0,:], x[1,:], c='g', linestyle='dotted', alpha=0.5)\nplt.xlim((np.min(y[0,:])-5, np.max(y[0,:])+5)) \nplt.ylim((np.min(y[1,:])-5, np.max(y[1,:])+5))\nplt.show() \n```", "```py\ndobs = x[0:1,:] - y[0:1,:]\nmse_obs = np.sqrt(np.sum(dobs**2))\nprint(mse_obs) \n```", "```py\n22.891982252201856 \n```", "```py\ndfilt = x[0:1,:] - mu[0:1,:]\nmse_filt = np.sqrt(np.sum(dfilt**2))\nprint(mse_filt) \n```", "```py\n9.778610100463018 \n```", "```py\ndef lgSamplePath(rng, ss, os, F, H, Q, R, init_mu, init_Sig, T):\n    x = np.zeros((ss,T)) \n    y = np.zeros((os,T))\n\n    x[:,0] = rng.multivariate_normal(init_mu, init_Sig)\n    for t in range(1,T):\n        x[:,t] = rng.multivariate_normal(F @ x[:,t-1],Q)\n        y[:,t] = rng.multivariate_normal(H @ x[:,t],R)\n\n    return x, y \n```", "```py\nseed = 535\nrng = np.random.default_rng(seed)\nss = 4 # state size\nos = 2 # observation size\nF = np.array([[1., 0., 1., 0.],\n              [0., 1., 0., 1.],\n              [0., 0., 1., 0.],\n              [0., 0., 0., 1.]]) \nH = np.array([[1., 0., 0., 0.],\n              [0., 1, 0., 0.]])\nQ = 0.1 * np.diag(np.ones(ss))\nR = 10 * np.diag(np.ones(os))\ninit_mu = np.array([0., 0., 1., 1.])\ninit_Sig = 1 * np.diag(np.ones(ss))\nT = 50\nx, y = lgSamplePath(rng, ss, os, F, H, Q, R, init_mu, init_Sig, T) \n```", "```py\nplt.scatter(y[0,:], y[1,:], s=5, c='r', alpha=0.5)\nplt.plot(x[0,:], x[1,:], c='g', linestyle='dotted')\nplt.xlim((np.min(y[0,:])-5, np.max(y[0,:])+5)) \nplt.ylim((np.min(y[1,:])-5, np.max(y[1,:])+5))\nplt.show() \n```", "```py\ndef kalmanUpdate(ss, F, H, Q, R, y_t, mu_prev, Sig_prev):\n\n    mu_pred = F @ mu_prev\n    Sig_pred = F @ Sig_prev @ F.T + Q\n\n    e_t = y_t - H @ mu_pred\n    S = H @ Sig_pred @ H.T + R\n    Sinv = LA.inv(S)\n    K = Sig_pred @ H.T @ Sinv\n\n    mu_new = mu_pred + K @ e_t\n    Sig_new = (np.diag(np.ones(ss)) - K @ H) @ Sig_pred\n\n    return mu_new, Sig_new \n```", "```py\ndef kalmanFilter(ss, os, y, F, H, Q, R, init_mu, init_Sig, T):\n\n    mu = np.zeros((ss, T))\n    Sig = np.zeros((ss, ss, T))\n    mu[:,0] = init_mu\n    Sig[:,:,0] = init_Sig\n    for t in range(1,T):\n        mu[:,t], Sig[:,:,t] = kalmanUpdate(ss, F, H, Q, R, y[:,t], mu[:,t-1], Sig[:,:,t-1])\n\n    return mu, Sig \n```", "```py\ninit_mu = np.array([0., 0., 1., 1.])\ninit_Sig = 1 * np.diag(np.ones(ss))\nmu, Sig = kalmanFilter(ss, os, y, F, H, Q, R, init_mu, init_Sig, T)\nplt.plot(mu[0,:], mu[1,:], c='b', marker='s', markersize=2, linewidth=1)\nplt.scatter(y[0,:], y[1,:], s=5, c='r', alpha=0.5)\nplt.plot(x[0,:], x[1,:], c='g', linestyle='dotted', alpha=0.5)\nplt.xlim((np.min(y[0,:])-5, np.max(y[0,:])+5)) \nplt.ylim((np.min(y[1,:])-5, np.max(y[1,:])+5))\nplt.show() \n```", "```py\ndobs = x[0:1,:] - y[0:1,:]\nmse_obs = np.sqrt(np.sum(dobs**2))\nprint(mse_obs) \n```", "```py\n22.891982252201856 \n```", "```py\ndfilt = x[0:1,:] - mu[0:1,:]\nmse_filt = np.sqrt(np.sum(dfilt**2))\nprint(mse_filt) \n```", "```py\n9.778610100463018 \n```"]