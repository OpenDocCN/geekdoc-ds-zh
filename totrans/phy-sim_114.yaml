- en: Friction Energy and Its Derivatives
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec22.3-fric_and_derivatives.html](https://phys-sim-book.github.io/lec22.3-fric_and_derivatives.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: With λ, r, and n precomputed for each friction point-edge pair, we can now conveniently
    compute the energy ([Implementation 22.3.1](#imp:lec22:fric_val)), gradient ([Implementation
    22.3.2](#imp:lec22:fric_grad)), and Hessian ([Implementation 22.3.3](#imp:lec22:fric_hess))
    of the friction potential and add them into the optimization.
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 22.3.1 (Friction energy value, FrictionEnergy.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'When computing the gradient and Hessian, we used the relative velocity v^k​
    as an intermediate variable to make the implementation more organized. This approach
    is given by: ∇Pf​(x)=k∑​(∂x∂v^k​​)T∂v^k​∂Dk​(x)​,∇2Pf​(x)=k∑​(∂x∂v^k​​)T∂v^k2​∂2Dk​(x)​∂x∂v^k​​,
    where the derivatives of Dk​ with respect to v^k​ have exactly the same forms
    as in [Frictional Contact](./lec9-friction.html).'
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 22.3.2 (Friction energy gradient, FrictionEnergy.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '**Implementation 22.3.3 (Friction energy Hessian, FrictionEnergy.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'After these implementations, we can finally run our compressing squares example
    with frictional self-contact (see: [Figure 22.3.1](#fig:lec22:compress_2_squares_fric)).
    From the figure, we observe that once the two squares touch, the large friction
    between them and the ground restricts any sliding. This causes the squares to
    rotate counter-clockwise as they are compressed by the ceiling.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/6017282846460d48562d77236ce4c17e.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 22.3.1.** Two squares dropped onto the ground and compressed by a
    ceiling. The friction coefficient is 0.4 between any contacting surfaces, which
    restricts any sliding here in this scene and results in counter-clockwise rotations
    of the two squares under compression. As their interface becomes nearly vertical,
    the squares are finally detached.'
  prefs: []
  type: TYPE_NORMAL
