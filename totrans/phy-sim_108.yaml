- en: Barrier Energy and Its Derivatives
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec21.3-barrier_and_derivatives.html](https://phys-sim-book.github.io/lec21.3-barrier_and_derivatives.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: With the point-edge distance functions implemented, we can traverse all point-edge
    pairs to assemble the total barrier energy and its derivatives. These will be
    used to solve for the search direction in the time-stepping optimization.
  prefs: []
  type: TYPE_NORMAL
- en: Since squared distances are used, here we rescale the barrier function to b(d2,d^2)={8κ​d^(d^2d2​−1)lnd^2d2​0​d<d^d≥d^,​(21.3.1)
    so that ∂(d^d​)2∂2b​(d^2,d^2)=κd^ still holds. Analogous to elasticity, s=d/d^
    can be viewed as a strain measure, then the 2nd-order derivative of the energy
    density (per area) function b w.r.t. s at s=1 would correspond to Young's modulus
    times thickness d^, which makes κ physically meaningful and convenient to set.
  prefs: []
  type: TYPE_NORMAL
- en: Based on Equation [(20.3.1)](lec20.3-self_contact.html#eq:lec20:barrier_discrete),
    we can derive the gradient and Hessian of the barrier potential as ∇Pb​(x)∇2Pb​(x)​=21​a^∑​Aa^​e∈E−I(Xa^​)∑​∂d∂b​(d(xa^​,e),d^2)∇x​d(xa^​,e) and=21​a^∑​Aa^​e∈E−I(Xa^​)∑​(∂d2∂2b​(d(xa^​,e),d^2)∇x​d(xa^​,e)∇x​d(xa^​,e)T+∂d∂b​(d(xa^​,e),d^2)∇x2​d(xa^​,e)),​
    where Aa^​=2∥Xa^​−Xa^−1​∥+∥Xa^​−Xa^+1​∥​ and we omitted the superscripts and subscripts
    for the squared point-edge distance functions (d(xa^​,e) denotes dsqPE​(xa^​,e)
    here).
  prefs: []
  type: TYPE_NORMAL
- en: 'The energy, gradient, and Hessian of the barrier contact potential are implemented
    as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 21.3.1 (Barrier energy computation, BarrierEnergy.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '**Implementation 21.3.2 (Barrier energy gradient computation, BarrierEnergy.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '**Implementation 21.3.3 (Barrier energy Hessian computation, BarrierEnergy.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
