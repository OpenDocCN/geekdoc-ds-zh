- en: Barrier Energy and Its Derivatives
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 势垒能量及其导数
- en: 原文：[https://phys-sim-book.github.io/lec21.3-barrier_and_derivatives.html](https://phys-sim-book.github.io/lec21.3-barrier_and_derivatives.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec21.3-barrier_and_derivatives.html](https://phys-sim-book.github.io/lec21.3-barrier_and_derivatives.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '`<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">`'
- en: With the point-edge distance functions implemented, we can traverse all point-edge
    pairs to assemble the total barrier energy and its derivatives. These will be
    used to solve for the search direction in the time-stepping optimization.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在实现了点-边距离函数之后，我们可以遍历所有点-边对来组装总的势垒能量及其导数。这些将被用于在时间步优化中求解搜索方向。
- en: Since squared distances are used, here we rescale the barrier function to b(d2,d^2)={8κ​d^(d^2d2​−1)lnd^2d2​0​d<d^d≥d^,​(21.3.1)
    so that ∂(d^d​)2∂2b​(d^2,d^2)=κd^ still holds. Analogous to elasticity, s=d/d^
    can be viewed as a strain measure, then the 2nd-order derivative of the energy
    density (per area) function b w.r.t. s at s=1 would correspond to Young's modulus
    times thickness d^, which makes κ physically meaningful and convenient to set.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 由于使用了平方距离，因此在这里我们将势垒函数重新缩放为 b(d²,d²)={8κd^(d²/d²−1)ln(d²/d²)0 d<d² d≥d²}，(21.3.1)
    以确保 ∂(d²/d²)²/∂²b(d²,d²)=κd² 仍然成立。类似于弹性，s=d/d² 可以被视为应变度量，那么在 s=1 时能量密度（每单位面积）函数
    b 对 s 的二阶导数将对应于杨氏模量乘以厚度 d²，这使得 κ 在物理上具有意义且便于设置。
- en: Based on Equation [(20.3.1)](lec20.3-self_contact.html#eq:lec20:barrier_discrete),
    we can derive the gradient and Hessian of the barrier potential as ∇Pb​(x)∇2Pb​(x)​=21​a^∑​Aa^​e∈E−I(Xa^​)∑​∂d∂b​(d(xa^​,e),d^2)∇x​d(xa^​,e) and=21​a^∑​Aa^​e∈E−I(Xa^​)∑​(∂d2∂2b​(d(xa^​,e),d^2)∇x​d(xa^​,e)∇x​d(xa^​,e)T+∂d∂b​(d(xa^​,e),d^2)∇x2​d(xa^​,e)),​
    where Aa^​=2∥Xa^​−Xa^−1​∥+∥Xa^​−Xa^+1​∥​ and we omitted the superscripts and subscripts
    for the squared point-edge distance functions (d(xa^​,e) denotes dsqPE​(xa^​,e)
    here).
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 基于方程 [(20.3.1)](lec20.3-self_contact.html#eq:lec20:barrier_discrete)，我们可以推导出势垒势能的梯度和Hessian为
    ∇Pb(x)∇²Pb(x) = 2a^∑(Aa^e∈E−I(Xa^))∑(∂d/∂b(d(xa^,e),d²))∇x(d(xa^,e)) 和 = 2a^∑(Aa^e∈E−I(Xa^))∑[(∂²d²/∂²b(d(xa^,e),d²))∇x(d(xa^,e))∇x(d(xa^,e))T
    + (∂d/∂b(d(xa^,e),d²))∇x²(d(xa^,e))]，其中 Aa^ = 2∥Xa^−Xa^−1∥ + ∥Xa^−Xa^+1∥，并且我们省略了平方点-边距离函数（d(xa^,e)表示dsqPE(xa^,e)）的上标和下标。
- en: 'The energy, gradient, and Hessian of the barrier contact potential are implemented
    as follows:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 势垒接触势能的能量、梯度和Hessian的实现如下：
- en: '**Implementation 21.3.1 (Barrier energy computation, BarrierEnergy.py).**'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现 21.3.1（势垒能量计算，BarrierEnergy.py）**。'
- en: '[PRE0]'
  id: totrans-8
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '**Implementation 21.3.2 (Barrier energy gradient computation, BarrierEnergy.py).**'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现 21.3.2（势垒能量梯度计算，BarrierEnergy.py）**。'
- en: '[PRE1]'
  id: totrans-10
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '**Implementation 21.3.3 (Barrier energy Hessian computation, BarrierEnergy.py).**'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现 21.3.3（势垒能量Hessian计算，BarrierEnergy.py）**。'
- en: '[PRE2]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
