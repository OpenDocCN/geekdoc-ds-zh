- en: Mass Matrix and Lumping
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 质量矩阵和聚集
- en: 原文：[https://phys-sim-book.github.io/lec19.2-mass_matrix.html](https://phys-sim-book.github.io/lec19.2-mass_matrix.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec19.2-mass_matrix.html](https://phys-sim-book.github.io/lec19.2-mass_matrix.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: 'Recall from [Discretization of Weak Forms](./lec17-disc_weak_form.html) that:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 回忆一下 [弱形式离散化](./lec17-disc_weak_form.html) 中的内容：
- en: Mab​=∫Ω0​R(X,0)Na​(X)Nb​(X)dX.(19.2.1)
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Mab=∫Ω0R(X,0)Na(X)Nb(X)dX.(19.2.1)
- en: 'With the solid domain discretized into triangles T, we have:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 将固体域离散成三角形 T，我们有：
- en: Mab​=e∈T∑​∫Ωe0​​R(X,0)Na​(X)Nb​(X)dX,(19.2.2)
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: Mab=e∈T∑∫Ωe0R(X,0)Na(X)Nb(X)dX,(19.2.2)
- en: where Ωe0​ represents the material space of triangle e. Note that for linear
    triangle elements, since Ni​ is nonzero only on the incident triangles of node
    i, here we only need to consider triangles with both a and b being their vertices.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 Ωe0 表示三角形 e 的材料空间。注意，对于线性三角形单元，由于 Ni 在节点 i 的相邻三角形上才不为零，因此这里我们只需要考虑以 a 和 b
    为顶点的三角形。
- en: 'Let us change the integration variable from X to (β,γ), which gives:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们将积分变量从 X 变换到 (β,γ)，这给出：
- en: =​∫Ωe0​​R(X,0)Na​(X)Nb​(X)dX∫01​∫01−β​R(β,γ,0)Na​(β,γ)Nb​(β,γ)​det(∂(β,γ)∂X​)​dγdβ.​(19.2.3)
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: =∫Ωe0R(X,0)Na(X)Nb(X)dX∫01∫01−βR(β,γ,0)Na(β,γ)Nb(β,γ)det(∂(β,γ)/∂X)dγdβ.​(19.2.3)
- en: 'For simplicity, let us denote the vertices of this triangle e as X1​, X2​,
    and X3​, and then we have:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 为了简化，让我们将这个三角形 e 的顶点表示为 X1、X2 和 X3，然后我们有：
- en: ​det(∂(β,γ)∂X​)​=∣det([X2​−X1​,X3​−X1​])∣=2Ae​,
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: det(∂(β,γ)/∂X)=|det([X2−X1,X3−X1])|=2Ae，
- en: 'where Ae​ is the area of triangle e. Here, Na​ and Nb​ take 1−β−γ, β, or γ
    depending on the vertex indices a and b. For example, if a and b correspond to
    the 2nd and 3rd vertices of triangle e, then Na​=β and Nb​=γ. Assuming uniform
    density, we have:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 Ae 是三角形 e 的面积。在这里，Na 和 Nb 根据 a 和 b 的顶点索引取 1−β−γ、β 或 γ。例如，如果 a 和 b 对应于三角形
    e 的第 2 和第 3 个顶点，那么 Na=β，Nb=γ。假设均匀密度，我们有：
- en: ∫Ωe0​​R(X,0)Na​(X)Nb​(X)dX====​2RAe​∫01​∫01−β​βγdγdβ2RAe​∫01​21​βγ2​γ=0γ=1−β​dβRAe​∫01​β(1−β)2dβRAe​(2β2​−32β3​+4β4​)​β=0β=1​=121​RAe​.​(19.2.4)
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: ∫Ωe0R(X,0)Na(X)Nb(X)dX====2RAe∫01∫01−ββγdγdβ2RAe∫0121βγ2γ=0γ=1−βdβRAe∫01β(1−β)2dβRAe(2β2−32β3+4β4)β=0β=1=121RAe.​(19.2.4)
- en: 'With mass lumping, Mablump​=δab​∑c​Mac​, which means:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在质量聚集中，Mablump=δab∑cMac，这意味着：
- en: Maalump​=e∈T∑​b∈V∑​∫Ωe0​​R(X,0)Na​(X)Nb​(X)dX,(19.2.5)
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: Maalump=e∈T∑b∈V∑∫Ωe0R(X,0)Na(X)Nb(X)dX,(19.2.5)
- en: 'where V contains all the nodes of the mesh, and all off-diagonal entries of
    Mlump are 0. Similarly, due to the locality of N, for each triangle element, b
    only needs to traverse all three triangle vertices:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 V 包含了网格的所有节点，Mlump 的所有非对角线项都是 0。同样，由于 N 的局部性，对于每个三角形单元，b 只需要遍历所有三个三角形顶点：
- en: Maalump​​=e∈T(a)∑​2RAe​(∫01​∫01−β​β(1−β−γ)dγdβ+∫01​∫01−β​β2dγdβ+∫01​∫01−β​βγdγdβ)=e∈T(a)∑​2RAe​∫01​βdγdβ=e∈T(a)∑​2RAe​∫01​βγ∣γ=0γ=1−β​dβ=e∈T(a)∑​2RAe​∫01​β(1−β)dβ=e∈T(a)∑​2RAe​(2β2​−3β3​)​β=0β=1​=e∈T(a)∑​31​RAe​,​(19.2.6)
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: Maalump=e∈T(a)∑2RAe(∫01∫01−ββ(1−β−γ)dγdβ+∫01∫01−ββ2dγdβ+∫01∫01−ββγdγdβ)=e∈T(a)∑2RAe∫01βdγdβ=e∈T(a)∑2RAe∫01βγ|γ=0γ=1−βdβ=e∈T(a)∑2RAe∫01β(1−β)dβ=e∈T(a)∑2RAe(2β2−3β3)β=0β=1=
    e∈T(a)∑31RAe,​(19.2.6)
- en: where T(a) denotes the set of triangles incident to node a. This result also
    explains why in [Inversion-Free Elasticity](./lec15-inv_free_elasticity.html)
    when computing the mass for all the nodes, we traverse all triangles, calculate
    the mass of the triangle RAe​ and evenly distribute it to the three vertices.
    With the mass matrix computed, the momentum change and external body force terms
    including their energy forms are all easy to deal with.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 T(a) 表示与节点 a 相邻的所有三角形的集合。这个结果也解释了为什么在 [无逆弹性](./lec15-inv_free_elasticity.html)
    中，当计算所有节点的质量时，我们需要遍历所有三角形，计算三角形 RAe 的质量，并将其均匀分配到三个顶点。计算完质量矩阵后，动量变化和外部体力的项以及它们的能量形式都很容易处理。
