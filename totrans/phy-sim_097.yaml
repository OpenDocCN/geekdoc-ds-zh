- en: Mass Matrix and Lumping
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec19.2-mass_matrix.html](https://phys-sim-book.github.io/lec19.2-mass_matrix.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: 'Recall from [Discretization of Weak Forms](./lec17-disc_weak_form.html) that:'
  prefs: []
  type: TYPE_NORMAL
- en: Mab​=∫Ω0​R(X,0)Na​(X)Nb​(X)dX.(19.2.1)
  prefs: []
  type: TYPE_NORMAL
- en: 'With the solid domain discretized into triangles T, we have:'
  prefs: []
  type: TYPE_NORMAL
- en: Mab​=e∈T∑​∫Ωe0​​R(X,0)Na​(X)Nb​(X)dX,(19.2.2)
  prefs: []
  type: TYPE_NORMAL
- en: where Ωe0​ represents the material space of triangle e. Note that for linear
    triangle elements, since Ni​ is nonzero only on the incident triangles of node
    i, here we only need to consider triangles with both a and b being their vertices.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let us change the integration variable from X to (β,γ), which gives:'
  prefs: []
  type: TYPE_NORMAL
- en: =​∫Ωe0​​R(X,0)Na​(X)Nb​(X)dX∫01​∫01−β​R(β,γ,0)Na​(β,γ)Nb​(β,γ)​det(∂(β,γ)∂X​)​dγdβ.​(19.2.3)
  prefs: []
  type: TYPE_NORMAL
- en: 'For simplicity, let us denote the vertices of this triangle e as X1​, X2​,
    and X3​, and then we have:'
  prefs: []
  type: TYPE_NORMAL
- en: ​det(∂(β,γ)∂X​)​=∣det([X2​−X1​,X3​−X1​])∣=2Ae​,
  prefs: []
  type: TYPE_NORMAL
- en: 'where Ae​ is the area of triangle e. Here, Na​ and Nb​ take 1−β−γ, β, or γ
    depending on the vertex indices a and b. For example, if a and b correspond to
    the 2nd and 3rd vertices of triangle e, then Na​=β and Nb​=γ. Assuming uniform
    density, we have:'
  prefs: []
  type: TYPE_NORMAL
- en: ∫Ωe0​​R(X,0)Na​(X)Nb​(X)dX====​2RAe​∫01​∫01−β​βγdγdβ2RAe​∫01​21​βγ2​γ=0γ=1−β​dβRAe​∫01​β(1−β)2dβRAe​(2β2​−32β3​+4β4​)​β=0β=1​=121​RAe​.​(19.2.4)
  prefs: []
  type: TYPE_NORMAL
- en: 'With mass lumping, Mablump​=δab​∑c​Mac​, which means:'
  prefs: []
  type: TYPE_NORMAL
- en: Maalump​=e∈T∑​b∈V∑​∫Ωe0​​R(X,0)Na​(X)Nb​(X)dX,(19.2.5)
  prefs: []
  type: TYPE_NORMAL
- en: 'where V contains all the nodes of the mesh, and all off-diagonal entries of
    Mlump are 0. Similarly, due to the locality of N, for each triangle element, b
    only needs to traverse all three triangle vertices:'
  prefs: []
  type: TYPE_NORMAL
- en: Maalump​​=e∈T(a)∑​2RAe​(∫01​∫01−β​β(1−β−γ)dγdβ+∫01​∫01−β​β2dγdβ+∫01​∫01−β​βγdγdβ)=e∈T(a)∑​2RAe​∫01​βdγdβ=e∈T(a)∑​2RAe​∫01​βγ∣γ=0γ=1−β​dβ=e∈T(a)∑​2RAe​∫01​β(1−β)dβ=e∈T(a)∑​2RAe​(2β2​−3β3​)​β=0β=1​=e∈T(a)∑​31​RAe​,​(19.2.6)
  prefs: []
  type: TYPE_NORMAL
- en: where T(a) denotes the set of triangles incident to node a. This result also
    explains why in [Inversion-Free Elasticity](./lec15-inv_free_elasticity.html)
    when computing the mass for all the nodes, we traverse all triangles, calculate
    the mass of the triangle RAe​ and evenly distribute it to the three vertices.
    With the mass matrix computed, the momentum change and external body force terms
    including their energy forms are all easy to deal with.
  prefs: []
  type: TYPE_NORMAL
