- en: Barrier Potential
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec18.3-barrier_potential.html](https://phys-sim-book.github.io/lec18.3-barrier_potential.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: As discussed in [Distance Barrier for Nonpenetration](./lec7-dist_barrier.html),
    the principle of IPC for solid-to-obstacle contact is to use a barrier function
    to ensure that the signed distance between any nodal degrees of freedom (DOFs)
    and obstacles remains positive throughout the simulation. To handle self-contact,
    potentially for codimensional objects, this idea is extended to ensure that the
    unsigned distance between any boundary points and the boundary remains nonzero
    throughout the simulation.
  prefs: []
  type: TYPE_NORMAL
- en: Let's consider two colliding regions, Γ1​⊂∂Ω0 and Γ2​⊂∂Ω0, on the boundary.
    For any point X1​∈Γ1​, we must ensure that the closest distance between X1​ and
    any point on Γ2​ remains nonzero. This can be achieved by using a barrier function
    to enforce this minimum distance, where the negative gradient of the function
    provides the contact force. This can be written as
  prefs: []
  type: TYPE_NORMAL
- en: TC​(X1​,t)=−∂x(X1​,t)∂b(minX2​∈Γ2​​∥x(X1​,t)−x(X2​,t)∥,d^)​,(18.3.1)
  prefs: []
  type: TYPE_NORMAL
- en: 'where b is the barrier function:'
  prefs: []
  type: TYPE_NORMAL
- en: b(d,d^)={2κ​d^(d^d​−1)lnd^d​0​d<d^d≥d^,​(18.3.2)
  prefs: []
  type: TYPE_NORMAL
- en: serving as the contact potential energy density. Here, the barrier function
    approaches infinity as the distance approaches zero, providing an arbitrarily
    large repulsive force to prevent interpenetration. When the distance is above
    the threshold d^ and no contact is occurring, no contact forces are exerted. By
    using the barrier function, the non-smooth contact constraints are approximated
    by a constitutive model in which the force is conservative, enabling consistent
    resolution through an optimization-based time integrator.
  prefs: []
  type: TYPE_NORMAL
- en: '***Remark 18.3.1 (Barrier Density).*** Compared to Equation [(7.2.3)](lec7.2-dist_barrier_formulation.html#eq:lec7:barrier_func),
    the barrier energy density function here is additionally multiplied by d^ to maintain
    consistent units after surface integration. Recall from [Remark 7.2.1](lec7.2-dist_barrier_formulation.html#rm:lec7:contact_layer)
    that the barrier potential can be thought of as an extra thin layer of (d^-thick)
    virtual material right outside the boundary of the solids, and κ is analogous
    to Young''s modulus.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '***Remark 18.3.2 (Min Operator).*** When multiple points have the same minimal
    distance to X1​, the distance barrier of X1​ to all these points should be summed
    up. The `min` operator is non-smooth, which can still complicate optimization-based
    time integration. In the next chapter, we will demonstrate how this is approximated
    as described in [Distance Barrier for Nonpenetration](./lec7-dist_barrier.html).'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'The case of two colliding regions results in a boundary integral:'
  prefs: []
  type: TYPE_NORMAL
- en: ∫Γ1​​Qi​(X1​,t)TC1​∣i​(X1​,t)ds(X)+∫Γ2​​Qi​(X2​,t)TC2​∣i​(X2​,t)ds(X),
  prefs: []
  type: TYPE_NORMAL
- en: 'where TC1​​ is defined in Equation [(18.3.1)](#eq:lec18:solid_solid_contact_force),
    and:'
  prefs: []
  type: TYPE_NORMAL
- en: TC2​​(X2​,t)=−∂x(X2​,t)∂b(minX1​∈Γ1​​∥x(X2​,t)−x(X1​,t)∥,d^)​,(18.3.3)
  prefs: []
  type: TYPE_NORMAL
- en: 'However, we have ignored the self-contact of Γ1​ and Γ2​ in this example. Thus,
    generalizing to arbitrary self-contact for the whole domain, we can keep the single
    boundary integral term ∫ΓC​​Qi​(X,t)TC∣i​(X,t)ds(X) for contact as in Equation
    [(18.2.1)](lec18.2-normal_contact.html#eq:lec18:boundary_int_with_contact) and
    define the traction more generally as:'
  prefs: []
  type: TYPE_NORMAL
- en: TC​(X,t)=−∂x(X,t)∂b(minX2​∈ΓC​−N(X)​∥x(X,t)−x(X2​,t)∥,d^)​,(18.3.4)
  prefs: []
  type: TYPE_NORMAL
- en: where N(X)={XN​∈Rd∣∥XN​−X∥<r} is an infinitesimal circle around X with the radius
    r sufficiently small to avoid unnecessary contact forces between a point and its
    geodesic neighbors.
  prefs: []
  type: TYPE_NORMAL
- en: '***Remark 18.3.3 (Barrier Force Limits).*** In Equation [(18.3.4)](#eq:lec18:solid_self_contact_force),
    self-contact is ignored for points inside N(X). This is the trade-off for smoothly
    approximating contact forces, which are discontinuous in a macroscopic view. Similarly,
    d^ introduces another source of error. However, when d^→0 and r→0, our model converges
    to the discontinuous definition. Note that we also need d^/r→0, or there could
    still be some distance d between r and d^ that causes the barrier to diverge in
    the limit.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Finally, we can define the contact potential over the whole boundary ΓC​ as:'
  prefs: []
  type: TYPE_NORMAL
- en: ∫ΓC​​21​b(X2​∈ΓC​−N(X)min​∥x(X,t)−x(X2​,t)∥,d^)ds(X).(18.3.5)
  prefs: []
  type: TYPE_NORMAL
- en: Here, the coefficient 21​ is used because the barrier energy density b of each
    pair of contacting points will be counted twice in the integral due to symmetry.
    When computing barrier forces, both occurrences need to be differentiated. Therefore,
    using the coefficient 21​ allows us to match the force definition in Equation
    [(18.3.4)](#eq:lec18:solid_self_contact_force). We'll elaborate on this in the
    next chapter under the discrete weak form.
  prefs: []
  type: TYPE_NORMAL
- en: The contact potential is not required in the weak form but will be useful for
    optimization-based time integration.
  prefs: []
  type: TYPE_NORMAL
