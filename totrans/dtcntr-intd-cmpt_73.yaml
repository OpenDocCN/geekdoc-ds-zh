- en: 27Â Interactive Games as Reactive SystemsğŸ”—
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 27Â äº¤äº’å¼æ¸¸æˆä½œä¸ºååº”æ€§ç³»ç»ŸğŸ”—
- en: åŸæ–‡ï¼š[https://dcic-world.org/2025-08-27/games-reactive.html](https://dcic-world.org/2025-08-27/games-reactive.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://dcic-world.org/2025-08-27/games-reactive.html](https://dcic-world.org/2025-08-27/games-reactive.html)
- en: '| Â Â Â Â [27.1Â About Reactive Animations](#%28part._.About_.Reactive_.Animations%29)
    |'
  id: totrans-2
  prefs: []
  type: TYPE_TB
  zh: '| Â Â Â Â [27.1Â å…³äºååº”æ€§åŠ¨ç”»](#%28part._.About_.Reactive_.Animations%29) |'
- en: '| Â Â Â Â [27.2Â Preliminaries](#%28part._.Preliminaries%29) |'
  id: totrans-3
  prefs: []
  type: TYPE_TB
  zh: '| Â Â Â Â [27.2Â é¢„å¤‡çŸ¥è¯†](#%28part._.Preliminaries%29) |'
- en: '| Â Â Â Â [27.3Â Version: Airplane Moving Across the Screen](#%28part._.Version__.Airplane_.Moving_.Across_the_.Screen%29)
    |'
  id: totrans-4
  prefs: []
  type: TYPE_TB
  zh: '| Â Â Â Â [27.3Â ç‰ˆæœ¬ï¼šé£æœºåœ¨å±å¹•ä¸Šç§»åŠ¨](#%28part._.Version__.Airplane_.Moving_.Across_the_.Screen%29)
    |'
- en: '| Â Â Â Â Â Â [27.3.1Â Updating the World State](#%28part._.Updating_the_.World_.State%29)
    |'
  id: totrans-5
  prefs: []
  type: TYPE_TB
  zh: '| Â Â Â Â [27.3.1Â æ›´æ–°ä¸–ç•ŒçŠ¶æ€](#%28part._.Updating_the_.World_.State%29) |'
- en: '| Â Â Â Â Â Â [27.3.2Â Displaying the World State](#%28part._.Displaying_the_.World_.State%29)
    |'
  id: totrans-6
  prefs: []
  type: TYPE_TB
  zh: '| Â Â Â Â Â Â [27.3.2Â æ˜¾ç¤ºä¸–ç•ŒçŠ¶æ€](#%28part._.Displaying_the_.World_.State%29) |'
- en: '| Â Â Â Â Â Â [27.3.3Â Observing Time (and Combining the Pieces)](#%28part._.Observing_.Time__and_.Combining_the_.Pieces_%29)
    |'
  id: totrans-7
  prefs: []
  type: TYPE_TB
  zh: '| Â Â Â Â [27.3.3Â è§‚å¯Ÿæ—¶é—´ï¼ˆä»¥åŠç»„åˆéƒ¨ä»¶ï¼‰](#%28part._.Observing_.Time__and_.Combining_the_.Pieces_%29)
    |'
- en: '| Â Â Â Â [27.4Â Version: Wrapping Around](#%28part._.Version__.Wrapping_.Around%29)
    |'
  id: totrans-8
  prefs: []
  type: TYPE_TB
  zh: '| Â Â Â Â [27.4Â ç‰ˆæœ¬ï¼šç¯ç»•](#%28part._.Version__.Wrapping_.Around%29) |'
- en: '| Â Â Â Â [27.5Â Version: Descending](#%28part._.Version__.Descending%29) |'
  id: totrans-9
  prefs: []
  type: TYPE_TB
  zh: '| Â Â Â Â [27.5Â ç‰ˆæœ¬ï¼šä¸‹é™](#%28part._.Version__.Descending%29) |'
- en: '| Â Â Â Â Â Â [27.5.1Â Moving the Airplane](#%28part._.Moving_the_.Airplane%29) |'
  id: totrans-10
  prefs: []
  type: TYPE_TB
  zh: '| Â Â Â Â Â Â [27.5.1Â ç§»åŠ¨é£æœº](#%28part._.Moving_the_.Airplane%29) |'
- en: '| Â Â Â Â Â Â [27.5.2Â Drawing the Scene](#%28part._.Drawing_the_.Scene%29) |'
  id: totrans-11
  prefs: []
  type: TYPE_TB
  zh: '| Â Â Â Â Â Â [27.5.2Â ç»˜åˆ¶åœºæ™¯](#%28part._.Drawing_the_.Scene%29) |'
- en: '| Â Â Â Â Â Â [27.5.3Â Finishing Touches](#%28part._.Finishing_.Touches%29) |'
  id: totrans-12
  prefs: []
  type: TYPE_TB
  zh: '| Â Â Â Â Â Â [27.5.3Â å®Œæˆç»†èŠ‚](#%28part._.Finishing_.Touches%29) |'
- en: '| Â Â Â Â [27.6Â Version: Responding to Keystrokes](#%28part._.Version__.Responding_to_.Keystrokes%29)
    |'
  id: totrans-13
  prefs: []
  type: TYPE_TB
  zh: '| Â Â Â Â [27.6Â ç‰ˆæœ¬ï¼šå“åº”æŒ‰é”®](#%28part._.Version__.Responding_to_.Keystrokes%29) |'
- en: '| Â Â Â Â [27.7Â Version: Landing](#%28part._.Version__.Landing%29) |'
  id: totrans-14
  prefs: []
  type: TYPE_TB
  zh: '| Â Â Â Â [27.7Â ç‰ˆæœ¬ï¼šé™è½](#%28part._.Version__.Landing%29) |'
- en: '| Â Â Â Â [27.8Â Version: A Fixed Balloon](#%28part._.Version__.A_.Fixed_.Balloon%29)
    |'
  id: totrans-15
  prefs: []
  type: TYPE_TB
  zh: '| Â Â Â Â [27.8Â ç‰ˆæœ¬ï¼šå›ºå®šæ°”çƒ](#%28part._.Version__.A_.Fixed_.Balloon%29) |'
- en: '| Â Â Â Â [27.9Â Version: Keep Your Eye on the Tank](#%28part._.Version__.Keep_.Your_.Eye_on_the_.Tank%29)
    |'
  id: totrans-16
  prefs: []
  type: TYPE_TB
  zh: '| Â Â Â Â [27.9Â ç‰ˆæœ¬ï¼šæ³¨æ„æ²¹ç®±](#%28part._.Version__.Keep_.Your_.Eye_on_the_.Tank%29)
    |'
- en: '| Â Â Â Â [27.10Â Version: The Balloon Moves, Too](#%28part._.Version__.The_.Balloon_.Moves__.Too%29)
    |'
  id: totrans-17
  prefs: []
  type: TYPE_TB
  zh: '| Â Â Â Â [27.10Â ç‰ˆæœ¬ï¼šæ°”çƒä¹Ÿåœ¨ç§»åŠ¨](#%28part._.Version__.The_.Balloon_.Moves__.Too%29)
    |'
- en: '| Â Â Â Â [27.11Â Version: One, Two, ..., Ninety-Nine Luftballons!](#%28part._.Version__.One__.Two_______.Ninety-.Nine_.Luftballons_%29)
    |'
  id: totrans-18
  prefs: []
  type: TYPE_TB
  zh: '| Â Â Â Â [27.11Â ç‰ˆæœ¬ï¼šä¸€ä¸ªã€ä¸¤ä¸ªã€â€¦â€¦ã€ä¹åä¹ä¸ªæ°”çƒï¼](#%28part._.Version__.One__.Two_______.Ninety-.Nine_.Luftballons_%29)
    |'
- en: In this tutorial weâ€™re going to write a little interactive game. The game wonâ€™t
    be sophisticated, but itâ€™ll have all the elements you need to build much richer
    games of your own.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ä¸ªæ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ç¼–å†™ä¸€ä¸ªå°å‹çš„äº¤äº’å¼æ¸¸æˆã€‚è¿™ä¸ªæ¸¸æˆä¸ä¼šå¾ˆå¤æ‚ï¼Œä½†å®ƒå°†åŒ…å«ä½ æ„å»ºè‡ªå·±æ›´ä¸°å¯Œæ¸¸æˆæ‰€éœ€çš„æ‰€æœ‰å…ƒç´ ã€‚
- en: '![](../Images/998e83245f5c413f941ee7fad3ab6d30.png)'
  id: totrans-20
  prefs:
  - PREF_BQ
  type: TYPE_IMG
  zh: '![](../Images/998e83245f5c413f941ee7fad3ab6d30.png)'
- en: Albuquerque Balloon Fiesta
  id: totrans-21
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: é˜¿å°”ä¼¯å…‹åŸºçƒ­æ°”çƒèŠ‚
- en: 'Imagine we have an airplane coming in to land. Itâ€™s unfortunately trying to
    do so amidst a hot-air balloon festival, so it naturally wants to avoid colliding
    with any (moving) balloons. In addition, there is both land and water, and the
    airplane needs to alight on land. We might also equip it with limited amounts
    of fuel to complete its task. Here are some animations of the game:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æœ‰ä¸€æ¶é£æœºæ­£åœ¨é™è½ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå®ƒè¯•å›¾åœ¨ä¸€ä¸ªçƒ­æ°”çƒèŠ‚ä¸­é™è½ï¼Œå› æ­¤å®ƒè‡ªç„¶æƒ³è¦é¿å…ä¸ä»»ä½•ï¼ˆç§»åŠ¨çš„ï¼‰æ°”çƒç›¸æ’ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰é™†åœ°å’Œæ°´ï¼Œé£æœºéœ€è¦é™è½åœ¨é™†åœ°ä¸Šã€‚æˆ‘ä»¬è¿˜å¯èƒ½ç»™å®ƒé…å¤‡æœ‰é™çš„ç‡ƒæ–™æ¥å®Œæˆå®ƒçš„ä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯æ¸¸æˆçš„å‡ ä¸ªåŠ¨ç”»ï¼š
- en: '[The airplane comes in to land succcessfully.](https://drive.google.com/file/d/1RyDtWXnodN1rzUwwe79InaVUTfIW5GC8/view?usp=share_link)'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[é£æœºæˆåŠŸé™è½ã€‚](https://drive.google.com/file/d/1RyDtWXnodN1rzUwwe79InaVUTfIW5GC8/view?usp=share_link)'
- en: '[Uh ohâ€”<wbr>the airplane collides with a balloon!](https://drive.google.com/file/d/1N8H8T4ssaIlzGfL8XD99QruxLlrIAnAu/view?usp=sharing)'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å“å‘€â€”â€”<wbr>é£æœºä¸æ°”çƒç›¸æ’äº†ï¼[æŸ¥çœ‹é“¾æ¥](https://drive.google.com/file/d/1N8H8T4ssaIlzGfL8XD99QruxLlrIAnAu/view?usp=sharing)
- en: '[Uh ohâ€”<wbr>the airplane lands in the water!](https://drive.google.com/file/d/1zdlxGY8InPkyYRWi3ROWDHLZPtuj2KZu/view?usp=share_link)'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å“å‘€â€”â€”<wbr>é£æœºè½åœ¨æ°´é‡Œäº†ï¼[æŸ¥çœ‹é“¾æ¥](https://drive.google.com/file/d/1zdlxGY8InPkyYRWi3ROWDHLZPtuj2KZu/view?usp=share_link)
- en: 'By the end, you will have written all the relevant portions of this program.
    Your program will:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ°æœ€åï¼Œä½ å°†ç¼–å†™è¿™ä¸ªç¨‹åºçš„æ‰€æœ‰ç›¸å…³éƒ¨åˆ†ã€‚ä½ çš„ç¨‹åºå°†ï¼š
- en: animate the airplane to move autonomously;
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿é£æœºè‡ªä¸»ç§»åŠ¨ï¼›
- en: detect keystrokes and adjust the airplane accordingly;
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ£€æµ‹æŒ‰é”®å¹¶ç›¸åº”åœ°è°ƒæ•´é£æœºï¼›
- en: have multiple moving balloons;
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æœ‰å¤šä¸ªç§»åŠ¨çš„çƒ­æ°”çƒï¼›
- en: detect collisions between the airplane and balloons;
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ£€æµ‹é£æœºä¸æ°”çƒä¹‹é—´çš„ç¢°æ’ï¼›
- en: check for landing on water and land; and
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ£€æŸ¥é£æœºæ˜¯å¦é™è½åœ¨æ°´ä¸Šå’Œé™†åœ°ä¸Šï¼›
- en: account for the use of fuel.
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è€ƒè™‘ç‡ƒæ–™çš„ä½¿ç”¨ã€‚
- en: 'Phew: thatâ€™s a lot going on! Therefore, we wonâ€™t write it all at once; instead,
    weâ€™ll build it up bit-by-bit. But weâ€™ll get there by the end.'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: å‘¼åï¼šäº‹æƒ…å¤ªå¤šäº†ï¼å› æ­¤ï¼Œæˆ‘ä»¬ä¸ä¼šä¸€æ¬¡æ€§å†™å®Œï¼›ç›¸åï¼Œæˆ‘ä»¬å°†é€æ­¥æ„å»ºã€‚ä½†æœ€ç»ˆæˆ‘ä»¬ä¼šè¾¾åˆ°ç›®æ ‡ã€‚
- en: 27.1Â About Reactive Animations[ğŸ”—](#(part._.About_.Reactive_.Animations) "Link
    to here")
  id: totrans-34
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.1 å…³äºååº”æ€§åŠ¨ç”»[ğŸ”—](#(part._.About_.Reactive_.Animations) "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'We are writing a program with two important interactive elements: it is an
    animation, meaning it gives the impression of motion, and it is reactive, meaning
    it responds to user input. Both of these can be challenging to program, but Pyret
    provides a simple mechanism that accommodates both and integrates well with other
    programming principles such as testing. We will learn about this as we go along.'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æ­£åœ¨ç¼–å†™ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªé‡è¦äº¤äº’å…ƒç´ çš„ç¨‹åºï¼šå®ƒæ˜¯ä¸€ä¸ªåŠ¨ç”»ï¼Œæ„å‘³ç€å®ƒç»™äººä¸€ç§è¿åŠ¨çš„æ„Ÿè§‰ï¼Œå®ƒæ˜¯ååº”æ€§çš„ï¼Œæ„å‘³ç€å®ƒå¯¹ç”¨æˆ·è¾“å…¥åšå‡ºå“åº”ã€‚è¿™ä¸¤ä¸ªå…ƒç´ ç¼–ç¨‹èµ·æ¥éƒ½å¯èƒ½å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œä½†
    Pyret æä¾›äº†ä¸€ç§ç®€å•çš„æœºåˆ¶ï¼Œå®ƒæ—¢é€‚åº”äº†è¿™ä¸¤ä¸ªå…ƒç´ ï¼Œåˆä¸å…¶ä»–ç¼–ç¨‹åŸåˆ™ï¼ˆå¦‚æµ‹è¯•ï¼‰å¾ˆå¥½åœ°é›†æˆã€‚æˆ‘ä»¬å°†éšç€å­¦ä¹ çš„æ·±å…¥äº†è§£è¿™ä¸€ç‚¹ã€‚
- en: 'The key to creating an animation is the Movie Principle. Even in the most sophisticated
    movie you can watch, there is no motion (indeed, the very term â€œmovieâ€â€”<wbr>short
    for â€œmoving pictureâ€â€”<wbr>is a clever bit of false advertising). Rather, there
    is just a sequence of still images shown in rapid succession, relying on the human
    brain to create the impression of motion:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ›å»ºåŠ¨ç”»çš„å…³é”®æ˜¯ç”µå½±åŸç†ã€‚å³ä½¿åœ¨æœ€å¤æ‚çš„ç”µå½±ä¸­ï¼Œä½ ä¹Ÿèƒ½çœ‹åˆ°æ²¡æœ‰è¿åŠ¨ï¼ˆå®é™…ä¸Šï¼Œâ€œç”µå½±â€â€”â€”<wbr>ç®€ç§°â€œç§»åŠ¨å›¾ç‰‡â€â€”â€”<wbr>æ˜¯ä¸€åˆ™å·§å¦™çš„è™šå‡å¹¿å‘Šï¼‰ã€‚ç›¸åï¼Œåªæ˜¯ä¸€ç³»åˆ—é™æ­¢çš„å›¾åƒä»¥å¿«é€Ÿè¿ç»­çš„æ–¹å¼æ˜¾ç¤ºï¼Œä¾é äººç±»å¤§è„‘åˆ›é€ å‡ºè¿åŠ¨çš„æ„Ÿè§‰ï¼š
- en: '![](../Images/5c8adbce3d9a918184e456af57b76f30.png)'
  id: totrans-37
  prefs:
  - PREF_BQ
  type: TYPE_IMG
  zh: '![](../Images/5c8adbce3d9a918184e456af57b76f30.png)'
- en: 'We are going to exploit the same idea: our animations will consist of a sequence
    of individual images, and we will ask Pyret to show these in rapid succession.
    We will then see how reactivity folds into the same process.'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†åˆ©ç”¨åŒæ ·çš„æƒ³æ³•ï¼šæˆ‘ä»¬çš„åŠ¨ç”»å°†åŒ…å«ä¸€ç³»åˆ—å•ç‹¬çš„å›¾åƒï¼Œæˆ‘ä»¬å°†è¦æ±‚ Pyret ä»¥å¿«é€Ÿè¿ç»­çš„æ–¹å¼æ˜¾ç¤ºè¿™äº›å›¾åƒã€‚ç„¶åæˆ‘ä»¬å°†çœ‹åˆ°ååº”æ€§å¦‚ä½•èå…¥åŒæ ·çš„è¿‡ç¨‹ã€‚
- en: 27.2Â Preliminaries[ğŸ”—](#(part._.Preliminaries) "Link to here")
  id: totrans-39
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.2 å‰ç½®çŸ¥è¯†[ğŸ”—](#(part._.Preliminaries) "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'To begin with, we should inform Pyret that we plan to make use of both images
    and animations. We load the libraries as follows:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œæˆ‘ä»¬åº”è¯¥é€šçŸ¥ Pyret æˆ‘ä»¬è®¡åˆ’ä½¿ç”¨å›¾åƒå’ŒåŠ¨ç”»ã€‚æˆ‘ä»¬æŒ‰ç…§ä»¥ä¸‹æ–¹å¼åŠ è½½åº“ï¼š
- en: '[PRE0]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: This tells Pyret to load these two libraries and bind the results to the corresponding
    names, `I` and `R`. Thus, all image operations are obtained from `I` and animation
    operations from `R`.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å‘Šè¯‰ Pyret åŠ è½½è¿™ä¸¤ä¸ªåº“å¹¶å°†ç»“æœç»‘å®šåˆ°ç›¸åº”çš„åç§°ï¼Œ`I` å’Œ `R`ã€‚å› æ­¤ï¼Œæ‰€æœ‰å›¾åƒæ“ä½œéƒ½æ¥è‡ª `I`ï¼ŒåŠ¨ç”»æ“ä½œæ¥è‡ª `R`ã€‚
- en: '27.3Â Version: Airplane Moving Across the Screen[ğŸ”—](#(part._.Version__.Airplane_.Moving_.Across_the_.Screen)
    "Link to here")'
  id: totrans-43
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.3 ç‰ˆæœ¬ï¼šé£æœºåœ¨å±å¹•ä¸Šç§»åŠ¨[ğŸ”—](#(part._.Version__.Airplane_.Moving_.Across_the_.Screen)
    "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'We will start with the simplest version: one in which the airplane moves horizontally
    across the screen. Watch [this video](https://drive.google.com/file/d/1rbDJJJEQV2z-FZT3R1c15xelLsCwhaLI/view?usp=share_link).'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†ä»æœ€ç®€å•çš„ç‰ˆæœ¬å¼€å§‹ï¼šé£æœºåœ¨å±å¹•ä¸Šæ°´å¹³ç§»åŠ¨ã€‚è§‚çœ‹[è¿™ä¸ªè§†é¢‘](https://drive.google.com/file/d/1rbDJJJEQV2z-FZT3R1c15xelLsCwhaLI/view?usp=share_link)ã€‚
- en: First, hereâ€™s an image of an airplane:Have fun finding your preferred airplane
    image! But donâ€™t spend too long on it, because weâ€™ve still got a lot of work to
    do.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œè¿™æ˜¯ä¸€å¼ é£æœºçš„å›¾ç‰‡ï¼šäº«å—å¯»æ‰¾ä½ å–œæ¬¢çš„é£æœºå›¾ç‰‡çš„è¿‡ç¨‹ï¼ä½†ä¸è¦èŠ±å¤ªå¤šæ—¶é—´ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æœ‰å¾ˆå¤šå·¥ä½œè¦åšã€‚
- en: '[http://world.cs.brown.edu/1/clipart/airplane-small.png](http://world.cs.brown.edu/1/clipart/airplane-small.png)'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://world.cs.brown.edu/1/clipart/airplane-small.png](http://world.cs.brown.edu/1/clipart/airplane-small.png)'
- en: 'We can tell Pyret to load this image and give it a name as follows:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥å‘Šè¯‰ Pyret åŠ è½½è¿™å¼ å›¾ç‰‡å¹¶ç»™å®ƒèµ·ä¸€ä¸ªåå­—ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
- en: '[PRE1]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Henceforth, when we refer to `AIRPLANE`, it will always refer to this image.
    (Try it out in the interactions area!)
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: ä»æ­¤ä»¥åï¼Œå½“æˆ‘ä»¬æåˆ° `AIRPLANE` æ—¶ï¼Œå®ƒå°†å§‹ç»ˆæŒ‡ä»£è¿™å¼ å›¾åƒã€‚ï¼ˆåœ¨äº¤äº’åŒºåŸŸè¯•è¯•çœ‹ï¼ï¼‰
- en: Now look at the video again. Watch what happens at different points in time.
    What stays the same, and what changes? Whatâ€™s common is the water and land, which
    stay the same. What changes is the (horizontal) position of the airplane.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨å†æ¬¡è§‚çœ‹è§†é¢‘ã€‚è§‚å¯Ÿåœ¨ä¸åŒæ—¶é—´ç‚¹å‘ç”Ÿäº†ä»€ä¹ˆã€‚ä»€ä¹ˆä¿æŒä¸å˜ï¼Œä»€ä¹ˆå‘ç”Ÿäº†å˜åŒ–ï¼Ÿå…±åŒç‚¹æ˜¯æ°´å’Œé™†åœ°ä¿æŒä¸å˜ã€‚å‘ç”Ÿå˜åŒ–çš„æ˜¯é£æœºçš„ï¼ˆæ°´å¹³ï¼‰ä½ç½®ã€‚
- en: Note
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„
- en: The World State consists of everything that changes. Things that stay the same
    do not need to get recorded in the World State.
  id: totrans-52
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸–ç•ŒçŠ¶æ€åŒ…æ‹¬æ‰€æœ‰ä¼šå‘ç”Ÿå˜åŒ–çš„ä¸œè¥¿ã€‚ä¿æŒä¸å˜çš„äº‹ç‰©ä¸éœ€è¦è®°å½•åœ¨ä¸–ç•ŒçŠ¶æ€ä¸­ã€‚
- en: 'We can now define our first World State:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ç°åœ¨å¯ä»¥å®šä¹‰æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªä¸–ç•ŒçŠ¶æ€ï¼š
- en: World Definition
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸–ç•Œå®šä¹‰
- en: The World State is a number, representing the x-position of the airplane.
  id: totrans-55
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸–ç•ŒçŠ¶æ€æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºé£æœºçš„xä½ç½®ã€‚
- en: 'Observe something important above:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ä¸Šé¢çš„ä¸€äº›é‡è¦å†…å®¹ï¼š
- en: Note
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„
- en: When we record a World State, we donâ€™t capture only the type of the values,
    but also their intended meaning.
  id: totrans-58
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å½“æˆ‘ä»¬è®°å½•ä¸–ç•ŒçŠ¶æ€æ—¶ï¼Œæˆ‘ä»¬ä¸ä»…æ•è·å€¼çš„ç±»å‹ï¼Œè¿˜æ•è·å®ƒä»¬çš„é¢„æœŸå«ä¹‰ã€‚
- en: 'Now we have a representation of the core data, but to generate the above animation,
    we still have to do several things:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬æœ‰äº†æ ¸å¿ƒæ•°æ®çš„è¡¨ç°ï¼Œä½†è¦ç”Ÿæˆä¸Šé¢çš„åŠ¨ç”»ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦åšå‡ ä»¶äº‹æƒ…ï¼š
- en: Ask to be notified of the passage of time.
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: è¯·æ±‚é€šçŸ¥æ—¶é—´çš„æµé€ã€‚
- en: As time passes, correspondingly update the World State.
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: éšç€æ—¶é—´çš„æ¨ç§»ï¼Œç›¸åº”åœ°æ›´æ–°ä¸–ç•ŒçŠ¶æ€ã€‚
- en: Given an updated World State, produce the corresponding visual display.
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç»™å®šä¸€ä¸ªæ›´æ–°çš„ä¸–ç•ŒçŠ¶æ€ï¼Œç”Ÿæˆç›¸åº”çš„è§†è§‰æ˜¾ç¤ºã€‚
- en: This sounds like a lot! Fortunately, Pyret makes this much easier than it sounds.
    Weâ€™ll do these in a slightly different order than listed above.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å¬èµ·æ¥å¥½åƒå¾ˆå¤šï¼å¹¸è¿çš„æ˜¯ï¼ŒPyretä½¿è¿™æ¯”å¬èµ·æ¥å®¹æ˜“å¾—å¤šã€‚æˆ‘ä»¬å°†æŒ‰ç…§ä¸ä¸Šé¢åˆ—å‡ºçš„ä¸åŒé¡ºåºæ¥åšè¿™äº›ã€‚
- en: 27.3.1Â Updating the World State[ğŸ”—](#(part._.Updating_the_.World_.State) "Link
    to here")
  id: totrans-64
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 27.3.1 æ›´æ–°ä¸–ç•ŒçŠ¶æ€[ğŸ”—](#(part._.Updating_the_.World_.State) "é“¾æ¥åˆ°æ­¤å¤„")
- en: As weâ€™ve noted, the airplane doesnâ€™t actually â€œmoveâ€. Rather, we can ask Pyret
    to notify us every time a clock ticks. If on each tick we place the airplane in
    an appropriately different position, and the ticks happen often enough, we will
    get the impression of motion.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: æ­£å¦‚æˆ‘ä»¬æ‰€æ³¨æ„åˆ°çš„ï¼Œé£æœºå®é™…ä¸Šå¹¶æ²¡æœ‰â€œç§»åŠ¨â€ã€‚ç›¸åï¼Œæˆ‘ä»¬å¯ä»¥è¦æ±‚Pyretåœ¨æ¯æ¬¡æ—¶é’Ÿæ»´ç­”æ—¶é€šçŸ¥æˆ‘ä»¬ã€‚å¦‚æœåœ¨æ¯ä¸ªæ»´ç­”æ—¶æˆ‘ä»¬å°†é£æœºæ”¾ç½®åœ¨é€‚å½“ä¸åŒçš„ä½ç½®ï¼Œå¹¶ä¸”æ»´ç­”å‘ç”Ÿå¾—è¶³å¤Ÿé¢‘ç¹ï¼Œæˆ‘ä»¬å°†å¾—åˆ°è¿åŠ¨çš„æ„Ÿè§‰ã€‚
- en: 'Because the World State consists of just the airplaneâ€™s x-position, to move
    it to the right, we simply increment its value. Letâ€™s first give this constant
    distance a name:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: å› ä¸ºä¸–ç•ŒçŠ¶æ€åªåŒ…å«é£æœºçš„xä½ç½®ï¼Œè¦å°†å®ƒå‘å³ç§»åŠ¨ï¼Œæˆ‘ä»¬åªéœ€å¢åŠ å…¶å€¼ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç»™è¿™ä¸ªå¸¸æ•°è·ç¦»èµ·ä¸ªåå­—ï¼š
- en: '[PRE2]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'We will need to write a function that reflects this movement. Letâ€™s first write
    some test cases:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸ªåæ˜ è¿™ç§ç§»åŠ¨çš„å‡½æ•°ã€‚è®©æˆ‘ä»¬é¦–å…ˆç¼–å†™ä¸€äº›æµ‹è¯•ç”¨ä¾‹ï¼š
- en: '[PRE3]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The functionâ€™s definition is now clear:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: å‡½æ•°çš„å®šä¹‰ç°åœ¨å¾ˆæ¸…æ™°ï¼š
- en: '[PRE4]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: And sure enough, Pyret will confirm that this function passes all of its tests.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: å¹¶ä¸”ç¡®å®å¦‚æ­¤ï¼ŒPyretå°†ç¡®è®¤è¿™ä¸ªå‡½æ•°é€šè¿‡äº†æ‰€æœ‰çš„æµ‹è¯•ã€‚
- en: Note
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„
- en: 'If you have prior experience programming animations and reactive programs,
    you will immediately notice an important difference: itâ€™s easy to test parts of
    your program in Pyret!'
  id: totrans-74
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å¦‚æœä½ ä»¥å‰æœ‰ç¼–ç¨‹åŠ¨ç”»å’Œå“åº”å¼ç¨‹åºçš„ç»éªŒï¼Œä½ å°†ç«‹å³æ³¨æ„åˆ°ä¸€ä¸ªé‡è¦çš„åŒºåˆ«ï¼šåœ¨Pyretä¸­æµ‹è¯•ç¨‹åºçš„éƒ¨åˆ†å¾ˆå®¹æ˜“ï¼
- en: 27.3.2Â Displaying the World State[ğŸ”—](#(part._.Displaying_the_.World_.State)
    "Link to here")
  id: totrans-75
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 27.3.2 æ˜¾ç¤ºä¸–ç•ŒçŠ¶æ€[ğŸ”—](#(part._.Displaying_the_.World_.State) "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'Now weâ€™re ready to draw the gameâ€™s visual output. We produce an image that
    consists of all the necessary components. It first helps to define some constants
    representing the visual output:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½ç»˜åˆ¶æ¸¸æˆçš„è§†è§‰è¾“å‡ºã€‚æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªåŒ…å«æ‰€æœ‰å¿…è¦ç»„ä»¶çš„å›¾åƒã€‚é¦–å…ˆï¼Œå®šä¹‰ä¸€äº›è¡¨ç¤ºè§†è§‰è¾“å‡ºçš„å¸¸é‡æ˜¯æœ‰å¸®åŠ©çš„ï¼š
- en: '[PRE5]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Using these, we can create a blank canvas, and overlay rectangles representing
    water and land:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨è¿™äº›ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç©ºç™½ç”»å¸ƒï¼Œå¹¶åœ¨å…¶ä¸Šå åŠ è¡¨ç¤ºæ°´å’Œé™†åœ°çš„çŸ©å½¢ï¼š
- en: '[PRE6]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Examine the value of `BACKGROUND` in the interactions area to confirm that it
    looks right.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: æ£€æŸ¥äº¤äº’åŒºåŸŸä¸­çš„`BACKGROUND`å€¼ï¼Œä»¥ç¡®è®¤å®ƒçœ‹èµ·æ¥æ­£ç¡®ã€‚
- en: Do Now!
  id: totrans-81
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç°åœ¨è¡ŒåŠ¨èµ·æ¥ï¼
- en: ''
  id: totrans-82
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: The reason we divide by two when placing `BASE` is because Pyret puts the middle
    of the image at the given location. Remove the division and see what happens to
    the resulting image.
  id: totrans-83
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬åœ¨æ”¾ç½®`BASE`æ—¶é™¤ä»¥äºŒçš„åŸå› æ˜¯Pyretå°†å›¾åƒçš„ä¸­é—´ä½ç½®æ”¾åœ¨ç»™å®šä½ç½®ã€‚å»æ‰é™¤æ³•ï¼Œçœ‹çœ‹ç»“æœå›¾åƒä¼šå‘ç”Ÿä»€ä¹ˆå˜åŒ–ã€‚
- en: 'Now that we know how to get our background, weâ€™re ready to place the airplane
    on it. The expression to do so looks roughly like this:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†å¦‚ä½•è·å–æˆ‘ä»¬çš„èƒŒæ™¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†é£æœºæ”¾ç½®åœ¨ä¸Šé¢ã€‚æ‰§è¡Œæ­¤æ“ä½œçš„è¡¨è¾¾å¼çœ‹èµ·æ¥å¤§è‡´å¦‚ä¸‹ï¼š
- en: '[PRE7]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'but what x position do we use? Actually, thatâ€™s just what the World State represents!
    So we create a function out of this expression:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†æˆ‘ä»¬ä½¿ç”¨ä»€ä¹ˆxä½ç½®å‘¢ï¼Ÿå®é™…ä¸Šï¼Œè¿™æ­£æ˜¯ä¸–ç•ŒçŠ¶æ€æ‰€ä»£è¡¨çš„ï¼å› æ­¤ï¼Œæˆ‘ä»¬ä»è¿™ä¸ªè¡¨è¾¾å¼åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼š
- en: '[PRE8]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 27.3.3Â Observing Time (and Combining the Pieces)[ğŸ”—](#(part._.Observing_.Time__and_.Combining_the_.Pieces_)
    "Link to here")
  id: totrans-88
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 27.3.3 è§‚å¯Ÿæ—¶é—´ï¼ˆå¹¶ç»„åˆéƒ¨ä»¶ï¼‰[ğŸ”—](#(part._.Observing_.Time__and_.Combining_the_.Pieces_)
    "é“¾æ¥åˆ°æ­¤å¤„")
- en: Finally, weâ€™re ready to put these pieces together.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œæˆ‘ä»¬å‡†å¤‡å¥½å°†è¿™äº›éƒ¨ä»¶ç»„åˆåœ¨ä¸€èµ·ã€‚
- en: We create a special kind of Pyret value called a reactor, which creates animations.
    Weâ€™ll start by creating a fairly simple kind of reactor, then grow it as the program
    gets more sophisticated.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬åˆ›å»ºäº†ä¸€ç§ç‰¹æ®Šçš„Pyretå€¼ï¼Œç§°ä¸ºååº”å™¨ï¼Œç”¨äºåˆ›å»ºåŠ¨ç”»ã€‚æˆ‘ä»¬å°†ä»åˆ›å»ºä¸€ç§ç›¸å½“ç®€å•çš„ååº”å™¨å¼€å§‹ï¼Œç„¶åéšç€ç¨‹åºçš„å¤æ‚åŒ–é€æ¸æ‰©å±•å®ƒã€‚
- en: 'The following code creates a reactor named `anim`:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥ä¸‹ä»£ç åˆ›å»ºäº†ä¸€ä¸ªåä¸º`anim`çš„ååº”å™¨ï¼š
- en: '[PRE9]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: A reactor needs to be given an initial World State as well as handlers that
    tell it how to react. Specifying `on-tick` tells Pyret to run a clock and, every
    time the clock ticks (roughly thirty times a second), invoke the associated handler.
    The `to-draw` handler is used by Pyret to refresh the visual display.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªååº”å™¨éœ€è¦è¢«èµ‹äºˆä¸€ä¸ªåˆå§‹ä¸–ç•ŒçŠ¶æ€ä»¥åŠå‘Šè¯‰å®ƒå¦‚ä½•ååº”çš„å¤„ç†ç¨‹åºã€‚æŒ‡å®š `on-tick` å‘Šè¯‰ Pyret è¿è¡Œä¸€ä¸ªæ—¶é’Ÿï¼Œå¹¶ä¸”æ¯å½“æ—¶é’Ÿæ»´ç­”ï¼ˆå¤§çº¦æ¯ç§’ä¸‰åæ¬¡ï¼‰æ—¶ï¼Œè°ƒç”¨ç›¸å…³å¤„ç†ç¨‹åºã€‚`to-draw`
    å¤„ç†ç¨‹åºè¢« Pyret ç”¨äºåˆ·æ–°è§†è§‰æ˜¾ç¤ºã€‚
- en: 'Having defined this reactor, we can run it in several ways that are useful
    for finding errors, running scientific experiments, and so on. Our needs here
    are simple; we ask Pyret to just run the program on the screen interactively:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: å®šä¹‰äº†è¿™ä¸ªååº”å™¨åï¼Œæˆ‘ä»¬å¯ä»¥ä»¥å‡ ç§æœ‰ç”¨çš„æ–¹å¼è¿è¡Œå®ƒï¼Œæ¯”å¦‚æŸ¥æ‰¾é”™è¯¯ã€è¿è¡Œç§‘å­¦å®éªŒç­‰ç­‰ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œçš„éœ€æ±‚å¾ˆç®€å•ï¼›æˆ‘ä»¬è¦æ±‚ Pyret äº¤äº’å¼åœ°åœ¨å±å¹•ä¸Šè¿è¡Œç¨‹åºï¼š
- en: '[PRE10]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: This creates a running program where the airplane flies across the background!
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™åˆ›å»ºäº†ä¸€ä¸ªé£æœºåœ¨èƒŒæ™¯ä¸­é£è¡Œçš„è¿è¡Œç¨‹åºï¼
- en: Thatâ€™s it! Weâ€™ve created our first animation. Now that weâ€™ve gotten all the
    preliminaries out of the way, we can go about enhancing it.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: å°±è¿™æ ·ï¼æˆ‘ä»¬åˆ›å»ºäº†æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªåŠ¨ç”»ã€‚ç°åœ¨æˆ‘ä»¬å·²ç»è§£å†³äº†æ‰€æœ‰åˆæ­¥é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç€æ‰‹å¢å¼ºå®ƒã€‚
- en: Exercise
  id: totrans-98
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-99
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: If you want the airplane to appear to move faster, what can you change?
  id: totrans-100
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å¦‚æœä½ æƒ³è®©é£æœºçœ‹èµ·æ¥ç§»åŠ¨å¾—æ›´å¿«ï¼Œä½ å¯ä»¥æ”¹å˜ä»€ä¹ˆï¼Ÿ
- en: '27.4Â Version: Wrapping Around[ğŸ”—](#(part._.Version__.Wrapping_.Around) "Link
    to here")'
  id: totrans-101
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.4 ç‰ˆæœ¬ï¼šç»•åœˆ[ğŸ”—](#(part._.Version__.Wrapping_.Around) "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'When you run the preceding program, youâ€™ll notice that after a while, the airplane
    just disappears. This is because it has gone past the right edge of the screen;
    it is still being â€œdrawnâ€, but in a location that you cannot see. Thatâ€™s not very
    useful!Also, after a long while you might get an error because the computer is
    being asked to draw the airplane at a location beyond what the graphics system
    can manage. Instead, when the airplane is about to go past the right edge of the
    screen, weâ€™d like it to reappear on the left by a corresponding amount: â€œwrapping
    aroundâ€, as it were.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: å½“ä½ è¿è¡Œå‰é¢çš„ç¨‹åºæ—¶ï¼Œä½ ä¼šæ³¨æ„åˆ°è¿‡äº†ä¸€æ®µæ—¶é—´åï¼Œé£æœºå°±æ¶ˆå¤±äº†ã€‚è¿™æ˜¯å› ä¸ºé£æœºå·²ç»é£è¿‡äº†å±å¹•çš„å³è¾¹ç¼˜ï¼›å®ƒä»ç„¶åœ¨â€œç»˜åˆ¶â€ï¼Œä½†ä½ç½®æ˜¯ä½ çœ‹ä¸åˆ°çš„ã€‚è¿™å¹¶ä¸å¤ªæœ‰ç”¨ï¼æ­¤å¤–ï¼Œè¿‡ä¸€æ®µæ—¶é—´åï¼Œä½ å¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºè®¡ç®—æœºè¢«è¦æ±‚åœ¨å›¾å½¢ç³»ç»Ÿæ— æ³•ç®¡ç†çš„ä½ç½®ç»˜åˆ¶é£æœºã€‚ç›¸åï¼Œå½“é£æœºå³å°†é£è¿‡å±å¹•çš„å³è¾¹ç¼˜æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒä»¥ç›¸åº”çš„é‡åœ¨å·¦ä¾§é‡æ–°å‡ºç°ï¼šâ€œç»•åœˆâ€ï¼Œå°±åƒé‚£æ ·ã€‚
- en: '[Hereâ€™s the video for this version.](https://drive.google.com/file/d/1zL4PY1vOWgFMBuPmMvr8wixh5VE9Pg_r/view?usp=share_link)'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '[è¿™é‡Œæ˜¯è¿™ä¸ªç‰ˆæœ¬çš„è§†é¢‘ã€‚](https://drive.google.com/file/d/1zL4PY1vOWgFMBuPmMvr8wixh5VE9Pg_r/view?usp=share_link)'
- en: Do Now!
  id: totrans-104
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç°åœ¨å°±åšï¼
- en: ''
  id: totrans-105
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: What needs to change?
  id: totrans-106
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: éœ€è¦æ”¹å˜ä»€ä¹ˆï¼Ÿ
- en: Clearly, we need to modify the function that updates the airplaneâ€™s location,
    since this must now reflect our decision to wrap around. But the task of how to
    draw the airplane doesnâ€™t need to change at all! Similarly, the definition of
    the World State does not need to change, either.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: æ˜¾ç„¶ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹æ›´æ–°é£æœºä½ç½®çš„å‡½æ•°ï¼Œå› ä¸ºç°åœ¨å®ƒå¿…é¡»åæ˜ æˆ‘ä»¬ç»•åœˆçš„å†³å®šã€‚ä½†ç»˜åˆ¶é£æœºçš„ä»»åŠ¡æ ¹æœ¬ä¸éœ€è¦æ”¹å˜ï¼åŒæ ·ï¼Œä¸–ç•ŒçŠ¶æ€çš„å®šä¹‰ä¹Ÿä¸éœ€è¦æ”¹å˜ã€‚
- en: 'Therefore, we only need to modify `move-airplane-x-on-tick`. The function `num-modulo`
    does exactly what we need. That is, we want the x-location to always be modulo
    the width of the scene:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹ `move-airplane-x-on-tick`ã€‚å‡½æ•° `num-modulo` æ­£å¥½æ˜¯æˆ‘ä»¬éœ€è¦çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¸Œæœ› x ä½ç½®å§‹ç»ˆæ˜¯åœºæ™¯å®½åº¦çš„æ¨¡æ•°ï¼š
- en: '[PRE11]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Notice that, instead of copying the content of the previous definition we can
    simply reuse it:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œæˆ‘ä»¬ä¸å¿…å¤åˆ¶ä¸Šä¸€ä¸ªå®šä¹‰çš„å†…å®¹ï¼Œå¯ä»¥ç›´æ¥é‡ç”¨å®ƒï¼š
- en: '[PRE12]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'which makes our intent clearer: compute whatever position we would have had
    before, but adapt the coordinate to remain within the sceneâ€™s width.'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä½¿å¾—æˆ‘ä»¬çš„æ„å›¾æ›´æ¸…æ™°ï¼šè®¡ç®—æˆ‘ä»¬åŸæœ¬ä¼šæœ‰çš„ä»»ä½•ä½ç½®ï¼Œä½†è°ƒæ•´åæ ‡ä»¥ä¿æŒåœ¨åœºæ™¯å®½åº¦å†…ã€‚
- en: 'Well, thatâ€™s a proposed re-definition. Be sure to test this function thoroughly:
    itâ€™s tricker than you might think! Have you thought about all the cases? For instance,
    what happens if the airplane is half-way off the right edge of the screen?'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: å¥½å§ï¼Œè¿™æ˜¯ä¸€ä¸ªæè®®çš„é‡æ–°å®šä¹‰ã€‚åŠ¡å¿…å½»åº•æµ‹è¯•è¿™ä¸ªå‡½æ•°ï¼šå®ƒæ¯”ä½ æƒ³è±¡çš„è¦å¤æ‚ï¼ä½ è€ƒè™‘è¿‡æ‰€æœ‰çš„æƒ…å†µå—ï¼Ÿä¾‹å¦‚ï¼Œå¦‚æœé£æœºçš„ä¸€åŠåœ¨å±å¹•çš„å³è¾¹ç¼˜ä¹‹å¤–ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ
- en: Exercise
  id: totrans-114
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-115
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Define quality tests for `move-airplane-wrapping-x-on-tick`.
  id: totrans-116
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å®šä¹‰ `move-airplane-wrapping-x-on-tick` çš„è´¨é‡æµ‹è¯•ã€‚
- en: Note
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„
- en: It is possible to leave `move-airplane-x-on-tick` unchanged and perform the
    modular arithmetic in `place-airplane-x` instead. We choose not to do that for
    the following reason. In this version, we really do think of the airplane as circling
    around and starting again from the left edge (imagine the world is a cylinder...).
    Thus, the airplaneâ€™s x-position really does keep going back down. If instead we
    allowed the World State to increase monotonically, then it would really be representing
    the total distance traveled, contradicting our definition of the World State.
  id: totrans-118
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æœ‰å¯èƒ½ä¿æŒ `move-airplane-x-on-tick` ä¸å˜ï¼Œå¹¶åœ¨ `place-airplane-x` ä¸­æ‰§è¡Œæ¨¡è¿ç®—ã€‚æˆ‘ä»¬é€‰æ‹©ä¸è¿™æ ·åšçš„åŸå› å¦‚ä¸‹ã€‚åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬çœŸçš„è®¤ä¸ºé£æœºæ˜¯å›´ç»•åœ†å½¢é£è¡Œå¹¶ä»å·¦ä¾§è¾¹ç¼˜é‡æ–°å¼€å§‹ï¼ˆæƒ³è±¡ä¸–ç•Œæ˜¯ä¸€ä¸ªåœ†æŸ±ä½“...ï¼‰ã€‚å› æ­¤ï¼Œé£æœºçš„
    x ä½ç½®ç¡®å®ä¼šä¸æ–­ä¸‹é™ã€‚å¦‚æœæˆ‘ä»¬å…è®¸ä¸–ç•ŒçŠ¶æ€å•è°ƒå¢åŠ ï¼Œé‚£ä¹ˆå®ƒå°†çœŸæ­£ä»£è¡¨æ€»è¡Œç¨‹è·ç¦»ï¼Œè¿™ä¸æˆ‘ä»¬å¯¹ä¸–ç•ŒçŠ¶æ€çš„å®šä¹‰ç›¸çŸ›ç›¾ã€‚
- en: Do Now!
  id: totrans-119
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç«‹åˆ»è¡ŒåŠ¨ï¼
- en: ''
  id: totrans-120
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: After adding this function, run your program again. Did you see any change in
    behavior?
  id: totrans-121
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ·»åŠ æ­¤å‡½æ•°åï¼Œå†æ¬¡è¿è¡Œä½ çš„ç¨‹åºã€‚ä½ çœ‹åˆ°ä»»ä½•è¡Œä¸ºä¸Šçš„å˜åŒ–å—ï¼Ÿ
- en: If you didnâ€™tâ€¦did you remember to update your reactor to use the new airplane-moving
    function?
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ æ²¡æœ‰â€¦â€¦ä½ è®°å¾—æ›´æ–°ä½ çš„ååº”å †ä»¥ä½¿ç”¨æ–°çš„é£æœºç§»åŠ¨å‡½æ•°å—ï¼Ÿ
- en: '27.5Â Version: Descending[ğŸ”—](#(part._.Version__.Descending) "Link to here")'
  id: totrans-123
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.5 ç‰ˆæœ¬ï¼šä¸‹é™[ğŸ”—](#(part._.Version__.Descending) "é“¾æ¥è‡³æ­¤")
- en: 'Of course, we need our airplane to move in more than just one dimension: to
    get to the final game, it must both ascend and descend as well. For now, weâ€™ll
    focus on the simplest version of this, which is an airplane that continuously
    descends. [Hereâ€™s a video.](https://drive.google.com/file/d/1fJ7eJ7Uv-YCXm87OKH5obAYFXp1pAnZo/view?usp=share_link)'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: å½“ç„¶ï¼Œæˆ‘ä»¬éœ€è¦æˆ‘ä»¬çš„é£æœºåœ¨ä¸æ­¢ä¸€ä¸ªç»´åº¦ä¸Šç§»åŠ¨ï¼šä¸ºäº†è¾¾åˆ°æœ€ç»ˆçš„æ¸¸æˆï¼Œå®ƒå¿…é¡»æ—¢èƒ½ä¸Šå‡ä¹Ÿèƒ½ä¸‹é™ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä¸“æ³¨äºè¿™ä¸ªæœ€ç®€å•çš„ç‰ˆæœ¬ï¼Œå³ä¸€ä¸ªæŒç»­ä¸‹é™çš„é£æœºã€‚[è¿™é‡Œæœ‰ä¸€ä¸ªè§†é¢‘ã€‚](https://drive.google.com/file/d/1fJ7eJ7Uv-YCXm87OKH5obAYFXp1pAnZo/view?usp=share_link)
- en: Letâ€™s again consider individual frames of this video. Whatâ€™s staying the same?
    Once again, the water and the land. Whatâ€™s changing? The position of the airplane.
    But, whereas before the airplane moved only in the x-dimension, now it moves in
    both x and y. That immediately tells us that our definition of the World State
    is inadequate, and must be modified.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬å†æ¬¡è€ƒè™‘è¿™ä¸ªè§†é¢‘çš„å•ç‹¬å¸§ã€‚ä»€ä¹ˆä¿æŒä¸å˜ï¼Ÿå†æ¬¡ï¼Œæ°´å’Œé™†åœ°ã€‚ä»€ä¹ˆåœ¨å˜åŒ–ï¼Ÿé£æœºçš„ä½ç½®ã€‚ä½†æ˜¯ï¼Œä¸ä¹‹å‰é£æœºåªåœ¨ x è½´ä¸Šç§»åŠ¨ä¸åŒï¼Œç°åœ¨å®ƒåœ¨ x å’Œ y è½´ä¸Šç§»åŠ¨ã€‚è¿™ç«‹å³å‘Šè¯‰æˆ‘ä»¬ï¼Œæˆ‘ä»¬å¯¹ä¸–ç•ŒçŠ¶æ€çš„å®šä¹‰æ˜¯ä¸å……åˆ†çš„ï¼Œå¿…é¡»è¿›è¡Œä¿®æ”¹ã€‚
- en: 'We therefore define a new structure to hold this pair of data:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ–°çš„ç»“æ„æ¥ä¿å­˜è¿™ä¸ªæ•°æ®å¯¹ï¼š
- en: '[PRE13]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Given this, we can revise our definition:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®è®¢æˆ‘ä»¬çš„å®šä¹‰ï¼š
- en: World Definition
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸–ç•Œå®šä¹‰
- en: The World State is a `posn`, representing the x-position and y-position of the
    airplane on the screen.
  id: totrans-130
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸–ç•ŒçŠ¶æ€æ˜¯ä¸€ä¸ª `posn`ï¼Œè¡¨ç¤ºé£æœºåœ¨å±å¹•ä¸Šçš„ x ä½ç½®å’Œ y ä½ç½®ã€‚
- en: 27.5.1Â Moving the Airplane[ğŸ”—](#(part._.Moving_the_.Airplane) "Link to here")
  id: totrans-131
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 27.5.1 ç§»åŠ¨é£æœº[ğŸ”—](#(part._.Moving_the_.Airplane) "é“¾æ¥è‡³æ­¤")
- en: 'First, letâ€™s consider `move-airplane-wrapping-x-on-tick`. Previously our airplane
    moved only in the x-direction; now we want it to descend as well, which means
    we must add something to the current y value:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œè®©æˆ‘ä»¬è€ƒè™‘ `move-airplane-wrapping-x-on-tick`ã€‚ä¹‹å‰æˆ‘ä»¬çš„é£æœºåªåœ¨ x æ–¹å‘ä¸Šç§»åŠ¨ï¼›ç°åœ¨æˆ‘ä»¬å¸Œæœ›å®ƒä¹Ÿèƒ½ä¸‹é™ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¿…é¡»å‘å½“å‰çš„
    y å€¼æ·»åŠ ä¸€äº›å†…å®¹ï¼š
- en: '[PRE14]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Letâ€™s write some test cases for the new function. Hereâ€™s one:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä¸ºè¿™ä¸ªæ–°å‡½æ•°ç¼–å†™ä¸€äº›æµ‹è¯•ç”¨ä¾‹ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­ï¼š
- en: '[PRE15]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Another way to write the test would be:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: å¦ä¸€ç§ç¼–å†™æµ‹è¯•çš„æ–¹æ³•æ˜¯ï¼š
- en: '[PRE16]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Note
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„
- en: 'Which method of writing tests is better? Both! They each offer different advantages:'
  id: totrans-139
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å“ªç§ç¼–å†™æµ‹è¯•çš„æ–¹æ³•æ›´å¥½ï¼Ÿä¸¤è€…éƒ½å¥½ï¼å®ƒä»¬å„è‡ªæä¾›äº†ä¸åŒçš„ä¼˜ç‚¹ï¼š
- en: ''
  id: totrans-140
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'The former method has the benefit of being very concrete: thereâ€™s no question
    what you expect, and it demonstrates that you really can compute the desired answer
    from first principles.'
  id: totrans-141
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‰è€…æ–¹æ³•çš„å¥½å¤„æ˜¯å®ƒéå¸¸å…·ä½“ï¼šä½ æœŸæœ›çš„æ²¡æœ‰ç–‘é—®ï¼Œå¹¶ä¸”å®ƒè¯æ˜äº†ä½ å¯ä»¥ä»ç¬¬ä¸€åŸç†è®¡ç®—å‡ºæ‰€éœ€çš„ç­”æ¡ˆã€‚
- en: ''
  id: totrans-142
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-143
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: The latter method has the advantage that, if you change the constants in your
    program (such as the rate of descent), seemingly correct tests do not suddenly
    fail. That is, this form of testing is more about the relationships between things
    rather than their precise values.
  id: totrans-144
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: åè€…æ–¹æ³•çš„ä¼˜ç‚¹åœ¨äºï¼Œå¦‚æœä½ æ›´æ”¹ç¨‹åºä¸­çš„å¸¸æ•°ï¼ˆä¾‹å¦‚ä¸‹é™é€Ÿç‡ï¼‰ï¼Œçœ‹ä¼¼æ­£ç¡®çš„æµ‹è¯•ä¸ä¼šçªç„¶å¤±è´¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ç§æµ‹è¯•å½¢å¼æ›´å¤šåœ°å…³æ³¨äº‹ç‰©ä¹‹é—´çš„å…³ç³»ï¼Œè€Œä¸æ˜¯å®ƒä»¬çš„ç²¾ç¡®å€¼ã€‚
- en: ''
  id: totrans-145
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-146
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-147
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'There is one more choice available, which often combines the best of both worlds:
    write the answer as concretely as possible (the former style), but using constants
    to compute the answer (the advantage of the latter style). For instance:'
  id: totrans-148
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: è¿˜æœ‰ä¸€ä¸ªå¯ç”¨çš„é€‰æ‹©ï¼Œå®ƒé€šå¸¸ç»“åˆäº†ä¸¤ç§æ–¹æ³•çš„ä¼˜ç‚¹ï¼šå°½å¯èƒ½å…·ä½“åœ°å†™å‡ºç­”æ¡ˆï¼ˆå‰è€…é£æ ¼ï¼‰ï¼Œä½†ä½¿ç”¨å¸¸æ•°æ¥è®¡ç®—ç­”æ¡ˆï¼ˆåè€…é£æ ¼çš„ä¼˜åŠ¿ï¼‰ã€‚ä¾‹å¦‚ï¼š
- en: ''
  id: totrans-149
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE17]'
  id: totrans-150
  prefs:
  - PREF_BQ
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Exercise
  id: totrans-151
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-152
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Before you proceed, have you written enough test cases? Are you sure? Have you,
    for instance, tested what should happen when the airplane is near the edge of
    the screen in either or both dimensions? We thought notâ€”<wbr>go back and write
    more tests before you proceed!
  id: totrans-153
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åœ¨ä½ ç»§ç»­ä¹‹å‰ï¼Œä½ æ˜¯å¦å·²ç»ç¼–å†™äº†è¶³å¤Ÿçš„æµ‹è¯•ç”¨ä¾‹ï¼Ÿä½ ç¡®å®šäº†å—ï¼Ÿä¾‹å¦‚ï¼Œä½ æ˜¯å¦æµ‹è¯•äº†å½“é£æœºåœ¨å±å¹•è¾¹ç¼˜é™„è¿‘æ—¶ï¼Œåœ¨ä»»ä¸€æˆ–ä¸¤ä¸ªç»´åº¦ä¸Šåº”è¯¥å‘ç”Ÿä»€ä¹ˆï¼Ÿæˆ‘ä»¬è®¤ä¸ºä½ æ²¡æœ‰â€”â€”åœ¨ç»§ç»­ä¹‹å‰ï¼Œå›å»ç¼–å†™æ›´å¤šçš„æµ‹è¯•ï¼
- en: 'Using the design recipe, now define `move-airplane-xy-on-tick`. You should
    end up with something like this:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨è®¾è®¡é…æ–¹ï¼Œç°åœ¨å®šä¹‰ `move-airplane-xy-on-tick`ã€‚ä½ åº”è¯¥å¾—åˆ°ç±»ä¼¼ä»¥ä¸‹çš„å†…å®¹ï¼š
- en: '[PRE18]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Note that we have reused the existing function for the x-dimension and, correspondingly,
    created a helper for the y dimension:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œæˆ‘ä»¬å·²ç»é‡ç”¨äº†ç°æœ‰çš„xç»´åº¦çš„å‡½æ•°ï¼Œå¹¶ç›¸åº”åœ°ä¸ºyç»´åº¦åˆ›å»ºäº†ä¸€ä¸ªè¾…åŠ©å‡½æ•°ï¼š
- en: '[PRE19]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: This may be slight overkill for now, but it does lead to a cleaner separation
    of concerns, and makes it possible for the complexity of movement in each dimension
    to evolve independently while keeping the code relatively readable.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: ç›®å‰è¿™å¯èƒ½æœ‰ç‚¹è¿‡åº¦ï¼Œä½†å®ƒç¡®å®å¯¼è‡´äº†å…³æ³¨ç‚¹çš„æ›´æ¸…æ™°åˆ†ç¦»ï¼Œå¹¶ä½¿å¾—æ¯ä¸ªç»´åº¦ä¸­è¿åŠ¨çš„å¤æ‚æ€§å¯ä»¥ç‹¬ç«‹æ¼”å˜ï¼ŒåŒæ—¶ä¿æŒä»£ç ç›¸å¯¹å¯è¯»ã€‚
- en: 27.5.2Â Drawing the Scene[ğŸ”—](#(part._.Drawing_the_.Scene) "Link to here")
  id: totrans-159
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 27.5.2 ç»˜åˆ¶åœºæ™¯[ğŸ”—](#(part._.Drawing_.the_.Scene) "é“¾æ¥è‡³æ­¤")
- en: 'We have to also examine and update `place-airplane-x`. Our earlier definition
    placed the airplane at an arbitrary y-coordinate; now we have to take the y-coordinate
    from the World State:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è¿˜å¿…é¡»æ£€æŸ¥å’Œæ›´æ–° `place-airplane-x`ã€‚æˆ‘ä»¬ä¹‹å‰çš„å®šä¹‰å°†é£æœºæ”¾ç½®åœ¨ä»»æ„çš„yåæ ‡ä¸Šï¼›ç°åœ¨æˆ‘ä»¬å¿…é¡»ä»ä¸–ç•ŒçŠ¶æ€ä¸­è·å–yåæ ‡ï¼š
- en: '[PRE20]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Notice that we canâ€™t really reuse the previous definition because it hard-coded
    the y-position, which we must now make a parameter.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œæˆ‘ä»¬å®é™…ä¸Šä¸èƒ½é‡ç”¨ä¹‹å‰çš„å®šä¹‰ï¼Œå› ä¸ºå®ƒç¡¬ç¼–ç äº†yåæ ‡ï¼Œè€Œæˆ‘ä»¬ç°åœ¨å¿…é¡»å°†å…¶ä½œä¸ºä¸€ä¸ªå‚æ•°ã€‚
- en: 27.5.3Â Finishing Touches[ğŸ”—](#(part._.Finishing_.Touches) "Link to here")
  id: totrans-163
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 27.5.3 å®Œç¾æ”¶å°¾[ğŸ”—](#(part._.Finishing_.Touches) "é“¾æ¥è‡³æ­¤")
- en: 'Are we done? It would seem so: weâ€™ve examined all the procedures that consume
    and produce World State and updated them appropriately. Actually, weâ€™re forgetting
    one small thing: the initial World State given to the reactor! If weâ€™ve changed
    the definition of World State, then we need to update this too. (We also need
    to use the new functions rather than the old ones.)'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å®Œæˆäº†å—ï¼Ÿçœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼šæˆ‘ä»¬å·²ç»æ£€æŸ¥äº†æ‰€æœ‰æ¶ˆè€—å’Œäº§ç”Ÿä¸–ç•ŒçŠ¶æ€çš„ç¨‹åºï¼Œå¹¶ç›¸åº”åœ°æ›´æ–°äº†å®ƒä»¬ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬å¿½ç•¥äº†ä¸€ä»¶äº‹ï¼šç»™ååº”å †æä¾›çš„åˆå§‹ä¸–ç•ŒçŠ¶æ€ï¼å¦‚æœæˆ‘ä»¬å·²ç»æ”¹å˜äº†ä¸–ç•ŒçŠ¶æ€çš„å®šä¹‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿéœ€è¦æ›´æ–°è¿™ä¸ªå®šä¹‰ã€‚ï¼ˆæˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨æ–°å‡½æ•°è€Œä¸æ˜¯æ—§å‡½æ•°ã€‚ï¼‰
- en: '[PRE21]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: Exercise
  id: totrans-166
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-167
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Itâ€™s a little unsatisfactory to have the airplane truncated by the screen. You
    can use `I.image-width` and `I.image-height` to obtain the dimensions of an image,
    such as the airplane. Use these to ensure the airplane fits entirely within the
    screen for the initial scene, and similarly in `move-airplane-xy-on-tick`.
  id: totrans-168
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: é£æœºè¢«å±å¹•æˆªæ–­æœ‰ç‚¹ä»¤äººä¸æ»¡æ„ã€‚ä½ å¯ä»¥ä½¿ç”¨ `I.image-width` å’Œ `I.image-height` æ¥è·å–å›¾åƒçš„å°ºå¯¸ï¼Œä¾‹å¦‚é£æœºã€‚ä½¿ç”¨è¿™äº›å°ºå¯¸ç¡®ä¿é£æœºåœ¨åˆå§‹åœºæ™¯ä¸­å®Œå…¨ä½äºå±å¹•å†…ï¼Œåœ¨
    `move-airplane-xy-on-tick` ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚
- en: '27.6Â Version: Responding to Keystrokes[ğŸ”—](#(part._.Version__.Responding_to_.Keystrokes)
    "Link to here")'
  id: totrans-169
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.6 ç‰ˆæœ¬ï¼šå“åº”æŒ‰é”®[ğŸ”—](#(part._.Version__.Responding_to_.Keystrokes) "é“¾æ¥è‡³æ­¤")
- en: Now that we have the airplane descending, thereâ€™s no reason it canâ€™t ascend
    as well. [Hereâ€™s a video.](https://drive.google.com/file/d/1IZw4NrmXsJ-KRaE1GNRhL2Cl3kU27whu/view?usp=share_link)
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬æœ‰äº†é£æœºä¸‹é™ï¼Œæ²¡æœ‰ç†ç”±å®ƒä¸èƒ½ä¸Šå‡ã€‚ [è¿™é‡Œæœ‰ä¸€ä¸ªè§†é¢‘ã€‚](https://drive.google.com/file/d/1IZw4NrmXsJ-KRaE1GNRhL2Cl3kU27whu/view?usp=share_link)
- en: 'Weâ€™ll use the keyboard to control its motion: specifically, the up-key will
    make it move up, while the down-key will make it descend even faster. This is
    easy to support using what we already know: we just need to provide one more handler
    using `on-key`. This handler takes two arguments: the first is the current value
    of the world, while the second is a representation of which key was pressed. For
    the purposes of this program, the only key values we care about are `"up"` and
    `"down"`.'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†ä½¿ç”¨é”®ç›˜æ¥æ§åˆ¶å…¶è¿åŠ¨ï¼šå…·ä½“æ¥è¯´ï¼Œä¸Šé”®ä¼šä½¿å®ƒå‘ä¸Šç§»åŠ¨ï¼Œè€Œä¸‹é”®ä¼šä½¿å®ƒä¸‹é™å¾—æ›´å¿«ã€‚è¿™å¾ˆå®¹æ˜“æ”¯æŒï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»çŸ¥é“å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ï¼šæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ `on-key`
    æä¾›ä¸€ä¸ªé¢å¤–çš„å¤„ç†ç¨‹åºã€‚è¿™ä¸ªå¤„ç†ç¨‹åºæ¥å—ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªæ˜¯ä¸–ç•Œçš„å½“å‰å€¼ï¼Œç¬¬äºŒä¸ªæ˜¯æŒ‰ä¸‹çš„é”®çš„è¡¨ç¤ºã€‚å¯¹äºè¿™ä¸ªç¨‹åºï¼Œæˆ‘ä»¬å”¯ä¸€å…³å¿ƒçš„é”®å€¼æ˜¯ `"up"` å’Œ `"down"`ã€‚
- en: 'This gives us a fairly comprehensive view of the core capabilities of reactors:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç›¸å½“å…¨é¢çš„ååº”å †æ ¸å¿ƒåŠŸèƒ½è§†å›¾ï¼š
- en: '![](../Images/4925a999ce7daf16dda269c55117e5c5.png)'
  id: totrans-173
  prefs:
  - PREF_BQ
  type: TYPE_IMG
  zh: '![](../Images/4925a999ce7daf16dda269c55117e5c5.png)'
- en: We just define a group of functions to perform all our desired actions, and
    the reactor strings them together. Some functions update world values (sometimes
    taking additional information about a stimulus, such as the key pressed), while
    others transform them into output (such as what we see on the screen).
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬åªå®šä¹‰äº†ä¸€ç»„å‡½æ•°æ¥æ‰§è¡Œæ‰€æœ‰æˆ‘ä»¬å¸Œæœ›æ‰§è¡Œçš„æ“ä½œï¼Œååº”å™¨å°†å®ƒä»¬è¿æ¥èµ·æ¥ã€‚ä¸€äº›å‡½æ•°æ›´æ–°ä¸–ç•Œå€¼ï¼ˆæœ‰æ—¶éœ€è¦å…³äºåˆºæ¿€ç‰©çš„é¢å¤–ä¿¡æ¯ï¼Œä¾‹å¦‚æŒ‰ä¸‹çš„é”®ï¼‰ï¼Œè€Œå…¶ä»–å‡½æ•°å°†å®ƒä»¬è½¬æ¢æˆè¾“å‡ºï¼ˆä¾‹å¦‚æˆ‘ä»¬åœ¨å±å¹•ä¸Šçœ‹åˆ°çš„å†…å®¹ï¼‰ã€‚
- en: 'Returning to our program, letâ€™s define a constant representing how much distance
    a key represents:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: è¿”å›æˆ‘ä»¬çš„ç¨‹åºï¼Œè®©æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªè¡¨ç¤ºä¸€ä¸ªé”®ä»£è¡¨å¤šå°‘è·ç¦»çš„å¸¸é‡ï¼š
- en: '[PRE22]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Now we can define a function that alterâ€™s the airplaneâ€™s position by that distance
    depending on which key is pressed:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œæ ¹æ®æŒ‰ä¸‹çš„å“ªä¸ªé”®ï¼Œé€šè¿‡è¿™ä¸ªè·ç¦»æ”¹å˜é£æœºçš„ä½ç½®ï¼š
- en: '[PRE23]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Do Now!
  id: totrans-179
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç°åœ¨è¡ŒåŠ¨ï¼
- en: ''
  id: totrans-180
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Why does this function definition contain
  id: totrans-181
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸ºä»€ä¹ˆè¿™ä¸ªå‡½æ•°å®šä¹‰åŒ…å«
- en: ''
  id: totrans-182
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE24]'
  id: totrans-183
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_PRE
  zh: '[PRE24]'
- en: ''
  id: totrans-184
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
- en: as its last condition?
  id: totrans-185
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä½œä¸ºå…¶æœ€åä¸€ä¸ªæ¡ä»¶ï¼Ÿ
- en: Notice that if we receive any key other than the two we expect, we leave the
    World State as it was; from the userâ€™s perspective, this has the effect of just
    ignoring the keystroke. Remove this last clause, press some other key, and watch
    what happens!
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œå¦‚æœæˆ‘ä»¬æ”¶åˆ°é™¤æˆ‘ä»¬æœŸæœ›çš„ä¸¤ä¸ªé”®ä»¥å¤–çš„ä»»ä½•é”®ï¼Œæˆ‘ä»¬å°†World Stateä¿æŒä¸å˜ï¼›ä»ç”¨æˆ·çš„è§†è§’æ¥çœ‹ï¼Œè¿™ç›¸å½“äºåªæ˜¯å¿½ç•¥äº†æŒ‰é”®ã€‚ç§»é™¤è¿™ä¸ªæœ€åçš„æ¡æ¬¾ï¼ŒæŒ‰ä¸‹ä¸€ä¸ªå…¶ä»–é”®ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼
- en: No matter what you choose, be sure to test this! Can the airplane drift off
    the top of the screen? How about off the screen at the bottom? Can it overlap
    with the land or water?
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: æ— è®ºä½ é€‰æ‹©ä»€ä¹ˆï¼Œä¸€å®šè¦æµ‹è¯•è¿™ä¸ªï¼é£æœºèƒ½å¦ä»å±å¹•é¡¶éƒ¨æ¼‚ç§»å‡ºå»ï¼Ÿåº•éƒ¨å‘¢ï¼Ÿå®ƒèƒ½ä¸é™†åœ°æˆ–æ°´é¢é‡å å—ï¼Ÿ
- en: 'Once weâ€™ve written and thoroughly tested this function, we simply need to ask
    Pyret to use it to handle keystrokes:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦æˆ‘ä»¬ç¼–å†™å¹¶å½»åº•æµ‹è¯•äº†è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦è¦æ±‚Pyretä½¿ç”¨å®ƒæ¥å¤„ç†æŒ‰é”®ï¼š
- en: '[PRE25]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: Now your airplane moves not only with the passage of time but also in response
    to your keystrokes. You can keep it up in the air forever!
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨é£æœºä¸ä»…éšç€æ—¶é—´æµé€è€Œç§»åŠ¨ï¼Œè¿˜ä¼šæ ¹æ®ä½ çš„æŒ‰é”®è€Œç§»åŠ¨ã€‚ä½ å¯ä»¥è®©å®ƒæ°¸è¿œä¿æŒåœ¨ç©ºä¸­ï¼
- en: '27.7Â Version: Landing[ğŸ”—](#(part._.Version__.Landing) "Link to here")'
  id: totrans-191
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.7 ç‰ˆæœ¬ï¼šé™è½[ğŸ”—](#(part._.Version__.Landing) "é“¾æ¥åˆ°è¿™é‡Œ")
- en: Remember that the objective of our game is to land the airplane, not to keep
    it airborne indefinitely. That means we need to detect when the airplane reaches
    the land or water level and, when it does, [terminate the animation](https://drive.google.com/file/d/1XbO-FHQIveD0f3KCvVlUZPjVLNpHW9NT/view?usp=share_link).
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: è®°ä½ï¼Œæˆ‘ä»¬æ¸¸æˆçš„ç›®æ ‡æ˜¯é™è½é£æœºï¼Œè€Œä¸æ˜¯è®©å®ƒæ— é™æœŸåœ°åœç•™åœ¨ç©ºä¸­ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦æ£€æµ‹é£æœºä½•æ—¶è¾¾åˆ°é™†åœ°æˆ–æ°´é¢ï¼Œå½“å®ƒè¾¾åˆ°æ—¶ï¼Œ[ç»ˆæ­¢åŠ¨ç”»](https://drive.google.com/file/d/1XbO-FHQIveD0f3KCvVlUZPjVLNpHW9NT/view?usp=share_link)ã€‚
- en: 'First, letâ€™s try to characterize when the animation should halt. This means
    writing a function that consumes the current World State and produces a boolean
    value: `true` if the animation should halt, `false` otherwise. This requires a
    little arithmetic based on the airplaneâ€™s size:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œè®©æˆ‘ä»¬å°è¯•æè¿°åŠ¨ç”»ä½•æ—¶åº”è¯¥åœæ­¢ã€‚è¿™æ„å‘³ç€ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¶ˆè€—å½“å‰çš„World Stateå¹¶äº§ç”Ÿä¸€ä¸ªå¸ƒå°”å€¼ï¼šå¦‚æœåŠ¨ç”»åº”è¯¥åœæ­¢ï¼Œåˆ™ä¸º`true`ï¼Œå¦åˆ™ä¸º`false`ã€‚è¿™éœ€è¦åŸºäºé£æœºå¤§å°çš„å°‘é‡ç®—æœ¯è¿ç®—ï¼š
- en: '[PRE26]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'We just need to inform Pyret to use this predicate to automatically halt the
    reactor:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬åªéœ€è¦é€šçŸ¥Pyretä½¿ç”¨è¿™ä¸ªè°“è¯æ¥è‡ªåŠ¨åœæ­¢ååº”å™¨ï¼š
- en: '[PRE27]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: Exercise
  id: totrans-197
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-198
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: When you test this, youâ€™ll see it isnâ€™t quite right because it doesnâ€™t take
    account of the size of the airplaneâ€™s image. As a result, the airplane only halts
    when itâ€™s half-way into the land or water, not when it first touches down. Adjust
    the formula so that it halts upon first contact.
  id: totrans-199
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å½“ä½ æµ‹è¯•æ—¶ï¼Œä½ ä¼šå‘ç°å®ƒå¹¶ä¸å®Œå…¨æ­£ç¡®ï¼Œå› ä¸ºå®ƒæ²¡æœ‰è€ƒè™‘åˆ°é£æœºå›¾åƒçš„å¤§å°ã€‚ç»“æœï¼Œé£æœºåªåœ¨å®ƒè¿›å…¥é™†åœ°æˆ–æ°´çš„ä¸€åŠæ—¶åœæ­¢ï¼Œè€Œä¸æ˜¯ç¬¬ä¸€æ¬¡æ¥è§¦åœ°é¢æ—¶ã€‚è°ƒæ•´å…¬å¼ï¼Œä½¿å…¶åœ¨ç¬¬ä¸€æ¬¡æ¥è§¦æ—¶åœæ­¢ã€‚
- en: Exercise
  id: totrans-200
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-201
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Extend this so that the airplane rolls for a while upon touching land, decelerating
    according to the laws of physics.
  id: totrans-202
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ‰©å±•è¿™ä¸ªåŠŸèƒ½ï¼Œä½¿å¾—é£æœºåœ¨æ¥è§¦é™†åœ°åæ»šåŠ¨ä¸€æ®µæ—¶é—´ï¼Œæ ¹æ®ç‰©ç†å®šå¾‹å‡é€Ÿã€‚
- en: Exercise
  id: totrans-203
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-204
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Suppose the airplane is actually landing at a secret subterranean airbase. The
    actual landing strip is actually below ground level, and opens up only when the
    airplane comes in to land. That means, after landing, only the parts of the airplane
    that stick above ground level would be visible. Implement this. As a hint, consider
    modifying `place-airplane-xy`.
  id: totrans-205
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å‡è®¾é£æœºå®é™…ä¸Šæ˜¯åœ¨ä¸€ä¸ªç§˜å¯†çš„åœ°ä¸‹æœºåœºé™è½ã€‚å®é™…çš„è·‘é“å®é™…ä¸Šåœ¨åœ°ä¸‹æ°´å¹³é¢ä»¥ä¸‹ï¼Œåªæœ‰åœ¨é£æœºè¿›å…¥é™è½æ—¶æ‰ä¼šæ‰“å¼€ã€‚è¿™æ„å‘³ç€ï¼Œé™è½ä¹‹åï¼Œåªæœ‰é£æœºéœ²å‡ºåœ°é¢çš„éƒ¨åˆ†æ‰ä¼šå¯è§ã€‚å®ç°è¿™ä¸€ç‚¹ã€‚ä½œä¸ºä¸€ä¸ªæç¤ºï¼Œè€ƒè™‘ä¿®æ”¹`place-airplane-xy`ã€‚
- en: '27.8Â Version: A Fixed Balloon[ğŸ”—](#(part._.Version__.A_.Fixed_.Balloon) "Link
    to here")'
  id: totrans-206
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.8 ç‰ˆæœ¬ï¼šå›ºå®šæ°”çƒ[ğŸ”—](#(part._.Version__.A_.Fixed_.Balloon) "é“¾æ¥åˆ°è¿™é‡Œ")
- en: Now letâ€™s add a balloon to the scene. [Hereâ€™s a video of the action.](https://drive.google.com/file/d/1QLt9tdt2sSPWR90-mmMLCDW4ZklgR_lN/view?usp=share_link)
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬ç»™åœºæ™¯æ·»åŠ ä¸€ä¸ªæ°”çƒã€‚[è¿™æ˜¯åŠ¨ä½œçš„è§†é¢‘ã€‚](https://drive.google.com/file/d/1QLt9tdt2sSPWR90-mmMLCDW4ZklgR_lN/view?usp=share_link)
- en: 'Notice that while the airplane moves, everything elseâ€”<wbr>including the balloonâ€”<wbr>stays
    immobile. Therefore, we do not need to alter the World State to record the balloonâ€™s
    position. All we need to do is alter the conditions under which the program halts:
    effectively, there is one more situation under which it terminates, and that is
    a collision with the balloon.'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œå½“é£æœºç§»åŠ¨æ—¶ï¼Œå…¶ä»–æ‰€æœ‰ä¸œè¥¿â€”â€”åŒ…æ‹¬æ°”çƒâ€”â€”éƒ½ä¿æŒé™æ­¢ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ”¹å˜ä¸–ç•ŒçŠ¶æ€æ¥è®°å½•æ°”çƒçš„ä½ç½®ã€‚æˆ‘ä»¬åªéœ€è¦æ”¹å˜ç¨‹åºåœæ­¢çš„æ¡ä»¶ï¼šå®é™…ä¸Šï¼Œåˆå¢åŠ äº†ä¸€ç§ç»ˆæ­¢æƒ…å†µï¼Œé‚£å°±æ˜¯ä¸æ°”çƒçš„ç¢°æ’ã€‚
- en: 'When does the game halt? There are now two circumstances: one is contact with
    land or water, and the other is contact with the balloon. The former remains unchanged
    from what it was before, so we can focus on the latter.'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: æ¸¸æˆä½•æ—¶åœæ­¢ï¼Ÿç°åœ¨æœ‰ä¸¤ç§æƒ…å†µï¼šä¸€ç§æ˜¯æ¥è§¦é™†åœ°æˆ–æ°´ï¼Œå¦ä¸€ç§æ˜¯æ¥è§¦æ°”çƒã€‚å‰è€…ä¸ä¹‹å‰ä¿æŒä¸å˜ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä¸“æ³¨äºåè€…ã€‚
- en: 'Where is the balloon, and how do we represent where it is? The latter is easy
    to answer: thatâ€™s what `posn`s are good for. As for the former, we can decide
    where it is:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: æ°”çƒåœ¨å“ªé‡Œï¼Œæˆ‘ä»¬å¦‚ä½•è¡¨ç¤ºå®ƒçš„ä½ç½®ï¼Ÿåè€…å¾ˆå®¹æ˜“å›ç­”ï¼šè¿™æ­£æ˜¯ `posn` çš„ç”¨é€”ã€‚è‡³äºå‰è€…ï¼Œæˆ‘ä»¬å¯ä»¥å†³å®šå®ƒçš„ä½ç½®ï¼š
- en: '[PRE28]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'or we can let Pyret pick a random position:'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ–è€…æˆ‘ä»¬å¯ä»¥è®© Pyret é€‰æ‹©ä¸€ä¸ªéšæœºä½ç½®ï¼š
- en: '[PRE29]'
  id: totrans-213
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Exercise
  id: totrans-214
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-215
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Improve the random placement of the balloon so that it is in credible spaces
    (e.g., not submerged).
  id: totrans-216
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ”¹è¿›æ°”çƒçš„éšæœºæ”¾ç½®ï¼Œä½¿å…¶ä½äºå¯ä¿¡çš„ç©ºé—´ä¸­ï¼ˆä¾‹å¦‚ï¼Œä¸è¦æµ¸æ²¡ï¼‰ã€‚
- en: 'Given a position for the balloon, we just need to detect collision. One simple
    way is as follows: determine whether the distance between the airplane and the
    balloon is within some threshold:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: ç»™å®šæ°”çƒçš„ä½ç½®ï¼Œæˆ‘ä»¬åªéœ€è¦æ£€æµ‹ç¢°æ’ã€‚ä¸€ç§ç®€å•çš„æ–¹æ³•å¦‚ä¸‹ï¼šç¡®å®šé£æœºå’Œæ°”çƒä¹‹é—´çš„è·ç¦»æ˜¯å¦åœ¨æŸä¸ªé˜ˆå€¼ä¹‹å†…ï¼š
- en: '[PRE30]'
  id: totrans-218
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: where `COLLISION-THRESHOLD` is some suitable constant computed based on the
    sizes of the airplane and balloon images. (For these particular images, `75` works
    pretty well.)
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä¸­ `COLLISION-THRESHOLD` æ˜¯åŸºäºé£æœºå’Œæ°”çƒå›¾åƒå¤§å°è®¡ç®—çš„ä¸€ä¸ªåˆé€‚çš„å¸¸æ•°ã€‚ï¼ˆå¯¹äºè¿™äº›ç‰¹å®šçš„å›¾åƒï¼Œ`75` å·¥ä½œå¾—ç›¸å½“å¥½ã€‚ï¼‰
- en: 'What is `distance`? It consumes two `posn`s and determines the Euclidean distance
    between them:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: '`distance` æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ¶ˆè€—ä¸¤ä¸ª `posn` å¹¶ç¡®å®šå®ƒä»¬ä¹‹é—´çš„æ¬§å‡ é‡Œå¾—è·ç¦»ï¼š'
- en: '[PRE31]'
  id: totrans-221
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Finally, we have to weave together the two termination conditions:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œæˆ‘ä»¬å¿…é¡»å°†ä¸¤ä¸ªç»ˆæ­¢æ¡ä»¶ç¼–ç»‡åœ¨ä¸€èµ·ï¼š
- en: '[PRE32]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'and use it instead:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: å¹¶ä½¿ç”¨å®ƒä»£æ›¿ï¼š
- en: '[PRE33]'
  id: totrans-225
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: Do Now!
  id: totrans-226
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç°åœ¨è¡ŒåŠ¨ï¼
- en: ''
  id: totrans-227
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Were you surprised by anything? Did the game look as you expected?
  id: totrans-228
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä½ å¯¹ä»»ä½•äº‹æƒ…æ„Ÿåˆ°æƒŠè®¶å—ï¼Ÿæ¸¸æˆçœ‹èµ·æ¥æ˜¯ä½ é¢„æœŸçš„æ ·å­å—ï¼Ÿ
- en: Odds are you didnâ€™t see a balloon on the screen! Thatâ€™s because we didnâ€™t update
    our display.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: æ¦‚ç‡ä¸Šï¼Œä½ å±å¹•ä¸Šæ²¡æœ‰çœ‹åˆ°æ°”çƒï¼é‚£æ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰æ›´æ–°æˆ‘ä»¬çš„æ˜¾ç¤ºã€‚
- en: 'You will need to define the balloonâ€™s image:'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ éœ€è¦å®šä¹‰æ°”çƒçš„å½¢è±¡ï¼š
- en: '[PRE34]'
  id: totrans-231
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'and also update the drawing function:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: å¹¶æ›´æ–°ç»˜å›¾å‡½æ•°ï¼š
- en: '[PRE35]'
  id: totrans-233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: Do Now!
  id: totrans-234
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç°åœ¨è¡ŒåŠ¨ï¼
- en: ''
  id: totrans-235
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Do you see how to write `game-ends` more concisely?
  id: totrans-236
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä½ çœ‹åˆ°å¦‚ä½•æ›´ç®€æ´åœ°ç¼–å†™ `game-ends` å—ï¼Ÿ
- en: 'Hereâ€™s another version:'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œæ˜¯å¦ä¸€ä¸ªç‰ˆæœ¬ï¼š
- en: '[PRE36]'
  id: totrans-238
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: '27.9Â Version: Keep Your Eye on the Tank[ğŸ”—](#(part._.Version__.Keep_.Your_.Eye_on_the_.Tank)
    "Link to here")'
  id: totrans-239
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.9 ç‰ˆæœ¬ï¼šå¯†åˆ‡å…³æ³¨æ²¹ç®±[ğŸ”—](#(part._.Version__.Keep_.Your_.Eye_on_the_.Tank) "é“¾æ¥åˆ°è¿™é‡Œ")
- en: Now weâ€™ll introduce the idea of fuel. In our simplified world, fuel isnâ€™t necessary
    to descendâ€”<wbr>gravity does that automaticallyâ€”<wbr>but it is needed to climb.
    Weâ€™ll assume that fuel is counted in whole number units, and every ascension consumes
    one unit of fuel. When you run out of fuel, the program no longer responds to
    the up-arrow, so you can no longer avoid either the balloon or water.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å°†å¼•å…¥ç‡ƒæ–™çš„æ¦‚å¿µã€‚åœ¨æˆ‘ä»¬çš„ç®€åŒ–ä¸–ç•Œä¸­ï¼Œä¸‹é™ä¸éœ€è¦ç‡ƒæ–™â€”â€”é‡åŠ›ä¼šè‡ªåŠ¨å®Œæˆâ€”â€”ä½†ä¸Šå‡åˆ™éœ€è¦ã€‚æˆ‘ä»¬å°†å‡è®¾ç‡ƒæ–™ä»¥æ•´æ•°å•ä½è®¡æ•°ï¼Œæ¯æ¬¡ä¸Šå‡æ¶ˆè€—ä¸€ä¸ªç‡ƒæ–™å•ä½ã€‚å½“ä½ ç”¨å®Œç‡ƒæ–™æ—¶ï¼Œç¨‹åºä¸å†å¯¹ä¸Šç®­å¤´åšå‡ºå“åº”ï¼Œå› æ­¤ä½ ä¸èƒ½å†é¿å¼€æ°”çƒæˆ–æ°´ã€‚
- en: In the past, weâ€™ve looked at still images of the game video to determine what
    is changing and what isnâ€™t. For this version, we could easily place a little gauge
    on the screen to show the quantity of fuel left. However, we donâ€™t on purpose,
    to illustrate a principle.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿‡å»ï¼Œæˆ‘ä»¬é€šè¿‡æŸ¥çœ‹æ¸¸æˆè§†é¢‘çš„é™æ€å›¾åƒæ¥ç¡®å®šä»€ä¹ˆæ˜¯å˜åŒ–çš„ï¼Œä»€ä¹ˆæ˜¯ä¸å˜çš„ã€‚å¯¹äºè¿™ä¸ªç‰ˆæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å±å¹•ä¸Šè½»æ¾æ”¾ç½®ä¸€ä¸ªå°ä»ªè¡¨æ¥æ˜¾ç¤ºå‰©ä½™çš„ç‡ƒæ–™é‡ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬æ•…æ„ä¸è¿™æ ·åšï¼Œä»¥è¯´æ˜ä¸€ä¸ªåŸåˆ™ã€‚
- en: Note
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„
- en: You canâ€™t always determine what is fixed and what is changing just by looking
    at the image. You have to also read the problem statement carefully, and think
    about it in depth.
  id: totrans-243
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä½ ä¸èƒ½ä»…ä»…é€šè¿‡è§‚å¯Ÿå›¾åƒæ¥ç¡®å®šä»€ä¹ˆæ˜¯å›ºå®šçš„ï¼Œä»€ä¹ˆæ˜¯å˜åŒ–çš„ã€‚ä½ å¿…é¡»ä»”ç»†é˜…è¯»é—®é¢˜é™ˆè¿°ï¼Œå¹¶æ·±å…¥æ€è€ƒã€‚
- en: 'Itâ€™s clear from our description that there are two things changing: the position
    of the airplane and the quantity of fuel left. Therefore, the World State must
    capture the current values of both of these. The fuel is best represented as a
    single number. However, we do need to create a new structure to represent the
    combination of these two.'
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: ä»æˆ‘ä»¬çš„æè¿°ä¸­å¯ä»¥çœ‹å‡ºï¼Œæœ‰ä¸¤ä»¶äº‹æƒ…åœ¨å˜åŒ–ï¼šé£æœºçš„ä½ç½®å’Œå‰©ä½™ç‡ƒæ–™é‡ã€‚å› æ­¤ï¼Œä¸–ç•ŒçŠ¶æ€å¿…é¡»æ•æ‰è¿™ä¸¤ä¸ªå½“å‰å€¼ã€‚ç‡ƒæ–™æœ€å¥½ç”¨ä¸€ä¸ªå•ä¸€çš„æ•°å­—æ¥è¡¨ç¤ºã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ç¡®å®éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ç»“æ„æ¥è¡¨ç¤ºè¿™ä¸¤ä¸ªçš„ç»„åˆã€‚
- en: World Definition
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸–ç•Œå®šä¹‰
- en: The World State is a structure representing the airplaneâ€™s current position
    and the quantity of fuel left.
  id: totrans-246
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸–ç•ŒçŠ¶æ€æ˜¯ä¸€ä¸ªè¡¨ç¤ºé£æœºå½“å‰ä½ç½®å’Œå‰©ä½™ç‡ƒæ–™é‡çš„ç»“æ„ã€‚
- en: 'Concretely, we will use this structure:'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¿™ä¸ªç»“æ„ï¼š
- en: '[PRE37]'
  id: totrans-248
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: Exercise
  id: totrans-249
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-250
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'We could have also defined the World to be a structure consisting of three
    components: the airplaneâ€™s x-position, the airplaneâ€™s y-position, and the quantity
    of fuel. Why do we choose to use the representation above?'
  id: totrans-251
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä¹Ÿå¯ä»¥å®šä¹‰ä¸–ç•Œä¸ºä¸€ä¸ªç”±ä¸‰ä¸ªç»„ä»¶ç»„æˆçš„ç»“æ„ï¼šé£æœºçš„xä½ç½®ã€é£æœºçš„yä½ç½®å’Œç‡ƒæ–™é‡ã€‚ä¸ºä»€ä¹ˆæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨ä¸Šé¢çš„è¡¨ç¤ºæ³•ï¼Ÿ
- en: We can again look at each of the parts of the program to determine what can
    stay the same and what changes. Concretely, we must focus on the functions that
    consume and produce `World`s.
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥å†æ¬¡æŸ¥çœ‹ç¨‹åºçš„æ¯ä¸ªéƒ¨åˆ†ï¼Œä»¥ç¡®å®šå“ªäº›å¯ä»¥ä¿æŒä¸å˜ï¼Œå“ªäº›éœ€è¦æ”¹å˜ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å¿…é¡»å…³æ³¨æ¶ˆè€—å’Œäº§ç”Ÿ`World`çš„å‡½æ•°ã€‚
- en: 'On each tick, we consume a world and compute one. The passage of time does
    not consume any fuel, so this code can remain unchanged, other than having to
    create a structure containing the current amount of fuel. Concretely:'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œæˆ‘ä»¬æ¶ˆè€—ä¸€ä¸ªä¸–ç•Œå¹¶è®¡ç®—ä¸€ä¸ªã€‚æ—¶é—´çš„æµé€ä¸ä¼šæ¶ˆè€—ä»»ä½•ç‡ƒæ–™ï¼Œæ‰€ä»¥é™¤äº†éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«å½“å‰ç‡ƒæ–™é‡çš„ç»“æ„ä¹‹å¤–ï¼Œè¿™æ®µä»£ç å¯ä»¥ä¿æŒä¸å˜ã€‚å…·ä½“æ¥è¯´ï¼š
- en: '[PRE38]'
  id: totrans-254
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'Similarly, the function that responds to keystrokes clearly needs to take into
    account how much fuel is left:'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: åŒæ ·ï¼Œå“åº”æŒ‰é”®çš„å‡½æ•°æ˜¾ç„¶éœ€è¦è€ƒè™‘åˆ°å‰©ä½™çš„ç‡ƒæ–™é‡ï¼š
- en: '[PRE39]'
  id: totrans-256
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: Exercise
  id: totrans-257
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-258
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Updating the function that renders a scene. Recall that the world has two fields;
    one of them corresponds to what we used to draw before, and the other isnâ€™t being
    drawn in the output.
  id: totrans-259
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ›´æ–°æ¸²æŸ“åœºæ™¯çš„å‡½æ•°ã€‚å›æƒ³ä¸€ä¸‹ï¼Œä¸–ç•Œæœ‰ä¸¤ä¸ªå­—æ®µï¼›å…¶ä¸­ä¸€ä¸ªå¯¹åº”äºæˆ‘ä»¬ä¹‹å‰ç”¨æ¥ç»˜åˆ¶çš„å†…å®¹ï¼Œå¦ä¸€ä¸ªåˆ™æ²¡æœ‰åœ¨è¾“å‡ºä¸­ç»˜åˆ¶ã€‚
- en: Do Now!
  id: totrans-260
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç°åœ¨è¡ŒåŠ¨ï¼
- en: ''
  id: totrans-261
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: What else do you need to change to get a working program?
  id: totrans-262
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä½ è¿˜éœ€è¦æ›´æ”¹ä»€ä¹ˆæ‰èƒ½å¾—åˆ°ä¸€ä¸ªå¯å·¥ä½œçš„ç¨‹åºï¼Ÿ
- en: You should have noticed that your initial world value is also incorrect because
    it doesnâ€™t account for fuel. What are interesting fuel values to try?
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ åº”è¯¥å·²ç»æ³¨æ„åˆ°ï¼Œä½ çš„åˆå§‹ä¸–ç•Œå€¼ä¹Ÿæ˜¯ä¸æ­£ç¡®çš„ï¼Œå› ä¸ºå®ƒæ²¡æœ‰è€ƒè™‘åˆ°ç‡ƒæ–™ã€‚å°è¯•å“ªäº›æœ‰è¶£çš„ç‡ƒæ–™å€¼ï¼Ÿ
- en: Exercise
  id: totrans-264
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-265
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Extend your program to draw a fuel gauge.
  id: totrans-266
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ‰©å±•ä½ çš„ç¨‹åºä»¥ç»˜åˆ¶ç‡ƒæ–™è¡¨ã€‚
- en: '27.10Â Version: The Balloon Moves, Too[ğŸ”—](#(part._.Version__.The_.Balloon_.Moves__.Too)
    "Link to here")'
  id: totrans-267
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.10 ç‰ˆæœ¬ï¼šæ°”çƒä¹Ÿç§»åŠ¨äº†[ğŸ”—](#(part._.Version__.The_.Balloon_.Moves__.Too) "é“¾æ¥åˆ°è¿™é‡Œ")
- en: Until now weâ€™ve left our balloon immobile. Letâ€™s now make the game more interesting
    by letting the balloon move, as [this video shows.](https://drive.google.com/file/d/19kxqArza5y72V9xIezUtPi8PNV33KsG3/view?usp=share_link)
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è®©æ°”çƒä¿æŒé™æ­¢ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡è®©æ°”çƒç§»åŠ¨æ¥ä½¿æ¸¸æˆæ›´æœ‰è¶£ï¼Œæ­£å¦‚[è¿™ä¸ªè§†é¢‘æ‰€ç¤ºã€‚](https://drive.google.com/file/d/19kxqArza5y72V9xIezUtPi8PNV33KsG3/view?usp=share_link)
- en: Obviously, the balloonâ€™s location needs to also become part of the World State.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: æ˜¾ç„¶ï¼Œæ°”çƒçš„å®šä½ä¹Ÿéœ€è¦æˆä¸ºä¸–ç•ŒçŠ¶æ€çš„ä¸€éƒ¨åˆ†ã€‚
- en: World Definition
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸–ç•Œå®šä¹‰
- en: The World State is a structure representing the planeâ€™s current position, the
    balloonâ€™s current position, and the quantity of fuel left.
  id: totrans-271
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸–ç•ŒçŠ¶æ€æ˜¯ä¸€ä¸ªè¡¨ç¤ºé£æœºå½“å‰ä½ç½®ã€æ°”çƒå½“å‰ä½ç½®å’Œå‰©ä½™ç‡ƒæ–™é‡çš„ç»“æ„ã€‚
- en: Here is a representation of the world state. As these states become more complex,
    itâ€™s important to add annotations so we can keep track of whatâ€™s what.
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œæ˜¯ä¸–ç•ŒçŠ¶æ€çš„ä¸€ä¸ªè¡¨ç¤ºã€‚éšç€è¿™äº›çŠ¶æ€å˜å¾—æ›´åŠ å¤æ‚ï¼Œæ·»åŠ æ³¨é‡Šä»¥è·Ÿè¸ªæ¯ä¸ªéƒ¨åˆ†æ˜¯å¾ˆé‡è¦çš„ã€‚
- en: '[PRE40]'
  id: totrans-273
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'With this definition, we obviously need to re-write all our previous definitions.
    Most of this is quite routine relative to what weâ€™ve seen before. The only detail
    we havenâ€™t really specified is how the balloon is supposed to move: in what direction,
    at what speed, and what to do at the edges. Weâ€™ll let you use your imagination
    for this one! (Remember that the closer the balloon is to land, the harder it
    is to safely land the plane.)'
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨è¿™ä¸ªå®šä¹‰ï¼Œæˆ‘ä»¬æ˜¾ç„¶éœ€è¦é‡å†™æˆ‘ä»¬ä¹‹å‰çš„æ‰€æœ‰å®šä¹‰ã€‚å¤§éƒ¨åˆ†ä¸ä¹‹å‰çœ‹åˆ°çš„å†…å®¹ç›¸æ¯”ç›¸å½“å¸¸è§„ã€‚å”¯ä¸€æˆ‘ä»¬æ²¡æœ‰çœŸæ­£æŒ‡å®šçš„æ˜¯æ°”çƒåº”è¯¥å¦‚ä½•ç§»åŠ¨ï¼šç§»åŠ¨çš„æ–¹å‘ã€é€Ÿåº¦ä»¥åŠè¾¹ç¼˜æ—¶åº”è¯¥åšä»€ä¹ˆã€‚æˆ‘ä»¬å°†è®©ä½ å‘æŒ¥æƒ³è±¡åŠ›æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ï¼ˆè®°ä½ï¼Œæ°”çƒç¦»åœ°é¢è¶Šè¿‘ï¼Œå®‰å…¨é™è½é£æœºå°±è¶Šå›°éš¾ã€‚ï¼‰
- en: 'We thus have to modify:'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»ä¿®æ”¹ï¼š
- en: The background image (to remove the static balloon).
  id: totrans-276
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: èƒŒæ™¯å›¾åƒï¼ˆç”¨äºç§»é™¤é™æ€æ°”çƒï¼‰ã€‚
- en: The drawing handler (to draw the balloon at its position).
  id: totrans-277
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç»˜å›¾å¤„ç†ç¨‹åºï¼ˆç”¨äºåœ¨æ°”çƒçš„ä½ç½®ç»˜åˆ¶æ°”çƒï¼‰ã€‚
- en: The timer handler (to move the balloon as well as the airplane).
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è®¡æ—¶å¤„ç†ç¨‹åºï¼ˆç§»åŠ¨æ°”çƒä»¥åŠé£æœºï¼‰ã€‚
- en: The key handler (to construct world data that leaves the balloon unchanged).
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å…³é”®å¤„ç†ç¨‹åºï¼ˆæ„å»ºä¸–ç•Œæ•°æ®ï¼Œä½¿æ°”çƒä¿æŒä¸å˜ï¼‰ã€‚
- en: The termination condition (to account for the balloonâ€™s dynamic location).
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç»ˆæ­¢æ¡ä»¶ï¼ˆä»¥è€ƒè™‘æ°”çƒçš„åŠ¨æ€ä½ç½®ï¼‰ã€‚
- en: Exercise
  id: totrans-281
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-282
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Modify each of the above functions, along with their test cases.
  id: totrans-283
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¿®æ”¹ä¸Šè¿°æ¯ä¸ªå‡½æ•°åŠå…¶æµ‹è¯•ç”¨ä¾‹ã€‚
- en: '27.11Â Version: One, Two, ..., Ninety-Nine Luftballons![ğŸ”—](#(part._.Version__.One__.Two_______.Ninety-.Nine_.Luftballons_)
    "Link to here")'
  id: totrans-284
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.11 ç‰ˆæœ¬ï¼šä¸€ä¸ªï¼Œä¸¤ä¸ªï¼Œâ€¦â€¦ï¼Œä¹åä¹ä¸ªæ°”çƒ![ğŸ”—](#(part._.Version__.One__.Two_______.Ninety-.Nine_.Luftballons_)
    "é“¾æ¥åˆ°è¿™é‡Œ")
- en: Finally, thereâ€™s no need to limit ourselves to only one balloon. How many is
    right? Two? Three? Ten? ... Why fix any one number? It could be a balloon festival!
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œæˆ‘ä»¬æ²¡æœ‰å¿…è¦å°†è‡ªå·±é™åˆ¶åœ¨åªæœ‰ä¸€ä¸ªæ°”çƒä¸Šã€‚å¤šå°‘ä¸ªæ˜¯æ­£ç¡®çš„ï¼Ÿä¸¤ä¸ªï¼Ÿä¸‰ä¸ªï¼Ÿåä¸ªï¼Ÿ...ä¸ºä»€ä¹ˆå›ºå®šä¸€ä¸ªæ•°å­—ï¼Ÿè¿™å¯ä»¥æ˜¯ä¸€ä¸ªæ°”çƒèŠ‚ï¼
- en: Similarly, many games have levels that become progressively harder; we could
    do the same, letting the number of balloons be part of what changes across levels.
    However, there is conceptually no big difference between having two balloons and
    five; the code to control each balloon is essentially the same.
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: ç±»ä¼¼åœ°ï¼Œè®¸å¤šæ¸¸æˆéƒ½æœ‰éš¾åº¦é€æ¸å¢åŠ çš„å…³å¡ï¼›æˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼Œè®©æ°”çƒçš„æ•°é‡æˆä¸ºå…³å¡å˜åŒ–çš„ä¸€éƒ¨åˆ†ã€‚ç„¶è€Œï¼Œåœ¨æ¦‚å¿µä¸Šï¼Œæœ‰ä¸¤ä¸ªæ°”çƒå’Œäº”ä¸ªæ°”çƒä¹‹é—´æ²¡æœ‰å¤ªå¤§çš„åŒºåˆ«ï¼›æ§åˆ¶æ¯ä¸ªæ°”çƒçš„ä»£ç åŸºæœ¬ä¸Šæ˜¯ç›¸åŒçš„ã€‚
- en: 'We need to represent a collection of balloons. We can use a list to represent
    them. Thus:'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬éœ€è¦è¡¨ç¤ºä¸€ç»„æ°”çƒã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åˆ—è¡¨æ¥è¡¨ç¤ºå®ƒä»¬ã€‚å› æ­¤ï¼š
- en: World Definition
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸–ç•Œå®šä¹‰
- en: The World State is a structure representing the planeâ€™s current position, a
    list of balloon positions, and the quantity of fuel left.
  id: totrans-289
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸–ç•ŒçŠ¶æ€æ˜¯ä¸€ä¸ªè¡¨ç¤ºé£æœºå½“å‰ä½ç½®ã€æ°”çƒä½ç½®åˆ—è¡¨å’Œå‰©ä½™ç‡ƒæ–™é‡çš„ç»“æ„ã€‚
- en: You should now use the design recipe for lists of structures to rewrite the
    functions. Notice that youâ€™ve already written the function to move one balloon.
    Whatâ€™s left?
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ ç°åœ¨åº”è¯¥ä½¿ç”¨ç»“æ„åˆ—è¡¨çš„è®¾è®¡é…æ–¹æ¥é‡å†™å‡½æ•°ã€‚æ³¨æ„ï¼Œä½ å·²ç»ç¼–å†™äº†ç§»åŠ¨ä¸€ä¸ªæ°”çƒçš„å‡½æ•°ã€‚å‰©ä¸‹ä»€ä¹ˆï¼Ÿ
- en: Apply the same function to each balloon in the list.
  id: totrans-291
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å°†ç›¸åŒçš„å‡½æ•°åº”ç”¨äºåˆ—è¡¨ä¸­çš„æ¯ä¸ªæ°”çƒã€‚
- en: Determine what to do if two balloons collide.
  id: totrans-292
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç¡®å®šå¦‚æœä¸¤ä¸ªæ°”çƒç›¸æ’æ—¶åº”è¯¥åšä»€ä¹ˆã€‚
- en: For now, you can avoid the latter problem by placing each balloon sufficiently
    spread apart along the x-dimension and letting them move only up and down.
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: ç›®å‰ï¼Œä½ å¯ä»¥é€šè¿‡åœ¨xè½´ä¸Šè¶³å¤Ÿåˆ†æ•£åœ°æ”¾ç½®æ¯ä¸ªæ°”çƒå¹¶è®©å®ƒä»¬åªä¸Šä¸‹ç§»åŠ¨æ¥é¿å…åä¸€ä¸ªé—®é¢˜ã€‚
- en: Exercise
  id: totrans-294
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-295
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Introduce a concept of wind, which affects balloons but not the airplane. After
    random periods of time, the wind blows with random speed and direction, causing
    the ballooons to move laterally.
  id: totrans-296
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å¼•å…¥é£çš„æ¦‚å¿µï¼Œå®ƒå½±å“æ°”çƒä½†ä¸å½±å“é£æœºã€‚åœ¨éšæœºçš„æ—¶æ®µåï¼Œé£ä»¥éšæœºé€Ÿåº¦å’Œæ–¹å‘å¹æ‹‚ï¼Œå¯¼è‡´æ°”çƒæ¨ªå‘ç§»åŠ¨ã€‚
- en: 27.1Â About Reactive Animations[ğŸ”—](#(part._.About_.Reactive_.Animations) "Link
    to here")
  id: totrans-297
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.1 å…³äºååº”æ€§åŠ¨ç”»[ğŸ”—](#(part._.About_.Reactive_.Animations) "é“¾æ¥åˆ°è¿™é‡Œ")
- en: 'We are writing a program with two important interactive elements: it is an
    animation, meaning it gives the impression of motion, and it is reactive, meaning
    it responds to user input. Both of these can be challenging to program, but Pyret
    provides a simple mechanism that accommodates both and integrates well with other
    programming principles such as testing. We will learn about this as we go along.'
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æ­£åœ¨ç¼–å†™ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªé‡è¦äº¤äº’å…ƒç´ çš„ç¨‹åºï¼šå®ƒæ˜¯ä¸€ä¸ªåŠ¨ç”»ï¼Œæ„å‘³ç€å®ƒç»™äººä¸€ç§è¿åŠ¨çš„æ„Ÿè§‰ï¼Œå®ƒæ˜¯ååº”æ€§çš„ï¼Œæ„å‘³ç€å®ƒå¯¹ç”¨æˆ·è¾“å…¥åšå‡ºå“åº”ã€‚è¿™ä¸¤ä¸ªéƒ½å¾ˆéš¾ç¼–ç¨‹ï¼Œä½†Pyretæä¾›äº†ä¸€ä¸ªç®€å•æœºåˆ¶ï¼Œå®ƒæ—¢é€‚åº”äº†è¿™ä¸¤ä¸ªï¼Œåˆä¸å…¶ä»–ç¼–ç¨‹åŸåˆ™å¦‚æµ‹è¯•å¾ˆå¥½åœ°é›†æˆã€‚æˆ‘ä»¬å°†éšç€å­¦ä¹ çš„æ·±å…¥äº†è§£è¿™ä¸€ç‚¹ã€‚
- en: 'The key to creating an animation is the Movie Principle. Even in the most sophisticated
    movie you can watch, there is no motion (indeed, the very term â€œmovieâ€â€”<wbr>short
    for â€œmoving pictureâ€â€”<wbr>is a clever bit of false advertising). Rather, there
    is just a sequence of still images shown in rapid succession, relying on the human
    brain to create the impression of motion:'
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ›å»ºåŠ¨ç”»çš„å…³é”®æ˜¯ç”µå½±åŸç†ã€‚å³ä½¿åœ¨æœ€å¤æ‚çš„ç”µå½±ä¸­ï¼Œä¹Ÿæ²¡æœ‰è¿åŠ¨ï¼ˆå®é™…ä¸Šï¼Œâ€œç”µå½±â€â€”â€”<wbr>ç®€ç§°â€œç§»åŠ¨å›¾ç‰‡â€â€”â€”<wbr>æ˜¯ä¸€åˆ™å·§å¦™çš„è™šå‡å¹¿å‘Šï¼‰ã€‚ç›¸åï¼Œåªæ˜¯ä¸€ç³»åˆ—é™æ­¢å›¾åƒçš„å¿«é€Ÿè¿ç»­æ˜¾ç¤ºï¼Œä¾é äººç±»å¤§è„‘åˆ›é€ å‡ºè¿åŠ¨çš„æ„Ÿè§‰ï¼š
- en: '![](../Images/5c8adbce3d9a918184e456af57b76f30.png)'
  id: totrans-300
  prefs:
  - PREF_BQ
  type: TYPE_IMG
  zh: '![](../Images/5c8adbce3d9a918184e456af57b76f30.png)'
- en: 'We are going to exploit the same idea: our animations will consist of a sequence
    of individual images, and we will ask Pyret to show these in rapid succession.
    We will then see how reactivity folds into the same process.'
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†åˆ©ç”¨åŒæ ·çš„æƒ³æ³•ï¼šæˆ‘ä»¬çš„åŠ¨ç”»å°†åŒ…æ‹¬ä¸€ç³»åˆ—å•ç‹¬çš„å›¾åƒï¼Œæˆ‘ä»¬å°†è¦æ±‚Pyretå¿«é€Ÿè¿ç»­åœ°æ˜¾ç¤ºè¿™äº›å›¾åƒã€‚ç„¶åæˆ‘ä»¬å°†çœ‹åˆ°ååº”æ€§å¦‚ä½•èå…¥åŒæ ·çš„è¿‡ç¨‹ã€‚
- en: 27.2Â Preliminaries[ğŸ”—](#(part._.Preliminaries) "Link to here")
  id: totrans-302
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.2 å‰æ[ğŸ”—](#(part._.Preliminaries) "é“¾æ¥åˆ°è¿™é‡Œ")
- en: 'To begin with, we should inform Pyret that we plan to make use of both images
    and animations. We load the libraries as follows:'
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œæˆ‘ä»¬åº”è¯¥é€šçŸ¥ Pyret æˆ‘ä»¬è®¡åˆ’åŒæ—¶ä½¿ç”¨å›¾åƒå’ŒåŠ¨ç”»ã€‚æˆ‘ä»¬æŒ‰ç…§ä»¥ä¸‹æ–¹å¼åŠ è½½åº“ï¼š
- en: '[PRE41]'
  id: totrans-304
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: This tells Pyret to load these two libraries and bind the results to the corresponding
    names, `I` and `R`. Thus, all image operations are obtained from `I` and animation
    operations from `R`.
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å‘Šè¯‰ Pyret åŠ è½½è¿™ä¸¤ä¸ªåº“å¹¶å°†ç»“æœç»‘å®šåˆ°ç›¸åº”çš„åç§°ï¼Œ`I` å’Œ `R`ã€‚å› æ­¤ï¼Œæ‰€æœ‰å›¾åƒæ“ä½œéƒ½æ¥è‡ª `I`ï¼ŒåŠ¨ç”»æ“ä½œæ¥è‡ª `R`ã€‚
- en: '27.3Â Version: Airplane Moving Across the Screen[ğŸ”—](#(part._.Version__.Airplane_.Moving_.Across_the_.Screen)
    "Link to here")'
  id: totrans-306
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.3 ç‰ˆæœ¬ï¼šé£æœºåœ¨å±å¹•ä¸Šç§»åŠ¨[ğŸ”—](#(part._.Version__.Airplane_.Moving_.Across_the_.Screen)
    "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'We will start with the simplest version: one in which the airplane moves horizontally
    across the screen. Watch [this video](https://drive.google.com/file/d/1rbDJJJEQV2z-FZT3R1c15xelLsCwhaLI/view?usp=share_link).'
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†ä»æœ€ç®€å•çš„ç‰ˆæœ¬å¼€å§‹ï¼šå…¶ä¸­é£æœºåœ¨å±å¹•ä¸Šæ°´å¹³ç§»åŠ¨ã€‚è§‚çœ‹[è¿™ä¸ªè§†é¢‘](https://drive.google.com/file/d/1rbDJJJEQV2z-FZT3R1c15xelLsCwhaLI/view?usp=share_link)ã€‚
- en: First, hereâ€™s an image of an airplane:Have fun finding your preferred airplane
    image! But donâ€™t spend too long on it, because weâ€™ve still got a lot of work to
    do.
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œè¿™æ˜¯ä¸€å¼ é£æœºçš„å›¾ç‰‡ï¼šäº«å—å¯»æ‰¾ä½ å–œæ¬¢çš„é£æœºå›¾ç‰‡çš„è¿‡ç¨‹ï¼ä½†ä¸è¦èŠ±å¤ªå¤šæ—¶é—´åœ¨è¿™ä¸Šé¢ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æœ‰å¾ˆå¤šå·¥ä½œè¦åšã€‚
- en: '[http://world.cs.brown.edu/1/clipart/airplane-small.png](http://world.cs.brown.edu/1/clipart/airplane-small.png)'
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://world.cs.brown.edu/1/clipart/airplane-small.png](http://world.cs.brown.edu/1/clipart/airplane-small.png)'
- en: 'We can tell Pyret to load this image and give it a name as follows:'
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥å‘Šè¯‰ Pyret åŠ è½½è¿™å¼ å›¾ç‰‡å¹¶ç»™å®ƒèµ·ä¸€ä¸ªåå­—ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
- en: '[PRE42]'
  id: totrans-311
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: Henceforth, when we refer to `AIRPLANE`, it will always refer to this image.
    (Try it out in the interactions area!)
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: ä»æ­¤ä»¥åï¼Œå½“æˆ‘ä»¬æåˆ° `AIRPLANE` æ—¶ï¼Œå®ƒå°†å§‹ç»ˆæŒ‡ä»£è¿™å¼ å›¾ç‰‡ã€‚ï¼ˆåœ¨äº¤äº’åŒºåŸŸå°è¯•ä¸€ä¸‹ï¼ï¼‰
- en: Now look at the video again. Watch what happens at different points in time.
    What stays the same, and what changes? Whatâ€™s common is the water and land, which
    stay the same. What changes is the (horizontal) position of the airplane.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨å†æ¬¡è§‚çœ‹è§†é¢‘ã€‚è§‚å¯Ÿåœ¨ä¸åŒæ—¶é—´ç‚¹å‘ç”Ÿçš„äº‹æƒ…ã€‚ä»€ä¹ˆä¿æŒä¸å˜ï¼Œä»€ä¹ˆå‘ç”Ÿå˜åŒ–ï¼Ÿå…±åŒçš„æ˜¯æ°´å’Œé™†åœ°ä¿æŒä¸å˜ï¼Œè€Œå˜åŒ–çš„æ˜¯é£æœºçš„ï¼ˆæ°´å¹³ï¼‰ä½ç½®ã€‚
- en: Note
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„
- en: The World State consists of everything that changes. Things that stay the same
    do not need to get recorded in the World State.
  id: totrans-315
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸–ç•ŒçŠ¶æ€åŒ…æ‹¬æ‰€æœ‰å˜åŒ–çš„ä¸œè¥¿ã€‚ä¿æŒä¸å˜çš„ä¸œè¥¿ä¸éœ€è¦è®°å½•åœ¨ä¸–ç•ŒçŠ¶æ€ä¸­ã€‚
- en: 'We can now define our first World State:'
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ç°åœ¨å¯ä»¥å®šä¹‰æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªä¸–ç•ŒçŠ¶æ€ï¼š
- en: World Definition
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸–ç•Œå®šä¹‰
- en: The World State is a number, representing the x-position of the airplane.
  id: totrans-318
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸–ç•ŒçŠ¶æ€æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºé£æœºçš„ x ä½ç½®ã€‚
- en: 'Observe something important above:'
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ä»¥ä¸‹é‡è¦äº‹é¡¹ï¼š
- en: Note
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„
- en: When we record a World State, we donâ€™t capture only the type of the values,
    but also their intended meaning.
  id: totrans-321
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å½“æˆ‘ä»¬è®°å½•ä¸–ç•ŒçŠ¶æ€æ—¶ï¼Œæˆ‘ä»¬ä¸ä»…æ•è·å€¼çš„ç±»å‹ï¼Œè¿˜æ•è·å®ƒä»¬çš„é¢„æœŸå«ä¹‰ã€‚
- en: 'Now we have a representation of the core data, but to generate the above animation,
    we still have to do several things:'
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬æœ‰äº†æ ¸å¿ƒæ•°æ®çš„è¡¨ç°å½¢å¼ï¼Œä½†è¦ç”Ÿæˆä¸Šé¢çš„åŠ¨ç”»ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦åšå‡ ä»¶äº‹æƒ…ï¼š
- en: Ask to be notified of the passage of time.
  id: totrans-323
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: è¯·æ±‚é€šçŸ¥æ—¶é—´çš„æµé€ã€‚
- en: As time passes, correspondingly update the World State.
  id: totrans-324
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: éšç€æ—¶é—´çš„æ¨ç§»ï¼Œç›¸åº”åœ°æ›´æ–°ä¸–ç•ŒçŠ¶æ€ã€‚
- en: Given an updated World State, produce the corresponding visual display.
  id: totrans-325
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç»™å®šä¸€ä¸ªæ›´æ–°çš„ä¸–ç•ŒçŠ¶æ€ï¼Œç”Ÿæˆç›¸åº”çš„è§†è§‰æ˜¾ç¤ºã€‚
- en: This sounds like a lot! Fortunately, Pyret makes this much easier than it sounds.
    Weâ€™ll do these in a slightly different order than listed above.
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å¬èµ·æ¥å¥½åƒå¾ˆå¤šï¼å¹¸è¿çš„æ˜¯ï¼ŒPyret ä½¿è¿™æ¯”å¬èµ·æ¥å®¹æ˜“å¾—å¤šã€‚æˆ‘ä»¬å°†æŒ‰ç…§ä¸ä¸Šé¢åˆ—å‡ºçš„ä¸åŒé¡ºåºæ¥åšè¿™äº›ã€‚
- en: 27.3.1Â Updating the World State[ğŸ”—](#(part._.Updating_the_.World_.State) "Link
    to here")
  id: totrans-327
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 27.3.1 æ›´æ–°ä¸–ç•ŒçŠ¶æ€[ğŸ”—](#(part._.Updating_the_.World_.State) "é“¾æ¥åˆ°æ­¤å¤„")
- en: As weâ€™ve noted, the airplane doesnâ€™t actually â€œmoveâ€. Rather, we can ask Pyret
    to notify us every time a clock ticks. If on each tick we place the airplane in
    an appropriately different position, and the ticks happen often enough, we will
    get the impression of motion.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: æ­£å¦‚æˆ‘ä»¬æ‰€æåˆ°çš„ï¼Œé£æœºå®é™…ä¸Šå¹¶æ²¡æœ‰â€œç§»åŠ¨â€ã€‚ç›¸åï¼Œæˆ‘ä»¬å¯ä»¥è¦æ±‚ Pyret åœ¨æ¯æ¬¡æ—¶é’Ÿæ»´ç­”æ—¶é€šçŸ¥æˆ‘ä»¬ã€‚å¦‚æœåœ¨æ¯æ¬¡æ»´ç­”æ—¶æˆ‘ä»¬å°†é£æœºæ”¾ç½®åœ¨é€‚å½“ä¸åŒçš„ä½ç½®ï¼Œå¹¶ä¸”æ»´ç­”å‘ç”Ÿå¾—è¶³å¤Ÿé¢‘ç¹ï¼Œæˆ‘ä»¬å°±ä¼šäº§ç”Ÿè¿åŠ¨çš„æ„Ÿè§‰ã€‚
- en: 'Because the World State consists of just the airplaneâ€™s x-position, to move
    it to the right, we simply increment its value. Letâ€™s first give this constant
    distance a name:'
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: å› ä¸ºä¸–ç•ŒçŠ¶æ€åªåŒ…å«é£æœºçš„ x ä½ç½®ï¼Œä¸ºäº†å°†å…¶å‘å³ç§»åŠ¨ï¼Œæˆ‘ä»¬åªéœ€å¢åŠ å…¶å€¼ã€‚è®©æˆ‘ä»¬é¦–å…ˆç»™è¿™ä¸ªå¸¸æ•°è·ç¦»èµ·ä¸€ä¸ªåå­—ï¼š
- en: '[PRE43]'
  id: totrans-330
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'We will need to write a function that reflects this movement. Letâ€™s first write
    some test cases:'
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸ªåæ˜ è¿™ç§ç§»åŠ¨çš„å‡½æ•°ã€‚è®©æˆ‘ä»¬é¦–å…ˆç¼–å†™ä¸€äº›æµ‹è¯•ç”¨ä¾‹ï¼š
- en: '[PRE44]'
  id: totrans-332
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'The functionâ€™s definition is now clear:'
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: å‡½æ•°çš„å®šä¹‰ç°åœ¨å¾ˆæ¸…æ™°ï¼š
- en: '[PRE45]'
  id: totrans-334
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: And sure enough, Pyret will confirm that this function passes all of its tests.
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: ç¡®å®ï¼ŒPyret å°†ç¡®è®¤è¿™ä¸ªå‡½æ•°é€šè¿‡äº†æ‰€æœ‰çš„æµ‹è¯•ã€‚
- en: Note
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„
- en: 'If you have prior experience programming animations and reactive programs,
    you will immediately notice an important difference: itâ€™s easy to test parts of
    your program in Pyret!'
  id: totrans-337
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å¦‚æœä½ ä¹‹å‰æœ‰ç¼–ç¨‹åŠ¨ç”»å’Œååº”ç¨‹åºçš„ç»éªŒï¼Œä½ å°†ç«‹å³æ³¨æ„åˆ°ä¸€ä¸ªé‡è¦çš„åŒºåˆ«ï¼šåœ¨ Pyret ä¸­æµ‹è¯•ç¨‹åºçš„éƒ¨åˆ†å¾ˆå®¹æ˜“ï¼
- en: 27.3.2Â Displaying the World State[ğŸ”—](#(part._.Displaying_the_.World_.State)
    "Link to here")
  id: totrans-338
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 27.3.2 æ˜¾ç¤ºä¸–ç•ŒçŠ¶æ€[ğŸ”—](#(part._.Displaying_the_.World_.State) "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'Now weâ€™re ready to draw the gameâ€™s visual output. We produce an image that
    consists of all the necessary components. It first helps to define some constants
    representing the visual output:'
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å‡†å¤‡ç»˜åˆ¶æ¸¸æˆçš„è§†è§‰è¾“å‡ºã€‚æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªåŒ…å«æ‰€æœ‰å¿…è¦ç»„ä»¶çš„å›¾åƒã€‚é¦–å…ˆï¼Œå®šä¹‰ä¸€äº›ä»£è¡¨è§†è§‰è¾“å‡ºçš„å¸¸é‡æ˜¯æœ‰å¸®åŠ©çš„ï¼š
- en: '[PRE46]'
  id: totrans-340
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'Using these, we can create a blank canvas, and overlay rectangles representing
    water and land:'
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨è¿™äº›ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç©ºç™½ç”»å¸ƒï¼Œå¹¶åœ¨å…¶ä¸Šå åŠ ä»£è¡¨æ°´å’Œé™†åœ°çš„çŸ©å½¢ï¼š
- en: '[PRE47]'
  id: totrans-342
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: Examine the value of `BACKGROUND` in the interactions area to confirm that it
    looks right.
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: æ£€æŸ¥äº¤äº’åŒºåŸŸä¸­ `BACKGROUND` çš„å€¼ï¼Œä»¥ç¡®è®¤å®ƒçœ‹èµ·æ¥æ­£ç¡®ã€‚
- en: Do Now!
  id: totrans-344
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç°åœ¨è¡ŒåŠ¨èµ·æ¥ï¼
- en: ''
  id: totrans-345
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: The reason we divide by two when placing `BASE` is because Pyret puts the middle
    of the image at the given location. Remove the division and see what happens to
    the resulting image.
  id: totrans-346
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬åœ¨æ”¾ç½® `BASE` æ—¶é™¤ä»¥äºŒçš„åŸå› æ˜¯ Pyret å°†å›¾åƒçš„ä¸­é—´ä½ç½®æ”¾ç½®åœ¨ç»™å®šä½ç½®ã€‚å»æ‰é™¤æ³•ï¼Œçœ‹çœ‹ç»“æœå›¾åƒä¼šå‘ç”Ÿä»€ä¹ˆå˜åŒ–ã€‚
- en: 'Now that we know how to get our background, weâ€™re ready to place the airplane
    on it. The expression to do so looks roughly like this:'
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†å¦‚ä½•è·å–èƒŒæ™¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†é£æœºæ”¾ç½®åœ¨ä¸Šé¢äº†ã€‚è¿™æ ·åšçš„æ–¹æ³•å¤§è‡´å¦‚ä¸‹ï¼š
- en: '[PRE48]'
  id: totrans-348
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'but what x position do we use? Actually, thatâ€™s just what the World State represents!
    So we create a function out of this expression:'
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ä»€ä¹ˆ x ä½ç½®å‘¢ï¼Ÿå®é™…ä¸Šï¼Œè¿™æ­£æ˜¯ä¸–ç•ŒçŠ¶æ€æ‰€ä»£è¡¨çš„ï¼å› æ­¤ï¼Œæˆ‘ä»¬ä»è¿™ä¸ªè¡¨è¾¾å¼ä¸­åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼š
- en: '[PRE49]'
  id: totrans-350
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 27.3.3Â Observing Time (and Combining the Pieces)[ğŸ”—](#(part._.Observing_.Time__and_.Combining_the_.Pieces_)
    "Link to here")
  id: totrans-351
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 27.3.3 è§‚å¯Ÿæ—¶é—´ï¼ˆä»¥åŠç»„åˆå„ä¸ªéƒ¨åˆ†ï¼‰[ğŸ”—](#(part._.Observing_.Time__and_.Combining_the_.Pieces_)
    "é“¾æ¥åˆ°æ­¤å¤„")
- en: Finally, weâ€™re ready to put these pieces together.
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œæˆ‘ä»¬å‡†å¤‡å°†è¿™äº›éƒ¨åˆ†ç»„åˆåœ¨ä¸€èµ·ã€‚
- en: We create a special kind of Pyret value called a reactor, which creates animations.
    Weâ€™ll start by creating a fairly simple kind of reactor, then grow it as the program
    gets more sophisticated.
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬åˆ›å»ºäº†ä¸€ç§ç‰¹æ®Šçš„ Pyret å€¼ï¼Œç§°ä¸ºååº”å™¨ï¼Œç”¨äºåˆ›å»ºåŠ¨ç”»ã€‚æˆ‘ä»¬å°†ä»åˆ›å»ºä¸€ç§ç›¸å½“ç®€å•çš„ååº”å™¨å¼€å§‹ï¼Œç„¶åéšç€ç¨‹åºçš„å¤æ‚åŒ–è€Œæ‰©å±•å®ƒã€‚
- en: 'The following code creates a reactor named `anim`:'
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥ä¸‹ä»£ç åˆ›å»ºäº†ä¸€ä¸ªåä¸º `anim` çš„ååº”å™¨ï¼š
- en: '[PRE50]'
  id: totrans-355
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: A reactor needs to be given an initial World State as well as handlers that
    tell it how to react. Specifying `on-tick` tells Pyret to run a clock and, every
    time the clock ticks (roughly thirty times a second), invoke the associated handler.
    The `to-draw` handler is used by Pyret to refresh the visual display.
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªååº”å™¨éœ€è¦æä¾›ä¸€ä¸ªåˆå§‹çš„ä¸–ç•ŒçŠ¶æ€ä»¥åŠå‘Šè¯‰å®ƒå¦‚ä½•ååº”çš„å¤„ç†ç¨‹åºã€‚æŒ‡å®š `on-tick` å‘Šè¯‰ Pyret è¿è¡Œä¸€ä¸ªæ—¶é’Ÿï¼Œå¹¶ä¸”æ¯å½“æ—¶é’Ÿæ»´ç­”ï¼ˆå¤§çº¦æ¯ç§’ä¸‰åæ¬¡ï¼‰æ—¶ï¼Œè°ƒç”¨ç›¸å…³å¤„ç†ç¨‹åºã€‚`to-draw`
    å¤„ç†ç¨‹åºè¢« Pyret ç”¨äºåˆ·æ–°è§†è§‰æ˜¾ç¤ºã€‚
- en: 'Having defined this reactor, we can run it in several ways that are useful
    for finding errors, running scientific experiments, and so on. Our needs here
    are simple; we ask Pyret to just run the program on the screen interactively:'
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: å®šä¹‰äº†è¿™ä¸ªååº”å™¨ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä»¥å‡ ç§æœ‰ç”¨çš„æ–¹å¼è¿è¡Œå®ƒï¼Œæ¯”å¦‚æŸ¥æ‰¾é”™è¯¯ã€è¿è¡Œç§‘å­¦å®éªŒç­‰ç­‰ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œçš„éœ€æ±‚å¾ˆç®€å•ï¼›æˆ‘ä»¬è¦æ±‚ Pyret äº¤äº’å¼åœ°ä»…å°†ç¨‹åºè¿è¡Œåœ¨å±å¹•ä¸Šï¼š
- en: '[PRE51]'
  id: totrans-358
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: This creates a running program where the airplane flies across the background!
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™åˆ›å»ºäº†ä¸€ä¸ªè¿è¡Œä¸­çš„ç¨‹åºï¼Œé£æœºåœ¨èƒŒæ™¯ä¸Šé£è¡Œï¼
- en: Thatâ€™s it! Weâ€™ve created our first animation. Now that weâ€™ve gotten all the
    preliminaries out of the way, we can go about enhancing it.
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: é‚£å°±æ˜¯å…¨éƒ¨äº†ï¼æˆ‘ä»¬å·²ç»åˆ›å»ºäº†æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªåŠ¨ç”»ã€‚ç°åœ¨æˆ‘ä»¬å·²ç»å¤„ç†å®Œæ‰€æœ‰åˆæ­¥å·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥ç€æ‰‹å¢å¼ºå®ƒäº†ã€‚
- en: Exercise
  id: totrans-361
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-362
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: If you want the airplane to appear to move faster, what can you change?
  id: totrans-363
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å¦‚æœä½ æƒ³è®©é£æœºçœ‹èµ·æ¥ç§»åŠ¨å¾—æ›´å¿«ï¼Œä½ å¯ä»¥æ”¹å˜ä»€ä¹ˆï¼Ÿ
- en: 27.3.1Â Updating the World State[ğŸ”—](#(part._.Updating_the_.World_.State) "Link
    to here")
  id: totrans-364
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 27.3.1 æ›´æ–°ä¸–ç•ŒçŠ¶æ€[ğŸ”—](#(part._.Updating_the_.World_.State) "é“¾æ¥åˆ°æ­¤å¤„")
- en: As weâ€™ve noted, the airplane doesnâ€™t actually â€œmoveâ€. Rather, we can ask Pyret
    to notify us every time a clock ticks. If on each tick we place the airplane in
    an appropriately different position, and the ticks happen often enough, we will
    get the impression of motion.
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: æ­£å¦‚æˆ‘ä»¬æ‰€æåˆ°çš„ï¼Œé£æœºå®é™…ä¸Šå¹¶æ²¡æœ‰â€œç§»åŠ¨â€ã€‚ç›¸åï¼Œæˆ‘ä»¬å¯ä»¥è¦æ±‚ Pyret æ¯å½“æ—¶é’Ÿæ»´ç­”æ—¶é€šçŸ¥æˆ‘ä»¬ã€‚å¦‚æœæ¯æ¬¡æ»´ç­”æˆ‘ä»¬éƒ½å°†é£æœºæ”¾ç½®åœ¨é€‚å½“ä¸åŒçš„ä½ç½®ï¼Œå¹¶ä¸”æ»´ç­”å‘ç”Ÿå¾—è¶³å¤Ÿé¢‘ç¹ï¼Œæˆ‘ä»¬å°±ä¼šäº§ç”Ÿè¿åŠ¨çš„å°è±¡ã€‚
- en: 'Because the World State consists of just the airplaneâ€™s x-position, to move
    it to the right, we simply increment its value. Letâ€™s first give this constant
    distance a name:'
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äºä¸–ç•ŒçŠ¶æ€ä»…ç”±é£æœºçš„ x ä½ç½®ç»„æˆï¼Œè¦å°†å®ƒå‘å³ç§»åŠ¨ï¼Œæˆ‘ä»¬åªéœ€å¢åŠ å…¶å€¼ã€‚è®©æˆ‘ä»¬é¦–å…ˆç»™è¿™ä¸ªå¸¸æ•°è·ç¦»èµ·ä¸€ä¸ªåå­—ï¼š
- en: '[PRE52]'
  id: totrans-367
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'We will need to write a function that reflects this movement. Letâ€™s first write
    some test cases:'
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸ªåæ˜ è¿™ç§ç§»åŠ¨çš„å‡½æ•°ã€‚è®©æˆ‘ä»¬é¦–å…ˆç¼–å†™ä¸€äº›æµ‹è¯•ç”¨ä¾‹ï¼š
- en: '[PRE53]'
  id: totrans-369
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: 'The functionâ€™s definition is now clear:'
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: å‡½æ•°çš„å®šä¹‰ç°åœ¨å¾ˆæ¸…æ™°ï¼š
- en: '[PRE54]'
  id: totrans-371
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: And sure enough, Pyret will confirm that this function passes all of its tests.
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: ç¡®å®ï¼ŒPyret å°†ç¡®è®¤è¿™ä¸ªå‡½æ•°é€šè¿‡äº†æ‰€æœ‰çš„æµ‹è¯•ã€‚
- en: Note
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„
- en: 'If you have prior experience programming animations and reactive programs,
    you will immediately notice an important difference: itâ€™s easy to test parts of
    your program in Pyret!'
  id: totrans-374
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å¦‚æœä½ ä¹‹å‰æœ‰ç¼–ç¨‹åŠ¨ç”»å’Œå“åº”å¼ç¨‹åºçš„ç»éªŒï¼Œä½ å°†ç«‹å³æ³¨æ„åˆ°ä¸€ä¸ªé‡è¦çš„åŒºåˆ«ï¼šåœ¨ Pyret ä¸­æµ‹è¯•ç¨‹åºçš„éƒ¨åˆ†å¾ˆå®¹æ˜“ï¼
- en: 27.3.2Â Displaying the World State[ğŸ”—](#(part._.Displaying_the_.World_.State)
    "Link to here")
  id: totrans-375
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 27.3.2Â æ˜¾ç¤ºä¸–ç•ŒçŠ¶æ€[ğŸ”—](#(part._.Displaying_the_.World_.State) "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'Now weâ€™re ready to draw the gameâ€™s visual output. We produce an image that
    consists of all the necessary components. It first helps to define some constants
    representing the visual output:'
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½ç»˜åˆ¶æ¸¸æˆçš„è§†è§‰è¾“å‡ºã€‚æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªåŒ…å«æ‰€æœ‰å¿…è¦ç»„ä»¶çš„å›¾åƒã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€äº›ä»£è¡¨è§†è§‰è¾“å‡ºçš„å¸¸é‡ï¼š
- en: '[PRE55]'
  id: totrans-377
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 'Using these, we can create a blank canvas, and overlay rectangles representing
    water and land:'
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨è¿™äº›å¸¸é‡ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç©ºç™½ç”»å¸ƒï¼Œå¹¶åœ¨å…¶ä¸Šå åŠ ä»£è¡¨æ°´å’Œé™†åœ°çš„çŸ©å½¢ï¼š
- en: '[PRE56]'
  id: totrans-379
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: Examine the value of `BACKGROUND` in the interactions area to confirm that it
    looks right.
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: æ£€æŸ¥äº¤äº’åŒºåŸŸä¸­ `BACKGROUND` çš„å€¼ï¼Œä»¥ç¡®è®¤å®ƒçœ‹èµ·æ¥æ­£ç¡®ã€‚
- en: Do Now!
  id: totrans-381
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç°åœ¨è¡ŒåŠ¨èµ·æ¥ï¼
- en: ''
  id: totrans-382
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: The reason we divide by two when placing `BASE` is because Pyret puts the middle
    of the image at the given location. Remove the division and see what happens to
    the resulting image.
  id: totrans-383
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬åœ¨æ”¾ç½® `BASE` æ—¶å°†å€¼é™¤ä»¥äºŒçš„åŸå› æ˜¯ Pyret å°†å›¾åƒçš„ä¸­é—´ä½ç½®æ”¾åœ¨ç»™å®šä½ç½®ã€‚ç§»é™¤é™¤æ³•å¹¶çœ‹çœ‹ç»“æœå›¾åƒä¼šå‘ç”Ÿä»€ä¹ˆå˜åŒ–ã€‚
- en: 'Now that we know how to get our background, weâ€™re ready to place the airplane
    on it. The expression to do so looks roughly like this:'
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†å¦‚ä½•è·å–èƒŒæ™¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†é£æœºæ”¾ç½®åœ¨å…¶ä¸Šäº†ã€‚æ‰§è¡Œæ­¤æ“ä½œçš„è¡¨è¾¾å¼çœ‹èµ·æ¥å¤§è‡´å¦‚ä¸‹ï¼š
- en: '[PRE57]'
  id: totrans-385
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: 'but what x position do we use? Actually, thatâ€™s just what the World State represents!
    So we create a function out of this expression:'
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†æˆ‘ä»¬ä½¿ç”¨ä»€ä¹ˆ x åæ ‡ï¼Ÿå®é™…ä¸Šï¼Œè¿™æ­£æ˜¯ä¸–ç•ŒçŠ¶æ€æ‰€ä»£è¡¨çš„ï¼å› æ­¤ï¼Œæˆ‘ä»¬ä»è¿™ä¸ªè¡¨è¾¾å¼ä¸­åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼š
- en: '[PRE58]'
  id: totrans-387
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: 27.3.3Â Observing Time (and Combining the Pieces)[ğŸ”—](#(part._.Observing_.Time__and_.Combining_the_.Pieces_)
    "Link to here")
  id: totrans-388
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 27.3.3Â è§‚å¯Ÿæ—¶é—´ï¼ˆä»¥åŠç»„åˆå„ä¸ªéƒ¨åˆ†ï¼‰[ğŸ”—](#(part._.Observing_.Time__and_.Combining_the_.Pieces_)
    "é“¾æ¥åˆ°æ­¤å¤„")
- en: Finally, weâ€™re ready to put these pieces together.
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œæˆ‘ä»¬å‡†å¤‡å°†è¿™äº›éƒ¨åˆ†ç»„åˆåœ¨ä¸€èµ·ã€‚
- en: We create a special kind of Pyret value called a reactor, which creates animations.
    Weâ€™ll start by creating a fairly simple kind of reactor, then grow it as the program
    gets more sophisticated.
  id: totrans-390
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬åˆ›å»ºäº†ä¸€ç§ç‰¹æ®Šçš„ Pyret å€¼ï¼Œç§°ä¸ºååº”å™¨ï¼Œå®ƒç”¨äºåˆ›å»ºåŠ¨ç”»ã€‚æˆ‘ä»¬å°†ä»åˆ›å»ºä¸€ç§ç›¸å½“ç®€å•çš„ååº”å™¨å¼€å§‹ï¼Œç„¶åéšç€ç¨‹åºçš„å¤æ‚åŒ–è€Œæ‰©å±•å®ƒã€‚
- en: 'The following code creates a reactor named `anim`:'
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥ä¸‹ä»£ç åˆ›å»ºäº†ä¸€ä¸ªåä¸º `anim` çš„ååº”å™¨ï¼š
- en: '[PRE59]'
  id: totrans-392
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: A reactor needs to be given an initial World State as well as handlers that
    tell it how to react. Specifying `on-tick` tells Pyret to run a clock and, every
    time the clock ticks (roughly thirty times a second), invoke the associated handler.
    The `to-draw` handler is used by Pyret to refresh the visual display.
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
  zh: ååº”å™¨éœ€è¦æä¾›ä¸€ä¸ªåˆå§‹ä¸–ç•ŒçŠ¶æ€ä»¥åŠå‘Šè¯‰å®ƒå¦‚ä½•ååº”çš„å¤„ç†ç¨‹åºã€‚æŒ‡å®š `on-tick` å‘Šè¯‰ Pyret è¿è¡Œä¸€ä¸ªæ—¶é’Ÿï¼Œå¹¶ä¸”æ¯å½“æ—¶é’Ÿæ»´ç­”ï¼ˆå¤§çº¦æ¯ç§’ä¸‰åæ¬¡ï¼‰æ—¶ï¼Œè°ƒç”¨ç›¸å…³å¤„ç†ç¨‹åºã€‚`to-draw`
    å¤„ç†ç¨‹åºç”± Pyret ç”¨äºåˆ·æ–°è§†è§‰æ˜¾ç¤ºã€‚
- en: 'Having defined this reactor, we can run it in several ways that are useful
    for finding errors, running scientific experiments, and so on. Our needs here
    are simple; we ask Pyret to just run the program on the screen interactively:'
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: å®šä¹‰äº†è¿™ç§ååº”å™¨åï¼Œæˆ‘ä»¬å¯ä»¥ä»¥å‡ ç§æœ‰ç”¨çš„æ–¹å¼è¿è¡Œå®ƒï¼Œä¾‹å¦‚æŸ¥æ‰¾é”™è¯¯ã€è¿è¡Œç§‘å­¦å®éªŒç­‰ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œçš„éœ€æ±‚å¾ˆç®€å•ï¼›æˆ‘ä»¬è¦æ±‚ Pyret äº¤äº’å¼åœ°åœ¨å±å¹•ä¸Šè¿è¡Œç¨‹åºï¼š
- en: '[PRE60]'
  id: totrans-395
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: This creates a running program where the airplane flies across the background!
  id: totrans-396
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™åˆ›å»ºäº†ä¸€ä¸ªè¿è¡Œä¸­çš„ç¨‹åºï¼Œé£æœºåœ¨èƒŒæ™¯ä¸­é£è¡Œï¼
- en: Thatâ€™s it! Weâ€™ve created our first animation. Now that weâ€™ve gotten all the
    preliminaries out of the way, we can go about enhancing it.
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: å°±è¿™æ ·ï¼æˆ‘ä»¬å·²ç»åˆ›å»ºäº†æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªåŠ¨ç”»ã€‚ç°åœ¨æˆ‘ä»¬å·²ç»å®Œæˆäº†æ‰€æœ‰åˆæ­¥å·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥ç€æ‰‹å¢å¼ºå®ƒã€‚
- en: Exercise
  id: totrans-398
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-399
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: If you want the airplane to appear to move faster, what can you change?
  id: totrans-400
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å¦‚æœä½ æƒ³è®©é£æœºçœ‹èµ·æ¥ç§»åŠ¨å¾—æ›´å¿«ï¼Œä½ å¯ä»¥æ”¹å˜ä»€ä¹ˆï¼Ÿ
- en: '27.4Â Version: Wrapping Around[ğŸ”—](#(part._.Version__.Wrapping_.Around) "Link
    to here")'
  id: totrans-401
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.4Â ç‰ˆæœ¬ï¼šå¾ªç¯[ğŸ”—](#(part._.Version__.Wrapping_.Around) "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'When you run the preceding program, youâ€™ll notice that after a while, the airplane
    just disappears. This is because it has gone past the right edge of the screen;
    it is still being â€œdrawnâ€, but in a location that you cannot see. Thatâ€™s not very
    useful!Also, after a long while you might get an error because the computer is
    being asked to draw the airplane at a location beyond what the graphics system
    can manage. Instead, when the airplane is about to go past the right edge of the
    screen, weâ€™d like it to reappear on the left by a corresponding amount: â€œwrapping
    aroundâ€, as it were.'
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
  zh: å½“ä½ è¿è¡Œå‰é¢çš„ç¨‹åºæ—¶ï¼Œä½ ä¼šæ³¨æ„åˆ°è¿‡ä¸€æ®µæ—¶é—´åï¼Œé£æœºå°±æ¶ˆå¤±äº†ã€‚è¿™æ˜¯å› ä¸ºå®ƒå·²ç»è¶…è¿‡äº†å±å¹•çš„å³ä¾§è¾¹ç¼˜ï¼›å®ƒä»ç„¶åœ¨â€œç»˜åˆ¶â€ï¼Œä½†ä½ç½®æ˜¯ä½ çœ‹ä¸åˆ°çš„ã€‚è¿™å¹¶ä¸å¤ªæœ‰ç”¨ï¼æ­¤å¤–ï¼Œç»è¿‡ä¸€æ®µæ—¶é—´åï¼Œä½ å¯èƒ½ä¼šé‡åˆ°é”™è¯¯ï¼Œå› ä¸ºè®¡ç®—æœºè¢«è¦æ±‚åœ¨å›¾å½¢ç³»ç»Ÿæ— æ³•ç®¡ç†çš„ä½ç½®ç»˜åˆ¶é£æœºã€‚ç›¸åï¼Œå½“é£æœºå³å°†è¶…è¿‡å±å¹•çš„å³ä¾§è¾¹ç¼˜æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒä»¥ç›¸åº”çš„é‡åœ¨å·¦ä¾§é‡æ–°å‡ºç°ï¼šâ€œç¯ç»•â€ï¼Œå°±åƒé‚£æ ·ã€‚
- en: '[Hereâ€™s the video for this version.](https://drive.google.com/file/d/1zL4PY1vOWgFMBuPmMvr8wixh5VE9Pg_r/view?usp=share_link)'
  id: totrans-403
  prefs: []
  type: TYPE_NORMAL
  zh: '[è¿™æ˜¯è¿™ä¸ªç‰ˆæœ¬çš„æ¼”ç¤ºè§†é¢‘ã€‚](https://drive.google.com/file/d/1zL4PY1vOWgFMBuPmMvr8wixh5VE9Pg_r/view?usp=share_link)'
- en: Do Now!
  id: totrans-404
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç«‹å³è¡ŒåŠ¨ï¼
- en: ''
  id: totrans-405
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: What needs to change?
  id: totrans-406
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: éœ€è¦æ”¹å˜ä»€ä¹ˆï¼Ÿ
- en: Clearly, we need to modify the function that updates the airplaneâ€™s location,
    since this must now reflect our decision to wrap around. But the task of how to
    draw the airplane doesnâ€™t need to change at all! Similarly, the definition of
    the World State does not need to change, either.
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
  zh: æ˜¾ç„¶ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹æ›´æ–°é£æœºä½ç½®çš„å‡½æ•°ï¼Œå› ä¸ºè¿™ä¸ªå‡½æ•°ç°åœ¨å¿…é¡»åæ˜ æˆ‘ä»¬çš„ç¯ç»•å†³ç­–ã€‚ä½†ç»˜åˆ¶é£æœºçš„ä»»åŠ¡æ ¹æœ¬ä¸éœ€è¦æ”¹å˜ï¼åŒæ ·ï¼Œä¸–ç•ŒçŠ¶æ€çš„å®šä¹‰ä¹Ÿä¸éœ€è¦æ”¹å˜ã€‚
- en: 'Therefore, we only need to modify `move-airplane-x-on-tick`. The function `num-modulo`
    does exactly what we need. That is, we want the x-location to always be modulo
    the width of the scene:'
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹`move-airplane-x-on-tick`ã€‚`num-modulo`å‡½æ•°æ­£å¥½æ˜¯æˆ‘ä»¬éœ€è¦çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›xä½ç½®å§‹ç»ˆæ˜¯åœºæ™¯å®½åº¦çš„æ¨¡æ•°ï¼š
- en: '[PRE61]'
  id: totrans-409
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: 'Notice that, instead of copying the content of the previous definition we can
    simply reuse it:'
  id: totrans-410
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œæˆ‘ä»¬ä¸å¿…å¤åˆ¶ä¸Šä¸€ä¸ªå®šä¹‰çš„å†…å®¹ï¼Œå¯ä»¥ç›´æ¥é‡ç”¨å®ƒï¼š
- en: '[PRE62]'
  id: totrans-411
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: 'which makes our intent clearer: compute whatever position we would have had
    before, but adapt the coordinate to remain within the sceneâ€™s width.'
  id: totrans-412
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä½¿å¾—æˆ‘ä»¬çš„æ„å›¾æ›´æ¸…æ™°ï¼šè®¡ç®—æˆ‘ä»¬åŸæœ¬ä¼šæœ‰çš„ä»»ä½•ä½ç½®ï¼Œä½†è°ƒæ•´åæ ‡ä»¥ä¿æŒåœ¨åœºæ™¯å®½åº¦å†…ã€‚
- en: 'Well, thatâ€™s a proposed re-definition. Be sure to test this function thoroughly:
    itâ€™s tricker than you might think! Have you thought about all the cases? For instance,
    what happens if the airplane is half-way off the right edge of the screen?'
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: å¥½å§ï¼Œè¿™æ˜¯ä¸€ä¸ªæè®®çš„é‡æ–°å®šä¹‰ã€‚åŠ¡å¿…å½»åº•æµ‹è¯•è¿™ä¸ªå‡½æ•°ï¼šå®ƒæ¯”ä½ æƒ³è±¡çš„è¦å¤æ‚ï¼ä½ è€ƒè™‘è¿‡æ‰€æœ‰çš„æƒ…å†µå—ï¼Ÿä¾‹å¦‚ï¼Œå¦‚æœé£æœºåœ¨å±å¹•å³ä¾§è¾¹ç¼˜çš„ä¸€åŠä½ç½®ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ
- en: Exercise
  id: totrans-414
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-415
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Define quality tests for `move-airplane-wrapping-x-on-tick`.
  id: totrans-416
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸º`move-airplane-wrapping-x-on-tick`å®šä¹‰è´¨é‡æµ‹è¯•ã€‚
- en: Note
  id: totrans-417
  prefs: []
  type: TYPE_NORMAL
  zh: å¤‡æ³¨
- en: It is possible to leave `move-airplane-x-on-tick` unchanged and perform the
    modular arithmetic in `place-airplane-x` instead. We choose not to do that for
    the following reason. In this version, we really do think of the airplane as circling
    around and starting again from the left edge (imagine the world is a cylinder...).
    Thus, the airplaneâ€™s x-position really does keep going back down. If instead we
    allowed the World State to increase monotonically, then it would really be representing
    the total distance traveled, contradicting our definition of the World State.
  id: totrans-418
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å¯ä»¥ä¿æŒ`move-airplane-x-on-tick`ä¸å˜ï¼Œå¹¶åœ¨`place-airplane-x`ä¸­æ‰§è¡Œæ¨¡è¿ç®—ã€‚æˆ‘ä»¬é€‰æ‹©ä¸è¿™æ ·åšçš„åŸå› å¦‚ä¸‹ã€‚åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬çœŸçš„æŠŠé£æœºæƒ³è±¡æˆåœ¨ç»•åœˆå¹¶ä»å·¦ä¾§è¾¹ç¼˜é‡æ–°å¼€å§‹ï¼ˆæƒ³è±¡ä¸–ç•Œæ˜¯ä¸€ä¸ªåœ†æŸ±ä½“...ï¼‰ã€‚å› æ­¤ï¼Œé£æœºçš„xä½ç½®ç¡®å®ä¼šä¸æ–­ä¸‹é™ã€‚å¦‚æœæˆ‘ä»¬å…è®¸ä¸–ç•ŒçŠ¶æ€å•è°ƒå¢åŠ ï¼Œé‚£ä¹ˆå®ƒå®é™…ä¸Šä¼šä»£è¡¨æ€»è¡Œç¨‹è·ç¦»ï¼Œè¿™ä¸æˆ‘ä»¬å¯¹ä¸–ç•ŒçŠ¶æ€çš„å®šä¹‰ç›¸çŸ›ç›¾ã€‚
- en: Do Now!
  id: totrans-419
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç«‹å³è¡ŒåŠ¨ï¼
- en: ''
  id: totrans-420
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: After adding this function, run your program again. Did you see any change in
    behavior?
  id: totrans-421
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ·»åŠ è¿™ä¸ªå‡½æ•°åï¼Œå†æ¬¡è¿è¡Œä½ çš„ç¨‹åºã€‚ä½ çœ‹åˆ°ä»»ä½•è¡Œä¸ºä¸Šçš„å˜åŒ–äº†å—ï¼Ÿ
- en: If you didnâ€™tâ€¦did you remember to update your reactor to use the new airplane-moving
    function?
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ æ²¡æœ‰...ä½ è®°å¾—æ›´æ–°ä½ çš„ååº”å †ä»¥ä½¿ç”¨æ–°çš„é£æœºç§»åŠ¨å‡½æ•°å—ï¼Ÿ
- en: '27.5Â Version: Descending[ğŸ”—](#(part._.Version__.Descending) "Link to here")'
  id: totrans-423
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.5 ç‰ˆæœ¬ï¼šä¸‹é™[ğŸ”—](#(part._.Version__.Descending) "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'Of course, we need our airplane to move in more than just one dimension: to
    get to the final game, it must both ascend and descend as well. For now, weâ€™ll
    focus on the simplest version of this, which is an airplane that continuously
    descends. [Hereâ€™s a video.](https://drive.google.com/file/d/1fJ7eJ7Uv-YCXm87OKH5obAYFXp1pAnZo/view?usp=share_link)'
  id: totrans-424
  prefs: []
  type: TYPE_NORMAL
  zh: å½“ç„¶ï¼Œæˆ‘ä»¬çš„é£æœºéœ€è¦åœ¨ä¸æ­¢ä¸€ä¸ªç»´åº¦ä¸Šç§»åŠ¨ï¼šä¸ºäº†åˆ°è¾¾æœ€ç»ˆçš„æ¸¸æˆï¼Œå®ƒå¿…é¡»æ—¢èƒ½ä¸Šå‡ä¹Ÿèƒ½ä¸‹é™ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°†å…³æ³¨è¿™ä¸ªæœ€ç®€å•çš„ç‰ˆæœ¬ï¼Œå³é£æœºæŒç»­ä¸‹é™ã€‚[è¿™é‡Œæœ‰ä¸€ä¸ªè§†é¢‘ã€‚](https://drive.google.com/file/d/1fJ7eJ7Uv-YCXm87OKH5obAYFXp1pAnZo/view?usp=share_link)
- en: Letâ€™s again consider individual frames of this video. Whatâ€™s staying the same?
    Once again, the water and the land. Whatâ€™s changing? The position of the airplane.
    But, whereas before the airplane moved only in the x-dimension, now it moves in
    both x and y. That immediately tells us that our definition of the World State
    is inadequate, and must be modified.
  id: totrans-425
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬å†æ¬¡è€ƒè™‘è¿™ä¸ªè§†é¢‘çš„å•ç‹¬å¸§ã€‚ä»€ä¹ˆä¿æŒä¸å˜ï¼Ÿå†æ¬¡ï¼Œæ˜¯æ°´å’Œé™†åœ°ã€‚ä»€ä¹ˆåœ¨å˜åŒ–ï¼Ÿé£æœºçš„ä½ç½®ã€‚ä½†æ˜¯ï¼Œä¸ä¹‹å‰é£æœºåªåœ¨xç»´åº¦ç§»åŠ¨ä¸åŒï¼Œç°åœ¨å®ƒåœ¨xå’Œyä¸¤ä¸ªç»´åº¦ä¸Šç§»åŠ¨ã€‚è¿™ç«‹å³å‘Šè¯‰æˆ‘ä»¬ï¼Œæˆ‘ä»¬å¯¹ä¸–ç•ŒçŠ¶æ€çš„å®šä¹‰æ˜¯ä¸å……åˆ†çš„ï¼Œå¿…é¡»è¿›è¡Œä¿®æ”¹ã€‚
- en: 'We therefore define a new structure to hold this pair of data:'
  id: totrans-426
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ–°çš„ç»“æ„æ¥ä¿å­˜è¿™ç»„æ•°æ®ï¼š
- en: '[PRE63]'
  id: totrans-427
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: 'Given this, we can revise our definition:'
  id: totrans-428
  prefs: []
  type: TYPE_NORMAL
  zh: ç»™å®šè¿™ä¸ªï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹æˆ‘ä»¬çš„å®šä¹‰ï¼š
- en: World Definition
  id: totrans-429
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸–ç•Œå®šä¹‰
- en: The World State is a `posn`, representing the x-position and y-position of the
    airplane on the screen.
  id: totrans-430
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸–ç•ŒçŠ¶æ€æ˜¯ä¸€ä¸ª`posn`ï¼Œè¡¨ç¤ºé£æœºåœ¨å±å¹•ä¸Šçš„xä½ç½®å’Œyä½ç½®ã€‚
- en: 27.5.1Â Moving the Airplane[ğŸ”—](#(part._.Moving_the_.Airplane) "Link to here")
  id: totrans-431
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 27.5.1 ç§»åŠ¨é£æœº[ğŸ”—](#(part._.Moving_the_.Airplane) "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'First, letâ€™s consider `move-airplane-wrapping-x-on-tick`. Previously our airplane
    moved only in the x-direction; now we want it to descend as well, which means
    we must add something to the current y value:'
  id: totrans-432
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œè®©æˆ‘ä»¬è€ƒè™‘`move-airplane-wrapping-x-on-tick`ã€‚ä¹‹å‰æˆ‘ä»¬çš„é£æœºåªåœ¨xæ–¹å‘ç§»åŠ¨ï¼›ç°åœ¨æˆ‘ä»¬å¸Œæœ›å®ƒä¹Ÿèƒ½ä¸‹é™ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¿…é¡»å‘å½“å‰çš„yå€¼æ·»åŠ ä¸€äº›å†…å®¹ï¼š
- en: '[PRE64]'
  id: totrans-433
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: 'Letâ€™s write some test cases for the new function. Hereâ€™s one:'
  id: totrans-434
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä¸ºè¿™ä¸ªæ–°å‡½æ•°ç¼–å†™ä¸€äº›æµ‹è¯•ç”¨ä¾‹ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªï¼š
- en: '[PRE65]'
  id: totrans-435
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: 'Another way to write the test would be:'
  id: totrans-436
  prefs: []
  type: TYPE_NORMAL
  zh: ç¼–å†™æµ‹è¯•çš„å¦ä¸€ç§æ–¹å¼æ˜¯ï¼š
- en: '[PRE66]'
  id: totrans-437
  prefs: []
  type: TYPE_PRE
  zh: '[PRE66]'
- en: Note
  id: totrans-438
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„
- en: 'Which method of writing tests is better? Both! They each offer different advantages:'
  id: totrans-439
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å“ªç§æµ‹è¯•ç¼–å†™æ–¹æ³•æ›´å¥½ï¼Ÿä¸¤è€…éƒ½å¥½ï¼å®ƒä»¬å„è‡ªæä¾›äº†ä¸åŒçš„ä¼˜åŠ¿ï¼š
- en: ''
  id: totrans-440
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'The former method has the benefit of being very concrete: thereâ€™s no question
    what you expect, and it demonstrates that you really can compute the desired answer
    from first principles.'
  id: totrans-441
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‰è€…æ–¹æ³•çš„å¥½å¤„æ˜¯å®ƒéå¸¸å…·ä½“ï¼šä½ ä¸ä¼šå¯¹æœŸæœ›çš„å†…å®¹æœ‰ç–‘é—®ï¼Œå¹¶ä¸”å®ƒè¯æ˜äº†ä½ å¯ä»¥ä»ç¬¬ä¸€åŸç†è®¡ç®—å‡ºæ‰€éœ€çš„ç­”æ¡ˆã€‚
- en: ''
  id: totrans-442
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-443
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: The latter method has the advantage that, if you change the constants in your
    program (such as the rate of descent), seemingly correct tests do not suddenly
    fail. That is, this form of testing is more about the relationships between things
    rather than their precise values.
  id: totrans-444
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: åè€…æ–¹æ³•çš„å¥½å¤„æ˜¯ï¼Œå¦‚æœä½ æ›´æ”¹ç¨‹åºä¸­çš„å¸¸æ•°ï¼ˆä¾‹å¦‚ä¸‹é™é€Ÿç‡ï¼‰ï¼Œçœ‹ä¼¼æ­£ç¡®çš„æµ‹è¯•ä¸ä¼šçªç„¶å¤±è´¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ç§æµ‹è¯•å½¢å¼æ›´å¤šåœ°å…³æ³¨äº‹ç‰©ä¹‹é—´çš„å…³ç³»ï¼Œè€Œä¸æ˜¯å®ƒä»¬çš„ç²¾ç¡®å€¼ã€‚
- en: ''
  id: totrans-445
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-446
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-447
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'There is one more choice available, which often combines the best of both worlds:
    write the answer as concretely as possible (the former style), but using constants
    to compute the answer (the advantage of the latter style). For instance:'
  id: totrans-448
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: è¿˜æœ‰ä¸€ä¸ªé€‰æ‹©å¯ç”¨ï¼Œå®ƒé€šå¸¸ç»“åˆäº†ä¸¤ç§æ–¹æ³•çš„ä¼˜ç‚¹ï¼šå°½å¯èƒ½å…·ä½“åœ°ç¼–å†™ç­”æ¡ˆï¼ˆå‰è€…é£æ ¼ï¼‰ï¼Œä½†ä½¿ç”¨å¸¸æ•°æ¥è®¡ç®—ç­”æ¡ˆï¼ˆåè€…é£æ ¼çš„ä¼˜åŠ¿ï¼‰ã€‚ä¾‹å¦‚ï¼š
- en: ''
  id: totrans-449
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE67]'
  id: totrans-450
  prefs:
  - PREF_BQ
  type: TYPE_PRE
  zh: '[PRE67]'
- en: Exercise
  id: totrans-451
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-452
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Before you proceed, have you written enough test cases? Are you sure? Have you,
    for instance, tested what should happen when the airplane is near the edge of
    the screen in either or both dimensions? We thought notâ€”<wbr>go back and write
    more tests before you proceed!
  id: totrans-453
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åœ¨ä½ ç»§ç»­ä¹‹å‰ï¼Œä½ æ˜¯å¦å·²ç»ç¼–å†™äº†è¶³å¤Ÿçš„æµ‹è¯•ç”¨ä¾‹ï¼Ÿä½ ç¡®å®šå—ï¼Ÿä¾‹å¦‚ï¼Œä½ æ˜¯å¦æµ‹è¯•äº†å½“é£æœºåœ¨å±å¹•è¾¹ç¼˜é™„è¿‘æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæˆ‘ä»¬è®¤ä¸ºä½ æ²¡æœ‰â€”â€”åœ¨ä½ ç»§ç»­ä¹‹å‰ï¼Œå›å»ç¼–å†™æ›´å¤šçš„æµ‹è¯•ï¼
- en: 'Using the design recipe, now define `move-airplane-xy-on-tick`. You should
    end up with something like this:'
  id: totrans-454
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨è®¾è®¡é…æ–¹ï¼Œç°åœ¨å®šä¹‰`move-airplane-xy-on-tick`ã€‚ä½ åº”è¯¥å¾—åˆ°ç±»ä¼¼è¿™æ ·çš„ç»“æœï¼š
- en: '[PRE68]'
  id: totrans-455
  prefs: []
  type: TYPE_PRE
  zh: '[PRE68]'
- en: 'Note that we have reused the existing function for the x-dimension and, correspondingly,
    created a helper for the y dimension:'
  id: totrans-456
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œæˆ‘ä»¬å·²ç»é‡ç”¨äº†ç°æœ‰çš„xç»´åº¦çš„å‡½æ•°ï¼Œå¹¶ç›¸åº”åœ°ä¸ºyç»´åº¦åˆ›å»ºäº†ä¸€ä¸ªè¾…åŠ©å‡½æ•°ï¼š
- en: '[PRE69]'
  id: totrans-457
  prefs: []
  type: TYPE_PRE
  zh: '[PRE69]'
- en: This may be slight overkill for now, but it does lead to a cleaner separation
    of concerns, and makes it possible for the complexity of movement in each dimension
    to evolve independently while keeping the code relatively readable.
  id: totrans-458
  prefs: []
  type: TYPE_NORMAL
  zh: ç›®å‰è¿™å¯èƒ½æ˜¯æœ‰ç‚¹è¿‡åº¦ï¼Œä½†å®ƒç¡®å®å¯¼è‡´äº†å…³æ³¨ç‚¹çš„æ›´æ¸…æ™°åˆ†ç¦»ï¼Œå¹¶ä½¿å¾—æ¯ä¸ªç»´åº¦çš„è¿åŠ¨å¤æ‚æ€§å¯ä»¥ç‹¬ç«‹å‘å±•ï¼ŒåŒæ—¶ä¿æŒä»£ç ç›¸å¯¹å¯è¯»ã€‚
- en: 27.5.2Â Drawing the Scene[ğŸ”—](#(part._.Drawing_the_.Scene) "Link to here")
  id: totrans-459
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 27.5.2 ç»˜åˆ¶åœºæ™¯[ğŸ”—](#(part._.Drawing_the_.Scene) "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'We have to also examine and update `place-airplane-x`. Our earlier definition
    placed the airplane at an arbitrary y-coordinate; now we have to take the y-coordinate
    from the World State:'
  id: totrans-460
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è¿˜å¿…é¡»æ£€æŸ¥å¹¶æ›´æ–°`place-airplane-x`ã€‚æˆ‘ä»¬ä¹‹å‰çš„å®šä¹‰å°†é£æœºæ”¾ç½®åœ¨ä»»æ„çš„yåæ ‡ä¸Šï¼›ç°åœ¨æˆ‘ä»¬å¿…é¡»ä»ä¸–ç•ŒçŠ¶æ€ä¸­è·å–yåæ ‡ï¼š
- en: '[PRE70]'
  id: totrans-461
  prefs: []
  type: TYPE_PRE
  zh: '[PRE70]'
- en: Notice that we canâ€™t really reuse the previous definition because it hard-coded
    the y-position, which we must now make a parameter.
  id: totrans-462
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œæˆ‘ä»¬å®é™…ä¸Šä¸èƒ½é‡ç”¨ä¹‹å‰çš„å®šä¹‰ï¼Œå› ä¸ºå®ƒç¡¬ç¼–ç äº†yä½ç½®ï¼Œæˆ‘ä»¬ç°åœ¨å¿…é¡»å°†å…¶ä½œä¸ºä¸€ä¸ªå‚æ•°ã€‚
- en: 27.5.3Â Finishing Touches[ğŸ”—](#(part._.Finishing_.Touches) "Link to here")
  id: totrans-463
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 27.5.3 å®Œæˆç»†èŠ‚[ğŸ”—](#(part._.Finishing_.Touches) "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'Are we done? It would seem so: weâ€™ve examined all the procedures that consume
    and produce World State and updated them appropriately. Actually, weâ€™re forgetting
    one small thing: the initial World State given to the reactor! If weâ€™ve changed
    the definition of World State, then we need to update this too. (We also need
    to use the new functions rather than the old ones.)'
  id: totrans-464
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å®Œæˆäº†å—ï¼Ÿçœ‹èµ·æ¥æ˜¯è¿™æ ·ï¼šæˆ‘ä»¬å·²ç»æ£€æŸ¥äº†æ‰€æœ‰æ¶ˆè€—å’Œäº§ç”Ÿä¸–ç•ŒçŠ¶æ€çš„ç¨‹åºï¼Œå¹¶ç›¸åº”åœ°æ›´æ–°äº†å®ƒä»¬ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬å¿½ç•¥äº†ä¸€ä»¶äº‹ï¼šç»™ååº”å™¨çš„åˆå§‹ä¸–ç•ŒçŠ¶æ€ï¼å¦‚æœæˆ‘ä»¬å·²ç»æ”¹å˜äº†ä¸–ç•ŒçŠ¶æ€çš„å®šä¹‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿéœ€è¦æ›´æ–°è¿™ä¸ªã€‚ï¼ˆæˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨æ–°å‡½æ•°è€Œä¸æ˜¯æ—§å‡½æ•°ã€‚ï¼‰
- en: '[PRE71]'
  id: totrans-465
  prefs: []
  type: TYPE_PRE
  zh: '[PRE71]'
- en: Exercise
  id: totrans-466
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-467
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Itâ€™s a little unsatisfactory to have the airplane truncated by the screen. You
    can use `I.image-width` and `I.image-height` to obtain the dimensions of an image,
    such as the airplane. Use these to ensure the airplane fits entirely within the
    screen for the initial scene, and similarly in `move-airplane-xy-on-tick`.
  id: totrans-468
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: é£æœºè¢«å±å¹•æˆªæ–­æœ‰ç‚¹ä»¤äººä¸æ»¡æ„ã€‚ä½ å¯ä»¥ä½¿ç”¨ `I.image-width` å’Œ `I.image-height` æ¥è·å–å›¾åƒçš„å°ºå¯¸ï¼Œä¾‹å¦‚é£æœºã€‚ä½¿ç”¨è¿™äº›æ¥ç¡®ä¿é£æœºåœ¨åˆå§‹åœºæ™¯ä¸­å®Œå…¨ä½äºå±å¹•å†…ï¼ŒåŒæ ·åœ¨
    `move-airplane-xy-on-tick` ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚
- en: 27.5.1Â Moving the Airplane[ğŸ”—](#(part._.Moving_the_.Airplane) "Link to here")
  id: totrans-469
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 27.5.1 ç§»åŠ¨é£æœº[ğŸ”—](#(part._.Moving_the_.Airplane) "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'First, letâ€™s consider `move-airplane-wrapping-x-on-tick`. Previously our airplane
    moved only in the x-direction; now we want it to descend as well, which means
    we must add something to the current y value:'
  id: totrans-470
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œè®©æˆ‘ä»¬è€ƒè™‘ `move-airplane-wrapping-x-on-tick`ã€‚ä¹‹å‰æˆ‘ä»¬çš„é£æœºåªåœ¨xæ–¹å‘ç§»åŠ¨ï¼›ç°åœ¨æˆ‘ä»¬å¸Œæœ›å®ƒä¹Ÿèƒ½ä¸‹é™ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¿…é¡»å‘å½“å‰çš„yå€¼æ·»åŠ ä¸€äº›ä¸œè¥¿ï¼š
- en: '[PRE72]'
  id: totrans-471
  prefs: []
  type: TYPE_PRE
  zh: '[PRE72]'
- en: 'Letâ€™s write some test cases for the new function. Hereâ€™s one:'
  id: totrans-472
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä¸ºè¿™ä¸ªæ–°å‡½æ•°ç¼–å†™ä¸€äº›æµ‹è¯•ç”¨ä¾‹ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªï¼š
- en: '[PRE73]'
  id: totrans-473
  prefs: []
  type: TYPE_PRE
  zh: '[PRE73]'
- en: 'Another way to write the test would be:'
  id: totrans-474
  prefs: []
  type: TYPE_NORMAL
  zh: ç¼–å†™æµ‹è¯•çš„å¦ä¸€ç§æ–¹å¼æ˜¯ï¼š
- en: '[PRE74]'
  id: totrans-475
  prefs: []
  type: TYPE_PRE
  zh: '[PRE74]'
- en: Note
  id: totrans-476
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„
- en: 'Which method of writing tests is better? Both! They each offer different advantages:'
  id: totrans-477
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å“ªç§æµ‹è¯•ç¼–å†™æ–¹æ³•æ›´å¥½ï¼Ÿä¸¤è€…éƒ½å¥½ï¼å®ƒä»¬å„è‡ªæä¾›äº†ä¸åŒçš„ä¼˜åŠ¿ï¼š
- en: ''
  id: totrans-478
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'The former method has the benefit of being very concrete: thereâ€™s no question
    what you expect, and it demonstrates that you really can compute the desired answer
    from first principles.'
  id: totrans-479
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‰è€…æ–¹æ³•çš„å¥½å¤„æ˜¯å®ƒéå¸¸å…·ä½“ï¼šæ²¡æœ‰ç–‘é—®ä½ æœŸæœ›ä»€ä¹ˆï¼Œå¹¶ä¸”å®ƒè¯æ˜äº†ä½ å¯ä»¥ä»ç¬¬ä¸€åŸç†è®¡ç®—å‡ºæ‰€éœ€çš„ç­”æ¡ˆã€‚
- en: ''
  id: totrans-480
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-481
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: The latter method has the advantage that, if you change the constants in your
    program (such as the rate of descent), seemingly correct tests do not suddenly
    fail. That is, this form of testing is more about the relationships between things
    rather than their precise values.
  id: totrans-482
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: åè€…æ–¹æ³•çš„ä¼˜åŠ¿åœ¨äºï¼Œå¦‚æœä½ æ›´æ”¹ç¨‹åºä¸­çš„å¸¸é‡ï¼ˆä¾‹å¦‚ä¸‹é™é€Ÿåº¦ï¼‰ï¼Œçœ‹ä¼¼æ­£ç¡®çš„æµ‹è¯•ä¸ä¼šçªç„¶å¤±è´¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ç§æµ‹è¯•å½¢å¼æ›´å¤šåœ°å…³æ³¨äº‹ç‰©ä¹‹é—´çš„å…³ç³»ï¼Œè€Œä¸æ˜¯å®ƒä»¬çš„ç²¾ç¡®å€¼ã€‚
- en: ''
  id: totrans-483
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-484
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-485
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'There is one more choice available, which often combines the best of both worlds:
    write the answer as concretely as possible (the former style), but using constants
    to compute the answer (the advantage of the latter style). For instance:'
  id: totrans-486
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: è¿˜æœ‰ä¸€ä¸ªé€‰æ‹©å¯ç”¨ï¼Œå®ƒé€šå¸¸ç»“åˆäº†ä¸¤ç§æ–¹æ³•çš„ä¼˜ç‚¹ï¼šå°½å¯èƒ½å…·ä½“åœ°å†™å‡ºç­”æ¡ˆï¼ˆå‰è€…é£æ ¼ï¼‰ï¼Œä½†ä½¿ç”¨å¸¸é‡æ¥è®¡ç®—ç­”æ¡ˆï¼ˆåè€…é£æ ¼çš„ä¼˜åŠ¿ï¼‰ã€‚ä¾‹å¦‚ï¼š
- en: ''
  id: totrans-487
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE75]'
  id: totrans-488
  prefs:
  - PREF_BQ
  type: TYPE_PRE
  zh: '[PRE75]'
- en: Exercise
  id: totrans-489
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-490
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Before you proceed, have you written enough test cases? Are you sure? Have you,
    for instance, tested what should happen when the airplane is near the edge of
    the screen in either or both dimensions? We thought notâ€”<wbr>go back and write
    more tests before you proceed!
  id: totrans-491
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åœ¨ä½ ç»§ç»­ä¹‹å‰ï¼Œä½ æ˜¯å¦å·²ç»ç¼–å†™äº†è¶³å¤Ÿçš„æµ‹è¯•ç”¨ä¾‹ï¼Ÿä½ ç¡®å®šå—ï¼Ÿä¾‹å¦‚ï¼Œä½ æ˜¯å¦æµ‹è¯•äº†å½“é£æœºåœ¨å±å¹•è¾¹ç¼˜é™„è¿‘æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæˆ‘ä»¬è®¤ä¸ºä½ æ²¡æœ‰â€”â€”åœ¨ä½ ç»§ç»­ä¹‹å‰ï¼Œå›å»ç¼–å†™æ›´å¤šçš„æµ‹è¯•ï¼
- en: 'Using the design recipe, now define `move-airplane-xy-on-tick`. You should
    end up with something like this:'
  id: totrans-492
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨è®¾è®¡é…æ–¹ï¼Œç°åœ¨å®šä¹‰ `move-airplane-xy-on-tick`ã€‚ä½ åº”è¯¥å¾—åˆ°ç±»ä¼¼ä»¥ä¸‹çš„å†…å®¹ï¼š
- en: '[PRE76]'
  id: totrans-493
  prefs: []
  type: TYPE_PRE
  zh: '[PRE76]'
- en: 'Note that we have reused the existing function for the x-dimension and, correspondingly,
    created a helper for the y dimension:'
  id: totrans-494
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œæˆ‘ä»¬é‡ç”¨äº†ç°æœ‰çš„xç»´åº¦çš„å‡½æ•°ï¼Œå¹¶ç›¸åº”åœ°åˆ›å»ºäº†ä¸€ä¸ªyç»´åº¦çš„è¾…åŠ©å‡½æ•°ï¼š
- en: '[PRE77]'
  id: totrans-495
  prefs: []
  type: TYPE_PRE
  zh: '[PRE77]'
- en: This may be slight overkill for now, but it does lead to a cleaner separation
    of concerns, and makes it possible for the complexity of movement in each dimension
    to evolve independently while keeping the code relatively readable.
  id: totrans-496
  prefs: []
  type: TYPE_NORMAL
  zh: ç›®å‰è¿™å¯èƒ½æ˜¯æœ‰ç‚¹è¿‡åº¦ï¼Œä½†å®ƒç¡®å®å¯¼è‡´äº†å…³æ³¨ç‚¹çš„æ›´æ¸…æ™°åˆ†ç¦»ï¼Œå¹¶ä½¿å¾—æ¯ä¸ªç»´åº¦çš„è¿åŠ¨å¤æ‚æ€§å¯ä»¥ç‹¬ç«‹æ¼”å˜ï¼ŒåŒæ—¶ä¿æŒä»£ç ç›¸å¯¹å¯è¯»ã€‚
- en: 27.5.2Â Drawing the Scene[ğŸ”—](#(part._.Drawing_the_.Scene) "Link to here")
  id: totrans-497
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 27.5.2 ç»˜åˆ¶åœºæ™¯[ğŸ”—](#(part._.Drawing_the_.Scene) "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'We have to also examine and update `place-airplane-x`. Our earlier definition
    placed the airplane at an arbitrary y-coordinate; now we have to take the y-coordinate
    from the World State:'
  id: totrans-498
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è¿˜å¿…é¡»æ£€æŸ¥å’Œæ›´æ–° `place-airplane-x`ã€‚æˆ‘ä»¬ä¹‹å‰çš„å®šä¹‰å°†é£æœºæ”¾ç½®åœ¨ä»»æ„çš„yåæ ‡ä¸Šï¼›ç°åœ¨æˆ‘ä»¬å¿…é¡»ä»ä¸–ç•ŒçŠ¶æ€ä¸­è·å–yåæ ‡ï¼š
- en: '[PRE78]'
  id: totrans-499
  prefs: []
  type: TYPE_PRE
  zh: '[PRE78]'
- en: Notice that we canâ€™t really reuse the previous definition because it hard-coded
    the y-position, which we must now make a parameter.
  id: totrans-500
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ— æ³•é‡ç”¨ä¹‹å‰çš„å®šä¹‰ï¼Œå› ä¸ºå®ƒç¡¬ç¼–ç äº†yåæ ‡ï¼Œè€Œæˆ‘ä»¬ç°åœ¨å¿…é¡»å°†å…¶ä½œä¸ºä¸€ä¸ªå‚æ•°ã€‚
- en: 27.5.3Â Finishing Touches[ğŸ”—](#(part._.Finishing_.Touches) "Link to here")
  id: totrans-501
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 27.5.3 å®Œç¾æ”¶å°¾[ğŸ”—](#(part._.Finishing_.Touches) "é“¾æ¥åˆ°æ­¤å¤„")
- en: 'Are we done? It would seem so: weâ€™ve examined all the procedures that consume
    and produce World State and updated them appropriately. Actually, weâ€™re forgetting
    one small thing: the initial World State given to the reactor! If weâ€™ve changed
    the definition of World State, then we need to update this too. (We also need
    to use the new functions rather than the old ones.)'
  id: totrans-502
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å®Œæˆäº†å—ï¼Ÿçœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼šæˆ‘ä»¬å·²ç»æ£€æŸ¥äº†æ‰€æœ‰æ¶ˆè€—å’Œäº§ç”Ÿä¸–ç•ŒçŠ¶æ€çš„è¿‡ç¨‹ï¼Œå¹¶ç›¸åº”åœ°æ›´æ–°äº†å®ƒä»¬ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬å¿½ç•¥äº†ä¸€ä»¶äº‹ï¼šç»™ååº”å †æä¾›çš„åˆå§‹ä¸–ç•ŒçŠ¶æ€ï¼å¦‚æœæˆ‘ä»¬å·²ç»æ”¹å˜äº†ä¸–ç•ŒçŠ¶æ€çš„å®šä¹‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿéœ€è¦æ›´æ–°è¿™ä¸ªã€‚ï¼ˆæˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨æ–°å‡½æ•°è€Œä¸æ˜¯æ—§å‡½æ•°ã€‚ï¼‰
- en: '[PRE79]'
  id: totrans-503
  prefs: []
  type: TYPE_PRE
  zh: '[PRE79]'
- en: Exercise
  id: totrans-504
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-505
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Itâ€™s a little unsatisfactory to have the airplane truncated by the screen. You
    can use `I.image-width` and `I.image-height` to obtain the dimensions of an image,
    such as the airplane. Use these to ensure the airplane fits entirely within the
    screen for the initial scene, and similarly in `move-airplane-xy-on-tick`.
  id: totrans-506
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: é£æœºè¢«å±å¹•æˆªæ–­ï¼Œè¿™æœ‰ç‚¹ä»¤äººä¸æ»¡æ„ã€‚ä½ å¯ä»¥ä½¿ç”¨ `I.image-width` å’Œ `I.image-height` æ¥è·å–å›¾åƒçš„å°ºå¯¸ï¼Œä¾‹å¦‚é£æœºã€‚ä½¿ç”¨è¿™äº›å°ºå¯¸æ¥ç¡®ä¿é£æœºåœ¨åˆå§‹åœºæ™¯ä¸­å®Œå…¨ä½äºå±å¹•å†…ï¼ŒåŒæ ·åœ¨
    `move-airplane-xy-on-tick` ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚
- en: '27.6Â Version: Responding to Keystrokes[ğŸ”—](#(part._.Version__.Responding_to_.Keystrokes)
    "Link to here")'
  id: totrans-507
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.6 ç‰ˆæœ¬ï¼šå“åº”æŒ‰é”®[ğŸ”—](#(part._.Version__.Responding_to_.Keystrokes) "é“¾æ¥åˆ°æ­¤å¤„")
- en: Now that we have the airplane descending, thereâ€™s no reason it canâ€™t ascend
    as well. [Hereâ€™s a video.](https://drive.google.com/file/d/1IZw4NrmXsJ-KRaE1GNRhL2Cl3kU27whu/view?usp=share_link)
  id: totrans-508
  prefs: []
  type: TYPE_NORMAL
  zh: æ—¢ç„¶é£æœºæ­£åœ¨ä¸‹é™ï¼Œå°±æ²¡æœ‰ç†ç”±å®ƒä¸èƒ½ä¸Šå‡ã€‚[è¿™é‡Œæœ‰ä¸€ä¸ªè§†é¢‘ã€‚](https://drive.google.com/file/d/1IZw4NrmXsJ-KRaE1GNRhL2Cl3kU27whu/view?usp=share_link)
- en: 'Weâ€™ll use the keyboard to control its motion: specifically, the up-key will
    make it move up, while the down-key will make it descend even faster. This is
    easy to support using what we already know: we just need to provide one more handler
    using `on-key`. This handler takes two arguments: the first is the current value
    of the world, while the second is a representation of which key was pressed. For
    the purposes of this program, the only key values we care about are `"up"` and
    `"down"`.'
  id: totrans-509
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†ä½¿ç”¨é”®ç›˜æ¥æ§åˆ¶å…¶è¿åŠ¨ï¼šå…·ä½“æ¥è¯´ï¼Œä¸Šé”®ä¼šä½¿å®ƒå‘ä¸Šç§»åŠ¨ï¼Œè€Œä¸‹é”®ä¼šä½¿å®ƒä¸‹é™å¾—æ›´å¿«ã€‚è¿™å¾ˆå®¹æ˜“æ”¯æŒï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»çŸ¥é“å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ï¼šæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ `on-key`
    æä¾›ä¸€ä¸ªé¢å¤–çš„å¤„ç†ç¨‹åºã€‚è¿™ä¸ªå¤„ç†ç¨‹åºæ¥å—ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªæ˜¯å½“å‰ä¸–ç•Œçš„å€¼ï¼Œè€Œç¬¬äºŒä¸ªæ˜¯å“ªä¸ªé”®è¢«æŒ‰ä¸‹çš„è¡¨ç¤ºã€‚å¯¹äºè¿™ä¸ªç¨‹åºçš„ç›®çš„ï¼Œæˆ‘ä»¬å”¯ä¸€å…³å¿ƒçš„é”®å€¼æ˜¯ `"up"`
    å’Œ `"down"`ã€‚
- en: 'This gives us a fairly comprehensive view of the core capabilities of reactors:'
  id: totrans-510
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ºæˆ‘ä»¬æä¾›äº†å¯¹ååº”å †æ ¸å¿ƒåŠŸèƒ½çš„ç›¸å½“å…¨é¢çš„äº†è§£ï¼š
- en: '![](../Images/4925a999ce7daf16dda269c55117e5c5.png)'
  id: totrans-511
  prefs:
  - PREF_BQ
  type: TYPE_IMG
  zh: '![](../Images/4925a999ce7daf16dda269c55117e5c5.png)'
- en: We just define a group of functions to perform all our desired actions, and
    the reactor strings them together. Some functions update world values (sometimes
    taking additional information about a stimulus, such as the key pressed), while
    others transform them into output (such as what we see on the screen).
  id: totrans-512
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬åªæ˜¯å®šä¹‰äº†ä¸€ç»„å‡½æ•°æ¥æ‰§è¡Œæˆ‘ä»¬æ‰€æœ‰çš„æœŸæœ›æ“ä½œï¼Œååº”å †å°†å®ƒä»¬ä¸²è”èµ·æ¥ã€‚ä¸€äº›å‡½æ•°æ›´æ–°ä¸–ç•Œå€¼ï¼ˆæœ‰æ—¶éœ€è¦å…³äºåˆºæ¿€ç‰©çš„é¢å¤–ä¿¡æ¯ï¼Œä¾‹å¦‚æŒ‰ä¸‹çš„é”®ï¼‰ï¼Œè€Œå…¶ä»–å‡½æ•°å°†å®ƒä»¬è½¬æ¢æˆè¾“å‡ºï¼ˆä¾‹å¦‚æˆ‘ä»¬åœ¨å±å¹•ä¸Šçœ‹åˆ°çš„å†…å®¹ï¼‰ã€‚
- en: 'Returning to our program, letâ€™s define a constant representing how much distance
    a key represents:'
  id: totrans-513
  prefs: []
  type: TYPE_NORMAL
  zh: å›åˆ°æˆ‘ä»¬çš„ç¨‹åºï¼Œè®©æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªè¡¨ç¤ºæŒ‰é”®ä»£è¡¨å¤šå°‘è·ç¦»çš„å¸¸é‡ï¼š
- en: '[PRE80]'
  id: totrans-514
  prefs: []
  type: TYPE_PRE
  zh: '[PRE80]'
- en: 'Now we can define a function that alterâ€™s the airplaneâ€™s position by that distance
    depending on which key is pressed:'
  id: totrans-515
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œæ ¹æ®æŒ‰ä¸‹çš„é”®æ”¹å˜é£æœºçš„ä½ç½®ï¼š
- en: '[PRE81]'
  id: totrans-516
  prefs: []
  type: TYPE_PRE
  zh: '[PRE81]'
- en: Do Now!
  id: totrans-517
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç°åœ¨è¡ŒåŠ¨èµ·æ¥ï¼
- en: ''
  id: totrans-518
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Why does this function definition contain
  id: totrans-519
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸ºä»€ä¹ˆè¿™ä¸ªå‡½æ•°å®šä¹‰åŒ…å«
- en: ''
  id: totrans-520
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE82]'
  id: totrans-521
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_PRE
  zh: '[PRE82]'
- en: ''
  id: totrans-522
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
- en: as its last condition?
  id: totrans-523
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä½œä¸ºå…¶æœ€åä¸€ä¸ªæ¡ä»¶ï¼Ÿ
- en: Notice that if we receive any key other than the two we expect, we leave the
    World State as it was; from the userâ€™s perspective, this has the effect of just
    ignoring the keystroke. Remove this last clause, press some other key, and watch
    what happens!
  id: totrans-524
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œå¦‚æœæˆ‘ä»¬æ”¶åˆ°é™¤æˆ‘ä»¬æœŸæœ›ä¹‹å¤–çš„ä»»ä½•é”®ï¼Œæˆ‘ä»¬å°†ä¿æŒä¸–ç•ŒçŠ¶æ€ä¸å˜ï¼›ä»ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ç›¸å½“äºåªæ˜¯å¿½ç•¥äº†æŒ‰é”®ã€‚ç§»é™¤æœ€åä¸€ä¸ªå­å¥ï¼ŒæŒ‰ä¸‹ä¸€ä¸ªå…¶ä»–é”®ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼
- en: No matter what you choose, be sure to test this! Can the airplane drift off
    the top of the screen? How about off the screen at the bottom? Can it overlap
    with the land or water?
  id: totrans-525
  prefs: []
  type: TYPE_NORMAL
  zh: æ— è®ºä½ é€‰æ‹©ä»€ä¹ˆï¼Œä¸€å®šè¦æµ‹è¯•è¿™ä¸ªï¼é£æœºèƒ½å¦ä»å±å¹•é¡¶éƒ¨æ¼‚ç§»å‡ºå»ï¼Ÿåº•éƒ¨å‘¢ï¼Ÿå®ƒèƒ½ä¸é™†åœ°æˆ–æ°´é¢é‡å å—ï¼Ÿ
- en: 'Once weâ€™ve written and thoroughly tested this function, we simply need to ask
    Pyret to use it to handle keystrokes:'
  id: totrans-526
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦æˆ‘ä»¬ç¼–å†™å¹¶å½»åº•æµ‹è¯•äº†è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬åªéœ€è¦è®©Pyretä½¿ç”¨å®ƒæ¥å¤„ç†æŒ‰é”®ï¼š
- en: '[PRE83]'
  id: totrans-527
  prefs: []
  type: TYPE_PRE
  zh: '[PRE83]'
- en: Now your airplane moves not only with the passage of time but also in response
    to your keystrokes. You can keep it up in the air forever!
  id: totrans-528
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨é£æœºä¸ä»…éšç€æ—¶é—´æµé€è€Œç§»åŠ¨ï¼Œè€Œä¸”è¿˜ä¼šæ ¹æ®ä½ çš„æŒ‰é”®å“åº”ã€‚ä½ å¯ä»¥è®©å®ƒæ°¸è¿œä¿æŒåœ¨ç©ºä¸­ï¼
- en: '27.7Â Version: Landing[ğŸ”—](#(part._.Version__.Landing) "Link to here")'
  id: totrans-529
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.7 ç‰ˆæœ¬ï¼šç€é™†[ğŸ”—](#(part._.Version__.Landing) "é“¾æ¥åˆ°è¿™é‡Œ")
- en: Remember that the objective of our game is to land the airplane, not to keep
    it airborne indefinitely. That means we need to detect when the airplane reaches
    the land or water level and, when it does, [terminate the animation](https://drive.google.com/file/d/1XbO-FHQIveD0f3KCvVlUZPjVLNpHW9NT/view?usp=share_link).
  id: totrans-530
  prefs: []
  type: TYPE_NORMAL
  zh: è®°ä½ï¼Œæˆ‘ä»¬æ¸¸æˆçš„ç›®æ ‡æ˜¯è®©é£æœºé™è½ï¼Œè€Œä¸æ˜¯è®©å®ƒæ— é™æœŸåœ°ä¿æŒåœ¨ç©ºä¸­ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦æ£€æµ‹é£æœºä½•æ—¶è¾¾åˆ°é™†åœ°æˆ–æ°´é¢ï¼Œå½“å®ƒè¾¾åˆ°æ—¶ï¼Œ[ç»ˆæ­¢åŠ¨ç”»](https://drive.google.com/file/d/1XbO-FHQIveD0f3KCvVlUZPjVLNpHW9NT/view?usp=share_link)ã€‚
- en: 'First, letâ€™s try to characterize when the animation should halt. This means
    writing a function that consumes the current World State and produces a boolean
    value: `true` if the animation should halt, `false` otherwise. This requires a
    little arithmetic based on the airplaneâ€™s size:'
  id: totrans-531
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œè®©æˆ‘ä»¬å°è¯•æè¿°åŠ¨ç”»ä½•æ—¶åº”è¯¥åœæ­¢ã€‚è¿™æ„å‘³ç€ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¶ˆè€—å½“å‰ä¸–ç•ŒçŠ¶æ€å¹¶äº§ç”Ÿä¸€ä¸ªå¸ƒå°”å€¼ï¼šå¦‚æœåŠ¨ç”»åº”è¯¥åœæ­¢ï¼Œåˆ™ä¸º`true`ï¼Œå¦åˆ™ä¸º`false`ã€‚è¿™éœ€è¦åŸºäºé£æœºå¤§å°çš„å°‘é‡ç®—æœ¯è¿ç®—ï¼š
- en: '[PRE84]'
  id: totrans-532
  prefs: []
  type: TYPE_PRE
  zh: '[PRE84]'
- en: 'We just need to inform Pyret to use this predicate to automatically halt the
    reactor:'
  id: totrans-533
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬åªéœ€è¦é€šçŸ¥Pyretä½¿ç”¨è¿™ä¸ªè°“è¯æ¥è‡ªåŠ¨åœæ­¢ååº”å™¨ï¼š
- en: '[PRE85]'
  id: totrans-534
  prefs: []
  type: TYPE_PRE
  zh: '[PRE85]'
- en: Exercise
  id: totrans-535
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-536
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: When you test this, youâ€™ll see it isnâ€™t quite right because it doesnâ€™t take
    account of the size of the airplaneâ€™s image. As a result, the airplane only halts
    when itâ€™s half-way into the land or water, not when it first touches down. Adjust
    the formula so that it halts upon first contact.
  id: totrans-537
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å½“ä½ æµ‹è¯•è¿™ä¸ªæ—¶ï¼Œä½ ä¼šå‘ç°å®ƒå¹¶ä¸å®Œå…¨æ­£ç¡®ï¼Œå› ä¸ºå®ƒæ²¡æœ‰è€ƒè™‘åˆ°é£æœºå›¾åƒçš„å¤§å°ã€‚å› æ­¤ï¼Œé£æœºåªæœ‰åœ¨è¿›å…¥é™†åœ°æˆ–æ°´çš„ä¸€åŠæ—¶æ‰ä¼šåœæ­¢ï¼Œè€Œä¸æ˜¯ç¬¬ä¸€æ¬¡æ¥è§¦åœ°é¢æ—¶ã€‚è°ƒæ•´å…¬å¼ï¼Œä½¿å…¶åœ¨ç¬¬ä¸€æ¬¡æ¥è§¦æ—¶åœæ­¢ã€‚
- en: Exercise
  id: totrans-538
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-539
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Extend this so that the airplane rolls for a while upon touching land, decelerating
    according to the laws of physics.
  id: totrans-540
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å°†æ­¤æ‰©å±•åˆ°é£æœºåœ¨æ¥è§¦åœ°é¢åæ»šåŠ¨ä¸€æ®µæ—¶é—´ï¼Œæ ¹æ®ç‰©ç†å®šå¾‹å‡é€Ÿã€‚
- en: Exercise
  id: totrans-541
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-542
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Suppose the airplane is actually landing at a secret subterranean airbase. The
    actual landing strip is actually below ground level, and opens up only when the
    airplane comes in to land. That means, after landing, only the parts of the airplane
    that stick above ground level would be visible. Implement this. As a hint, consider
    modifying `place-airplane-xy`.
  id: totrans-543
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: å‡è®¾é£æœºå®é™…ä¸Šæ˜¯åœ¨ä¸€ä¸ªç§˜å¯†çš„åœ°ä¸‹æœºåœºé™è½ã€‚å®é™…çš„è·‘é“å®é™…ä¸Šåœ¨åœ°ä¸‹æ°´å¹³é¢ä»¥ä¸‹ï¼Œåªæœ‰å½“é£æœºè¿›å…¥é™è½æ—¶æ‰ä¼šæ‰“å¼€ã€‚è¿™æ„å‘³ç€ï¼Œé™è½ä¹‹åï¼Œåªæœ‰é£æœºéœ²å‡ºåœ°é¢çš„éƒ¨åˆ†æ‰ä¼šå¯è§ã€‚å®ç°è¿™ä¸€ç‚¹ã€‚ä½œä¸ºä¸€ä¸ªæç¤ºï¼Œè€ƒè™‘ä¿®æ”¹`place-airplane-xy`ã€‚
- en: '27.8Â Version: A Fixed Balloon[ğŸ”—](#(part._.Version__.A_.Fixed_.Balloon) "Link
    to here")'
  id: totrans-544
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.8 ç‰ˆæœ¬ï¼šå›ºå®šæ°”çƒ[ğŸ”—](#(part._.Version__.A_.Fixed_.Balloon) "é“¾æ¥åˆ°è¿™é‡Œ")
- en: Now letâ€™s add a balloon to the scene. [Hereâ€™s a video of the action.](https://drive.google.com/file/d/1QLt9tdt2sSPWR90-mmMLCDW4ZklgR_lN/view?usp=share_link)
  id: totrans-545
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨è®©æˆ‘ä»¬å‘åœºæ™¯ä¸­æ·»åŠ ä¸€ä¸ªæ°”çƒã€‚[è¿™é‡Œæ˜¯åŠ¨ä½œçš„è§†é¢‘ã€‚](https://drive.google.com/file/d/1QLt9tdt2sSPWR90-mmMLCDW4ZklgR_lN/view?usp=share_link)
- en: 'Notice that while the airplane moves, everything elseâ€”<wbr>including the balloonâ€”<wbr>stays
    immobile. Therefore, we do not need to alter the World State to record the balloonâ€™s
    position. All we need to do is alter the conditions under which the program halts:
    effectively, there is one more situation under which it terminates, and that is
    a collision with the balloon.'
  id: totrans-546
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œå½“é£æœºç§»åŠ¨æ—¶ï¼Œå…¶ä»–æ‰€æœ‰ä¸œè¥¿â€”â€”åŒ…æ‹¬æ°”çƒâ€”â€”éƒ½ä¿æŒé™æ­¢ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä¿®æ”¹ä¸–ç•ŒçŠ¶æ€æ¥è®°å½•æ°”çƒçš„ä½ç½®ã€‚æˆ‘ä»¬åªéœ€è¦æ”¹å˜ç¨‹åºåœæ­¢çš„æ¡ä»¶ï¼šå®é™…ä¸Šï¼Œåˆå¢åŠ äº†ä¸€ç§ç»ˆæ­¢æƒ…å†µï¼Œé‚£å°±æ˜¯ä¸æ°”çƒçš„ç¢°æ’ã€‚
- en: 'When does the game halt? There are now two circumstances: one is contact with
    land or water, and the other is contact with the balloon. The former remains unchanged
    from what it was before, so we can focus on the latter.'
  id: totrans-547
  prefs: []
  type: TYPE_NORMAL
  zh: æ¸¸æˆä½•æ—¶åœæ­¢ï¼Ÿç°åœ¨æœ‰ä¸¤ç§æƒ…å†µï¼šä¸€ç§æ˜¯æ¥è§¦åœ°é¢æˆ–æ°´ï¼Œå¦ä¸€ç§æ˜¯æ¥è§¦æ°”çƒã€‚å‰è€…ä¸ä¹‹å‰ç›¸æ¯”æ²¡æœ‰å˜åŒ–ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä¸“æ³¨äºåè€…ã€‚
- en: 'Where is the balloon, and how do we represent where it is? The latter is easy
    to answer: thatâ€™s what `posn`s are good for. As for the former, we can decide
    where it is:'
  id: totrans-548
  prefs: []
  type: TYPE_NORMAL
  zh: æ°”çƒåœ¨å“ªé‡Œï¼Œæˆ‘ä»¬å¦‚ä½•è¡¨ç¤ºå®ƒçš„ä½ç½®ï¼Ÿåè€…å®¹æ˜“å›ç­”ï¼šè¿™æ­£æ˜¯`posn`sçš„ä½œç”¨æ‰€åœ¨ã€‚è‡³äºå‰è€…ï¼Œæˆ‘ä»¬å¯ä»¥å†³å®šå®ƒçš„ä½ç½®ï¼š
- en: '[PRE86]'
  id: totrans-549
  prefs: []
  type: TYPE_PRE
  zh: '[PRE86]'
- en: 'or we can let Pyret pick a random position:'
  id: totrans-550
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ–è€…æˆ‘ä»¬å¯ä»¥è®©Pyretéšæœºé€‰æ‹©ä½ç½®ï¼š
- en: '[PRE87]'
  id: totrans-551
  prefs: []
  type: TYPE_PRE
  zh: '[PRE87]'
- en: Exercise
  id: totrans-552
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-553
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Improve the random placement of the balloon so that it is in credible spaces
    (e.g., not submerged).
  id: totrans-554
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ”¹å–„æ°”çƒçš„éšæœºæ”¾ç½®ï¼Œä½¿å…¶ä½äºå¯ä¿¡çš„ç©ºé—´ä¸­ï¼ˆä¾‹å¦‚ï¼Œä¸è¦è¢«æ·¹æ²¡ï¼‰ã€‚
- en: 'Given a position for the balloon, we just need to detect collision. One simple
    way is as follows: determine whether the distance between the airplane and the
    balloon is within some threshold:'
  id: totrans-555
  prefs: []
  type: TYPE_NORMAL
  zh: ç»™å®šæ°”çƒçš„ä½ç½®ï¼Œæˆ‘ä»¬åªéœ€è¦æ£€æµ‹ç¢°æ’ã€‚ä¸€ç§ç®€å•çš„æ–¹æ³•å¦‚ä¸‹ï¼šç¡®å®šé£æœºå’Œæ°”çƒä¹‹é—´çš„è·ç¦»æ˜¯å¦åœ¨æŸä¸ªé˜ˆå€¼ä¹‹å†…ï¼š
- en: '[PRE88]'
  id: totrans-556
  prefs: []
  type: TYPE_PRE
  zh: '[PRE88]'
- en: where `COLLISION-THRESHOLD` is some suitable constant computed based on the
    sizes of the airplane and balloon images. (For these particular images, `75` works
    pretty well.)
  id: totrans-557
  prefs: []
  type: TYPE_NORMAL
  zh: å…¶ä¸­ `COLLISION-THRESHOLD` æ˜¯åŸºäºé£æœºå’Œæ°”çƒå›¾åƒå¤§å°è®¡ç®—çš„ä¸€ä¸ªåˆé€‚çš„å¸¸æ•°ã€‚ï¼ˆå¯¹äºè¿™äº›ç‰¹å®šçš„å›¾åƒï¼Œ`75` å·¥ä½œå¾—ç›¸å½“å¥½ã€‚ï¼‰
- en: 'What is `distance`? It consumes two `posn`s and determines the Euclidean distance
    between them:'
  id: totrans-558
  prefs: []
  type: TYPE_NORMAL
  zh: ä»€ä¹ˆæ˜¯ `distance`ï¼Ÿå®ƒæ¶ˆè€—ä¸¤ä¸ª `posn` å¹¶ç¡®å®šå®ƒä»¬ä¹‹é—´çš„æ¬§å‡ é‡Œå¾—è·ç¦»ï¼š
- en: '[PRE89]'
  id: totrans-559
  prefs: []
  type: TYPE_PRE
  zh: '[PRE89]'
- en: 'Finally, we have to weave together the two termination conditions:'
  id: totrans-560
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œæˆ‘ä»¬å¿…é¡»å°†ä¸¤ä¸ªç»ˆæ­¢æ¡ä»¶ç¼–ç»‡åœ¨ä¸€èµ·ï¼š
- en: '[PRE90]'
  id: totrans-561
  prefs: []
  type: TYPE_PRE
  zh: '[PRE90]'
- en: 'and use it instead:'
  id: totrans-562
  prefs: []
  type: TYPE_NORMAL
  zh: å¹¶ä½¿ç”¨å®ƒä»£æ›¿ï¼š
- en: '[PRE91]'
  id: totrans-563
  prefs: []
  type: TYPE_PRE
  zh: '[PRE91]'
- en: Do Now!
  id: totrans-564
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç«‹å³è¡ŒåŠ¨ï¼
- en: ''
  id: totrans-565
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Were you surprised by anything? Did the game look as you expected?
  id: totrans-566
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä½ å¯¹ä»»ä½•äº‹æƒ…æ„Ÿåˆ°æƒŠè®¶å—ï¼Ÿæ¸¸æˆçœ‹èµ·æ¥æ˜¯ä½ é¢„æœŸçš„æ ·å­å—ï¼Ÿ
- en: Odds are you didnâ€™t see a balloon on the screen! Thatâ€™s because we didnâ€™t update
    our display.
  id: totrans-567
  prefs: []
  type: TYPE_NORMAL
  zh: æ¦‚ç‡ä¸Šï¼Œä½ å¯èƒ½æ²¡æœ‰åœ¨å±å¹•ä¸Šçœ‹åˆ°æ°”çƒï¼è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰æ›´æ–°æˆ‘ä»¬çš„æ˜¾ç¤ºã€‚
- en: 'You will need to define the balloonâ€™s image:'
  id: totrans-568
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ éœ€è¦å®šä¹‰æ°”çƒå›¾åƒï¼š
- en: '[PRE92]'
  id: totrans-569
  prefs: []
  type: TYPE_PRE
  zh: '[PRE92]'
- en: 'and also update the drawing function:'
  id: totrans-570
  prefs: []
  type: TYPE_NORMAL
  zh: å¹¶æ›´æ–°ç»˜å›¾å‡½æ•°ï¼š
- en: '[PRE93]'
  id: totrans-571
  prefs: []
  type: TYPE_PRE
  zh: '[PRE93]'
- en: Do Now!
  id: totrans-572
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç«‹å³è¡ŒåŠ¨ï¼
- en: ''
  id: totrans-573
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Do you see how to write `game-ends` more concisely?
  id: totrans-574
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä½ çœ‹åˆ°å¦‚ä½•æ›´ç®€æ´åœ°ç¼–å†™ `game-ends` å—ï¼Ÿ
- en: 'Hereâ€™s another version:'
  id: totrans-575
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯å¦ä¸€ä¸ªç‰ˆæœ¬ï¼š
- en: '[PRE94]'
  id: totrans-576
  prefs: []
  type: TYPE_PRE
  zh: '[PRE94]'
- en: '27.9Â Version: Keep Your Eye on the Tank[ğŸ”—](#(part._.Version__.Keep_.Your_.Eye_on_the_.Tank)
    "Link to here")'
  id: totrans-577
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.9 ç‰ˆæœ¬ï¼šå…³æ³¨æ²¹ç®±[ğŸ”—](#(part._.Version__.Keep_.Your_.Eye_on_the_.Tank) "é“¾æ¥åˆ°æ­¤å¤„")
- en: Now weâ€™ll introduce the idea of fuel. In our simplified world, fuel isnâ€™t necessary
    to descendâ€”<wbr>gravity does that automaticallyâ€”<wbr>but it is needed to climb.
    Weâ€™ll assume that fuel is counted in whole number units, and every ascension consumes
    one unit of fuel. When you run out of fuel, the program no longer responds to
    the up-arrow, so you can no longer avoid either the balloon or water.
  id: totrans-578
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å°†å¼•å…¥ç‡ƒæ–™çš„æ¦‚å¿µã€‚åœ¨æˆ‘ä»¬çš„ç®€åŒ–ä¸–ç•Œä¸­ï¼Œä¸‹é™ä¸éœ€è¦ç‡ƒæ–™â€”â€”é‡åŠ›ä¼šè‡ªåŠ¨å®Œæˆâ€”â€”ä½†ä¸Šå‡åˆ™éœ€è¦ã€‚æˆ‘ä»¬å°†å‡è®¾ç‡ƒæ–™ä»¥æ•´æ•°å•ä½è®¡ç®—ï¼Œæ¯æ¬¡ä¸Šå‡æ¶ˆè€—ä¸€ä¸ªç‡ƒæ–™å•ä½ã€‚å½“ä½ è€—å°½ç‡ƒæ–™æ—¶ï¼Œç¨‹åºä¸å†å¯¹ä¸Šç®­å¤´åšå‡ºå“åº”ï¼Œå› æ­¤ä½ å°†æ— æ³•é¿å¼€æ°”çƒæˆ–æ°´ã€‚
- en: In the past, weâ€™ve looked at still images of the game video to determine what
    is changing and what isnâ€™t. For this version, we could easily place a little gauge
    on the screen to show the quantity of fuel left. However, we donâ€™t on purpose,
    to illustrate a principle.
  id: totrans-579
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿‡å»ï¼Œæˆ‘ä»¬æŸ¥çœ‹æ¸¸æˆè§†é¢‘çš„é™æ€å›¾åƒæ¥ç¡®å®šå“ªäº›åœ¨å˜åŒ–ï¼Œå“ªäº›æ²¡æœ‰å˜åŒ–ã€‚å¯¹äºè¿™ä¸ªç‰ˆæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å±å¹•ä¸Šè½»æ¾æ”¾ç½®ä¸€ä¸ªå°ä»ªè¡¨æ¥æ˜¾ç¤ºå‰©ä½™çš„ç‡ƒæ–™é‡ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬æ•…æ„ä¸è¿™æ ·åšï¼Œä»¥è¯´æ˜ä¸€ä¸ªåŸç†ã€‚
- en: Note
  id: totrans-580
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„
- en: You canâ€™t always determine what is fixed and what is changing just by looking
    at the image. You have to also read the problem statement carefully, and think
    about it in depth.
  id: totrans-581
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä½ ä¸èƒ½ä»…ä»…é€šè¿‡è§‚å¯Ÿå›¾åƒå°±æ€»æ˜¯ç¡®å®šä»€ä¹ˆæ˜¯å›ºå®šçš„ï¼Œä»€ä¹ˆæ˜¯å˜åŒ–çš„ã€‚ä½ å¿…é¡»ä»”ç»†é˜…è¯»é—®é¢˜é™ˆè¿°ï¼Œå¹¶æ·±å…¥æ€è€ƒã€‚
- en: 'Itâ€™s clear from our description that there are two things changing: the position
    of the airplane and the quantity of fuel left. Therefore, the World State must
    capture the current values of both of these. The fuel is best represented as a
    single number. However, we do need to create a new structure to represent the
    combination of these two.'
  id: totrans-582
  prefs: []
  type: TYPE_NORMAL
  zh: ä»æˆ‘ä»¬çš„æè¿°ä¸­å¯ä»¥çœ‹å‡ºï¼Œæœ‰ä¸¤ä»¶äº‹æƒ…åœ¨å˜åŒ–ï¼šé£æœºçš„ä½ç½®å’Œå‰©ä½™çš„ç‡ƒæ–™é‡ã€‚å› æ­¤ï¼Œä¸–ç•ŒçŠ¶æ€å¿…é¡»æ•æ‰è¿™ä¸¤ä¸ªå½“å‰å€¼ã€‚ç‡ƒæ–™æœ€å¥½ç”¨ä¸€ä¸ªå•ä¸€çš„æ•°å­—æ¥è¡¨ç¤ºã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ç¡®å®éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ç»“æ„æ¥è¡¨ç¤ºè¿™ä¸¤ä¸ªçš„ç»„åˆã€‚
- en: World Definition
  id: totrans-583
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸–ç•Œå®šä¹‰
- en: The World State is a structure representing the airplaneâ€™s current position
    and the quantity of fuel left.
  id: totrans-584
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸–ç•ŒçŠ¶æ€æ˜¯ä¸€ä¸ªç»“æ„ï¼Œè¡¨ç¤ºé£æœºçš„å½“å‰ä½ç½®å’Œå‰©ä½™çš„ç‡ƒæ–™é‡ã€‚
- en: 'Concretely, we will use this structure:'
  id: totrans-585
  prefs: []
  type: TYPE_NORMAL
  zh: å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹ç»“æ„ï¼š
- en: '[PRE95]'
  id: totrans-586
  prefs: []
  type: TYPE_PRE
  zh: '[PRE95]'
- en: Exercise
  id: totrans-587
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-588
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'We could have also defined the World to be a structure consisting of three
    components: the airplaneâ€™s x-position, the airplaneâ€™s y-position, and the quantity
    of fuel. Why do we choose to use the representation above?'
  id: totrans-589
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ä¸–ç•Œå®šä¹‰ä¸ºåŒ…å«ä¸‰ä¸ªç»„ä»¶çš„ç»“æ„ï¼šé£æœºçš„ x ä½ç½®ã€é£æœºçš„ y ä½ç½®å’Œç‡ƒæ–™é‡ã€‚æˆ‘ä»¬ä¸ºä»€ä¹ˆé€‰æ‹©ä½¿ç”¨ä¸Šé¢çš„è¡¨ç¤ºæ³•ï¼Ÿ
- en: We can again look at each of the parts of the program to determine what can
    stay the same and what changes. Concretely, we must focus on the functions that
    consume and produce `World`s.
  id: totrans-590
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥å†æ¬¡æŸ¥çœ‹ç¨‹åºçš„å„ä¸ªéƒ¨åˆ†ï¼Œä»¥ç¡®å®šå“ªäº›å¯ä»¥ä¿æŒä¸å˜ï¼Œå“ªäº›éœ€è¦æ”¹å˜ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å¿…é¡»å…³æ³¨æ¶ˆè€—å’Œäº§ç”Ÿ `World` çš„å‡½æ•°ã€‚
- en: 'On each tick, we consume a world and compute one. The passage of time does
    not consume any fuel, so this code can remain unchanged, other than having to
    create a structure containing the current amount of fuel. Concretely:'
  id: totrans-591
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œæˆ‘ä»¬æ¶ˆè€—ä¸€ä¸ªä¸–ç•Œå¹¶è®¡ç®—ä¸€ä¸ªã€‚æ—¶é—´çš„æµé€ä¸æ¶ˆè€—ä»»ä½•ç‡ƒæ–™ï¼Œå› æ­¤è¿™æ®µä»£ç å¯ä»¥ä¿æŒä¸å˜ï¼Œé™¤äº†éœ€è¦åˆ›å»ºä¸€ä¸ªåŒ…å«å½“å‰ç‡ƒæ–™é‡çš„ç»“æ„ã€‚å…·ä½“æ¥è¯´ï¼š
- en: '[PRE96]'
  id: totrans-592
  prefs: []
  type: TYPE_PRE
  zh: '[PRE96]'
- en: 'Similarly, the function that responds to keystrokes clearly needs to take into
    account how much fuel is left:'
  id: totrans-593
  prefs: []
  type: TYPE_NORMAL
  zh: åŒæ ·ï¼Œå“åº”æŒ‰é”®çš„å‡½æ•°æ˜¾ç„¶éœ€è¦è€ƒè™‘å‰©ä½™çš„ç‡ƒæ²¹é‡ï¼š
- en: '[PRE97]'
  id: totrans-594
  prefs: []
  type: TYPE_PRE
  zh: '[PRE97]'
- en: Exercise
  id: totrans-595
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-596
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Updating the function that renders a scene. Recall that the world has two fields;
    one of them corresponds to what we used to draw before, and the other isnâ€™t being
    drawn in the output.
  id: totrans-597
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ›´æ–°æ¸²æŸ“åœºæ™¯çš„å‡½æ•°ã€‚å›æƒ³ä¸€ä¸‹ï¼Œä¸–ç•Œæœ‰ä¸¤ä¸ªå­—æ®µï¼›å…¶ä¸­ä¸€ä¸ªå¯¹åº”äºæˆ‘ä»¬ä¹‹å‰ç”¨æ¥ç»˜åˆ¶çš„å†…å®¹ï¼Œå¦ä¸€ä¸ªåœ¨è¾“å‡ºä¸­æ²¡æœ‰è¢«ç»˜åˆ¶ã€‚
- en: Do Now!
  id: totrans-598
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç°åœ¨å°±åšï¼
- en: ''
  id: totrans-599
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: What else do you need to change to get a working program?
  id: totrans-600
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä½ è¿˜éœ€è¦æ›´æ”¹ä»€ä¹ˆæ‰èƒ½å¾—åˆ°ä¸€ä¸ªå¯å·¥ä½œçš„ç¨‹åºï¼Ÿ
- en: You should have noticed that your initial world value is also incorrect because
    it doesnâ€™t account for fuel. What are interesting fuel values to try?
  id: totrans-601
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ åº”è¯¥å·²ç»æ³¨æ„åˆ°ä½ çš„åˆå§‹ä¸–ç•Œå€¼ä¹Ÿæ˜¯ä¸æ­£ç¡®çš„ï¼Œå› ä¸ºå®ƒæ²¡æœ‰è€ƒè™‘åˆ°ç‡ƒæ²¹ã€‚å°è¯•å“ªäº›æœ‰è¶£çš„ç‡ƒæ²¹å€¼ï¼Ÿ
- en: Exercise
  id: totrans-602
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-603
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Extend your program to draw a fuel gauge.
  id: totrans-604
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: æ‰©å±•ä½ çš„ç¨‹åºä»¥ç»˜åˆ¶ä¸€ä¸ªç‡ƒæ²¹è¡¨ã€‚
- en: '27.10Â Version: The Balloon Moves, Too[ğŸ”—](#(part._.Version__.The_.Balloon_.Moves__.Too)
    "Link to here")'
  id: totrans-605
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.10 ç‰ˆæœ¬ï¼šæ°”çƒä¹Ÿåœ¨ç§»åŠ¨[ğŸ”—](#(part._.Version__.The_.Balloon_.Moves__.Too) "é“¾æ¥åˆ°æ­¤å¤„")
- en: Until now weâ€™ve left our balloon immobile. Letâ€™s now make the game more interesting
    by letting the balloon move, as [this video shows.](https://drive.google.com/file/d/19kxqArza5y72V9xIezUtPi8PNV33KsG3/view?usp=share_link)
  id: totrans-606
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è®©æ°”çƒä¿æŒé™æ­¢ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡è®©æ°”çƒç§»åŠ¨æ¥ä½¿æ¸¸æˆæ›´æœ‰è¶£ï¼Œæ­£å¦‚[è¿™ä¸ªè§†é¢‘æ‰€ç¤ºã€‚](https://drive.google.com/file/d/19kxqArza5y72V9xIezUtPi8PNV33KsG3/view?usp=share_link)
- en: Obviously, the balloonâ€™s location needs to also become part of the World State.
  id: totrans-607
  prefs: []
  type: TYPE_NORMAL
  zh: æ˜¾ç„¶ï¼Œæ°”çƒçš„å®šä½ä¹Ÿéœ€è¦æˆä¸ºä¸–ç•ŒçŠ¶æ€çš„ä¸€éƒ¨åˆ†ã€‚
- en: World Definition
  id: totrans-608
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸–ç•Œå®šä¹‰
- en: The World State is a structure representing the planeâ€™s current position, the
    balloonâ€™s current position, and the quantity of fuel left.
  id: totrans-609
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸–ç•ŒçŠ¶æ€æ˜¯ä¸€ä¸ªè¡¨ç¤ºé£æœºå½“å‰ä½ç½®ã€æ°”çƒå½“å‰ä½ç½®ä»¥åŠå‰©ä½™ç‡ƒæ²¹é‡çš„ç»“æ„ã€‚
- en: Here is a representation of the world state. As these states become more complex,
    itâ€™s important to add annotations so we can keep track of whatâ€™s what.
  id: totrans-610
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œæ˜¯ä¸–ç•ŒçŠ¶æ€çš„ä¸€ä¸ªè¡¨ç¤ºã€‚éšç€è¿™äº›çŠ¶æ€å˜å¾—æ›´åŠ å¤æ‚ï¼Œæ·»åŠ æ³¨é‡Šå˜å¾—å¾ˆé‡è¦ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½è·Ÿè¸ªæ¯ä¸ªçŠ¶æ€ã€‚
- en: '[PRE98]'
  id: totrans-611
  prefs: []
  type: TYPE_PRE
  zh: '[PRE98]'
- en: 'With this definition, we obviously need to re-write all our previous definitions.
    Most of this is quite routine relative to what weâ€™ve seen before. The only detail
    we havenâ€™t really specified is how the balloon is supposed to move: in what direction,
    at what speed, and what to do at the edges. Weâ€™ll let you use your imagination
    for this one! (Remember that the closer the balloon is to land, the harder it
    is to safely land the plane.)'
  id: totrans-612
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹æ®è¿™ä¸ªå®šä¹‰ï¼Œæˆ‘ä»¬æ˜¾ç„¶éœ€è¦é‡å†™æˆ‘ä»¬ä¹‹å‰æ‰€æœ‰çš„å®šä¹‰ã€‚å¤§éƒ¨åˆ†å†…å®¹ä¸ä¹‹å‰çœ‹åˆ°çš„å†…å®¹ç›¸æ¯”ç›¸å½“å¸¸è§„ã€‚å”¯ä¸€æˆ‘ä»¬æ²¡æœ‰çœŸæ­£æŒ‡å®šçš„æ˜¯æ°”çƒåº”è¯¥å¦‚ä½•ç§»åŠ¨ï¼šæœå“ªä¸ªæ–¹å‘ï¼Œä»¥ä»€ä¹ˆé€Ÿåº¦ï¼Œä»¥åŠè¾¹ç¼˜æ—¶åº”è¯¥åšä»€ä¹ˆã€‚æˆ‘ä»¬å°†è®©ä½ å‘æŒ¥æƒ³è±¡åŠ›æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ï¼ˆè®°ä½ï¼Œæ°”çƒç¦»åœ°é¢è¶Šè¿‘ï¼Œå®‰å…¨é™è½é£æœºå°±è¶Šå›°éš¾ã€‚ï¼‰
- en: 'We thus have to modify:'
  id: totrans-613
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»ä¿®æ”¹ï¼š
- en: The background image (to remove the static balloon).
  id: totrans-614
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: èƒŒæ™¯å›¾åƒï¼ˆç§»é™¤é™æ€æ°”çƒï¼‰ã€‚
- en: The drawing handler (to draw the balloon at its position).
  id: totrans-615
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç»˜å›¾å¤„ç†ç¨‹åºï¼ˆåœ¨æ°”çƒçš„ä½ç½®ç»˜åˆ¶æ°”çƒï¼‰ã€‚
- en: The timer handler (to move the balloon as well as the airplane).
  id: totrans-616
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è®¡æ—¶å¤„ç†ç¨‹åºï¼ˆç§»åŠ¨æ°”çƒä»¥åŠé£æœºï¼‰ã€‚
- en: The key handler (to construct world data that leaves the balloon unchanged).
  id: totrans-617
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å…³é”®å¤„ç†ç¨‹åºï¼ˆç”¨äºæ„å»ºä¸æ”¹å˜æ°”çƒçš„å…¨çƒæ•°æ®ï¼‰ã€‚
- en: The termination condition (to account for the balloonâ€™s dynamic location).
  id: totrans-618
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç»ˆæ­¢æ¡ä»¶ï¼ˆè€ƒè™‘åˆ°æ°”çƒçš„åŠ¨æ€ä½ç½®ï¼‰ã€‚
- en: Exercise
  id: totrans-619
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-620
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Modify each of the above functions, along with their test cases.
  id: totrans-621
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¿®æ”¹ä¸Šè¿°æ¯ä¸ªå‡½æ•°åŠå…¶æµ‹è¯•ç”¨ä¾‹ã€‚
- en: '27.11Â Version: One, Two, ..., Ninety-Nine Luftballons![ğŸ”—](#(part._.Version__.One__.Two_______.Ninety-.Nine_.Luftballons_)
    "Link to here")'
  id: totrans-622
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 27.11 ç‰ˆæœ¬ï¼šä¸€ä¸ªï¼Œä¸¤ä¸ªï¼Œâ€¦â€¦ï¼Œä¹åä¹ä¸ªæ°”çƒ![ğŸ”—](#(part._.Version__.One__.Two_______.Ninety-.Nine_.Luftballons_)
    "é“¾æ¥åˆ°æ­¤å¤„")
- en: Finally, thereâ€™s no need to limit ourselves to only one balloon. How many is
    right? Two? Three? Ten? ... Why fix any one number? It could be a balloon festival!
  id: totrans-623
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åï¼Œæˆ‘ä»¬æ²¡æœ‰å¿…è¦å°†è‡ªå·±é™åˆ¶åœ¨åªæœ‰ä¸€ä¸ªæ°”çƒä¸Šã€‚å¤šå°‘ä¸ªæ˜¯åˆé€‚çš„ï¼Ÿä¸¤ä¸ªï¼Ÿä¸‰ä¸ªï¼Ÿåä¸ªï¼Ÿ...ä¸ºä»€ä¹ˆå›ºå®šä¸€ä¸ªæ•°å­—ï¼Ÿè¿™å¯ä»¥æ˜¯ä¸€ä¸ªæ°”çƒèŠ‚ï¼
- en: Similarly, many games have levels that become progressively harder; we could
    do the same, letting the number of balloons be part of what changes across levels.
    However, there is conceptually no big difference between having two balloons and
    five; the code to control each balloon is essentially the same.
  id: totrans-624
  prefs: []
  type: TYPE_NORMAL
  zh: ç±»ä¼¼åœ°ï¼Œè®¸å¤šæ¸¸æˆéƒ½æœ‰éš¾åº¦é€æ¸å¢åŠ çš„å…³å¡ï¼›æˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼Œè®©æ°”çƒçš„æ•°é‡æˆä¸ºå…³å¡ä¹‹é—´å˜åŒ–çš„ä¸€éƒ¨åˆ†ã€‚ç„¶è€Œï¼Œåœ¨æ¦‚å¿µä¸Šï¼Œæœ‰ä¸¤ä¸ªæ°”çƒå’Œäº”ä¸ªæ°”çƒä¹‹é—´æ²¡æœ‰å¤ªå¤§çš„åŒºåˆ«ï¼›æ§åˆ¶æ¯ä¸ªæ°”çƒçš„ä»£ç åŸºæœ¬ä¸Šæ˜¯ç›¸åŒçš„ã€‚
- en: 'We need to represent a collection of balloons. We can use a list to represent
    them. Thus:'
  id: totrans-625
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬éœ€è¦è¡¨ç¤ºä¸€ç»„æ°”çƒã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åˆ—è¡¨æ¥è¡¨ç¤ºå®ƒä»¬ã€‚å› æ­¤ï¼š
- en: World Definition
  id: totrans-626
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸–ç•Œå®šä¹‰
- en: The World State is a structure representing the planeâ€™s current position, a
    list of balloon positions, and the quantity of fuel left.
  id: totrans-627
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä¸–ç•ŒçŠ¶æ€æ˜¯ä¸€ä¸ªè¡¨ç¤ºé£æœºå½“å‰ä½ç½®ã€æ°”çƒä½ç½®åˆ—è¡¨ä»¥åŠå‰©ä½™ç‡ƒæ²¹é‡çš„ç»“æ„ã€‚
- en: You should now use the design recipe for lists of structures to rewrite the
    functions. Notice that youâ€™ve already written the function to move one balloon.
    Whatâ€™s left?
  id: totrans-628
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ ç°åœ¨åº”è¯¥ä½¿ç”¨ç»“æ„åˆ—è¡¨çš„è®¾è®¡é£Ÿè°±æ¥é‡å†™å‡½æ•°ã€‚æ³¨æ„ï¼Œä½ å·²ç»ç¼–å†™äº†ç§»åŠ¨ä¸€ä¸ªæ°”çƒçš„åŠŸèƒ½ã€‚å‰©ä¸‹ä»€ä¹ˆï¼Ÿ
- en: Apply the same function to each balloon in the list.
  id: totrans-629
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å°†ç›¸åŒçš„åŠŸèƒ½åº”ç”¨äºåˆ—è¡¨ä¸­çš„æ¯ä¸ªæ°”çƒã€‚
- en: Determine what to do if two balloons collide.
  id: totrans-630
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç¡®å®šå¦‚æœä¸¤ä¸ªæ°”çƒç›¸æ’æ—¶åº”è¯¥æ€ä¹ˆåšã€‚
- en: For now, you can avoid the latter problem by placing each balloon sufficiently
    spread apart along the x-dimension and letting them move only up and down.
  id: totrans-631
  prefs: []
  type: TYPE_NORMAL
  zh: ç›®å‰ï¼Œä½ å¯ä»¥é€šè¿‡åœ¨xè½´æ–¹å‘ä¸Šè¶³å¤Ÿåˆ†æ•£åœ°æ”¾ç½®æ¯ä¸ªæ°”çƒå¹¶è®©å®ƒä»¬åªä¸Šä¸‹ç§»åŠ¨æ¥é¿å…åä¸€ä¸ªé—®é¢˜ã€‚
- en: Exercise
  id: totrans-632
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ç»ƒä¹ 
- en: ''
  id: totrans-633
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Introduce a concept of wind, which affects balloons but not the airplane. After
    random periods of time, the wind blows with random speed and direction, causing
    the ballooons to move laterally.
  id: totrans-634
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: ä»‹ç»ä¸€ä¸ªé£çš„æ¦‚å¿µï¼Œå®ƒå½±å“æ°”çƒä½†ä¸å½±å“é£æœºã€‚åœ¨éšæœºçš„æ—¶æ®µåï¼Œé£ä»¥éšæœºçš„é€Ÿåº¦å’Œæ–¹å‘å¹æ‹‚ï¼Œå¯¼è‡´æ°”çƒæ¨ªå‘ç§»åŠ¨ã€‚
