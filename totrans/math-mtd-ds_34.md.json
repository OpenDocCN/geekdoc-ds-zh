["```py\ndef svd(rng, A, l, maxiter=100):\n    V = rng.normal(0,1,(np.size(A,1),l))\n    for _ in range(maxiter):\n        W = A @ V\n        Z = A.T @ W\n        V, R = mmids.gramschmidt(Z)\n    W = A @ V\n    S = [LA.norm(W[:, i]) for i in range(np.size(W,1))]\n    U = np.stack([W[:,i]/S[i] for i in range(np.size(W,1))],axis=-1)\n    return U, S, V \n```", "```py\nseed = 535\nrng = np.random.default_rng(seed)\nd, n, w = 1000, 100, 3.\nX = mmids.two_mixed_clusters(rng, d, n, w) \n```", "```py\nU, S, V = svd(rng, X, 2, maxiter=100)\nXproj = np.stack((U[:,0]*S[0], U[:,1]*S[1]), axis=-1)\nassign = mmids.kmeans(rng, Xproj, 2, maxiter=5) \n```", "```py\n3786.880620193068\n2066.200891030328\n2059.697450794238\n2059.697450794238\n2059.697450794238 \n```", "```py\nplt.figure(figsize=(6,3))\nplt.scatter(X[:,0], X[:,1], s=10, c=assign, cmap='brg')\nplt.axis([-6,6,-3,3])\nplt.show() \n```", "```py\nprint(np.stack((V[:,0], V[:,1]), axis=-1)) \n```", "```py\n[[-0.65359543 -0.03518408]\n [ 0.04389105 -0.01030089]\n [ 0.00334687 -0.01612429]\n ...\n [-0.01970281 -0.05868921]\n [-0.01982662 -0.04122036]\n [-0.00674388  0.01161806]] \n```", "```py\nM = np.array([[1.5, 1.3], [1.2, 1.9], [2.1, 0.8]])\nprint(M) \n```", "```py\n[[1.5 1.3]\n [1.2 1.9]\n [2.1 0.8]] \n```", "```py\nMp = LA.pinv(M)\nprint(Mp) \n```", "```py\n[[ 0.09305394 -0.31101404  0.58744568]\n [ 0.12627124  0.62930858 -0.44979865]] \n```", "```py\nMp @ M \n```", "```py\narray([[ 1.00000000e+00, -4.05255527e-17],\n       [ 3.70832374e-16,  1.00000000e+00]]) \n```", "```py\nA = np.array([[1., 0.], [-1., 0.]])\nprint(A) \n```", "```py\n[[ 1\\.  0.]\n [-1\\.  0.]] \n```", "```py\nAp = LA.pinv(A)\nprint(Ap) \n```", "```py\n[[ 0.5 -0.5]\n [ 0\\.   0\\. ]] \n```", "```py\nq = 1/np.sqrt(2)\nQ = np.array([[q, q], [q, -q]])\nprint(Q) \n```", "```py\n[[ 0.70710678  0.70710678]\n [ 0.70710678 -0.70710678]] \n```", "```py\nLA.cond(Q) \n```", "```py\n1.0000000000000002 \n```", "```py\neps = 1e-6\nA = np.array([[q, q], [q, q+eps]])\nprint(A) \n```", "```py\n[[0.70710678 0.70710678]\n [0.70710678 0.70710778]] \n```", "```py\nLA.cond(A) \n```", "```py\n2828429.1245844117 \n```", "```py\nu, s, vh = LA.svd(A)\nprint(s) \n```", "```py\n[1.41421406e+00 4.99999823e-07] \n```", "```py\nb = u[:,0]\nprint(b) \n```", "```py\n[-0.70710653 -0.70710703] \n```", "```py\nx = LA.solve(A,b)\nprint(x) \n```", "```py\n[-0.49999965 -0.5       ] \n```", "```py\ndelta = 1e-6\nbp = b + delta*u[:,1]\nprint(bp) \n```", "```py\n[-0.70710724 -0.70710632] \n```", "```py\nxp = LA.solve(A,bp)\nprint(xp) \n```", "```py\n[-1.91421421  0.91421356] \n```", "```py\n(LA.norm(x-xp)/LA.norm(x))/(LA.norm(b-bp)/LA.norm(b)) \n```", "```py\n2828429.124665918 \n```", "```py\nA = np.array([[1., 101.],[1., 102.],[1., 103.],[1., 104.],[1., 105]])\nprint(A) \n```", "```py\n[[  1\\. 101.]\n [  1\\. 102.]\n [  1\\. 103.]\n [  1\\. 104.]\n [  1\\. 105.]] \n```", "```py\nLA.cond(A) \n```", "```py\n7503.817028686101 \n```", "```py\nLA.cond(A.T @ A) \n```", "```py\n56307270.00472849 \n```", "```py\nn = 100 \nt = np.arange(n)/(n-1)\nb = np.exp(np.sin(4 * t)) \n```", "```py\nplt.plot(t, b)\nplt.show() \n```", "```py\nm = 17\nA = np.vander(t, m, increasing=True) \n```", "```py\nprint(LA.cond(A)) \n```", "```py\n755823354629.852 \n```", "```py\nprint(LA.cond(A.T @ A)) \n```", "```py\n3.846226459131048e+17 \n```", "```py\nxNE = LA.solve(A.T @ A, A.T @ b)\nprint(LA.norm(b - A@xNE)) \n```", "```py\n0.0002873101427587512 \n```", "```py\nplt.plot(t, b - A@xNE)\nplt.show() \n```", "```py\nQ, R = LA.qr(A)\nxQR = mmids.backsubs(R, Q.T @ b)\nprint(LA.norm(b - A@xQR)) \n```", "```py\n7.359657452370885e-06 \n```", "```py\nplt.plot(t, b - A@xNE)\nplt.plot(t, b - A@xQR)\nplt.show() \n```", "```py\ndef svd(rng, A, l, maxiter=100):\n    V = rng.normal(0,1,(np.size(A,1),l))\n    for _ in range(maxiter):\n        W = A @ V\n        Z = A.T @ W\n        V, R = mmids.gramschmidt(Z)\n    W = A @ V\n    S = [LA.norm(W[:, i]) for i in range(np.size(W,1))]\n    U = np.stack([W[:,i]/S[i] for i in range(np.size(W,1))],axis=-1)\n    return U, S, V \n```", "```py\nseed = 535\nrng = np.random.default_rng(seed)\nd, n, w = 1000, 100, 3.\nX = mmids.two_mixed_clusters(rng, d, n, w) \n```", "```py\nU, S, V = svd(rng, X, 2, maxiter=100)\nXproj = np.stack((U[:,0]*S[0], U[:,1]*S[1]), axis=-1)\nassign = mmids.kmeans(rng, Xproj, 2, maxiter=5) \n```", "```py\n3786.880620193068\n2066.200891030328\n2059.697450794238\n2059.697450794238\n2059.697450794238 \n```", "```py\nplt.figure(figsize=(6,3))\nplt.scatter(X[:,0], X[:,1], s=10, c=assign, cmap='brg')\nplt.axis([-6,6,-3,3])\nplt.show() \n```", "```py\nprint(np.stack((V[:,0], V[:,1]), axis=-1)) \n```", "```py\n[[-0.65359543 -0.03518408]\n [ 0.04389105 -0.01030089]\n [ 0.00334687 -0.01612429]\n ...\n [-0.01970281 -0.05868921]\n [-0.01982662 -0.04122036]\n [-0.00674388  0.01161806]] \n```", "```py\nM = np.array([[1.5, 1.3], [1.2, 1.9], [2.1, 0.8]])\nprint(M) \n```", "```py\n[[1.5 1.3]\n [1.2 1.9]\n [2.1 0.8]] \n```", "```py\nMp = LA.pinv(M)\nprint(Mp) \n```", "```py\n[[ 0.09305394 -0.31101404  0.58744568]\n [ 0.12627124  0.62930858 -0.44979865]] \n```", "```py\nMp @ M \n```", "```py\narray([[ 1.00000000e+00, -4.05255527e-17],\n       [ 3.70832374e-16,  1.00000000e+00]]) \n```", "```py\nA = np.array([[1., 0.], [-1., 0.]])\nprint(A) \n```", "```py\n[[ 1\\.  0.]\n [-1\\.  0.]] \n```", "```py\nAp = LA.pinv(A)\nprint(Ap) \n```", "```py\n[[ 0.5 -0.5]\n [ 0\\.   0\\. ]] \n```", "```py\nq = 1/np.sqrt(2)\nQ = np.array([[q, q], [q, -q]])\nprint(Q) \n```", "```py\n[[ 0.70710678  0.70710678]\n [ 0.70710678 -0.70710678]] \n```", "```py\nLA.cond(Q) \n```", "```py\n1.0000000000000002 \n```", "```py\neps = 1e-6\nA = np.array([[q, q], [q, q+eps]])\nprint(A) \n```", "```py\n[[0.70710678 0.70710678]\n [0.70710678 0.70710778]] \n```", "```py\nLA.cond(A) \n```", "```py\n2828429.1245844117 \n```", "```py\nu, s, vh = LA.svd(A)\nprint(s) \n```", "```py\n[1.41421406e+00 4.99999823e-07] \n```", "```py\nb = u[:,0]\nprint(b) \n```", "```py\n[-0.70710653 -0.70710703] \n```", "```py\nx = LA.solve(A,b)\nprint(x) \n```", "```py\n[-0.49999965 -0.5       ] \n```", "```py\ndelta = 1e-6\nbp = b + delta*u[:,1]\nprint(bp) \n```", "```py\n[-0.70710724 -0.70710632] \n```", "```py\nxp = LA.solve(A,bp)\nprint(xp) \n```", "```py\n[-1.91421421  0.91421356] \n```", "```py\n(LA.norm(x-xp)/LA.norm(x))/(LA.norm(b-bp)/LA.norm(b)) \n```", "```py\n2828429.124665918 \n```", "```py\nA = np.array([[1., 101.],[1., 102.],[1., 103.],[1., 104.],[1., 105]])\nprint(A) \n```", "```py\n[[  1\\. 101.]\n [  1\\. 102.]\n [  1\\. 103.]\n [  1\\. 104.]\n [  1\\. 105.]] \n```", "```py\nLA.cond(A) \n```", "```py\n7503.817028686101 \n```", "```py\nLA.cond(A.T @ A) \n```", "```py\n56307270.00472849 \n```", "```py\nn = 100 \nt = np.arange(n)/(n-1)\nb = np.exp(np.sin(4 * t)) \n```", "```py\nplt.plot(t, b)\nplt.show() \n```", "```py\nm = 17\nA = np.vander(t, m, increasing=True) \n```", "```py\nprint(LA.cond(A)) \n```", "```py\n755823354629.852 \n```", "```py\nprint(LA.cond(A.T @ A)) \n```", "```py\n3.846226459131048e+17 \n```", "```py\nxNE = LA.solve(A.T @ A, A.T @ b)\nprint(LA.norm(b - A@xNE)) \n```", "```py\n0.0002873101427587512 \n```", "```py\nplt.plot(t, b - A@xNE)\nplt.show() \n```", "```py\nQ, R = LA.qr(A)\nxQR = mmids.backsubs(R, Q.T @ b)\nprint(LA.norm(b - A@xQR)) \n```", "```py\n7.359657452370885e-06 \n```", "```py\nplt.plot(t, b - A@xNE)\nplt.plot(t, b - A@xQR)\nplt.show() \n```", "```py\ndef svd(rng, A, l, maxiter=100):\n    V = rng.normal(0,1,(np.size(A,1),l))\n    for _ in range(maxiter):\n        W = A @ V\n        Z = A.T @ W\n        V, R = mmids.gramschmidt(Z)\n    W = A @ V\n    S = [LA.norm(W[:, i]) for i in range(np.size(W,1))]\n    U = np.stack([W[:,i]/S[i] for i in range(np.size(W,1))],axis=-1)\n    return U, S, V \n```", "```py\nseed = 535\nrng = np.random.default_rng(seed)\nd, n, w = 1000, 100, 3.\nX = mmids.two_mixed_clusters(rng, d, n, w) \n```", "```py\nU, S, V = svd(rng, X, 2, maxiter=100)\nXproj = np.stack((U[:,0]*S[0], U[:,1]*S[1]), axis=-1)\nassign = mmids.kmeans(rng, Xproj, 2, maxiter=5) \n```", "```py\n3786.880620193068\n2066.200891030328\n2059.697450794238\n2059.697450794238\n2059.697450794238 \n```", "```py\nplt.figure(figsize=(6,3))\nplt.scatter(X[:,0], X[:,1], s=10, c=assign, cmap='brg')\nplt.axis([-6,6,-3,3])\nplt.show() \n```", "```py\nprint(np.stack((V[:,0], V[:,1]), axis=-1)) \n```", "```py\n[[-0.65359543 -0.03518408]\n [ 0.04389105 -0.01030089]\n [ 0.00334687 -0.01612429]\n ...\n [-0.01970281 -0.05868921]\n [-0.01982662 -0.04122036]\n [-0.00674388  0.01161806]] \n```", "```py\nM = np.array([[1.5, 1.3], [1.2, 1.9], [2.1, 0.8]])\nprint(M) \n```", "```py\n[[1.5 1.3]\n [1.2 1.9]\n [2.1 0.8]] \n```", "```py\nMp = LA.pinv(M)\nprint(Mp) \n```", "```py\n[[ 0.09305394 -0.31101404  0.58744568]\n [ 0.12627124  0.62930858 -0.44979865]] \n```", "```py\nMp @ M \n```", "```py\narray([[ 1.00000000e+00, -4.05255527e-17],\n       [ 3.70832374e-16,  1.00000000e+00]]) \n```", "```py\nA = np.array([[1., 0.], [-1., 0.]])\nprint(A) \n```", "```py\n[[ 1\\.  0.]\n [-1\\.  0.]] \n```", "```py\nAp = LA.pinv(A)\nprint(Ap) \n```", "```py\n[[ 0.5 -0.5]\n [ 0\\.   0\\. ]] \n```", "```py\nq = 1/np.sqrt(2)\nQ = np.array([[q, q], [q, -q]])\nprint(Q) \n```", "```py\n[[ 0.70710678  0.70710678]\n [ 0.70710678 -0.70710678]] \n```", "```py\nLA.cond(Q) \n```", "```py\n1.0000000000000002 \n```", "```py\neps = 1e-6\nA = np.array([[q, q], [q, q+eps]])\nprint(A) \n```", "```py\n[[0.70710678 0.70710678]\n [0.70710678 0.70710778]] \n```", "```py\nLA.cond(A) \n```", "```py\n2828429.1245844117 \n```", "```py\nu, s, vh = LA.svd(A)\nprint(s) \n```", "```py\n[1.41421406e+00 4.99999823e-07] \n```", "```py\nb = u[:,0]\nprint(b) \n```", "```py\n[-0.70710653 -0.70710703] \n```", "```py\nx = LA.solve(A,b)\nprint(x) \n```", "```py\n[-0.49999965 -0.5       ] \n```", "```py\ndelta = 1e-6\nbp = b + delta*u[:,1]\nprint(bp) \n```", "```py\n[-0.70710724 -0.70710632] \n```", "```py\nxp = LA.solve(A,bp)\nprint(xp) \n```", "```py\n[-1.91421421  0.91421356] \n```", "```py\n(LA.norm(x-xp)/LA.norm(x))/(LA.norm(b-bp)/LA.norm(b)) \n```", "```py\n2828429.124665918 \n```", "```py\nA = np.array([[1., 101.],[1., 102.],[1., 103.],[1., 104.],[1., 105]])\nprint(A) \n```", "```py\n[[  1\\. 101.]\n [  1\\. 102.]\n [  1\\. 103.]\n [  1\\. 104.]\n [  1\\. 105.]] \n```", "```py\nLA.cond(A) \n```", "```py\n7503.817028686101 \n```", "```py\nLA.cond(A.T @ A) \n```", "```py\n56307270.00472849 \n```", "```py\nn = 100 \nt = np.arange(n)/(n-1)\nb = np.exp(np.sin(4 * t)) \n```", "```py\nplt.plot(t, b)\nplt.show() \n```", "```py\nm = 17\nA = np.vander(t, m, increasing=True) \n```", "```py\nprint(LA.cond(A)) \n```", "```py\n755823354629.852 \n```", "```py\nprint(LA.cond(A.T @ A)) \n```", "```py\n3.846226459131048e+17 \n```", "```py\nxNE = LA.solve(A.T @ A, A.T @ b)\nprint(LA.norm(b - A@xNE)) \n```", "```py\n0.0002873101427587512 \n```", "```py\nplt.plot(t, b - A@xNE)\nplt.show() \n```", "```py\nQ, R = LA.qr(A)\nxQR = mmids.backsubs(R, Q.T @ b)\nprint(LA.norm(b - A@xQR)) \n```", "```py\n7.359657452370885e-06 \n```", "```py\nplt.plot(t, b - A@xNE)\nplt.plot(t, b - A@xQR)\nplt.show() \n```"]