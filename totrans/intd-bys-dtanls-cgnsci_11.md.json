["```r\ndata(\"df_spacebar\")\ndf_spacebar\n```", "```r\n## # A tibble: 361 × 2\n##       t trial\n##   <int> <int>\n## 1   141     1\n## 2   138     2\n## 3   128     3\n## # ℹ 358 more rows\n```", "```r\n ggplot(df_spacebar, aes(t)) +\n geom_density() +\n xlab(\"Finger tapping times\") +\n ggtitle(\"Button-press data\")\n```", "```r\nfit_press <-\n brm(t ~  1,\n data = df_spacebar,\n family = gaussian(),\n prior =\n c(prior(uniform(0, 60000), class = Intercept, lb = 0, ub = 60000),\n prior(uniform(0, 2000), class = sigma, lb = 0, ub = 2000)),\n chains = 4,\n iter = 2000,\n warmup = 1000)\n```", "```r\nas_draws_df(fit_press) %>%\n head(3)\n```", "```r\n## # A draws_df: 3 iterations, 1 chains, and 5 variables\n##   b_Intercept sigma Intercept lprior  lp__\n## 1         168    25       168    -19 -1683\n## 2         169    24       169    -19 -1683\n## 3         169    25       169    -19 -1683\n## # ... hidden reserved variables {'.chain', '.iteration', '.draw'}\n```", "```r\nfit_press\n# posterior_summary(fit_press) is also useful\n```", "```r\n##  Family: gaussian \n##   Links: mu = identity; sigma = identity \n## Formula: t ~ 1 \n##    Data: df_spacebar (Number of observations: 361) \n##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;\n##          total post-warmup draws = 4000\n## \n## Regression Coefficients:\n##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\n## Intercept   168.63      1.29   166.17   171.23 1.00     3482     2624\n## \n## Further Distributional Parameters:\n##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\n## sigma    25.02      0.96    23.26    26.98 1.00     2990     2588\n## \n## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\n## and Tail_ESS are effective sample size measures, and Rhat is the potential\n## scale reduction factor on split chains (at convergence, Rhat = 1).\n```", "```r\nas_draws_df(fit_press)$b_Intercept %>%  mean()\n```", "```r\n## [1] 169\n```", "```r\nas_draws_df(fit_press)$b_Intercept %>%  sd()\n```", "```r\n## [1] 1.29\n```", "```r\nas_draws_df(fit_press)$b_Intercept %>%\n quantile(c(0.025, .975))\n```", "```r\n##  2.5% 97.5% \n##   166   171\n```", "```r\nnormal_predictive_distribution <-\n function(mu_samples, sigma_samples, N_obs) {\n # empty data frame with headers:\n df_pred <-  tibble(trialn = numeric(0),\n t_pred = numeric(0),\n iter = numeric(0))\n # i iterates from 1 to the length of mu_samples,\n # which we assume is identical to\n # the length of the sigma_samples:\n for (i in seq_along(mu_samples)) {\n mu <-  mu_samples[i]\n sigma <-  sigma_samples[i]\n df_pred <-  bind_rows(df_pred,\n tibble(trialn = seq_len(N_obs), \n # seq_len generates 1, 2,..., N_obs\n t_pred = rnorm(N_obs, mu, sigma),\n iter = i))\n }\n df_pred\n }\n```", "```r\nN_samples <-  1000\nN_obs <-  nrow(df_spacebar)\nmu_samples <-  runif(N_samples, 0, 60000)\nsigma_samples <-  runif(N_samples, 0, 2000)\ntic()\nprior_pred <-\n normal_predictive_distribution(mu_samples = mu_samples,\n sigma_samples = sigma_samples,\n N_obs = N_obs)\ntoc()\n```", "```r\n## 1.39 sec elapsed\n```", "```r\nprior_pred\n```", "```r\n## # A tibble: 361,000 × 3\n##   trialn t_pred  iter\n##    <dbl>  <dbl> <dbl>\n## 1      1 16710\\.     1\n## 2      2 16686\\.     1\n## 3      3 17245\\.     1\n## # ℹ 360,997 more rows\n```", "```r\n## 0.321 sec elapsed\n```", "```r\nprior_pred %>%\n filter(iter <=  18) %>%\n ggplot(aes(t_pred)) +\n geom_histogram(aes(y = after_stat(density))) +\n xlab(\"predicted t (ms)\") +\n theme(axis.text.x = element_text(angle = 40,\n vjust = 1,\n hjust = 1)) +\n scale_y_continuous(limits = c(0, 0.0005),\n breaks = c(0, 0.00025, 0.0005),\n name = \"density\") +\n facet_wrap(~iter, ncol = 3)\n```", "```r\n# The default settings are used when they are not set explicitly:\n# 4 chains, with half of the iterations (set as 3000) as warmup.\nfit_press_unif <-  brm(t ~  1,\n data = df_spacebar,\n family = gaussian(),\n prior = c(prior(uniform(-10^6, 10^6),\n class = Intercept,\n lb = -10^6,\n ub = 10^6),\n prior(uniform(0, 10^6),\n class = sigma,\n lb = 0,\n ub = 10^6)),\n iter = 3000,\n control = list(adapt_delta = .99,\n max_treedepth = 15))\n```", "```r\nfit_press_unif\n```", "```r\n## ...\n## Population-Level Effects: \n##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\n## Intercept   168.68      1.28   166.18   171.22 1.00     4192     2840\n## \n## Family Specific Parameters: \n##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\n## sigma    25.02      0.94    23.24    27.02 1.01      602      469\n## \n## ...\n```", "```r\nfit_press_inf <-  brm(t ~  1,\n data = df_spacebar,\n family = gaussian(),\n prior = c(prior(normal(400, 10), class = Intercept),\n # `brms` knows that SDs need to be bounded\n # to exclude values below zero:\n prior(normal(100, 10), class = sigma)))\n```", "```r\nfit_press_inf\n```", "```r\n## ...\n## Population-Level Effects: \n##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\n## Intercept   172.95      1.42   170.20   175.77 1.00     2639     2367\n## \n## Family Specific Parameters: \n##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\n## sigma    26.11      1.06    24.19    28.26 1.00     2599     2561\n## \n## ...\n```", "```r\nfit_press_prin <-\n brm(t ~  1,\n data = df_spacebar,\n family = gaussian(),\n prior = c(prior(normal(200, 100), class = Intercept),\n prior(normal(50, 50), class = sigma)))\n```", "```r\nfit_press_prin\n```", "```r\n## ...\n## Population-Level Effects: \n##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\n## Intercept   168.68      1.30   166.17   171.26 1.00     3775     2676\n## \n## Family Specific Parameters: \n##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\n## sigma    25.01      0.95    23.21    27.07 1.00     4210     2622\n## \n## ...\n```", "```r\nN_obs <-  nrow(df_spacebar)\nmu_samples <-  as_draws_df(fit_press)$b_Intercept\nsigma_samples <-  as_draws_df(fit_press)$sigma\nnormal_predictive_distribution(mu_samples = mu_samples,\n sigma_samples = sigma_samples,\n N_obs = N_obs)\n```", "```r\n## # A tibble: 1,444,000 × 3\n##    iter trialn t_pred\n##   <dbl>  <int>  <dbl>\n## 1     1      1   128.\n## 2     1      2   134.\n## 3     1      3   167.\n## # ℹ 1,443,997 more rows\n```", "```r\npp_check(fit_press, ndraws = 11, type = \"hist\")\n```", "```r\npp_check(fit_press, ndraws = 100, type = \"dens_overlay\")\n```", "```r\nmu <-  6\nsigma <-  0.5\nN <-  500000\n# Generate N random samples from a log-normal distribution\nsl <-  rlnorm(N, mu, sigma)\nggplot(tibble(samples = sl), aes(samples)) +\n geom_histogram(aes(y = after_stat(density)), binwidth = 50) +\n ggtitle(\"Log-normal distribution\\n\") +\n coord_cartesian(xlim = c(0, 2000))\n# Generate N random samples from a normal distribution,\n# and then exponentiate them\nsn <-  exp(rnorm(N, mu, sigma))\nggplot(tibble(samples = sn), aes(samples)) +\n geom_histogram(aes(y = after_stat(density)), binwidth = 50) +\n ggtitle(\"Exponentiated samples from\\na normal distribution\") +\n coord_cartesian(xlim = c(0, 2000))\n```", "```r\nN_samples <-  1000\nN_obs <-  nrow(df_spacebar)\nmu_samples <-  runif(N_samples, 0, 11)\nsigma_samples <-  runif(N_samples, 0, 1)\nprior_pred_ln <-\n normal_predictive_distribution(mu_samples = mu_samples,\n sigma_samples = sigma_samples,\n N_obs = N_obs) %>%\n mutate(t_pred = exp(t_pred))\n```", "```r\nmean(rtnorm(100000, 0, 1, a = 0))\n```", "```r\n## [1] 0.798\n```", "```r\nc(lower = exp(6 -  2 *  1.5),\n higher = exp(6 +  2 *  1.5))\n```", "```r\n##  lower higher \n##   20.1 8103.1\n```", "```r\nfit_prior_press_ln <-\n brm(t ~  1,\n data = df_spacebar,\n family = lognormal(),\n prior = c(prior(normal(6, 1.5), class = Intercept),\n prior(normal(0, 1), class = sigma)),\n sample_prior = \"only\",\n control = list(adapt_delta = 0.9))\n```", "```r\n p1 <-  pp_check(fit_prior_press_ln,\n type = \"stat\",\n stat = \"mean\",\n prefix = \"ppd\") +\n coord_cartesian(xlim = c(0.001, 300000)) +\n scale_x_continuous(\"Finger tapping times (ms)\",\n trans = \"log\",\n breaks = c(0.001, 1, 100, 1000, 10000, 100000),\n labels = c(\"0.001\", \"1\", \"100\", \"1000\", \"10000\",\n \"100000\")) +\n ggtitle(\"Prior predictive distribution of means\")\np2 <-  pp_check(fit_prior_press_ln,\n type = \"stat\",\n stat = \"min\",\n prefix = \"ppd\") +\n coord_cartesian(xlim = c(0.001, 300000)) +\n scale_x_continuous(\"Finger tapping times (ms)\",\n trans = \"log\",\n breaks = c(0.001, 1, 100, 1000, 10000, 100000),\n labels = c(\"0.001\", \"1\", \"100\", \"1000\", \"10000\",\n \"100000\")) +\n ggtitle(\"Prior predictive distribution of minimum values\")\np3 <-  pp_check(fit_prior_press_ln,\n type = \"stat\",\n stat = \"max\",\n prefix = \"ppd\") +\n coord_cartesian(xlim = c(0.001, 300000)) +\n scale_x_continuous(\"Finger tapping times (ms)\",\n trans = \"log\",\n breaks = c(0.001, 1, 100, 1000, 10000, 100000),\n labels = c(\"0.001\", \"1\", \"10\", \"1000\", \"10000\",\n \"100000\")) +\n ggtitle(\"Prior predictive distribution of maximum values\")\nplot_grid(p1, p2, p3, nrow = 3, ncol =1)\n```", "```r\nfit_press_ln <-\n brm(t ~  1,\n data = df_spacebar,\n family = lognormal(),\n prior = c(prior(normal(6, 1.5), class = Intercept),\n prior(normal(0, 1), class = sigma)))\n```", "```r\nfit_press_ln\n```", "```r\n## ...\n## Population-Level Effects: \n##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\n## Intercept     5.12      0.01     5.10     5.13 1.00     4098     2796\n## \n## Family Specific Parameters: \n##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\n## sigma     0.13      0.01     0.13     0.15 1.00     2463     1999\n## \n## ...\n```", "```r\nestimate_ms <-  exp(as_draws_df(fit_press_ln)$b_Intercept)\n```", "```r\nc(mean = mean(estimate_ms),\n quantile(estimate_ms, probs = c(.025, .975)))\n```", "```r\n##  mean  2.5% 97.5% \n##   167   165   169\n```", "```r\npp_check(fit_press_ln, ndraws = 100)\n```", "```r\npp_check(fit_press, type = \"stat\", stat = \"min\")\n```", "```r\nfit_press <-\n brm(t ~  1,\n data = df_spacebar,\n family = gaussian(),\n prior = c(prior(uniform(0, 60000),\n class = Intercept,\n lb = 0,\n ub = 60000),\n prior(uniform(0, 2000),\n class = sigma,\n lb = 0,\n ub = 2000)),\n ## uncomment for prior predictive:\n ## sample_prior = \"only\",\n ## uncomment when dealing with divergent transitions\n ## control = list(adapt_delta = .9)\n ## default values for chains, iterations and warmup:\n chains = 4,\n iter = 2000,\n warmup = 1000)\n```", "```r\nas_draws_df(fit_press)\n```", "```r\nplot(fit_press)\n```", "```r\n## Posterior predictive check:\npp_check(fit_press, ndraws = 100, type = \"dens_overlay\")\n## Plot posterior predictive distribution of statistical summaries:\npp_check(fit_press, ndraws = 100, type = \"stat\", stat = \"mean\")\n## Plot prior predictive distribution of statistical summaries:\npp_check(fit_press, ndraws = 100, type = \"stat\", stat = \"mean\",\n prefix = \"ppd\")\n```"]