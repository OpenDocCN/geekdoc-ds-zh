<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>12.3Â Arrays and Lists in MemoryğŸ”—</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>12.3Â Arrays and Lists in MemoryğŸ”—</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://dcic-world.org/2025-08-27/unified-lists-memory.html">https://dcic-world.org/2025-08-27/unified-lists-memory.html</a></blockquote><table cellspacing="0" cellpadding="0"><tr><td/></tr></table><p>In <a href="unified-equality.html" data-pltdoc="x">Understanding Equality</a>, we drew memory diagrams to show how
values appear in the heap. At that time, we looked only at structured
data. Now we will look at aggregate data: lists in Python and arrays
in Pyret.</p><p>Both Python lists and Pyret arrays are stored in memory with a
starting value that indicates how many values there are, followed by
the actual elements in subsequent addresses. For instance, suppose we
write the following value:
</p><table cellspacing="0" cellpadding="0" class="TwoColumnAsRows"><tr><td><p>Python</p></td><td></td></tr><tr><td></td><td><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">sl = ['bread', 'coffee', 'eggs']</code></pre></td></tr><tr><td><p>Pyret</p></td><td></td></tr><tr><td></td><td><pre data-lang="pyret" class="sourceCode"><code data-lang="pyret" class="sourceCode">sl = [array: 'bread', 'coffee', 'eggs']</code></pre></td></tr></table><p>Hereâ€™s what memory might look like:
</p><p>Directory</p><ul><li><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">sl</code></pre><p>Â â†’Â 1001</p></li></ul><p>Heap</p><ul><li><p>1001:Â <code data-lang="text/x-python" class="sourceCode">(length:3)</code></p></li><li><p>1002:Â <code data-lang="text/x-python" class="sourceCode">"bread"</code></p></li><li><p>1003:Â <code data-lang="text/x-python" class="sourceCode">"coffee"</code></p></li><li><p>1004:Â <code data-lang="text/x-python" class="sourceCode">"eggs"</code></p></li></ul><p>If these terms mean anything to you: Pythonâ€™s default list
implementation is array-based, not a linked list.
So at 1001 thereâ€™s an indication of how many entries follow,
and the next memory locations have those values. There are no
directory entries for the individual elements, but they can be reached
by referring to <code data-lang="pyret" class="sourceCode">sl</code> followed by an offset: for instance,
</p><table cellspacing="0" cellpadding="0" class="TwoColumn"><tr><td><p>Python</p></td><td><p>Pyret</p></td></tr><tr><td><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">sl[2]</code></pre></td><td><pre data-lang="pyret" class="sourceCode"><code data-lang="pyret" class="sourceCode">sl.get-now(2)</code></pre></td></tr></table><p>Internally, this turns into: â€œobtain the address of <code data-lang="pyret" class="sourceCode">sl</code>, then
add 1 and the offset <code data-lang="pyret" class="sourceCode">2</code> to itâ€. This produces the address
1001 + 1 + 2 = 1004. Looking up the value stored
at address 1004, in both languages, produces
<code data-lang="text/x-python" class="sourceCode">'eggs'</code>.You may find it odd that the offsets begin
at 0. While it is indeed confusingâ€”<wbr/>the â€œfirstâ€ value is at offset
<code data-lang="pyret" class="sourceCode">0</code>, the â€œthirdâ€ value at offset <code data-lang="pyret" class="sourceCode">2</code>, and so onâ€”<wbr/>this is
a convention both Python and Pyret chose to be consistent with most
other programming languages.</p><p>Similarly, suppose we try to change the shopping listâ€™s content to
replace the second value with <code data-lang="pyret" class="sourceCode">'tea'</code>. Recall that the second
value is at offset <code data-lang="pyret" class="sourceCode">1</code>:
</p><table cellspacing="0" cellpadding="0" class="TwoColumn"><tr><td><p>Python</p></td><td><p>Pyret</p></td></tr><tr><td><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">sl[1] = 'tea'</code></pre></td><td><pre data-lang="pyret" class="sourceCode"><code data-lang="pyret" class="sourceCode">sl.set-now(1, 'tea')</code></pre></td></tr></table><p>Again, we obtain the address of <code data-lang="pyret" class="sourceCode">sl</code>, which is 1001; add
1 and the offset (<code data-lang="pyret" class="sourceCode">1</code>) to it; this gives us the address
1003. Now, we modify the value at 1003 to be the new
value:
</p><p>Directory</p><ul><li><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">sl</code></pre><p>Â â†’Â 1001</p></li></ul><p>Heap</p><ul><li><p>1001:Â <code data-lang="text/x-python" class="sourceCode">(length:3)</code></p></li><li><p>1002:Â <code data-lang="text/x-python" class="sourceCode">"bread"</code></p></li><li><p>1003:Â <code data-lang="text/x-python" class="sourceCode">"tea"</code></p></li><li><p>1004:Â <code data-lang="text/x-python" class="sourceCode">"eggs"</code></p></li></ul><p>If we now ask the language for the list as a whole, we see the change:
in Python,</p><table cellspacing="0" cellpadding="0" class="PyretReplInteraction"><tr><td><table cellspacing="0" cellpadding="0" class="PyretReplInteraction"><tr><td><blockquote class="PyretRepl"><p class="PyretReplPrompt"/><pre data-lang="pyret" class="sourceCode"><code data-lang="pyret" class="sourceCode">sl</code></pre></blockquote></td></tr></table></td></tr><tr><td><pre data-lang="pyret" class="sourceCode"><code data-lang="pyret" class="sourceCode">['bread', 'tea', 'eggs']</code></pre></td></tr></table><p>and in Pyret,</p><table cellspacing="0" cellpadding="0" class="PyretReplInteraction"><tr><td><table cellspacing="0" cellpadding="0" class="PyretReplInteraction"><tr><td><blockquote class="PyretRepl"><p class="PyretReplPrompt"/><pre data-lang="pyret" class="sourceCode"><code data-lang="pyret" class="sourceCode">sl</code></pre></blockquote></td></tr></table></td></tr><tr><td><pre data-lang="pyret" class="sourceCode"><code data-lang="pyret" class="sourceCode">[array: "bread", "tea", "eggs"]</code></pre></td></tr></table><p>Observe that what we have learned about aliasing applies here,
too. Suppose Shaunae and Jonella share a shopping list, where
<code data-lang="pyret" class="sourceCode">sl</code> is Shaunaeâ€™s and Jonella writes:
</p><table cellspacing="0" cellpadding="0" class="TwoColumn"><tr><td><p>Python</p></td><td><p>Pyret</p></td></tr><tr><td><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">jl = sl</code></pre></td><td><pre data-lang="pyret" class="sourceCode"><code data-lang="pyret" class="sourceCode">jl = sl</code></pre></td></tr></table><p>Now <code data-lang="pyret" class="sourceCode">jl</code> and <code data-lang="pyret" class="sourceCode">sl</code> are aliases for the same data in the heap:
</p><p>Directory</p><ul><li><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">sl</code></pre><p>Â â†’Â 1001</p></li><li><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">jl</code></pre><p>Â â†’Â 1001</p></li></ul><p>Heap</p><ul><li><p>1001:Â <code data-lang="text/x-python" class="sourceCode">(length:3)</code></p></li><li><p>1002:Â <code data-lang="text/x-python" class="sourceCode">"bread"</code></p></li><li><p>1003:Â <code data-lang="text/x-python" class="sourceCode">"tea"</code></p></li><li><p>1004:Â <code data-lang="text/x-python" class="sourceCode">"eggs"</code></p></li></ul><p>Thus, modifying the list <code data-lang="pyret" class="sourceCode">jl</code> has the same impact as modifying it
via <code data-lang="pyret" class="sourceCode">sl</code>:
</p><table cellspacing="0" cellpadding="0" class="TwoColumn"><tr><td><p>Python</p></td><td><p>Pyret</p></td></tr><tr><td><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">jl[0] = 'butter'</code></pre></td><td><pre data-lang="pyret" class="sourceCode"><code data-lang="pyret" class="sourceCode">jl.set-now(0, 'butter')</code></pre></td></tr></table><p>means the memory looks like
</p><p>Directory</p><ul><li><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">sl</code></pre><p>Â â†’Â 1001</p></li><li><pre data-lang="text/x-python" class="sourceCode"><code data-lang="text/x-python" class="sourceCode">jl</code></pre><p>Â â†’Â 1001</p></li></ul><p>Heap</p><ul><li><p>1001:Â <code data-lang="text/x-python" class="sourceCode">(length:3)</code></p></li><li><p>1002:Â <code data-lang="text/x-python" class="sourceCode">"butter"</code></p></li><li><p>1003:Â <code data-lang="text/x-python" class="sourceCode">"tea"</code></p></li><li><p>1004:Â <code data-lang="text/x-python" class="sourceCode">"eggs"</code></p></li></ul><p>Thus, if we ask for the value of <code data-lang="pyret" class="sourceCode">sl</code>, we will see in Python:</p><table cellspacing="0" cellpadding="0" class="PyretReplInteraction"><tr><td><table cellspacing="0" cellpadding="0" class="PyretReplInteraction"><tr><td><blockquote class="PyretRepl"><p class="PyretReplPrompt"/><pre data-lang="pyret" class="sourceCode"><code data-lang="pyret" class="sourceCode">sl</code></pre></blockquote></td></tr></table></td></tr><tr><td><pre data-lang="pyret" class="sourceCode"><code data-lang="pyret" class="sourceCode">['butter', 'tea', 'eggs']</code></pre></td></tr></table><p>and in Pyret:</p><table cellspacing="0" cellpadding="0" class="PyretReplInteraction"><tr><td><table cellspacing="0" cellpadding="0" class="PyretReplInteraction"><tr><td><blockquote class="PyretRepl"><p class="PyretReplPrompt"/><pre data-lang="pyret" class="sourceCode"><code data-lang="pyret" class="sourceCode">sl</code></pre></blockquote></td></tr></table></td></tr><tr><td><pre data-lang="pyret" class="sourceCode"><code data-lang="pyret" class="sourceCode">[array: "butter", "tea", "eggs"]</code></pre></td></tr></table><p>even though we did not make a modification through the name <code data-lang="pyret" class="sourceCode">sl</code>.</p>    
</body>
</html>