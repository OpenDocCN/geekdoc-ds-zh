- en: Particle-In-Cell Transfer
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec29.2-pic_transfer.html](https://phys-sim-book.github.io/lec29.2-pic_transfer.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: At the beginning of each simulation step, the grid must be cleared before accumulating
    new particle-to-grid transfers.
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 30.2.1 (Reset Grid, simulator.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: We adopt the Saint Venant–Kirchhoff (StVK) constitutive model formulated in
    the logarithmic (Hencky) strain space using the SVD of the deformation gradient.
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 30.2.2 (Stvk Hencky Elasticity, simulator.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: During the particle-to-grid (P2G) transfer, we use quadratic B-spline interpolation
    to distribute each particle’s mass, momentum, and internal force to its neighboring
    grid nodes. This process follows the PIC (Particle-In-Cell) formulation, where
    particle velocities are directly transferred to the grid without storing affine
    velocity fields.
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 30.2.3 (PIC Particle-to-Grid (P2G) Transfers, simulator.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Right after Particle-to-Grid (P2G) Transfer, we normalize grid momentum to obtain
    nodal velocities and enforces Dirichlet boundary conditions near the domain edges
    by zeroing out velocities.
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 30.2.4 (Grid Update, simulator.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: During the grid-to-particle (G2P) transfer, we gather the updated velocity from
    the background grid and compute the elastic deformation gradient update using
    the velocity gradient derived from the interpolation function.
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 30.2.5 (PIC Grid-to-Particle (G2P) Transfers, simulator.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: Finally, particle positions are updated through advection using symplectic Euler
    time integration.
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 30.2.6 (Particle State Update, simulator.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'A full MPM simulation step consists of the following stages:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation 30.2.7 (A full time step of MPM, simulator.py).**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/1bcb904b717ed3313178f48f22cea71e.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Figure 30.2.1.** **Time sequence of two colliding elastic blocks in 2D**.
    The red and blue blocks approach each other with opposite velocities, undergo
    large elastic deformation upon impact, and rebound with shape recovery. The simulation
    demonstrates symmetric momentum exchange and elastic energy storage under the
    MPM framework.'
  prefs: []
  type: TYPE_NORMAL
