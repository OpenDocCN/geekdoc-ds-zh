<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>4 Statistical Inference - Case Study Satisfaction with Government</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>4 Statistical Inference - Case Study Satisfaction with Government</h1>
<blockquote>原文：<a href="https://bookdown.org/conradziller/introstatistics/statistical-inference---case-study-satisfaction-with-government.html">https://bookdown.org/conradziller/introstatistics/statistical-inference---case-study-satisfaction-with-government.html</a></blockquote><div id="statistical-inference---case-study-satisfaction-with-government" class="section level1" number="4">

<div id="introduction-2" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-2"/>
</h2>
<p>In Western democracies, citizens’ satisfaction with the government is critically related to the electoral success of governing parties in an upcoming election. At the same time, satisfied citizens are more willing to support non-preferred policies and are less likely to support anti-system or populist parties.</p>
<p>If we are interested in the degree of satisfaction with the government in Germany, for example, we first need to define the population we aim to make statements about (e.g., people over 18 years old who live in Germany). Conducting interviews with each person that belongs to the population would be pointless. Instead, we can rely on the “shortcut” of random sampling, in which we randomly select observational units from this population (i.e., randomly selected Germans) and survey them. The idea is that the results (e.g., mean approval of the government using a survey item) from the random sample are representative of the underlying population - that is, a close match between the parameter estimated from the sample (e.g., mean approval) and the (unobserved) parameter of the population.</p>
<div class="float" id="id">
<img src="../Images/9d094f2d7b0391808b604a030ca9f903.png" class="class" style="width:30.0%;height:30.0%" alt="Federal Chancellery (Bundeskanzleramt)" data-original-src="https://bookdown.org/conradziller/introstatistics/picture/bkamt.jpg"/><div class="figcaption">Federal Chancellery (Bundeskanzleramt)</div>
</div>
<p>Source: <a href="https://www.bundesregierung.de/breg-de/bundesregierung/bundeskanzleramt/dienstsitze-bundeskanzleramt-466834" target="„_blank“">https://www.bundesregierung.de/breg-de/bundesregierung/bundeskanzleramt/dienstsitze-bundeskanzleramt-466834</a></p>
<p>In statistical inference, we are primarily interested in how accurately an estimate from a sample reflects the true population parameter. Thus, the goal is to find a suitable measure of precision (or uncertainty, as the other “side of the coin”). We do this by matching the estimate from the sample with a test distribution that reflects likely or unlikely values in terms of probabilities. How this is done will be discussed in this case study.</p>
<p>Before that, we take a short excursion into the realm of probability theory.</p>
<p><br/></p>
</div>
<div id="probability" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Probability<a class="anchor" aria-label="anchor" href="#probability"/>
</h2>
<p>Probabilities correspond to the ratio of the number of observations that meet a certain criterion (i.e., an “event”) to the total number of observations. A classic example is the coin toss and the ratio between heads and the total number of tosses. Probabilities are always positive (<span class="math inline">\(P(A)\ge0\)</span>). The probability of all possible events (e.g., heads and tails in the case of a coin toss) is 1 (<span class="math inline">\(P(\Omega)=1\)</span>). If events A and B cannot occur simultaneously, then the probability of A or B occurring is the summed probability for both events (<span class="math inline">\(P(A or B)=P(A)+P(B)\)</span>).</p>
<p>The probabilities of events that occur in a chance experiment (e.g., a coin toss) can be represented as so-called random variables. Random variables have a probability distribution, for binary variables (0/1) this is the Bernoulli distribution, for continuous variables this is the normal distribution. (There are other distributions like the F-distribution or chi-square distribution, which we will use later for further purposes).</p>
<p>Here we see a probability distribution for 10 balls (7 blue, 3 red) randomly drawn with replacement, in total 10,000 draws were made. Accordingly, the probability distribution is approximately 0.7 for blue and 0.3 for red:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">possible_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">Bernoulli</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">possible_values</span>,</span>
<span>               size<span class="op">=</span><span class="fl">10000</span>,</span>
<span>               replace<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>               prob<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">Bernoulli</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Bernoulli
##      0      1 
## 0.7034 0.2966</code></pre>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">Bernoulli</span>,plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">h</span><span class="op">$</span><span class="va">density</span> <span class="op">=</span> <span class="va">h</span><span class="op">$</span><span class="va">counts</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">h</span><span class="op">$</span><span class="va">counts</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">h</span>,freq<span class="op">=</span><span class="cn">FALSE</span>, axes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Blue"</span>, <span class="st">"Red"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">2</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">60</span>, <span class="fl">70</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="../Images/503726bbe43a1bb8173b7e34e6f07530.png" width="672" data-original-src="https://bookdown.org/conradziller/introstatistics/03-inference_files/figure-html/unnamed-chunk-2-1.png"/></div>
<p>The Bernoulli distribution is characterized by the probability of occurrence of an event <span class="math inline">\(p\)</span>. The probability for the counter-event automatically follows from this: <span class="math inline">\(1-p\)</span>. <strong>We will need this distribution for the calculation of test statistics of proportions.</strong></p>
<p><br/></p>
<p>The normal distribution for random variables is a bell-shaped probability density function. It gives the probabilities for a <strong>continuous random variable</strong> with infinite intermediate values. Think of time as a continuous concept. Theoretically, we can measure time in infinitely small units (milliseconds, nanoseconds, etc.). However, in applied research, we would assign discrete values to the variable time. Hence, continuous variables are rather a theoretical concept. Regarding the distribution of a continuous random variable: The normal distribution is characterized by a mean <span class="math inline">\(\mu\)</span> and a standard deviation <span class="math inline">\(\sigma\)</span>. The notation for the normal distribution of a random variable is <span class="math inline">\(X \sim N(\mu,\sigma)\)</span>. Each combination of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> gives a differently shaped normal distribution. The mean indicates where the center of the distribution is on the x-axis and <span class="math inline">\(\sigma\)</span> indicates how flat or steep the distribution is (the higher, the more spread out and thus the flatter the curve becomes).</p>
<p>The so-called <em>standard normal distribution</em> has a mean of 0 and a standard deviation of 1 (<span class="math inline">\(X \sim N(0,1)\)</span>). As with all other normal distributions, (1) the ends of the curve spread out to the left and right, approaching the x-axis without ever touching it. Thus, the values can range from - to + infinity. (2) The area under the curve is equal to 1 in total. (3) The so-called “Empirical Rule” states that for a standard normal distribution, 68% of the observations lie between -1 and +1 standard deviations. 95% of the observations lie between approx. -2 and +2 standard deviations (to be exact -1.96 and +1.96), and 99.7% of the observations lie between approximately -3 and +3 standard deviations.</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Draw a standard normal distribution:</span></span>
<span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, length.out<span class="op">=</span><span class="fl">1001</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span> x<span class="op">=</span><span class="va">z</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">'n'</span>, type<span class="op">=</span><span class="st">'l'</span>, main<span class="op">=</span><span class="st">"Standard normal distribution"</span>, ylab<span class="op">=</span><span class="st">"Probability density"</span>, xlab<span class="op">=</span><span class="st">"z"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span/>
<span><span class="co"># annotate the density function with the 5% probability mass tails</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">z</span><span class="op">&lt;=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">z</span><span class="op">&lt;=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html">grey</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">z</span><span class="op">&gt;=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">z</span><span class="op">&gt;=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html">grey</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="../Images/7e4896d3aa2bb86af5da0464107f5bff.png" width="672" data-original-src="https://bookdown.org/conradziller/introstatistics/03-inference_files/figure-html/unnamed-chunk-3-1.png"/></div>
<p><br/></p>
<p>With probability distributions such as the standard normal distribution, we do not calculate the probability of a specific value but rather a range of values. For example, the probability that a value is greater than 1.96 standard deviations, i.e., <span class="math inline">\(P(Z\ge1.96)\)</span>, is 2.5%. And the probability that a value is less than -1.96 standard deviations, i.e., <span class="math inline">\(P(Z\le-1.96)\)</span>, is 2.5% (see the grey areas in the plot above, both areas sum up to 5%).</p>
<p><strong>We will use the standard normal distribution (also referred to as Z-distribution) for various statistical tests. The rule that 95% of observable values are located between -1.96 and 1.96, and 5% at the outer margins will also become important in Null Hypothesis Testing.</strong></p>
<p><br/></p>
</div>
<div id="basics-of-statistical-inference" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Basics of statistical inference<a class="anchor" aria-label="anchor" href="#basics-of-statistical-inference"/>
</h2>
<p>Inference means that we use facts we know to learn about facts we don’t know (yet). Statistical inference means that we take information from a (random) sample and infer from it (not yet known) properties of the population (from which the sample was drawn). Basically, only random samples are suitable for this purpose, since they represent the underlying population in all properties in the best possible way (plus minus some random variation).</p>
<p>While random samples are the best way to conduct statistical inference, the process is not flawless. There is still a chance that the units in our sample do not perfectly match all properties of the population due to random deviations. It may be that a sample was drawn in which disproportionately many women accidentally “slipped in”. These random deviations are called <strong>sampling variability</strong>. The following sections should illustrate that sampling variability decreases with the number of observations in a sample (“more data is better”) and that if we did the process of random sampling over and over again (with a sufficiently large number of observations), we would obtain a distribution of sampled estimates that are shaped like a normal distribution. This will be tremendously useful when we conduct statistical tests, in which we use the normal distribution as if it was the sampling distribution of a quantity of interest we can match and test our estimate with.</p>
<p><br/></p>
<div id="law-of-large-numbers" class="section level3" number="4.3.1">
<h3>
<span class="header-section-number">4.3.1</span> Law of Large Numbers<a class="anchor" aria-label="anchor" href="#law-of-large-numbers"/>
</h3>
<p>In general, a small number of cases leads to higher sampling variability. You may be familiar with this from the coin toss experiment. A coin is often tossed in succession. After 10 tosses, it is quite possible that heads were tossed 7 times and tails only 3 times. Nevertheless, the underlying probability is always 0.5/0.5 (or 50%/50%) and in the population of all coin tosses, heads and tails should occur equally often. If we now toss the coin even more often, after 30, 300, 3000, etc. the observed coin tosses will increasingly match the 0.5/0.5 probability distribution.</p>
<p>The law of large numbers states that as the sample size increases, the mean of the sample will increasingly approxiamte that of the population. (Eventually, the sample would be identical to the entire population.) This means that more data is better, and the larger our sample, the more confident we can be that it matches or at least approximates the population parameter.</p>
<div class="float" id="id">
<img src="../Images/e067d3d1c6e50c1aaeedc4b319f705e7.png" class="class" style="width:70.0%" fig.align="center" alt="Law of large numbers: Coin toss" data-original-src="https://bookdown.org/conradziller/introstatistics/picture/zahlen.png"/><div class="figcaption">Law of large numbers: Coin toss</div>
</div>
<p>Source: <a href="https://link.springer.com/chapter/10.1007/978-3-030-45553-8_5" target="„_blank“">https://link.springer.com/chapter/10.1007/978-3-030-45553-8_5</a></p>
<p><br/></p>
</div>
<div id="central-limit-theorem" class="section level3" number="4.3.2">
<h3>
<span class="header-section-number">4.3.2</span> Central Limit Theorem<a class="anchor" aria-label="anchor" href="#central-limit-theorem"/>
</h3>
<p>If we draw many (or even infinite) samples from a population and are interested in, for example, the mean of satisfaction with government, then plotting the means of each sample as a histogram will lead to a distribution that (with added samples increasingly) follows a normal distribution. The mean of the sample means thereby corresponds to the population parameter we are essentially interested in (i.e., satisfaction with the government of all over-18-year-olds living in Germany).</p>
<p>The implications of the central limit theorem are illustrated in the following figure. The mean of the means from 100,000 simulated samples is 4.2 and corresponds to the “true” population mean of government satisfaction. Note that in reality, we do not have this information and we are not able to draw these many samples as that would be too costly.</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100000</span>, <span class="fl">4.2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">data</span>, freq <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="st">"gray"</span>, xlab <span class="op">=</span> <span class="st">"Data Values"</span>, main <span class="op">=</span> <span class="st">"Means of government satisfaction"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="../Images/78fad6f32fbeef73ffde823b7f7cf4d0.png" width="70%" height="70%" style="display: block; margin: auto;" data-original-src="https://bookdown.org/conradziller/introstatistics/03-inference_files/figure-html/unnamed-chunk-4-1.png"/></div>
<p>Another property of the central limit theorem is that the larger the number of cases (<span class="math inline">\(n\)</span>) of each of the individual samples, the better the distribution of sample estimates corresponds to a normal distribution. This works very well with <span class="math inline">\(n&gt;30\)</span>. Moreover, it is not important how the distribution of the characteristic to be examined is in the population (e.g., right- or left-skewed). In any case, with increasing samples (and <span class="math inline">\(n&gt;30\)</span>), the distribution of sample estimates will (with added samples increasingly) correspond to a normal distribution.</p>
<p><br/></p>
</div>
<div id="why-statistical-laws-are-important" class="section level3" number="4.3.3">
<h3>
<span class="header-section-number">4.3.3</span> Why statistical laws are important<a class="anchor" aria-label="anchor" href="#why-statistical-laws-are-important"/>
</h3>
<div id="only-one-sample" class="section level4" number="4.3.3.1">
<h4>
<span class="header-section-number">4.3.3.1</span> Only one sample<a class="anchor" aria-label="anchor" href="#only-one-sample"/>
</h4>
<ul>
<li><p>We calculate everything on the basis of <strong>one sample</strong>, everything else would be too costly.</p></li>
<li>
<p>We can never be completely sure that the ONE specific sample and the statistics estimated using it correspond to those of the population, but:</p>
<ul>
<li><p>The <strong>larger the sample</strong>, the steeper the distribution of sample estimates and the more certain we are to get an estimated parameter <strong>near the population parameter</strong>, even with only one sample (Law of Large Numbers).</p></li>
<li><p>For a <strong>sample of 30 or more observations</strong>, we know that the distribution of sample estimates is normal no matter how the distribution of the population looks like; this gives us the rationale that most samples mingle around the population mean and that there is quite a high probability that the estimate from our one sample <strong>is near the center of the distribution (i.e., close to the population parameter)</strong>; getting an estimate that is far away from the center of the distribution is rather unlikely (Central Limit Theorem).</p></li>
</ul>
</li>
</ul>
</div>
<div id="a-primer-on-null-hypothesis-testing" class="section level4" number="4.3.3.2">
<h4>
<span class="header-section-number">4.3.3.2</span> A Primer on Null Hypothesis Testing<a class="anchor" aria-label="anchor" href="#a-primer-on-null-hypothesis-testing"/>
</h4>
<ul>
<li><p>The Central Limit Theorem also gives us a rationale for <strong>quantifying uncertainty</strong>, because if repeated sample estimates can be represented as a <strong>normal distribution</strong>, then we can use the normal distribution as a frame of reference for how credible the results from our one sample are.</p></li>
<li><p>To do so, we make specific assumptions about the distribution we test our sample estimate against (e.g., a distribution that assumes no difference in means between two groups).</p></li>
<li><p>This procedure is called Null Hypothesis Testing (or, NHT):</p></li>
</ul>
<ol style="list-style-type: decimal">
<li><p>We develop a research hypothesis or a so-called <strong>alternative hypothesis (e.g., women are more satisfied with the government than men)</strong>.</p></li>
<li><p>We use a random sample and estimate the difference in means of government satisfaction between men and women.</p></li>
<li><p>We test our result against a (theoretical) distribution under which we assume the <strong>null hypothesis (-&gt; there is NO difference in government satisfaction between men and women)</strong> to be true (i.e., the test distribution).</p></li>
<li><p>If the estimate from our sample is located near the center of the distribution that assumes the null hypothesis, this would be not much evidence for the alternative hypothesis; however: If the estimate is at the margins of that distribution, we would conclude that there is evidence that favor the alternative hypothesis, which states that <strong>in the population, women are more satisfied with the government than men</strong>.</p></li>
</ol>
<ul>
<li>The prerequisite for this testing procedure is that we standardize our sample estimate to make it comparable to the test distribution (For example, this can be achieved by: <span class="math inline">\(z = \frac{estimate}{{standard error}}\)</span>).</li>
</ul>
</div>
<div id="standard-error" class="section level4" number="4.3.3.3">
<h4>
<span class="header-section-number">4.3.3.3</span> Standard error<a class="anchor" aria-label="anchor" href="#standard-error"/>
</h4>
<ul>
<li><p>To determine the variation around a population parameter, we could use the standard deviation of the sampling distribution.</p></li>
<li><p>However, since in the applied case we do not have many samples, but only one, we need to estimate this variation from the one sample.</p></li>
<li><p>This estimated variation of an estimate is called the standard error, and the formula for calculating it differs depending on the estimator (usually we normalize a <strong>measure of variance or standard deviation</strong> using a measure that involves the <strong>number of observations</strong>; for example, the standard error of mean the formula is given as: <span class="math inline">\(\bar x = \frac{s}{\sqrt{n}}\)</span>).</p></li>
</ul>
<p><br/></p>
</div>
</div>
</div>
<div id="confidence-intervals" class="section level2" number="4.4">
<h2>
<span class="header-section-number">4.4</span> Confidence intervals<a class="anchor" aria-label="anchor" href="#confidence-intervals"/>
</h2>
<div id="basic-idea" class="section level3" number="4.4.1">
<h3>
<span class="header-section-number">4.4.1</span> Basic idea<a class="anchor" aria-label="anchor" href="#basic-idea"/>
</h3>
<p>In theory, the confidence intervals (CIs) for a point estimate (e.g., a mean or a correlation coefficient) shows a range of values that contain the true population parameter with a certain probability. It is thus a measure of uncertainty (or, conversely, precision) of an estimate. There are conventionally three types of confidence intervals: 90%, 95%, and 99% confidence intervals. These three types reflect the level of probability that the true population value lies within the interval for a very large number of samples. For example, if one is interested in the population mean and conducts repeated (“infinite”) sampling, 95% of the confidence intervals of the respective samples would contain the true population mean, and 5% would not contain it.</p>
<p>This can be illustrated with the following figures.</p>
<div class="float" id="id">
<img src="../Images/f3474453e6d0423693806d67d7090428.png" class="class" style="width:80.0%;height:80.0%" alt="Confidence interval of sample means" data-original-src="https://bookdown.org/conradziller/introstatistics/picture/ci_mean.PNG"/><div class="figcaption">Confidence interval of sample means</div>
</div>
<p>Source: <a href="https://seeing-theory.brown.edu/frequentist-inference/index.html" target="„_blank“">https://seeing-theory.brown.edu/frequentist-inference/index.html</a></p>
<p>In the figure, samples were repeatedly drawn from a population with five observations each (orange dots). Each time, the mean is calculated (or estimated because we are using a sample). These point estimates of the mean from each sample are represented by the green or red dots, the confidence interval is the corresponding line to the left and right of it. For the green estimates, the population mean (dashed line) is within the confidence interval, for the red it is not.</p>
<p><br/></p>
<div class="float" id="id">
<img src="../Images/e8646d9f0396c286662592c32225e9da.png" class="class" style="width:80.0%;height:80.0%" alt="Confidence intervals of sample correlations" data-original-src="https://bookdown.org/conradziller/introstatistics/picture/ci_corr.PNG"/><div class="figcaption">Confidence intervals of sample correlations</div>
</div>
<p>Source: <a href="https://github.com/simonheb/metrics1-public" target="„_blank“">https://github.com/simonheb/metrics1-public</a></p>
<p>Here, instead of the mean value, results of a bivariate regression (similar to a correlation) are shown. The bivariate relationship between x and y in the population is represented by the black slope line (regression coefficient <span class="math inline">\(\beta_1=1.2\)</span>). The gray dots are the units in the population. From this population, four random samples are drawn and the observations in the sample are represented by the red dots. The point estimate of the correlation is represented by the red slope line. The confidence interval is the light red area around the estimate. In samples 1, 2, and 4, the confidence interval includes the population parameter; only in sample 3 (bottom left) is this no longer the case for parts of the confidence interval. Analogously to the thought experiment regarding means above, 95% of estimates from repeated samples would include the population mean, and 5% would not.</p>
<p><br/></p>
</div>
<div id="how-to-calculate-and-interpret-the-confidence-interval" class="section level3" number="4.4.2">
<h3>
<span class="header-section-number">4.4.2</span> How to calculate and interpret the confidence interval<a class="anchor" aria-label="anchor" href="#how-to-calculate-and-interpret-the-confidence-interval"/>
</h3>
<p>The idea of confidence intervals refers to the sampling distribution, i.e. many (up to infinitely many) repeated random samples from the population. For a 95% confidence interval, the interpretation would be: for repeated samples, 95% of the samples will contain the population parameter, 5% will not.</p>
<p>In practice, we only have one sample and can therefore only calculate confidence intervals once. Whether the population parameter actually falls within the value range of the confidence interval of our one sample or not cannot be answered conclusively. What can be said is that the likelihood of this is high. For example, with the 95% confidence interval, 95 out of 100 samples would have to contain the population parameter and it is likely that our one sample is one of the 95 and not one of the 5. (At the same time, some interpretations made in textbooks such as “with 95% probability the population parameter is in the interval” are strictly speaking not true).</p>
<p>We can therefore interpret the confidence intervals primarily as <strong>the likely or plausible range of values of the unknown population parameter we are interested in (given the characteristics of our sample).</strong> The confidence interval thus gives us, at the same time as the point estimate, a range of variability to be expected if we were to repeat studies similar to ours more often. This is indeed important information, and for many researchers, it is also more intuitive than significance values from null hypothesis tests.</p>
<p>In addition, there is a relationship between confidence intervals and statistical significance, a concept related to null hypothesis tests. We will look at this relationship at the end of this case study. In short, confidence intervals show a possible range of values of the population parameter <em>and</em> at the same time provide information about statistical significance.</p>
<p>To compute a confidence interval, we generally use the following formula:</p>
<p><span class="math inline">\(point estimate \pm z_\alpha \times standard error\)</span>.</p>
<p><span class="math inline">\(z_\alpha\)</span> refers to the critical Z-value (i.e., a given value of the z-distribution that corresponds a set probability of error, this will be explained in greater detail below).</p>
<p><br/></p>
<div id="mean-1" class="section level4" number="4.4.2.1">
<h4>
<span class="header-section-number">4.4.2.1</span> Mean<a class="anchor" aria-label="anchor" href="#mean-1"/>
</h4>
<p>For the lower and upper 95% confidence intervals of a mean, we use: <span class="math inline">\(95\% CIs=[\bar x - 1.96 \times {\frac{s}{\sqrt n}}, \bar x + 1.96 \times {\frac{s}{\sqrt n}}]\)</span>.</p>
<p>Let us look into this with real data from the European Social Survey (German sample). First, we read the data and get an overview of the distribution of the variable satisfaction with government <code>stfgov</code>. <code>stfgov</code> was surveyed using an 11-point scale ranging from 0 “extremely dissatisfied” to 10 “extremely satisfied.”</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_ess</span> <span class="op">&lt;-</span> <span class="fu">read_dta</span><span class="op">(</span><span class="st">"data/ESS9_DE.dta"</span>, encoding <span class="op">=</span> <span class="st">"latin1"</span><span class="op">)</span> </span>
<span/>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">data_ess</span><span class="op">$</span><span class="va">stfgov</span>, breaks <span class="op">=</span> <span class="st">"FD"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="../Images/8f622a96d1c89b332e19274bde795f99.png" width="80%" height="80%" style="display: block; margin: auto;" data-original-src="https://bookdown.org/conradziller/introstatistics/03-inference_files/figure-html/unnamed-chunk-5-1.png"/></div>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">data_ess</span><span class="op">$</span><span class="va">stfgov</span><span class="op">)</span></span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##    0.00    3.00    4.00    4.28    6.00   10.00      66</code></pre>
<p>Next, we calculate the 95% confidence interval in several steps:</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We store the mean, the standard deviation and the number of observations as objects, because this way we can refer to them later on</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2292</span></span>
<span><span class="va">xbar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">data_ess</span><span class="op">$</span><span class="va">stfgov</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">data_ess</span><span class="op">$</span><span class="va">stfgov</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span/>
<span><span class="co"># Set confidence level with 1-alpha (alpha = our willingness to be wrong in repeated samples)</span></span>
<span><span class="va">conf.level</span> <span class="op">&lt;-</span> <span class="fl">0.95</span></span>
<span/>
<span><span class="co"># Calculating the critical z-value for a two-sided test </span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">conf.level</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span/>
<span><span class="co"># Calculate the confidence interval</span></span>
<span><span class="va">lower.ci</span> <span class="op">&lt;-</span> <span class="va">xbar</span> <span class="op">-</span> <span class="va">z</span> <span class="op">*</span> <span class="va">s</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">upper.ci</span> <span class="op">&lt;-</span> <span class="va">xbar</span> <span class="op">+</span> <span class="va">z</span> <span class="op">*</span> <span class="va">s</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span/>
<span><span class="co"># Print confidence intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"The"</span>, <span class="va">conf.level</span><span class="op">*</span><span class="fl">100</span>,<span class="st">"% confidence interval for the population mean is ("</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lower.ci</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">","</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">upper.ci</span>, <span class="fl">2</span><span class="op">)</span>,<span class="st">").\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## The 95 % confidence interval for the population mean is ( 4.19 , 4.37 ).</code></pre>
<p>Computing confidence intervals is even easier with the “t.test” command. While we are interested in the z-distribution, t- and z-distribution correspond to each other when the number of observations is high enough (usually already &gt;30).</p>
<p>Let’s try it out:</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">data_ess</span><span class="op">$</span><span class="va">stfgov</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  data_ess$stfgov
## t = 92.783, df = 2291, p-value &lt; 2.2e-16
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  4.189216 4.370120
## sample estimates:
## mean of x 
##  4.279668</code></pre>
<p><br/></p>
<hr/>
<div class="alert alert-info">
<p><strong>Question:</strong> Interpret the confidence interval.</p>
</div>
<p><br/><br/>
Your answer:<br/></p>
<p><br/></p>

Solution:

<br/><blockquote>
<p><font size="-1"> <i/></font></p>
<p><strong>Interpretation:</strong> Likely values for the population mean are within the limits of 4.2 and 4.4.</p>
 
</blockquote>
<hr/>
<p><br/></p>
<p>There is also the possibility to display the confidence interval as a plot:</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">xbar</span>, <span class="va">lower.ci</span>, <span class="va">upper.ci</span><span class="op">)</span></span>
<span/>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="va">xbar</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, shape <span class="op">=</span> <span class="fl">21</span>, fill <span class="op">=</span> <span class="st">"white"</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lower.ci</span>, ymax <span class="op">=</span> <span class="va">upper.ci</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Value"</span>, y <span class="op">=</span> <span class="st">"Mean with 95% CI"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="../Images/9521033d831eee314a1722faaaf52c8e.png" width="672" data-original-src="https://bookdown.org/conradziller/introstatistics/03-inference_files/figure-html/unnamed-chunk-8-1.png"/></div>
<p><br/></p>
</div>
<div id="proportion" class="section level4" number="4.4.2.2">
<h4>
<span class="header-section-number">4.4.2.2</span> Proportion<a class="anchor" aria-label="anchor" href="#proportion"/>
</h4>
<p>Besides the mean, we can calculate a confidence interval for a proportion value of a sample. The formula is slightly different because the calculation of the standard error is different. It is the square root of the variance divided by the number of observations. The variance is obtained by multiplying the probability of an event <span class="math inline">\(p\)</span> times the counter probability <span class="math inline">\(1-p\)</span>:</p>
<p><span class="math inline">\(95\% CIs=[p - 1.96 \times \sqrt{\frac{p\times(1-p)}{n}}, p + 1.96 \times \sqrt{\frac{p\times(1-p)}{n}}]\)</span>.</p>
<p>Let’s try this by using a dichotomized version of the government satisfaction variable with an initial 11-point rating scale. In this example, values of 5 or less are assigned to 0 (“little or not satisfied”) and values above 5 are assigned to 1 (“satisfied”). We can now focus on the proportion of those respondents who are satisfied or rather satisfied with the government (variable value = 1). Note that with a 0/1 coding, the mean of a binary variable corresponds to the proportion of observations with a variable value of 1.</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Recode of variable</span></span>
<span><span class="va">data_ess</span> <span class="op">&lt;-</span> <span class="va">data_ess</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>stfgov_di <span class="op">=</span></span>
<span>           <span class="fu">case_when</span><span class="op">(</span><span class="va">stfgov</span> <span class="op">&lt;=</span> <span class="fl">5</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>                     <span class="va">stfgov</span> <span class="op">&gt;</span> <span class="fl">5</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span/>
<span><span class="co"># Proportion via table command</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">data_ess</span><span class="op">$</span><span class="va">stfgov_di</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##        0        1 
## 0.693281 0.306719</code></pre>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Correspondence with the mean of the summary command</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">data_ess</span><span class="op">$</span><span class="va">stfgov_di</span><span class="op">)</span></span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##  0.0000  0.0000  0.0000  0.3067  1.0000  1.0000      66</code></pre>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set confidence level with 1-alpha</span></span>
<span><span class="va">conf.level</span> <span class="op">&lt;-</span> <span class="fl">0.95</span></span>
<span/>
<span><span class="co"># Calculating the critical z-value for a two-sided test</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">conf.level</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span/>
<span><span class="co"># Calculation of the confidence interval</span></span>
<span><span class="va">lower.ci</span> <span class="op">&lt;-</span> <span class="fl">0.3067</span> <span class="op">-</span> <span class="va">z</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="fl">0.3067</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">0.3067</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">upper.ci</span> <span class="op">&lt;-</span> <span class="fl">0.3067</span> <span class="op">+</span> <span class="va">z</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="fl">0.3067</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">0.3067</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">n</span><span class="op">)</span></span>
<span/>
<span><span class="co"># Print the confidence intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"The"</span>, <span class="va">conf.level</span><span class="op">*</span><span class="fl">100</span>, <span class="st">"% confidence interval for the proportion value is ("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lower.ci</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">","</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">upper.ci</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">").\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## The 95 % confidence interval for the proportion value is ( 0.29 , 0.33 ).</code></pre>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Test using t.test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">data_ess</span><span class="op">$</span><span class="va">stfgov_di</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  data_ess$stfgov_di
## t = 31.837, df = 2291, p-value &lt; 2.2e-16
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  0.2878265 0.3256115
## sample estimates:
## mean of x 
##  0.306719</code></pre>
<p><br/></p>
<hr/>
<div class="alert alert-info">
<p><strong>Question:</strong> Interpret the confidence interval.</p>
</div>
<p><br/><br/>
Your answer:<br/></p>
<p><br/></p>

Solution:

<br/><blockquote>
<p><font size="-1"> <i><strong>Interpretation:</strong> Likely values for the population proportion are within the limits of 0.29 and 0.33.</i></font></p>
 
</blockquote>
<hr/>
<p><br/></p>
</div>
<div id="correlation-coefficient" class="section level4" number="4.4.2.3">
<h4>
<span class="header-section-number">4.4.2.3</span> Correlation coefficient<a class="anchor" aria-label="anchor" href="#correlation-coefficient"/>
</h4>
<p>Next, we look at how a confidence interval for a correlation is computed. For this, we use the following formula: <span class="math inline">\(95\% CIs=r\pm 1.96 \times SE\)</span>, where the standard error SE is calculated as follows: <span class="math inline">\(SE_r=\sqrt {\frac{(1-r^2)}{n-2}}\)</span>. To illustrate that, we let the software compute the confidence interval of the correlation between household income and satisfaction with the government. <code>hinctnta</code> measures respondents’ net household income (after deductions) across 10 quantiles (“deciles” 1-10) - the reason for this measurement is that this way income becomes adjusted to a country’s income distribution and is thus comparable across countries. Regarding the correlation, we assume that - in line with economic voting theory - people with a higher income are more satisfied with the government than people with a lower income.</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">data_ess</span><span class="op">$</span><span class="va">hinctnta</span>, <span class="va">data_ess</span><span class="op">$</span><span class="va">stfgov</span><span class="op">)</span></span>
<span><span class="va">cor</span></span></code></pre></div>
<pre><code>## 
##  Pearson's product-moment correlation
## 
## data:  data_ess$hinctnta and data_ess$stfgov
## t = 1.805, df = 2047, p-value = 0.07122
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.003445968  0.083023781
## sample estimates:
##        cor 
## 0.03986354</code></pre>
<p><br/></p>
<hr/>
<div class="alert alert-info">
<p><strong>Question:</strong> Interpret the confidence interval.</p>
</div>
<p><br/><br/>
Your answer:<br/></p>
<p><br/></p>

Solution:

<br/><blockquote>
<p><font size="-1"> <i><strong>Interpretation:</strong> Likely values for correlation in the population are within the limits of -0.003 and 0.08.</i></font></p>
 
</blockquote>
<hr/>
<p><br/></p>
<p>The graphical representation of the confidence interval of a correlation is two-dimensional. The width of the confidence interval can vary along the values of the x-axis. The value from the previous test is, so to say, the average confidence interval.</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ciplot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">data_ess</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">hinctnta</span> , y <span class="op">=</span> <span class="va">stfgov</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">TRUE</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Income (Deciles)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Satisfaction with the government"</span><span class="op">)</span></span>
<span><span class="va">ciplot</span></span></code></pre></div>
<div class="inline-figure"><img src="../Images/d86f767f96c71877b2d04915a8ab5e50.png" width="672" data-original-src="https://bookdown.org/conradziller/introstatistics/03-inference_files/figure-html/unnamed-chunk-12-1.png"/></div>
<p><br/></p>
<hr/>
<div class="alert alert-info">
<p><strong>Question:</strong> The shown figure displays 95% confidence intervals. Would 90% confidence intervals be narrower or wider?</p>
</div>
<p><br/><br/>
Your answer:<br/></p>
<p><br/></p>

Solution:

<br/>
The 90% confidence intervals would be narrower. Going back to the probability-world interpretation: If we only want to capture the true population parameter 90 percent of the time (instead of 95), this means that we could narrow down the range of values in which the parameter will fall. In contrast, if we decrease our readiness to err to 1% (i.e., a 99% confidence interval), the range of values to fulfill this assumption would increase - the confidence interval would get wider. <br/><hr/>
<p><br/></p>
<p><br/></p>
</div>
</div>
</div>
<div id="null-hypothesis-testing" class="section level2" number="4.5">
<h2>
<span class="header-section-number">4.5</span> Null Hypothesis Testing<a class="anchor" aria-label="anchor" href="#null-hypothesis-testing"/>
</h2>
<div id="basic-idea-and-procedure" class="section level3" number="4.5.1">
<h3>
<span class="header-section-number">4.5.1</span> Basic idea and procedure<a class="anchor" aria-label="anchor" href="#basic-idea-and-procedure"/>
</h3>
<p>Hypothesis testing allows us to test how likely it is that a sample estimate corresponds to another value, more specifically the sampling distribution of another value. We typically use for this purpose the distribution that is obtained under the null hypothesis- that is, for example, the assumption that the difference in means between two groups or the correlation between two variables is zero in the population. The distribution of a test statistic under the assumption that the null hypothesis is true is sometimes labeled “null distribution.” We know from the central limit theorem that such a sampling distribution would be normal given repeated sampling and a high enough sample size (&gt;30), which implies that we can use a normal distribution for our statistical tests.</p>
<p>The goal usually is to test the sample estimate we obtained against the null distribution. If the estimate is so “extreme” that it becomes very unlikely to obtain such a result although the null hypothesis is true, then this would provide evidence against the null hypothesis and in favor of our alternative hypothesis (e.g., the correlation between two variables is positive in the population). Hence, the procedure of Null Hypothesis Testing is a form of <em>proof by contradiction</em>. We assume the opposite of what we want to show and then collect as much evidence as possible against that assumption.</p>
<p>To begin with, we first formulate the so-called <strong>null hypothesis <span class="math inline">\(H_0\)</span></strong> (e.g., there is <em>no</em> or zero correlation in the population). Next, we formulate an <strong>alternative hypothesis <span class="math inline">\(H_A\)</span></strong> (e.g., the correlation in the population is positive or negative) and then want to show that the correlation we found is strong enough so that it becomes very unlikely that <span class="math inline">\(H_0\)</span> is true. This means that we are trying to disprove <span class="math inline">\(H_0\)</span>, which in turn is evidence for <span class="math inline">\(H_A\)</span>. Note that we do not assign probabilities for <span class="math inline">\(H_A\)</span> to be true but probabilities to observe a given estimate given that <span class="math inline">\(H_0\)</span> is true (i.e., <span class="math inline">\(P\)</span>(correlation | <span class="math inline">\(H_0\)</span>).</p>
<p>The following steps illustrate how to do Null Hypothesis Testing:</p>
<ul>
<li>
<strong>Step 1:</strong> Formulate the null hypothesis and alternative hypothesis.</li>
<li>
<strong>Step 2:</strong> Determine the probability of error (<span class="math inline">\(\alpha\)</span>, i.e., our willingness to err in repeated sampling, the convention is typically 5% or less).</li>
<li>
<strong>Step 3:</strong> Compute the value of the test statistic for your estimate (=estimator/standard error).</li>
<li>
<strong>Step 4a:</strong> Determine a critical value c (e.g., from an online table)</li>
<li>
<strong>Step 5a:</strong> If the value of the test statistic falls within the rejection range (i.e., exceeds the critical value), reject <span class="math inline">\(H_0\)</span>.</li>
</ul>
<p>Alternatively:</p>
<ul>
<li><p><strong>Step 4b:</strong> Calculate p-value (use statistical software).</p></li>
<li><p><strong>Step 5b:</strong> If p-value &lt; probability of error, then reject <span class="math inline">\(H_0\)</span>.</p></li>
<li><p><strong>Step 6:</strong> Interpret the result of the hypothesis test in substantive terms.</p></li>
</ul>
<p><br/></p>
</div>
<div id="hypothesis-test-of-a-difference-in-means" class="section level3" number="4.5.2">
<h3>
<span class="header-section-number">4.5.2</span> Hypothesis test of a difference in means<a class="anchor" aria-label="anchor" href="#hypothesis-test-of-a-difference-in-means"/>
</h3>
<p>Differences in means usually refer to a comparison of the mean of a variable between two groups. To illustrate that, we use the example of income and government satisfaction again. We leave the variable government satisfaction <code>stfgov</code> in its original metric form so that we can calculate the mean. However, we dichotomize the variable income <code>hinctnta</code> into two groups: low earners and high earners.</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_ess</span> <span class="op">&lt;-</span> <span class="va">data_ess</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>hinctnta_di <span class="op">=</span></span>
<span>           <span class="fu">case_when</span><span class="op">(</span><span class="va">hinctnta</span> <span class="op">&lt;=</span> <span class="fl">6</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>                     <span class="va">hinctnta</span> <span class="op">&gt;</span> <span class="fl">6</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">data_ess</span><span class="op">$</span><span class="va">hinctnta_di</span><span class="op">)</span></span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##  0.0000  0.0000  0.0000  0.4794  1.0000  1.0000     270</code></pre>
<p><br/></p>
<hr/>
<div class="alert alert-info">
<p><strong>Question:</strong> Formulate the null and alternative hypotheses if we assume that persons with a high-income are more satisfied with the government.</p>
</div>
<p><br/><br/>
Your answer:<br/></p>
<textarea name="textarea" cols="50" rows="5">

H_0:

H_A:

</textarea><p><br/></p>

Solution:

<p><br/>
Typically, it is easier to start with formulating the alternative hypothesis.</p>
<p><span class="math inline">\(H_A\)</span>:
High-income individuals are more satisfied with government than low-income individuals (i.e., positive relationship between income and satisfaction with government).</p>
<p>Formal: <span class="math inline">\(\mu(satisfaction|highincome)&gt;\mu(satisfaction|lowincome)\)</span> or (equivalent) <span class="math inline">\(\mu(satisfaction|highincome)-\mu(satisfaction|lowincome)&gt;0\)</span></p>
<p><br/></p>
<p><span class="math inline">\(H_0\)</span>:
High-income individuals are equally or less satisfied with government than low-income individuals (i.e., null or negative relationship between income and satisfaction with government).</p>
<p>Formal: <span class="math inline">\(\mu(satisfaction|highincome)\le\mu(satisfaction|lowincome)\)</span> or (equivalent) <span class="math inline">\(\mu(satisfaction|highincome)-\mu(satisfaction|lowincome)\le0\)</span></p>
<p>Note that it is important that all possible outcomes are covered by both hypotheses. This means that when formulating a directed hypothesis, the null hypothesis must include the case of no relationship (i.e., “<span class="math inline">\(\le\)</span>” instead of just “<span class="math inline">\(&lt;\)</span>”).</p>
<br/><hr/>
<p><br/></p>
<p>Let us then assume an error probability of 5% or 0.05 (Step 2). Next, we calculate the test statistic (Step 3). Generally, this is given as <span class="math inline">\(\frac{estimate - true value}{standard error}\)</span>. Since we test against the null hypothesis, the true value is 0. The formula for the so-called z-test statistic is given as:</p>
<p><span class="math inline">\(z=\frac{Estimation}{Standard Error}\)</span>.</p>
<p>Steps 4 and 5 are about the actual test. Remember that per the alternative hypothesis, we assumed a positive mean difference (i.e., high-income earners are more satisfied with the government than low-income earners). Next, we want to know where the mean difference is located on the null distribution. If it is close to the center of the distribution, we have no reason to reject the null hypothesis. However, if it is at the margins of the distribution, this would provide a reason for rejecting the null hypothesis (and favoring the alternative hypothesis). We use the z-distribution with a mean of 0 and a standard deviation of 1. Remember the properties of this distribution from above. If we set the critical value to be lower than -1.96 and higher than +1.96, we would be in the 5% range of the distribution if our test statistic exceeds those critical values. If this was the case, we can conclude that it would be very unlikely to sample such a value even though <span class="math inline">\(H_0\)</span> holds. Note that we set up a positive and negative area of rejection if we formulate undirected hypotheses (i.e., <span class="math inline">\(H_A\)</span>: the mean difference can be higher or lower than zero, <span class="math inline">\(H_0\)</span>: the mean difference equals zero) and conduct two-sided tests. For a directed hypothesis (and one-sided tests), like in our example, the rejection area is only in the negative or positive range of the distribution (depending on whether <span class="math inline">\(H_A\)</span> expects a pos. or neg. statistic).</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Draw a standard normal distribution:</span></span>
<span><span class="va">z</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, length.out<span class="op">=</span><span class="fl">1001</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span/>
<span><span class="co"># Null distribution of two-sided test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span> x<span class="op">=</span><span class="va">z</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">'n'</span>, type<span class="op">=</span><span class="st">'l'</span>, main<span class="op">=</span><span class="st">"Null distribution of two-sided test, error probability 0.05"</span>, ylab<span class="op">=</span><span class="st">"Probability density"</span>, xlab<span class="op">=</span><span class="st">"z"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">z</span><span class="op">&lt;=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">z</span><span class="op">&lt;=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.025</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"maroon"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">z</span><span class="op">&gt;=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">z</span><span class="op">&gt;=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"maroon"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="../Images/adbfd17d562ccc396d1fe0c9bea7d598.png" width="672" data-original-src="https://bookdown.org/conradziller/introstatistics/03-inference_files/figure-html/unnamed-chunk-14-1.png"/></div>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Null distribution of one-sided test (H_A&gt;0)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span> x<span class="op">=</span><span class="va">z</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">'n'</span>, type<span class="op">=</span><span class="st">'l'</span>, main<span class="op">=</span><span class="st">"Null distribution of one-sided test (H_A&gt;0), error probability 0.05"</span>, ylab<span class="op">=</span><span class="st">"Probability density"</span>, xlab<span class="op">=</span><span class="st">"z"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">z</span><span class="op">&gt;=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.95</span><span class="op">)</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.95</span><span class="op">)</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">z</span><span class="op">&gt;=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.95</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"maroon"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="../Images/03648c89dbdb157687b7943bf457c54f.png" width="672" data-original-src="https://bookdown.org/conradziller/introstatistics/03-inference_files/figure-html/unnamed-chunk-14-2.png"/></div>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Null distribution of one-sided test (H_A&lt;0)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span> x<span class="op">=</span><span class="va">z</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, bty<span class="op">=</span><span class="st">'n'</span>, type<span class="op">=</span><span class="st">'l'</span>, main<span class="op">=</span><span class="st">"Null distribution of one-sided test (H_A&lt;0), error probability 0.05"</span>, ylab<span class="op">=</span><span class="st">"Probability density"</span>, xlab<span class="op">=</span><span class="st">"z"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span><span class="fl">1</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">z</span><span class="op">&lt;=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.05</span><span class="op">)</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.05</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="va">z</span><span class="op">&lt;=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.05</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"maroon"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="../Images/faa33b90ef9f0d91a5d9bbba48e44b09.png" width="672" data-original-src="https://bookdown.org/conradziller/introstatistics/03-inference_files/figure-html/unnamed-chunk-14-3.png"/></div>
<p><br/></p>
<hr/>
<div class="alert alert-info">
<p><strong>Question:</strong> How would the rejection area change if we test one-sided? What would change if we set a 1% probability of error (two-sided test)?</p>
</div>
<p><br/><br/>
Your answer:<br/></p>
<p><br/></p>

Solution:

<p><br/>
Assuming a positive mean difference or correlation, the rejection area would be located only on the right side of the distribution. Since we still use an error probability of 5%, this area would be larger than in the two-sided case. Consequently, the critical value c thus moves a bit in the direction of the center of the distribution. For the z-distribution, this value is +1.645 for a positive alternative hypothesis (and -1.645 for a negative hypothesis).</p>
<p>If we change the probability of error to 1% and test two-sided, we have a rejection range that is smaller compared to the 5% case. Our estimate and the corresponding z-statistic need to be larger to reject the null hypothesis compared to the 5%-case. In the 1% case, the critical values are -2.326 and +2.326.</p>
<p>Critical values at which one can reject the null hypothesis can be obtained from here: <a href="https://www.criticalvaluecalculator.com/" target="„_blank“">https://www.criticalvaluecalculator.com/</a></p>
<br/><hr/>
<p><br/></p>
<div id="general-remarks-on-p-values" class="section level4" number="4.5.2.1">
<h4>
<span class="header-section-number">4.5.2.1</span> General remarks on P-values<a class="anchor" aria-label="anchor" href="#general-remarks-on-p-values"/>
</h4>
<p>P-values <strong>indicate the probability of finding an estimate as extreme (or more extreme) as we got from our sample (e.g., a difference in means), even though the null hypothesis is true in the population.</strong> In formal terms, that is the probability of the estimate given the null hypothesis <span class="math inline">\(P\)</span>(estimate | <span class="math inline">\(H_0\)</span>).</p>
<p>Some features of p-values:</p>
<ul>
<li><p>The smaller the p-value, the more “statistically significant” the result (or the more reason we have to reject the null hypothesis, which, in turn, provides evidence in favor of the alternative hypothesis).</p></li>
<li><p>Contingent upon the probability of error, if p is smaller than <span class="math inline">\(\alpha\)</span>, then the result is statistically significant (usually &lt; 0.05 or 5%).</p></li>
<li><p>If the test statistic associated with the estimate is less than or greater than the critical z- or t-values, respectively, then p &lt; 0.05.</p></li>
<li>
<p>Correspondence with confidence intervals:</p>
<ul>
<li><p>If the confidence interval includes the null hypothesis value (usually 0), this is consistent with a high p-value, indicating weak evidence against the null hypothesis.</p></li>
<li><p>If the confidence interval does not include 0, it is consistent with a low p-value, suggesting strong evidence against the null hypothesis.</p></li>
<li><p>For example: A mean difference of 0.5 with a 95% confidence interval of [0.35; 0.65] is statistically significant at the <span class="math inline">\(\alpha\)</span>=0.05 level (reject <span class="math inline">\(H_0\)</span>). However, a mean difference of -0.1 with a 95% confidence interval of [-0.25; 0.05] is statistically <strong>not</strong> significant at the <span class="math inline">\(\alpha\)</span>=0.05 level (confidence intervals include 0, fail to reject <span class="math inline">\(H_0\)</span>).</p></li>
</ul>
</li>
<li><p>To calculate the exact p-value, we rely on tables or statistical software.</p></li>
<li><p>A p-value says <strong>nothing</strong> about the probability that <span class="math inline">\(H_0\)</span> or <span class="math inline">\(H_A\)</span> is true; remember <span class="math inline">\(P\)</span>(estimate | <span class="math inline">\(H_0\)</span>)!</p></li>
<li><p>When we formulate one-sided hypotheses but use a two-sided test (which is the norm in social science research), we are especially careful and do not want to make a 1st kind error (<span class="math inline">\(H_0\)</span> is true, but we reject it); we can divide the p-value by 2 and end up with the p-value we would have gotten if we tested one-sided.</p></li>
</ul>
</div>
<div id="test-implementation" class="section level4" number="4.5.2.2">
<h4>
<span class="header-section-number">4.5.2.2</span> Test implementation<a class="anchor" aria-label="anchor" href="#test-implementation"/>
</h4>
<p>To actually test the difference in the means of satisfaction with the government between high and low earners, the formula for this is given as <span class="math inline">\(z =\frac{(\bar x_1 - \bar x_2)}{standard error}\)</span> (note that the standard error of the mean difference is not simply the difference of two standard errors).</p>
<p>We now calculate the mean difference and conduct a corresponding hypothesis test:</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">data_ess</span><span class="op">$</span><span class="va">stfgov</span><span class="op">[</span><span class="va">data_ess</span><span class="op">$</span><span class="va">hinctnta_di</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">data_ess</span><span class="op">$</span><span class="va">stfgov</span><span class="op">[</span><span class="va">data_ess</span><span class="op">$</span><span class="va">hinctnta_di</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.1543566</code></pre>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">data_ess</span><span class="op">$</span><span class="va">stfgov</span><span class="op">[</span><span class="va">data_ess</span><span class="op">$</span><span class="va">hinctnta_di</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span>, <span class="va">data_ess</span><span class="op">$</span><span class="va">stfgov</span><span class="op">[</span><span class="va">data_ess</span><span class="op">$</span><span class="va">hinctnta_di</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  data_ess$stfgov[data_ess$hinctnta_di == 1] and data_ess$stfgov[data_ess$hinctnta_di == 0]
## t = 1.5882, df = 2046.8, p-value = 0.1124
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.03624397  0.34495717
## sample estimates:
## mean of x mean of y 
##  4.354545  4.200189</code></pre>
<p><br/></p>
<hr/>
<div class="alert alert-info">
<p><strong>Question:</strong> Interpret the result of the statistical test in detail with reference to the specific p-value.</p>
</div>
<p><br/><br/>
Your answer:<br/></p>
<p><br/></p>

Solution:

<p><br/>
The probability of obtaining such a result from the sample, although <span class="math inline">\(H_0\)</span> is true in the population, is 0.11 or 11%. Since this exceeds the threshold of our willingness to err of 5%, we cannot reject the null hypothesis (and thus find no evidence in favor of <span class="math inline">\(H_A\)</span>).</p>
<p>Even if we take into account that we formulated a directed hypothesis and rely on a one-sided test (we can thus divide the p-value by 2), the p-value still exceeds our assumed probability of error (p-value of 0.055 &gt; <span class="math inline">\(\alpha\)</span> of 0.05). Hence, even with a one-sided test, we are not able to reject the null hypothesis.</p>
<br/><hr/>
<p><br/></p>
</div>
</div>
<div id="hypothesis-test-of-a-correlation" class="section level3" number="4.5.3">
<h3>
<span class="header-section-number">4.5.3</span> Hypothesis test of a correlation<a class="anchor" aria-label="anchor" href="#hypothesis-test-of-a-correlation"/>
</h3>
<p>Instead of a difference in means, we now focus on hypothesis tests of correlations. The procedure is analogous to the one before. We first formulate the null and alternative hypotheses, specify the probability of error (5% in this case), calculate the test statistic (<span class="math inline">\(z=\frac{r}{SE}\)</span>), calculate the p-value, and interpret the result.</p>
<p><br/></p>
<hr/>
<div class="alert alert-info">
<p><strong>Question:</strong> Assume that higher income is either positively or negatively related to satisfaction with government. Formulate the null and alternative hypotheses (undirected).</p>
</div>
<p><br/><br/>
Your answer:<br/></p>
<textarea name="textarea" cols="50" rows="5">

H_0:

H_A:

</textarea><p><br/></p>

Solution:

<p><br/></p>
<p><span class="math inline">\(H_A\)</span>:
Verbal: Income is either positively or negatively related to satisfaction with government.</p>
<p>Formal: <span class="math inline">\(r \ne 0\)</span></p>
<p><br/></p>
<p><span class="math inline">\(H_0\)</span>:
Verbal: Income is unrelated to satisfaction with government.</p>
<p>Formal: <span class="math inline">\(r = 0\)</span></p>
<br/><hr/>
<p><br/></p>
<p>We now calculate the test statistic and the p-value.</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">data_ess</span><span class="op">$</span><span class="va">hinctnta</span>, <span class="va">data_ess</span><span class="op">$</span><span class="va">stfgov</span><span class="op">)</span></span>
<span><span class="va">cor</span></span></code></pre></div>
<pre><code>## 
##  Pearson's product-moment correlation
## 
## data:  data_ess$hinctnta and data_ess$stfgov
## t = 1.805, df = 2047, p-value = 0.07122
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.003445968  0.083023781
## sample estimates:
##        cor 
## 0.03986354</code></pre>
<p><br/></p>
<hr/>
<div class="alert alert-info">
<p><strong>Question:</strong> Interpret the result of the statistical test (two-sided test) with reference to the t-value and p-value.</p>
</div>
<p><br/><br/>
Your answer:<br/></p>
<p><br/></p>

Solution:

<p><br/>
The probability of obtaining such a result from the sample, although <span class="math inline">\(H_0\)</span> is true in the population, is 0.07 or 7%. Since this exceeds the threshold of our willingness to err of 5%, the result is not statistically significant and we cannot reject the null hypothesis (and thus find no evidence in favor of <span class="math inline">\(H_A\)</span>).</p>
<br/><hr/>
<p><br/></p>
</div>
</div>
<div id="outlook-1" class="section level2" number="4.6">
<h2>
<span class="header-section-number">4.6</span> Outlook<a class="anchor" aria-label="anchor" href="#outlook-1"/>
</h2>
<p>This case study reviewed the basics of probability theory, some relevant statistical laws, confidence intervals, and hypothesis testing. In the examples, we have mainly used the z-distribution, which is the way to go if we deal with large or reasonably large samples (&gt;30 is already sufficient). For small samples and other purposes, we use other distributions for statistical testing that are briefly introduced here.</p>
<p><br/></p>
<div id="t-distribution" class="section level3" number="4.6.1">
<h3>
<span class="header-section-number">4.6.1</span> t-distribution<a class="anchor" aria-label="anchor" href="#t-distribution"/>
</h3>
<p>The t-distribution corresponds to the z-distribution for larger samples. For small samples, the distribution is flatter and therefore has wider margins. The critical t-values (above or below we can reject the null hypothesis) are therefore larger on the right and lower on the left side. This makes it more difficult to reject the null hypothesis. In other words: We need more extreme results in small samples to reject the null hypothesis. This accounts for the fact that some outliers have greater weight in small samples. This helps to avoid the so-called alpha error (or type I error), which refers to erroneously inferring statistically significant results although the null hypothesis is true in the population. The alpha error is usually seen as a greater threat to scientific progress than failing to reject the null hypothesis although we should have done so (beta error or type II error).</p>
<p>Df refers to degrees of freedom, which is usually the number of cases - 1 (for estimation).</p>
<div class="float" id="id">
<img src="../Images/c287a1a35548f8f82bf97e42fb7dfcd5.png" class="class" style="width:50.0%;height:50.0%" alt="t-distribution" data-original-src="https://bookdown.org/conradziller/introstatistics/picture/t.png"/><div class="figcaption">t-distribution</div>
</div>
<p>Source: <a href="https://www.geo.fu-berlin.de/en/v/soga-py/Basics-of-statistics/Continous-Random-Variables/Students-t-Distribution/index.html" target="„_blank“">https://www.geo.fu-berlin.de/en/v/soga-py/Basics-of-statistics/Continous-Random-Variables/Students-t-Distribution/index.html</a></p>
<p><br/></p>
</div>
<div id="chi-square-distribution" class="section level3" number="4.6.2">
<h3>
<span class="header-section-number">4.6.2</span> Chi-square distribution<a class="anchor" aria-label="anchor" href="#chi-square-distribution"/>
</h3>
<p>The chi-square distribution is used, for example, for testing variances. One field of application is in cross tabulations. Chi-square values are never negative, so only one-sided tests are suitable.</p>
<p>Df refers to degrees of freedom, which in the case of crosstabs would be the table size, for example.</p>
<div class="float" id="id">
<img src="../Images/f7ed5980e4a4bc02da3af38a835ec9cc.png" class="class" style="width:50.0%;height:50.0%" alt="Chi-Square-Distribution" data-original-src="https://bookdown.org/conradziller/introstatistics/picture/chi.png"/><div class="figcaption">Chi-Square-Distribution</div>
</div>
<p>Source: <a href="https://www.geo.fu-berlin.de/en/v/soga-py/Basics-of-statistics/Continous-Random-Variables/Chi-Square-Distribution/index.html" target="„_blank“">https://www.geo.fu-berlin.de/en/v/soga-py/Basics-of-statistics/Continous-Random-Variables/Chi-Square-Distribution/index.html</a></p>
<p><br/></p>
</div>
<div id="f-distribution" class="section level3" number="4.6.3">
<h3>
<span class="header-section-number">4.6.3</span> F-Distribution<a class="anchor" aria-label="anchor" href="#f-distribution"/>
</h3>
<p>The F-distribution is basically the ratio of two chi-squared distributed random variables (e.g., two variances). The F-distribution is also always positive and the functional form depends on the degrees of freedom of the two variables under consideration. F-tests are used, for example, in comparing the model fit of regression models.</p>
<p><img src="../Images/2de8e3c2e232988c4e1262fb8cdbbea5.png" id="id" class="class" style="width:50.0%;height:50.0%" alt="F-Distribution 1" data-original-src="https://bookdown.org/conradziller/introstatistics/picture/f1.png"/><img src="../Images/8597d82a7302d8203525fc4557db3545.png" id="id" class="class" style="width:50.0%;height:50.0%" alt="F-Distribution 2" data-original-src="https://bookdown.org/conradziller/introstatistics/picture/f2.png"/></p>
<p>Source: <a href="https://www.geo.fu-berlin.de/en/v/soga-py/Basics-of-statistics/Continous-Random-Variables/F-Distribution/index.html" target="„_blank“">https://www.geo.fu-berlin.de/en/v/soga-py/Basics-of-statistics/Continous-Random-Variables/F-Distribution/index.html</a></p>
<p><br/><br/></p>
</div>
<div id="statistical-versus-substantive-significance" class="section level3" number="4.6.4">
<h3>
<span class="header-section-number">4.6.4</span> Statistical versus substantive significance<a class="anchor" aria-label="anchor" href="#statistical-versus-substantive-significance"/>
</h3>
<p>The procedures discussed here relate to the concept of hypothesis testing and statistical significance. They are essentially concerned with quantifying uncertainty and inferring from that whether or not one can assume that a result from a random sample can be generalized to the population the sample has been drawn from. Although these are important concepts, statistical significance is different from scientific or substantive significance, which refers to the degree to which a result is relevant against the background of other research findings or alternative explanatory factors. Thus, a statistically significant result may not be substantial or, conversely, a substantial result may not be statistically significant. Statistical significance, for example, is highly dependent on the number of observations that are incorporated in calculating the standard error. A measure of the substance of, for example, a regression coefficient can be obtained by using standardized effect sizes such as beta or Cohen’s D.</p>
<p>In general, we are looking for empirical results that are both statistically and substantively significant.</p>
<p><br/></p>

<p><br/><br/></p>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="bivariate-statistics-case-study-united-states-presidential-election.html"><span class="header-section-number">3</span> Bivariate Statistics – Case Study United States Presidential Election</a></div>
<div class="next"><a href="regression-analysis---case-study-attitudes-toward-justice.html"><span class="header-section-number">5</span> Regression Analysis - Case Study Attitudes Toward Justice</a></div>
</div>    
</body>
</html>