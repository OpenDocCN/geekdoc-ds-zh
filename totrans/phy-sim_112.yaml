- en: Discretization and Approximation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec22.1-disc_and_approx.html](https://phys-sim-book.github.io/lec22.1-disc_and_approx.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: From Equation [(18.4.2)](lec18.4-friction_force.html#eq:lec18:smooth-frict),
    the friction force per unit area is defined as
  prefs: []
  type: TYPE_NORMAL
- en: TF​(X,t)=−μ∥TC​(X,t)∥ f(∥VF​(X,t)∥) s(VF​(X,t)),
  prefs: []
  type: TYPE_NORMAL
- en: where μ is the friction coefficient, TC​ is the normal contact force, and VF​
    is the relative sliding velocity. Here s(VF​)=∥VF​∥VF​​ when ∥VF​∥>0, while s(VF​)
    takes any unit vector orthogonal to the normal N(X,t) when ∥VF​∥=0. Additionally,
    the friction scaling function f is also nonsmooth with respect to VF​, as f(∥VF​∥)=1
    when ∥VF​∥>0, and f(∥VF​∥)∈[0,1] when ∥VF​∥=0.
  prefs: []
  type: TYPE_NORMAL
- en: It is important to note that without temporal discretization, there is no potential
    energy for friction. However, similar to [Frictional Contact](./lec9-friction.html),
    once we discretize the normal force magnitude and the tangent operator to the
    last time step and smoothly approximate the friction scaling function f, the friction
    force at the (n+1)-th time step becomes integrable with respect to x, and we obtain
  prefs: []
  type: TYPE_NORMAL
- en: TFn+1​(X)≈−∂xn+1(X)∂Dn+1(X)​=−∂xn+1(X)∂(μ∥TCn​(X)∥f0​(∥VˉFn+1​(X)h^∥))​.
  prefs: []
  type: TYPE_NORMAL
- en: Here, VˉFn+1​(X)=(I−Nn(X)Nn(X)T)(Vn+1(X)−Vn+1(X2​)) is the approximate relative
    sliding velocity, where Nn and X2​ are the normal direction and the point in contact
    with X in the last time step, h^I=(∂v/∂x)−1, and
  prefs: []
  type: TYPE_NORMAL
- en: f0​(y)={−3ϵv2​h^2y3​+ϵv​h^y2​+3ϵv​h^​,y,​y∈[0,ϵv​h^);y≥ϵv​h^.​
  prefs: []
  type: TYPE_NORMAL
- en: Therefore, considering self-contact, the approximate friction potential over
    the entire boundary can be written as
  prefs: []
  type: TYPE_NORMAL
- en: ∫ΓC​​21​μ∥TCn​(X)∥f0​(∥VˉFn+1​(X)h^∥)ds(X),
  prefs: []
  type: TYPE_NORMAL
- en: where the 21​ scaling comes from double counting the friction between each pair
    of contact points in the integral (similar to the normal contact forces in [Boundary
    Conditions and Frictional Contact](./lec18-BC_and_fric.html)).
  prefs: []
  type: TYPE_NORMAL
- en: 'After discretizing the boundary curves as polylines and approximating the max
    operator in the normal contact force component using summations ([Piecewise Linear
    Boundaries](./lec20-pw_linear_boundary.html)), we similarly obtain the spatially
    discretized friction potential:'
  prefs: []
  type: TYPE_NORMAL
- en: ∫ΓC​​e∈E−I(X)∑​21​μ(−∂d∂b(dPE(xn(X),e),d^)​)f0​(∥VˉFn+1​(X,e)h^∥)ds(X).
  prefs: []
  type: TYPE_NORMAL
- en: Here, dPE(xn(X),e) is the point-edge distance between xn(X) and edge e in the
    last time step, and VˉFn+1​(X,e) is the approximate relative sliding velocity
    of the point-edge pair with contact normal and the closest point discretized to
    the last time step (see next section for details).
  prefs: []
  type: TYPE_NORMAL
- en: 'If we choose boundary nodes as quadrature points to approximate the integral,
    we finally obtain our discrete friction potential:'
  prefs: []
  type: TYPE_NORMAL
- en: Pf​(x)​=a^∑​Aa^​e∈E−I(Xa^​)∑​21​μ(−∂d∂b(dPE(xa^n​,e),d^)​)f0​(∥VˉFn+1​(Xa^​,e)h^∥)=k∈{(a^,e)}∑​μλkn​f0​(∥vˉk​h^∥)​
  prefs: []
  type: TYPE_NORMAL
- en: where Aa^​=2∥Xa^​−Xa^−1​∥+∥Xa^​−Xa^+1​∥​ is the integration weight. Denoting
    vˉk​=VˉFn+1​(Xa^​,e) and λkn​=21​Aa^​(−∂d∂b(dPE(xa^n​,e),d^)​), the expression
    of Pf​ agrees with the discrete form of Equation [(9.2.1)](lec9.2-semi_imp_fric.html#eq:lec9:fric_potential)
    we directly derived, except that here k traverses all non-incident point-edge
    pairs on the boundary.
  prefs: []
  type: TYPE_NORMAL
- en: Based on this discrete form of the smoothed semi-implicit friction potential,
    we now need to determine how to calculate λ and vˉ for point-edge pairs, implement
    the computation of the value, gradient, and Hessian of Pf​(x), and then incorporate
    them into the optimization.
  prefs: []
  type: TYPE_NORMAL
