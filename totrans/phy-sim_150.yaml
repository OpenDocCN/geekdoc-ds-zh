- en: Frictional Contact on Material Particles
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec28.2-contact_on_particles.html](https://phys-sim-book.github.io/lec28.2-contact_on_particles.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: 'Previously, we discussed applying boundary conditions directly on the Eulerian
    grid nodes. While this approach is natural due to the grid nodes being the true
    degrees of freedom (DOFs) where Newton''s second law is enforced, it suffers from
    several inherent issues:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Normal Estimation Error**: For coarse grids, estimating accurate surface
    normals becomes challenging, potentially resulting in incorrect contact responses.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Contact gap (dx gap)**: Grid-based collision handling responds even when
    grid nodes are within approximately one grid cell spacing from collision surfaces,
    leading to visible gaps and earlier collision responses.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Given that the Material Point Method (MPM) discretizes solids directly into
    a set of material particles, it is more intuitive—and potentially more accurate—to
    handle frictional contact directly at the particle level. However, it is not physically
    consistent to simply compute collision forces and friction at particles and then
    directly transfer them (via P2G) to the grid, because this naïve approach bypasses
    the correct enforcement of Newton’s second law on the grid DOFs, potentially resulting
    in unphysical responses, particularly failing to properly enforce static friction
    constraints.
  prefs: []
  type: TYPE_NORMAL
- en: Instead, a more robust strategy is to formulate the frictional contact problem
    at the grid level explicitly as an optimization problem, taking advantage of the
    particle-based definition of collision energies or penalty functions. This leads
    us to adopt a two-stage time-splitting numerical scheme.
  prefs: []
  type: TYPE_NORMAL
- en: '[Two-Stage Time-splitting Optimization Scheme](#two-stage-time-splitting-optimization-scheme)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '**Stage 1: Free-motion velocity**'
  prefs: []
  type: TYPE_NORMAL
- en: In the first stage, we ignore contact constraints entirely and compute the intermediate
    "free-motion" nodal velocity vi∗​ on grid nodes, which would occur in the absence
    of any contact forces. These velocities can be conveniently obtained via a standard
    [symplectic Euler](./lec26.3-euler_lag_transfers.html) time integration step.
  prefs: []
  type: TYPE_NORMAL
- en: '**Stage 2: Frictional Contact via Optimization**'
  prefs: []
  type: TYPE_NORMAL
- en: 'In the second stage, frictional contact is enforced by solving a constrained
    linearized momentum balance around the free-motion velocity v∗:'
  prefs: []
  type: TYPE_NORMAL
- en: M(vin+1​−vi∗​)=hJT(xpn​)γ(vin+1​).
  prefs: []
  type: TYPE_NORMAL
- en: 'Here:'
  prefs: []
  type: TYPE_NORMAL
- en: M is the mass matrix.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'J is the contact Jacobian defined at the particle level, it maps grid nodal
    velocities to particle-level contact velocities. Specifically, each contacting
    particle j contributes a local Jacobian matrix: Jj​=∂vi​∂vc,j​​∈R3×nv​. Stacking
    all these individual Jacobians produces the global contact Jacobian J∈R3nc​×nv​,
    which collectively relates all particle contact velocities vc​ to grid velocities
    v as: vc​=Jvi​. Intuitively, J can be understood as a special Grid-to-Particle
    (G2P) transfer operator linearized at the current configuration, directly encoding
    how infinitesimal changes in grid nodal velocities affect the particle velocities
    (normal and tangential components) at contact points.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: γ(vin+1​) represents contact forces (normal and tangential) subject to friction
    cone constraints.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'This linear system can be reformulated into an **unconstrained optimization
    problem**:'
  prefs: []
  type: TYPE_NORMAL
- en: vi​min​ℓ(vi​)=21​∥vi​−vi∗​∥M2​+ℓc​(vc​(vi​)).
  prefs: []
  type: TYPE_NORMAL
- en: Possible contact energy formulations for ℓc​ include the [Logarithm Barrier
    Potential](./lec7.2-dist_barrier_formulation.html) and [Semi-Implicit Friction](./lec9.2-semi_imp_fric.html).
  prefs: []
  type: TYPE_NORMAL
