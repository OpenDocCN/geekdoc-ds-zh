- en: Frictional Contact on Material Particles
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 材料粒子的摩擦接触
- en: 原文：[https://phys-sim-book.github.io/lec28.2-contact_on_particles.html](https://phys-sim-book.github.io/lec28.2-contact_on_particles.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec28.2-contact_on_particles.html](https://phys-sim-book.github.io/lec28.2-contact_on_particles.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: 'Previously, we discussed applying boundary conditions directly on the Eulerian
    grid nodes. While this approach is natural due to the grid nodes being the true
    degrees of freedom (DOFs) where Newton''s second law is enforced, it suffers from
    several inherent issues:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 之前，我们讨论了直接在欧拉网格节点上应用边界条件。虽然这种方法由于网格节点是真正的自由度（DOFs）且牛顿第二定律在这些节点上得到实施，因此是自然的，但它存在几个固有的问题：
- en: '**Normal Estimation Error**: For coarse grids, estimating accurate surface
    normals becomes challenging, potentially resulting in incorrect contact responses.'
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**法线估计误差**：对于粗网格，估计准确表面法线变得具有挑战性，可能导致错误的接触响应。'
- en: '**Contact gap (dx gap)**: Grid-based collision handling responds even when
    grid nodes are within approximately one grid cell spacing from collision surfaces,
    leading to visible gaps and earlier collision responses.'
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**接触间隙（dx gap）**：基于网格的碰撞处理甚至在网格节点与碰撞表面大约一个网格单元间距内时也会响应，导致可见的间隙和较早的碰撞响应。'
- en: Given that the Material Point Method (MPM) discretizes solids directly into
    a set of material particles, it is more intuitive—and potentially more accurate—to
    handle frictional contact directly at the particle level. However, it is not physically
    consistent to simply compute collision forces and friction at particles and then
    directly transfer them (via P2G) to the grid, because this naïve approach bypasses
    the correct enforcement of Newton’s second law on the grid DOFs, potentially resulting
    in unphysical responses, particularly failing to properly enforce static friction
    constraints.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 由于材料点法（MPM）直接将固体离散成一组材料粒子，因此在粒子级别直接处理摩擦接触更直观——并且可能更准确。然而，简单地计算粒子上的碰撞力和摩擦力，然后直接通过
    P2G 转移到网格上，在物理上是不一致的，因为这种天真方法绕过了在网格 DOFs 上正确实施牛顿第二定律，可能导致非物理响应，尤其是未能正确实施静摩擦约束。
- en: Instead, a more robust strategy is to formulate the frictional contact problem
    at the grid level explicitly as an optimization problem, taking advantage of the
    particle-based definition of collision energies or penalty functions. This leads
    us to adopt a two-stage time-splitting numerical scheme.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 相反，一种更稳健的策略是在网格级别明确地将摩擦接触问题表述为一个优化问题，利用基于粒子的碰撞能量或罚函数的定义。这使我们采用两阶段时间分裂数值方案。
- en: '[Two-Stage Time-splitting Optimization Scheme](#two-stage-time-splitting-optimization-scheme)'
  id: totrans-8
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[两阶段时间分裂优化方案](#two-stage-time-splitting-optimization-scheme)'
- en: '**Stage 1: Free-motion velocity**'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '**阶段 1：自由运动速度**'
- en: In the first stage, we ignore contact constraints entirely and compute the intermediate
    "free-motion" nodal velocity vi∗​ on grid nodes, which would occur in the absence
    of any contact forces. These velocities can be conveniently obtained via a standard
    [symplectic Euler](./lec26.3-euler_lag_transfers.html) time integration step.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在第一阶段，我们完全忽略接触约束，并在网格节点上计算中间的“自由运动”节点速度 vi∗，这些速度在没有任何接触力的情况下会发生。这些速度可以通过标准的
    [辛普森欧拉法](./lec26.3-euler_lag_transfers.html) 时间积分步骤方便地获得。
- en: '**Stage 2: Frictional Contact via Optimization**'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '**阶段 2：通过优化实现摩擦接触**'
- en: 'In the second stage, frictional contact is enforced by solving a constrained
    linearized momentum balance around the free-motion velocity v∗:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在第二阶段，通过求解围绕自由运动速度 v∗ 的约束线性化动量平衡来实施摩擦接触：
- en: M(vin+1​−vi∗​)=hJT(xpn​)γ(vin+1​).
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: M(vin+1−vi∗)=hJT(xpn​)γ(vin+1​).
- en: 'Here:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里：
- en: M is the mass matrix.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: M 是质量矩阵。
- en: 'J is the contact Jacobian defined at the particle level, it maps grid nodal
    velocities to particle-level contact velocities. Specifically, each contacting
    particle j contributes a local Jacobian matrix: Jj​=∂vi​∂vc,j​​∈R3×nv​. Stacking
    all these individual Jacobians produces the global contact Jacobian J∈R3nc​×nv​,
    which collectively relates all particle contact velocities vc​ to grid velocities
    v as: vc​=Jvi​. Intuitively, J can be understood as a special Grid-to-Particle
    (G2P) transfer operator linearized at the current configuration, directly encoding
    how infinitesimal changes in grid nodal velocities affect the particle velocities
    (normal and tangential components) at contact points.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: J是定义在粒子层面的接触雅可比矩阵，它将网格节点速度映射到粒子层面的接触速度。具体来说，每个接触粒子j贡献一个局部雅可比矩阵：Jj​=∂vi​∂vc,j​​∈R3×nv​。将这些单个雅可比矩阵堆叠起来产生全局接触雅可比矩阵J∈R3nc×nv​，它将所有粒子接触速度vc与网格速度v相关联：vc=Jvi​。直观上，J可以理解为在当前配置下线性化的特殊网格到粒子（G2P）转移算子，直接编码了网格节点速度的无限小变化如何影响接触点的粒子速度（法向和切向分量）。
- en: γ(vin+1​) represents contact forces (normal and tangential) subject to friction
    cone constraints.
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: γ(vin+1​)表示在摩擦锥约束下的接触力（法向和切向）。
- en: 'This linear system can be reformulated into an **unconstrained optimization
    problem**:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 这个线性系统可以被重新表述为一个**无约束优化问题**：
- en: vi​min​ℓ(vi​)=21​∥vi​−vi∗​∥M2​+ℓc​(vc​(vi​)).
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: vi​minℓ(vi​)=21∥vi​−vi∗∥M2+ℓc​(vc​(vi​)).
- en: Possible contact energy formulations for ℓc​ include the [Logarithm Barrier
    Potential](./lec7.2-dist_barrier_formulation.html) and [Semi-Implicit Friction](./lec9.2-semi_imp_fric.html).
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 对于ℓc​可能的接触能量公式包括[对数障碍势能](./lec7.2-dist_barrier_formulation.html)和[半隐式摩擦](./lec9.2-semi_imp_fric.html)。
