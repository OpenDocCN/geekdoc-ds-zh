- en: DOF Elimination Method
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec5.2-DOF_elimin.html](https://phys-sim-book.github.io/lec5.2-DOF_elimin.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: Considering the simplest sticky Dirichlet boundary condition as an example,
    its constraint Jacobian \( A \) acts as a selection matrix. Consequently, \( AA^T
    \) forms a \( m \times m \) identity matrix, and \( A^T A \) becomes a \( dn \times
    dn \) diagonal matrix. In this matrix, the entries corresponding to the BC nodes
    are one, and all other entries are zero.
  prefs: []
  type: TYPE_NORMAL
- en: 'When we left-multiply \( A \) to the first block row of Equation [(5.1.3)](lec5.1-equality_constraints.html#eq:lec5:BC_KKT),
    the resulting equation is:'
  prefs: []
  type: TYPE_NORMAL
- en: '[AHA​AAT​][Δxλ​]=[−Ag0​].'
  prefs: []
  type: TYPE_NORMAL
- en: 'This manipulation allows us to directly solve for \( \lambda \) as:'
  prefs: []
  type: TYPE_NORMAL
- en: λ=−AHΔx−Ag.(5.2.1)
  prefs: []
  type: TYPE_NORMAL
- en: 'By substituting Equation [(5.2.1)](#eq:lec5:BC_lambda) back into the first
    block row of Equation [(5.1.3)](lec5.1-equality_constraints.html#eq:lec5:BC_KKT),
    we derive the following equation:'
  prefs: []
  type: TYPE_NORMAL
- en: (I−ATA)HΔx=(I−ATA)(−g).(5.2.2)
  prefs: []
  type: TYPE_NORMAL
- en: 'Here, left-multiplying by \((I - A^T A)\) effectively zeroes out the rows corresponding
    to the BC nodes. Hence, Equation [(5.2.2)](#eq:lec5:BC_lambda_solved) represents
    an under-constrained system. However, the second block row of Equation [(5.1.3)](lec5.1-equality_constraints.html#eq:lec5:BC_KKT)
    actually provides us with the values of \(\Delta x\) at the BC nodes (so they
    are not really unknowns). By considering this information, we can rewrite Equation
    [(5.2.2)](#eq:lec5:BC_lambda_solved) into a Symmetric Positive Definite (SPD)
    system:'
  prefs: []
  type: TYPE_NORMAL
- en: HUB​ΔxB​+HUU​ΔxU​=−gU​,
  prefs: []
  type: TYPE_NORMAL
- en: 'where the matrices and vectors are partitioned as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: H=[HBB​HUB​​HBU​HUU​​],Δx=[ΔxB​ΔxU​​],g=[gB​gU​​],
  prefs: []
  type: TYPE_NORMAL
- en: 'and the subscript \(B\) denotes the BC nodes. Knowing that \(\Delta x_B = 0\),
    the system simplifies to:'
  prefs: []
  type: TYPE_NORMAL
- en: HUU​ΔxU​=−gU​,(5.2.3)
  prefs: []
  type: TYPE_NORMAL
- en: which represents a SPD system that excludes the BC nodes.
  prefs: []
  type: TYPE_NORMAL
- en: '[A More Practical Approach](#a-more-practical-approach)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The method outlined above serves primarily for mathematical explanation. In
    practical applications, constructing Equation [(5.2.3)](#eq:lec5:BC_final_system)
    is often avoided. This is because it entails reordering degrees of freedom (DOFs)
    and separating the BC nodes from unconstrained nodes, a process that can be both
    tedious and inefficient, particularly when the set of Dirichlet nodes varies over
    time.
  prefs: []
  type: TYPE_NORMAL
- en: To circumvent the need to reorder DOFs, a direct modification of the original
    linear system can be made to align it with Equation [(5.2.3)](#eq:lec5:BC_final_system).
    This adjustment involves setting all entries in the rows corresponding to BC nodes
    in \( H \) and \( g \) to \( 0 \). Additionally, for the columns associated with
    BC nodes in \( H \), all off-diagonal entries are set to \( 0 \) while diagonal
    entries are assigned \( 1 \) or another positive real number to ensure the system
    remains well-conditioned. After solving this modified system, the resulting values
    of \( \Delta x_U \) are immediately aquired, and all \( \Delta x_B \) values are
    guaranteed to be \( 0 \).
  prefs: []
  type: TYPE_NORMAL
- en: '**Example 5.2.1 (DOF Elimination).** For the problem defined in [Example 5.1.1](lec5.1-equality_constraints.html#exp:lec5:dbc)
    where the second node \((x_{21}, x_{22})\) is fixed at \((1,2)\) in a 2D two-node
    system, assuming in a certain iteration of a time step H=​4−1−1−1​−14−1−1​−1−14−1​−1−1−14​​,andg=​1234​​,
    we solve the system ​4−100​−1400​0010​0001​​​Δx11​Δx12​Δx21​Δx22​​​=​−1−200​​.(5.2.4)
    for search direction \(\Delta x\) so that \(\Delta x_{21} = \Delta x_{22} = 0\)
    and after line search we for sure know that \((x_{21}, x_{22}) = (1, 2)\) still
    holds since (x21​+αΔx21​,x22​+αΔx22​)=(x21​,x22​). Here [(5.2.4)](#eq:sec5:BC_projected_system)
    is essentially [HUU​​I​][ΔxU​ΔxB​​]=[−gU​0​]'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '***Remark 5.2.1 (Limitations of DOF Elimination).*** The DOF elimination method
    described is effective when sticky BC nodes are established at the beginning of
    the time step. However, if this is not the case, and the constraint function in
    Equation [(5.1.3)](lec5.1-equality_constraints.html#eq:lec5:BC_KKT) has a non-zero
    right-hand side (rhs), the DOF elimination method becomes inapplicable. The issue
    here is not the inability to solve for \( \Delta x \) under constraints with a
    non-zero rhs. Rather, the concern is that the resulting \( \Delta x \) might not
    lead to a descent direction in the Incremental Potential. This can result in exceedingly
    small step sizes after a line search, potentially stalling the optimization process.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Intuitively, if the direction of \( \Delta x_B \) is towards the prescribed
    BC coordinates, it could inadvertently increase the Incremental Potential, which
    is not adjusted to consider the BCs. Conversely, if \( \Delta x_B \) is simply
    \( 0 \) when the BCs are already satisfied, it effectively minimizes the Incremental
    Potential using a subset of variables, which remains a valid approach.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: One might then ask why not adjust the DOFs to meet the BCs before starting the
    optimization. However, this strategy could lead to infeasible configurations,
    such as those involving intersections. A viable alternative is to initially apply
    stiff spring forces to gradually 'drag' the BC nodes to their constrained positions
    during optimization. After this, switching to the DOF elimination method can enhance
    convergence. This technique is further discussed in the section [Moving Boundary
    Conditions*](lec11-mov_DBC.html).
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
