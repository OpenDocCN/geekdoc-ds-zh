<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Online Appendix E — R Markdown</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Online Appendix E — R Markdown</h1>
<blockquote>原文：<a href="https://tellingstorieswithdata.com/24-rmarkdown.html">https://tellingstorieswithdata.com/24-rmarkdown.html</a></blockquote>

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./20-r_essentials.html">Appendices</a></li><li class="breadcrumb-item"><a href="./24-rmarkdown.html"><span class="chapter-number">E</span>  <span class="chapter-title">R Markdown</span></a></li></ol></nav>
<div class="quarto-title">

</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Quarto is the successor to R Markdown, however it is relatively new and many people still use R Markdown. For the most part, the aspects covered in <a href="03-workflow.html" class="quarto-xref"><span>Chapter 3</span></a> apply for both Quarto and R Markdown. However, in this appendix we provide an equivalent for R Markdown, for the guidance provided for Quarto, where there are aspects that differ.</p>
<section id="r-chunks" class="level2" data-number="E.1">
<h2 data-number="E.1" class="anchored" data-anchor-id="r-chunks"><span class="header-section-number">E.1</span> R chunks</h2>
<p>We can include code for R and many other languages in code chunks within an R Markdown document. Then when we knit the document, the code will run and be included in the document.</p>
<p>To create an R chunk, we start with three backticks and then within curly braces we tell R Markdown that this is an R chunk. Anything inside this chunk will be considered R code and run as such. For instance, we could load the <code>tidyverse</code> and <code>AER</code> and make a graph of the number of times a survey respondent visited the doctor in the past two weeks.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>```{r}
library(tidyverse)
library(AER)

data("DoctorVisits", package = "AER")

DoctorVisits |&gt;
  ggplot(aes(x = illness)) +
  geom_histogram(stat = "count")
```</code></pre>
</div>
</div>
<p>The output of that code is <a href="03-workflow.html#fig-doctervisits" class="quarto-xref">Figure <span>3.1</span></a></p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../Images/fea3d502a7503de9e0f6f6d602220d17.png" class="img-fluid figure-img" width="672" data-original-src="https://tellingstorieswithdata.com/24-rmarkdown_files/figure-html/doctervisits-1.png"/></p>
<figcaption>Number of illnesses in the past two weeks, based on the 1977–1978 Australian Health Survey</figcaption>
</figure>
</div>
</div>
</div>
<p>Notice that in contrast to Quarto, all the options go between curly braces in the top line. It is not possible to use the comment notation of Quarto.</p>
</section>
<section id="cross-references" class="level2" data-number="E.2">
<h2 data-number="E.2" class="anchored" data-anchor-id="cross-references"><span class="header-section-number">E.2</span> Cross-references</h2>
<p>It can be useful to cross-reference figures, tables, and equations. This makes it easier to refer to them in the text. To do this for a figure we refer to the name of the R chunk that creates or contains the figure. For instance, <code>(Figure \@ref(fig:uniquename))</code> will produce: (<a href="03-workflow.html#fig-uniquename" class="quarto-xref">Figure <span>3.2</span></a>) as the name of the R chunk is <code>uniquename</code>. We also need to add ‘fig’ in front of the chunk name so that R Markdown knows that this is a figure. We then include a ‘fig.cap’ in the R chunk that specifies a caption.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"/><span class="in">```{r uniquename, fig.cap = "Number of illnesses in the past two weeks, based on the 1977--1978 Australian Health Survey", echo = TRUE}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"/></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"/><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"/><span class="fu">library</span>(AER)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"/></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"/><span class="fu">data</span>(<span class="st">"DoctorVisits"</span>, <span class="at">package =</span> <span class="st">"AER"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"/></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"/>DoctorVisits <span class="sc">|&gt;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"/>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> illness)) <span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"/>  <span class="fu">geom_histogram</span>(<span class="at">stat =</span> <span class="st">"count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"/></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../Images/534ae4780883ed6a61c57f477b332c80.png" class="img-fluid figure-img" width="672" data-original-src="https://tellingstorieswithdata.com/24-rmarkdown_files/figure-html/uniquename-1.png"/></p>
<figcaption>Number of illnesses in the past two weeks, based on the 1977–1978 Australian Health Survey</figcaption>
</figure>
</div>
</div>
</div>
<p>We can take a similar, but slightly different, approach to cross-reference tables. For instance, <code>(Table \@ref(tab:docvisittablermarkdown))</code> will produce: (<a href="#tbl-docvisittablermarkdown" class="quarto-xref">Table <span>E.1</span></a>). In this case we specify ‘tab’ before the unique reference to the table, so that R Markdown knows that it is a table. For tables we need to include the caption in the main content, as a ‘caption’, rather than in a ‘fig.cap’ chunk option as is the case for figures.</p>
<div class="cell">
<div id="tbl-docvisittablermarkdown" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-docvisittablermarkdown-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table E.1: Number of visits to the doctor in the past two weeks, based on the 1977–1978 Australian Health Survey
</figcaption>
<div aria-describedby="tbl-docvisittablermarkdown-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">visits</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">4141</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">782</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">174</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Finally, we can also cross-reference equations. To that we need to add a tag <code>(\#eq:macroidentity)</code> which we then reference. For instance, use <code>Equation \@ref(eq:macroidentity).</code> to produce (<a href="#eq-gdpmacroidentity" class="quarto-xref">Equation <span>E.1</span></a>)</p>
<pre><code>\begin{equation}
Y = C + I + G + (X - M) (\#eq:macroidentity)
\end{equation}</code></pre>
<p><span id="eq-gdpmacroidentity"><span class="math display">\[
Y = C + I + G + (X - M)
\tag{E.1}\]</span></span></p>
<p>When using cross-references ensure that the R chunks have simple labels. In general, try to keep the names simple but unique, and if possible, avoid punctuation and stick to letters. Do not use underbars in the labels because that will cause an error.</p>


</section>

    
</body>
</html>