- en: Discrete Space
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec17.1-discrete_space.html](https://phys-sim-book.github.io/lec17.1-discrete_space.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: To enable numerical evaluation of the integrals in the weak form, the first
    step is to discretize the smooth vector fields x and Q. This allows them to be
    represented by a finite set of samples, along with appropriate interpolation functions.
  prefs: []
  type: TYPE_NORMAL
- en: '****Example 17.1.1 (1D Function Interpolation).**** In 1D, to approximate a
    function f(x) using three sample points x1​=1, x2​=2, x3​=3 ([Figure 17.1.1](#fig:lec17:1d_interpolation)),
    we can use interpolation functions Ni​(x)=1−∣x−xi​∣ and form f(x)≈∑i​f(xi​)Ni​(x).'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![](../Images/6f8a7ab7f29fb6e103f6121f2165d66a.png)'
  prefs:
  - PREF_BQ
  type: TYPE_IMG
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Figure 17.1.1.** With interpolation functions N1​(x), N2​(x), N3​(x) and
    sample points x1​=1, x2​=2, x3​=3, a function f(x) can be approximated as ∑i​f(xi​)Ni​(x).'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Given a set of sample points indexed by a or b in the simulation domain, we
    can approximate the test function Q and the DOF x as: Qi​(X,tn)xi​(X,tn)​≈a∑​Qa∣i​(tn)Na​(X)=a∑​Qa∣in​Na​(X),≈b∑​xb∣i​(tn)Nb​(X)=b∑​xb∣in​Nb​(X),​
    where Qa∣in​=Qa∣i​(tn) refers to the i-th dimension of Q evaluated at sample point
    a at time tn, and Na​(X):Ω0→R is the interpolation function at sample point a.
    In this way, we similarly have: Ai​(X,tn)≈b∑​Ab∣i​(tn)Nb​(X)=b∑​Ab∣in​Nb​(X).(17.1.1)
    Plugging these discretizations into the weak form (Equation [(17.1)](lec17-disc_weak_form.html#eq:lec17:weakform_lagrangian_tn))
    and expressing summations with the index notation, we obtain: ​∫Ω0​R(X,0)Qa∣in​Na​(X)Ab∣in​Nb​(X)dX=∫∂Ω0​Qa∣in​Na​(X)Ti​(X,tn)ds(X)−∫Ω0​Qa∣in​Na,j​(X)Pij​(X,tn)dX.​
    On the left-hand side, we see that the sample values Qa∣in​ and Ab∣in​ are in
    fact independent of X, so we can move them out of the integral and obtain: ​Mab​Qa∣in​Ab∣in​=∫∂Ω0​Qa∣in​Na​(X)Ti​(X,tn)ds(X)−∫Ω0​Qa∣in​Na,j​(X)Pij​(X,tn)dX​
    where Mab​=∫Ω0​R(X,0)Na​(X)Nb​(X)dX(17.1.2) is the mass matrix.'
  prefs: []
  type: TYPE_NORMAL
- en: '***Remark 17.1.1 (Mass Matrix Properties).*** The mass matrix M (Equation [(17.1.2)](#eq:lec17:mass_matrix))
    is symmetric and positive semi-definite because it can be expressed as: ∫Ω0​BBTdX,
    where Bi​=R(X,0)​Ni​(X). Thus, for any vector z, zTMz=∫Ω0​(zTB)2dX≥0. In practice,
    this mass matrix may be singular. To address this, we typically use a "mass lumping"
    strategy to approximate the mass matrix with a diagonal and positive definite
    form. This is achieved by summing each row and defining: Mablump​=δab​c∑​Mac​.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: After spatial discretization, the solution of the weak form (Equation [(17.1)](lec17-disc_weak_form.html#eq:lec17:weakform_lagrangian_tn))
    is confined to d n-dimensional function spaces, where n represents the number
    of sample points, assuming all interpolation functions are mutually orthogonal.
    This means that there could be continuous solutions to the weak form outside of
    our solution space. In such cases, we can only provide an approximate solution
    based on the chosen sample points and interpolation functions.
  prefs: []
  type: TYPE_NORMAL
- en: '****Definition 17.1.1 (Orthogonal Functions).**** Similar to the orthogonality
    of two vectors a and b, defined as aTb=0, the orthogonality of two functions f(x)
    and g(x) is defined as: ∫f(x)g(x)dx=0. Just as a basis of vectors can span a finite-dimensional
    space, orthogonal functions can form an infinite basis for a function space. Conceptually,
    the integral above is analogous to a vector dot product.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'That being said, to generate equations solvable for the unknowns, the arbitrary
    test function Q does not need to cover all possibilities to produce an infinite
    number of equations. Instead, we only need to produce a finite set of equations
    that spans the entire solution space. Therefore, for a^ traversing all sample
    points, and i^=1,2,…,d, we can assign the test function: Qa∣in​={1,0,​a=a^ and i=i^otherwise​
    to obtain nd equations: Ma^b​Ab∣i^n​=∫∂Ω0​Na^​(X)Ti^​(X,tn)ds(X)−∫Ω0​Na^,j​(X)Pi^j​(X,tn)dX,(17.1.3)
    resulting in nd unknowns and nd equations, bringing us closer to the discrete
    form.'
  prefs: []
  type: TYPE_NORMAL
- en: The two integrals on the right side of Equation [(17.1.3)](#eq:lec17:test_func_chosen)
    can be evaluated analytically or using quadrature rules, depending on the specific
    choice of interpolation functions. We will discuss these in detail in future lectures.
  prefs: []
  type: TYPE_NORMAL
