- en: '6.5\. Application: linear-Gaussian models and Kalman filtering#'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 6.5\. 应用：线性高斯模型和卡尔曼滤波#
- en: 原文：[https://mmids-textbook.github.io/chap06_prob/05_kalman/roch-mmids-prob-kalman.html](https://mmids-textbook.github.io/chap06_prob/05_kalman/roch-mmids-prob-kalman.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://mmids-textbook.github.io/chap06_prob/05_kalman/roch-mmids-prob-kalman.html](https://mmids-textbook.github.io/chap06_prob/05_kalman/roch-mmids-prob-kalman.html)
- en: In this section, we illustrate the use of linear-Gaussian models for object
    tracking. We first give some background.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们说明了线性高斯模型在目标跟踪中的应用。我们首先给出一些背景信息。
- en: '6.5.1\. Multivariate Gaussians: marginals and conditionals[#](#multivariate-gaussians-marginals-and-conditionals
    "Link to this heading")'
  id: totrans-3
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 6.5.1\. 多变量高斯分布：边缘和条件分布[#](#multivariate-gaussians-marginals-and-conditionals
    "链接到本标题")
- en: We will need the marginal and conditional densities of a multivariate Gaussian.
    For this purpose, we require various formulas and results about block matrices.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将需要多变量高斯分布的边缘和条件密度。为此，我们需要各种关于块矩阵的公式和结果。
- en: '**Properties of block matrices** Recall that block matrices have a convenient
    algebra that mimics the usual matrix algebra. Consider a square block matrix with
    the same partitioning of the rows and columns, that is,'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '**块矩阵的性质** 回想一下，块矩阵有一个方便的代数，类似于通常的矩阵代数。考虑一个具有相同行和列划分的平方块矩阵，即，'
- en: \[\begin{split} A = \begin{pmatrix} A_{11} & A_{12}\\ A_{21} & A_{22} \end{pmatrix}
    \end{split}\]
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A = \begin{pmatrix} A_{11} & A_{12}\\ A_{21} & A_{22} \end{pmatrix}
    \end{split}\]
- en: where \(A \in \mathbb{R}^{n \times n}\), \(A_{ij} \in \mathbb{R}^{n_i \times
    n_j}\) for \(i, j = 1, 2\) with the condition \(n_1 + n_2 = n\). Then it is straightforward
    to check (try it!) that the transpose can be written as
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(A \in \mathbb{R}^{n \times n}\)，\(A_{ij} \in \mathbb{R}^{n_i \times n_j}\)
    对于 \(i, j = 1, 2\)，且满足条件 \(n_1 + n_2 = n\)。然后可以简单地检查（试试看！）转置可以写成
- en: \[\begin{split} A^T = \begin{pmatrix} A_{11}^T & A_{21}^T\\ A_{12}^T & A_{22}^T
    \end{pmatrix}. \end{split}\]
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A^T = \begin{pmatrix} A_{11}^T & A_{21}^T\\ A_{12}^T & A_{22}^T
    \end{pmatrix}. \end{split}\]
- en: In particular, if \(A\) is symmetric then \(A_{11} = A_{11}^T\), \(A_{22} =
    A_{22}^T\) and \(A_{21} = A_{12}^T\).
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 特别地，如果 \(A\) 是对称的，那么 \(A_{11} = A_{11}^T\)，\(A_{22} = A_{22}^T\)，且 \(A_{21}
    = A_{12}^T\)。
- en: '**EXAMPLE:** For instance, consider the \(\mathbf{z} = (\mathbf{z}_1, \mathbf{z}_2)\),
    where \(\mathbf{z}_1 \in \mathbb{R}^{n_1}\) and \(\mathbf{z}_2 \in \mathbb{R}^{n_2}\).
    We want to compute the quadratic form'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例：** 例如，考虑 \(\mathbf{z} = (\mathbf{z}_1, \mathbf{z}_2)\)，其中 \(\mathbf{z}_1
    \in \mathbb{R}^{n_1}\) 和 \(\mathbf{z}_2 \in \mathbb{R}^{n_2}\)。我们想要计算二次型'
- en: \[\begin{split} \mathbf{z}^T \begin{pmatrix} A_{11} & A_{12}\\ A_{12}^T & A_{22}
    \end{pmatrix} \mathbf{z} \end{split}\]
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{z}^T \begin{pmatrix} A_{11} & A_{12}\\ A_{12}^T & A_{22}
    \end{pmatrix} \mathbf{z} \end{split}\]
- en: where \(A_{ij} \in \mathbb{R}^{n_i \times n_j}\) for \(i,j = 1, 2\) with the
    conditions \(n_1 + n_2 = n\), and \(A_{11}^T = A_{11}\) and \(A_{22}^T = A_{22}\).
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(A_{ij} \in \mathbb{R}^{n_i \times n_j}\) 对于 \(i,j = 1, 2\)，且满足条件 \(n_1
    + n_2 = n\)，以及 \(A_{11}^T = A_{11}\) 和 \(A_{22}^T = A_{22}\)。
- en: We apply the block matrix product formula twice to get
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应用块矩阵乘法公式两次得到
- en: \[\begin{align*} &(\mathbf{z}_1, \mathbf{z}_2)^T \begin{pmatrix} A_{11} & A_{12}\\
    A_{12}^T & A_{22} \end{pmatrix} (\mathbf{z}_1, \mathbf{z}_2)\\ &= (\mathbf{z}_1,
    \mathbf{z}_2)^T \begin{pmatrix} A_{11} \mathbf{z}_1 + A_{12} \mathbf{z}_2\\ A_{12}^T
    \mathbf{z}_1 + A_{22} \mathbf{z}_2 \end{pmatrix}\\ &= \mathbf{z}_1^T A_{11} \mathbf{z}_1
    + \mathbf{z}_1^T A_{12} \mathbf{z}_2 + \mathbf{z}_2^T A_{12}^T \mathbf{z}_1 +
    \mathbf{z}_2^T A_{22} \mathbf{z}_2\\ &= \mathbf{z}_1^T A_{11} \mathbf{z}_1 + 2
    \mathbf{z}_1^T A_{12} \mathbf{z}_2 + \mathbf{z}_2^T A_{22} \mathbf{z}_2. \end{align*}\]
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &(\mathbf{z}_1, \mathbf{z}_2)^T \begin{pmatrix} A_{11} & A_{12}\\
    A_{12}^T & A_{22} \end{pmatrix} (\mathbf{z}_1, \mathbf{z}_2)\\ &= (\mathbf{z}_1,
    \mathbf{z}_2)^T \begin{pmatrix} A_{11} \mathbf{z}_1 + A_{12} \mathbf{z}_2\\ A_{12}^T
    \mathbf{z}_1 + A_{22} \mathbf{z}_2 \end{pmatrix}\\ &= \mathbf{z}_1^T A_{11} \mathbf{z}_1
    + \mathbf{z}_1^T A_{12} \mathbf{z}_2 + \mathbf{z}_2^T A_{12}^T \mathbf{z}_1 +
    \mathbf{z}_2^T A_{22} \mathbf{z}_2\\ &= \mathbf{z}_1^T A_{11} \mathbf{z}_1 + 2
    \mathbf{z}_1^T A_{12} \mathbf{z}_2 + \mathbf{z}_2^T A_{22} \mathbf{z}_2. \end{align*}\]
- en: \(\lhd\)
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: \(\lhd\)
- en: '**EXAMPLE:** Let \(A_{ii} \in \mathbb{R}^{n_i \times n_i}\) for \(i = 1, 2\)
    be invertible. We claim that'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例：** 设 \(A_{ii} \in \mathbb{R}^{n_i \times n_i}\) 对于 \(i = 1, 2\) 是可逆的。我们声称'
- en: \[\begin{split} \begin{pmatrix} A_{11} & \mathbf{0}\\ \mathbf{0} & A_{22} \end{pmatrix}^{-1}
    = \begin{pmatrix} A_{11}^{-1} & \mathbf{0}\\ \mathbf{0} & A_{22}^{-1} \end{pmatrix}.
    \end{split}\]
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} A_{11} & \mathbf{0}\\ \mathbf{0} & A_{22} \end{pmatrix}^{-1}
    = \begin{pmatrix} A_{11}^{-1} & \mathbf{0}\\ \mathbf{0} & A_{22}^{-1} \end{pmatrix}.
    \end{split}\]
- en: The matrix on the right-hand side is well-defined by the invertibility of \(A_{11}\)
    and \(A_{22}\). We check the claim using the formula for matrix products of block
    matrices. The matrices above are block diagonal.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 右侧的矩阵由 \(A_{11}\) 和 \(A_{22}\) 的可逆性定义良好。我们使用分块矩阵的矩阵乘积公式来验证这个命题。上面的矩阵是分块对角矩阵。
- en: Indeed, we obtain
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 事实上，我们得到
- en: \[\begin{align*} &\begin{pmatrix} A_{11} & \mathbf{0}\\ \mathbf{0} & A_{22}
    \end{pmatrix} \begin{pmatrix} A_{11}^{-1} & \mathbf{0}\\ \mathbf{0} & A_{22}^{-1}
    \end{pmatrix}\\ &= \begin{pmatrix} A_{11} A_{11}^{-1} + \mathbf{0} & \mathbf{0}
    + \mathbf{0}\\ \mathbf{0} + \mathbf{0} & \mathbf{0} + A_{22} A_{22}^{-1} \end{pmatrix}
    = \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ \mathbf{0} & I_{n_2 \times
    n_2} \end{pmatrix} = I_{n \times n} \end{align*}\]
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &\begin{pmatrix} A_{11} & \mathbf{0}\\ \mathbf{0} & A_{22}
    \end{pmatrix} \begin{pmatrix} A_{11}^{-1} & \mathbf{0}\\ \mathbf{0} & A_{22}^{-1}
    \end{pmatrix}\\ &= \begin{pmatrix} A_{11} A_{11}^{-1} + \mathbf{0} & \mathbf{0}
    + \mathbf{0}\\ \mathbf{0} + \mathbf{0} & \mathbf{0} + A_{22} A_{22}^{-1} \end{pmatrix}
    = \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ \mathbf{0} & I_{n_2 \times
    n_2} \end{pmatrix} = I_{n \times n} \end{align*}\]
- en: and similarly for the other direction. \(\lhd\)
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 并且对于其他方向也有类似的结果。 \(\lhd\)
- en: '**EXAMPLE:** Let \(A_{21} \in \mathbb{R}^{n_2 \times n_1}\). Then we claim
    that'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例:** 设 \(A_{21} \in \mathbb{R}^{n_2 \times n_1}\)。那么我们声称'
- en: \[\begin{split} \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ A_{21} & I_{n_2
    \times n_2} \end{pmatrix}^{-1} = \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\
    - A_{21} & I_{n_2 \times n_2} \end{pmatrix}. \end{split}\]
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ A_{21} & I_{n_2
    \times n_2} \end{pmatrix}^{-1} = \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\
    - A_{21} & I_{n_2 \times n_2} \end{pmatrix}. \end{split}\]
- en: A similar formula holds for the block upper triangular case. In particular,
    such matrices are invertible (which can be proved in other ways, for instance
    through determinants).
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 对于分块上三角矩阵的情况，也有类似的公式。特别是，这样的矩阵是可逆的（可以通过其他方式证明，例如通过行列式）。
- en: 'It suffices to check:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 只需检查：
- en: \[\begin{align*} &\begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ A_{21} &
    I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\
    -A_{21} & I_{n_2 \times n_2} \end{pmatrix}\\ &= \begin{pmatrix} I_{n_1 \times
    n_1} I_{n_1 \times n_1} + \mathbf{0} & \mathbf{0} + \mathbf{0}\\ A_{21} I_{n_1
    \times n_1} + (-A_{21}) I_{n_1 \times n_1} & \mathbf{0} + I_{n_2 \times n_2} I_{n_2
    \times n_2} \end{pmatrix} = \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\
    \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix} = I_{n \times n} \end{align*}\]
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &\begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ A_{21} &
    I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\
    -A_{21} & I_{n_2 \times n_2} \end{pmatrix}\\ &= \begin{pmatrix} I_{n_1 \times
    n_1} I_{n_1 \times n_1} + \mathbf{0} & \mathbf{0} + \mathbf{0}\\ A_{21} I_{n_1
    \times n_1} + (-A_{21}) I_{n_1 \times n_1} & \mathbf{0} + I_{n_2 \times n_2} I_{n_2
    \times n_2} \end{pmatrix} = \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\
    \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix} = I_{n \times n} \end{align*}\]
- en: Taking a transpose gives a similar formula for the block upper triangular case.
    \(\lhd\)
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 取转置得到分块上三角矩阵情况的类似公式。 \(\lhd\)
- en: '**Inverting a block matrix** We will need a classical formula for inverting
    a block matrix. We start with the concept of a Schur complement.'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '**分块矩阵的求逆** 我们将需要一个关于分块矩阵求逆的经典公式。我们从Schur补的概念开始。'
- en: '**DEFINITION** **(Schur Complement)** \(\idx{Schur complement}\xdi\) Consider
    the matrix \(B \in \mathbb{R}^{n \times n}\) in block form'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: '**定义** **(Schur补)** \(\idx{Schur complement}\xdi\) 考虑矩阵 \(B \in \mathbb{R}^{n
    \times n}\) 以分块形式'
- en: \[\begin{split} B = \begin{pmatrix} B_{11} & B_{12}\\ B_{21} & B_{22} \end{pmatrix}
    \end{split}\]
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} B = \begin{pmatrix} B_{11} & B_{12}\\ B_{21} & B_{22} \end{pmatrix}
    \end{split}\]
- en: where \(B_{11} \in \mathbb{R}^{n_1 \times n_1}\), \(B_{22} \in \mathbb{R}^{n
    - n_1 \times n - n_1}\), \(B_{12} \in \mathbb{R}^{n_1 \times n - n_1}\), and \(B_{21}
    \in \mathbb{R}^{n - n_1 \times n_1}\). Then, provided \(B_{22}\) is invertible,
    the Schur complement of the block \(B_{22}\) is defined as the matrix
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(B_{11} \in \mathbb{R}^{n_1 \times n_1}\), \(B_{22} \in \mathbb{R}^{n -
    n_1 \times n - n_1}\), \(B_{12} \in \mathbb{R}^{n_1 \times n - n_1}\), 和 \(B_{21}
    \in \mathbb{R}^{n - n_1 \times n_1}\)。然后，如果 \(B_{22}\) 是可逆的，那么分块 \(B_{22}\) 的Schur补定义为矩阵
- en: \[ B/B_{22} := B_{11} - B_{12} B_{22}^{-1} B_{21}. \]
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: \[ B/B_{22} := B_{11} - B_{12} B_{22}^{-1} B_{21}. \]
- en: Similarly, provided \(B_{11}\) is invertible,
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，如果 \(B_{11}\) 是可逆的，
- en: \[ B/B_{11} := B_{22} - B_{21} B_{11}^{-1} B_{12}. \]
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: \[ B/B_{11} := B_{22} - B_{21} B_{11}^{-1} B_{12}. \]
- en: \(\natural\)
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: \(\natural\)
- en: '**LEMMA** **(Inverting a Block Matrix)** \(\idx{inverting a block matrix lemma}\xdi\)
    Consider the matrix \(B \in \mathbb{R}^{n \times n}\) in block form as'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: '**引理** **(分块矩阵的求逆)** \(\idx{inverting a block matrix lemma}\xdi\) 考虑矩阵 \(B
    \in \mathbb{R}^{n \times n}\) 以分块形式表示'
- en: \[\begin{split} B = \begin{pmatrix} B_{11} & B_{12}\\ B_{21} & B_{22} \end{pmatrix}
    \end{split}\]
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} B = \begin{pmatrix} B_{11} & B_{12}\\ B_{21} & B_{22} \end{pmatrix}
    \end{split}\]
- en: where \(B_{11} \in \mathbb{R}^{n_1 \times n_1}\), \(B_{22} \in \mathbb{R}^{n
    - n_1 \times n - n_1}\), \(B_{12} \in \mathbb{R}^{n_1 \times n - n_1}\), and \(B_{21}
    \in \mathbb{R}^{n - n_1 \times n_1}\). Then, provided \(B_{22}\) is invertible,
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(B_{11} \in \mathbb{R}^{n_1 \times n_1}\), \(B_{22} \in \mathbb{R}^{n -
    n_1 \times n - n_1}\), \(B_{12} \in \mathbb{R}^{n_1 \times n - n_1}\), 和 \(B_{21}
    \in \mathbb{R}^{n - n_1 \times n_1}\)。然后，假设 \(B_{22}\) 是可逆的，
- en: \[\begin{split} B^{-1} = \begin{pmatrix} (B/B_{22})^{-1} & - (B/B_{22})^{-1}
    B_{12} B_{22}^{-1}\\ - B_{22}^{-1} B_{21} (B/B_{22})^{-1} & B_{22}^{-1} B_{21}
    (B/B_{22})^{-1} B_{12} B_{22}^{-1} + B_{22}^{-1} \end{pmatrix}. \end{split}\]
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} B^{-1} = \begin{pmatrix} (B/B_{22})^{-1} & - (B/B_{22})^{-1}
    B_{12} B_{22}^{-1}\\ - B_{22}^{-1} B_{21} (B/B_{22})^{-1} & B_{22}^{-1} B_{21}
    (B/B_{22})^{-1} B_{12} B_{22}^{-1} + B_{22}^{-1} \end{pmatrix}. \end{split}\]
- en: Alternatively, provided \(B_{11}\) is invertible,
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，假设 \(B_{11}\) 是可逆的，
- en: \[\begin{split} B^{-1} = \begin{pmatrix} B_{11}^{-1} B_{12} (B/B_{11})^{-1}
    B_{21} B_{11}^{-1} + B_{11}^{-1} & - B_{11}^{-1} B_{12} (B/B_{11})^{-1}\\ - (B/B_{11})^{-1}
    B_{21} B_{11}^{-1} & (B/B_{11})^{-1} \end{pmatrix}. \end{split}\]
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} B^{-1} = \begin{pmatrix} B_{11}^{-1} B_{12} (B/B_{11})^{-1}
    B_{21} B_{11}^{-1} + B_{11}^{-1} & - B_{11}^{-1} B_{12} (B/B_{11})^{-1}\\ - (B/B_{11})^{-1}
    B_{21} B_{11}^{-1} & (B/B_{11})^{-1} \end{pmatrix}. \end{split}\]
- en: \(\flat\)
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: \(\flat\)
- en: '*Proof idea:* One way to prove this is to multiply \(B\) and \(B^{-1}\) and
    check that the identity matrix comes out (try it!). We give a longer proof that
    provides more insight into where the formula is coming from.'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明思路:* 证明这一点的办法之一是乘以 \(B\) 和 \(B^{-1}\)，检查是否得到单位矩阵（试试看！）。我们给出一个更长的证明，以提供更多关于公式来源的见解。'
- en: The trick is to multiply \(B\) on the left and right by carefully chosen block
    triangular matrices with identity matrices on the diagonal (which we know are
    invertible by a previous example) to produce a block diagonal matrix with invertible
    matrices on the diagonal (which we know how to invert by a previous example).
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 诀窍是左乘和右乘 \(B\)，使用精心选择的具有对角线为单位矩阵的块三角矩阵（我们知道根据之前的例子它们是可逆的）来产生对角线为可逆矩阵的块对角矩阵（我们知道根据之前的例子如何求逆）。
- en: '*Proof:* We only prove the first formula. The proof is a calculation based
    on the formula for matrix products of block matrices. We will need that, if \(C\),
    \(D\), and \(E\) are invertible and of the same size, then \((CDE)^{-1} = E^{-1}
    D^{-1} C^{-1}\) (check it!).'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明:* 我们只证明第一个公式。证明是基于分块矩阵的矩阵乘积公式进行的计算。我们需要，如果 \(C\)、\(D\) 和 \(E\) 是可逆的且大小相同，那么
    \((CDE)^{-1} = E^{-1} D^{-1} C^{-1}\)（检查它！）。'
- en: We make a series of observations.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 我们进行了一系列观察。
- en: 1- Our first step is to get a zero block in the upper right corner using an
    invertible matrix. Note that (recall that the order of multiplication matters
    here!)
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 1- 我们的第一步是使用一个可逆矩阵在右上角得到一个零块。注意（回想一下，这里的乘法顺序很重要！）
- en: \[\begin{align*} &\begin{pmatrix} I_{n_1 \times n_1} & - B_{12} B_{22}^{-1}\\
    \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix} B_{11} & B_{12}\\
    B_{21} & B_{22} \end{pmatrix}\\ &= \begin{pmatrix} B_{11} - B_{12} B_{22}^{-1}
    B_{21} & B_{12} - B_{12} B_{22}^{-1} B_{22}\\ \mathbf{0} + B_{21} & \mathbf{0}
    + B_{22} \end{pmatrix} = \begin{pmatrix} B/B_{22} & \mathbf{0}\\ B_{21} & B_{22}
    \end{pmatrix}. \end{align*}\]
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &\begin{pmatrix} I_{n_1 \times n_1} & - B_{12} B_{22}^{-1}\\
    \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix} B_{11} & B_{12}\\
    B_{21} & B_{22} \end{pmatrix}\\ &= \begin{pmatrix} B_{11} - B_{12} B_{22}^{-1}
    B_{21} & B_{12} - B_{12} B_{22}^{-1} B_{22}\\ \mathbf{0} + B_{21} & \mathbf{0}
    + B_{22} \end{pmatrix} = \begin{pmatrix} B/B_{22} & \mathbf{0}\\ B_{21} & B_{22}
    \end{pmatrix}. \end{align*}\]
- en: 2- Next we get a zero block in the bottom left corner. Starting from the final
    matrix in the last display,
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 2- 接下来，我们在左下角得到一个零块。从上一个显示的最终矩阵开始，
- en: \[\begin{align*} & \begin{pmatrix} B/B_{22} & \mathbf{0}\\ B_{21} & B_{22} \end{pmatrix}
    \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1} B_{21} & I_{n_2
    \times n_2} \end{pmatrix}\\ &= \begin{pmatrix} B/B_{22} + \mathbf{0} & \mathbf{0}
    + \mathbf{0} \\ B_{21} - B_{22} B_{22}^{-1} B_{21} & \mathbf{0} + B_{22} \end{pmatrix}
    = \begin{pmatrix} B/B_{22} & \mathbf{0}\\ \mathbf{0} & B_{22} \end{pmatrix}. \end{align*}\]
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} & \begin{pmatrix} B/B_{22} & \mathbf{0}\\ B_{21} & B_{22} \end{pmatrix}
    \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1} B_{21} & I_{n_2
    \times n_2} \end{pmatrix}\\ &= \begin{pmatrix} B/B_{22} + \mathbf{0} & \mathbf{0}
    + \mathbf{0} \\ B_{21} - B_{22} B_{22}^{-1} B_{21} & \mathbf{0} + B_{22} \end{pmatrix}
    = \begin{pmatrix} B/B_{22} & \mathbf{0}\\ \mathbf{0} & B_{22} \end{pmatrix}. \end{align*}\]
- en: 3- Combining the last two steps, we have shown that
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 3- 结合最后两个步骤，我们证明了
- en: \[\begin{split} \begin{pmatrix} I_{n_1 \times n_1} & - B_{12} B_{22}^{-1}\\
    \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix} B_{11} & B_{12}\\
    B_{21} & B_{22} \end{pmatrix} \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\
    - B_{22}^{-1} B_{21} & I_{n_2 \times n_2} \end{pmatrix} = \begin{pmatrix} B/B_{22}
    & \mathbf{0}\\ \mathbf{0} & B_{22} \end{pmatrix}. \end{split}\]
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} I_{n_1 \times n_1} & - B_{12} B_{22}^{-1}\\
    \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix} B_{11} & B_{12}\\
    B_{21} & B_{22} \end{pmatrix} \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\
    - B_{22}^{-1} B_{21} & I_{n_2 \times n_2} \end{pmatrix} = \begin{pmatrix} B/B_{22}
    & \mathbf{0}\\ \mathbf{0} & B_{22} \end{pmatrix}. \end{split}\]
- en: Using the formula for the inverse of a product of three invertible matrices,
    we obtain
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 使用三个可逆矩阵乘积的逆公式，我们得到
- en: \[\begin{align*} &\begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1}
    B_{21} & I_{n_2 \times n_2} \end{pmatrix}^{-1} \begin{pmatrix} B_{11} & B_{12}\\
    B_{21} & B_{22} \end{pmatrix}^{-1} \begin{pmatrix} I_{n_1 \times n_1} & - B_{12}
    B_{22}^{-1}\\ \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix}^{-1}\\ &= \begin{pmatrix}
    B/B_{22} & \mathbf{0}\\ \mathbf{0} & B_{22} \end{pmatrix}^{-1}. \end{align*}\]
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &\begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1}
    B_{21} & I_{n_2 \times n_2} \end{pmatrix}^{-1} \begin{pmatrix} B_{11} & B_{12}\\
    B_{21} & B_{22} \end{pmatrix}^{-1} \begin{pmatrix} I_{n_1 \times n_1} & - B_{12}
    B_{22}^{-1}\\ \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix}^{-1}\\ &= \begin{pmatrix}
    B/B_{22} & \mathbf{0}\\ \mathbf{0} & B_{22} \end{pmatrix}^{-1}. \end{align*}\]
- en: 4- Rearranging and using the formula for the inverse of a block diagonal matrix,
    we finally get
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 4- 通过重新排列并使用块对角矩阵逆的公式，我们最终得到
- en: \[\begin{align*} &\begin{pmatrix} B_{11} & B_{12}\\ B_{21} & B_{22} \end{pmatrix}^{-1}\\
    &= \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1} B_{21} & I_{n_2
    \times n_2} \end{pmatrix} \begin{pmatrix} B/B_{22} & \mathbf{0}\\ \mathbf{0} &
    B_{22} \end{pmatrix}^{-1} \begin{pmatrix} I_{n_1 \times n_1} & - B_{12} B_{22}^{-1}\\
    \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix}\\ &= \begin{pmatrix} I_{n_1 \times
    n_1} & \mathbf{0}\\ - B_{22}^{-1} B_{21} & I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix}
    (B/B_{22})^{-1} & \mathbf{0}\\ \mathbf{0} & B_{22}^{-1} \end{pmatrix} \begin{pmatrix}
    I_{n_1 \times n_1} & - B_{12} B_{22}^{-1}\\ \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix}\\
    &= \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1} B_{21} & I_{n_2
    \times n_2} \end{pmatrix} \begin{pmatrix} (B/B_{22})^{-1} + \mathbf{0}& - (B/B_{22})^{-1}
    B_{12} B_{22}^{-1} + \mathbf{0}\\ \mathbf{0} + \mathbf{0} & \mathbf{0} + B_{22}^{-1}
    \end{pmatrix}\\ &= \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1}
    B_{21} & I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix} (B/B_{22})^{-1} & -
    (B/B_{22})^{-1} B_{12} B_{22}^{-1} \\ \mathbf{0} & B_{22}^{-1} \end{pmatrix}\\
    &= \begin{pmatrix} (B/B_{22})^{-1} & - (B/B_{22})^{-1} B_{12} B_{22}^{-1}\\ -
    B_{22}^{-1} B_{21} (B/B_{22})^{-1} & B_{22}^{-1} B_{21} (B/B_{22})^{-1} B_{12}
    B_{22}^{-1} + B_{22}^{-1} \end{pmatrix}, \end{align*}\]
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &\begin{pmatrix} B_{11} & B_{12}\\ B_{21} & B_{22} \end{pmatrix}^{-1}\\
    &= \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1} B_{21} & I_{n_2
    \times n_2} \end{pmatrix} \begin{pmatrix} B/B_{22} & \mathbf{0}\\ \mathbf{0} &
    B_{22} \end{pmatrix}^{-1} \begin{pmatrix} I_{n_1 \times n_1} & - B_{12} B_{22}^{-1}\\
    \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix}\\ &= \begin{pmatrix} I_{n_1 \times
    n_1} & \mathbf{0}\\ - B_{22}^{-1} B_{21} & I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix}
    (B/B_{22})^{-1} & \mathbf{0}\\ \mathbf{0} & B_{22}^{-1} \end{pmatrix} \begin{pmatrix}
    I_{n_1 \times n_1} & - B_{12} B_{22}^{-1}\\ \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix}\\
    &= \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1} B_{21} & I_{n_2
    \times n_2} \end{pmatrix} \begin{pmatrix} (B/B_{22})^{-1} + \mathbf{0}& - (B/B_{22})^{-1}
    B_{12} B_{22}^{-1} + \mathbf{0}\\ \mathbf{0} + \mathbf{0} & \mathbf{0} + B_{22}^{-1}
    \end{pmatrix}\\ &= \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1}
    B_{21} & I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix} (B/B_{22})^{-1} & -
    (B/B_{22})^{-1} B_{12} B_{22}^{-1} \\ \mathbf{0} & B_{22}^{-1} \end{pmatrix}\\
    &= \begin{pmatrix} (B/B_{22})^{-1} & - (B/B_{22})^{-1} B_{12} B_{22}^{-1}\\ -
    B_{22}^{-1} B_{21} (B/B_{22})^{-1} & B_{22}^{-1} B_{21} (B/B_{22})^{-1} B_{12}
    B_{22}^{-1} + B_{22}^{-1} \end{pmatrix}, \end{align*}\]
- en: as claimed. \(\square\)
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 如所声称。 \(\square\)
- en: '**The positive definite case** In applying the inversion formula, it will be
    enough to restrict ourselves to the positive definite case, where the lemmas that
    follow guarantee the required invertibility conditions.'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '**正定情况** 在应用求逆公式时，我们只需将注意力限制在正定情况，接下来的引理将保证所需的可逆性条件。'
- en: 'First:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 首先：
- en: '**LEMMA** **(Invertibility of Positive Definite Matrices)** \(\idx{invertibility
    of positive definite matrices}\xdi\) Let \(B \in \mathbb{R}^{n \times n}\) be
    symmetric, positive definite. Then \(B\) is invertible. \(\flat\)'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '**引理** **(正定矩阵的可逆性)** \(\idx{invertibility of positive definite matrices}\xdi\)
    设 \(B \in \mathbb{R}^{n \times n}\) 为对称，正定。那么 \(B\) 是可逆的。 \(\flat\)'
- en: '*Proof:* For any \(\mathbf{x} \neq \mathbf{0}\), it holds by positive definiteness
    that \(\mathbf{x}^T B \mathbf{x} > 0\). In particular, it must be that \(\mathbf{x}^T
    B \mathbf{x} \neq 0\) and therefore, by contradiction, \(B \mathbf{x} \neq \mathbf{0}\)
    (since for any \(\mathbf{z}\), it holds that \(\mathbf{z}^T \mathbf{0} = 0\)).
    The claim follows from the *Equivalent Definition of Linear Independence*. \(\square\)'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明：* 对于任何 \(\mathbf{x} \neq \mathbf{0}\)，根据正定性，有 \(\mathbf{x}^T B \mathbf{x}
    > 0\)。特别是，必须满足 \(\mathbf{x}^T B \mathbf{x} \neq 0\)，因此，通过反证法，\(B \mathbf{x} \neq
    \mathbf{0}\)（因为对于任何 \(\mathbf{z}\)，都有 \(\mathbf{z}^T \mathbf{0} = 0\)）。这个结论来自于线性独立的等价定义。
    \(\square\)'
- en: A principal submatrix is a square submatrix obtained by removing some rows and
    columns. Moreover we require that the set of row indices that remain is the same
    as the set of column indices that remain.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 主子矩阵是通过删除一些行和列得到的正方形子矩阵。此外，我们还需要保证剩余的行索引集合与剩余的列索引集合相同。
- en: '**LEMMA** **(Principal Submatrices)** \(\idx{principal submatrices lemma}\xdi\)
    Let \(B \in \mathbb{R}^{n \times n}\) be positive definite and let \(Z \in \mathbb{R}^{n
    \times p}\) have full column rank. Then \(Z^T B Z\) is positive definite. In particular
    all principal submatrices of positive definite matrices are positive definite.
    \(\flat\)'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: '**引理** **（主子矩阵）** \(\idx{principal submatrices lemma}\xdi\) 设 \(B \in \mathbb{R}^{n
    \times n}\) 是正定的，并且设 \(Z \in \mathbb{R}^{n \times p}\) 具有满列秩。那么 \(Z^T B Z\) 是正定的。特别是，所有正定矩阵的主子矩阵都是正定的。
    \(\flat\)'
- en: '*Proof:* If \(\mathbf{x} \neq \mathbf{0}\), then \(\mathbf{x}^T (Z^T B Z) \mathbf{x}
    = \mathbf{y}^T B \mathbf{y}\), where we defined \(\mathbf{y} = Z \mathbf{x}\).
    Because \(Z\) has full column rank and \(\mathbf{x} \neq \mathbf{0}\), it follows
    that \(\mathbf{y} \neq \mathbf{0}\) by the *Equivalent Definition of Linear Independence*.
    Hence, since \(B \succ 0\), we have \(\mathbf{y}^T B \mathbf{y} > 0\) which proves
    the first claim. For the second claim, take \(Z\) of the form \((\mathbf{e}_{m_1}\
    \mathbf{e}_{m_2}\ \ldots\ \mathbf{e}_{m_p})\), where the indices \(m_1, \ldots,
    m_p\) are distinct and increasing. The columns of \(Z\) are then linearly independent
    since they are distinct basis vectors. \(\square\)'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明：* 如果 \(\mathbf{x} \neq \mathbf{0}\)，那么 \(\mathbf{x}^T (Z^T B Z) \mathbf{x}
    = \mathbf{y}^T B \mathbf{y}\)，其中我们定义 \(\mathbf{y} = Z \mathbf{x}\)。因为 \(Z\) 具有满列秩且
    \(\mathbf{x} \neq \mathbf{0}\)，根据线性独立的等价定义，可以得出 \(\mathbf{y} \neq \mathbf{0}\)。因此，由于
    \(B \succ 0\)，我们有 \(\mathbf{y}^T B \mathbf{y} > 0\)，这证明了第一个结论。对于第二个结论，取 \(Z\)
    的形式为 \((\mathbf{e}_{m_1}\ \mathbf{e}_{m_2}\ \ldots\ \mathbf{e}_{m_p})\)，其中索引 \(m_1,
    \ldots, m_p\) 是不同的且递增的。由于这些列是不同的基向量，因此 \(Z\) 的列是线性无关的。 \(\square\)'
- en: To better understand the last claim in the proof, note that
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更好地理解证明中的最后一个结论，请注意
- en: \[ (Z^T B Z)_{i,j} = (Z^T)_{i,\cdot} B Z_{\cdot,j} = (Z_{\cdot,i})^T B Z_{\cdot,j}
    = \sum_{k=1}^n \sum_{\ell=1}^n Z_{k,i} B_{k,\ell} Z_{\ell,j}. \]
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: \[ (Z^T B Z)_{i,j} = (Z^T)_{i,\cdot} B Z_{\cdot,j} = (Z_{\cdot,i})^T B Z_{\cdot,j}
    = \sum_{k=1}^n \sum_{\ell=1}^n Z_{k,i} B_{k,\ell} Z_{\ell,j}. \]
- en: So if the \(i\)-th column of \(Z\) is \(\mathbf{e}_{m_i}\) and the \(j\)-th
    column of \(Z\) is \(\mathbf{e}_{m_j}\), then the rightmost summation picks up
    only one element, \(B_{m_i, m_j}\). In other words, \(Z^T B Z\) is the principal
    submatrix of \(B\) corresponding to rows and columns \(m_1, \ldots, m_p\).
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，如果 \(Z\) 的第 \(i\) 列是 \(\mathbf{e}_{m_i}\) 并且 \(Z\) 的第 \(j\) 列是 \(\mathbf{e}_{m_j}\)，那么最右边的求和只取一个元素，即
    \(B_{m_i, m_j}\)。换句话说，\(Z^T B Z\) 是 \(B\) 对应于行和列 \(m_1, \ldots, m_p\) 的主子矩阵。
- en: '**KNOWLEDGE CHECK:** Consider the matrices'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: '**知识检查：** 考虑以下矩阵'
- en: \[\begin{split} A = \begin{pmatrix} 1 & 3 & 0 & 2\\ 2 & 8 & 4 & 0\\ 6 & 1 &
    1 & 4\\ 3 & 2 & 0 & 1 \end{pmatrix} \qquad\text{and}\qquad Z = \begin{pmatrix}
    0 & 0\\ 1 & 0\\ 0 & 0\\ 0 & 1 \end{pmatrix} \end{split}\]
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A = \begin{pmatrix} 1 & 3 & 0 & 2\\ 2 & 8 & 4 & 0\\ 6 & 1 &
    1 & 4\\ 3 & 2 & 0 & 1 \end{pmatrix} \qquad\text{and}\qquad Z = \begin{pmatrix}
    0 & 0\\ 1 & 0\\ 0 & 0\\ 0 & 1 \end{pmatrix} \end{split}\]
- en: Which of the following matrices is \(Z^T A Z\)?
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 以下哪个矩阵是 \(Z^T A Z\)？
- en: a) \(\begin{pmatrix} 1 & 0\\ 6 & 1 \end{pmatrix}\)
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: a) \(\begin{pmatrix} 1 & 0\\ 6 & 1 \end{pmatrix}\)
- en: b) \(\begin{pmatrix} 8 & 0\\ 2 & 1 \end{pmatrix}\)
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: b) \(\begin{pmatrix} 8 & 0\\ 2 & 1 \end{pmatrix}\)
- en: c) \(\begin{pmatrix} 2 & 8 & 4 & 0\\ 3 & 2 & 0 & 1 \end{pmatrix}\)
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: c) \(\begin{pmatrix} 2 & 8 & 4 & 0\\ 3 & 2 & 0 & 1 \end{pmatrix}\)
- en: d) \(\begin{pmatrix} 1 & 0\\ 2 & 4\\ 6 & 1\\ 3 & 0 \end{pmatrix}\)
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: d) \(\begin{pmatrix} 1 & 0\\ 2 & 4\\ 6 & 1\\ 3 & 0 \end{pmatrix}\)
- en: \(\checkmark\)
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: \(\checkmark\)
- en: '**LEMMA** **(Schur Complement)** \(\idx{Schur complement lemma}\xdi\) Let \(B
    \in \mathbb{R}^{n \times n}\) be positive definite and write it in block form'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '**引理** **（舒尔补）** \(\idx{Schur complement lemma}\xdi\) 设 \(B \in \mathbb{R}^{n
    \times n}\) 是正定的，并以分块形式表示'
- en: \[\begin{split} B = \begin{pmatrix} B_{11} & B_{12}\\ B_{12}^T & B_{22} \end{pmatrix}
    \end{split}\]
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} B = \begin{pmatrix} B_{11} & B_{12}\\ B_{12}^T & B_{22} \end{pmatrix}
    \end{split}\]
- en: where \(B_{11} \in \mathbb{R}^{n_1 \times n_1}\) and \(B_{22} \in \mathbb{R}^{n
    - n_1 \times n - n_1}\) are symmetric, and \(B_{12} \in \mathbb{R}^{n_1 \times
    n - n_1}\) . Then the Schur complement of the block \(B_{11}\), i.e., the matrix
    \(B/B_{11} := B_{22} - B_{12}^T B_{11}^{-1} B_{12}\), is well-defined, symmetric,
    and positive definite. The same holds for \(B/B_{22} := B_{11} - B_{12} B_{22}^{-1}
    B_{12}^T\). \(\flat\)
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(B_{11} \in \mathbb{R}^{n_1 \times n_1}\) 和 \(B_{22} \in \mathbb{R}^{n -
    n_1 \times n - n_1}\) 是对称的，且 \(B_{12} \in \mathbb{R}^{n_1 \times n - n_1}\) 。然后，\(B_{11}\)
    的 Schur 补，即矩阵 \(B/B_{11} := B_{22} - B_{12}^T B_{11}^{-1} B_{12}\)，是良好定义的、对称的且正定的。对于
    \(B/B_{22} := B_{11} - B_{12} B_{22}^{-1} B_{12}^T\) 也同样成立。\(\flat\)
- en: '*Proof:* By the *Principal Submatrices Lemma*, \(B_{11}\) is positive definite.
    By the *Invertibility of Positive Definite Matrices*, \(B_{11}\) is therefore
    invertible. Hence the Schur complement is well defined. Moreover, it is symmetric
    since'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明:* 根据 *主子矩阵引理*，\(B_{11}\) 是正定的。根据 *正定矩阵的可逆性*，\(B_{11}\) 因此是可逆的。因此，Schur
    补是良好定义的。此外，它是对称的，因为'
- en: \[ (B/B_{11})^T = B_{22}^T - (B_{12}^T B_{11}^{-1} B_{12})^T = B_{22} - B_{12}^T
    B_{11}^{-1} B_{12} = B/B_{11}, \]
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: \[ (B/B_{11})^T = B_{22}^T - (B_{12}^T B_{11}^{-1} B_{12})^T = B_{22} - B_{12}^T
    B_{11}^{-1} B_{12} = B/B_{11}, \]
- en: by the symmetry of \(B_{11}\), \(B_{22}\), and \(B_{11}^{-1}\) (prove that last
    one!).
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 由 \(B_{11}\)、\(B_{22}\) 和 \(B_{11}^{-1}\) 的对称性（证明最后一个！）。
- en: For a non-zero \(\mathbf{x} \in \mathbb{R}^{n_2}\), let
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 对于非零的 \(\mathbf{x} \in \mathbb{R}^{n_2}\)，令
- en: \[\begin{split} \mathbf{z} = \begin{pmatrix} \mathbf{z}_1\\ \mathbf{z}_2 \end{pmatrix}
    = \begin{pmatrix} B_{11}^{-1} B_{12} \mathbf{x}\\ - \mathbf{x} \end{pmatrix}.
    \end{split}\]
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{z} = \begin{pmatrix} \mathbf{z}_1\\ \mathbf{z}_2 \end{pmatrix}
    = \begin{pmatrix} B_{11}^{-1} B_{12} \mathbf{x}\\ - \mathbf{x} \end{pmatrix}.
    \end{split}\]
- en: The result then follows from the observation that
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 从观察结果得出结论，
- en: \[\begin{align*} &\mathbf{z}^T \begin{pmatrix} B_{11} & B_{12}\\ B_{12}^T &
    B_{22} \end{pmatrix} \mathbf{z}\\ &= \mathbf{z}_1^T B_{11} \mathbf{z}_1 + 2 \mathbf{z}_1^T
    B_{12} \mathbf{z}_2 + \mathbf{z}_2^T B_{22} \mathbf{z}_2\\ &= (B_{11}^{-1} B_{12}
    \mathbf{x})^T B_{11} B_{11}^{-1} B_{12} \mathbf{x} + 2 (B_{11}^{-1} B_{12} \mathbf{x})^T
    B_{12} (- \mathbf{x}) + (- \mathbf{x})^T B_{22} (- \mathbf{x})\\ &= \mathbf{x}^T
    B_{12}^T B_{11}^{-1} B_{12}\,\mathbf{x} - 2 \mathbf{x}^T B_{12}^T B_{11}^{-1}
    B_{12}\,\mathbf{x} + \mathbf{x}^T B_{22}\,\mathbf{x}\\ &= \mathbf{x}^T(B_{22}
    - B_{12}^T B_{11}^{-1} B_{12})\,\mathbf{x}. \end{align*}\]
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &\mathbf{z}^T \begin{pmatrix} B_{11} & B_{12}\\ B_{12}^T &
    B_{22} \end{pmatrix} \mathbf{z}\\ &= \mathbf{z}_1^T B_{11} \mathbf{z}_1 + 2 \mathbf{z}_1^T
    B_{12} \mathbf{z}_2 + \mathbf{z}_2^T B_{22} \mathbf{z}_2\\ &= (B_{11}^{-1} B_{12}
    \mathbf{x})^T B_{11} B_{11}^{-1} B_{12} \mathbf{x} + 2 (B_{11}^{-1} B_{12} \mathbf{x})^T
    B_{12} (- \mathbf{x}) + (- \mathbf{x})^T B_{22} (- \mathbf{x})\\ &= \mathbf{x}^T
    B_{12}^T B_{11}^{-1} B_{12}\,\mathbf{x} - 2 \mathbf{x}^T B_{12}^T B_{11}^{-1}
    B_{12}\,\mathbf{x} + \mathbf{x}^T B_{22}\,\mathbf{x}\\ &= \mathbf{x}^T(B_{22}
    - B_{12}^T B_{11}^{-1} B_{12})\,\mathbf{x}. \end{align*}\]
- en: \(\square\)
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: \(\square\)
- en: '**Marginals and conditionals** We are now ready to derive the distribution
    of marginals and conditionals of multivariate Gaussians\(\idx{multivariate Gaussian}\xdi\).
    Recall that a multivariate Gaussian\(\idx{multivariate normal}\xdi\) vector \(\mathbf{X}
    = (X_1,\ldots,X_d)\) on \(\mathbb{R}^d\) with mean \(\bmu \in \mathbb{R}^d\) and
    positive definite covariance matrix \(\bSigma \in \mathbb{R}^{d \times d}\) has
    probability density function'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: '**边缘和条件** 我们现在可以推导出多元高斯分布的边缘和条件分布\(\idx{多元高斯}\xdi\)。回想一下，一个在 \(\mathbb{R}^d\)
    上的多元高斯\(\idx{多元正态}\xdi\)向量 \(\mathbf{X} = (X_1,\ldots,X_d)\) 具有均值 \(\bmu \in \mathbb{R}^d\)
    和正定协方差矩阵 \(\bSigma \in \mathbb{R}^{d \times d}\)，其概率密度函数为'
- en: \[ f_{\bmu, \bSigma}(\mathbf{x}) = \frac{1}{(2\pi)^{d/2} \,|\bSigma|^{1/2}}
    \exp\left(-\frac{1}{2}(\mathbf{x} - \bmu)^T \bSigma^{-1} (\mathbf{x} - \bmu)\right).
    \]
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f_{\bmu, \bSigma}(\mathbf{x}) = \frac{1}{(2\pi)^{d/2} \,|\bSigma|^{1/2}}
    \exp\left(-\frac{1}{2}(\mathbf{x} - \bmu)^T \bSigma^{-1} (\mathbf{x} - \bmu)\right).
    \]
- en: Recall that one way to compute \(|\bSigma|\) is as the product of all eigenvalues
    of \(\bSigma\) (with repeats). The matrix \(\bLambda = \bSigma^{-1}\) is called
    the precision matrix.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 回想一下，计算 \(|\bSigma|\) 的一种方法是将 \(\bSigma\) 的所有特征值（包括重复的）相乘。矩阵 \(\bLambda = \bSigma^{-1}\)
    被称为精度矩阵。
- en: Partition \(\mathbf{X}\) as the column vector \((\mathbf{X}_1, \mathbf{X}_2)\)
    where \(\mathbf{X}_i \in \mathbb{R}^{d_i}\), \(i=1,2\), with \(d_1 + d_2 = d\).
    Similarly, consider the corresponding block vectors and matrices
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 将 \(\mathbf{X}\) 分块为列向量 \((\mathbf{X}_1, \mathbf{X}_2)\)，其中 \(\mathbf{X}_i \in
    \mathbb{R}^{d_i}\)，\(i=1,2\)，且 \(d_1 + d_2 = d\)。类似地，考虑相应的块向量和矩阵
- en: \[\begin{split} \bmu = \begin{pmatrix} \bmu_1\\ \bmu_2 \end{pmatrix} \qquad
    \bSigma = \begin{pmatrix} \bSigma_{11} & \bSigma_{12}\\ \bSigma_{21} & \bSigma_{22}
    \end{pmatrix} \qquad \bLambda = \begin{pmatrix} \bLambda_{11} & \bLambda_{12}\\
    \bLambda_{21} & \bLambda_{22} \end{pmatrix}. \end{split}\]
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bmu = \begin{pmatrix} \bmu_1\\ \bmu_2 \end{pmatrix} \qquad
    \bSigma = \begin{pmatrix} \bSigma_{11} & \bSigma_{12}\\ \bSigma_{21} & \bSigma_{22}
    \end{pmatrix} \qquad \bLambda = \begin{pmatrix} \bLambda_{11} & \bLambda_{12}\\
    \bLambda_{21} & \bLambda_{22} \end{pmatrix}. \end{split}\]
- en: Note that by the symmetry of \(\bSigma\), we have \(\bSigma_{21} = \bSigma_{12}^T\).
    Furthemore, it can be proved that a symmetric, invertible matrix has a symmetric
    inverse (try it!) so that \(\bLambda_{21} = \bLambda_{12}^T\).
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 注意到由于 \(\bSigma\) 的对称性，我们有 \(\bSigma_{21} = \bSigma_{12}^T\)。此外，可以证明一个对称可逆矩阵有一个对称的逆（试试看！）因此
    \(\bLambda_{21} = \bLambda_{12}^T\)。
- en: We seek to compute the marginals\(\idx{marginal}\xdi\) \(f_{\mathbf{X}_1}(\mathbf{x}_1)\)
    and \(f_{\mathbf{X}_2}(\mathbf{x}_2)\), as well as the conditional density of
    \(\mathbf{X}_1\) given \(\mathbf{X}_2\), which we denote as \(f_{\mathbf{X}_1|\mathbf{X}_2}(\mathbf{x}_1|\mathbf{x}_2)\),
    and similarly \(f_{\mathbf{X}_2|\mathbf{X}_1}(\mathbf{x}_2|\mathbf{x}_1)\).
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要计算边缘分布\(\idx{marginal}\xdi\) \(f_{\mathbf{X}_1}(\mathbf{x}_1)\) 和 \(f_{\mathbf{X}_2}(\mathbf{x}_2)\)，以及给定
    \(\mathbf{X}_2\) 的 \(\mathbf{X}_1\) 的条件密度，我们将其表示为 \(f_{\mathbf{X}_1|\mathbf{X}_2}(\mathbf{x}_1|\mathbf{x}_2)\)，同样
    \(f_{\mathbf{X}_2|\mathbf{X}_1}(\mathbf{x}_2|\mathbf{x}_1)\)。
- en: By the multiplication rule, the joint density \(f_{\mathbf{X}_1,\mathbf{X}_2}(\mathbf{x}_1,\mathbf{x}_2)\)
    can be decomposed as
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 根据乘法规则，联合密度 \(f_{\mathbf{X}_1,\mathbf{X}_2}(\mathbf{x}_1,\mathbf{x}_2)\) 可以分解为
- en: \[ f_{\mathbf{X}_1,\mathbf{X}_2}(\mathbf{x}_1,\mathbf{x}_2) = f_{\mathbf{X}_1|\mathbf{X}_2}(\mathbf{x}_1|\mathbf{x}_2)
    f_{\mathbf{X}_2}(\mathbf{x}_2). \]
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f_{\mathbf{X}_1,\mathbf{X}_2}(\mathbf{x}_1,\mathbf{x}_2) = f_{\mathbf{X}_1|\mathbf{X}_2}(\mathbf{x}_1|\mathbf{x}_2)
    f_{\mathbf{X}_2}(\mathbf{x}_2). \]
- en: We use the *Inverting a Block Matrix* lemma to rewrite \(f_{\mathbf{X}_1,\mathbf{X}_2}(\mathbf{x}_1,\mathbf{x}_2)\)
    in this form and “reveal” the marginal and conditional\(\idx{conditional}\xdi\)
    involved. Indeed, once the joint density is in this form, by integrating over
    \(\mathbf{x}_1\) we obtain that the marginal density of \(\mathbf{X}_2\) is \(f_{\mathbf{X}_2}\)
    and the conditional density of \(\mathbf{X}_1\) given \(\mathbf{X}_2\) is obtained
    by taking the ratio of the joint and the marginal.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用 *Inverting a Block Matrix* 引理将 \(f_{\mathbf{X}_1,\mathbf{X}_2}(\mathbf{x}_1,\mathbf{x}_2)\)
    重写为这种形式，并“揭示”涉及的边缘和条件\(\idx{conditional}\xdi\)。确实，一旦联合密度以这种形式存在，通过对 \(\mathbf{x}_1\)
    进行积分，我们得到 \(\mathbf{X}_2\) 的边缘密度为 \(f_{\mathbf{X}_2}\)，而给定 \(\mathbf{X}_2\) 的
    \(\mathbf{X}_1\) 的条件密度是通过联合密度和边缘密度的比值得到的。
- en: In fact, it will be easier to work with an expression derived in the proof of
    that lemma, specifically
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，使用该引理的证明中推导出的表达式会更简单，具体来说
- en: \[\begin{align*} &\begin{pmatrix} \bSigma_{11} & \bSigma_{12}\\ \bSigma_{21}
    & \bSigma_{22} \end{pmatrix}^{-1}\\ &= \begin{pmatrix} I_{d_1 \times d_1} & \mathbf{0}\\
    - \bSigma_{22}^{-1} \bSigma_{12}^T & I_{d_2 \times d_2} \end{pmatrix} \begin{pmatrix}
    (\bSigma/\bSigma_{22})^{-1} & \mathbf{0}\\ \mathbf{0} & \bSigma_{22}^{-1} \end{pmatrix}
    \begin{pmatrix} I_{d_1 \times d_1} & - \bSigma_{12} \bSigma_{22}^{-1}\\ \mathbf{0}
    & I_{d_2 \times d_2} \end{pmatrix}. \end{align*}\]
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &\begin{pmatrix} \bSigma_{11} & \bSigma_{12}\\ \bSigma_{21}
    & \bSigma_{22} \end{pmatrix}^{-1}\\ &= \begin{pmatrix} I_{d_1 \times d_1} & \mathbf{0}\\
    - \bSigma_{22}^{-1} \bSigma_{12}^T & I_{d_2 \times d_2} \end{pmatrix} \begin{pmatrix}
    (\bSigma/\bSigma_{22})^{-1} & \mathbf{0}\\ \mathbf{0} & \bSigma_{22}^{-1} \end{pmatrix}
    \begin{pmatrix} I_{d_1 \times d_1} & - \bSigma_{12} \bSigma_{22}^{-1}\\ \mathbf{0}
    & I_{d_2 \times d_2} \end{pmatrix}. \end{align*}\]
- en: We will use the fact that the first matrix on the last line is the transpose
    of the third one (check it!).
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用事实，即最后一行的第一个矩阵是第三个矩阵的转置（检查一下！）。
- en: To evaluate the joint density, we need to expand the quadratic function \((\mathbf{x}
    - \bmu)^T \bSigma^{-1} (\mathbf{x} - \bmu)\) appearing in the exponential. We
    break this up in a few steps.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 为了评估联合密度，我们需要展开指数中出现的二次函数 \((\mathbf{x} - \bmu)^T \bSigma^{-1} (\mathbf{x} -
    \bmu)\)。我们将这一过程分为几个步骤。
- en: 1- Note first that
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 1- 首先注意
- en: \[\begin{split} \begin{pmatrix} I_{d_1 \times d_1} & - \bSigma_{12} \bSigma_{22}^{-1}\\
    \mathbf{0} & I_{d_2 \times d_2} \end{pmatrix} \begin{pmatrix} \mathbf{x}_1 - \bmu_1\\
    \mathbf{x}_2 - \bmu_2 \end{pmatrix} = \begin{pmatrix} (\mathbf{x}_1 - \bmu_1)
    - \bSigma_{12} \bSigma_{22}^{-1} (\mathbf{x}_2 - \bmu_2) \\ \mathbf{x}_2 - \bmu_2
    \end{pmatrix} \end{split}\]
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} I_{d_1 \times d_1} & - \bSigma_{12} \bSigma_{22}^{-1}\\
    \mathbf{0} & I_{d_2 \times d_2} \end{pmatrix} \begin{pmatrix} \mathbf{x}_1 - \bmu_1\\
    \mathbf{x}_2 - \bmu_2 \end{pmatrix} = \begin{pmatrix} (\mathbf{x}_1 - \bmu_1)
    - \bSigma_{12} \bSigma_{22}^{-1} (\mathbf{x}_2 - \bmu_2) \\ \mathbf{x}_2 - \bmu_2
    \end{pmatrix} \end{split}\]
- en: and similarly for its transpose. We define
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 对于其转置也是如此。我们定义
- en: \[ \bmu_{1|2}(\mathbf{x}_2) := \bmu_1 + \bSigma_{12} \bSigma_{22}^{-1} (\mathbf{x}_2
    - \bmu_2). \]
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bmu_{1|2}(\mathbf{x}_2) := \bmu_1 + \bSigma_{12} \bSigma_{22}^{-1} (\mathbf{x}_2
    - \bmu_2). \]
- en: 2- Plugging this back in the quadratic function, we get
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 2- 将此代入二次函数中，我们得到
- en: \[\begin{align*} &(\mathbf{x} - \bmu)^T \bSigma^{-1} (\mathbf{x} - \bmu)\\ &=
    \begin{pmatrix} \mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2) \\ \mathbf{x}_2 - \bmu_2
    \end{pmatrix}^T \begin{pmatrix} (\bSigma/\bSigma_{22})^{-1} & \mathbf{0}\\ \mathbf{0}
    & \bSigma_{22}^{-1} \end{pmatrix} \begin{pmatrix} \mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2)
    \\ \mathbf{x}_2 - \bmu_2 \end{pmatrix}\\ &= (\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2))^T
    (\bSigma/\bSigma_{22})^{-1} (\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2)) + (\mathbf{x}_2
    - \bmu_2)^T \bSigma_{22}^{-1} (\mathbf{x}_2 - \bmu_2). \end{align*}\]
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &(\mathbf{x} - \bmu)^T \bSigma^{-1} (\mathbf{x} - \bmu)\\ &=
    \begin{pmatrix} \mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2) \\ \mathbf{x}_2 - \bmu_2
    \end{pmatrix}^T \begin{pmatrix} (\bSigma/\bSigma_{22})^{-1} & \mathbf{0}\\ \mathbf{0}
    & \bSigma_{22}^{-1} \end{pmatrix} \begin{pmatrix} \mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2)
    \\ \mathbf{x}_2 - \bmu_2 \end{pmatrix}\\ &= (\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2))^T
    (\bSigma/\bSigma_{22})^{-1} (\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2)) + (\mathbf{x}_2
    - \bmu_2)^T \bSigma_{22}^{-1} (\mathbf{x}_2 - \bmu_2). \end{align*}\]
- en: Note that both terms have the same form as the original quadratic function.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 注意到这两个项都与原始二次函数具有相同的形式。
- en: 3- Going back to the density, we use \(\propto\) to indicate that the expression
    holds up to a constant not depending on \(\mathbf{x}\). Using that the exponential
    of a sum is the product of exponentials, we obtain
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 3- 回到密度函数，我们使用 \(\propto\) 来表示表达式在常数项（不依赖于 \(\mathbf{x}\)）的范围内成立。利用指数和的性质，我们得到
- en: \[\begin{align*} &f_{\mathbf{X}_1,\mathbf{X}_2}(\mathbf{x}_1,\mathbf{x}_2)\\
    &\propto \exp\left(-\frac{1}{2}(\mathbf{x} - \bmu)^T \bSigma^{-1} (\mathbf{x}
    - \bmu)\right)\\ &\propto \exp\left(-\frac{1}{2}(\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2))^T
    (\bSigma/\bSigma_{22})^{-1} (\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2))\right)\\
    & \qquad \times \exp\left(-\frac{1}{2}(\mathbf{x}_2 - \bmu_2)^T \bSigma_{22}^{-1}
    (\mathbf{x}_2 - \bmu_2)\right). \end{align*}\]
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &f_{\mathbf{X}_1,\mathbf{X}_2}(\mathbf{x}_1,\mathbf{x}_2)\\
    &\propto \exp\left(-\frac{1}{2}(\mathbf{x} - \bmu)^T \bSigma^{-1} (\mathbf{x}
    - \bmu)\right)\\ &\propto \exp\left(-\frac{1}{2}(\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2))^T
    (\bSigma/\bSigma_{22})^{-1} (\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2))\right)\\
    & \qquad \times \exp\left(-\frac{1}{2}(\mathbf{x}_2 - \bmu_2)^T \bSigma_{22}^{-1}
    (\mathbf{x}_2 - \bmu_2)\right). \end{align*}\]
- en: 4- We have shown that
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 4- 我们已经证明了
- en: \[ f_{\mathbf{X}_1|\mathbf{X}_2}(\mathbf{x}_1|\mathbf{x}_2) \propto \exp\left(-\frac{1}{2}(\mathbf{x}_1
    - \bmu_{1|2}(\mathbf{x}_2))^T (\bSigma/\bSigma_{22})^{-1} (\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2))\right)
    \]
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f_{\mathbf{X}_1|\mathbf{X}_2}(\mathbf{x}_1|\mathbf{x}_2) \propto \exp\left(-\frac{1}{2}(\mathbf{x}_1
    - \bmu_{1|2}(\mathbf{x}_2))^T (\bSigma/\bSigma_{22})^{-1} (\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2))\right)
    \]
- en: and
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 和
- en: \[ f_{\mathbf{X}_2}(\mathbf{x}_2) \propto \exp\left(-\frac{1}{2}(\mathbf{x}_2
    - \bmu_2)^T \bSigma_{22}^{-1} (\mathbf{x}_2 - \bmu_2)\right). \]
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f_{\mathbf{X}_2}(\mathbf{x}_2) \propto \exp\left(-\frac{1}{2}(\mathbf{x}_2
    - \bmu_2)^T \bSigma_{22}^{-1} (\mathbf{x}_2 - \bmu_2)\right). \]
- en: In other words, the marginal density of \(\mathbf{X}_2\) is multivariate Gaussian
    with mean \(\bmu_2\) and covariance \(\bSigma_{22}\). The conditional density
    of \(\mathbf{X}_1\) given \(\mathbf{X}_2\) is multivariate Gaussian with mean
    \(\bmu_{1|2}(\mathbf{X}_2)\) and covariance \(\bSigma/\bSigma_{22} = \bSigma_{11}
    - \bSigma_{12} \bSigma_{22}^{-1} \bSigma_{12}^T\). We write this as
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 换句话说，\(\mathbf{X}_2\) 的边缘密度是具有均值 \(\bmu_2\) 和协方差 \(\bSigma_{22}\) 的多元高斯分布。给定
    \(\mathbf{X}_2\) 的 \(\mathbf{X}_1\) 的条件密度是具有均值 \(\bmu_{1|2}(\mathbf{X}_2)\) 和协方差
    \(\bSigma/\bSigma_{22} = \bSigma_{11} - \bSigma_{12} \bSigma_{22}^{-1} \bSigma_{12}^T\)
    的多元高斯分布。我们将其表示为
- en: \[ \mathbf{X}_1|\mathbf{X}_2 \sim N_{d_1}(\bmu_{1|2}(\mathbf{X}_2), \bSigma/\bSigma_{22})
    \]
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{X}_1|\mathbf{X}_2 \sim N_{d_1}(\bmu_{1|2}(\mathbf{X}_2), \bSigma/\bSigma_{22})
    \]
- en: and
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 和
- en: \[ \mathbf{X}_2 \sim N_{d_2}(\bmu_2, \bSigma_{22}). \]
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{X}_2 \sim N_{d_2}(\bmu_2, \bSigma_{22}). \]
- en: Similarly, by exchanging the roles of \(\mathbf{X}_1\) and \(\mathbf{X}_2\),
    we see that the marginal density of \(\mathbf{X}_1\) is multivariate Gaussian
    with mean \(\bmu_1\) and covariance \(\bSigma_{11}\). The conditional density
    of \(\mathbf{X}_2\) given \(\mathbf{X}_1\) is multivariate Gaussian with mean
    \(\bmu_{2|1}(\mathbf{X}_1) = \bmu_2 + \bSigma_{21} \bSigma_{11}^{-1} (\mathbf{X}_1
    - \bmu_1)\) and covariance \(\bSigma/\bSigma_{11} = \bSigma_{22} - \bSigma_{12}^T
    \bSigma_{11}^{-1} \bSigma_{12}\).
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 同样地，通过交换 \(\mathbf{X}_1\) 和 \(\mathbf{X}_2\) 的角色，我们可以看到 \(\mathbf{X}_1\) 的边缘密度是具有均值
    \(\bmu_1\) 和协方差 \(\bSigma_{11}\) 的多元高斯分布。给定 \(\mathbf{X}_1\) 的 \(\mathbf{X}_2\)
    的条件密度是具有均值 \(\bmu_{2|1}(\mathbf{X}_1) = \bmu_2 + \bSigma_{21} \bSigma_{11}^{-1}
    (\mathbf{X}_1 - \bmu_1)\) 和协方差 \(\bSigma/\bSigma_{11} = \bSigma_{22} - \bSigma_{12}^T
    \bSigma_{11}^{-1} \bSigma_{12}\) 的多元高斯分布。
- en: '**KNOWLEDGE CHECK:** Suppose \((X_1, X_2)\) is a bivariate Gaussian with mean
    \((0,0)\), variances \(2\) and correlation coefficient \(-1/2\). Conditioned on
    \(X_2 = 1\), what is the mean of \(X_1\)?'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: '**知识检查：** 假设 \((X_1, X_2)\) 是一个均值为 \((0,0)\)，方差为 \(2\)，相关系数为 \(-1/2\) 的双变量高斯分布。在
    \(X_2 = 1\) 的条件下，\(X_1\) 的均值是多少？'
- en: a) \(1/2\)
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: a) \(1/2\)
- en: b) \(-1/2\)
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: b) \(-1/2\)
- en: c) \(1\)
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: c) \(1\)
- en: d) \(-1\)
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: d) \(-1\)
- en: \(\checkmark\)
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: \(\checkmark\)
- en: 6.5.2\. Kalman filter[#](#kalman-filter "Link to this heading")
  id: totrans-125
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 6.5.2\. 卡尔曼滤波[#](#kalman-filter "链接到这个标题")
- en: We consider a stochastic process\(\idx{stochastic process}\xdi\) \(\{\bX_t\}_{t=0}^T\)
    (i.e., a collection of random vectors – often indexed by time) with state space
    \(\S = \mathbb{R}^{d_0}\) of the following form
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 我们考虑一个随机过程\(\idx{随机过程}\xdi\) \(\{\bX_t\}_{t=0}^T\)（即一组随机向量——通常按时间索引）的状态空间 \(\S
    = \mathbb{R}^{d_0}\) 的以下形式
- en: \[ \bX_{t+1} = F \,\bX_t + \bW_t \]
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bX_{t+1} = F \,\bX_t + \bW_t \]
- en: where the \(\bW_t\)s are i.i.d. \(N_{d_0}(\mathbf{0}, Q)\) and \(F\) and \(Q\)
    are known \(d_0 \times d_0\) matrices. We denote the initial state by \(\bX_0
    \sim N_{d_0}(\bmu_0, \bSigma_0)\). We assume that the process \(\{\bX_t\}_{t=1}^T\)
    is not observed, but rather that an auxiliary observed process \(\{\bY_t\}_{t=1}^T\)
    with state space \(\S = \mathbb{R}^{d}\) satisfies
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 其中，\(\bW_t\)s 是独立同分布的 \(N_{d_0}(\mathbf{0}, Q)\)，\(F\) 和 \(Q\) 是已知的 \(d_0 \times
    d_0\) 矩阵。我们用 \(\bX_0 \sim N_{d_0}(\bmu_0, \bSigma_0)\) 表示初始状态。我们假设过程 \(\{\bX_t\}_{t=1}^T\)
    没有被观察到，而是辅助观察过程 \(\{\bY_t\}_{t=1}^T\) 满足状态空间 \(\S = \mathbb{R}^{d}\)，满足以下条件
- en: \[ \bY_t = H\,\bX_t + \bV_t \]
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bY_t = H\,\bX_t + \bV_t \]
- en: where the \(\bV_t\)s are i.i.d. \(N_d(\mathbf{0}, R)\) and \(H \in \mathbb{R}^{d
    \times d_0}\) and \(R \in \mathbb{R}^{d \times d}\) are known matrices. This is
    an example of a linear-Gaussian system\(\idx{linear-Gaussian system}\xdi\) (also
    known as linear-Gaussian state space model).
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 其中，\(\bV_t\)s 是独立同分布的 \(N_d(\mathbf{0}, R)\)，\(H \in \mathbb{R}^{d \times d_0}\)
    和 \(R \in \mathbb{R}^{d \times d}\) 是已知的矩阵。这是一个线性高斯系统\(\idx{线性高斯系统}\xdi\)（也称为线性高斯状态空间模型）的例子。
- en: 'Our goal is to infer the unobserved states given the observed process. Specifically,
    we look at the filtering problem. Quoting [Wikipedia](https://en.wikipedia.org/wiki/Hidden_Markov_model#Filtering):'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的目标是根据观察过程推断未观察到的状态。具体来说，我们考虑滤波问题。引用 [维基百科](https://en.wikipedia.org/wiki/Hidden_Markov_model#Filtering)：
- en: The task is to compute, given the model’s parameters and a sequence of observations,
    the distribution over hidden states of the last latent variable at the end of
    the sequence, i.e. to compute P(x(t)|y(1),…,y(t)). This task is normally used
    when the sequence of latent variables is thought of as the underlying states that
    a process moves through at a sequence of points of time, with corresponding observations
    at each point in time. Then, it is natural to ask about the state of the process
    at the end.
  id: totrans-132
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 任务是计算给定模型参数和一系列观察值后，序列末尾最后一个潜在状态的分布，即计算 P(x(t)|y(1),…,y(t))。当认为潜在变量的序列是过程在一系列时间点移动的潜在状态，每个时间点都有相应的观察值时，通常使用此任务。然后，自然要询问过程在序列末尾的状态。
- en: '**Key lemma** Given the structure of the linear-Gaussian model, the following
    lemma will play a key role.'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: '**关键引理** 给定线性高斯模型的结构，以下引理将发挥关键作用。'
- en: '**LEMMA** **(Linear-Gaussian System)** \(\idx{linear-Gaussian system lemma}\xdi\)
    Let \(\bW \sim N_{d}(\bmu, \bSigma)\) and \(\bW''|\bW \sim N_{d''}(A \,\bW, \bSigma'')\)
    where \(A \in \mathbb{R}^{d'' \times d}\) is a deterministic matrix, and \(\bSigma
    \in \mathbb{R}^{d \times d}\) and \(\bSigma'' \in \mathbb{R}^{d'' \times d''}\)
    are positive definite. Then, \((\bW, \bW'')\) is multivariate Gaussian with mean
    vector'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: '**引理** **(线性高斯系统)** \(\idx{线性高斯系统引理}\xdi\) 设 \(\bW \sim N_{d}(\bmu, \bSigma)\)
    和 \(\bW''|\bW \sim N_{d''}(A \,\bW, \bSigma'')\)，其中 \(A \in \mathbb{R}^{d'' \times
    d}\) 是一个确定性矩阵，\(\bSigma \in \mathbb{R}^{d \times d}\) 和 \(\bSigma'' \in \mathbb{R}^{d''
    \times d''}\) 是正定的。那么，\((\bW, \bW'')\) 是多元高斯分布，其均值向量为'
- en: \[\begin{split} \bmu'' = \begin{pmatrix} \bmu \\ A\bmu \end{pmatrix} \end{split}\]
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bmu'' = \begin{pmatrix} \bmu \\ A\bmu \end{pmatrix} \end{split}\]
- en: and positive definite covariance matrix
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 和正定的协方差矩阵
- en: \[\begin{split} \bSigma'' = \begin{pmatrix} \bSigma & \bSigma A^T\\ A \bSigma
    & A \bSigma A^T + \bSigma' \end{pmatrix}. \end{split}\]
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bSigma'' = \begin{pmatrix} \bSigma & \bSigma A^T\\ A \bSigma
    & A \bSigma A^T + \bSigma' \end{pmatrix}. \end{split}\]
- en: \(\flat\)
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: \(\flat\)
- en: '**KNOWLEDGE CHECK:** What are the dimensions of each block of \(\bSigma''''\)?
    \(\checkmark\)'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: '**知识检查：** \(\bSigma''''\) 的每个块的维度是多少？ \(\checkmark\)'
- en: '*Proof:* We have'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明：* 我们有'
- en: \[\begin{align*} &f_{\bW, \bW'}(\bw, \bw')\\ &= f_{\bW}(\bw) \, f_{\bW'|\bW}(\bw'|\bw)\\
    &\propto \exp\left(-\frac{1}{2}(\bw - \bmu)^T \bSigma^{-1} (\bw - \bmu)\right)\\
    & \qquad \times \exp\left(-\frac{1}{2}(\bw' - A \bw)^T (\bSigma')^{-1} (\bw' -
    A \bw)\right)\\ &\propto \exp\left(-\frac{1}{2}\left[(\bw - \bmu)^T \bSigma^{-1}
    (\bw - \bmu) + (\bw' - A \bw)^T (\bSigma')^{-1} (\bw' - A \bw)\right]\right).
    \end{align*}\]
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &f_{\bW, \bW'}(\bw, \bw')\\ &= f_{\bW}(\bw) \, f_{\bW'|\bW}(\bw'|\bw)\\
    &\propto \exp\left(-\frac{1}{2}(\bw - \bmu)^T \bSigma^{-1} (\bw - \bmu)\right)\\
    & \qquad \times \exp\left(-\frac{1}{2}(\bw' - A \bw)^T (\bSigma')^{-1} (\bw' -
    A \bw)\right)\\ &\propto \exp\left(-\frac{1}{2}\left[(\bw - \bmu)^T \bSigma^{-1}
    (\bw - \bmu) + (\bw' - A \bw)^T (\bSigma')^{-1} (\bw' - A \bw)\right]\right).
    \end{align*}\]
- en: We re-write the quadratic function in square brackets in the exponent as follows
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将指数中的平方函数重写如下
- en: \[\begin{align*} &(\bw - \bmu)^T \bSigma^{-1} (\bw - \bmu) + (\bw' - A \bw)^T
    (\bSigma')^{-1} (\bw' - A \bw)\\ &=(\bw - \bmu)^T \bSigma^{-1} (\bw - \bmu)\\
    & \qquad + ([\bw' - A\bmu] - A[\bw-\bmu])^T (\bSigma')^{-1} ([\bw' - A\bmu] -
    A[\bw-\bmu])\\ &=(\bw - \bmu)^T (A^T (\bSigma')^{-1} A + \bSigma^{-1}) (\bw -
    \bmu)\\ & \qquad - 2 (\bw-\bmu)^T A^T (\bSigma')^{-1} (\bw' - A\bmu) + (\bw' -
    A\bmu)^T (\bSigma')^{-1} (\bw' - A\bmu)\\ &= \begin{pmatrix} \bw - \bmu \\ \bw'
    - A\bmu \end{pmatrix}^T \begin{pmatrix} A^T (\bSigma')^{-1} A + \bSigma^{-1} &
    - A^T (\bSigma')^{-1}\\ - (\bSigma')^{-1} A & (\bSigma')^{-1} \end{pmatrix} \begin{pmatrix}
    \bw - \bmu \\ \bw' - A\bmu \end{pmatrix}\\ &= \begin{pmatrix} \bw - \bmu \\ \bw'
    - A\bmu \end{pmatrix}^T \bLambda'' \begin{pmatrix} \bw - \bmu \\ \bw' - A\bmu
    \end{pmatrix}, \end{align*}\]
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &(\bw - \bmu)^T \bSigma^{-1} (\bw - \bmu) + (\bw' - A \bw)^T
    (\bSigma')^{-1} (\bw' - A \bw)\\ &=(\bw - \bmu)^T \bSigma^{-1} (\bw - \bmu)\\
    & \qquad + ([\bw' - A\bmu] - A[\bw-\bmu])^T (\bSigma')^{-1} ([\bw' - A\bmu] -
    A[\bw-\bmu])\\ &=(\bw - \bmu)^T (A^T (\bSigma')^{-1} A + \bSigma^{-1}) (\bw -
    \bmu)\\ & \qquad - 2 (\bw-\bmu)^T A^T (\bSigma')^{-1} (\bw' - A\bmu) + (\bw' -
    A\bmu)^T (\bSigma')^{-1} (\bw' - A\bmu)\\ &= \begin{pmatrix} \bw - \bmu \\ \bw'
    - A\bmu \end{pmatrix}^T \begin{pmatrix} A^T (\bSigma')^{-1} A + \bSigma^{-1} &
    - A^T (\bSigma')^{-1}\\ - (\bSigma')^{-1} A & (\bSigma')^{-1} \end{pmatrix} \begin{pmatrix}
    \bw - \bmu \\ \bw' - A\bmu \end{pmatrix}\\ &= \begin{pmatrix} \bw - \bmu \\ \bw'
    - A\bmu \end{pmatrix}^T \bLambda'' \begin{pmatrix} \bw - \bmu \\ \bw' - A\bmu
    \end{pmatrix}, \end{align*}\]
- en: where the last line defines \(\bLambda''\) and the second line shows that it
    is positive definite (why?). We have shown that \((\bW, \bW')\) is multivariate
    Gaussian with mean \((\bmu, A\bmu)\).
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 其中最后一行定义了 \(\bLambda''\)，第二行显示它是正定的（为什么？）。我们已经证明了 \((\bW, \bW')\) 是具有均值 \((\bmu,
    A\bmu)\) 的多元高斯分布。
- en: We use the *Inverting a Block Matrix Lemma* to invert \(\bLambda''\) and reveal
    the covariance matrix. (One could also compute the covariance directly; try it!)
    We break up \(\bLambda''\) into blocks
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用**逆矩阵块引理**来求逆 \(\bLambda''\) 并揭示协方差矩阵。 (也可以直接计算协方差；试试看！) 我们将 \(\bLambda''\)
    分解为块
- en: \[\begin{split} \bLambda'' = \begin{pmatrix} \bLambda''_{11} & \bLambda''_{12}\\
    (\bLambda''_{12})^T & \bLambda''_{22} \end{pmatrix} \end{split}\]
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bLambda'' = \begin{pmatrix} \bLambda''_{11} & \bLambda''_{12}\\
    (\bLambda''_{12})^T & \bLambda''_{22} \end{pmatrix} \end{split}\]
- en: where \(\bLambda''_{11} \in \mathbb{R}^{d \times d}\), \(\bLambda''_{22} \in
    \mathbb{R}^{d' \times d'}\), and \(\bLambda''_{12} \in \mathbb{R}^{d \times d'}\).
    Recall that the inverse is
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(\bLambda''_{11} \in \mathbb{R}^{d \times d}\)，\(\bLambda''_{22} \in \mathbb{R}^{d'
    \times d'}\)，和 \(\bLambda''_{12} \in \mathbb{R}^{d \times d'}\)。回忆一下，逆矩阵是
- en: \[\begin{split} B^{-1} = \begin{pmatrix} (B/B_{22})^{-1} & -(B/B_{22})^{-1}
    B_{12} B_{22}^{-1}\\ -B_{22}^{-1} B_{12}^T (B/B_{22})^{-1} & B_{22}^{-1} B_{12}^T
    (B/B_{22})^{-1} B_{12} B_{22}^{-1} + B_{22}^{-1} \end{pmatrix} \end{split}\]
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} B^{-1} = \begin{pmatrix} (B/B_{22})^{-1} & -(B/B_{22})^{-1}
    B_{12} B_{22}^{-1}\\ -B_{22}^{-1} B_{12}^T (B/B_{22})^{-1} & B_{22}^{-1} B_{12}^T
    (B/B_{22})^{-1} B_{12} B_{22}^{-1} + B_{22}^{-1} \end{pmatrix} \end{split}\]
- en: where here \(B = \bLambda''\).
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 其中这里 \(B = \bLambda''\).
- en: The Schur complement is
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: Schur 补是
- en: \[\begin{align*} \bLambda'' / \bLambda''_{22} &= \bLambda''_{11} - \bLambda''_{12}
    (\bLambda''_{22})^{-1} (\bLambda''_{12})^T\\ &= A^T (\bSigma')^{-1} A + \bSigma^{-1}
    - (- A^T (\bSigma')^{-1}) ((\bSigma')^{-1})^{-1} (- A^T (\bSigma')^{-1})^T\\ &=
    A^T (\bSigma')^{-1} A + \bSigma^{-1} - A^T (\bSigma')^{-1} \bSigma' (\bSigma')^{-1}
    A\\ &= A^T (\bSigma')^{-1} A + \bSigma^{-1} - A^T (\bSigma')^{-1} A\\ &= \bSigma^{-1}.
    \end{align*}\]
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \bLambda'' / \bLambda''_{22} &= \bLambda''_{11} - \bLambda''_{12}
    (\bLambda''_{22})^{-1} (\bLambda''_{12})^T\\ &= A^T (\bSigma')^{-1} A + \bSigma^{-1}
    - (- A^T (\bSigma')^{-1}) ((\bSigma')^{-1})^{-1} (- A^T (\bSigma')^{-1})^T\\ &=
    A^T (\bSigma')^{-1} A + \bSigma^{-1} - A^T (\bSigma')^{-1} \bSigma' (\bSigma')^{-1}
    A\\ &= A^T (\bSigma')^{-1} A + \bSigma^{-1} - A^T (\bSigma')^{-1} A\\ &= \bSigma^{-1}.
    \end{align*}\]
- en: Hence \((\bLambda'' / \bLambda''_{22})^{-1} = \bSigma\).
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 因此 \((\bLambda'' / \bLambda''_{22})^{-1} = \bSigma\).
- en: Moreover,
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，
- en: \[\begin{align*} - (\bLambda''/\bLambda''_{22})^{-1} \bLambda''_{12} (\bLambda''_{22})^{-1}
    &= - \bSigma (- A^T (\bSigma')^{-1}) ((\bSigma')^{-1})^{-1}\\ &= \bSigma A^T (\bSigma')^{-1}
    \bSigma'\\ &= \bSigma A^T \end{align*}\]
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} - (\bLambda''/\bLambda''_{22})^{-1} \bLambda''_{12} (\bLambda''_{22})^{-1}
    &= - \bSigma (- A^T (\bSigma')^{-1}) ((\bSigma')^{-1})^{-1}\\ &= \bSigma A^T (\bSigma')^{-1}
    \bSigma'\\ &= \bSigma A^T \end{align*}\]
- en: and
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 以及
- en: \[\begin{align*} &(\bLambda''_{22})^{-1} (\bLambda''_{12})^T (\bLambda''/\bLambda''_{22})^{-1}
    \bLambda''_{12} (\bLambda''_{22})^{-1} + (\bLambda''_{22})^{-1}\\ &= ((\bSigma')^{-1})^{-1}
    (- A^T (\bSigma')^{-1})^T \bSigma (-A^T (\bSigma')^{-1}) ((\bSigma')^{-1})^{-1}
    + ((\bSigma')^{-1})^{-1}\\ &= \bSigma' (\bSigma')^{-1} A \bSigma A^T (\bSigma')^{-1}
    \bSigma' + \bSigma'\\ &= A \bSigma A^T + \bSigma'. \end{align*}\]
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &(\bLambda''_{22})^{-1} (\bLambda''_{12})^T (\bLambda''/\bLambda''_{22})^{-1}
    \bLambda''_{12} (\bLambda''_{22})^{-1} + (\bLambda''_{22})^{-1}\\ &= ((\bSigma')^{-1})^{-1}
    (- A^T (\bSigma')^{-1})^T \bSigma (-A^T (\bSigma')^{-1}) ((\bSigma')^{-1})^{-1}
    + ((\bSigma')^{-1})^{-1}\\ &= \bSigma' (\bSigma')^{-1} A \bSigma A^T (\bSigma')^{-1}
    \bSigma' + \bSigma'\\ &= A \bSigma A^T + \bSigma'. \end{align*}\]
- en: Plugging back into the formula for the inverse of a block matrix completes the
    proof. \(\square\)
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 将其代入块矩阵逆的公式中，完成证明。 \(\square\)
- en: '**Joint distribution** We extend our previous notation as follows: for two
    disjoint, finite collections of random vectors \(\{\mathbf{U}_i\}_i\) and \(\{\mathbf{W}_j\}_j\)
    defined on the same probability space, we let \(f_{\{\mathbf{U}_i\}_i, \{\mathbf{W}_j\}_j}\)
    be their joint density, \(f_{\{\mathbf{U}_i\}_i | \{\mathbf{W}_j\}_j}\) be the
    conditional density of \(\{\mathbf{U}_i\}_i\) given \(\{\mathbf{W}_j\}_j\), and
    \(f_{\{\mathbf{U}_i\}_i}\) be the marginal density of \(\{\mathbf{U}_i\}_i\).
    Formally, our goal is to compute'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '**联合分布** 我们将之前的符号扩展如下：对于在相同概率空间上定义的两个不相交的有限随机向量集合 \(\{\mathbf{U}_i\}_i\) 和
    \(\{\mathbf{W}_j\}_j\)，我们令 \(f_{\{\mathbf{U}_i\}_i, \{\mathbf{W}_j\}_j}\) 为它们的联合密度，\(f_{\{\mathbf{U}_i\}_i
    | \{\mathbf{W}_j\}_j}\) 为 \(\{\mathbf{U}_i\}_i\) 在 \(\{\mathbf{W}_j\}_j\) 条件下的条件密度，\(f_{\{\mathbf{U}_i\}_i}\)
    为 \(\{\mathbf{U}_i\}_i\) 的边缘密度。形式上，我们的目标是计算'
- en: \[ f_{\bX_{t}|\bY_{1:t}} := f_{\{\bX_{t}\}|\{\bY_1,\ldots,\bY_{t}\}} \]
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f_{\bX_{t}|\bY_{1:t}} := f_{\{\bX_{t}\}|\{\bY_1,\ldots,\bY_{t}\}} \]
- en: recursively in \(t\), where we define \(\bY_{1:t} = \{\bY_1,\ldots,\bY_{t}\}\).
    We will see that all densities appearing in this calculation are multivariate
    Gaussians, and therefore keeping track of the means and covariances will suffice.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 在 \(t\) 上递归地定义，其中我们定义 \(\bY_{1:t} = \{\bY_1,\ldots,\bY_{t}\}\)。我们将看到在此计算中出现的所有密度都是多元高斯分布，因此跟踪均值和协方差就足够了。
- en: Formally, we posit that the density of the full process (with both observed
    and unobserved parts) is
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 形式上，我们假设整个过程（包括观测和未观测部分）的密度为
- en: \[ f_{\bX_0}(\bx_0) \prod_{t=1}^{T} f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})
    f_{\bY_{t}|\bX_{t}}(\by_{t}|\bx_{t}) \]
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f_{\bX_0}(\bx_0) \prod_{t=1}^{T} f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})
    f_{\bY_{t}|\bX_{t}}(\by_{t}|\bx_{t}) \]
- en: where the description of the model stipulates that
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 其中模型的描述规定如下
- en: \[ \bX_{t}|\bX_{t-1} \sim N_{d_0}(F \,\bX_{t-1}, Q). \]
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bX_{t}|\bX_{t-1} \sim N_{d_0}(F \,\bX_{t-1}, Q). \]
- en: and
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 以及
- en: \[ \bY_t|\bX_t \sim N_d(H\,\bX_t, R) \]
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bY_t|\bX_t \sim N_d(H\,\bX_t, R) \]
- en: for all \(t \geq 1\) and \(\bX_0 \sim N_{d_0}(\bmu_0, \bSigma_0)\). We assume
    that \(\bmu_0\) and \(\bSigma_0\) are known. Applying the *Linear-Gaussian System
    Lemma* inductively shows that the full process \((\bX_{0:T}, \bY_{1:T})\) is jointly
    multivariate Gaussian (try it!). In particular, all marginals and conditionals
    are multivariate Gaussians.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 对于所有 \(t \geq 1\) 和 \(\bX_0 \sim N_{d_0}(\bmu_0, \bSigma_0)\)。我们假设 \(\bmu_0\)
    和 \(\bSigma_0\) 是已知的。通过归纳应用 *线性高斯系统引理*，我们可以证明整个过程 \((\bX_{0:T}, \bY_{1:T})\) 是联合多元高斯分布（试试看！）特别是，所有边缘和条件都是多元高斯分布。
- en: Graphically, it can be represented as follows, where as before each variable
    is a node and its conditional distribution depends only on its parent nodes.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 图形上，它可以表示如下，其中每个变量是一个节点，其条件分布只依赖于其父节点。
- en: '![HMM (with help from Claude)](../Images/dff6cc66efbd6ca33102a19a1e83e4b7.png)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![HMM (with help from Claude)](../Images/dff6cc66efbd6ca33102a19a1e83e4b7.png)'
- en: '**Conditional independence** The stipulated form of the joint density of the
    full process implies many conditional independence relations. We will need the
    following two:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: '**条件独立性** 全过程联合密度的规定形式暗示了许多条件独立性关系。我们需要以下两个：'
- en: 1- \(\bX_t\) is conditionally independent of \(\bY_{1:t-1}\) given \(\bX_{t-1}\)
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 1- 在给定 \(\bX_{t-1}\) 的条件下，\(\bX_t\) 与 \(\bY_{1:t-1}\) 是条件独立的。
- en: 2- \(\bY_t\) is conditionally independent of \(\bY_{1:t-1}\) given \(\bX_{t}\).
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 2- 在给定 \(\bX_{t}\) 的条件下，\(\bY_t\) 与 \(\bY_{1:t-1}\) 是条件独立的。
- en: 'We prove the first one and leave the second one as an exercise. In fact, we
    prove something stronger: \(\bX_t\) is conditionally independent of \(\bX_{0:t-2},
    \bY_{1:t-1}\) given \(\bX_{t-1}\).'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 我们证明第一个，并将第二个留作练习。实际上，我们证明了一个更强的结论：\(\bX_t\) 在给定 \(\bX_{t-1}\) 的条件下与 \(\bX_{0:t-2},
    \bY_{1:t-1}\) 条件独立。
- en: First, by integrating over \(\by_T\), then \(\bx_{T}\), then \(\by_{T-1}\),
    then \(\bx_{T-1}\), … , then \(\by_t\), we see that the joint density of \((\bX_{0:t},
    \bY_{1:t-1})\) is
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，通过积分 \(\by_T\)，然后 \(\bx_{T}\)，然后 \(\by_{T-1}\)，然后 \(\bx_{T-1}\)，……，然后 \(\by_t\)，我们看到
    \((\bX_{0:t}, \bY_{1:t-1})\) 的联合密度是
- en: \[ f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right) f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1}).
    \]
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right) f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1}).
    \]
- en: Similarly, the joint density of \((\bX_{0:t-1}, \bY_{1:t-1})\) is
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 类似地，\((\bX_{0:t-1}, \bY_{1:t-1})\) 的联合密度是
- en: \[ f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right). \]
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right). \]
- en: The conditional density given \(\bX_{t-1}\) is then obtained by dividing the
    first expression by the marginal density of \(\bX_{t-1}\)
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 给定 \(\bX_{t-1}\) 的条件密度是通过将第一个表达式除以 \(\bX_{t-1}\) 的边缘密度得到的
- en: \[\begin{align*} &\frac{f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right) f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})}{f_{\bX_{t-1}}(\bx_{t-1})}\\
    &= \frac{f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right) f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})}{f_{\bX_{t-1}}(\bx_{t-1})}\\
    &= \frac{f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right) }{f_{\bX_{t-1}}(\bx_{t-1})}f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})\\
    &= f_{\bX_{0:t-2}, \bY_{1:t-1}|\bX_{t-1}}(\bx_{0:t-2}, \by_{1:t-1}|\bx_{t-1})
    f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})\\ \end{align*}\]
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &\frac{f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right) f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})}{f_{\bX_{t-1}}(\bx_{t-1})}\\
    &= \frac{f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right) f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})}{f_{\bX_{t-1}}(\bx_{t-1})}\\
    &= \frac{f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right) }{f_{\bX_{t-1}}(\bx_{t-1})}f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})\\
    &= f_{\bX_{0:t-2}, \bY_{1:t-1}|\bX_{t-1}}(\bx_{0:t-2}, \by_{1:t-1}|\bx_{t-1})
    f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})\\ \end{align*}\]
- en: as claimed.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 如所述。
- en: '**Algorithm** \(\idx{Kalman filter}\xdi\) We give a recursive algorithm for
    solving the filtering problem, that is, for computing the mean vector and covariance
    matrix of the conditional density \(f_{\bX_{t}|\bY_{1:t}}\).'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: '**算法** \(\idx{卡尔曼滤波}\xdi\) 我们给出一个递归算法来解决滤波问题，即计算条件密度 \(f_{\bX_{t}|\bY_{1:t}}\)
    的均值向量和协方差矩阵。'
- en: '*Initial step:* The first compute \(f_{\bX_1|\bY_1}\). We do this through a
    series of observations which will generalize straightforwardly.'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: '**初始步骤**：首先计算 \(f_{\bX_1|\bY_1}\)。我们通过一系列观察来完成这一任务，这些观察将直接推广。'
- en: 1- We have \(\bX_0 \sim N_{d_0}(\bmu_0, \bSigma_0)\) and \(\bX_{1}|\bX_{0} \sim
    N_{d_0}(F \,\bX_0, Q)\). So, by the *Linear-Gaussian System Lemma*, the joint
    vector \((\bX_0, \bX_{1})\) is multivariate Gaussian with mean vector \((\bmu_0,
    F \bmu_0)\) and covariance matrix
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 1- 我们有 \(\bX_0 \sim N_{d_0}(\bmu_0, \bSigma_0)\) 和 \(\bX_{1}|\bX_{0} \sim N_{d_0}(F
    \,\bX_0, Q)\)。因此，根据**线性高斯系统引理**，联合向量 \((\bX_0, \bX_{1})\) 是具有均值向量 \((\bmu_0, F
    \bmu_0)\) 和协方差矩阵的多变量高斯分布
- en: \[\begin{split} \begin{pmatrix} \bSigma_0 & \bSigma_0 F^T\\ F \bSigma_0 & F
    \bSigma_0 F^T + Q \end{pmatrix}. \end{split}\]
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} \bSigma_0 & \bSigma_0 F^T\\ F \bSigma_0 & F
    \bSigma_0 F^T + Q \end{pmatrix}. \end{split}\]
- en: Hence the marginal density of \(\bX_{1}\) is multivariate Gaussian with mean
    vector \(F \bmu_0\) and covariance matrix
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，\(\bX_{1}\) 的边缘密度是具有均值向量 \(F \bmu_0\) 和协方差矩阵的多变量高斯分布
- en: \[ P_0 := F \bSigma_0 F^T + Q. \]
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: \[ P_0 := F \bSigma_0 F^T + Q. \]
- en: 2- Combining the previous observation about the marginal density of \(\bX_{1}\)
    with the fact that \(\bY_1|\bX_1 \sim N_d(H\,\bX_1, R)\), the *Linear-Gaussian
    System Lemma* says that \((\bX_1, \bY_{1})\) is multivariate Gaussian with mean
    vector \((F \bmu_0, H F \bmu_0)\) and covariance matrix
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 2- 将关于 \(\bX_{1}\) 边缘密度的先前观察与 \(\bY_1|\bX_1 \sim N_d(H\,\bX_1, R)\) 的实际情况结合起来，**线性高斯系统引理**表明
    \((\bX_1, \bY_{1})\) 是具有均值向量 \((F \bmu_0, H F \bmu_0)\) 和协方差矩阵的多变量高斯分布
- en: \[\begin{split} \begin{pmatrix} P_0 & P_0 H^T\\ H P_0 & H P_0 H^T + R \end{pmatrix}.
    \end{split}\]
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} P_0 & P_0 H^T\\ H P_0 & H P_0 H^T + R \end{pmatrix}.
    \end{split}\]
- en: Finally, define \(K_1 := P_0 H^T (H P_0 H^T + R)^{-1}\). This new observation
    and the conditional density formula give that
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，定义 \(K_1 := P_0 H^T (H P_0 H^T + R)^{-1}\)。这个新的观测和条件密度公式给出
- en: \[ \bX_1|\bY_1 \sim N_d(\bmu_1, \bSigma_1) \]
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bX_1|\bY_1 \sim N_d(\bmu_1, \bSigma_1) \]
- en: where we define
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 其中我们定义
- en: \[\begin{align*} \bmu_1 &:= F \bmu_0 + P_0 H^T (H P_0 H^T + R)^{-1} (\mathbf{Y}_1
    - H F \bmu_0)\\ &= F \bmu_0 + K_1 (\mathbf{Y}_1 - H F \bmu_0) \end{align*}\]
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \bmu_1 &:= F \bmu_0 + P_0 H^T (H P_0 H^T + R)^{-1} (\mathbf{Y}_1
    - H F \bmu_0)\\ &= F \bmu_0 + K_1 (\mathbf{Y}_1 - H F \bmu_0) \end{align*}\]
- en: and
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 并且
- en: \[\begin{align*} \bSigma_1 &:= P_0 - P_0 H^T (H P_0 H^T + R)^{-1} H P_0\\ &=
    (I_{d_0 \times d_0} - K_1 H) P_0. \end{align*}\]
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \bSigma_1 &:= P_0 - P_0 H^T (H P_0 H^T + R)^{-1} H P_0\\ &=
    (I_{d_0 \times d_0} - K_1 H) P_0. \end{align*}\]
- en: '*General step:* Assuming by induction that \(\bX_{t-1}|\bY_{1:t-1} \sim N_{d_0}(\bmu_{t-1},
    \bSigma_{t-1})\) where \(\bmu_{t-1}\) depends implicitly on \(\bY_{1:t-1}\) (but
    \(\bSigma_{t-1}\) does not), we deduce the next step. It mimics closely the initial
    step.'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: '*一般步骤:* 假设通过归纳法，\(\bX_{t-1}|\bY_{1:t-1} \sim N_{d_0}(\bmu_{t-1}, \bSigma_{t-1})\)，其中
    \(\bmu_{t-1}\) 依赖于 \(\bY_{1:t-1}\)（但 \(\bSigma_{t-1}\) 不依赖），我们推导出下一步。它非常接近初始步骤。'
- en: '1- Predict: We first “predict” \(\bX_{t}\) given \(\bY_{1:t-1}\). We use the
    fact that \(\bX_{t-1}|\bY_{1:t-1} \sim N_{d_0}(\bmu_{t-1}, \bSigma_{t-1})\). Moreover,
    we have that \(\bX_{t}|\bX_{t-1} \sim N_{d_0}(F \,\bX_{t-1}, Q)\) and that \(\bX_t\)
    is conditionally independent of \(\bY_{1:t-1}\) given \(\bX_{t-1}\). So, \(\bX_{t}|\{\bX_{t-1},
    \bY_{1:t-1}\} \sim N_{d_0}(F \,\bX_{t-1}, Q)\) by the *Role of Independence Lemma*.
    By the *Linear-Gaussian System Lemma*, the joint vector \((\bX_{t-1}, \bX_{t})\)
    conditioned on \(\bY_{1:t-1}\) is multivariate Gaussian with mean vector \((\bmu_{t-1},
    F \bmu_{t-1})\) and covariance matrix'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 1- 预测：我们首先根据 \(\bY_{1:t-1}\) “预测” \(\bX_{t}\)。我们使用 \(\bX_{t-1}|\bY_{1:t-1} \sim
    N_{d_0}(\bmu_{t-1}, \bSigma_{t-1})\) 的事实。此外，我们有 \(\bX_{t}|\bX_{t-1} \sim N_{d_0}(F
    \,\bX_{t-1}, Q)\) 并且 \(\bX_t\) 在给定 \(\bX_{t-1}\) 的条件下与 \(\bY_{1:t-1}\) 条件独立。因此，根据
    *独立性角色公理*，\(\bX_{t}|\{\bX_{t-1}, \bY_{1:t-1}\} \sim N_{d_0}(F \,\bX_{t-1}, Q)\)。根据
    *线性高斯系统公理*，条件在 \(\bY_{1:t-1}\) 上 \((\bX_{t-1}, \bX_{t})\) 的联合向量是具有均值向量 \((\bmu_{t-1},
    F \bmu_{t-1})\) 和协方差矩阵的多变量高斯分布
- en: \[\begin{split} \begin{pmatrix} \bSigma_{t-1} & \bSigma_{t-1} F^T\\ F \bSigma_{t-1}
    & F \bSigma_{t-1} F^T + Q \end{pmatrix}. \end{split}\]
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} \bSigma_{t-1} & \bSigma_{t-1} F^T\\ F \bSigma_{t-1}
    & F \bSigma_{t-1} F^T + Q \end{pmatrix}. \end{split}\]
- en: As a consequence, the conditional marginal density of \(\bX_{t}\) given \(\bY_{1:t-1}\)
    is multivariate Gaussian with mean vector \(F \bmu_{t-1}\) and covariance matrix
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，给定 \(\bY_{1:t-1}\) 的 \(\bX_{t}\) 的条件边缘密度是具有均值向量 \(F \bmu_{t-1}\) 和协方差矩阵的多变量高斯分布
- en: \[ P_{t-1} := F \bSigma_{t-1} F^T + Q. \]
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: \[ P_{t-1} := F \bSigma_{t-1} F^T + Q. \]
- en: '2- Update: Next we “update” our prediction of \(\bX_{t}\) using the new observation
    \(\bY_{t}\). We have that \(\bY_{t}|\bX_{t} \sim N_d(H\,\bX_{t}, R)\) and that
    \(\bY_t\) is conditionally independent of \(\bY_{1:t-1}\) given \(\bX_{t}\). So
    \(\bY_{t}|\{\bX_{t}, \bY_{1:t-1}\} \sim N_d(H\,\bX_{t}, R)\) by the *Role of Independence*
    lemma. Combining this with the previous observation, the *Linear-Gaussian System*
    lemma says that \((\bX_{t}, \bY_{t})\) given \(\bY_{1:t-1}\) is multivariate Gaussian
    with mean vector \((F \bmu_{t-1}, H F \bmu_{t-1})\) and covariance matrix'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 2- 更新：接下来我们使用新的观测 \(\bY_{t}\) “更新”对 \(\bX_{t}\) 的预测。我们有 \(\bY_{t}|\bX_{t} \sim
    N_d(H\,\bX_{t}, R)\) 并且 \(\bY_t\) 在给定 \(\bX_{t}\) 的条件下与 \(\bY_{1:t-1}\) 条件独立。因此，根据
    *独立性角色* 公理，\(\bY_{t}|\{\bX_{t}, \bY_{1:t-1}\} \sim N_d(H\,\bX_{t}, R)\)。结合之前的观测，*线性高斯系统*
    公理表明，给定 \(\bY_{1:t-1}\) 的 \((\bX_{t}, \bY_{t})\) 是具有均值向量 \((F \bmu_{t-1}, H F
    \bmu_{t-1})\) 和协方差矩阵的多变量高斯分布
- en: \[\begin{split} \begin{pmatrix} P_{t-1} & P_{t-1} H^T\\ H P_{t-1} & H P_{t-1}
    H^T + R \end{pmatrix}. \end{split}\]
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} P_{t-1} & P_{t-1} H^T\\ H P_{t-1} & H P_{t-1}
    H^T + R \end{pmatrix}. \end{split}\]
- en: Finally, define \(K_{t} := P_{t-1} H^T (H P_{t-1} H^T + R)^{-1}\). This new
    observation and the conditional density formula give that
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，定义 \(K_{t} := P_{t-1} H^T (H P_{t-1} H^T + R)^{-1}\)。这个新的观测和条件密度公式给出
- en: \[ \bX_{t}|\{\bY_t, \bY_{1:t-1}\} = \bX_{t}|\bY_{1:t} \sim N_d(\bmu_{t}, \bSigma_{t})
    \]
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bX_{t}|\{\bY_t, \bY_{1:t-1}\} = \bX_{t}|\bY_{1:t} \sim N_d(\bmu_{t}, \bSigma_{t})
    \]
- en: where we define
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 其中我们定义
- en: \[\begin{align*} \bmu_{t} &:= F \bmu_{t-1} + K_{t} (\mathbf{Y}_{t} - H F \bmu_{t-1})
    \end{align*}\]
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \bmu_{t} &:= F \bmu_{t-1} + K_{t} (\mathbf{Y}_{t} - H F \bmu_{t-1})
    \end{align*}\]
- en: and
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 并且
- en: \[\begin{align*} \bSigma_{t} &= (I_{d_0 \times d_0} - K_{t} H) P_{t-1}. \end{align*}\]
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \bSigma_{t} &= (I_{d_0 \times d_0} - K_{t} H) P_{t-1}. \end{align*}\]
- en: '*Summary:* Let \(\bmu_t\) and \(\bSigma_t\) be the mean and covariance matrix
    of \(\bX_t\) conditioned on \(\bY_{1:t}\). The recursions for these quantities
    are the following:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: '*总结：* 设 \(\bmu_t\) 和 \(\bSigma_t\) 为 \(\bX_t\) 在 \(\bY_{1:t}\) 条件下的均值和协方差矩阵。这些量的递推关系如下：'
- en: \[\begin{align*} \bmu_t &= F\,\bmu_{t-1} + K_{t} (\bY_{t} - H F \bmu_{t-1})\\
    \bSigma_t &= (I_{d_0 \times d_0} - K_t H) P_{t-1} \end{align*}\]
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \bmu_t &= F\,\bmu_{t-1} + K_{t} (\bY_{t} - H F \bmu_{t-1})\\
    \bSigma_t &= (I_{d_0 \times d_0} - K_t H) P_{t-1} \end{align*}\]
- en: where
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 其中
- en: \[\begin{align*} P_{t-1} &= F \,\bSigma_{t-1} F^T + Q\\ K_t &= P_{t-1} H^T (H
    P_{t-1} H^T + R)^{-1} \end{align*}\]
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} P_{t-1} &= F \,\bSigma_{t-1} F^T + Q\\ K_t &= P_{t-1} H^T (H
    P_{t-1} H^T + R)^{-1} \end{align*}\]
- en: This last matrix is known as the Kalman gain matrix. The vector \(\bY_{t} -
    H F \bmu_{t-1}\) is referred to as innovation; it compares the new observation
    \(\bY_{t}\) to its predicted expectation \(H F \bmu_{t-1}\) based on the previous
    observations. Hence, in some sense, the Kalman gain matrix\(\idx{Kalman gain matrix}\xdi\)
    represents the “weight” given to the observation at time \(t\) when updating the
    state estimate \(\bmu_t\). The solution above is known as Kalman filtering.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 这个矩阵被称为卡尔曼增益矩阵。向量 \(\bY_{t} - H F \bmu_{t-1}\) 被称为创新；它将新的观测值 \(\bY_{t}\) 与基于先前观测值的预测期望
    \(H F \bmu_{t-1}\) 进行比较。因此，从某种意义上说，卡尔曼增益矩阵\(\idx{Kalman gain matrix}\xdi\) 代表了在更新状态估计
    \(\bmu_t\) 时对时间 \(t\) 的观测所赋予的“权重”。上述解被称为卡尔曼滤波。
- en: '**CHAT & LEARN** Explore the concept of sequential Monte Carlo methods, also
    known as particle filters, as an alternative to the Kalman filter. Ask your favorite
    AI chatbot for an explanation and implementation of a particle filter. Try it
    on this dataset. ([Open In Colab](https://colab.research.google.com/github/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/just_the_code/roch_mmids_chap_prob_notebook.ipynb))
    \(\ddagger\)'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: '**CHAT & LEARN** 探索序列蒙特卡洛方法的概念，也称为粒子滤波器，作为卡尔曼滤波的替代方案。向您喜欢的AI聊天机器人询问粒子滤波器的解释和实现。尝试在数据集上使用它。（[在Colab中打开](https://colab.research.google.com/github/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/just_the_code/roch_mmids_chap_prob_notebook.ipynb))
    \(\ddagger\)'
- en: 6.5.3\. Back to location tracking[#](#back-to-location-tracking "Link to this
    heading")
  id: totrans-214
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 6.5.3\. 返回位置跟踪[#](#back-to-location-tracking "链接到本标题")
- en: We apply Kalman filtering to location tracking. Returning to our cyborg corgi
    example, we imagine that we get noisy observations about its successive positions
    in a park. (Think of GPS measurements.) We seek to get a better estimate of its
    location using the method above.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将卡尔曼滤波应用于位置跟踪。回到我们的机械狗示例，我们想象我们得到了关于它在公园中连续位置的有噪声观测值。（想想GPS测量。）我们希望通过上述方法获得其位置的更好估计。
- en: '**Figure:** Cyborg corgi (*Credit:* Made with [Midjourney](https://www.midjourney.com/))'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: '**图：** 机械狗（*来源：[Midjourney](https://www.midjourney.com/)*）'
- en: '![Cyborg corgi](../Images/348998a4b7d1b53beeec4c9913f351c0.png)'
  id: totrans-217
  prefs: []
  type: TYPE_IMG
  zh: '![机械狗](../Images/348998a4b7d1b53beeec4c9913f351c0.png)'
- en: \(\bowtie\)
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: \(\bowtie\)
- en: We model the true location as a linear-Gaussian system over the 2d position
    \((z_{1,t}, z_{2,t})_t\) and velocity \((\dot{z}_{1,t}, \dot{z}_{2,t})_t\) sampled
    at \(\Delta\) intervals of time. Formally,
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将真实位置建模为在 2 维位置 \((z_{1,t}, z_{2,t})_t\) 和速度 \((\dot{z}_{1,t}, \dot{z}_{2,t})_t\)
    上，以 \(\Delta\) 时间间隔采样的线性高斯系统。形式上，
- en: \[\begin{split} \bX_t = (z_{1,t}, z_{2,t}, \dot{z}_{1,t}, \dot{z}_{2,t}), \quad
    F = \begin{pmatrix} 1 & 0 & \Delta & 0\\ 0 & 1 & 0 & \Delta\\ 0 & 0 & 1 & 0\\
    0 & 0 & 0 & 1 \end{pmatrix}, \end{split}\]
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bX_t = (z_{1,t}, z_{2,t}, \dot{z}_{1,t}, \dot{z}_{2,t}), \quad
    F = \begin{pmatrix} 1 & 0 & \Delta & 0\\ 0 & 1 & 0 & \Delta\\ 0 & 0 & 1 & 0\\
    0 & 0 & 0 & 1 \end{pmatrix}, \end{split}\]
- en: so the unobserved dynamics are
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，未观测到的动力学是
- en: \[\begin{split} \begin{pmatrix} z_{1,t+1}\\ z_{2,t+1}\\ \dot{z}_{1,t+1}\\ \dot{z}_{2,t+1}
    \end{pmatrix} = \bX_{t+1} = F \,\bX_t + \bW_t = \begin{pmatrix} z_{1,t} + \Delta
    \dot{z}_{1,t} + W_{1,t}\\ z_{2,t} + \Delta \dot{z}_{2,t} + W_{2,t}\\ \dot{z}_{1,t}
    + \dot{W}_{1,t}\\ \dot{z}_{2,t} + \dot{W}_{2,t} \end{pmatrix} \end{split}\]
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} z_{1,t+1}\\ z_{2,t+1}\\ \dot{z}_{1,t+1}\\ \dot{z}_{2,t+1}
    \end{pmatrix} = \bX_{t+1} = F \,\bX_t + \bW_t = \begin{pmatrix} z_{1,t} + \Delta
    \dot{z}_{1,t} + W_{1,t}\\ z_{2,t} + \Delta \dot{z}_{2,t} + W_{2,t}\\ \dot{z}_{1,t}
    + \dot{W}_{1,t}\\ \dot{z}_{2,t} + \dot{W}_{2,t} \end{pmatrix} \end{split}\]
- en: where the \(\bW_t = (W_{1,t}, W_{2,t}, \dot{W}_{1,t}, \dot{W}_{2,t}) \sim N_{d_0}(\mathbf{0},
    Q)\) with \(Q\) known.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(\bW_t = (W_{1,t}, W_{2,t}, \dot{W}_{1,t}, \dot{W}_{2,t}) \sim N_{d_0}(\mathbf{0},
    Q)\) 且 \(Q\) 已知。
- en: In words, the velocity is unchanged, up to Gaussian perturbation. The position
    changes proportionally to the velocity in the corresponding dimension, again up
    to Gaussian perturbation.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 用话来说，速度保持不变，直到高斯扰动。位置按相应维度的速度成比例变化，再次直到高斯扰动。
- en: The observations \((\tilde{z}_{1,t}, \tilde{z}_{2,t})_t\) are modeled as
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 观测值 \((\tilde{z}_{1,t}, \tilde{z}_{2,t})_t\) 被建模为
- en: \[\begin{split} \bY_t = (\tilde{z}_{1,t}, \tilde{z}_{2,t}), \quad H = \begin{pmatrix}
    1 & 0 & 0 & 0\\ 0 & 1 & 0 & 0\\ \end{pmatrix}. \end{split}\]
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bY_t = (\tilde{z}_{1,t}, \tilde{z}_{2,t}), \quad H = \begin{pmatrix}
    1 & 0 & 0 & 0\\ 0 & 1 & 0 & 0\\ \end{pmatrix}. \end{split}\]
- en: so the observed process satisfies
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，观测过程满足
- en: \[\begin{split} \begin{pmatrix} \tilde{z}_{1,t}\\ \tilde{z}_{2,t} \end{pmatrix}
    = \bY_t = H\,\bX_t + \bV_t = \begin{pmatrix} z_{1,t} + V_{1,t}\\ z_{2,t} + V_{2,t}
    \end{pmatrix} \end{split}\]
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} \tilde{z}_{1,t}\\ \tilde{z}_{2,t} \end{pmatrix}
    = \bY_t = H\,\bX_t + \bV_t = \begin{pmatrix} z_{1,t} + V_{1,t}\\ z_{2,t} + V_{2,t}
    \end{pmatrix} \end{split}\]
- en: where the \(\bV_t = (V_{1,t}, V_{2,t}) \sim N_d(\mathbf{0}, R)\) with \(R\)
    known.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(\bV_t = (V_{1,t}, V_{2,t}) \sim N_d(\mathbf{0}, R)\) 且 \(R\) 是已知的。
- en: In words, we only observe the positions, up to Gaussian noise.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 用话来说，我们只能观察到位置，直到高斯噪声。
- en: '**Implementing the Kalman filter** We implement the Kalman filter as described
    above with known covariance matrices. We take \(\Delta = 1\) for simplicity. The
    code is adapted from [[Mur0](https://github.com/probml/pmtk3/blob/master/demos/kalmanTrackingDemo.m)].'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现卡尔曼滤波** 我们使用已知的协方差矩阵，按照上述描述实现了卡尔曼滤波。为了简化，我们取 \(\Delta = 1\)。代码改编自 [[Mur0](https://github.com/probml/pmtk3/blob/master/demos/kalmanTrackingDemo.m)]。'
- en: We will test Kalman filtering on a simulated path drawn from the linear-Gaussian
    model above. The following function creates such a path and its noisy observations.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在从上述线性高斯模型中抽取的模拟路径上测试卡尔曼滤波。以下函数创建这样的路径及其有噪声的观测值。
- en: '[PRE0]'
  id: totrans-233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '**NUMERICAL CORNER:** Here is an example.'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: '**数值角落**：这里有一个例子。'
- en: '[PRE1]'
  id: totrans-235
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: In the next plot (and throughout this section), the dots are the noisy observations.
    The unobserved true path is also shown as a dotted line.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一个图中（以及本节中），点表示有噪声的观测值。未观测到的真实路径也以虚线表示。
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格源代码
    隐藏代码单元格源代码</summary>
- en: '[PRE2]</details> ![../../_images/7887a8a25f3bbd2d4c1cc1b809a24f2aa031c84a10f4cd5ed5f0ae71eff0253c.png](../Images/c8b3c6c67639d980e6620091452f12a9.png)'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE2]</details> ![../../_images/7887a8a25f3bbd2d4c1cc1b809a24f2aa031c84a10f4cd5ed5f0ae71eff0253c.png](../Images/c8b3c6c67639d980e6620091452f12a9.png)'
- en: \(\unlhd\)
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: The following function implements the Kalman filter. The full recursion is broken
    up into several steps. We use [`numpy.linalg.inv`](https://numpy.org/doc/stable/reference/generated/numpy.linalg.inv.html)
    to compute the Kalman gain matrix. Below, `mu_pred` is \(F \bmu_{t-1}\) and `Sig_pred`
    is \(P_{t-1} = F \bSigma_{t-1} F^T + Q\), which are the mean vector and covariance
    matrix of \(\bX_{t}\) given \(\bY_{1:t-1}\) as computed in the *Predict* step.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 以下函数实现了卡尔曼滤波。完整的递归被分解成几个步骤。我们使用 `numpy.linalg.inv` 来计算卡尔曼增益矩阵。下面，`mu_pred` 是
    \(F \bmu_{t-1}\)，而 `Sig_pred` 是 \(P_{t-1} = F \bSigma_{t-1} F^T + Q\)，这是在 *预测*
    步骤中根据 \(\bY_{1:t-1}\) 计算出的 \(\bX_{t}\) 的均值向量和协方差矩阵。
- en: '[PRE3]'
  id: totrans-241
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '[PRE4]'
  id: totrans-242
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '**NUMERICAL CORNER:** We apply this to the location tracking example. The inferred
    states, or more precisely their estimated mean, are in blue. Note that we also
    inferred the velocity at each time point, but we are not plotting that information.'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: '**数值角落**：我们将此应用于位置跟踪示例。推断出的状态，或者更准确地说，它们的估计均值，以蓝色表示。请注意，我们还推断出每个时间点的速度，但我们没有绘制这些信息。'
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格源代码
    隐藏代码单元格源代码</summary>
- en: '[PRE5]</details> ![../../_images/046beb4acdf4c61da2a5de4c6dbb7d32ca2d7b4e8416651030b3f49747fcac9a.png](../Images/959069dbefd76cfab2d54229507451d1.png)'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE5]</details> ![../../_images/046beb4acdf4c61da2a5de4c6dbb7d32ca2d7b4e8416651030b3f49747fcac9a.png](../Images/959069dbefd76cfab2d54229507451d1.png)'
- en: To quantify the improvement in the inferred means compared to the observations,
    we compute the mean squared error in both cases.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 为了量化与观测值相比推断出的均值改进，我们计算两种情况下的均方误差。
- en: '[PRE6]'
  id: totrans-247
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '[PRE7]'
  id: totrans-248
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '[PRE8]'
  id: totrans-249
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '[PRE9]'
  id: totrans-250
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: We indeed observe a substantial reduction.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 我们确实观察到显著的减少。
- en: \(\unlhd\)
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: '**CHAT & LEARN** The Kalman filter assumes that the parameters of the state
    evolution and observation models are known. Ask your favorite AI chatbot about
    methods for estimating these parameters from data, such as the expectation-maximization
    algorithm or the variational Bayes approach. \(\ddagger\)'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: '**聊天与学习** 卡尔曼滤波假设状态演变和观测模型参数是已知的。向您喜欢的AI聊天机器人询问从数据中估计这些参数的方法，例如期望最大化算法或变分贝叶斯方法。
    \(\ddagger\)'
- en: '***Self-assessment quiz*** *(with help from Claude, Gemini, and ChatGPT)*'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: '***自我评估测验*** *(在 Claude、Gemini 和 ChatGPT 的帮助下)*'
- en: '**1** Which of the following is the Schur complement of the block \(B_{11}\)
    in the positive definite matrix \(B = \begin{pmatrix} B_{11} & B_{12} \\ B_{12}^T
    & B_{22} \end{pmatrix}\)?'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: '**1** 以下哪个是正定矩阵 \(B = \begin{pmatrix} B_{11} & B_{12} \\ B_{12}^T & B_{22}
    \end{pmatrix}\) 中 \(B_{11}\) 块的 Schur 补？'
- en: a) \(B_{22} - B_{12}^T B_{11}^{-1} B_{12}\)
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: a) \(B_{22} - B_{12}^T B_{11}^{-1} B_{12}\)
- en: b) \(B_{11} - B_{12} B_{22}^{-1} B_{12}^T\)
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: b) \(B_{11} - B_{12} B_{22}^{-1} B_{12}^T\)
- en: c) \(B_{22}\)
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: c) \(B_{22}\)
- en: d) \(B_{11}\)
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: d) \(B_{11}\)
- en: '**2** Which of the following is true about the Schur complement \(B/B_{11}\)
    of the block \(B_{11}\) in a positive definite matrix \(B\)?'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: '**2** 以下关于正定矩阵 \(B\) 中 \(B_{11}\) 块的 Schur 补 \(B/B_{11}\) 的哪个说法是正确的？'
- en: a) It is always symmetric.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: a) 它总是对称的。
- en: b) It is always positive definite.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: b) 它总是正定的。
- en: c) Both a and b.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: c) a 和 b 都正确。
- en: d) Neither a nor b.
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: d) 既不是 a 也不是 b。
- en: '**3** What is the conditional distribution of \(\mathbf{X}_1\) given \(\mathbf{X}_2\)
    in a multivariate Gaussian distribution?'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: '**3** 在多元高斯分布中，\(\mathbf{X}_1\) 给定 \(\mathbf{X}_2\) 的条件分布是什么？'
- en: a) \(\mathbf{X}_1 | \mathbf{X}_2 \sim N_{d_1}(\boldsymbol{\mu}_1 + \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2
    - \boldsymbol{\mu}_2), \bSigma_{11} - \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\)
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: a) \(\mathbf{X}_1 | \mathbf{X}_2 \sim N_{d_1}(\boldsymbol{\mu}_1 + \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2
    - \boldsymbol{\mu}_2), \bSigma_{11} - \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\)
- en: b) \(\mathbf{X}_1 | \mathbf{X}_2 \sim N_{d_1}(\boldsymbol{\mu}_1 - \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2
    - \boldsymbol{\mu}_2), \bSigma_{11} + \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\)
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: b) \(\mathbf{X}_1 | \mathbf{X}_2 \sim N_{d_1}(\boldsymbol{\mu}_1 - \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2
    - \boldsymbol{\mu}_2), \bSigma_{11} + \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\)
- en: c) \(\mathbf{X}_1 | \mathbf{X}_2 \sim N_{d_1}(\boldsymbol{\mu}_1 + \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2
    - \boldsymbol{\mu}_2), \bSigma_{11} + \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\)
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: c) \(\mathbf{X}_1 | \mathbf{X}_2 \sim N_{d_1}(\boldsymbol{\mu}_1 + \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2
    - \boldsymbol{\mu}_2), \bSigma_{11} + \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\)
- en: d) \(\mathbf{X}_1 | \mathbf{X}_2 \sim N_{d_1}(\boldsymbol{\mu}_1 - \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2
    - \boldsymbol{\mu}_2), \bSigma_{11} - \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\)
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: d) \(\mathbf{X}_1 | \mathbf{X}_2 \sim N_{d_1}(\boldsymbol{\mu}_1 - \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2
    - \boldsymbol{\mu}_2), \bSigma_{11} - \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\)
- en: '**4** In a linear-Gaussian system, which of the following is true about the
    conditional independence relationships?'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: '**4** 在线性高斯系统中，以下关于条件独立性关系的哪个说法是正确的？'
- en: a) \(\mathbf{X}_t\) is conditionally independent of \(\mathbf{Y}_{1:t-1}\) given
    \(\mathbf{X}_{t-1}\).
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: a) 在给定 \(\mathbf{X}_{t-1}\) 的条件下，\(\mathbf{X}_t\) 与 \(\mathbf{Y}_{1:t-1}\) 条件独立。
- en: b) \(\mathbf{Y}_t\) is conditionally independent of \(\mathbf{Y}_{1:t-1}\) given
    \(\mathbf{X}_t\).
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: b) \(\mathbf{Y}_t\) 在给定 \(\mathbf{X}_t\) 的条件下与 \(\mathbf{Y}_{1:t-1}\) 条件独立。
- en: c) \(\mathbf{X}_t\) is conditionally independent of \(\mathbf{X}_{t-2}\) given
    \(\mathbf{X}_{t-1}\).
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: c) 在给定 \(\mathbf{X}_{t-1}\) 的条件下，\(\mathbf{X}_t\) 与 \(\mathbf{X}_{t-2}\) 条件独立。
- en: d) All of the above.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: d) 以上所有。
- en: '**5** In the Kalman filter, what does the Kalman gain matrix \(K_t\) represent?'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: '**5** 在卡尔曼滤波中，卡尔曼增益矩阵 \(K_t\) 代表什么？'
- en: a) The covariance matrix of the state estimate at time \(t\).
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: a) 时间 \(t\) 状态估计的协方差矩阵。
- en: b) The covariance matrix of the observation at time \(t\).
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: b) 时间 \(t\) 观测的协方差矩阵。
- en: c) The weight given to the observation at time \(t\) when updating the state
    estimate.
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: c) 在更新状态估计时，赋予时间 \(t\) 观测的权重。
- en: d) The weight given to the previous state estimate when predicting the current
    state.
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: d) 在预测当前状态时赋予先前状态估计的权重。
- en: 'Answer for 1: a. Justification: The text defines the Schur complement of \(B_{11}\)
    as \(B / B_{11} := B_{22} - B_{12}^T B_{11}^{-1} B_{12}\).'
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 1 的答案：a. 理由：文本中将 \(B_{11}\) 的 Schur 补定义为 \(B / B_{11} := B_{22} - B_{12}^T B_{11}^{-1}
    B_{12}\)。
- en: 'Answer for 2: c. Justification: The text states “the Schur complement of the
    block \(B_{11}\), i.e., the matrix \(B/B_{11} := B_{22} - B_{12}^T B_{11}^{-1}
    B_{12}\), is symmetric and positive definite.”'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 2 的答案：c. 理由：文本中提到“\(B_{11}\) 块的 Schur 补，即矩阵 \(B/B_{11} := B_{22} - B_{12}^T
    B_{11}^{-1} B_{12}\)，是对称且正定的。”
- en: 'Answer for 3: a. Justification: The conditional distribution of \(\mathbf{X}_1\)
    given \(\mathbf{X}_2\) is derived in the text as \(\mathbf{X}_1 | \mathbf{X}_2
    \sim N_{d_1}(\boldsymbol{\mu}_1 + \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2 -
    \boldsymbol{\mu}_2), \bSigma_{11} - \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\).'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 3 的答案：a. 理由：文本中推导了给定 \(\mathbf{X}_2\) 的 \(\mathbf{X}_1\) 的条件分布为 \(\mathbf{X}_1
    | \mathbf{X}_2 \sim N_{d_1}(\boldsymbol{\mu}_1 + \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2
    - \boldsymbol{\mu}_2), \bSigma_{11} - \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\)。
- en: 'Answer for 4: d. Justification: The text explicitly states these conditional
    independence relationships.'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 答案4：d. 证明：文本明确指出这些条件独立性关系。
- en: 'Answer for 5: c. Justification: The text defines \(K_t := P_{t-1} H^T (H P_{t-1}
    H^T + R)^{-1}\) as the Kalman gain matrix, which is used to update the state estimate
    as \(\boldsymbol{\mu}_t := F \boldsymbol{\mu}_{t-1} + K_t (\mathbf{Y}_t - H F
    \boldsymbol{\mu}_{t-1})\), where \(K_t\) weighs the innovation \((\mathbf{Y}_t
    - H F \boldsymbol{\mu}_{t-1})\).'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 答案5：c. 证明：文本定义 \(K_t := P_{t-1} H^T (H P_{t-1} H^T + R)^{-1}\) 为卡尔曼增益矩阵，它用于更新状态估计
    \(\boldsymbol{\mu}_t := F \boldsymbol{\mu}_{t-1} + K_t (\mathbf{Y}_t - H F \boldsymbol{\mu}_{t-1})\)，其中
    \(K_t\) 权衡创新 \((\mathbf{Y}_t - H F \boldsymbol{\mu}_{t-1})\)。
- en: '6.5.1\. Multivariate Gaussians: marginals and conditionals[#](#multivariate-gaussians-marginals-and-conditionals
    "Link to this heading")'
  id: totrans-285
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 6.5.1\. 多变量高斯分布：边缘和条件分布[#](#multivariate-gaussians-marginals-and-conditionals
    "链接到这个标题")
- en: We will need the marginal and conditional densities of a multivariate Gaussian.
    For this purpose, we require various formulas and results about block matrices.
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将需要多变量高斯分布的边缘和条件密度。为此，我们需要各种关于分块矩阵的公式和结果。
- en: '**Properties of block matrices** Recall that block matrices have a convenient
    algebra that mimics the usual matrix algebra. Consider a square block matrix with
    the same partitioning of the rows and columns, that is,'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: '**分块矩阵的性质** 回想一下，分块矩阵有一个方便的代数，类似于通常的矩阵代数。考虑一个行和列划分相同的平方分块矩阵，即，'
- en: \[\begin{split} A = \begin{pmatrix} A_{11} & A_{12}\\ A_{21} & A_{22} \end{pmatrix}
    \end{split}\]
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A = \begin{pmatrix} A_{11} & A_{12}\\ A_{21} & A_{22} \end{pmatrix}
    \end{split}\]
- en: where \(A \in \mathbb{R}^{n \times n}\), \(A_{ij} \in \mathbb{R}^{n_i \times
    n_j}\) for \(i, j = 1, 2\) with the condition \(n_1 + n_2 = n\). Then it is straightforward
    to check (try it!) that the transpose can be written as
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(A \in \mathbb{R}^{n \times n}\)，\(A_{ij} \in \mathbb{R}^{n_i \times n_j}\)
    对于 \(i, j = 1, 2\)，条件是 \(n_1 + n_2 = n\)。那么可以简单地检查（试试看！）转置可以写成
- en: \[\begin{split} A^T = \begin{pmatrix} A_{11}^T & A_{21}^T\\ A_{12}^T & A_{22}^T
    \end{pmatrix}. \end{split}\]
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A^T = \begin{pmatrix} A_{11}^T & A_{21}^T\\ A_{12}^T & A_{22}^T
    \end{pmatrix}. \end{split}\]
- en: In particular, if \(A\) is symmetric then \(A_{11} = A_{11}^T\), \(A_{22} =
    A_{22}^T\) and \(A_{21} = A_{12}^T\).
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 特别地，如果 \(A\) 是对称的，那么 \(A_{11} = A_{11}^T\)，\(A_{22} = A_{22}^T\) 和 \(A_{21}
    = A_{12}^T\)。
- en: '**EXAMPLE:** For instance, consider the \(\mathbf{z} = (\mathbf{z}_1, \mathbf{z}_2)\),
    where \(\mathbf{z}_1 \in \mathbb{R}^{n_1}\) and \(\mathbf{z}_2 \in \mathbb{R}^{n_2}\).
    We want to compute the quadratic form'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例：** 例如，考虑 \(\mathbf{z} = (\mathbf{z}_1, \mathbf{z}_2)\)，其中 \(\mathbf{z}_1
    \in \mathbb{R}^{n_1}\) 和 \(\mathbf{z}_2 \in \mathbb{R}^{n_2}\)。我们想要计算二次型'
- en: \[\begin{split} \mathbf{z}^T \begin{pmatrix} A_{11} & A_{12}\\ A_{12}^T & A_{22}
    \end{pmatrix} \mathbf{z} \end{split}\]
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{z}^T \begin{pmatrix} A_{11} & A_{12}\\ A_{12}^T & A_{22}
    \end{pmatrix} \mathbf{z} \end{split}\]
- en: where \(A_{ij} \in \mathbb{R}^{n_i \times n_j}\) for \(i,j = 1, 2\) with the
    conditions \(n_1 + n_2 = n\), and \(A_{11}^T = A_{11}\) and \(A_{22}^T = A_{22}\).
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(A_{ij} \in \mathbb{R}^{n_i \times n_j}\) 对于 \(i,j = 1, 2\)，条件是 \(n_1 +
    n_2 = n\)，且 \(A_{11}^T = A_{11}\) 和 \(A_{22}^T = A_{22}\)。
- en: We apply the block matrix product formula twice to get
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 我们两次应用分块矩阵乘法公式得到
- en: \[\begin{align*} &(\mathbf{z}_1, \mathbf{z}_2)^T \begin{pmatrix} A_{11} & A_{12}\\
    A_{12}^T & A_{22} \end{pmatrix} (\mathbf{z}_1, \mathbf{z}_2)\\ &= (\mathbf{z}_1,
    \mathbf{z}_2)^T \begin{pmatrix} A_{11} \mathbf{z}_1 + A_{12} \mathbf{z}_2\\ A_{12}^T
    \mathbf{z}_1 + A_{22} \mathbf{z}_2 \end{pmatrix}\\ &= \mathbf{z}_1^T A_{11} \mathbf{z}_1
    + \mathbf{z}_1^T A_{12} \mathbf{z}_2 + \mathbf{z}_2^T A_{12}^T \mathbf{z}_1 +
    \mathbf{z}_2^T A_{22} \mathbf{z}_2\\ &= \mathbf{z}_1^T A_{11} \mathbf{z}_1 + 2
    \mathbf{z}_1^T A_{12} \mathbf{z}_2 + \mathbf{z}_2^T A_{22} \mathbf{z}_2. \end{align*}\]
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &(\mathbf{z}_1, \mathbf{z}_2)^T \begin{pmatrix} A_{11} & A_{12}\\
    A_{12}^T & A_{22} \end{pmatrix} (\mathbf{z}_1, \mathbf{z}_2)\\ &= (\mathbf{z}_1,
    \mathbf{z}_2)^T \begin{pmatrix} A_{11} \mathbf{z}_1 + A_{12} \mathbf{z}_2\\ A_{12}^T
    \mathbf{z}_1 + A_{22} \mathbf{z}_2 \end{pmatrix}\\ &= \mathbf{z}_1^T A_{11} \mathbf{z}_1
    + \mathbf{z}_1^T A_{12} \mathbf{z}_2 + \mathbf{z}_2^T A_{12}^T \mathbf{z}_1 +
    \mathbf{z}_2^T A_{22} \mathbf{z}_2\\ &= \mathbf{z}_1^T A_{11} \mathbf{z}_1 + 2
    \mathbf{z}_1^T A_{12} \mathbf{z}_2 + \mathbf{z}_2^T A_{22} \mathbf{z}_2. \end{align*}\]
- en: \(\lhd\)
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: \(\lhd\)
- en: '**EXAMPLE:** Let \(A_{ii} \in \mathbb{R}^{n_i \times n_i}\) for \(i = 1, 2\)
    be invertible. We claim that'
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例：** 设 \(A_{ii} \in \mathbb{R}^{n_i \times n_i}\) 对于 \(i = 1, 2\) 是可逆的。我们声称'
- en: \[\begin{split} \begin{pmatrix} A_{11} & \mathbf{0}\\ \mathbf{0} & A_{22} \end{pmatrix}^{-1}
    = \begin{pmatrix} A_{11}^{-1} & \mathbf{0}\\ \mathbf{0} & A_{22}^{-1} \end{pmatrix}.
    \end{split}\]
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} A_{11} & \mathbf{0}\\ \mathbf{0} & A_{22} \end{pmatrix}^{-1}
    = \begin{pmatrix} A_{11}^{-1} & \mathbf{0}\\ \mathbf{0} & A_{22}^{-1} \end{pmatrix}.
    \end{split}\]
- en: The matrix on the right-hand side is well-defined by the invertibility of \(A_{11}\)
    and \(A_{22}\). We check the claim using the formula for matrix products of block
    matrices. The matrices above are block diagonal.
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 右侧的矩阵由 \(A_{11}\) 和 \(A_{22}\) 的可逆性定义。我们使用分块矩阵的乘积公式来验证这个断言。上面的矩阵是分块对角矩阵。
- en: Indeed, we obtain
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 事实上，我们得到
- en: \[\begin{align*} &\begin{pmatrix} A_{11} & \mathbf{0}\\ \mathbf{0} & A_{22}
    \end{pmatrix} \begin{pmatrix} A_{11}^{-1} & \mathbf{0}\\ \mathbf{0} & A_{22}^{-1}
    \end{pmatrix}\\ &= \begin{pmatrix} A_{11} A_{11}^{-1} + \mathbf{0} & \mathbf{0}
    + \mathbf{0}\\ \mathbf{0} + \mathbf{0} & \mathbf{0} + A_{22} A_{22}^{-1} \end{pmatrix}
    = \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ \mathbf{0} & I_{n_2 \times
    n_2} \end{pmatrix} = I_{n \times n} \end{align*}\]
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &\begin{pmatrix} A_{11} & \mathbf{0}\\ \mathbf{0} & A_{22}
    \end{pmatrix} \begin{pmatrix} A_{11}^{-1} & \mathbf{0}\\ \mathbf{0} & A_{22}^{-1}
    \end{pmatrix}\\ &= \begin{pmatrix} A_{11} A_{11}^{-1} + \mathbf{0} & \mathbf{0}
    + \mathbf{0}\\ \mathbf{0} + \mathbf{0} & \mathbf{0} + A_{22} A_{22}^{-1} \end{pmatrix}
    = \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ \mathbf{0} & I_{n_2 \times
    n_2} \end{pmatrix} = I_{n \times n} \end{align*}\]
- en: and similarly for the other direction. \(\lhd\)
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 并且对于其他方向也是类似的。 \(\lhd\)
- en: '**EXAMPLE:** Let \(A_{21} \in \mathbb{R}^{n_2 \times n_1}\). Then we claim
    that'
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: '**EXAMPLE:** 设 \(A_{21} \in \mathbb{R}^{n_2 \times n_1}\)。那么我们断言'
- en: \[\begin{split} \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ A_{21} & I_{n_2
    \times n_2} \end{pmatrix}^{-1} = \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\
    - A_{21} & I_{n_2 \times n_2} \end{pmatrix}. \end{split}\]
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ A_{21} & I_{n_2
    \times n_2} \end{pmatrix}^{-1} = \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\
    - A_{21} & I_{n_2 \times n_2} \end{pmatrix}. \end{split}\]
- en: A similar formula holds for the block upper triangular case. In particular,
    such matrices are invertible (which can be proved in other ways, for instance
    through determinants).
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 对于分块上三角的情况，也有类似的公式。特别是，这样的矩阵是可逆的（可以通过其他方式证明，例如通过行列式）。
- en: 'It suffices to check:'
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 只需检查：
- en: \[\begin{align*} &\begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ A_{21} &
    I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\
    -A_{21} & I_{n_2 \times n_2} \end{pmatrix}\\ &= \begin{pmatrix} I_{n_1 \times
    n_1} I_{n_1 \times n_1} + \mathbf{0} & \mathbf{0} + \mathbf{0}\\ A_{21} I_{n_1
    \times n_1} + (-A_{21}) I_{n_1 \times n_1} & \mathbf{0} + I_{n_2 \times n_2} I_{n_2
    \times n_2} \end{pmatrix} = \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\
    \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix} = I_{n \times n} \end{align*}\]
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &\begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ A_{21} &
    I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\
    -A_{21} & I_{n_2 \times n_2} \end{pmatrix}\\ &= \begin{pmatrix} I_{n_1 \times
    n_1} I_{n_1 \times n_1} + \mathbf{0} & \mathbf{0} + \mathbf{0}\\ A_{21} I_{n_1
    \times n_1} + (-A_{21}) I_{n_1 \times n_1} & \mathbf{0} + I_{n_2 \times n_2} I_{n_2
    \times n_2} \end{pmatrix} = \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\
    \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix} = I_{n \times n} \end{align*}\]
- en: Taking a transpose gives a similar formula for the block upper triangular case.
    \(\lhd\)
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 取转置可以得到分块上三角情况的类似公式。 \(\lhd\)
- en: '**Inverting a block matrix** We will need a classical formula for inverting
    a block matrix. We start with the concept of a Schur complement.'
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: '**Inverting a block matrix** 我们需要使用一个经典的分块矩阵求逆公式。我们从Schur补的概念开始。'
- en: '**DEFINITION** **(Schur Complement)** \(\idx{Schur complement}\xdi\) Consider
    the matrix \(B \in \mathbb{R}^{n \times n}\) in block form'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: '**DEFINITION** **(Schur Complement)** \(\idx{Schur Complement}\xdi\) 考虑矩阵 \(B
    \in \mathbb{R}^{n \times n}\) 的分块形式'
- en: \[\begin{split} B = \begin{pmatrix} B_{11} & B_{12}\\ B_{21} & B_{22} \end{pmatrix}
    \end{split}\]
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} B = \begin{pmatrix} B_{11} & B_{12}\\ B_{21} & B_{22} \end{pmatrix}
    \end{split}\]
- en: where \(B_{11} \in \mathbb{R}^{n_1 \times n_1}\), \(B_{22} \in \mathbb{R}^{n
    - n_1 \times n - n_1}\), \(B_{12} \in \mathbb{R}^{n_1 \times n - n_1}\), and \(B_{21}
    \in \mathbb{R}^{n - n_1 \times n_1}\). Then, provided \(B_{22}\) is invertible,
    the Schur complement of the block \(B_{22}\) is defined as the matrix
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(B_{11} \in \mathbb{R}^{n_1 \times n_1}\)，\(B_{22} \in \mathbb{R}^{n - n_1
    \times n - n_1}\)，\(B_{12} \in \mathbb{R}^{n_1 \times n - n_1}\)，和 \(B_{21} \in
    \mathbb{R}^{n - n_1 \times n_1}\)。那么，如果 \(B_{22}\) 是可逆的，\(B_{22}\) 的Schur补定义为矩阵
- en: \[ B/B_{22} := B_{11} - B_{12} B_{22}^{-1} B_{21}. \]
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: \[ B/B_{22} := B_{11} - B_{12} B_{22}^{-1} B_{21}. \]
- en: Similarly, provided \(B_{11}\) is invertible,
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 类似地，如果 \(B_{11}\) 是可逆的，
- en: \[ B/B_{11} := B_{22} - B_{21} B_{11}^{-1} B_{12}. \]
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: \[ B/B_{11} := B_{22} - B_{21} B_{11}^{-1} B_{12}. \]
- en: \(\natural\)
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: \(\natural\)
- en: '**LEMMA** **(Inverting a Block Matrix)** \(\idx{inverting a block matrix lemma}\xdi\)
    Consider the matrix \(B \in \mathbb{R}^{n \times n}\) in block form as'
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: '**LEMMA** **(Inverting a Block Matrix)** \(\idx{inverting a block matrix lemma}\xdi\)
    考虑矩阵 \(B \in \mathbb{R}^{n \times n}\) 的分块形式为'
- en: \[\begin{split} B = \begin{pmatrix} B_{11} & B_{12}\\ B_{21} & B_{22} \end{pmatrix}
    \end{split}\]
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} B = \begin{pmatrix} B_{11} & B_{12}\\ B_{21} & B_{22} \end{pmatrix}
    \end{split}\]
- en: where \(B_{11} \in \mathbb{R}^{n_1 \times n_1}\), \(B_{22} \in \mathbb{R}^{n
    - n_1 \times n - n_1}\), \(B_{12} \in \mathbb{R}^{n_1 \times n - n_1}\), and \(B_{21}
    \in \mathbb{R}^{n - n_1 \times n_1}\). Then, provided \(B_{22}\) is invertible,
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(B_{11} \in \mathbb{R}^{n_1 \times n_1}\)，\(B_{22} \in \mathbb{R}^{n - n_1
    \times n - n_1}\)，\(B_{12} \in \mathbb{R}^{n_1 \times n - n_1}\)，和 \(B_{21} \in
    \mathbb{R}^{n - n_1 \times n_1}\)。然后，如果 \(B_{22}\) 是可逆的，
- en: \[\begin{split} B^{-1} = \begin{pmatrix} (B/B_{22})^{-1} & - (B/B_{22})^{-1}
    B_{12} B_{22}^{-1}\\ - B_{22}^{-1} B_{21} (B/B_{22})^{-1} & B_{22}^{-1} B_{21}
    (B/B_{22})^{-1} B_{12} B_{22}^{-1} + B_{22}^{-1} \end{pmatrix}. \end{split}\]
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} B^{-1} = \begin{pmatrix} (B/B_{22})^{-1} & - (B/B_{22})^{-1}
    B_{12} B_{22}^{-1}\\ - B_{22}^{-1} B_{21} (B/B_{22})^{-1} & B_{22}^{-1} B_{21}
    (B/B_{22})^{-1} B_{12} B_{22}^{-1} + B_{22}^{-1} \end{pmatrix}. \end{split}\]
- en: Alternatively, provided \(B_{11}\) is invertible,
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，如果 \(B_{11}\) 是可逆的，
- en: \[\begin{split} B^{-1} = \begin{pmatrix} B_{11}^{-1} B_{12} (B/B_{11})^{-1}
    B_{21} B_{11}^{-1} + B_{11}^{-1} & - B_{11}^{-1} B_{12} (B/B_{11})^{-1}\\ - (B/B_{11})^{-1}
    B_{21} B_{11}^{-1} & (B/B_{11})^{-1} \end{pmatrix}. \end{split}\]
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} B^{-1} = \begin{pmatrix} B_{11}^{-1} B_{12} (B/B_{11})^{-1}
    B_{21} B_{11}^{-1} + B_{11}^{-1} & - B_{11}^{-1} B_{12} (B/B_{11})^{-1}\\ - (B/B_{11})^{-1}
    B_{21} B_{11}^{-1} & (B/B_{11})^{-1} \end{pmatrix}. \end{split}\]
- en: \(\flat\)
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: \(\flat\)
- en: '*Proof idea:* One way to prove this is to multiply \(B\) and \(B^{-1}\) and
    check that the identity matrix comes out (try it!). We give a longer proof that
    provides more insight into where the formula is coming from.'
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明思路:* 证明这一点的其中一种方法是将 \(B\) 和 \(B^{-1}\) 相乘并检查是否得到单位矩阵（试试看！）我们给出一个更长的证明，它提供了更多关于公式来源的见解。'
- en: The trick is to multiply \(B\) on the left and right by carefully chosen block
    triangular matrices with identity matrices on the diagonal (which we know are
    invertible by a previous example) to produce a block diagonal matrix with invertible
    matrices on the diagonal (which we know how to invert by a previous example).
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 诀窍是左乘和右乘 \(B\) 以精心选择的具有对角线为单位矩阵的分块三角矩阵（我们知道根据前一个例子它们是可逆的）以产生对角线上有可逆矩阵的分块对角矩阵（我们知道根据前一个例子如何求逆）。
- en: '*Proof:* We only prove the first formula. The proof is a calculation based
    on the formula for matrix products of block matrices. We will need that, if \(C\),
    \(D\), and \(E\) are invertible and of the same size, then \((CDE)^{-1} = E^{-1}
    D^{-1} C^{-1}\) (check it!).'
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明:* 我们只证明第一个公式。证明是基于分块矩阵的矩阵乘积公式的一个计算。我们需要知道，如果 \(C\)、\(D\) 和 \(E\) 是可逆的并且大小相同，那么
    \((CDE)^{-1} = E^{-1} D^{-1} C^{-1}\)（检查一下！）。'
- en: We make a series of observations.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 我们做出一系列观察。
- en: 1- Our first step is to get a zero block in the upper right corner using an
    invertible matrix. Note that (recall that the order of multiplication matters
    here!)
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: 1- 我们的第一步是使用可逆矩阵在右上角得到一个零块。注意（回想一下，这里的乘法顺序很重要！）
- en: \[\begin{align*} &\begin{pmatrix} I_{n_1 \times n_1} & - B_{12} B_{22}^{-1}\\
    \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix} B_{11} & B_{12}\\
    B_{21} & B_{22} \end{pmatrix}\\ &= \begin{pmatrix} B_{11} - B_{12} B_{22}^{-1}
    B_{21} & B_{12} - B_{12} B_{22}^{-1} B_{22}\\ \mathbf{0} + B_{21} & \mathbf{0}
    + B_{22} \end{pmatrix} = \begin{pmatrix} B/B_{22} & \mathbf{0}\\ B_{21} & B_{22}
    \end{pmatrix}. \end{align*}\]
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &\begin{pmatrix} I_{n_1 \times n_1} & - B_{12} B_{22}^{-1}\\
    \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix} B_{11} & B_{12}\\
    B_{21} & B_{22} \end{pmatrix}\\ &= \begin{pmatrix} B_{11} - B_{12} B_{22}^{-1}
    B_{21} & B_{12} - B_{12} B_{22}^{-1} B_{22}\\ \mathbf{0} + B_{21} & \mathbf{0}
    + B_{22} \end{pmatrix} = \begin{pmatrix} B/B_{22} & \mathbf{0}\\ B_{21} & B_{22}
    \end{pmatrix}. \end{align*}\]
- en: 2- Next we get a zero block in the bottom left corner. Starting from the final
    matrix in the last display,
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 2- 接下来我们在左下角得到一个零块。从上一个显示的最终矩阵开始，
- en: \[\begin{align*} & \begin{pmatrix} B/B_{22} & \mathbf{0}\\ B_{21} & B_{22} \end{pmatrix}
    \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1} B_{21} & I_{n_2
    \times n_2} \end{pmatrix}\\ &= \begin{pmatrix} B/B_{22} + \mathbf{0} & \mathbf{0}
    + \mathbf{0} \\ B_{21} - B_{22} B_{22}^{-1} B_{21} & \mathbf{0} + B_{22} \end{pmatrix}
    = \begin{pmatrix} B/B_{22} & \mathbf{0}\\ \mathbf{0} & B_{22} \end{pmatrix}. \end{align*}\]
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} & \begin{pmatrix} B/B_{22} & \mathbf{0}\\ B_{21} & B_{22} \end{pmatrix}
    \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1} B_{21} & I_{n_2
    \times n_2} \end{pmatrix}\\ &= \begin{pmatrix} B/B_{22} + \mathbf{0} & \mathbf{0}
    + \mathbf{0} \\ B_{21} - B_{22} B_{22}^{-1} B_{21} & \mathbf{0} + B_{22} \end{pmatrix}
    = \begin{pmatrix} B/B_{22} & \mathbf{0}\\ \mathbf{0} & B_{22} \end{pmatrix}. \end{align*}\]
- en: 3- Combining the last two steps, we have shown that
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 3- 结合最后两个步骤，我们证明了
- en: \[\begin{split} \begin{pmatrix} I_{n_1 \times n_1} & - B_{12} B_{22}^{-1}\\
    \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix} B_{11} & B_{12}\\
    B_{21} & B_{22} \end{pmatrix} \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\
    - B_{22}^{-1} B_{21} & I_{n_2 \times n_2} \end{pmatrix} = \begin{pmatrix} B/B_{22}
    & \mathbf{0}\\ \mathbf{0} & B_{22} \end{pmatrix}. \end{split}\]
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} I_{n_1 \times n_1} & - B_{12} B_{22}^{-1}\\
    \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix} B_{11} & B_{12}\\
    B_{21} & B_{22} \end{pmatrix} \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\
    - B_{22}^{-1} B_{21} & I_{n_2 \times n_2} \end{pmatrix} = \begin{pmatrix} B/B_{22}
    & \mathbf{0}\\ \mathbf{0} & B_{22} \end{pmatrix}. \end{split}\]
- en: Using the formula for the inverse of a product of three invertible matrices,
    we obtain
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: 使用三个可逆矩阵乘积的逆公式，我们得到
- en: \[\begin{align*} &\begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1}
    B_{21} & I_{n_2 \times n_2} \end{pmatrix}^{-1} \begin{pmatrix} B_{11} & B_{12}\\
    B_{21} & B_{22} \end{pmatrix}^{-1} \begin{pmatrix} I_{n_1 \times n_1} & - B_{12}
    B_{22}^{-1}\\ \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix}^{-1}\\ &= \begin{pmatrix}
    B/B_{22} & \mathbf{0}\\ \mathbf{0} & B_{22} \end{pmatrix}^{-1}. \end{align*}\]
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &\begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1}
    B_{21} & I_{n_2 \times n_2} \end{pmatrix}^{-1} \begin{pmatrix} B_{11} & B_{12}\\
    B_{21} & B_{22} \end{pmatrix}^{-1} \begin{pmatrix} I_{n_1 \times n_1} & - B_{12}
    B_{22}^{-1}\\ \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix}^{-1}\\ &= \begin{pmatrix}
    B/B_{22} & \mathbf{0}\\ \mathbf{0} & B_{22} \end{pmatrix}^{-1}. \end{align*}\]
- en: 4- Rearranging and using the formula for the inverse of a block diagonal matrix,
    we finally get
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: 4- 通过重新排列并使用分块对角矩阵的逆公式，我们最终得到
- en: \[\begin{align*} &\begin{pmatrix} B_{11} & B_{12}\\ B_{21} & B_{22} \end{pmatrix}^{-1}\\
    &= \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1} B_{21} & I_{n_2
    \times n_2} \end{pmatrix} \begin{pmatrix} B/B_{22} & \mathbf{0}\\ \mathbf{0} &
    B_{22} \end{pmatrix}^{-1} \begin{pmatrix} I_{n_1 \times n_1} & - B_{12} B_{22}^{-1}\\
    \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix}\\ &= \begin{pmatrix} I_{n_1 \times
    n_1} & \mathbf{0}\\ - B_{22}^{-1} B_{21} & I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix}
    (B/B_{22})^{-1} & \mathbf{0}\\ \mathbf{0} & B_{22}^{-1} \end{pmatrix} \begin{pmatrix}
    I_{n_1 \times n_1} & - B_{12} B_{22}^{-1}\\ \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix}\\
    &= \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1} B_{21} & I_{n_2
    \times n_2} \end{pmatrix} \begin{pmatrix} (B/B_{22})^{-1} + \mathbf{0}& - (B/B_{22})^{-1}
    B_{12} B_{22}^{-1} + \mathbf{0}\\ \mathbf{0} + \mathbf{0} & \mathbf{0} + B_{22}^{-1}
    \end{pmatrix}\\ &= \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1}
    B_{21} & I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix} (B/B_{22})^{-1} & -
    (B/B_{22})^{-1} B_{12} B_{22}^{-1} \\ \mathbf{0} & B_{22}^{-1} \end{pmatrix}\\
    &= \begin{pmatrix} (B/B_{22})^{-1} & - (B/B_{22})^{-1} B_{12} B_{22}^{-1}\\ -
    B_{22}^{-1} B_{21} (B/B_{22})^{-1} & B_{22}^{-1} B_{21} (B/B_{22})^{-1} B_{12}
    B_{22}^{-1} + B_{22}^{-1} \end{pmatrix}, \end{align*}\]
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &\begin{pmatrix} B_{11} & B_{12}\\ B_{21} & B_{22} \end{pmatrix}^{-1}\\
    &= \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1} B_{21} & I_{n_2
    \times n_2} \end{pmatrix} \begin{pmatrix} B/B_{22} & \mathbf{0}\\ \mathbf{0} &
    B_{22} \end{pmatrix}^{-1} \begin{pmatrix} I_{n_1 \times n_1} & - B_{12} B_{22}^{-1}\\
    \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix}\\ &= \begin{pmatrix} I_{n_1 \times
    n_1} & \mathbf{0}\\ - B_{22}^{-1} B_{21} & I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix}
    (B/B_{22})^{-1} & \mathbf{0}\\ \mathbf{0} & B_{22}^{-1} \end{pmatrix} \begin{pmatrix}
    I_{n_1 \times n_1} & - B_{12} B_{22}^{-1}\\ \mathbf{0} & I_{n_2 \times n_2} \end{pmatrix}\\
    &= \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1} B_{21} & I_{n_2
    \times n_2} \end{pmatrix} \begin{pmatrix} (B/B_{22})^{-1} + \mathbf{0}& - (B/B_{22})^{-1}
    B_{12} B_{22}^{-1} + \mathbf{0}\\ \mathbf{0} + \mathbf{0} & \mathbf{0} + B_{22}^{-1}
    \end{pmatrix}\\ &= \begin{pmatrix} I_{n_1 \times n_1} & \mathbf{0}\\ - B_{22}^{-1}
    B_{21} & I_{n_2 \times n_2} \end{pmatrix} \begin{pmatrix} (B/B_{22})^{-1} & -
    (B/B_{22})^{-1} B_{12} B_{22}^{-1} \\ \mathbf{0} & B_{22}^{-1} \end{pmatrix}\\
    &= \begin{pmatrix} (B/B_{22})^{-1} & - (B/B_{22})^{-1} B_{12} B_{22}^{-1}\\ -
    B_{22}^{-1} B_{21} (B/B_{22})^{-1} & B_{22}^{-1} B_{21} (B/B_{22})^{-1} B_{12}
    B_{22}^{-1} + B_{22}^{-1} \end{pmatrix}, \end{align*}\]
- en: as claimed. \(\square\)
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 如所声称。 \(\square\)
- en: '**The positive definite case** In applying the inversion formula, it will be
    enough to restrict ourselves to the positive definite case, where the lemmas that
    follow guarantee the required invertibility conditions.'
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: '**正定情况** 在应用求逆公式时，我们只需将注意力限制在正定情况，其中接下来的引理保证了所需的可逆性条件。'
- en: 'First:'
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 首先：
- en: '**LEMMA** **(Invertibility of Positive Definite Matrices)** \(\idx{invertibility
    of positive definite matrices}\xdi\) Let \(B \in \mathbb{R}^{n \times n}\) be
    symmetric, positive definite. Then \(B\) is invertible. \(\flat\)'
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: '**引理** **(正定矩阵的可逆性)** \(\idx{正定矩阵的可逆性}\xdi\) 设 \(B \in \mathbb{R}^{n \times
    n}\) 为对称，正定。则 \(B\) 是可逆的。 \(\flat\)'
- en: '*Proof:* For any \(\mathbf{x} \neq \mathbf{0}\), it holds by positive definiteness
    that \(\mathbf{x}^T B \mathbf{x} > 0\). In particular, it must be that \(\mathbf{x}^T
    B \mathbf{x} \neq 0\) and therefore, by contradiction, \(B \mathbf{x} \neq \mathbf{0}\)
    (since for any \(\mathbf{z}\), it holds that \(\mathbf{z}^T \mathbf{0} = 0\)).
    The claim follows from the *Equivalent Definition of Linear Independence*. \(\square\)'
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明:* 对于任何 \(\mathbf{x} \neq \mathbf{0}\)，根据正定性的定义，有 \(\mathbf{x}^T B \mathbf{x}
    > 0\)。特别是，必须有 \(\mathbf{x}^T B \mathbf{x} \neq 0\)，因此，通过反证法，\(B \mathbf{x} \neq
    \mathbf{0}\)（因为对于任何 \(\mathbf{z}\)，都有 \(\mathbf{z}^T \mathbf{0} = 0\)）。这个结论来自于线性无关的等价定义。\(\square\)'
- en: A principal submatrix is a square submatrix obtained by removing some rows and
    columns. Moreover we require that the set of row indices that remain is the same
    as the set of column indices that remain.
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 主子矩阵是通过删除一些行和列得到的正方形子矩阵。此外，我们要求剩余的行索引集合与剩余的列索引集合相同。
- en: '**LEMMA** **(Principal Submatrices)** \(\idx{principal submatrices lemma}\xdi\)
    Let \(B \in \mathbb{R}^{n \times n}\) be positive definite and let \(Z \in \mathbb{R}^{n
    \times p}\) have full column rank. Then \(Z^T B Z\) is positive definite. In particular
    all principal submatrices of positive definite matrices are positive definite.
    \(\flat\)'
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: '**引理** **(主子矩阵)** \(\idx{principal submatrices lemma}\xdi\) 设 \(B \in \mathbb{R}^{n
    \times n}\) 是正定的，并且设 \(Z \in \mathbb{R}^{n \times p}\) 具有满列秩。那么 \(Z^T B Z\) 是正定的。特别是，所有正定矩阵的主子矩阵都是正定的。\(\flat\)'
- en: '*Proof:* If \(\mathbf{x} \neq \mathbf{0}\), then \(\mathbf{x}^T (Z^T B Z) \mathbf{x}
    = \mathbf{y}^T B \mathbf{y}\), where we defined \(\mathbf{y} = Z \mathbf{x}\).
    Because \(Z\) has full column rank and \(\mathbf{x} \neq \mathbf{0}\), it follows
    that \(\mathbf{y} \neq \mathbf{0}\) by the *Equivalent Definition of Linear Independence*.
    Hence, since \(B \succ 0\), we have \(\mathbf{y}^T B \mathbf{y} > 0\) which proves
    the first claim. For the second claim, take \(Z\) of the form \((\mathbf{e}_{m_1}\
    \mathbf{e}_{m_2}\ \ldots\ \mathbf{e}_{m_p})\), where the indices \(m_1, \ldots,
    m_p\) are distinct and increasing. The columns of \(Z\) are then linearly independent
    since they are distinct basis vectors. \(\square\)'
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明:* 如果 \(\mathbf{x} \neq \mathbf{0}\)，那么 \(\mathbf{x}^T (Z^T B Z) \mathbf{x}
    = \mathbf{y}^T B \mathbf{y}\)，其中我们定义 \(\mathbf{y} = Z \mathbf{x}\)。因为 \(Z\) 具有满列秩且
    \(\mathbf{x} \neq \mathbf{0}\)，根据线性无关的等价定义，可以得出 \(\mathbf{y} \neq \mathbf{0}\)。因此，由于
    \(B \succ 0\)，我们有 \(\mathbf{y}^T B \mathbf{y} > 0\)，这证明了第一个结论。对于第二个结论，取 \(Z\)
    的形式为 \((\mathbf{e}_{m_1}\ \mathbf{e}_{m_2}\ \ldots\ \mathbf{e}_{m_p})\)，其中索引 \(m_1,
    \ldots, m_p\) 是不同的且递增的。\(Z\) 的列是线性无关的，因为它们是不同的基向量。\(\square\)'
- en: To better understand the last claim in the proof, note that
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更好地理解证明中的最后一个结论，请注意
- en: \[ (Z^T B Z)_{i,j} = (Z^T)_{i,\cdot} B Z_{\cdot,j} = (Z_{\cdot,i})^T B Z_{\cdot,j}
    = \sum_{k=1}^n \sum_{\ell=1}^n Z_{k,i} B_{k,\ell} Z_{\ell,j}. \]
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: \[ (Z^T B Z)_{i,j} = (Z^T)_{i,\cdot} B Z_{\cdot,j} = (Z_{\cdot,i})^T B Z_{\cdot,j}
    = \sum_{k=1}^n \sum_{\ell=1}^n Z_{k,i} B_{k,\ell} Z_{\ell,j}. \]
- en: So if the \(i\)-th column of \(Z\) is \(\mathbf{e}_{m_i}\) and the \(j\)-th
    column of \(Z\) is \(\mathbf{e}_{m_j}\), then the rightmost summation picks up
    only one element, \(B_{m_i, m_j}\). In other words, \(Z^T B Z\) is the principal
    submatrix of \(B\) corresponding to rows and columns \(m_1, \ldots, m_p\).
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，如果 \(Z\) 的第 \(i\) 列是 \(\mathbf{e}_{m_i}\) 且 \(Z\) 的第 \(j\) 列是 \(\mathbf{e}_{m_j}\)，那么最右边的求和只取一个元素，即
    \(B_{m_i, m_j}\)。换句话说，\(Z^T B Z\) 是对应于行和列 \(m_1, \ldots, m_p\) 的 \(B\) 的主子矩阵。
- en: '**KNOWLEDGE CHECK:** Consider the matrices'
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: '**知识检查:** 考虑以下矩阵'
- en: \[\begin{split} A = \begin{pmatrix} 1 & 3 & 0 & 2\\ 2 & 8 & 4 & 0\\ 6 & 1 &
    1 & 4\\ 3 & 2 & 0 & 1 \end{pmatrix} \qquad\text{and}\qquad Z = \begin{pmatrix}
    0 & 0\\ 1 & 0\\ 0 & 0\\ 0 & 1 \end{pmatrix} \end{split}\]
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} A = \begin{pmatrix} 1 & 3 & 0 & 2\\ 2 & 8 & 4 & 0\\ 6 & 1 &
    1 & 4\\ 3 & 2 & 0 & 1 \end{pmatrix} \qquad\text{and}\qquad Z = \begin{pmatrix}
    0 & 0\\ 1 & 0\\ 0 & 0\\ 0 & 1 \end{pmatrix} \end{split}\]
- en: Which of the following matrices is \(Z^T A Z\)?
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: 以下哪个矩阵是 \(Z^T A Z\)？
- en: a) \(\begin{pmatrix} 1 & 0\\ 6 & 1 \end{pmatrix}\)
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: a) \(\begin{pmatrix} 1 & 0\\ 6 & 1 \end{pmatrix}\)
- en: b) \(\begin{pmatrix} 8 & 0\\ 2 & 1 \end{pmatrix}\)
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: b) \(\begin{pmatrix} 8 & 0\\ 2 & 1 \end{pmatrix}\)
- en: c) \(\begin{pmatrix} 2 & 8 & 4 & 0\\ 3 & 2 & 0 & 1 \end{pmatrix}\)
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: c) \(\begin{pmatrix} 2 & 8 & 4 & 0\\ 3 & 2 & 0 & 1 \end{pmatrix}\)
- en: d) \(\begin{pmatrix} 1 & 0\\ 2 & 4\\ 6 & 1\\ 3 & 0 \end{pmatrix}\)
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: d) \(\begin{pmatrix} 1 & 0\\ 2 & 4\\ 6 & 1\\ 3 & 0 \end{pmatrix}\)
- en: \(\checkmark\)
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: \(\checkmark\)
- en: '**LEMMA** **(Schur Complement)** \(\idx{Schur complement lemma}\xdi\) Let \(B
    \in \mathbb{R}^{n \times n}\) be positive definite and write it in block form'
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: '**引理** **(舒尔补)** \(\idx{Schur complement lemma}\xdi\) 设 \(B \in \mathbb{R}^{n
    \times n}\) 是正定的，并且将其写成块形式'
- en: \[\begin{split} B = \begin{pmatrix} B_{11} & B_{12}\\ B_{12}^T & B_{22} \end{pmatrix}
    \end{split}\]
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} B = \begin{pmatrix} B_{11} & B_{12}\\ B_{12}^T & B_{22} \end{pmatrix}
    \end{split}\]
- en: where \(B_{11} \in \mathbb{R}^{n_1 \times n_1}\) and \(B_{22} \in \mathbb{R}^{n
    - n_1 \times n - n_1}\) are symmetric, and \(B_{12} \in \mathbb{R}^{n_1 \times
    n - n_1}\) . Then the Schur complement of the block \(B_{11}\), i.e., the matrix
    \(B/B_{11} := B_{22} - B_{12}^T B_{11}^{-1} B_{12}\), is well-defined, symmetric,
    and positive definite. The same holds for \(B/B_{22} := B_{11} - B_{12} B_{22}^{-1}
    B_{12}^T\). \(\flat\)
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(B_{11} \in \mathbb{R}^{n_1 \times n_1}\) 和 \(B_{22} \in \mathbb{R}^{n -
    n_1 \times n - n_1}\) 是对称的，且 \(B_{12} \in \mathbb{R}^{n_1 \times n - n_1}\)。然后，块
    \(B_{11}\) 的 Schur 补，即矩阵 \(B/B_{11} := B_{22} - B_{12}^T B_{11}^{-1} B_{12}\)，是良好定义的、对称的且正定的。对于
    \(B/B_{22} := B_{11} - B_{12} B_{22}^{-1} B_{12}^T\) 也同样成立。\(\flat\)
- en: '*Proof:* By the *Principal Submatrices Lemma*, \(B_{11}\) is positive definite.
    By the *Invertibility of Positive Definite Matrices*, \(B_{11}\) is therefore
    invertible. Hence the Schur complement is well defined. Moreover, it is symmetric
    since'
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明:* 根据 *主子矩阵引理*，\(B_{11}\) 是正定的。根据 *正定矩阵的可逆性*，\(B_{11}\) 因此是可逆的。因此 Schur
    补是良好定义的。此外，由于 \(B_{11}\)、\(B_{22}\) 和 \(B_{11}^{-1}\) 的对称性（证明最后一个！），它也是对称的。'
- en: \[ (B/B_{11})^T = B_{22}^T - (B_{12}^T B_{11}^{-1} B_{12})^T = B_{22} - B_{12}^T
    B_{11}^{-1} B_{12} = B/B_{11}, \]
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: \[ (B/B_{11})^T = B_{22}^T - (B_{12}^T B_{11}^{-1} B_{12})^T = B_{22} - B_{12}^T
    B_{11}^{-1} B_{12} = B/B_{11}, \]
- en: by the symmetry of \(B_{11}\), \(B_{22}\), and \(B_{11}^{-1}\) (prove that last
    one!).
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: 通过 \(B_{11}\)、\(B_{22}\) 和 \(B_{11}^{-1}\) 的对称性。
- en: For a non-zero \(\mathbf{x} \in \mathbb{R}^{n_2}\), let
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 对于非零 \(\mathbf{x} \in \mathbb{R}^{n_2}\)，让
- en: \[\begin{split} \mathbf{z} = \begin{pmatrix} \mathbf{z}_1\\ \mathbf{z}_2 \end{pmatrix}
    = \begin{pmatrix} B_{11}^{-1} B_{12} \mathbf{x}\\ - \mathbf{x} \end{pmatrix}.
    \end{split}\]
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \mathbf{z} = \begin{pmatrix} \mathbf{z}_1\\ \mathbf{z}_2 \end{pmatrix}
    = \begin{pmatrix} B_{11}^{-1} B_{12} \mathbf{x}\\ - \mathbf{x} \end{pmatrix}.
    \end{split}\]
- en: The result then follows from the observation that
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 结果可从以下观察得出：
- en: \[\begin{align*} &\mathbf{z}^T \begin{pmatrix} B_{11} & B_{12}\\ B_{12}^T &
    B_{22} \end{pmatrix} \mathbf{z}\\ &= \mathbf{z}_1^T B_{11} \mathbf{z}_1 + 2 \mathbf{z}_1^T
    B_{12} \mathbf{z}_2 + \mathbf{z}_2^T B_{22} \mathbf{z}_2\\ &= (B_{11}^{-1} B_{12}
    \mathbf{x})^T B_{11} B_{11}^{-1} B_{12} \mathbf{x} + 2 (B_{11}^{-1} B_{12} \mathbf{x})^T
    B_{12} (- \mathbf{x}) + (- \mathbf{x})^T B_{22} (- \mathbf{x})\\ &= \mathbf{x}^T
    B_{12}^T B_{11}^{-1} B_{12}\,\mathbf{x} - 2 \mathbf{x}^T B_{12}^T B_{11}^{-1}
    B_{12}\,\mathbf{x} + \mathbf{x}^T B_{22}\,\mathbf{x}\\ &= \mathbf{x}^T(B_{22}
    - B_{12}^T B_{11}^{-1} B_{12})\,\mathbf{x}. \end{align*}\]
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &\mathbf{z}^T \begin{pmatrix} B_{11} & B_{12}\\ B_{12}^T &
    B_{22} \end{pmatrix} \mathbf{z}\\ &= \mathbf{z}_1^T B_{11} \mathbf{z}_1 + 2 \mathbf{z}_1^T
    B_{12} \mathbf{z}_2 + \mathbf{z}_2^T B_{22} \mathbf{z}_2\\ &= (B_{11}^{-1} B_{12}
    \mathbf{x})^T B_{11} B_{11}^{-1} B_{12} \mathbf{x} + 2 (B_{11}^{-1} B_{12} \mathbf{x})^T
    B_{12} (- \mathbf{x}) + (- \mathbf{x})^T B_{22} (- \mathbf{x})\\ &= \mathbf{x}^T
    B_{12}^T B_{11}^{-1} B_{12}\,\mathbf{x} - 2 \mathbf{x}^T B_{12}^T B_{11}^{-1}
    B_{12}\,\mathbf{x} + \mathbf{x}^T B_{22}\,\mathbf{x}\\ &= \mathbf{x}^T(B_{22}
    - B_{12}^T B_{11}^{-1} B_{12})\,\mathbf{x}. \end{align*}\]
- en: \(\square\)
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: \(\square\)
- en: '**Marginals and conditionals** We are now ready to derive the distribution
    of marginals and conditionals of multivariate Gaussians\(\idx{multivariate Gaussian}\xdi\).
    Recall that a multivariate Gaussian\(\idx{multivariate normal}\xdi\) vector \(\mathbf{X}
    = (X_1,\ldots,X_d)\) on \(\mathbb{R}^d\) with mean \(\bmu \in \mathbb{R}^d\) and
    positive definite covariance matrix \(\bSigma \in \mathbb{R}^{d \times d}\) has
    probability density function'
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: '**边缘和条件概率** 我们现在可以推导出多元高斯分布的边缘和条件概率分布\(\idx{多元高斯}\xdi\)。回想一下，在 \(\mathbb{R}^d\)
    上的多元高斯\(\idx{多元正态}\xdi\)向量 \(\mathbf{X} = (X_1,\ldots,X_d)\) 具有均值 \(\bmu \in \mathbb{R}^d\)
    和正定协方差矩阵 \(\bSigma \in \mathbb{R}^{d \times d}\)，其概率密度函数为'
- en: \[ f_{\bmu, \bSigma}(\mathbf{x}) = \frac{1}{(2\pi)^{d/2} \,|\bSigma|^{1/2}}
    \exp\left(-\frac{1}{2}(\mathbf{x} - \bmu)^T \bSigma^{-1} (\mathbf{x} - \bmu)\right).
    \]
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f_{\bmu, \bSigma}(\mathbf{x}) = \frac{1}{(2\pi)^{d/2} \,|\bSigma|^{1/2}}
    \exp\left(-\frac{1}{2}(\mathbf{x} - \bmu)^T \bSigma^{-1} (\mathbf{x} - \bmu)\right).
    \]
- en: Recall that one way to compute \(|\bSigma|\) is as the product of all eigenvalues
    of \(\bSigma\) (with repeats). The matrix \(\bLambda = \bSigma^{-1}\) is called
    the precision matrix.
  id: totrans-371
  prefs: []
  type: TYPE_NORMAL
  zh: 回想一下，计算 \(|\bSigma|\) 的一种方法是将 \(\bSigma\) 的所有特征值（包括重复的）相乘。矩阵 \(\bLambda = \bSigma^{-1}\)
    被称为精度矩阵。
- en: Partition \(\mathbf{X}\) as the column vector \((\mathbf{X}_1, \mathbf{X}_2)\)
    where \(\mathbf{X}_i \in \mathbb{R}^{d_i}\), \(i=1,2\), with \(d_1 + d_2 = d\).
    Similarly, consider the corresponding block vectors and matrices
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: 将 \(\mathbf{X}\) 分解为列向量 \((\mathbf{X}_1, \mathbf{X}_2)\)，其中 \(\mathbf{X}_i \in
    \mathbb{R}^{d_i}\)，\(i=1,2\)，且 \(d_1 + d_2 = d\)。类似地，考虑相应的块向量和矩阵
- en: \[\begin{split} \bmu = \begin{pmatrix} \bmu_1\\ \bmu_2 \end{pmatrix} \qquad
    \bSigma = \begin{pmatrix} \bSigma_{11} & \bSigma_{12}\\ \bSigma_{21} & \bSigma_{22}
    \end{pmatrix} \qquad \bLambda = \begin{pmatrix} \bLambda_{11} & \bLambda_{12}\\
    \bLambda_{21} & \bLambda_{22} \end{pmatrix}. \end{split}\]
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bmu = \begin{pmatrix} \bmu_1\\ \bmu_2 \end{pmatrix} \qquad
    \bSigma = \begin{pmatrix} \bSigma_{11} & \bSigma_{12}\\ \bSigma_{21} & \bSigma_{22}
    \end{pmatrix} \qquad \bLambda = \begin{pmatrix} \bLambda_{11} & \bLambda_{12}\\
    \bLambda_{21} & \bLambda_{22} \end{pmatrix}. \end{split}\]
- en: Note that by the symmetry of \(\bSigma\), we have \(\bSigma_{21} = \bSigma_{12}^T\).
    Furthemore, it can be proved that a symmetric, invertible matrix has a symmetric
    inverse (try it!) so that \(\bLambda_{21} = \bLambda_{12}^T\).
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，由于 \(\bSigma\) 的对称性，我们有 \(\bSigma_{21} = \bSigma_{12}^T\)。此外，可以证明一个对称且可逆的矩阵有一个对称的逆矩阵（试试看！）因此
    \(\bLambda_{21} = \bLambda_{12}^T\)。
- en: We seek to compute the marginals\(\idx{marginal}\xdi\) \(f_{\mathbf{X}_1}(\mathbf{x}_1)\)
    and \(f_{\mathbf{X}_2}(\mathbf{x}_2)\), as well as the conditional density of
    \(\mathbf{X}_1\) given \(\mathbf{X}_2\), which we denote as \(f_{\mathbf{X}_1|\mathbf{X}_2}(\mathbf{x}_1|\mathbf{x}_2)\),
    and similarly \(f_{\mathbf{X}_2|\mathbf{X}_1}(\mathbf{x}_2|\mathbf{x}_1)\).
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: 我们试图计算边缘分布\(\idx{marginal}\xdi\) \(f_{\mathbf{X}_1}(\mathbf{x}_1)\) 和 \(f_{\mathbf{X}_2}(\mathbf{x}_2)\)，以及给定
    \(\mathbf{X}_2\) 的 \(\mathbf{X}_1\) 的条件密度，我们将其表示为 \(f_{\mathbf{X}_1|\mathbf{X}_2}(\mathbf{x}_1|\mathbf{x}_2)\)，同样
    \(f_{\mathbf{X}_2|\mathbf{X}_1}(\mathbf{x}_2|\mathbf{x}_1)\)。
- en: By the multiplication rule, the joint density \(f_{\mathbf{X}_1,\mathbf{X}_2}(\mathbf{x}_1,\mathbf{x}_2)\)
    can be decomposed as
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: 根据乘法规则，联合密度 \(f_{\mathbf{X}_1,\mathbf{X}_2}(\mathbf{x}_1,\mathbf{x}_2)\) 可以分解为
- en: \[ f_{\mathbf{X}_1,\mathbf{X}_2}(\mathbf{x}_1,\mathbf{x}_2) = f_{\mathbf{X}_1|\mathbf{X}_2}(\mathbf{x}_1|\mathbf{x}_2)
    f_{\mathbf{X}_2}(\mathbf{x}_2). \]
  id: totrans-377
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f_{\mathbf{X}_1,\mathbf{X}_2}(\mathbf{x}_1,\mathbf{x}_2) = f_{\mathbf{X}_1|\mathbf{X}_2}(\mathbf{x}_1|\mathbf{x}_2)
    f_{\mathbf{X}_2}(\mathbf{x}_2). \]
- en: We use the *Inverting a Block Matrix* lemma to rewrite \(f_{\mathbf{X}_1,\mathbf{X}_2}(\mathbf{x}_1,\mathbf{x}_2)\)
    in this form and “reveal” the marginal and conditional\(\idx{conditional}\xdi\)
    involved. Indeed, once the joint density is in this form, by integrating over
    \(\mathbf{x}_1\) we obtain that the marginal density of \(\mathbf{X}_2\) is \(f_{\mathbf{X}_2}\)
    and the conditional density of \(\mathbf{X}_1\) given \(\mathbf{X}_2\) is obtained
    by taking the ratio of the joint and the marginal.
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用 *逆矩阵的块矩阵* 引理将 \(f_{\mathbf{X}_1,\mathbf{X}_2}(\mathbf{x}_1,\mathbf{x}_2)\)
    重写为这种形式，并“揭示”涉及的边缘和条件\(\idx{conditional}\xdi\)。确实，一旦联合密度以这种形式存在，通过对 \(\mathbf{x}_1\)
    进行积分，我们得到 \(\mathbf{X}_2\) 的边缘密度为 \(f_{\mathbf{X}_2}\)，而给定 \(\mathbf{X}_2\) 的
    \(\mathbf{X}_1\) 的条件密度是通过联合密度和边缘密度的比值得到的。
- en: In fact, it will be easier to work with an expression derived in the proof of
    that lemma, specifically
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，使用该引理的证明中推导出的表达式会更简单，具体来说
- en: \[\begin{align*} &\begin{pmatrix} \bSigma_{11} & \bSigma_{12}\\ \bSigma_{21}
    & \bSigma_{22} \end{pmatrix}^{-1}\\ &= \begin{pmatrix} I_{d_1 \times d_1} & \mathbf{0}\\
    - \bSigma_{22}^{-1} \bSigma_{12}^T & I_{d_2 \times d_2} \end{pmatrix} \begin{pmatrix}
    (\bSigma/\bSigma_{22})^{-1} & \mathbf{0}\\ \mathbf{0} & \bSigma_{22}^{-1} \end{pmatrix}
    \begin{pmatrix} I_{d_1 \times d_1} & - \bSigma_{12} \bSigma_{22}^{-1}\\ \mathbf{0}
    & I_{d_2 \times d_2} \end{pmatrix}. \end{align*}\]
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &\begin{pmatrix} \bSigma_{11} & \bSigma_{12}\\ \bSigma_{21}
    & \bSigma_{22} \end{pmatrix}^{-1}\\ &= \begin{pmatrix} I_{d_1 \times d_1} & \mathbf{0}\\
    - \bSigma_{22}^{-1} \bSigma_{12}^T & I_{d_2 \times d_2} \end{pmatrix} \begin{pmatrix}
    (\bSigma/\bSigma_{22})^{-1} & \mathbf{0}\\ \mathbf{0} & \bSigma_{22}^{-1} \end{pmatrix}
    \begin{pmatrix} I_{d_1 \times d_1} & - \bSigma_{12} \bSigma_{22}^{-1}\\ \mathbf{0}
    & I_{d_2 \times d_2} \end{pmatrix}. \end{align*}\]
- en: We will use the fact that the first matrix on the last line is the transpose
    of the third one (check it!).
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用事实，即最后一行上的第一个矩阵是第三个矩阵的转置（检查一下！）。
- en: To evaluate the joint density, we need to expand the quadratic function \((\mathbf{x}
    - \bmu)^T \bSigma^{-1} (\mathbf{x} - \bmu)\) appearing in the exponential. We
    break this up in a few steps.
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: 为了评估联合密度，我们需要展开指数中出现的二次函数 \((\mathbf{x} - \bmu)^T \bSigma^{-1} (\mathbf{x} -
    \bmu)\)。我们将这一过程分解为几个步骤。
- en: 1- Note first that
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: 1- 首先注意
- en: \[\begin{split} \begin{pmatrix} I_{d_1 \times d_1} & - \bSigma_{12} \bSigma_{22}^{-1}\\
    \mathbf{0} & I_{d_2 \times d_2} \end{pmatrix} \begin{pmatrix} \mathbf{x}_1 - \bmu_1\\
    \mathbf{x}_2 - \bmu_2 \end{pmatrix} = \begin{pmatrix} (\mathbf{x}_1 - \bmu_1)
    - \bSigma_{12} \bSigma_{22}^{-1} (\mathbf{x}_2 - \bmu_2) \\ \mathbf{x}_2 - \bmu_2
    \end{pmatrix} \end{split}\]
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} I_{d_1 \times d_1} & - \bSigma_{12} \bSigma_{22}^{-1}\\
    \mathbf{0} & I_{d_2 \times d_2} \end{pmatrix} \begin{pmatrix} \mathbf{x}_1 - \bmu_1\\
    \mathbf{x}_2 - \bmu_2 \end{pmatrix} = \begin{pmatrix} (\mathbf{x}_1 - \bmu_1)
    - \bSigma_{12} \bSigma_{22}^{-1} (\mathbf{x}_2 - \bmu_2) \\ \mathbf{x}_2 - \bmu_2
    \end{pmatrix} \end{split}\]
- en: and similarly for its transpose. We define
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: 同样地，对于其转置也是如此。我们定义
- en: \[ \bmu_{1|2}(\mathbf{x}_2) := \bmu_1 + \bSigma_{12} \bSigma_{22}^{-1} (\mathbf{x}_2
    - \bmu_2). \]
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bmu_{1|2}(\mathbf{x}_2) := \bmu_1 + \bSigma_{12} \bSigma_{22}^{-1} (\mathbf{x}_2
    - \bmu_2). \]
- en: 2- Plugging this back in the quadratic function, we get
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: 2- 将其代入二次函数中，我们得到
- en: \[\begin{align*} &(\mathbf{x} - \bmu)^T \bSigma^{-1} (\mathbf{x} - \bmu)\\ &=
    \begin{pmatrix} \mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2) \\ \mathbf{x}_2 - \bmu_2
    \end{pmatrix}^T \begin{pmatrix} (\bSigma/\bSigma_{22})^{-1} & \mathbf{0}\\ \mathbf{0}
    & \bSigma_{22}^{-1} \end{pmatrix} \begin{pmatrix} \mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2)
    \\ \mathbf{x}_2 - \bmu_2 \end{pmatrix}\\ &= (\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2))^T
    (\bSigma/\bSigma_{22})^{-1} (\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2)) + (\mathbf{x}_2
    - \bmu_2)^T \bSigma_{22}^{-1} (\mathbf{x}_2 - \bmu_2). \end{align*}\]
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &(\mathbf{x} - \bmu)^T \bSigma^{-1} (\mathbf{x} - \bmu)\\ &=
    \begin{pmatrix} \mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2) \\ \mathbf{x}_2 - \bmu_2
    \end{pmatrix}^T \begin{pmatrix} (\bSigma/\bSigma_{22})^{-1} & \mathbf{0}\\ \mathbf{0}
    & \bSigma_{22}^{-1} \end{pmatrix} \begin{pmatrix} \mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2)
    \\ \mathbf{x}_2 - \bmu_2 \end{pmatrix}\\ &= (\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2))^T
    (\bSigma/\bSigma_{22})^{-1} (\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2)) + (\mathbf{x}_2
    - \bmu_2)^T \bSigma_{22}^{-1} (\mathbf{x}_2 - \bmu_2). \end{align*}\]
- en: Note that both terms have the same form as the original quadratic function.
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，这两个项与原始二次函数具有相同的形式。
- en: 3- Going back to the density, we use \(\propto\) to indicate that the expression
    holds up to a constant not depending on \(\mathbf{x}\). Using that the exponential
    of a sum is the product of exponentials, we obtain
  id: totrans-390
  prefs: []
  type: TYPE_NORMAL
  zh: 3- 返回密度函数，我们用\(\propto\)表示该表达式在常数项上成立，该常数项不依赖于\(\mathbf{x}\)。利用指数和的指数等于指数的乘积，我们得到
- en: \[\begin{align*} &f_{\mathbf{X}_1,\mathbf{X}_2}(\mathbf{x}_1,\mathbf{x}_2)\\
    &\propto \exp\left(-\frac{1}{2}(\mathbf{x} - \bmu)^T \bSigma^{-1} (\mathbf{x}
    - \bmu)\right)\\ &\propto \exp\left(-\frac{1}{2}(\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2))^T
    (\bSigma/\bSigma_{22})^{-1} (\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2))\right)\\
    & \qquad \times \exp\left(-\frac{1}{2}(\mathbf{x}_2 - \bmu_2)^T \bSigma_{22}^{-1}
    (\mathbf{x}_2 - \bmu_2)\right). \end{align*}\]
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &f_{\mathbf{X}_1,\mathbf{X}_2}(\mathbf{x}_1,\mathbf{x}_2)\\
    &\propto \exp\left(-\frac{1}{2}(\mathbf{x} - \bmu)^T \bSigma^{-1} (\mathbf{x}
    - \bmu)\right)\\ &\propto \exp\left(-\frac{1}{2}(\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2))^T
    (\bSigma/\bSigma_{22})^{-1} (\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2))\right)\\
    & \qquad \times \exp\left(-\frac{1}{2}(\mathbf{x}_2 - \bmu_2)^T \bSigma_{22}^{-1}
    (\mathbf{x}_2 - \bmu_2)\right). \end{align*}\]
- en: 4- We have shown that
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: 4- 我们已经证明
- en: \[ f_{\mathbf{X}_1|\mathbf{X}_2}(\mathbf{x}_1|\mathbf{x}_2) \propto \exp\left(-\frac{1}{2}(\mathbf{x}_1
    - \bmu_{1|2}(\mathbf{x}_2))^T (\bSigma/\bSigma_{22})^{-1} (\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2))\right)
    \]
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f_{\mathbf{X}_1|\mathbf{X}_2}(\mathbf{x}_1|\mathbf{x}_2) \propto \exp\left(-\frac{1}{2}(\mathbf{x}_1
    - \bmu_{1|2}(\mathbf{x}_2))^T (\bSigma/\bSigma_{22})^{-1} (\mathbf{x}_1 - \bmu_{1|2}(\mathbf{x}_2))\right)
    \]
- en: and
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: 和
- en: \[ f_{\mathbf{X}_2}(\mathbf{x}_2) \propto \exp\left(-\frac{1}{2}(\mathbf{x}_2
    - \bmu_2)^T \bSigma_{22}^{-1} (\mathbf{x}_2 - \bmu_2)\right). \]
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f_{\mathbf{X}_2}(\mathbf{x}_2) \propto \exp\left(-\frac{1}{2}(\mathbf{x}_2
    - \bmu_2)^T \bSigma_{22}^{-1} (\mathbf{x}_2 - \bmu_2)\right). \]
- en: In other words, the marginal density of \(\mathbf{X}_2\) is multivariate Gaussian
    with mean \(\bmu_2\) and covariance \(\bSigma_{22}\). The conditional density
    of \(\mathbf{X}_1\) given \(\mathbf{X}_2\) is multivariate Gaussian with mean
    \(\bmu_{1|2}(\mathbf{X}_2)\) and covariance \(\bSigma/\bSigma_{22} = \bSigma_{11}
    - \bSigma_{12} \bSigma_{22}^{-1} \bSigma_{12}^T\). We write this as
  id: totrans-396
  prefs: []
  type: TYPE_NORMAL
  zh: 换句话说，\(\mathbf{X}_2\)的边缘密度是具有均值\(\bmu_2\)和协方差\(\bSigma_{22}\)的多变量高斯分布。给定\(\mathbf{X}_2\)的\(\mathbf{X}_1\)的条件密度是具有均值\(\bmu_{1|2}(\mathbf{X}_2)\)和协方差\(\bSigma/\bSigma_{22}
    = \bSigma_{11} - \bSigma_{12} \bSigma_{22}^{-1} \bSigma_{12}^T\)的多变量高斯分布。我们将其表示为
- en: \[ \mathbf{X}_1|\mathbf{X}_2 \sim N_{d_1}(\bmu_{1|2}(\mathbf{X}_2), \bSigma/\bSigma_{22})
    \]
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{X}_1|\mathbf{X}_2 \sim N_{d_1}(\bmu_{1|2}(\mathbf{X}_2), \bSigma/\bSigma_{22})
    \]
- en: and
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
  zh: 和
- en: \[ \mathbf{X}_2 \sim N_{d_2}(\bmu_2, \bSigma_{22}). \]
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mathbf{X}_2 \sim N_{d_2}(\bmu_2, \bSigma_{22}). \]
- en: Similarly, by exchanging the roles of \(\mathbf{X}_1\) and \(\mathbf{X}_2\),
    we see that the marginal density of \(\mathbf{X}_1\) is multivariate Gaussian
    with mean \(\bmu_1\) and covariance \(\bSigma_{11}\). The conditional density
    of \(\mathbf{X}_2\) given \(\mathbf{X}_1\) is multivariate Gaussian with mean
    \(\bmu_{2|1}(\mathbf{X}_1) = \bmu_2 + \bSigma_{21} \bSigma_{11}^{-1} (\mathbf{X}_1
    - \bmu_1)\) and covariance \(\bSigma/\bSigma_{11} = \bSigma_{22} - \bSigma_{12}^T
    \bSigma_{11}^{-1} \bSigma_{12}\).
  id: totrans-400
  prefs: []
  type: TYPE_NORMAL
  zh: 类似地，通过交换\(\mathbf{X}_1\)和\(\mathbf{X}_2\)的角色，我们可以看到\(\mathbf{X}_1\)的边缘密度是具有均值\(\bmu_1\)和协方差\(\bSigma_{11}\)的多变量高斯分布。给定\(\mathbf{X}_1\)的\(\mathbf{X}_2\)的条件密度是具有均值\(\bmu_{2|1}(\mathbf{X}_1)
    = \bmu_2 + \bSigma_{21} \bSigma_{11}^{-1} (\mathbf{X}_1 - \bmu_1)\)和协方差\(\bSigma/\bSigma_{11}
    = \bSigma_{22} - \bSigma_{12}^T \bSigma_{11}^{-1} \bSigma_{12}\)的多变量高斯分布。
- en: '**KNOWLEDGE CHECK:** Suppose \((X_1, X_2)\) is a bivariate Gaussian with mean
    \((0,0)\), variances \(2\) and correlation coefficient \(-1/2\). Conditioned on
    \(X_2 = 1\), what is the mean of \(X_1\)?'
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: '**知识检查：** 假设\((X_1, X_2)\)是一个均值为\((0,0)\)，方差为\(2\)，相关系数为\(-1/2\)的双变量高斯分布。在\(X_2
    = 1\)的条件下，\(X_1\)的均值是多少？'
- en: a) \(1/2\)
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
  zh: a) \(1/2\)
- en: b) \(-1/2\)
  id: totrans-403
  prefs: []
  type: TYPE_NORMAL
  zh: b) \(-1/2\)
- en: c) \(1\)
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: c) \(1\)
- en: d) \(-1\)
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
  zh: d) \(-1\)
- en: \(\checkmark\)
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
  zh: \(\checkmark\)
- en: 6.5.2\. Kalman filter[#](#kalman-filter "Link to this heading")
  id: totrans-407
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 6.5.2\. 卡尔曼滤波[#](#kalman-filter "链接到这个标题")
- en: We consider a stochastic process\(\idx{stochastic process}\xdi\) \(\{\bX_t\}_{t=0}^T\)
    (i.e., a collection of random vectors – often indexed by time) with state space
    \(\S = \mathbb{R}^{d_0}\) of the following form
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
  zh: 我们考虑一个随机过程\(\idx{stochastic process}\xdi\) \(\{\bX_t\}_{t=0}^T\)（即一组随机向量——通常按时间索引）的状态空间\(\S
    = \mathbb{R}^{d_0}\)具有以下形式
- en: \[ \bX_{t+1} = F \,\bX_t + \bW_t \]
  id: totrans-409
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bX_{t+1} = F \,\bX_t + \bW_t \]
- en: where the \(\bW_t\)s are i.i.d. \(N_{d_0}(\mathbf{0}, Q)\) and \(F\) and \(Q\)
    are known \(d_0 \times d_0\) matrices. We denote the initial state by \(\bX_0
    \sim N_{d_0}(\bmu_0, \bSigma_0)\). We assume that the process \(\{\bX_t\}_{t=1}^T\)
    is not observed, but rather that an auxiliary observed process \(\{\bY_t\}_{t=1}^T\)
    with state space \(\S = \mathbb{R}^{d}\) satisfies
  id: totrans-410
  prefs: []
  type: TYPE_NORMAL
  zh: 其中\(\bW_t\)s是独立同分布的\(N_{d_0}(\mathbf{0}, Q)\)，\(F\)和\(Q\)是已知的\(d_0 \times d_0\)矩阵。我们用\(\bX_0
    \sim N_{d_0}(\bmu_0, \bSigma_0)\)表示初始状态。我们假设过程\(\{\bX_t\}_{t=1}^T\)没有被观察到，而是辅助观察过程\(\{\bY_t\}_{t=1}^T\)，其状态空间为\(\S
    = \mathbb{R}^{d}\)满足
- en: \[ \bY_t = H\,\bX_t + \bV_t \]
  id: totrans-411
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bY_t = H\,\bX_t + \bV_t \]
- en: where the \(\bV_t\)s are i.i.d. \(N_d(\mathbf{0}, R)\) and \(H \in \mathbb{R}^{d
    \times d_0}\) and \(R \in \mathbb{R}^{d \times d}\) are known matrices. This is
    an example of a linear-Gaussian system\(\idx{linear-Gaussian system}\xdi\) (also
    known as linear-Gaussian state space model).
  id: totrans-412
  prefs: []
  type: TYPE_NORMAL
  zh: 其中\(\bV_t\)s是独立同分布的\(N_d(\mathbf{0}, R)\)，\(H \in \mathbb{R}^{d \times d_0}\)和\(R
    \in \mathbb{R}^{d \times d}\)是已知的矩阵。这是一个线性高斯系统\(\idx{linear-Gaussian system}\xdi\)（也称为线性高斯状态空间模型）的例子。
- en: 'Our goal is to infer the unobserved states given the observed process. Specifically,
    we look at the filtering problem. Quoting [Wikipedia](https://en.wikipedia.org/wiki/Hidden_Markov_model#Filtering):'
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的目标是根据观察到的过程推断未观察到的状态。具体来说，我们研究滤波问题。引用[Wikipedia](https://en.wikipedia.org/wiki/Hidden_Markov_model#Filtering)：
- en: The task is to compute, given the model’s parameters and a sequence of observations,
    the distribution over hidden states of the last latent variable at the end of
    the sequence, i.e. to compute P(x(t)|y(1),…,y(t)). This task is normally used
    when the sequence of latent variables is thought of as the underlying states that
    a process moves through at a sequence of points of time, with corresponding observations
    at each point in time. Then, it is natural to ask about the state of the process
    at the end.
  id: totrans-414
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 任务是在给定模型参数和一系列观察值的情况下，计算序列末尾最后一个潜在状态的分布，即计算P(x(t)|y(1),…,y(t))。当认为潜在变量的序列是过程在一系列时间点移动的潜在状态，每个时间点都有相应的观察值时，通常使用此任务。然后，自然地会询问过程在序列末尾的状态。
- en: '**Key lemma** Given the structure of the linear-Gaussian model, the following
    lemma will play a key role.'
  id: totrans-415
  prefs: []
  type: TYPE_NORMAL
  zh: '**关键引理** 给定线性高斯模型的结构，以下引理将发挥关键作用。'
- en: '**LEMMA** **(Linear-Gaussian System)** \(\idx{linear-Gaussian system lemma}\xdi\)
    Let \(\bW \sim N_{d}(\bmu, \bSigma)\) and \(\bW''|\bW \sim N_{d''}(A \,\bW, \bSigma'')\)
    where \(A \in \mathbb{R}^{d'' \times d}\) is a deterministic matrix, and \(\bSigma
    \in \mathbb{R}^{d \times d}\) and \(\bSigma'' \in \mathbb{R}^{d'' \times d''}\)
    are positive definite. Then, \((\bW, \bW'')\) is multivariate Gaussian with mean
    vector'
  id: totrans-416
  prefs: []
  type: TYPE_NORMAL
  zh: '**引理** **(线性高斯系统)** \(\idx{linear-Gaussian system lemma}\xdi\) 设\(\bW \sim
    N_{d}(\bmu, \bSigma)\)和\(\bW''|\bW \sim N_{d''}(A \,\bW, \bSigma'')\)，其中\(A \in
    \mathbb{R}^{d'' \times d}\)是一个确定性矩阵，且\(\bSigma \in \mathbb{R}^{d \times d}\)和\(\bSigma''
    \in \mathbb{R}^{d'' \times d''}\)是正定的。那么，\((\bW, \bW'')\)是多元高斯分布，其均值向量为'
- en: \[\begin{split} \bmu'' = \begin{pmatrix} \bmu \\ A\bmu \end{pmatrix} \end{split}\]
  id: totrans-417
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bmu'' = \begin{pmatrix} \bmu \\ A\bmu \end{pmatrix} \end{split}\]
- en: and positive definite covariance matrix
  id: totrans-418
  prefs: []
  type: TYPE_NORMAL
  zh: 和正定协方差矩阵
- en: \[\begin{split} \bSigma'' = \begin{pmatrix} \bSigma & \bSigma A^T\\ A \bSigma
    & A \bSigma A^T + \bSigma' \end{pmatrix}. \end{split}\]
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bSigma'' = \begin{pmatrix} \bSigma & \bSigma A^T\\ A \bSigma
    & A \bSigma A^T + \bSigma' \end{pmatrix}. \end{split}\]
- en: \(\flat\)
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: \(\flat\)
- en: '**KNOWLEDGE CHECK:** What are the dimensions of each block of \(\bSigma''''\)?
    \(\checkmark\)'
  id: totrans-421
  prefs: []
  type: TYPE_NORMAL
  zh: '**知识检查：** \(\bSigma''''\)的每个块的维度是什么？\(\checkmark\)'
- en: '*Proof:* We have'
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: '*证明：* 我们有'
- en: \[\begin{align*} &f_{\bW, \bW'}(\bw, \bw')\\ &= f_{\bW}(\bw) \, f_{\bW'|\bW}(\bw'|\bw)\\
    &\propto \exp\left(-\frac{1}{2}(\bw - \bmu)^T \bSigma^{-1} (\bw - \bmu)\right)\\
    & \qquad \times \exp\left(-\frac{1}{2}(\bw' - A \bw)^T (\bSigma')^{-1} (\bw' -
    A \bw)\right)\\ &\propto \exp\left(-\frac{1}{2}\left[(\bw - \bmu)^T \bSigma^{-1}
    (\bw - \bmu) + (\bw' - A \bw)^T (\bSigma')^{-1} (\bw' - A \bw)\right]\right).
    \end{align*}\]
  id: totrans-423
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &f_{\bW, \bW'}(\bw, \bw')\\ &= f_{\bW}(\bw) \, f_{\bW'|\bW}(\bw'|\bw)\\
    &\propto \exp\left(-\frac{1}{2}(\bw - \bmu)^T \bSigma^{-1} (\bw - \bmu)\right)\\
    & \qquad \times \exp\left(-\frac{1}{2}(\bw' - A \bw)^T (\bSigma')^{-1} (\bw' -
    A \bw)\right)\\ &\propto \exp\left(-\frac{1}{2}\left[(\bw - \bmu)^T \bSigma^{-1}
    (\bw - \bmu) + (\bw' - A \bw)^T (\bSigma')^{-1} (\bw' - A \bw)\right]\right).
    \end{align*}\]
- en: We re-write the quadratic function in square brackets in the exponent as follows
  id: totrans-424
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将指数中的平方函数重写为如下形式
- en: \[\begin{align*} &(\bw - \bmu)^T \bSigma^{-1} (\bw - \bmu) + (\bw' - A \bw)^T
    (\bSigma')^{-1} (\bw' - A \bw)\\ &=(\bw - \bmu)^T \bSigma^{-1} (\bw - \bmu)\\
    & \qquad + ([\bw' - A\bmu] - A[\bw-\bmu])^T (\bSigma')^{-1} ([\bw' - A\bmu] -
    A[\bw-\bmu])\\ &=(\bw - \bmu)^T (A^T (\bSigma')^{-1} A + \bSigma^{-1}) (\bw -
    \bmu)\\ & \qquad - 2 (\bw-\bmu)^T A^T (\bSigma')^{-1} (\bw' - A\bmu) + (\bw' -
    A\bmu)^T (\bSigma')^{-1} (\bw' - A\bmu)\\ &= \begin{pmatrix} \bw - \bmu \\ \bw'
    - A\bmu \end{pmatrix}^T \begin{pmatrix} A^T (\bSigma')^{-1} A + \bSigma^{-1} &
    - A^T (\bSigma')^{-1}\\ - (\bSigma')^{-1} A & (\bSigma')^{-1} \end{pmatrix} \begin{pmatrix}
    \bw - \bmu \\ \bw' - A\bmu \end{pmatrix}\\ &= \begin{pmatrix} \bw - \bmu \\ \bw'
    - A\bmu \end{pmatrix}^T \bLambda'' \begin{pmatrix} \bw - \bmu \\ \bw' - A\bmu
    \end{pmatrix}, \end{align*}\]
  id: totrans-425
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &(\bw - \bmu)^T \bSigma^{-1} (\bw - \bmu) + (\bw' - A \bw)^T
    (\bSigma')^{-1} (\bw' - A \bw)\\ &=(\bw - \bmu)^T \bSigma^{-1} (\bw - \bmu)\\
    & \qquad + ([\bw' - A\bmu] - A[\bw-\bmu])^T (\bSigma')^{-1} ([\bw' - A\bmu] -
    A[\bw-\bmu])\\ &=(\bw - \bmu)^T (A^T (\bSigma')^{-1} A + \bSigma^{-1}) (\bw -
    \bmu)\\ & \qquad - 2 (\bw-\bmu)^T A^T (\bSigma')^{-1} (\bw' - A\bmu) + (\bw' -
    A\bmu)^T (\bSigma')^{-1} (\bw' - A\bmu)\\ &= \begin{pmatrix} \bw - \bmu \\ \bw'
    - A\bmu \end{pmatrix}^T \begin{pmatrix} A^T (\bSigma')^{-1} A + \bSigma^{-1} &
    - A^T (\bSigma')^{-1}\\ - (\bSigma')^{-1} A & (\bSigma')^{-1} \end{pmatrix} \begin{pmatrix}
    \bw - \bmu \\ \bw' - A\bmu \end{pmatrix}\\ &= \begin{pmatrix} \bw - \bmu \\ \bw'
    - A\bmu \end{pmatrix}^T \bLambda'' \begin{pmatrix} \bw - \bmu \\ \bw' - A\bmu
    \end{pmatrix}, \end{align*}\]
- en: where the last line defines \(\bLambda''\) and the second line shows that it
    is positive definite (why?). We have shown that \((\bW, \bW')\) is multivariate
    Gaussian with mean \((\bmu, A\bmu)\).
  id: totrans-426
  prefs: []
  type: TYPE_NORMAL
  zh: 其中最后一行定义了 \(\bLambda''\)，第二行显示它是正定的（为什么？）。我们已经证明了 \((\bW, \bW')\) 是具有均值 \((\bmu,
    A\bmu)\) 的多元高斯分布。
- en: We use the *Inverting a Block Matrix Lemma* to invert \(\bLambda''\) and reveal
    the covariance matrix. (One could also compute the covariance directly; try it!)
    We break up \(\bLambda''\) into blocks
  id: totrans-427
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用 *块矩阵求逆引理* 来求 \(\bLambda''\) 的逆并揭示协方差矩阵。（也可以直接计算协方差；试试看！）我们将 \(\bLambda''\)
    分解为块
- en: \[\begin{split} \bLambda'' = \begin{pmatrix} \bLambda''_{11} & \bLambda''_{12}\\
    (\bLambda''_{12})^T & \bLambda''_{22} \end{pmatrix} \end{split}\]
  id: totrans-428
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bLambda'' = \begin{pmatrix} \bLambda''_{11} & \bLambda''_{12}\\
    (\bLambda''_{12})^T & \bLambda''_{22} \end{pmatrix} \end{split}\]
- en: where \(\bLambda''_{11} \in \mathbb{R}^{d \times d}\), \(\bLambda''_{22} \in
    \mathbb{R}^{d' \times d'}\), and \(\bLambda''_{12} \in \mathbb{R}^{d \times d'}\).
    Recall that the inverse is
  id: totrans-429
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(\bLambda''_{11} \in \mathbb{R}^{d \times d}\)，\(\bLambda''_{22} \in \mathbb{R}^{d'
    \times d'}\)，和 \(\bLambda''_{12} \in \mathbb{R}^{d \times d'}\)。回忆一下，逆是
- en: \[\begin{split} B^{-1} = \begin{pmatrix} (B/B_{22})^{-1} & -(B/B_{22})^{-1}
    B_{12} B_{22}^{-1}\\ -B_{22}^{-1} B_{12}^T (B/B_{22})^{-1} & B_{22}^{-1} B_{12}^T
    (B/B_{22})^{-1} B_{12} B_{22}^{-1} + B_{22}^{-1} \end{pmatrix} \end{split}\]
  id: totrans-430
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} B^{-1} = \begin{pmatrix} (B/B_{22})^{-1} & -(B/B_{22})^{-1}
    B_{12} B_{22}^{-1}\\ -B_{22}^{-1} B_{12}^T (B/B_{22})^{-1} & B_{22}^{-1} B_{12}^T
    (B/B_{22})^{-1} B_{12} B_{22}^{-1} + B_{22}^{-1} \end{pmatrix} \end{split}\]
- en: where here \(B = \bLambda''\).
  id: totrans-431
  prefs: []
  type: TYPE_NORMAL
  zh: 其中这里 \(B = \bLambda''\).
- en: The Schur complement is
  id: totrans-432
  prefs: []
  type: TYPE_NORMAL
  zh: Schur 补是
- en: \[\begin{align*} \bLambda'' / \bLambda''_{22} &= \bLambda''_{11} - \bLambda''_{12}
    (\bLambda''_{22})^{-1} (\bLambda''_{12})^T\\ &= A^T (\bSigma')^{-1} A + \bSigma^{-1}
    - (- A^T (\bSigma')^{-1}) ((\bSigma')^{-1})^{-1} (- A^T (\bSigma')^{-1})^T\\ &=
    A^T (\bSigma')^{-1} A + \bSigma^{-1} - A^T (\bSigma')^{-1} \bSigma' (\bSigma')^{-1}
    A\\ &= A^T (\bSigma')^{-1} A + \bSigma^{-1} - A^T (\bSigma')^{-1} A\\ &= \bSigma^{-1}.
    \end{align*}\]
  id: totrans-433
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \bLambda'' / \bLambda''_{22} &= \bLambda''_{11} - \bLambda''_{12}
    (\bLambda''_{22})^{-1} (\bLambda''_{12})^T\\ &= A^T (\bSigma')^{-1} A + \bSigma^{-1}
    - (- A^T (\bSigma')^{-1}) ((\bSigma')^{-1})^{-1} (- A^T (\bSigma')^{-1})^T\\ &=
    A^T (\bSigma')^{-1} A + \bSigma^{-1} - A^T (\bSigma')^{-1} \bSigma' (\bSigma')^{-1}
    A\\ &= A^T (\bSigma')^{-1} A + \bSigma^{-1} - A^T (\bSigma')^{-1} A\\ &= \bSigma^{-1}.
    \end{align*}\]
- en: Hence \((\bLambda'' / \bLambda''_{22})^{-1} = \bSigma\).
  id: totrans-434
  prefs: []
  type: TYPE_NORMAL
  zh: 因此 \((\bLambda'' / \bLambda''_{22})^{-1} = \bSigma\).
- en: Moreover,
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，
- en: \[\begin{align*} - (\bLambda''/\bLambda''_{22})^{-1} \bLambda''_{12} (\bLambda''_{22})^{-1}
    &= - \bSigma (- A^T (\bSigma')^{-1}) ((\bSigma')^{-1})^{-1}\\ &= \bSigma A^T (\bSigma')^{-1}
    \bSigma'\\ &= \bSigma A^T \end{align*}\]
  id: totrans-436
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} - (\bLambda''/\bLambda''_{22})^{-1} \bLambda''_{12} (\bLambda''_{22})^{-1}
    &= - \bSigma (- A^T (\bSigma')^{-1}) ((\bSigma')^{-1})^{-1}\\ &= \bSigma A^T (\bSigma')^{-1}
    \bSigma'\\ &= \bSigma A^T \end{align*}\]
- en: and
  id: totrans-437
  prefs: []
  type: TYPE_NORMAL
  zh: 和
- en: \[\begin{align*} &(\bLambda''_{22})^{-1} (\bLambda''_{12})^T (\bLambda''/\bLambda''_{22})^{-1}
    \bLambda''_{12} (\bLambda''_{22})^{-1} + (\bLambda''_{22})^{-1}\\ &= ((\bSigma')^{-1})^{-1}
    (- A^T (\bSigma')^{-1})^T \bSigma (-A^T (\bSigma')^{-1}) ((\bSigma')^{-1})^{-1}
    + ((\bSigma')^{-1})^{-1}\\ &= \bSigma' (\bSigma')^{-1} A \bSigma A^T (\bSigma')^{-1}
    \bSigma' + \bSigma'\\ &= A \bSigma A^T + \bSigma'. \end{align*}\]
  id: totrans-438
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &(\bLambda''_{22})^{-1} (\bLambda''_{12})^T (\bLambda''/\bLambda''_{22})^{-1}
    \bLambda''_{12} (\bLambda''_{22})^{-1} + (\bLambda''_{22})^{-1}\\ &= ((\bSigma')^{-1})^{-1}
    (- A^T (\bSigma')^{-1})^T \bSigma (-A^T (\bSigma')^{-1}) ((\bSigma')^{-1})^{-1}
    + ((\bSigma')^{-1})^{-1}\\ &= \bSigma' (\bSigma')^{-1} A \bSigma A^T (\bSigma')^{-1}
    \bSigma' + \bSigma'\\ &= A \bSigma A^T + \bSigma'. \end{align*}\]
- en: Plugging back into the formula for the inverse of a block matrix completes the
    proof. \(\square\)
  id: totrans-439
  prefs: []
  type: TYPE_NORMAL
  zh: 将其代入块矩阵逆的公式中，完成证明。 \(\square\)
- en: '**Joint distribution** We extend our previous notation as follows: for two
    disjoint, finite collections of random vectors \(\{\mathbf{U}_i\}_i\) and \(\{\mathbf{W}_j\}_j\)
    defined on the same probability space, we let \(f_{\{\mathbf{U}_i\}_i, \{\mathbf{W}_j\}_j}\)
    be their joint density, \(f_{\{\mathbf{U}_i\}_i | \{\mathbf{W}_j\}_j}\) be the
    conditional density of \(\{\mathbf{U}_i\}_i\) given \(\{\mathbf{W}_j\}_j\), and
    \(f_{\{\mathbf{U}_i\}_i}\) be the marginal density of \(\{\mathbf{U}_i\}_i\).
    Formally, our goal is to compute'
  id: totrans-440
  prefs: []
  type: TYPE_NORMAL
  zh: '**联合分布** 我们将之前的符号扩展如下：对于在相同概率空间上定义的两个不相交的有限随机向量集合 \(\{\mathbf{U}_i\}_i\) 和
    \(\{\mathbf{W}_j\}_j\)，我们令 \(f_{\{\mathbf{U}_i\}_i, \{\mathbf{W}_j\}_j}\) 为它们的联合密度，\(f_{\{\mathbf{U}_i\}_i
    | \{\mathbf{W}_j\}_j}\) 为 \(\{\mathbf{U}_i\}_i\) 在 \(\{\mathbf{W}_j\}_j\) 条件下的条件密度，以及
    \(f_{\{\mathbf{U}_i\}_i}\) 为 \(\{\mathbf{U}_i\}_i\) 的边缘密度。正式来说，我们的目标是递归地在 \(t\)
    上进行计算，其中我们定义 \(\bY_{1:t} = \{\bY_1,\ldots,\bY_{t}\}\)。我们将看到在这个计算中出现的所有密度都是多元高斯分布，因此跟踪均值和协方差就足够了。'
- en: \[ f_{\bX_{t}|\bY_{1:t}} := f_{\{\bX_{t}\}|\{\bY_1,\ldots,\bY_{t}\}} \]
  id: totrans-441
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f_{\bX_{t}|\bY_{1:t}} := f_{\{\bX_{t}\}|\{\bY_1,\ldots,\bY_{t}\}} \]
- en: recursively in \(t\), where we define \(\bY_{1:t} = \{\bY_1,\ldots,\bY_{t}\}\).
    We will see that all densities appearing in this calculation are multivariate
    Gaussians, and therefore keeping track of the means and covariances will suffice.
  id: totrans-442
  prefs: []
  type: TYPE_NORMAL
  zh: 递归地在 \(t\) 上，其中我们定义 \(\bY_{1:t} = \{\bY_1,\ldots,\bY_{t}\}\)。我们将看到在这个计算中出现的所有密度都是多元高斯分布，因此跟踪均值和协方差就足够了。
- en: Formally, we posit that the density of the full process (with both observed
    and unobserved parts) is
  id: totrans-443
  prefs: []
  type: TYPE_NORMAL
  zh: 正式来说，我们假设整个过程（包括观测和未观测部分）的密度是
- en: \[ f_{\bX_0}(\bx_0) \prod_{t=1}^{T} f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})
    f_{\bY_{t}|\bX_{t}}(\by_{t}|\bx_{t}) \]
  id: totrans-444
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f_{\bX_0}(\bx_0) \prod_{t=1}^{T} f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})
    f_{\bY_{t}|\bX_{t}}(\by_{t}|\bx_{t}) \]
- en: where the description of the model stipulates that
  id: totrans-445
  prefs: []
  type: TYPE_NORMAL
  zh: 其中模型描述指定了
- en: \[ \bX_{t}|\bX_{t-1} \sim N_{d_0}(F \,\bX_{t-1}, Q). \]
  id: totrans-446
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bX_{t}|\bX_{t-1} \sim N_{d_0}(F \,\bX_{t-1}, Q). \]
- en: and
  id: totrans-447
  prefs: []
  type: TYPE_NORMAL
  zh: 和
- en: \[ \bY_t|\bX_t \sim N_d(H\,\bX_t, R) \]
  id: totrans-448
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bY_t|\bX_t \sim N_d(H\,\bX_t, R) \]
- en: for all \(t \geq 1\) and \(\bX_0 \sim N_{d_0}(\bmu_0, \bSigma_0)\). We assume
    that \(\bmu_0\) and \(\bSigma_0\) are known. Applying the *Linear-Gaussian System
    Lemma* inductively shows that the full process \((\bX_{0:T}, \bY_{1:T})\) is jointly
    multivariate Gaussian (try it!). In particular, all marginals and conditionals
    are multivariate Gaussians.
  id: totrans-449
  prefs: []
  type: TYPE_NORMAL
  zh: 对于所有 \(t \geq 1\) 和 \(\bX_0 \sim N_{d_0}(\bmu_0, \bSigma_0)\)。我们假设 \(\bmu_0\)
    和 \(\bSigma_0\) 是已知的。通过归纳应用 *线性高斯系统引理*，可以证明整个过程 \((\bX_{0:T}, \bY_{1:T})\) 是联合多元高斯分布（试试看！）特别是，所有边缘和条件分布都是多元高斯分布。
- en: Graphically, it can be represented as follows, where as before each variable
    is a node and its conditional distribution depends only on its parent nodes.
  id: totrans-450
  prefs: []
  type: TYPE_NORMAL
  zh: 图形上，它可以表示如下，其中每个变量是一个节点，其条件分布只依赖于其父节点。
- en: '![HMM (with help from Claude)](../Images/dff6cc66efbd6ca33102a19a1e83e4b7.png)'
  id: totrans-451
  prefs: []
  type: TYPE_IMG
  zh: '![HMM (with help from Claude)](../Images/dff6cc66efbd6ca33102a19a1e83e4b7.png)'
- en: '**Conditional independence** The stipulated form of the joint density of the
    full process implies many conditional independence relations. We will need the
    following two:'
  id: totrans-452
  prefs: []
  type: TYPE_NORMAL
  zh: '**条件独立性** 整个过程的联合密度的指定形式暗示了许多条件独立性关系。我们将需要以下两个：'
- en: 1- \(\bX_t\) is conditionally independent of \(\bY_{1:t-1}\) given \(\bX_{t-1}\)
  id: totrans-453
  prefs: []
  type: TYPE_NORMAL
  zh: 1- \(\bX_t\) 在给定 \(\bX_{t-1}\) 的条件下与 \(\bY_{1:t-1}\) 条件独立
- en: 2- \(\bY_t\) is conditionally independent of \(\bY_{1:t-1}\) given \(\bX_{t}\).
  id: totrans-454
  prefs: []
  type: TYPE_NORMAL
  zh: 2- \(\bY_t\) 在给定 \(\bX_{t}\) 的条件下与 \(\bY_{1:t-1}\) 条件独立。
- en: 'We prove the first one and leave the second one as an exercise. In fact, we
    prove something stronger: \(\bX_t\) is conditionally independent of \(\bX_{0:t-2},
    \bY_{1:t-1}\) given \(\bX_{t-1}\).'
  id: totrans-455
  prefs: []
  type: TYPE_NORMAL
  zh: 我们证明第一个，并将第二个留作练习。实际上，我们证明了一个更强的结论：\(\bX_t\) 在给定 \(\bX_{t-1}\) 的条件下与 \(\bX_{0:t-2},
    \bY_{1:t-1}\) 条件独立。
- en: First, by integrating over \(\by_T\), then \(\bx_{T}\), then \(\by_{T-1}\),
    then \(\bx_{T-1}\), … , then \(\by_t\), we see that the joint density of \((\bX_{0:t},
    \bY_{1:t-1})\) is
  id: totrans-456
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，通过积分 \(\by_T\)，然后 \(\bx_{T}\)，接着 \(\by_{T-1}\)，然后 \(\bx_{T-1}\)，……，最后 \(\by_t\)，我们可以看到
    \((\bX_{0:t}, \bY_{1:t-1})\) 的联合密度是
- en: \[ f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right) f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1}).
    \]
  id: totrans-457
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right) f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1}).
    \]
- en: Similarly, the joint density of \((\bX_{0:t-1}, \bY_{1:t-1})\) is
  id: totrans-458
  prefs: []
  type: TYPE_NORMAL
  zh: 类似地，\((\bX_{0:t-1}, \bY_{1:t-1})\) 的联合密度是
- en: \[ f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right). \]
  id: totrans-459
  prefs: []
  type: TYPE_NORMAL
  zh: \[ f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right). \]
- en: The conditional density given \(\bX_{t-1}\) is then obtained by dividing the
    first expression by the marginal density of \(\bX_{t-1}\)
  id: totrans-460
  prefs: []
  type: TYPE_NORMAL
  zh: 在给定 \(\bX_{t-1}\) 的条件下，通过将第一个表达式除以 \(\bX_{t-1}\) 的边缘密度来获得条件密度
- en: \[\begin{align*} &\frac{f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right) f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})}{f_{\bX_{t-1}}(\bx_{t-1})}\\
    &= \frac{f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right) f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})}{f_{\bX_{t-1}}(\bx_{t-1})}\\
    &= \frac{f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right) }{f_{\bX_{t-1}}(\bx_{t-1})}f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})\\
    &= f_{\bX_{0:t-2}, \bY_{1:t-1}|\bX_{t-1}}(\bx_{0:t-2}, \by_{1:t-1}|\bx_{t-1})
    f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})\\ \end{align*}\]
  id: totrans-461
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} &\frac{f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right) f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})}{f_{\bX_{t-1}}(\bx_{t-1})}\\
    &= \frac{f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right) f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})}{f_{\bX_{t-1}}(\bx_{t-1})}\\
    &= \frac{f_{\bX_0}(\bx_0) \left(\prod_{s=1}^{t-1} f_{\bX_{s}|\bX_{s-1}}(\bx_{s}|\bx_{s-1})
    f_{\bY_{s}|\bX_{s}}(\by_{s}|\bx_{s})\right) }{f_{\bX_{t-1}}(\bx_{t-1})}f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})\\
    &= f_{\bX_{0:t-2}, \bY_{1:t-1}|\bX_{t-1}}(\bx_{0:t-2}, \by_{1:t-1}|\bx_{t-1})
    f_{\bX_{t}|\bX_{t-1}}(\bx_{t}|\bx_{t-1})\\ \end{align*}\]
- en: as claimed.
  id: totrans-462
  prefs: []
  type: TYPE_NORMAL
  zh: 如所声称的。
- en: '**Algorithm** \(\idx{Kalman filter}\xdi\) We give a recursive algorithm for
    solving the filtering problem, that is, for computing the mean vector and covariance
    matrix of the conditional density \(f_{\bX_{t}|\bY_{1:t}}\).'
  id: totrans-463
  prefs: []
  type: TYPE_NORMAL
  zh: '**算法** \(\idx{卡尔曼滤波器}\xdi\) 我们给出一个递归算法来解决滤波问题，即计算条件密度 \(f_{\bX_{t}|\bY_{1:t}}\)
    的均值向量和协方差矩阵。'
- en: '*Initial step:* The first compute \(f_{\bX_1|\bY_1}\). We do this through a
    series of observations which will generalize straightforwardly.'
  id: totrans-464
  prefs: []
  type: TYPE_NORMAL
  zh: '*初始步骤:* 首先计算 \(f_{\bX_1|\bY_1}\)。我们通过一系列观察来完成这项工作，这些观察将直接推广。'
- en: 1- We have \(\bX_0 \sim N_{d_0}(\bmu_0, \bSigma_0)\) and \(\bX_{1}|\bX_{0} \sim
    N_{d_0}(F \,\bX_0, Q)\). So, by the *Linear-Gaussian System Lemma*, the joint
    vector \((\bX_0, \bX_{1})\) is multivariate Gaussian with mean vector \((\bmu_0,
    F \bmu_0)\) and covariance matrix
  id: totrans-465
  prefs: []
  type: TYPE_NORMAL
  zh: 1- 我们有 \(\bX_0 \sim N_{d_0}(\bmu_0, \bSigma_0)\) 和 \(\bX_{1}|\bX_{0} \sim N_{d_0}(F
    \,\bX_0, Q)\)。因此，根据 *线性高斯系统引理*，联合向量 \((\bX_0, \bX_{1})\) 是具有均值向量 \((\bmu_0, F
    \bmu_0)\) 和协方差矩阵的多变量高斯分布
- en: \[\begin{split} \begin{pmatrix} \bSigma_0 & \bSigma_0 F^T\\ F \bSigma_0 & F
    \bSigma_0 F^T + Q \end{pmatrix}. \end{split}\]
  id: totrans-466
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} \bSigma_0 & \bSigma_0 F^T\\ F \bSigma_0 & F
    \bSigma_0 F^T + Q \end{pmatrix}. \end{split}\]
- en: Hence the marginal density of \(\bX_{1}\) is multivariate Gaussian with mean
    vector \(F \bmu_0\) and covariance matrix
  id: totrans-467
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，\(\bX_{1}\) 的边缘密度是具有均值向量 \(F \bmu_0\) 和协方差矩阵的多变量高斯分布
- en: \[ P_0 := F \bSigma_0 F^T + Q. \]
  id: totrans-468
  prefs: []
  type: TYPE_NORMAL
  zh: \[ P_0 := F \bSigma_0 F^T + Q. \]
- en: 2- Combining the previous observation about the marginal density of \(\bX_{1}\)
    with the fact that \(\bY_1|\bX_1 \sim N_d(H\,\bX_1, R)\), the *Linear-Gaussian
    System Lemma* says that \((\bX_1, \bY_{1})\) is multivariate Gaussian with mean
    vector \((F \bmu_0, H F \bmu_0)\) and covariance matrix
  id: totrans-469
  prefs: []
  type: TYPE_NORMAL
  zh: 2- 将关于 \(\bX_{1}\) 边缘密度的先前观察与 \(\bY_1|\bX_1 \sim N_d(H\,\bX_1, R)\) 的事实结合起来，*线性高斯系统引理*
    表明 \((\bX_1, \bY_{1})\) 是具有均值向量 \((F \bmu_0, H F \bmu_0)\) 和协方差矩阵的多变量高斯分布
- en: \[\begin{split} \begin{pmatrix} P_0 & P_0 H^T\\ H P_0 & H P_0 H^T + R \end{pmatrix}.
    \end{split}\]
  id: totrans-470
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} P_0 & P_0 H^T\\ H P_0 & H P_0 H^T + R \end{pmatrix}.
    \end{split}\]
- en: Finally, define \(K_1 := P_0 H^T (H P_0 H^T + R)^{-1}\). This new observation
    and the conditional density formula give that
  id: totrans-471
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，定义 \(K_1 := P_0 H^T (H P_0 H^T + R)^{-1}\)。这个新的观测值和条件密度公式给出
- en: \[ \bX_1|\bY_1 \sim N_d(\bmu_1, \bSigma_1) \]
  id: totrans-472
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bX_1|\bY_1 \sim N_d(\bmu_1, \bSigma_1) \]
- en: where we define
  id: totrans-473
  prefs: []
  type: TYPE_NORMAL
  zh: 其中我们定义
- en: \[\begin{align*} \bmu_1 &:= F \bmu_0 + P_0 H^T (H P_0 H^T + R)^{-1} (\mathbf{Y}_1
    - H F \bmu_0)\\ &= F \bmu_0 + K_1 (\mathbf{Y}_1 - H F \bmu_0) \end{align*}\]
  id: totrans-474
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \bmu_1 &:= F \bmu_0 + P_0 H^T (H P_0 H^T + R)^{-1} (\mathbf{Y}_1
    - H F \bmu_0)\\ &= F \bmu_0 + K_1 (\mathbf{Y}_1 - H F \bmu_0) \end{align*}\]
- en: and
  id: totrans-475
  prefs: []
  type: TYPE_NORMAL
  zh: 和
- en: \[\begin{align*} \bSigma_1 &:= P_0 - P_0 H^T (H P_0 H^T + R)^{-1} H P_0\\ &=
    (I_{d_0 \times d_0} - K_1 H) P_0. \end{align*}\]
  id: totrans-476
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \bSigma_1 &:= P_0 - P_0 H^T (H P_0 H^T + R)^{-1} H P_0\\ &=
    (I_{d_0 \times d_0} - K_1 H) P_0. \end{align*}\]
- en: '*General step:* Assuming by induction that \(\bX_{t-1}|\bY_{1:t-1} \sim N_{d_0}(\bmu_{t-1},
    \bSigma_{t-1})\) where \(\bmu_{t-1}\) depends implicitly on \(\bY_{1:t-1}\) (but
    \(\bSigma_{t-1}\) does not), we deduce the next step. It mimics closely the initial
    step.'
  id: totrans-477
  prefs: []
  type: TYPE_NORMAL
  zh: '*一般步骤：* 假设通过归纳法，\(\bX_{t-1}|\bY_{1:t-1} \sim N_{d_0}(\bmu_{t-1}, \bSigma_{t-1})\)，其中
    \(\bmu_{t-1}\) 依赖于 \(\bY_{1:t-1}\)（但 \(\bSigma_{t-1}\) 不依赖于 \(\bY_{1:t-1}\)），我们推导出下一步。这非常接近初始步骤。'
- en: '1- Predict: We first “predict” \(\bX_{t}\) given \(\bY_{1:t-1}\). We use the
    fact that \(\bX_{t-1}|\bY_{1:t-1} \sim N_{d_0}(\bmu_{t-1}, \bSigma_{t-1})\). Moreover,
    we have that \(\bX_{t}|\bX_{t-1} \sim N_{d_0}(F \,\bX_{t-1}, Q)\) and that \(\bX_t\)
    is conditionally independent of \(\bY_{1:t-1}\) given \(\bX_{t-1}\). So, \(\bX_{t}|\{\bX_{t-1},
    \bY_{1:t-1}\} \sim N_{d_0}(F \,\bX_{t-1}, Q)\) by the *Role of Independence Lemma*.
    By the *Linear-Gaussian System Lemma*, the joint vector \((\bX_{t-1}, \bX_{t})\)
    conditioned on \(\bY_{1:t-1}\) is multivariate Gaussian with mean vector \((\bmu_{t-1},
    F \bmu_{t-1})\) and covariance matrix'
  id: totrans-478
  prefs: []
  type: TYPE_NORMAL
  zh: 1- 预测：我们首先根据 \(\bY_{1:t-1}\) 来“预测” \(\bX_{t}\)。我们使用的事实是 \(\bX_{t-1}|\bY_{1:t-1}
    \sim N_{d_0}(\bmu_{t-1}, \bSigma_{t-1})\)。此外，我们有 \(\bX_{t}|\bX_{t-1} \sim N_{d_0}(F
    \,\bX_{t-1}, Q)\) 并且在给定 \(\bX_{t-1}\) 的条件下，\(\bX_t\) 与 \(\bY_{1:t-1}\) 条件独立。因此，根据**独立性作用引理**，\(\bX_{t}|\{\bX_{t-1},
    \bY_{1:t-1}\} \sim N_{d_0}(F \,\bX_{t-1}, Q)\)。根据**线性高斯系统引理**，在给定 \(\bY_{1:t-1}\)
    的联合向量 \((\bX_{t-1}, \bX_{t})\) 是具有均值向量 \((\bmu_{t-1}, F \bmu_{t-1})\) 和协方差矩阵的多变量高斯分布。
- en: \[\begin{split} \begin{pmatrix} \bSigma_{t-1} & \bSigma_{t-1} F^T\\ F \bSigma_{t-1}
    & F \bSigma_{t-1} F^T + Q \end{pmatrix}. \end{split}\]
  id: totrans-479
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} \bSigma_{t-1} & \bSigma_{t-1} F^T\\ F \bSigma_{t-1}
    & F \bSigma_{t-1} F^T + Q \end{pmatrix}. \end{split}\]
- en: As a consequence, the conditional marginal density of \(\bX_{t}\) given \(\bY_{1:t-1}\)
    is multivariate Gaussian with mean vector \(F \bmu_{t-1}\) and covariance matrix
  id: totrans-480
  prefs: []
  type: TYPE_NORMAL
  zh: 作为结果，给定 \(\bY_{1:t-1}\) 的 \(\bX_{t}\) 的条件边缘密度是具有均值向量 \(F \bmu_{t-1}\) 和协方差矩阵的多变量高斯分布。
- en: \[ P_{t-1} := F \bSigma_{t-1} F^T + Q. \]
  id: totrans-481
  prefs: []
  type: TYPE_NORMAL
  zh: \[ P_{t-1} := F \bSigma_{t-1} F^T + Q. \]
- en: '2- Update: Next we “update” our prediction of \(\bX_{t}\) using the new observation
    \(\bY_{t}\). We have that \(\bY_{t}|\bX_{t} \sim N_d(H\,\bX_{t}, R)\) and that
    \(\bY_t\) is conditionally independent of \(\bY_{1:t-1}\) given \(\bX_{t}\). So
    \(\bY_{t}|\{\bX_{t}, \bY_{1:t-1}\} \sim N_d(H\,\bX_{t}, R)\) by the *Role of Independence*
    lemma. Combining this with the previous observation, the *Linear-Gaussian System*
    lemma says that \((\bX_{t}, \bY_{t})\) given \(\bY_{1:t-1}\) is multivariate Gaussian
    with mean vector \((F \bmu_{t-1}, H F \bmu_{t-1})\) and covariance matrix'
  id: totrans-482
  prefs: []
  type: TYPE_NORMAL
  zh: 2- 更新：接下来我们使用新的观测值 \(\bY_{t}\) 来“更新”对 \(\bX_{t}\) 的预测。我们有 \(\bY_{t}|\bX_{t}
    \sim N_d(H\,\bX_{t}, R)\) 并且在给定 \(\bX_{t}\) 的条件下，\(\bY_t\) 与 \(\bY_{1:t-1}\) 条件独立。因此，根据**独立性作用**引理，\(\bY_{t}|\{\bX_{t},
    \bY_{1:t-1}\} \sim N_d(H\,\bX_{t}, R)\)。结合之前的观测，**线性高斯系统**引理表明，给定 \(\bY_{1:t-1}\)
    的 \((\bX_{t}, \bY_{t})\) 是具有均值向量 \((F \bmu_{t-1}, H F \bmu_{t-1})\) 和协方差矩阵的多变量高斯分布。
- en: \[\begin{split} \begin{pmatrix} P_{t-1} & P_{t-1} H^T\\ H P_{t-1} & H P_{t-1}
    H^T + R \end{pmatrix}. \end{split}\]
  id: totrans-483
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} P_{t-1} & P_{t-1} H^T\\ H P_{t-1} & H P_{t-1}
    H^T + R \end{pmatrix}. \end{split}\]
- en: Finally, define \(K_{t} := P_{t-1} H^T (H P_{t-1} H^T + R)^{-1}\). This new
    observation and the conditional density formula give that
  id: totrans-484
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，定义 \(K_{t} := P_{t-1} H^T (H P_{t-1} H^T + R)^{-1}\)。这个新的观测值和条件密度公式给出
- en: \[ \bX_{t}|\{\bY_t, \bY_{1:t-1}\} = \bX_{t}|\bY_{1:t} \sim N_d(\bmu_{t}, \bSigma_{t})
    \]
  id: totrans-485
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bX_{t}|\{\bY_t, \bY_{1:t-1}\} = \bX_{t}|\bY_{1:t} \sim N_d(\bmu_{t}, \bSigma_{t})
    \]
- en: where we define
  id: totrans-486
  prefs: []
  type: TYPE_NORMAL
  zh: 其中我们定义
- en: \[\begin{align*} \bmu_{t} &:= F \bmu_{t-1} + K_{t} (\mathbf{Y}_{t} - H F \bmu_{t-1})
    \end{align*}\]
  id: totrans-487
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \bmu_{t} &:= F \bmu_{t-1} + K_{t} (\mathbf{Y}_{t} - H F \bmu_{t-1})
    \end{align*}\]
- en: and
  id: totrans-488
  prefs: []
  type: TYPE_NORMAL
  zh: 和
- en: \[\begin{align*} \bSigma_{t} &= (I_{d_0 \times d_0} - K_{t} H) P_{t-1}. \end{align*}\]
  id: totrans-489
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \bSigma_{t} &= (I_{d_0 \times d_0} - K_{t} H) P_{t-1}. \end{align*}\]
- en: '*Summary:* Let \(\bmu_t\) and \(\bSigma_t\) be the mean and covariance matrix
    of \(\bX_t\) conditioned on \(\bY_{1:t}\). The recursions for these quantities
    are the following:'
  id: totrans-490
  prefs: []
  type: TYPE_NORMAL
  zh: '*摘要:* 设 \(\bmu_t\) 和 \(\bSigma_t\) 为 \(\bX_t\) 在 \(\bY_{1:t}\) 条件下的均值和协方差矩阵。这些量的递归关系如下：'
- en: \[\begin{align*} \bmu_t &= F\,\bmu_{t-1} + K_{t} (\bY_{t} - H F \bmu_{t-1})\\
    \bSigma_t &= (I_{d_0 \times d_0} - K_t H) P_{t-1} \end{align*}\]
  id: totrans-491
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} \bmu_t &= F\,\bmu_{t-1} + K_{t} (\bY_{t} - H F \bmu_{t-1})\\
    \bSigma_t &= (I_{d_0 \times d_0} - K_t H) P_{t-1} \end{align*}\]
- en: where
  id: totrans-492
  prefs: []
  type: TYPE_NORMAL
  zh: 其中
- en: \[\begin{align*} P_{t-1} &= F \,\bSigma_{t-1} F^T + Q\\ K_t &= P_{t-1} H^T (H
    P_{t-1} H^T + R)^{-1} \end{align*}\]
  id: totrans-493
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{align*} P_{t-1} &= F \,\bSigma_{t-1} F^T + Q\\ K_t &= P_{t-1} H^T (H
    P_{t-1} H^T + R)^{-1} \end{align*}\]
- en: This last matrix is known as the Kalman gain matrix. The vector \(\bY_{t} -
    H F \bmu_{t-1}\) is referred to as innovation; it compares the new observation
    \(\bY_{t}\) to its predicted expectation \(H F \bmu_{t-1}\) based on the previous
    observations. Hence, in some sense, the Kalman gain matrix\(\idx{Kalman gain matrix}\xdi\)
    represents the “weight” given to the observation at time \(t\) when updating the
    state estimate \(\bmu_t\). The solution above is known as Kalman filtering.
  id: totrans-494
  prefs: []
  type: TYPE_NORMAL
  zh: 这个矩阵被称为卡尔曼增益矩阵。向量 \(\bY_{t} - H F \bmu_{t-1}\) 被称为创新；它将新的观测值 \(\bY_{t}\) 与基于先前观测值的预测期望
    \(H F \bmu_{t-1}\) 进行比较。因此，从某种意义上说，卡尔曼增益矩阵\(\idx{Kalman gain matrix}\xdi\) 代表了在更新状态估计
    \(\bmu_t\) 时对时间 \(t\) 的观测所赋予的“权重”。上述解被称为卡尔曼滤波。
- en: '**CHAT & LEARN** Explore the concept of sequential Monte Carlo methods, also
    known as particle filters, as an alternative to the Kalman filter. Ask your favorite
    AI chatbot for an explanation and implementation of a particle filter. Try it
    on this dataset. ([Open In Colab](https://colab.research.google.com/github/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/just_the_code/roch_mmids_chap_prob_notebook.ipynb))
    \(\ddagger\)'
  id: totrans-495
  prefs: []
  type: TYPE_NORMAL
  zh: '**CHAT & LEARN** 探索序列蒙特卡洛方法的概念，也称为粒子滤波器，作为卡尔曼滤波的替代方案。向您喜欢的AI聊天机器人询问粒子滤波的解释和实现。尝试在以下数据集上使用它。([在Colab中打开](https://colab.research.google.com/github/MMiDS-textbook/MMiDS-textbook.github.io/blob/main/just_the_code/roch_mmids_chap_prob_notebook.ipynb))
    \(\ddagger\)'
- en: 6.5.3\. Back to location tracking[#](#back-to-location-tracking "Link to this
    heading")
  id: totrans-496
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 6.5.3\. 返回位置跟踪[#](#back-to-location-tracking "链接到本标题")
- en: We apply Kalman filtering to location tracking. Returning to our cyborg corgi
    example, we imagine that we get noisy observations about its successive positions
    in a park. (Think of GPS measurements.) We seek to get a better estimate of its
    location using the method above.
  id: totrans-497
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将卡尔曼滤波应用于位置跟踪。回到我们的机器狗示例，我们想象我们得到了关于它在公园中连续位置的有噪声观测值。（想想GPS测量。）我们试图使用上述方法获得其位置的更好估计。
- en: '**Figure:** Cyborg corgi (*Credit:* Made with [Midjourney](https://www.midjourney.com/))'
  id: totrans-498
  prefs: []
  type: TYPE_NORMAL
  zh: '**图:** 机器狗（*来源:* 使用 [Midjourney](https://www.midjourney.com/) 制作）'
- en: '![Cyborg corgi](../Images/348998a4b7d1b53beeec4c9913f351c0.png)'
  id: totrans-499
  prefs: []
  type: TYPE_IMG
  zh: '![机器狗](../Images/348998a4b7d1b53beeec4c9913f351c0.png)'
- en: \(\bowtie\)
  id: totrans-500
  prefs: []
  type: TYPE_NORMAL
  zh: \(\bowtie\)
- en: We model the true location as a linear-Gaussian system over the 2d position
    \((z_{1,t}, z_{2,t})_t\) and velocity \((\dot{z}_{1,t}, \dot{z}_{2,t})_t\) sampled
    at \(\Delta\) intervals of time. Formally,
  id: totrans-501
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将真实位置建模为在2维位置 \((z_{1,t}, z_{2,t})_t\) 和速度 \((\dot{z}_{1,t}, \dot{z}_{2,t})_t\)
    上采样的线性高斯系统，时间间隔为 \(\Delta\)。形式上，
- en: \[\begin{split} \bX_t = (z_{1,t}, z_{2,t}, \dot{z}_{1,t}, \dot{z}_{2,t}), \quad
    F = \begin{pmatrix} 1 & 0 & \Delta & 0\\ 0 & 1 & 0 & \Delta\\ 0 & 0 & 1 & 0\\
    0 & 0 & 0 & 1 \end{pmatrix}, \end{split}\]
  id: totrans-502
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bX_t = (z_{1,t}, z_{2,t}, \dot{z}_{1,t}, \dot{z}_{2,t}), \quad
    F = \begin{pmatrix} 1 & 0 & \Delta & 0\\ 0 & 1 & 0 & \Delta\\ 0 & 0 & 1 & 0\\
    0 & 0 & 0 & 1 \end{pmatrix}, \end{split}\]
- en: so the unobserved dynamics are
  id: totrans-503
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，未观测的动力学是
- en: \[\begin{split} \begin{pmatrix} z_{1,t+1}\\ z_{2,t+1}\\ \dot{z}_{1,t+1}\\ \dot{z}_{2,t+1}
    \end{pmatrix} = \bX_{t+1} = F \,\bX_t + \bW_t = \begin{pmatrix} z_{1,t} + \Delta
    \dot{z}_{1,t} + W_{1,t}\\ z_{2,t} + \Delta \dot{z}_{2,t} + W_{2,t}\\ \dot{z}_{1,t}
    + \dot{W}_{1,t}\\ \dot{z}_{2,t} + \dot{W}_{2,t} \end{pmatrix} \end{split}\]
  id: totrans-504
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} z_{1,t+1}\\ z_{2,t+1}\\ \dot{z}_{1,t+1}\\ \dot{z}_{2,t+1}
    \end{pmatrix} = \bX_{t+1} = F \,\bX_t + \bW_t = \begin{pmatrix} z_{1,t} + \Delta
    \dot{z}_{1,t} + W_{1,t}\\ z_{2,t} + \Delta \dot{z}_{2,t} + W_{2,t}\\ \dot{z}_{1,t}
    + \dot{W}_{1,t}\\ \dot{z}_{2,t} + \dot{W}_{2,t} \end{pmatrix} \end{split}\]
- en: where the \(\bW_t = (W_{1,t}, W_{2,t}, \dot{W}_{1,t}, \dot{W}_{2,t}) \sim N_{d_0}(\mathbf{0},
    Q)\) with \(Q\) known.
  id: totrans-505
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(\bW_t = (W_{1,t}, W_{2,t}, \dot{W}_{1,t}, \dot{W}_{2,t}) \sim N_{d_0}(\mathbf{0},
    Q)\) 且 \(Q\) 已知。
- en: In words, the velocity is unchanged, up to Gaussian perturbation. The position
    changes proportionally to the velocity in the corresponding dimension, again up
    to Gaussian perturbation.
  id: totrans-506
  prefs: []
  type: TYPE_NORMAL
  zh: 用话来说，速度保持不变，直到高斯扰动。位置按比例变化，与对应维度的速度成正比，再次直到高斯扰动。
- en: The observations \((\tilde{z}_{1,t}, \tilde{z}_{2,t})_t\) are modeled as
  id: totrans-507
  prefs: []
  type: TYPE_NORMAL
  zh: 观测值 \((\tilde{z}_{1,t}, \tilde{z}_{2,t})_t\) 被建模为
- en: \[\begin{split} \bY_t = (\tilde{z}_{1,t}, \tilde{z}_{2,t}), \quad H = \begin{pmatrix}
    1 & 0 & 0 & 0\\ 0 & 1 & 0 & 0\\ \end{pmatrix}. \end{split}\]
  id: totrans-508
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bY_t = (\tilde{z}_{1,t}, \tilde{z}_{2,t}), \quad H = \begin{pmatrix}
    1 & 0 & 0 & 0\\ 0 & 1 & 0 & 0\\ \end{pmatrix}. \end{split}\]
- en: so the observed process satisfies
  id: totrans-509
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，观察到的过程满足
- en: \[\begin{split} \begin{pmatrix} \tilde{z}_{1,t}\\ \tilde{z}_{2,t} \end{pmatrix}
    = \bY_t = H\,\bX_t + \bV_t = \begin{pmatrix} z_{1,t} + V_{1,t}\\ z_{2,t} + V_{2,t}
    \end{pmatrix} \end{split}\]
  id: totrans-510
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \begin{pmatrix} \tilde{z}_{1,t}\\ \tilde{z}_{2,t} \end{pmatrix}
    = \bY_t = H\,\bX_t + \bV_t = \begin{pmatrix} z_{1,t} + V_{1,t}\\ z_{2,t} + V_{2,t}
    \end{pmatrix} \end{split}\]
- en: where the \(\bV_t = (V_{1,t}, V_{2,t}) \sim N_d(\mathbf{0}, R)\) with \(R\)
    known.
  id: totrans-511
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(\bV_t = (V_{1,t}, V_{2,t}) \sim N_d(\mathbf{0}, R)\) 且 \(R\) 已知。
- en: In words, we only observe the positions, up to Gaussian noise.
  id: totrans-512
  prefs: []
  type: TYPE_NORMAL
  zh: 用话来说，我们只观察到位置，直到高斯噪声。
- en: '**Implementing the Kalman filter** We implement the Kalman filter as described
    above with known covariance matrices. We take \(\Delta = 1\) for simplicity. The
    code is adapted from [[Mur0](https://github.com/probml/pmtk3/blob/master/demos/kalmanTrackingDemo.m)].'
  id: totrans-513
  prefs: []
  type: TYPE_NORMAL
  zh: '**实现卡尔曼滤波** 我们使用已知的协方差矩阵实现了上述描述的卡尔曼滤波。为了简单起见，我们取 \(\Delta = 1\)。代码改编自 [[Mur0](https://github.com/probml/pmtk3/blob/master/demos/kalmanTrackingDemo.m)]。'
- en: We will test Kalman filtering on a simulated path drawn from the linear-Gaussian
    model above. The following function creates such a path and its noisy observations.
  id: totrans-514
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在从上述线性高斯模型中抽取的模拟路径上测试卡尔曼滤波。以下函数创建这样的路径及其有噪声的观测值。
- en: '[PRE10]'
  id: totrans-515
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '**NUMERICAL CORNER:** Here is an example.'
  id: totrans-516
  prefs: []
  type: TYPE_NORMAL
  zh: '**数值角落:** 这里有一个例子。'
- en: '[PRE11]'
  id: totrans-517
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: In the next plot (and throughout this section), the dots are the noisy observations.
    The unobserved true path is also shown as a dotted line.
  id: totrans-518
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一个图中（以及本节中），点代表有噪声的观测值。未观测到的真实路径也以虚线表示。
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  id: totrans-519
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格源
    隐藏代码单元格源</summary>
- en: '[PRE12]</details> ![../../_images/7887a8a25f3bbd2d4c1cc1b809a24f2aa031c84a10f4cd5ed5f0ae71eff0253c.png](../Images/c8b3c6c67639d980e6620091452f12a9.png)'
  id: totrans-520
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE12]</details> ![../../_images/7887a8a25f3bbd2d4c1cc1b809a24f2aa031c84a10f4cd5ed5f0ae71eff0253c.png](../Images/c8b3c6c67639d980e6620091452f12a9.png)'
- en: \(\unlhd\)
  id: totrans-521
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: The following function implements the Kalman filter. The full recursion is broken
    up into several steps. We use [`numpy.linalg.inv`](https://numpy.org/doc/stable/reference/generated/numpy.linalg.inv.html)
    to compute the Kalman gain matrix. Below, `mu_pred` is \(F \bmu_{t-1}\) and `Sig_pred`
    is \(P_{t-1} = F \bSigma_{t-1} F^T + Q\), which are the mean vector and covariance
    matrix of \(\bX_{t}\) given \(\bY_{1:t-1}\) as computed in the *Predict* step.
  id: totrans-522
  prefs: []
  type: TYPE_NORMAL
  zh: 以下函数实现了卡尔曼滤波。完整的递归被分解成几个步骤。我们使用 `numpy.linalg.inv` 来计算卡尔曼增益矩阵。下面，`mu_pred` 是
    \(F \bmu_{t-1}\)，而 `Sig_pred` 是 \(P_{t-1} = F \bSigma_{t-1} F^T + Q\)，这是在 *预测*
    步骤中根据 \(\bY_{1:t-1}\) 计算的 \(\bX_{t}\) 的均值向量和协方差矩阵。
- en: '[PRE13]'
  id: totrans-523
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '[PRE14]'
  id: totrans-524
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '**NUMERICAL CORNER:** We apply this to the location tracking example. The inferred
    states, or more precisely their estimated mean, are in blue. Note that we also
    inferred the velocity at each time point, but we are not plotting that information.'
  id: totrans-525
  prefs: []
  type: TYPE_NORMAL
  zh: '**数值角落:** 我们将此应用于位置跟踪示例。推断出的状态，或者更确切地说，它们的估计均值，以蓝色表示。请注意，我们还推断出每个时间点的速度，但我们没有绘制该信息。'
- en: <details class="hide above-input"><summary aria-label="Toggle hidden content">Show
    code cell source Hide code cell source</summary>
  id: totrans-526
  prefs: []
  type: TYPE_NORMAL
  zh: <details class="hide above-input"><summary aria-label="Toggle hidden content">显示代码单元格源
    隐藏代码单元格源</summary>
- en: '[PRE15]</details> ![../../_images/046beb4acdf4c61da2a5de4c6dbb7d32ca2d7b4e8416651030b3f49747fcac9a.png](../Images/959069dbefd76cfab2d54229507451d1.png)'
  id: totrans-527
  prefs: []
  type: TYPE_NORMAL
  zh: '[PRE15]</details> ![../../_images/046beb4acdf4c61da2a5de4c6dbb7d32ca2d7b4e8416651030b3f49747fcac9a.png](../Images/959069dbefd76cfab2d54229507451d1.png)'
- en: To quantify the improvement in the inferred means compared to the observations,
    we compute the mean squared error in both cases.
  id: totrans-528
  prefs: []
  type: TYPE_NORMAL
  zh: 为了量化与观测值相比推断出的均值改进，我们计算两种情况下的均方误差。
- en: '[PRE16]'
  id: totrans-529
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '[PRE17]'
  id: totrans-530
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '[PRE18]'
  id: totrans-531
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '[PRE19]'
  id: totrans-532
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: We indeed observe a substantial reduction.
  id: totrans-533
  prefs: []
  type: TYPE_NORMAL
  zh: 我们确实观察到显著的减少。
- en: \(\unlhd\)
  id: totrans-534
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: '**CHAT & LEARN** The Kalman filter assumes that the parameters of the state
    evolution and observation models are known. Ask your favorite AI chatbot about
    methods for estimating these parameters from data, such as the expectation-maximization
    algorithm or the variational Bayes approach. \(\ddagger\)'
  id: totrans-535
  prefs: []
  type: TYPE_NORMAL
  zh: '**聊天与学习** 卡尔曼滤波假设状态演变和观测模型参数是已知的。向您喜欢的AI聊天机器人询问从数据中估计这些参数的方法，例如期望最大化算法或变分贝叶斯方法。
    \(\ddagger\)'
- en: '***Self-assessment quiz*** *(with help from Claude, Gemini, and ChatGPT)*'
  id: totrans-536
  prefs: []
  type: TYPE_NORMAL
  zh: '***自我评估测验*** *(由 Claude、Gemini 和 ChatGPT 协助)*'
- en: '**1** Which of the following is the Schur complement of the block \(B_{11}\)
    in the positive definite matrix \(B = \begin{pmatrix} B_{11} & B_{12} \\ B_{12}^T
    & B_{22} \end{pmatrix}\)?'
  id: totrans-537
  prefs: []
  type: TYPE_NORMAL
  zh: '**1** 以下哪个是正定矩阵 \(B = \begin{pmatrix} B_{11} & B_{12} \\ B_{12}^T & B_{22}
    \end{pmatrix}\) 中 \(B_{11}\) 块的舒尔补？'
- en: a) \(B_{22} - B_{12}^T B_{11}^{-1} B_{12}\)
  id: totrans-538
  prefs: []
  type: TYPE_NORMAL
  zh: a) \(B_{22} - B_{12}^T B_{11}^{-1} B_{12}\)
- en: b) \(B_{11} - B_{12} B_{22}^{-1} B_{12}^T\)
  id: totrans-539
  prefs: []
  type: TYPE_NORMAL
  zh: b) \(B_{11} - B_{12} B_{22}^{-1} B_{12}^T\)
- en: c) \(B_{22}\)
  id: totrans-540
  prefs: []
  type: TYPE_NORMAL
  zh: c) \(B_{22}\)
- en: d) \(B_{11}\)
  id: totrans-541
  prefs: []
  type: TYPE_NORMAL
  zh: d) \(B_{11}\)
- en: '**2** Which of the following is true about the Schur complement \(B/B_{11}\)
    of the block \(B_{11}\) in a positive definite matrix \(B\)?'
  id: totrans-542
  prefs: []
  type: TYPE_NORMAL
  zh: '**2** 关于正定矩阵 \(B\) 中 \(B_{11}\) 块的舒尔补 \(B/B_{11}\) 以下哪个是正确的？'
- en: a) It is always symmetric.
  id: totrans-543
  prefs: []
  type: TYPE_NORMAL
  zh: a) 它总是对称的。
- en: b) It is always positive definite.
  id: totrans-544
  prefs: []
  type: TYPE_NORMAL
  zh: b) 它总是正定的。
- en: c) Both a and b.
  id: totrans-545
  prefs: []
  type: TYPE_NORMAL
  zh: c) a 和 b 都正确。
- en: d) Neither a nor b.
  id: totrans-546
  prefs: []
  type: TYPE_NORMAL
  zh: d) 既不是 a 也不是 b。
- en: '**3** What is the conditional distribution of \(\mathbf{X}_1\) given \(\mathbf{X}_2\)
    in a multivariate Gaussian distribution?'
  id: totrans-547
  prefs: []
  type: TYPE_NORMAL
  zh: '**3** 在多元高斯分布中，\(\mathbf{X}_1\) 在给定 \(\mathbf{X}_2\) 的条件分布是什么？'
- en: a) \(\mathbf{X}_1 | \mathbf{X}_2 \sim N_{d_1}(\boldsymbol{\mu}_1 + \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2
    - \boldsymbol{\mu}_2), \bSigma_{11} - \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\)
  id: totrans-548
  prefs: []
  type: TYPE_NORMAL
  zh: a) \(\mathbf{X}_1 | \mathbf{X}_2 \sim N_{d_1}(\boldsymbol{\mu}_1 + \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2
    - \boldsymbol{\mu}_2), \bSigma_{11} - \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\)
- en: b) \(\mathbf{X}_1 | \mathbf{X}_2 \sim N_{d_1}(\boldsymbol{\mu}_1 - \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2
    - \boldsymbol{\mu}_2), \bSigma_{11} + \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\)
  id: totrans-549
  prefs: []
  type: TYPE_NORMAL
  zh: b) \(\mathbf{X}_1 | \mathbf{X}_2 \sim N_{d_1}(\boldsymbol{\mu}_1 - \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2
    - \boldsymbol{\mu}_2), \bSigma_{11} + \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\)
- en: c) \(\mathbf{X}_1 | \mathbf{X}_2 \sim N_{d_1}(\boldsymbol{\mu}_1 + \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2
    - \boldsymbol{\mu}_2), \bSigma_{11} + \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\)
  id: totrans-550
  prefs: []
  type: TYPE_NORMAL
  zh: c) \(\mathbf{X}_1 | \mathbf{X}_2 \sim N_{d_1}(\boldsymbol{\mu}_1 + \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2
    - \boldsymbol{\mu}_2), \bSigma_{11} + \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\)
- en: d) \(\mathbf{X}_1 | \mathbf{X}_2 \sim N_{d_1}(\boldsymbol{\mu}_1 - \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2
    - \boldsymbol{\mu}_2), \bSigma_{11} - \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\)
  id: totrans-551
  prefs: []
  type: TYPE_NORMAL
  zh: d) \(\mathbf{X}_1 | \mathbf{X}_2 \sim N_{d_1}(\boldsymbol{\mu}_1 - \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2
    - \boldsymbol{\mu}_2), \bSigma_{11} - \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\)
- en: '**4** In a linear-Gaussian system, which of the following is true about the
    conditional independence relationships?'
  id: totrans-552
  prefs: []
  type: TYPE_NORMAL
  zh: '**4** 在线性高斯系统中，关于条件独立性关系以下哪个是正确的？'
- en: a) \(\mathbf{X}_t\) is conditionally independent of \(\mathbf{Y}_{1:t-1}\) given
    \(\mathbf{X}_{t-1}\).
  id: totrans-553
  prefs: []
  type: TYPE_NORMAL
  zh: a) \(\mathbf{X}_t\) 在给定 \(\mathbf{X}_{t-1}\) 的条件下与 \(\mathbf{Y}_{1:t-1}\) 条件独立。
- en: b) \(\mathbf{Y}_t\) is conditionally independent of \(\mathbf{Y}_{1:t-1}\) given
    \(\mathbf{X}_t\).
  id: totrans-554
  prefs: []
  type: TYPE_NORMAL
  zh: b) \(\mathbf{Y}_t\) 在给定 \(\mathbf{X}_t\) 的条件下与 \(\mathbf{Y}_{1:t-1}\) 条件独立。
- en: c) \(\mathbf{X}_t\) is conditionally independent of \(\mathbf{X}_{t-2}\) given
    \(\mathbf{X}_{t-1}\).
  id: totrans-555
  prefs: []
  type: TYPE_NORMAL
  zh: c) \(\mathbf{X}_t\) 在给定 \(\mathbf{X}_{t-1}\) 的条件下与 \(\mathbf{X}_{t-2}\) 条件独立。
- en: d) All of the above.
  id: totrans-556
  prefs: []
  type: TYPE_NORMAL
  zh: d) 以上所有选项。
- en: '**5** In the Kalman filter, what does the Kalman gain matrix \(K_t\) represent?'
  id: totrans-557
  prefs: []
  type: TYPE_NORMAL
  zh: '**5** 在卡尔曼滤波中，卡尔曼增益矩阵 \(K_t\) 代表什么？'
- en: a) The covariance matrix of the state estimate at time \(t\).
  id: totrans-558
  prefs: []
  type: TYPE_NORMAL
  zh: a) 时间 \(t\) 时状态估计的协方差矩阵。
- en: b) The covariance matrix of the observation at time \(t\).
  id: totrans-559
  prefs: []
  type: TYPE_NORMAL
  zh: b) 时间 \(t\) 时观测的协方差矩阵。
- en: c) The weight given to the observation at time \(t\) when updating the state
    estimate.
  id: totrans-560
  prefs: []
  type: TYPE_NORMAL
  zh: c) 在更新状态估计时，给予时间 \(t\) 时观测的权重。
- en: d) The weight given to the previous state estimate when predicting the current
    state.
  id: totrans-561
  prefs: []
  type: TYPE_NORMAL
  zh: d) 预测当前状态时给予先前状态估计的权重。
- en: 'Answer for 1: a. Justification: The text defines the Schur complement of \(B_{11}\)
    as \(B / B_{11} := B_{22} - B_{12}^T B_{11}^{-1} B_{12}\).'
  id: totrans-562
  prefs: []
  type: TYPE_NORMAL
  zh: 1 的答案：a. 理由：文本将 \(B_{11}\) 的舒尔补定义为 \(B / B_{11} := B_{22} - B_{12}^T B_{11}^{-1}
    B_{12}\)。
- en: 'Answer for 2: c. Justification: The text states “the Schur complement of the
    block \(B_{11}\), i.e., the matrix \(B/B_{11} := B_{22} - B_{12}^T B_{11}^{-1}
    B_{12}\), is symmetric and positive definite.”'
  id: totrans-563
  prefs: []
  type: TYPE_NORMAL
  zh: 2 的答案：c. 理由：文本中提到“\(B_{11}\) 块的舒尔补，即矩阵 \(B/B_{11} := B_{22} - B_{12}^T B_{11}^{-1}
    B_{12}\)，是对称且正定的。”
- en: 'Answer for 3: a. Justification: The conditional distribution of \(\mathbf{X}_1\)
    given \(\mathbf{X}_2\) is derived in the text as \(\mathbf{X}_1 | \mathbf{X}_2
    \sim N_{d_1}(\boldsymbol{\mu}_1 + \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2 -
    \boldsymbol{\mu}_2), \bSigma_{11} - \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\).'
  id: totrans-564
  prefs: []
  type: TYPE_NORMAL
  zh: 3 的答案：a. 理由：文本中推导出 \(\mathbf{X}_1\) 在给定 \(\mathbf{X}_2\) 的条件分布为 \(\mathbf{X}_1
    | \mathbf{X}_2 \sim N_{d_1}(\boldsymbol{\mu}_1 + \bSigma_{12}\bSigma_{22}^{-1}(\mathbf{X}_2
    - \boldsymbol{\mu}_2), \bSigma_{11} - \bSigma_{12}\bSigma_{22}^{-1}\bSigma_{12}^T)\)。
- en: 'Answer for 4: d. Justification: The text explicitly states these conditional
    independence relationships.'
  id: totrans-565
  prefs: []
  type: TYPE_NORMAL
  zh: 答案4：d. 证明：文本明确指出这些条件独立性关系。
- en: 'Answer for 5: c. Justification: The text defines \(K_t := P_{t-1} H^T (H P_{t-1}
    H^T + R)^{-1}\) as the Kalman gain matrix, which is used to update the state estimate
    as \(\boldsymbol{\mu}_t := F \boldsymbol{\mu}_{t-1} + K_t (\mathbf{Y}_t - H F
    \boldsymbol{\mu}_{t-1})\), where \(K_t\) weighs the innovation \((\mathbf{Y}_t
    - H F \boldsymbol{\mu}_{t-1})\).'
  id: totrans-566
  prefs: []
  type: TYPE_NORMAL
  zh: 答案5：c. 证明：文本将 \(K_t := P_{t-1} H^T (H P_{t-1} H^T + R)^{-1}\) 定义为卡尔曼增益矩阵，该矩阵用于更新状态估计
    \(\boldsymbol{\mu}_t := F \boldsymbol{\mu}_{t-1} + K_t (\mathbf{Y}_t - H F \boldsymbol{\mu}_{t-1})\)，其中
    \(K_t\) 权衡了创新 \((\mathbf{Y}_t - H F \boldsymbol{\mu}_{t-1})\)。
