- en: Solid-Obstacle Contact
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec20.2-obstacle_contact.html](https://phys-sim-book.github.io/lec20.2-obstacle_contact.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: 'Recall that we used a conservative force model to approximate the contact traction
    TC​, allowing it to be directly evaluated given the current configuration of the
    solids. This results in a contact potential:'
  prefs: []
  type: TYPE_NORMAL
- en: PC​=∫ΓC​​21​b(X2​∈ΓC​−N(X)min​∥x(X,t)−x(X2​,t)∥,d^)ds(X),
  prefs: []
  type: TYPE_NORMAL
- en: where b() is the barrier energy density function, and N(X) is an infinitesimal
    region around X where contact is ignored for theoretical soundness.
  prefs: []
  type: TYPE_NORMAL
- en: For normal contact between simulated solids and collision obstacles (ignoring
    self-contact for now), PC​ can be written in a much simpler form PC​​=∫ΓS​​21​b(X2​∈ΓO​min​∥x(X,t)−x(X2​,t)∥,d^)ds(X)+∫ΓO​​21​b(X2​∈ΓS​min​∥x(X,t)−x(X2​,t)∥,d^)ds(X)=∫ΓS​​b(X2​∈ΓO​min​∥x(X,t)−x(X2​,t)∥,d^)ds(X)=∫ΓS​​b(dPO(x(X,t),O),d^)ds(X).​
    Here ΓS​ and ΓO​ are the boundaries of the simulated solids and obstacles respectively,
    dPO(x(X,t),O)=minX2​∈ΓO​​∥x(X,t)−x(X2​,t)∥ is the point-obstacle distance, and
    the simplification from two terms to one single term is due to symmetry in the
    continuous setting. With triangle discretization, ∫ΓS​​b(dPO(x(X,t),O),d^)ds(X)≈e∈T∑​∫∂Ωe0​∩ΓS​​b(dPO(x(X,t),O),d^)ds(X).(20.2.1)
    Similar to the derivation for Neumann boundaries, for any boundary node a^, with
    2 incident triangles, let us look at one of the integral. Without loss of generality,
    we can assume Na^​=β (Xa^​ corresponds to X2​ in triangle e), and that X3​ is
    the other node of e on the boundary edge. Then, switching the integration variables
    to β gives us =​∫∂Ωe0​∩ΓS​​b(dPO(x(X,t),O),d^)ds(X)∫01​b(dPO(x(βX2​+(1−β)X3​,t),O),d^)​∂β∂s​​dβ.​(20.2.2)
    Since b() and dPO() are both highly nonlinear functions, we could not obtain a
    closed-form expression for Equation [(20.2.2)](#eq:lec20:point_obstacle_1). If
    we take the two end points X2​ and X3​ as quadrature points both with weights
    21​, we can approximate the integral as ≈​∫01​b(dPO(x(βX2​+(1−β)X3​,t),O),d^)​∂β∂s​​dβ21​b(dPO(x(X2​,t),O),d^)​∂β∂s​​+21​b(dPO(x(X3​,t),O),d^)​∂β∂s​​.​(20.2.3)
    Then, the whole boundary integral can be approximated as ∫ΓS​​b(dPO(x(X,t),O),d^)ds(X)≈a^∑​2∥Xa^​−Xa^−1​∥+∥Xa^​−Xa^+1​∥​b(dPO(xa^​,O),d^),
    assuming that Xa^−1​ and Xa^+1​ are the two neighbors of Xa^​ on the boundary.
    This is now exactly what has been implemented in [Filter Line Search](./lec8-filter_line_search.html).
  prefs: []
  type: TYPE_NORMAL
- en: '***Remark 20.2.1 (Quadrature Choice for Line Segment).*** Selecting the two
    end points (β=0,1) as quadrature points for a line segment integral (Equation
    [(20.2.3)](#eq:lec20:ipc_end_point_quadrature)) is not a common design choice.
    Typically, Gaussian quadrature would use β=63±3​​. The advantage of choosing β=0,1
    is that it results in fewer quadrature points globally, thus reducing computational
    costs, as neighboring edges share end points.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'To see how PC​ connects to the boundary integral (Equation [(20.1)](lec20-pw_linear_boundary.html#eq:lec20:bi_disc_weak))
    in the discrete weak form, let us take the derivative of the discretized contact
    potential (Equation [(20.2.1)](#eq:lec20:discrete_contact_potential)) with respect
    to xa^​: ==​−∂xa^​∂(∑e∈T​∫∂Ωe0​∩ΓS​​b(dPO(x(X,t),O),d^)ds(X))​e∈T∑​∫∂Ωe0​∩ΓS​​−∂x∂b(dPO(x(X,t),O),d^)​∂xa^​∂x​ds(X)e∈T∑​∫∂Ωe0​∩ΓS​​−∂x∂b(dPO(x(X,t),O),d^)​Na^​(X)ds(X).​
    Then we also verified that TC​(X,t)=−∂x∂b(dPO(x(X,t),O),d^)​ here.'
  prefs: []
  type: TYPE_NORMAL
