- en: 15  Causality from observational data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://tellingstorieswithdata.com/14-causality_from_obs.html](https://tellingstorieswithdata.com/14-causality_from_obs.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[Applications](./14-causality_from_obs.html)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[15  Causality from observational data](./14-causality_from_obs.html)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Prerequisites**'
  prefs: []
  type: TYPE_NORMAL
- en: Read *Causal design patterns for data analysts*, ([Riederer 2021](99-references.html#ref-riedererdesignpatterns))
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This blog post provides an overview of different approaches for making causal
    claims from observational data.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Read *BNT162b2 mRNA Covid-19 Vaccine in a Nationwide Mass Vaccination Setting*,
    ([Dagan et al. 2021](99-references.html#ref-dagan2021bnt162b2))
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This paper compares causal conclusions drawn from observational data with those
    of a randomized trial.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Read *The Effect: An Introduction to Research Design and Causality*, ([Huntington-Klein
    2021](99-references.html#ref-theeffect))'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Focus on Chapters 18 “Difference-in-Differences”, 19 “Instrumental Variables”,
    and 20 “Regression Discontinuity”, which provide an overview of three key approaches
    for making causal claims from observational data.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Read *Understanding regression discontinuity designs as observational studies*,
    ([Sekhon and Titiunik 2017](99-references.html#ref-sekhon2017understanding))
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Discusses some concerns with the use of regression discontinuity.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Key concepts and skills**'
  prefs: []
  type: TYPE_NORMAL
- en: Running an experiment is not always possible, but we can use various approaches
    to nonetheless be able to speak to causality to some extent.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We need to be careful of common paradoxes including Simpson’s paradox and Berkson’s
    paradox, and be aware of both the potential and pitfalls of matching.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We can use difference-in-differences when we have data on both treated and untreated
    units at both time periods. Regression discontinuity is useful when a group is
    either treated or not, but the two groups are very similar apart from the treatment.
    And instrumental variables is an approach used to estimate causality indirectly
    through another variable.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In general, these approaches need to be used with humility and concern for weaknesses
    and assumptions, both those that we can test and those that we cannot.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Software and packages**'
  prefs: []
  type: TYPE_NORMAL
- en: Base R ([R Core Team 2024](99-references.html#ref-citeR))
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`broom` ([Robinson, Hayes, and Couch 2022](99-references.html#ref-broom))'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`broom.mixed` ([Bolker and Robinson 2022](99-references.html#ref-mixedbroom))'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`estimatr` ([Blair et al. 2021](99-references.html#ref-estimatr))'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`haven` ([Wickham, Miller, and Smith 2023](99-references.html#ref-citehaven))'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`MatchIt` ([Ho et al. 2011](99-references.html#ref-MatchIt))'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`modelsummary` ([Arel-Bundock 2022](99-references.html#ref-citemodelsummary))'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`palmerpenguins` ([Horst, Presmanes Hill, and Gorman 2020](99-references.html#ref-palmerpenguins))'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`rdrobust` ([Calonico et al. 2021](99-references.html#ref-rdrobust))'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`rstanarm` ([Goodrich et al. 2023](99-references.html#ref-citerstanarm))'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`scales` ([Wickham and Seidel 2022](99-references.html#ref-scales))'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`tidyverse` ([Wickham et al. 2019](99-references.html#ref-tidyverse))'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`tinytable` ([Arel-Bundock 2024](99-references.html#ref-tinytable))'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '*## 15.1 Introduction'
  prefs: []
  type: TYPE_NORMAL
- en: Life is grand when we can conduct experiments to be able to speak to causality.
    But there are circumstances in which we cannot run an experiment, yet nonetheless
    want to be able to make causal claims. And data from outside experiments have
    value that experiments do not have. In this chapter we discuss the circumstances
    and methods that allow us to speak to causality using observational data. We use
    relatively simple methods, in sophisticated ways, drawing from statistics, but
    also a variety of social sciences, including economics and political science,
    as well as epidemiology.
  prefs: []
  type: TYPE_NORMAL
- en: For instance, Dagan et al. ([2021](99-references.html#ref-dagan2021bnt162b2))
    use observational data to confirm the effectiveness of the Pfizer-BioNTech vaccine.
    They discuss how one concern with using observational data in this way is confounding,
    which is where we are concerned that there is some variable that affects both
    the predictor and outcome variables and can lead to spurious relationships. Dagan
    et al. ([2021](99-references.html#ref-dagan2021bnt162b2)) adjust for this by first
    making a list of potential confounders, such as age, sex, geographic location,
    and healthcare usage and then adjusting for each of them, by matching one-to-one
    between people that were vaccinated and those that were not. The experimental
    data guided the use of observational data, and the larger size of the latter enabled
    a focus on specific age-groups and extent of disease.
  prefs: []
  type: TYPE_NORMAL
- en: 'This chapter is about using observational data in sophisticated ways. How we
    can nonetheless be comfortable making causal statements, even when we cannot run
    A/B tests or RCTs. Indeed, in what circumstances may we prefer to not run those
    or to run observational-based approaches in addition to them. We cover three of
    the major methods: difference-in-differences, regression discontinuity, and instrumental
    variables.'
  prefs: []
  type: TYPE_NORMAL
- en: 15.2 Two common paradoxes
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'There are two situations where data can trick us that are so common that we
    will explicitly go through them. These are:'
  prefs: []
  type: TYPE_NORMAL
- en: Simpson’s paradox, and
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Berkson’s paradox.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 15.2.1 Simpson’s paradox
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Simpson’s paradox occurs when we estimate some relationship for subsets of our
    data, but a different relationship when we consider the entire dataset ([Simpson
    1951](99-references.html#ref-simpson1951interpretation)). It is a particular case
    of the ecological fallacy, which is when we try to make claims about individuals,
    based on their group. For instance, it may be that there is a positive relationship
    between undergraduate grades and performance in graduate school in two departments
    when considering each department individually. But if undergraduate grades tended
    to be higher in one department than another while graduate school performance
    tended to be opposite, we may find a negative relationship between undergraduate
    grades and performance in graduate school. We can simulate some data to show this
    more clearly ([Figure 15.1](#fig-simpsonsparadox)).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '*[PRE2]*  *[PRE3]'
  prefs: []
  type: TYPE_NORMAL
- en: '*![](../Images/d54a1978d5b766d99381a0fcd385d3a4.png)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 15.1: Illustration of simulated data that shows Simpson’s paradox*  *Simpson’s
    paradox is often illustrated using real-world data from University of California,
    Berkeley, on graduate admissions ([Bickel, Hammel, and O’Connell 1975](99-references.html#ref-bickel1975sex)).
    This paper was mentioned in [Chapter 4](04-writing_research.html) as having one
    of the greatest sub-titles ever published. Hernán, Clayton, and Keiding ([2011](99-references.html#ref-Hernn2011))
    create DAGs that further illuminate the relationship and the cause of the paradox.'
  prefs: []
  type: TYPE_NORMAL
- en: More recently, as mentioned in its documentation, the “penguins” dataset from
    `palmerpenguins` provides an example of Simpson’s paradox, using real-world data
    on the relationship between body mass and bill depth in different species of penguins
    ([Figure 15.2](#fig-simpsonsparadoxinpenguins)). The overall negative trend occurs
    because Gentoo penguins tend to be heavier but with shorter bills compared to
    Adelie and Chinstrap penguins.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '*![](../Images/6f4f2f58ba1b5bf62ed1877339955eb4.png)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 15.2: Illustration of Simpson’s paradox in a dataset of penguin bill
    depth compared with their body mass***  ***### 15.2.2 Berkson’s paradox'
  prefs: []
  type: TYPE_NORMAL
- en: Berkson’s paradox occurs when we estimate some relationship based on the dataset
    that we have, but because the dataset is so selected, the relationship is different
    in a more general dataset ([Berkson 1946](99-references.html#ref-citeberkson)).
    For instance, if we have a dataset of professional cyclists then we might find
    there is no relationship between their VO2 max and their chance of winning a bike
    race ([Coyle et al. 1988](99-references.html#ref-vomaxpaper); [Podlogar, Leo,
    and Spragg 2022](99-references.html#ref-anothernicevomaxpaper)). But if we had
    a dataset of the general population then we might find a relationship between
    these two variables. The professional dataset has just been so selected that the
    relationship disappears; one cannot become a professional cyclist unless one has
    a good enough VO2 max, but among professional cyclists everyone has a good enough
    VO2 max. Again, we can simulate some data to show this more clearly ([Figure 15.3](#fig-berksonsparadox)).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '*[PRE6]'
  prefs: []
  type: TYPE_NORMAL
- en: '*![](../Images/94dfef3b9700904fd16ea3577bf25aef.png)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 15.3: Illustration of simulated data that shows Berkson’s paradox*****  ***##
    15.3 Difference-in-differences'
  prefs: []
  type: TYPE_NORMAL
- en: The ideal situation of being able to conduct an experiment is rarely possible.
    Can we reasonably expect that Netflix would allow us to change prices? And even
    if they did once, would they let us do it again, and again, and again? Further,
    rarely can we explicitly create treatment and control groups. Finally, experiments
    can be expensive or unethical. Instead, we need to make do with what we have.
    Rather than our counterfactual coming to us through randomization, and hence us
    knowing that the two are the same but for the treatment, we try to identify groups
    that were similar but for the treatment, and hence any differences can be attributed
    to the treatment.
  prefs: []
  type: TYPE_NORMAL
- en: With observational data, sometimes there are differences between our two groups
    before we treat. Provided those pre-treatment differences satisfy assumptions
    that essentially amount to the differences being both consistent, and that we
    expect that consistency to continue in the absence of the treatment—the “parallel
    trends” assumption—then we can look to any difference in the differences as the
    effect of the treatment. One of the aspects of difference-in-differences analysis
    is that we can do it using relatively straight forward methods, for instance Tang
    ([2015](99-references.html#ref-Tang2015)). Linear regression with a binary variable
    is enough to get started and do a convincing job.
  prefs: []
  type: TYPE_NORMAL
- en: Consider wanting to know the effect of a new tennis racket on serve speed. One
    way to test this would be to measure the difference between, say, Roger Federer’s
    serve speed without the tennis racket and the serve speed of an enthusiastic amateur,
    let us call them Ville, with the tennis racket. Yes, we would find a difference,
    but would we know how much to attribute to the tennis racket? Another way would
    be to consider the difference between Ville’s serve speed without the new tennis
    racket and Ville’s serve speed with the new tennis racket. But what if serves
    were just getting faster naturally over time? Instead, we combine the two approaches
    to look at the difference in the differences.
  prefs: []
  type: TYPE_NORMAL
- en: 'We begin by measuring Federer’s serve speed and compare it to Ville’s serve
    speed, both without the new racket. We then measure Federer’s serve speed again,
    and measure Ville’s serve speed with the new racket. That difference in the differences
    would then be the estimate of the effect of the new racket. There are a few key
    questions we must ask to see if this analysis is appropriate:'
  prefs: []
  type: TYPE_NORMAL
- en: Is there something else that may have affected only Ville, and not Federer that
    could affect Ville’s serve speed?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Is it likely that Federer and Ville have the same trajectory of serve speed
    improvement? This is the “parallel trends” assumption, and it dominates many discussions
    of difference-in-differences analysis.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Finally, is it likely that the variance of our serve speeds of Federer and Ville
    are the same?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Despite these requirements, difference-in-differences is a powerful approach
    because we do not need the treatment and control group to be the same before the
    treatment. We just need to have a good idea of how they differed.
  prefs: []
  type: TYPE_NORMAL
- en: '15.3.1 Simulated example: tennis serve speed'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: To be more specific about the situation, we simulate data. We will simulate
    a situation in which there is initially a difference of one between the serve
    speeds of the different people, and then after a new tennis racket, there is a
    difference of six. We can use a graph to illustrate the situation ([Figure 15.4](#fig-diffindifftennisracket)).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '*[PRE8]*  *[PRE9]'
  prefs: []
  type: TYPE_NORMAL
- en: '*![](../Images/bceeafd58e5f964ed4c299d02daa29cb.png)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 15.4: Illustration of simulated data that shows a difference before
    and after getting a new tennis racket*  *We can obtain our estimate manually,
    by looking at the average difference of the differences. When we do that, we find
    that we estimate the effect of the new tennis racket to be 5.06, which is similar
    to what we simulated.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '*[PRE11]*  *And we can use linear regression to get the same result. The model
    we are interested in is:'
  prefs: []
  type: TYPE_NORMAL
- en: \[Y_{i,t} = \beta_0 + \beta_1\times\mbox{Treatment}_i + \beta_2\times\mbox{Time}_t
    + \beta_3\times(\mbox{Treatment} \times\mbox{Time})_{i,t} + \epsilon_{i,t}\]
  prefs: []
  type: TYPE_NORMAL
- en: While we should include the separate aspects as well, it is the estimate of
    the interaction that we are interested in. In this case it is \(\beta_3\). And
    we find that our estimated effect is 5.06 ([Table 15.1](#tbl-diffindifftennisracket)).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: '*[PRE13]'
  prefs: []
  type: TYPE_NORMAL
- en: '*[PRE14]'
  prefs: []
  type: TYPE_NORMAL
- en: '*Table 15.1: Illustration of simulated data that shows a difference before
    and after getting a new tennis racket'
  prefs: []
  type: TYPE_NORMAL
- en: '|  | (1) |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| (Intercept) | 4.971 |'
  prefs: []
  type: TYPE_TB
- en: '| treatment_group1 | 3.035 |'
  prefs: []
  type: TYPE_TB
- en: '| time1 | 1.006 |'
  prefs: []
  type: TYPE_TB
- en: '| treatment_group1 × time1 | 5.057 |'
  prefs: []
  type: TYPE_TB
- en: '| Num.Obs. | 2000 |'
  prefs: []
  type: TYPE_TB
- en: '| R2 | 0.927 |'
  prefs: []
  type: TYPE_TB
- en: '| R2 Adj. | 0.927 |'
  prefs: []
  type: TYPE_TB
- en: '| Log.Lik. | -2802.166 |'
  prefs: []
  type: TYPE_TB
- en: '| ELPD | -2806.3 |'
  prefs: []
  type: TYPE_TB
- en: '| ELPD s.e. | 32.1 |'
  prefs: []
  type: TYPE_TB
- en: '| LOOIC | 5612.5 |'
  prefs: []
  type: TYPE_TB
- en: '| LOOIC s.e. | 64.2 |'
  prefs: []
  type: TYPE_TB
- en: '| WAIC | 5612.5 |'
  prefs: []
  type: TYPE_TB
- en: '| RMSE | 0.98 |******  ***### 15.3.2 Assumptions'
  prefs: []
  type: TYPE_NORMAL
- en: If we want to use difference-in-differences, then we need to satisfy the assumptions.
    There were three that were touched on earlier, but here we will focus on the “parallel
    trends” assumption. The parallel trends assumption haunts everything to do with
    difference-in-differences analysis because we can never prove it; we can just
    be convinced of it, and try to convince others.
  prefs: []
  type: TYPE_NORMAL
- en: 'To see why we can never prove it, consider an example in which we want to know
    the effect of a new stadium on a professional sports team’s wins/loses. To do
    this we consider two professional basketball teams: the Golden State Warriors
    and the Toronto Raptors. The Warriors changed stadiums at the start of the 2019-20
    season, while the Raptors did not, so we will consider four time periods: the
    2016-17 season, 2017-18 season, 2018-19 season, and finally we will compare the
    performance with the one after they moved, so the 2019-20 season. The Raptors
    here act as our counterfactual. This means that we assume the relationship between
    the Warriors and the Raptors, in the absence of a new stadium, would have continued
    to change in a consistent way. But the fundamental problem of causal inference
    means that we can never know that for certain. We must present sufficient evidence
    to assuage any concerns that a reader may have.'
  prefs: []
  type: TYPE_NORMAL
- en: 'There are four main threats to validity when we use difference-in-differences,
    and we need to address all of them ([Cunningham 2021, 272–77](99-references.html#ref-Cunningham2021)):'
  prefs: []
  type: TYPE_NORMAL
- en: Non-parallel trends. The treatment and control groups may be based on differences.
    As such it can be difficult to convincingly argue for parallel trends. In this
    case, maybe try to find another factor to consider in your model that may adjust
    for some of that. This may require triple-differenced approaches. For instance,
    in the earlier example, we could perhaps add the San Francisco 49ers, a football
    team, as they are in the same broad geographic area as the Warriors. Or maybe
    rethink the analysis to see if we can make a different control group. Adding additional
    earlier time periods may help but may introduce more issues, which we touch on
    in the third point.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Compositional differences. This is a concern when working with repeated cross-sections.
    What if the composition of those cross-sections change? For instance, if we are
    working at an app that is rapidly growing, and we want to look at the effect of
    some change. In our initial cross-section, we may have mostly young people, but
    in a subsequent cross-section, we may have more older people as the demographics
    of the app usage change. Hence our results may just be an age-effect, not an effect
    of the change that we are interested in.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Long-term effects compared with reliability. As we discussed in [Chapter 8](08-hunt.html),
    there is a trade-off between the length of the analysis that we run. As we run
    the analysis for longer there is more opportunity for other factors to affect
    the results. There is also increased chance for someone who was not treated to
    be treated. But, on the other hand, it can be difficult to convincingly argue
    that short-term results will continue in the long term.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Functional form dependence. This is less of an issue when the outcomes are similar,
    but if they are different then functional form may be responsible for some aspects
    of the results.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 15.3.3 French newspaper prices between 1960 and 1974
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In this case study we introduce Angelucci and Cagé ([2019](99-references.html#ref-angelucci2019newspapers)).
    They are interested in understanding the effect of the introduction of television
    on French newspapers. We will replicate one of the main findings.
  prefs: []
  type: TYPE_NORMAL
- en: The business model of newspapers has been challenged by the internet and many
    local newspapers have closed. This issue is not new. When television was introduced,
    there were similar concerns. Angelucci and Cagé ([2019](99-references.html#ref-angelucci2019newspapers))
    use the introduction of television advertising in France, announced in 1967, to
    examine the effect of decreased advertising revenue on newspapers. They create
    a dataset of French newspapers from 1960 to 1974 and then use difference-in-differences
    to examine the effect of the reduction in advertising revenues on newspapers’
    content and prices. The change that they focus on is the introduction of television
    advertising, which they argue affected national newspapers more than local newspapers.
    They find that this change results in both less journalism content in the newspapers
    and lower newspaper prices. Focusing on this change, and analyzing it using difference-in-differences,
    is important because it allows us to disentangle a few competing effects. For
    instance, did newspapers become redundant because they could no longer charge
    high prices for their advertisements, or because consumers preferred to get their
    news from the television?
  prefs: []
  type: TYPE_NORMAL
- en: We can get free access to the [data](https://www.openicpsr.org/openicpsr/project/116438/version/V1/view)
    that underpins Angelucci and Cagé ([2019](99-references.html#ref-angelucci2019newspapers))
    after registration. The dataset is in the Stata data format, “.dta”, which we
    can read with `read_dta()` from `haven`. The file that we are interested in is
    “Angelucci_Cage_AEJMicro_dataset.dta”, which is the “dta” folder.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: '*There are 1,196 observations in the dataset and 52 variables. Angelucci and
    Cagé ([2019](99-references.html#ref-angelucci2019newspapers)) are interested in
    the 1960-1974 time period which has around 100 newspapers. There are 14 national
    newspapers at the beginning of the period and 12 at the end. The key period is
    1967, when the French government announced it would allow advertising on television.
    Angelucci and Cagé ([2019](99-references.html#ref-angelucci2019newspapers)) argue
    that national newspapers were affected by this change, but local newspapers were
    not. The national newspapers are the treatment group and the local newspapers
    are the control group.'
  prefs: []
  type: TYPE_NORMAL
- en: We focus just on the headline difference-in-differences result and construct
    summary statistics.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: '*[PRE17]*  *We are interested in what happened from 1967 onward, especially
    in terms of advertising revenue, and whether that was different for national,
    compared with local newspapers ([Figure 15.5](#fig-frenchnewspapersrevenue)).
    We use `scales` to adjust the y-axis.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: '*![](../Images/ee991dc1577bca0f0803bc3b4e2c24f9.png)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 15.5: Revenue of French newspapers (1960-1974), by whether they were
    local or national*  *The model that we are interested in estimating is:'
  prefs: []
  type: TYPE_NORMAL
- en: \[\mbox{ln}(y_{n,t}) = \beta_0 + \beta_1\times(\mbox{National binary}\times\mbox{1967
    onward binary}) + \lambda_n + \gamma_t + \epsilon\]
  prefs: []
  type: TYPE_NORMAL
- en: It is the \(\beta_1\) coefficient that we are especially interested in. We estimate
    the models using `stan_glm()`.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: '*[PRE20]'
  prefs: []
  type: TYPE_NORMAL
- en: '*Looking at the advertising-side variables, such as revenue and prices, in
    [Table 15.2](#tbl-frenchnewspapersadvertising) we find consistently negative coefficients.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: '*Table 15.2: Effect of changed television advertising laws on revenue of French
    newspapers (1960-1974)'
  prefs: []
  type: TYPE_NORMAL
- en: '|  | Ad revenue | Ad revenue over circulation | Subscription price |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| Year | 0.05 | 0.04 | 0.05 |'
  prefs: []
  type: TYPE_TB
- en: '| After change | -0.23 | -0.15 | -0.04 |'
  prefs: []
  type: TYPE_TB
- en: '| Num.Obs. | 1052 | 1048 | 1044 |'
  prefs: []
  type: TYPE_TB
- en: '| R2 | 0.984 | 0.896 | 0.868 |'
  prefs: []
  type: TYPE_TB
- en: '| R2 Adj. | 0.983 | 0.886 | 0.852 |'
  prefs: []
  type: TYPE_TB
- en: '| Log.Lik. | 336.539 | 441.471 | 875.559 |'
  prefs: []
  type: TYPE_TB
- en: '| ELPD | 257.4 | 362.3 | 793.5 |'
  prefs: []
  type: TYPE_TB
- en: '| ELPD s.e. | 34.4 | 45.6 | 24.3 |'
  prefs: []
  type: TYPE_TB
- en: '| LOOIC | -514.8 | -724.6 | -1586.9 |'
  prefs: []
  type: TYPE_TB
- en: '| LOOIC s.e. | 68.9 | 91.2 | 48.6 |'
  prefs: []
  type: TYPE_TB
- en: '| WAIC | -515.9 | -725.5 | -1588.9 |'
  prefs: []
  type: TYPE_TB
- en: '| RMSE | 0.17 | 0.16 | 0.10 |*  *We can replicate the main results of Angelucci
    and Cagé ([2019](99-references.html#ref-angelucci2019newspapers)) and find that
    in many cases there appears to be a difference from 1967 onward. Angelucci and
    Cagé ([2019, 353–58](99-references.html#ref-angelucci2019newspapers)) also include
    an excellent example of the discussion of interpretation, external validity, and
    robustness that is required for difference-in-differences models.*********  ***##
    15.4 Propensity score matching'
  prefs: []
  type: TYPE_NORMAL
- en: Difference-in-differences is a powerful analysis framework. But it can be tough
    to identify appropriate treatment and control groups. Alexander and Ward ([2018](99-references.html#ref-alexander2018age))
    compare migrant brothers, where one brother had most of their education in a different
    country, and the other brother had most of their education in the United States.
    Given the data that are available, this match provides a reasonable treatment
    and control group. But other matches could have given different results, for instance
    friends or cousins.
  prefs: []
  type: TYPE_NORMAL
- en: 'We can only match based on observable variables. For instance, age-group or
    education. At two different times we compare smoking rates in 18-year-olds in
    one city with smoking rates in 18-year-olds in another city. This would be a coarse
    match because we know that there are many differences between 18-year-olds, even
    in terms of the variables that we commonly observe, say gender and education.
    One way to deal with this would be to create sub-groups: 18-year-old males with
    a high school education, etc. But then the sample sizes quickly become small.
    We also have the issue of how to deal with continuous variables. And is an 18-year-old
    really that different to a 19-year-old? Why not also compare with them?'
  prefs: []
  type: TYPE_NORMAL
- en: One way to proceed is to consider a nearest neighbor approach, but there can
    be limited concern for uncertainty with this approach. There can also be an issue
    with having many variables because we end up with a high-dimension graph. This
    leads to propensity score matching. Here we explain the process of propensity
    score matching and a few of the concerns that are commonly brought up about it.
  prefs: []
  type: TYPE_NORMAL
- en: Propensity score matching involves assigning some probability—the “propensity
    score”—to each observation. We construct that probability based on the observation’s
    values for the predictors without the treatment. That probability is our best
    guess at the probability of the observation being treated, regardless of whether
    it was actually treated. For instance, if 18-year-old males were treated but 19-year-old
    males were not, then, as there is not much difference between 18-year-old and
    19-year-old males in general, our assigned probability would be similar. We then
    compare the outcomes of observations with similar propensity scores.
  prefs: []
  type: TYPE_NORMAL
- en: '15.4.1 Simulated example: free shipping'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: One advantage of propensity score matching is that it allows us to easily consider
    many predictor variables at once, and it can be constructed using logistic regression.
    To be more specific we can simulate some data. We will pretend that we work for
    a large online retailer. We are going to treat some individuals with free shipping
    to see what happens to their average purchase.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: '*[PRE23]*  *Then we need to add some probability of being treated with free
    shipping. We will say that it depends on our predictors and that younger, higher-income,
    male individuals make this treatment more likely. We only know that because we
    simulated the situation. We would not know it if we were using actual data.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE24]'
  prefs: []
  type: TYPE_PRE
- en: '*Finally, we need to have some measure of a person’s average spend. We will
    assume that this increases with income. We want those with free shipping to be
    slightly higher than those without.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE25]'
  prefs: []
  type: TYPE_PRE
- en: '*[PRE26]*  *Naively we can see that there is a difference in the average spend
    between those with free shipping and those without ([Table 15.3](#tbl-heyheybigspender)).
    But the fundamental concern is what would have the spend have been of those with
    free shipping if they have not had free shipping. [Table 15.3](#tbl-heyheybigspender)
    shows an average comparison but not everyone had the same chance of getting free
    shipping. So we question the validity of that use of an average comparison. Instead
    we use propensity score matching to “link” each observation that actually got
    free shipping with their most similar observation, based on the observable variables,
    that did not get free shipping.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE27]'
  prefs: []
  type: TYPE_PRE
- en: '*Table 15.3: Difference in average spend by whether had free shipping'
  prefs: []
  type: TYPE_NORMAL
- en: '| Received free shipping? | Average spend |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| No | 64.44 |'
  prefs: []
  type: TYPE_TB
- en: '| Yes | 86.71 |*  *We use `matchit()` from `MatchIt` to implement logistic
    regression and create matched groups. We then use `match.data()` to get the data
    of matches containing both all 254 people who were actually treated with free
    shipping and the untreated person who is considered as similar to them, based
    on propensity score, as possible. The result is a dataset of 508 observations.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE28]'
  prefs: []
  type: TYPE_PRE
- en: '*[PRE29]'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE30]'
  prefs: []
  type: TYPE_PRE
- en: '*[PRE31]**  **Finally, we can estimate the effect of being treated on average
    spend using linear regression ([Table 15.4](#tbl-treatedexample)). We are particularly
    interested in the coefficient associated with the treatment variable, in this
    case free shipping.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE32]'
  prefs: []
  type: TYPE_PRE
- en: '*Table 15.4: Effect of being treated, using simulated data'
  prefs: []
  type: TYPE_NORMAL
- en: '|  | (1) |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| (Intercept) | 3.862 |'
  prefs: []
  type: TYPE_TB
- en: '|  | (0.506) |'
  prefs: []
  type: TYPE_TB
- en: '| age | 0.007 |'
  prefs: []
  type: TYPE_TB
- en: '|  | (0.005) |'
  prefs: []
  type: TYPE_TB
- en: '| genderMale | 0.013 |'
  prefs: []
  type: TYPE_TB
- en: '|  | (0.202) |'
  prefs: []
  type: TYPE_TB
- en: '| genderOther/decline | -0.509 |'
  prefs: []
  type: TYPE_TB
- en: '|  | (0.847) |'
  prefs: []
  type: TYPE_TB
- en: '| income | 0.001 |'
  prefs: []
  type: TYPE_TB
- en: '|  | (0.000) |'
  prefs: []
  type: TYPE_TB
- en: '| free_shipping1 | 10.073 |'
  prefs: []
  type: TYPE_TB
- en: '|  | (0.180) |'
  prefs: []
  type: TYPE_TB
- en: '| Num.Obs. | 508 |'
  prefs: []
  type: TYPE_TB
- en: '| R2 | 0.983 |'
  prefs: []
  type: TYPE_TB
- en: '| R2 Adj. | 0.983 |'
  prefs: []
  type: TYPE_TB
- en: '| AIC | 2167.6 |'
  prefs: []
  type: TYPE_TB
- en: '| BIC | 2197.2 |'
  prefs: []
  type: TYPE_TB
- en: '| Log.Lik. | -1076.811 |'
  prefs: []
  type: TYPE_TB
- en: '| F | 5911.747 |'
  prefs: []
  type: TYPE_TB
- en: '| RMSE | 2.02 |*  *In [Table 15.4](#tbl-treatedexample), which was based on
    only the matched sample, we find that the effect is what we simulated. That is,
    there is a difference of ten between the average spend of those who received free
    shipping and those that did not. That is in contrast to [Table 15.3](#tbl-heyheybigspender)
    which was based on the entire sample.'
  prefs: []
  type: TYPE_NORMAL
- en: 'We cover propensity score matching because it is widely used. But there are
    tradeoffs. Transparency is needed when it is being used ([Greifer 2021](99-references.html#ref-omggreifer)).
    These concerns include ([King and Nielsen 2019](99-references.html#ref-king2019propensity)):'
  prefs: []
  type: TYPE_NORMAL
- en: Unobservables. Propensity score matching cannot match on unobserved variables.
    This may be fine in a classroom setting, but in more realistic settings it will
    likely cause issues. It is difficult to understand why individuals that appear
    to be so similar, would have received different treatments, unless there is something
    unobserved that causes the difference. As propensity score matching cannot account
    for these, it is difficult to know which features are actually being brought together.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Modeling. The results of propensity score matching tend to be specific to the
    model that is used. As there is considerable flexibility as to which model is
    used, this enables researchers to pick through matches to find one that suits.
    Additionally, because the two regression steps (the matching and the analysis)
    are conducted separately, there is no propagation of uncertainty.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The fundamental problem of unobservables can never be shown to be inconsequential
    because that would require the unobserved data. Those who want to use propensity
    score matching, and other matching methods, need to be able to argue convincingly
    that it is appropriate. McKenzie ([2021](99-references.html#ref-mckenzieforthedefence))
    presents a few cases where this is possible, for instance, when there are capacity
    limits. As is the common theme of this book, such cases will require focusing
    on the data and a deep understanding of the situation that produced it.*******  ***##
    15.5 Regression discontinuity design
  prefs: []
  type: TYPE_NORMAL
- en: Regression discontinuity design (RDD) was established by Thistlethwaite and
    Campbell ([1960](99-references.html#ref-thistlethwaite1960regression)) and is
    a popular way to get causality when there is a continuous variable with cut-offs
    that determine treatment. Is there a difference between a student who gets 79
    per cent and a student who gets 80 per cent? Probably not much, but one may get
    a A-, while the other may get a B+. Seeing that on a transcript could affect who
    gets a job which could affect income. In this case the percentage is a “forcing
    variable” or “forcing function” and the cut-off for an A- is a “threshold”. As
    the treatment is determined by the forcing variable we need to control for that
    variable. These seemingly arbitrary cut-offs can be seen all the time. Hence,
    there has been a great deal of work using RDD.
  prefs: []
  type: TYPE_NORMAL
- en: There is sometimes slightly different terminology used when it comes to RDD.
    For instance, Cunningham ([2021](99-references.html#ref-Cunningham2021)) refers
    to the forcing function as a running variable. The exact terminology that is used
    does not matter provided we use it consistently.
  prefs: []
  type: TYPE_NORMAL
- en: '15.5.1 Simulated example: income and grades'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: To be more specific about the situation, we simulate data. We will consider
    the relationship between income and grades, and simulate there to be a change
    if a student gets at least 80 ([Figure 15.6](#fig-rddmarks)).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE33]'
  prefs: []
  type: TYPE_PRE
- en: '*[PRE34]*  *[PRE35]'
  prefs: []
  type: TYPE_NORMAL
- en: '*![](../Images/438ba3919b3a5c5de6e035537f8fd353.png)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 15.6: Illustration of simulated data that shows an effect on income
    from getting a mark that is 80, compared with 79*  *We can use a binary variable
    with linear regression to estimate the effect of getting a mark over 80 on income.
    We expect the coefficient to be around two, which is what we simulated, and what
    we find ([Table 15.5](#tbl-rddexample)).'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE36]'
  prefs: []
  type: TYPE_PRE
- en: '*[PRE37]'
  prefs: []
  type: TYPE_NORMAL
- en: '*[PRE38]'
  prefs: []
  type: TYPE_NORMAL
- en: '*Table 15.5: Example of regression discontinuity with simulated data'
  prefs: []
  type: TYPE_NORMAL
- en: '|  | (1) |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| (Intercept) | 5.22 |'
  prefs: []
  type: TYPE_TB
- en: '| mark | 0.06 |'
  prefs: []
  type: TYPE_TB
- en: '| mark_80_and_over | 1.89 |'
  prefs: []
  type: TYPE_TB
- en: '| Num.Obs. | 1000 |'
  prefs: []
  type: TYPE_TB
- en: '| R2 | 0.417 |'
  prefs: []
  type: TYPE_TB
- en: '| R2 Adj. | 0.415 |'
  prefs: []
  type: TYPE_TB
- en: '| Log.Lik. | -1591.847 |'
  prefs: []
  type: TYPE_TB
- en: '| ELPD | -1595.1 |'
  prefs: []
  type: TYPE_TB
- en: '| ELPD s.e. | 25.4 |'
  prefs: []
  type: TYPE_TB
- en: '| LOOIC | 3190.3 |'
  prefs: []
  type: TYPE_TB
- en: '| LOOIC s.e. | 50.9 |'
  prefs: []
  type: TYPE_TB
- en: '| WAIC | 3190.3 |'
  prefs: []
  type: TYPE_TB
- en: '| RMSE | 1.19 |*  *There are various caveats to this estimate that we will
    discuss, but the essentials of RDD are here. Given an appropriate set-up, and
    model, RDD can compare favorably to randomized trials ([Bloom, Bell, and Reiman
    2020](99-references.html#ref-bloombellreiman2020)).'
  prefs: []
  type: TYPE_NORMAL
- en: We could also implement RDD using `rdrobust`. The advantage of this approach
    is that many common extensions are easily available.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE39]'
  prefs: []
  type: TYPE_PRE
- en: '*[PRE40]******  ***### 15.5.2 Assumptions'
  prefs: []
  type: TYPE_NORMAL
- en: 'The key assumptions of RDD are ([Cunningham 2021, 163](99-references.html#ref-Cunningham2021)):'
  prefs: []
  type: TYPE_NORMAL
- en: The cut-off is specific, fixed, and known to all.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The forcing function is continuous.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The first assumption is largely about being unable to manipulate the cut-off,
    and ensures that the cut-off has meaning. The second assumption enables us to
    be confident that people on either side of the threshold are similar, apart from
    just happening to just fall on either side of the threshold.
  prefs: []
  type: TYPE_NORMAL
- en: When we discussed randomized control trials and A/B testing in [Chapter 8](08-hunt.html)
    the randomized assignment of the treatment meant that the control and treatment
    groups were the same, but for the treatment. Then we moved to difference-in-differences,
    and we assumed that there was a common trend between the treated and control groups.
    We allowed that the groups could be different, but that we could “difference out”
    their differences. Finally, we considered matching, and we said that even if the
    control and treatment groups seemed different, we were able to match, to some
    extent, those who were treated with a group that were like them in all ways, apart
    from the fact that they were not treated.
  prefs: []
  type: TYPE_NORMAL
- en: 'In regression discontinuity we consider a slightly different setting. The two
    groups are completely different in terms of the forcing variable. They are on
    either side of the threshold. There is no overlap at all. But we know the threshold
    and believe that those on either side are essentially matched. Let us consider
    the 2019 NBA Eastern Conference Semifinals—Toronto and Philadelphia:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Game 1: Raptors win 108-95;'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Game 2: 76ers win 94-89;'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Game 3: 76ers win 116-95;'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Game 4: Raptors win 101-96;'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Game 5: Raptors win 125-89;'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Game 6: 76ers win 112-101; and finally,'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Game 7: Raptors win 92-90, because of a ball that went in after bouncing on
    the rim four times.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Was there really that much difference between the teams?
  prefs: []
  type: TYPE_NORMAL
- en: 'The continuity assumption is important, but we cannot test this as it is based
    on a counterfactual. Instead, we need to convince people of it. Ways to do this
    include:'
  prefs: []
  type: TYPE_NORMAL
- en: Using a test/train set-up.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Trying different specifications. We are especially concerned if results do not
    broadly persist with just linear or quadratic functions.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Considering different subsets of the data.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Considering different windows, which is the term we give to how far each side
    of the cutoff we examine.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Being clear about uncertainty intervals, especially in graphs.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Discuss and assuaging concerns about the possibility of omitted variables.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The threshold is also important. For instance, is there an actual shift or is
    there a non-linear relationship?
  prefs: []
  type: TYPE_NORMAL
- en: 'There are a variety of weaknesses of RDD, including:'
  prefs: []
  type: TYPE_NORMAL
- en: External validity may be difficult. For instance, when we think about the A-/B+
    example, it is hard to see those generalizing to also B-/C+ students.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The important responses are those that are close to the cut-off. This means
    that even if we have many A and B students, they do not help much. Hence, we need
    a lot of data or we may have concerns about our ability to support our claims
    ([Green et al. 2009](99-references.html#ref-green2009testing)).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: As the researcher, we have a lot of freedom to implement different options.
    This means that open science best practice becomes vital.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: To this point we have considered “sharp” RDD. That is, the threshold is strict.
    But, in reality, often the boundary is a little less strict. In a sharp RDD setting,
    if we know the value of the forcing function then we know the outcome. For instance,
    if a student gets a mark of 80 then we know that they got an A-, but if they got
    a mark of 79 then we know that they got a B+. But with fuzzy RDD it is only known
    with some probability.
  prefs: []
  type: TYPE_NORMAL
- en: We want as “sharp” an effect as possible, but if the thresholds are known, then
    they will be gamed. For instance, there is a lot of evidence that people run for
    certain marathon times, and we know that people aim for certain grades. Similarly,
    from the other side, it is a lot easier for an instructor to just give out As
    than it is to have to justify Bs. One way to look at this is to consider how “balanced”
    the sample is on either side of the threshold. We can do this using histograms
    with appropriate bins. For instance, think of the age-heaping that we found in
    the cleaned Kenyan census data in [Chapter 9](09-clean_and_prepare.html).
  prefs: []
  type: TYPE_NORMAL
- en: Another key factor for RDD is the possible effect of the decision around the
    choice of model. For instance, [Figure 15.7](#fig-rddissuperconcerning) illustrates
    the difference between linear ([Figure 15.7 (a)](#fig-rddissuperconcerning-1))
    and polynomial ([Figure 15.7 (b)](#fig-rddissuperconcerning-2)).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE41]'
  prefs: []
  type: TYPE_PRE
- en: '*![](../Images/6b6148443f6adc191250302e502df9b8.png)'
  prefs: []
  type: TYPE_NORMAL
- en: (a) Linear
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/207435f819511684c2e234ac31f0c9df.png)'
  prefs: []
  type: TYPE_IMG
- en: (b) Polynomial
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 15.7: Comparing the result of considering the same situation with different
    functions'
  prefs: []
  type: TYPE_NORMAL
- en: The result is that our estimate of the difference in outcome is dependent on
    the choice of model. We see this issue occur often in RDD ([Gelman 2019](99-references.html#ref-gelmanonrdd))
    and it is especially recommended that higher order polynomials not be used, and
    instead the choice of models be either linear, quadratic, or some other smooth
    function ([Gelman and Imbens 2019](99-references.html#ref-gelmanimbensrdd)).
  prefs: []
  type: TYPE_NORMAL
- en: RDD is a popular approach, but meta-analysis suggests that standard errors are
    often inappropriately small and this could result in spurious results ([Stommes,
    Aronow, and Sävje 2023](99-references.html#ref-stommessaysno)). If you use RDD
    it is critical that you discuss the possibility of much wider standard errors
    than are reported by software packages, and what effect this would have on your
    conclusions.*  *### 15.5.3 Alcohol and crime in California
  prefs: []
  type: TYPE_NORMAL
- en: There are many opportunities to use regression discontinuity design. For instance,
    we often see it used in elections where one candidate barely wins. Caughey and
    Sekhon ([2011](99-references.html#ref-caugheysekhon2011)) examine US House elections
    between 1942 and 2008 and showed that there is considerable difference between
    bare winners and bare losers. They highlight that one of the advantages of regression
    discontinuity is the fact that the assumptions can be tested. Another common use
    is when there is a somewhat arbitrary cut-off. For instance, in much of the USA
    the legal drinking age is 21\. Carpenter and Dobkin ([2015](99-references.html#ref-carpenterdobkin))
    consider the possible effect of alcohol on crime by comparing arrests and other
    records of those who are either side of 21 in California. They find those who
    are slightly over 21 are slightly more likely to be arrested than those slightly
    under 21\. We will revisit Carpenter and Dobkin ([2015](99-references.html#ref-carpenterdobkin))
    in the context of crime in California.
  prefs: []
  type: TYPE_NORMAL
- en: 'We can obtain their replication data ([Carpenter and Dobkin 2014](99-references.html#ref-carpenterdobkinreplicationdata))
    from [here](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/27070).
    Carpenter and Dobkin ([2015](99-references.html#ref-carpenterdobkin)) consider
    a large number of variables and construct a rate, and average this rate over a
    fortnight, but for simplicity, we will just consider numbers for a few variables:
    assault, aggravated assault, DUI, and traffic violations ([Figure 15.8](#fig-californiaarrests)).'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE42]'
  prefs: []
  type: TYPE_PRE
- en: '*[PRE43]'
  prefs: []
  type: TYPE_NORMAL
- en: '*![](../Images/f68581fa2ab5a7224494fffb740ea1c9.png)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 15.8: Comparing the number of arrests either side of turning 21 for
    selected reasons*  *[PRE44]'
  prefs: []
  type: TYPE_NORMAL
- en: '*[PRE45]'
  prefs: []
  type: TYPE_NORMAL
- en: '*[PRE46]'
  prefs: []
  type: TYPE_NORMAL
- en: '*[PRE47]'
  prefs: []
  type: TYPE_NORMAL
- en: '*Table 15.6: Examining the effect of alcohol on crime in California'
  prefs: []
  type: TYPE_NORMAL
- en: '|  | (1) |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| (Intercept) | 145.54 |'
  prefs: []
  type: TYPE_TB
- en: '| age | 3.87 |'
  prefs: []
  type: TYPE_TB
- en: '| is_21_or_more | 13.24 |'
  prefs: []
  type: TYPE_TB
- en: '| Num.Obs. | 1459 |'
  prefs: []
  type: TYPE_TB
- en: '| R2 | 0.299 |'
  prefs: []
  type: TYPE_TB
- en: '| R2 Adj. | 0.297 |'
  prefs: []
  type: TYPE_TB
- en: '| Log.Lik. | -6153.757 |'
  prefs: []
  type: TYPE_TB
- en: '| ELPD | -6157.3 |'
  prefs: []
  type: TYPE_TB
- en: '| ELPD s.e. | 32.9 |'
  prefs: []
  type: TYPE_TB
- en: '| LOOIC | 12314.6 |'
  prefs: []
  type: TYPE_TB
- en: '| LOOIC s.e. | 65.7 |'
  prefs: []
  type: TYPE_TB
- en: '| WAIC | 12314.6 |'
  prefs: []
  type: TYPE_TB
- en: '| RMSE | 16.42 |*  *And the results are similar if we use `rdrobust`.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE48]'
  prefs: []
  type: TYPE_PRE
- en: '*[PRE49]***********  ***## 15.6 Instrumental variables'
  prefs: []
  type: TYPE_NORMAL
- en: 'Instrumental variables (IV) is an approach that can be handy when we have some
    type of treatment and control going on, but we have a lot of correlation with
    other variables and we possibly do not have a variable that actually measures
    what we are interested in. Adjusting for observables will not be enough to create
    a good estimate. Instead we find some variable—the eponymous instrumental variable—that
    is:'
  prefs: []
  type: TYPE_NORMAL
- en: correlated with the treatment variable, but
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: not correlated with the outcome.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: This solves our problem because the only way the instrumental variable can have
    an effect is through the treatment variable, and so we can adjust our understanding
    of the effect of the treatment variable appropriately. The trade-off is that instrumental
    variables must satisfy a bunch of different assumptions, and that, frankly, they
    are difficult to identify *ex ante*. Nonetheless, when we are able to use them,
    they are a powerful tool for speaking about causality.
  prefs: []
  type: TYPE_NORMAL
- en: The canonical instrumental variables example is smoking. These days we know
    that smoking causes cancer. But because smoking is correlated with a lot of other
    variables, for instance, education, it could be that it was actually education
    that causes cancer. RCTs may be possible, but they are likely to be troublesome
    in terms of speed and ethics, and so instead we look for some other variable that
    is correlated with smoking, but not, in and of itself, with lung cancer. In this
    case, we look to tax rates, and other policy responses, on cigarettes. As the
    tax rates on cigarettes are correlated with the number of cigarettes that are
    smoked, but not correlated with lung cancer, other than through their impact on
    cigarette smoking, through them we can assess the effect of cigarettes smoked
    on lung cancer.
  prefs: []
  type: TYPE_NORMAL
- en: To implement instrumental variables we first regress tax rates on cigarette
    smoking to get some coefficient on the instrumental variable, and then (in a separate
    regression) regress tax rates on lung cancer to again, get some coefficient on
    the instrumental variable. Our estimate is then the ratio of these coefficients,
    which is described as a “Wald estimate” ([Gelman and Hill 2007, 219](99-references.html#ref-gelmanandhill)).
  prefs: []
  type: TYPE_NORMAL
- en: Sometimes instrumental variables are used in the context of random allocation
    of treatment, such as the Oregon Health Insurance Experiment introduced in [Chapter
    8](08-hunt.html). Recall the issue was that a lottery was used to select individuals
    who were allocated to apply for health insurance, but there was nothing forcing
    them to do this. Our approach would then be to consider the relationship between
    being selected and taking up health insurance, and then between various health
    outcomes and taking up insurance. Our instrumental variable estimate, which would
    be the ratio, would estimate only those that took up health insurance because
    they were selected.
  prefs: []
  type: TYPE_NORMAL
- en: 'Following the language of Gelman and Hill ([2007, 216](99-references.html#ref-gelmanandhill)),
    when we use instrumental variables we make a variety of assumptions including:'
  prefs: []
  type: TYPE_NORMAL
- en: Ignorability of the instrument.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Correlation between the instrumental variable and the treatment variable.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Monotonicity.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Exclusion restriction.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'As an aside, the history of instrumental variables is intriguing, and Stock
    and Trebbi ([2003](99-references.html#ref-stock2003retrospectives)), via Cunningham
    ([2021](99-references.html#ref-Cunningham2021)), provide a brief overview. The
    method was first published in Wright ([1928](99-references.html#ref-wright1928tariff)).
    This is a book about the effect of tariffs on animal and vegetable oil. Why might
    instrumental variables be important in a book about tariffs on animal and vegetable
    oil? The fundamental problem is that the effect of tariffs depends on both supply
    and demand. But we only know prices and quantities, so we do not know what is
    driving the effect. We can use instrumental variables to pin down causality. The
    intriguing aspect is that the instrumental variables discussion is only in “Appendix
    B” of that book. It would seem odd to relegate a major statistical break through
    to an appendix. Further, Philip G. Wright, the book’s author, had a son Sewall
    Wright, who had considerable expertise in statistics and the specific method used
    in “Appendix B”. Hence the mystery of “Appendix B”: did Philip or Sewall write
    it? Cunningham ([2021](99-references.html#ref-Cunningham2021)), Stock and Trebbi
    ([2003](99-references.html#ref-stock2003retrospectives)), and Angrist and Krueger
    ([2001](99-references.html#ref-angristkrueger)) all go into more detail, but on
    balance feel that it is likely that Philip authored the work.'
  prefs: []
  type: TYPE_NORMAL
- en: '15.6.1 Simulated example: health status, smoking, and tax rates'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Let us generate some data. We will explore a simulation related to the canonical
    example of health status, smoking, and tax rates. We are looking to explain how
    healthy someone is based on the amount they smoke, via the tax rate on smoking.
    We are going to generate different tax rates by provinces. The tax rate on cigarettes
    is now similar across the Canadian provinces but that this is fairly recent. Let
    us assume Alberta had a low tax, and Nova Scotia had a high tax.
  prefs: []
  type: TYPE_NORMAL
- en: We are simulating data for illustrative purposes, so we need to impose the answer
    that we want. When you actually use instrumental variables you will be reversing
    the process.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE50]'
  prefs: []
  type: TYPE_PRE
- en: '*Now we need to relate the number of cigarettes that someone smoked to their
    health. We will model health status as a draw from the Normal distribution, with
    either a high or low mean depending on whether the person smokes.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE51]'
  prefs: []
  type: TYPE_PRE
- en: '*Now we need a relationship between cigarettes and the province (because in
    this illustration, the provinces have different tax rates).'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE52]'
  prefs: []
  type: TYPE_PRE
- en: '*[PRE53]*  *Now we can look at our data.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE54]'
  prefs: []
  type: TYPE_PRE
- en: '*![](../Images/758e99299e46cf90b450e424f8f2113c.png)*  *Finally, we can use
    the tax rate as an instrumental variable to estimate the effect of smoking on
    health.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE55]'
  prefs: []
  type: TYPE_PRE
- en: '*[PRE56]*  *By understanding the effect of tax rates on both smoking and health,
    we find that if you smoke then your health is likely to be worse than if you do
    not smoke.'
  prefs: []
  type: TYPE_NORMAL
- en: We can use `iv_robust()` from `estimatr` to estimate IV ([Table 15.7](#tbl-ivexamplesmoker)).
    One nice reason for doing this is that it can help to keep everything organized
    and adjust the standard errors.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE57]'
  prefs: []
  type: TYPE_PRE
- en: '*Table 15.7: Instrumental variable example using simulated data'
  prefs: []
  type: TYPE_NORMAL
- en: '|  | (1) |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| (Intercept) | 0.977 |'
  prefs: []
  type: TYPE_TB
- en: '|  | (0.041) |'
  prefs: []
  type: TYPE_TB
- en: '| smoker | -0.980 |'
  prefs: []
  type: TYPE_TB
- en: '|  | (0.081) |'
  prefs: []
  type: TYPE_TB
- en: '| Num.Obs. | 10000 |'
  prefs: []
  type: TYPE_TB
- en: '| R2 | 0.201 |'
  prefs: []
  type: TYPE_TB
- en: '| R2 Adj. | 0.201 |'
  prefs: []
  type: TYPE_TB
- en: '| AIC | 28342.1 |'
  prefs: []
  type: TYPE_TB
- en: '| BIC | 28363.7 |'
  prefs: []
  type: TYPE_TB
- en: '| RMSE | 1.00 |******  ***### 15.6.2 Assumptions'
  prefs: []
  type: TYPE_NORMAL
- en: The set-up of instrumental variables is described in [Figure 15.9](#fig-dot-taxrebateasiv-quarto),
    which shows education as a confounder between income and happiness. A tax rebate
    likely only affects income, not education, and could be used as an instrumental
    variable.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE58]'
  prefs: []
  type: TYPE_PRE
- en: '*<svg width="384" height="480" viewBox="0.00 0.00 189.54 116.00" xlink="http://www.w3.org/1999/xlink"
    style="; max-width: none; max-height: none"><g id="graph0" class="graph" transform="scale(1
    1) rotate(0) translate(4 112)"><title>D</title> <g id="node1" class="node"><title>a</title>
    <text text-anchor="middle" x="50.46" y="-13.8" font-family="Helvetica,sans-Serif"
    font-size="14.00">Income</text></g> <g id="node2" class="node"><title>b</title>
    <text text-anchor="middle" x="140.46" y="-13.8" font-family="Helvetica,sans-Serif"
    font-size="14.00">Happiness</text></g> <g id="edge1" class="edge"><title>a->b</title></g>
    <g id="node3" class="node"><title>c</title> <text text-anchor="middle" x="140.46"
    y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00">Education</text></g>
    <g id="edge2" class="edge"><title>c->a</title></g> <g id="edge3" class="edge"><title>c->b</title></g>
    <g id="node4" class="node"><title>d</title> <text text-anchor="middle" x="41.46"
    y="-85.8" font-family="Helvetica,sans-Serif" font-size="14.00">Tax rebate</text></g>
    <g id="edge4" class="edge"><title>d->a</title></g></g></svg>'
  prefs: []
  type: TYPE_NORMAL
- en: 'Figure 15.9: Education as a confounder for the relationship between income
    and happiness with tax rebate as an instrumental variable*  *As discussed earlier,
    there are a variety of assumptions that are made when using instrumental variables.
    The two most important are:'
  prefs: []
  type: TYPE_NORMAL
- en: Exclusion Restriction. This assumption is that the instrumental variable only
    affects the outcome variable through the predictor variable of interest.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Relevance. There must actually be a relationship between the instrumental variable
    and the predictor variable.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: There is typically a trade-off between these two. There are plenty of variables
    that satisfy one, precisely because they do not satisfy the other. Cunningham
    ([2021, 211](99-references.html#ref-Cunningham2021)) describes how one test of
    a good instrument is if people are initially confused before you explain it to
    them, only to think it obvious in hindsight.
  prefs: []
  type: TYPE_NORMAL
- en: Relevance can be tested using regression and other tests for correlation. The
    exclusion restriction cannot be tested. We need to present evidence and convincing
    arguments. The difficult aspect is that the instrument needs to seem irrelevant
    because that is the implication of the exclusion restriction ([Cunningham 2021,
    225](99-references.html#ref-Cunningham2021)).
  prefs: []
  type: TYPE_NORMAL
- en: Instrumental variables is a useful approach because one can obtain causal estimates
    even without explicit randomization. Finding instrumental variables used to be
    a bit of a white whale, especially in academia. But there has been increased use
    of IV approaches downstream of A/B tests ([Taddy 2019, 162](99-references.html#ref-taddy2019)).
  prefs: []
  type: TYPE_NORMAL
- en: For a long time, the canonical instrumental variable was rainfall, or more generally,
    the weather. However, the issue is that if the instrumental variable is correlated
    with other, potentially unobserved, variables, then they could be correlated with
    the variable of interest. This is a similar criticism to that above of propensity
    score matching. Mellon ([2024](99-references.html#ref-mellontakingourtoys)) found
    a large number of variables have been linked to weather in instrumental variable
    papers. It would seem that the likelihood of incorrectly estimated effects in
    some of them is quite high.
  prefs: []
  type: TYPE_NORMAL
- en: When considering an instrumental variable approach, you should spend considerable
    amounts of time on both of these assumptions. Mellon ([2024](99-references.html#ref-mellontakingourtoys))
    shows that we are especially concerned that this particular tax rebate only affects
    income and no other variable, which could itself be linked with our variables
    of interest. Approaches based on instrumental variables provide extensive freedom
    for the researcher, and Brodeur, Cook, and Heyes ([2020](99-references.html#ref-brodeurcookheyes))
    find they are more associated with p-hacking and selection reporting compared
    with RCTs and RDD. As with multiple-imputation, and propensity score matching,
    we recommend caution when using IV, and that it is never naively turned to. Indeed,
    Betz, Cook, and Hollenbach ([2018](99-references.html#ref-betzcookhollenbach2018))
    go further and say that spatial instruments are rarely valid.****  ***## 15.7
    Exercises
  prefs: []
  type: TYPE_NORMAL
- en: Practice
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '*(Plan)* Consider the following scenario: *Two children will both look when
    an ambulance passes, but only the older one will look if a street car passes,
    and only the younger one will look when a bike passes.* Please sketch out what
    that dataset could look like and then sketch a graph that you could build to show
    all observations.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '*(Simulate)* Please further consider the scenario described and simulate the
    situation. Please include at least ten tests based on the simulated data.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '*(Acquire)* Please describe a possible source of such a dataset.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '*(Explore)* Please use `ggplot2` to build the graph that you sketched. Then
    use `rstanarm` to build a model.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '*(Communicate)* Please write two paragraphs about what you did.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Quiz
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: What is the key assumption when using difference-in-differences?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Please read Varner and Sankin ([2020](99-references.html#ref-markupinsurance))
    and discuss: i) two statistical aspects; and ii) two ethical aspects.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Please go to the GitHub [page](https://github.com/the-markup/investigation-allstates-algorithm)
    related to Varner and Sankin ([2020](99-references.html#ref-markupinsurance)).
    Please list two points about what is good, and another two points about what could
    be improved.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: What are the fundamental features of regression discontinuity design and what
    are the conditions that are needed in order for regression discontinuity design
    to be able to be used?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: What are some threats to the validity of regression discontinuity design estimates?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'According to Meng ([2021](99-references.html#ref-Meng2021What)) “Data science
    can persuade via\(\dots\)” (pick all that apply):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: the careful establishment of evidence from fair-minded and high-quality data
    collection
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: processing and analysis
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: the honest interpretation and communication of findings
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: large sample sizes
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: According to Riederer ([2021](99-references.html#ref-riedererdesignpatterns))
    if we have “disjoint treated and untreated groups partitioned by a sharp cut-off”
    then which method should we use to measure the local treatment effect at the juncture
    between groups (pick one)?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: regression discontinuity
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: matching
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: difference-in-differences
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: event study methods
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: What does causal inference require according to Riederer ([2021](99-references.html#ref-riedererdesignpatterns))
    (pick all that apply)?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: data management
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: domain knowledge
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: probabilistic reasoning
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Consider an Australian 30-39 year old male living in Toronto with two children
    and a PhD. Which of the following do you think they would match most closely with
    and why (please explain in a paragraph or two)?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: An Australian 30-39 year old male living in Toronto with one child and a bachelors
    degree
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: A Canadian 30-39 year old male living in Toronto with one child and a PhD
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: An Australian 30-39 year old male living in Ottawa with one child and a PhD
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: A Canadian 18-29 year old male living in Toronto with one child and a PhD
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: What is propensity score matching? If you were matching people, then what are
    some of the features that you would like to match on? What sort of ethical questions
    does collecting and storing such information raise for you? (Please write at least
    one paragraph for each question.)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Draw a DAG illustrating the collider bias described by Bronner ([2020](99-references.html#ref-bronnerftw)).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Kahneman, Sibony, and Sunstein ([2021](99-references.html#ref-NoiseKahneman))
    say “\(\dots\)while correlation does not imply causation, causation does imply
    correlation. Where there is a causal link, we should find a correlation”. With
    reference to Cunningham ([2021, chap. 1](99-references.html#ref-Cunningham2021)),
    are they right or wrong, and why?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Class activities
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: “Look Daddy, I’m shaving”. A three-year-old stands next to his father. The father
    shaves, and then has no beard. The three-year-old “shaves”, and then also has
    no beard. Use a DAG to illustrate the situation and what might be missing.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Consider the following situation: “There are two surgeons at a hospital. One
    is considered great, and so triage, on average, tends to send hard cases to them,
    hence many of their patients die. The other surgeon is considered good, and so
    triage, on average, tends to send moderate cases to them, hence an average number
    of their patients die.” Simulate the situation, including only patient name, surgeon
    name, and patient outcome. Run a regression. What conclusion do you draw? Then
    draw a DAG that specifies the data that were missed in that regression. Add those
    variables to the simulation and re-run the regression. How does your conclusion
    differ?'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Pick either Simpson’s paradox or Berkson’s paradox and then please think of
    an example and discuss an analytical approach to adjusting for it.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Task
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: You are interested in the characteristics of people’s friendship groups and
    how those characteristics relate to individual-level outcomes, particularly economic
    measures.
  prefs: []
  type: TYPE_NORMAL
- en: You have access to individual-level data from a social media website, which
    contains information about social interactions (comments on posts, tags, etc)
    on the website, as well as a wide variety of individual-level characteristics.
  prefs: []
  type: TYPE_NORMAL
- en: While the social media website is very popular, not everyone in the population
    you are interested in has an account, and not everyone that has an account is
    active on the website. Given you are interested in economic measures, what are
    some possible issues with using these data to make inferences about the broader
    population?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The data do not contain information on individual-level income. But for around
    20 per cent of the sample you have information on the “census block” of the individual.
    By way of background, a census block contains no more than 3,000 individuals.
    The median income of each census block is known. As such, you decide to estimate
    individual-level income as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Regress the median income of each census block on a series of individual level
    characteristics (such as age, education, marital status, gender, \(\dots\)).
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Use these estimates to predict the income of individuals that do not have location
    information. Briefly discuss the advantages and disadvantages of this approach,
    particularly in how it could affect the study of income characteristics of friendship
    groups. Ensure that you address the ecological fallacy.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Understandably, the social media website will not allow the unfettered distribution
    of individual-level data. What are some ways in which you might nonetheless enhance
    the reproducibility of your work?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: This should take at least two pages.
  prefs: []
  type: TYPE_NORMAL
- en: 'Alexander, Rohan, and Zachary Ward. 2018\. “Age at Arrival and Assimilation
    During the Age of Mass Migration.” *The Journal of Economic History* 78 (3): 904–37\.
    [https://doi.org/10.1017/S0022050718000335](https://doi.org/10.1017/S0022050718000335).Angelucci,
    Charles, and Julia Cagé. 2019\. “Newspapers in Times of Low Advertising Revenues.”
    *American Economic Journal: Microeconomics* 11 (3): 319–64\. [https://doi.org/10.1257/mic.20170306](https://doi.org/10.1257/mic.20170306).Angrist,
    Joshua, and Alan Krueger. 2001\. “Instrumental Variables and the Search for Identification:
    From Supply and Demand to Natural Experiments.” *Journal of Economic Perspectives*
    15 (4): 69–85\. [https://doi.org/10.1257/jep.15.4.69](https://doi.org/10.1257/jep.15.4.69).Arel-Bundock,
    Vincent. 2022\. “modelsummary: Data and Model Summaries in R.” *Journal of Statistical
    Software* 103 (1): 1–23\. [https://doi.org/10.18637/jss.v103.i01](https://doi.org/10.18637/jss.v103.i01).———.
    2024\. *tinytable: Simple and Configurable Tables in “HTML,” “LaTeX,” “Markdown,”
    “Word,” “PNG,” “PDF,” and “Typst” Formats*. [https://vincentarelbundock.github.io/tinytable/](https://vincentarelbundock.github.io/tinytable/).Berkson,
    Joseph. 1946\. “Limitations of the Application of Fourfold Table Analysis to Hospital
    Data.” *Biometrics Bulletin* 2 (3): 47–53\. [https://doi.org/10.2307/3002000](https://doi.org/10.2307/3002000).Betz,
    Timm, Scott Cook, and Florian Hollenbach. 2018\. “On the Use and Abuse of Spatial
    Instruments.” *Political Analysis* 26 (4): 474–79\. [https://doi.org/10.1017/pan.2018.10](https://doi.org/10.1017/pan.2018.10).Bickel,
    Peter, Eugene Hammel, and William O’Connell. 1975\. “Sex Bias in Graduate Admissions:
    Data from Berkeley: Measuring Bias Is Harder Than Is Usually Assumed, and the
    Evidence Is Sometimes Contrary to Expectation.” *Science* 187 (4175): 398–404\.
    [https://doi.org/10.1126/science.187.4175.398](https://doi.org/10.1126/science.187.4175.398).Blair,
    Graeme, Jasper Cooper, Alexander Coppock, Macartan Humphreys, and Luke Sonnet.
    2021\. *estimatr: Fast Estimators for Design-Based Inference*. [https://CRAN.R-project.org/package=estimatr](https://CRAN.R-project.org/package=estimatr).Bloom,
    Howard, Andrew Bell, and Kayla Reiman. 2020\. “Using Data from Randomized Trials
    to Assess the Likely Generalizability of Educational Treatment-Effect Estimates
    from Regression Discontinuity Designs.” *Journal of Research on Educational Effectiveness*
    13 (3): 488–517\. [https://doi.org/10.1080/19345747.2019.1634169](https://doi.org/10.1080/19345747.2019.1634169).Bolker,
    Ben, and David Robinson. 2022\. *broom.mixed: Tidying Methods for Mixed Models*.
    [https://CRAN.R-project.org/package=broom.mixed](https://CRAN.R-project.org/package=broom.mixed).Brodeur,
    Abel, Nikolai Cook, and Anthony Heyes. 2020\. “Methods Matter: p-Hacking and Publication
    Bias in Causal Analysis in Economics.” *American Economic Review* 110 (11): 3634–60\.
    [https://doi.org/10.1257/aer.20190687](https://doi.org/10.1257/aer.20190687).Bronner,
    Laura. 2020\. “Why Statistics Don’t Capture the Full Extent of the Systemic Bias
    in Policing.” *FiveThirtyEight*, June. [https://fivethirtyeight.com/features/why-statistics-dont-capture-the-full-extent-of-the-systemic-bias-in-policing/](https://fivethirtyeight.com/features/why-statistics-dont-capture-the-full-extent-of-the-systemic-bias-in-policing/).Calonico,
    Sebastian, Matias Cattaneo, Max Farrell, and Rocio Titiunik. 2021\. *rdrobust:
    Robust Data-Driven Statistical Inference in Regression-Discontinuity Designs*.
    [https://CRAN.R-project.org/package=rdrobust](https://CRAN.R-project.org/package=rdrobust).Carpenter,
    Christopher, and Carlos Dobkin. 2014\. “Replication data for: The Minimum Legal
    Drinking Age and Crime.” [https://doi.org/10.7910/DVN/27070](https://doi.org/10.7910/DVN/27070).———.
    2015\. “The Minimum Legal Drinking Age and Crime.” *The Review of Economics and
    Statistics* 97 (2): 521–24\. [https://doi.org/10.1162/REST_a_00489](https://doi.org/10.1162/REST_a_00489).Caughey,
    Devin, and Jasjeet Sekhon. 2011\. “Elections and the Regression Discontinuity
    Design: Lessons from Close U.S. House Races, 1942–2008.” *Political Analysis*
    19 (4): 385–408\. [https://doi.org/10.1093/pan/mpr032](https://doi.org/10.1093/pan/mpr032).Coyle,
    Edward, Andrew Coggan, Mari Hopper, and Thomas Walters. 1988\. “Determinants of
    Endurance in Well-Trained Cyclists.” *Journal of Applied Physiology* 64 (6): 2622–30\.
    [https://doi.org/10.1152/jappl.1988.64.6.2622](https://doi.org/10.1152/jappl.1988.64.6.2622).Cunningham,
    Scott. 2021\. *Causal Inference: The Mixtape*. 1st ed. New Haven: Yale Press.
    [https://mixtape.scunning.com](https://mixtape.scunning.com).Dagan, Noa, Noam
    Barda, Eldad Kepten, Oren Miron, Shay Perchik, Mark Katz, Miguel Hernán, Marc
    Lipsitch, Ben Reis, and Ran Balicer. 2021\. “BNT162b2 mRNA Covid-19 Vaccine in
    a Nationwide Mass Vaccination Setting.” *New England Journal of Medicine* 384
    (15): 1412–23\. [https://doi.org/10.1056/NEJMoa2101765](https://doi.org/10.1056/NEJMoa2101765).Gelman,
    Andrew. 2019\. “Another Regression Discontinuity Disaster and What Can We Learn
    from It,” June. [https://statmodeling.stat.columbia.edu/2019/06/25/another-regression-discontinuity-disaster-and-what-can-we-learn-from-it/](https://statmodeling.stat.columbia.edu/2019/06/25/another-regression-discontinuity-disaster-and-what-can-we-learn-from-it/).Gelman,
    Andrew, and Jennifer Hill. 2007\. *Data Analysis Using Regression and Multilevel/Hierarchical
    Models*. 1st ed. Cambridge University Press.Gelman, Andrew, and Guido Imbens.
    2019\. “Why High-Order Polynomials Should Not Be Used in Regression Discontinuity
    Designs.” *Journal of Business & Economic Statistics* 37 (3): 447–56\. [https://doi.org/10.1080/07350015.2017.1366909](https://doi.org/10.1080/07350015.2017.1366909).Goodrich,
    Ben, Jonah Gabry, Imad Ali, and Sam Brilleman. 2023\. “rstanarm: Bayesian applied
    regression modeling via Stan.” [https://mc-stan.org/rstanarm](https://mc-stan.org/rstanarm).Green,
    Donald, Terence Leong, Holger Kern, Alan Gerber, and Christopher Larimer. 2009\.
    “Testing the Accuracy of Regression Discontinuity Analysis Using Experimental
    Benchmarks.” *Political Analysis* 17 (4): 400–417\. [https://doi.org/10.1093/pan/mpp018](https://doi.org/10.1093/pan/mpp018).Greifer,
    Noah. 2021\. “Why Do We Do Matching for Causal Inference Vs Regressing on Confounders?”
    *Cross Validated*, September. [https://stats.stackexchange.com/q/544958](https://stats.stackexchange.com/q/544958).Hernán,
    Miguel, David Clayton, and Niels Keiding. 2011\. “The Simpson’s Paradox Unraveled.”
    *International Journal of Epidemiology* 40 (3): 780–85\. [https://doi.org/10.1093/ije/dyr041](https://doi.org/10.1093/ije/dyr041).Ho,
    Daniel, Kosuke Imai, Gary King, and Elizabeth Stuart. 2011\. “MatchIt: Nonparametric
    Preprocessing for Parametric Causal Inference.” *Journal of Statistical Software*
    42 (8): 1–28\. [https://doi.org/10.18637/jss.v042.i08](https://doi.org/10.18637/jss.v042.i08).Horst,
    Allison Marie, Alison Presmanes Hill, and Kristen Gorman. 2020\. *palmerpenguins:
    Palmer Archipelago (Antarctica) penguin data*. [https://doi.org/10.5281/zenodo.3960218](https://doi.org/10.5281/zenodo.3960218).Huntington-Klein,
    Nick. 2021\. *The Effect: An Introduction to Research Design and Causality*. 1st
    ed. Chapman & Hall. [https://theeffectbook.net](https://theeffectbook.net).Kahneman,
    Daniel, Olivier Sibony, and Cass Sunstein. 2021\. *Noise: A Flaw in Human Judgment*.
    William Collins.King, Gary, and Richard Nielsen. 2019\. “Why Propensity Scores
    Should Not Be Used for Matching.” *Political Analysis* 27 (4): 435–54\. [https://doi.org/10.1017/pan.2019.11](https://doi.org/10.1017/pan.2019.11).McKenzie,
    David. 2021\. “What Do You Need To Do To Make A Matching Estimator Convincing?
    Rhetorical vs Statistical Checks.” *World Bank Blogs—Development Impact*, February.
    [https://blogs.worldbank.org/impactevaluations/what-do-you-need-do-make-matching-estimator-convincing-rhetorical-vs-statistical](https://blogs.worldbank.org/impactevaluations/what-do-you-need-do-make-matching-estimator-convincing-rhetorical-vs-statistical).Mellon,
    Jonathan. 2024\. “Rain, Rain, Go Away: 194 Potential Exclusion‐restriction Violations
    for Studies Using Weather as an Instrumental Variable.” *American Journal of Political
    Science*, 1–18\. [https://doi.org/10.1111/ajps.12894](https://doi.org/10.1111/ajps.12894).Meng,
    Xiao-Li. 2021\. “What Are the Values of Data, Data Science, or Data Scientists?”
    *Harvard Data Science Review* 3 (1). [https://doi.org/10.1162/99608f92.ee717cf7](https://doi.org/10.1162/99608f92.ee717cf7).Podlogar,
    Tim, Peter Leo, and James Spragg. 2022\. “Using VO2max as a marker of training
    status in athletes—Can we do better?” *Journal of Applied Physiology* 133 (6):
    144–47\. [https://doi.org/10.1152/japplphysiol.00723.2021](https://doi.org/10.1152/japplphysiol.00723.2021).R
    Core Team. 2024\. *R: A Language and Environment for Statistical Computing*. Vienna,
    Austria: R Foundation for Statistical Computing. [https://www.R-project.org/](https://www.R-project.org/).Riederer,
    Emily. 2021\. “Causal Design Patterns for Data Analysts,” January. [https://emilyriederer.netlify.app/post/causal-design-patterns/](https://emilyriederer.netlify.app/post/causal-design-patterns/).Robinson,
    David, Alex Hayes, and Simon Couch. 2022\. *broom: Convert Statistical Objects
    into Tidy Tibbles*. [https://CRAN.R-project.org/package=broom](https://CRAN.R-project.org/package=broom).Sekhon,
    Jasjeet, and Rocío Titiunik. 2017\. “Understanding Regression Discontinuity Designs
    as Observational Studies.” *Observational Studies* 3 (2): 174–82\. [https://doi.org/10.1353/obs.2017.0005](https://doi.org/10.1353/obs.2017.0005).Simpson,
    Edward. 1951\. “The Interpretation of Interaction in Contingency Tables.” *Journal
    of the Royal Statistical Society: Series B (Methodological)* 13 (2): 238–41\.
    [https://doi.org/10.1111/j.2517-6161.1951.tb00088.x](https://doi.org/10.1111/j.2517-6161.1951.tb00088.x).Stock,
    James, and Francesco Trebbi. 2003\. “Retrospectives: Who Invented Instrumental
    Variable Regression?” *Journal of Economic Perspectives* 17 (3): 177–94\. [https://doi.org/10.1257/089533003769204416](https://doi.org/10.1257/089533003769204416).Stommes,
    Drew, P. M. Aronow, and Fredrik Sävje. 2023\. “On the Reliability of Published
    Findings Using the Regression Discontinuity Design in Political Science.” *Research
    & Politics* 10 (2). https://doi.org/[https://doi.org/10.1177/2053168023116645](https://doi.org/10.1177/2053168023116645).Taddy,
    Matt. 2019\. *Business Data Science*. 1st ed. McGraw Hill.Tang, John. 2015\. “Pollution
    havens and the trade in toxic chemicals: Evidence from U.S. trade flows.” *Ecological
    Economics* 112 (April): 150–60\. [https://doi.org/10.1016/j.ecolecon.2015.02.022](https://doi.org/10.1016/j.ecolecon.2015.02.022).Thistlethwaite,
    Donald, and Donald Campbell. 1960\. “Regression-Discontinuity Analysis: An Alternative
    to the Ex Post Facto Experiment.” *Journal of Educational Psychology* 51 (6):
    309–17\. [https://doi.org/10.1037/h0044319](https://doi.org/10.1037/h0044319).Varner,
    Maddy, and Aaron Sankin. 2020\. “Suckers List: How Allstate’s Secret Auto Insurance
    Algorithm Squeezes Big Spenders.” *The Markup*, February. [https://themarkup.org/allstates-algorithm/2020/02/25/car-insurance-suckers-list](https://themarkup.org/allstates-algorithm/2020/02/25/car-insurance-suckers-list).Wickham,
    Hadley, Mara Averick, Jenny Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain
    François, Garrett Grolemund, et al. 2019\. “Welcome to the Tidyverse.” *Journal
    of Open Source Software* 4 (43): 1686\. [https://doi.org/10.21105/joss.01686](https://doi.org/10.21105/joss.01686).Wickham,
    Hadley, Evan Miller, and Danny Smith. 2023\. *haven: Import and Export “SPSS”
    “Stata” and “SAS” Files*. [https://CRAN.R-project.org/package=haven](https://CRAN.R-project.org/package=haven).Wickham,
    Hadley, and Dana Seidel. 2022\. *scales: Scale Functions for Visualization*. [https://CRAN.R-project.org/package=scales](https://CRAN.R-project.org/package=scales).Wright,
    Philip. 1928\. *The Tariff on Animal and Vegetable Oils*. New York: Macmillan
    Company.****************'
  prefs: []
  type: TYPE_NORMAL
