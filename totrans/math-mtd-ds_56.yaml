- en: '7.4\. Limit behavior 2: convergence to equilibrium#'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 7.4\. 限行为 2：收敛到平衡#
- en: 原文：[https://mmids-textbook.github.io/chap07_rwmc/04_mclimit/roch-mmids-rwmc-mclimit.html](https://mmids-textbook.github.io/chap07_rwmc/04_mclimit/roch-mmids-rwmc-mclimit.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://mmids-textbook.github.io/chap07_rwmc/04_mclimit/roch-mmids-rwmc-mclimit.html](https://mmids-textbook.github.io/chap07_rwmc/04_mclimit/roch-mmids-rwmc-mclimit.html)
- en: We continue our study of the long-term behavior of a chain. Again, we restrict
    ourselves to finite-space discrete-time Markov chains that are also time-homogeneous.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 我们继续研究链的长期行为。再次，我们将自己限制在有限空间离散时间马尔可夫链，这些链也是时间齐次的。
- en: 7.4.1\. Definitions[#](#definitions "Link to this heading")
  id: totrans-3
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 7.4.1\. 定义[#](#definitions "链接到这个标题")
- en: Now that we have established the existence and uniqueness of a stationary distribution
    (at least in the irreducible case), it remains to justify its relevance. As we
    indicated before, the fixed-point nature of the stationary distribution definition
    suggests that it arises as a limit of repeatedly applying \(P\). Indeed it can
    be shown that, starting from any distribution, the state distribution at time
    \(t\) converges to the stationary distribution as \(t \to +\infty\) – under an
    additional assumption.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经证明了平稳分布的存在性和唯一性（至少在不可约情况下），接下来需要证明其相关性。正如我们之前指出的，平稳分布定义的定点性质表明它是由反复应用
    \(P\) 而产生的极限。确实可以证明，从任何分布开始，状态分布随时间 \(t\) 趋于平稳分布，前提是满足一个额外的假设。
- en: The additional assumption involves issues of periodicity. The following example
    will suffice to illustrate.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 这个额外的假设涉及到周期性问题。以下例子足以说明。
- en: '**EXAMPLE:** **(A Periodic Chain)** Consider a two-state Markov chain with
    transition matrix'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '**例证：** **(周期链)** 考虑一个具有转移矩阵的两个状态马尔可夫链'
- en: \[\begin{split} P =\begin{pmatrix} 0 & 1\\ 1 & 0 \end{pmatrix}. \end{split}\]
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} P =\begin{pmatrix} 0 & 1\\ 1 & 0 \end{pmatrix}. \end{split}\]
- en: Note that this chain is irreducible. Its unique stationary distribution is \(\bpi
    = (1/2, 1/2)^T\) since indeed
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 注意到这个链是不可约的。它的唯一平稳分布是 \(\bpi = (1/2, 1/2)^T\)，因为确实
- en: \[\begin{split} \bpi P = (1/2, 1/2)^T \begin{pmatrix} 0 & 1\\ 1 & 0 \end{pmatrix}
    = (1/2, 1/2)^T = \bpi. \end{split}\]
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bpi P = (1/2, 1/2)^T \begin{pmatrix} 0 & 1\\ 1 & 0 \end{pmatrix}
    = (1/2, 1/2)^T = \bpi. \end{split}\]
- en: We compute the distribution at time \(t\), started from state \(1\). That is,
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 我们计算从状态 \(1\) 开始的时间 \(t\) 的分布。也就是说，
- en: \[ \bmu = (1, 0)^T. \]
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bmu = (1, 0)^T. \]
- en: Then
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 然后
- en: \[ \bmu P = (0, 1)^T, \]\[ \bmu P^2 = (1,0)^T, \]\[ \bmu P^3 = (0,1)^T, \]
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bmu P = (0, 1)^T, \]\[ \bmu P^2 = (1,0)^T, \]\[ \bmu P^3 = (0,1)^T, \]
- en: and so on.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 等等。
- en: In general, by induction,
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 通常情况下，通过归纳法，
- en: \[\begin{split} \bmu P^k = \begin{cases} (1,0)^T & \text{if $k$ is even}\\ (0,1)^T
    & \text{if $k$ is odd}. \end{cases} \end{split}\]
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bmu P^k = \begin{cases} (1,0)^T & \text{如果 $k$ 是偶数}\\ (0,1)^T
    & \text{如果 $k$ 是奇数}. \end{cases} \end{split}\]
- en: Clearly the distribution is not converging. Note however that the time average
    does
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 显然分布并没有收敛。然而，时间平均却在
- en: \[ \lim_{t \to +\infty} \frac{1}{t}\sum_{k \leq t} \bmu P^k = (1/2, 1/2)^T =
    \bpi. \]
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \lim_{t \to +\infty} \frac{1}{t}\sum_{k \leq t} \bmu P^k = (1/2, 1/2)^T =
    \bpi. \]
- en: \(\lhd\)
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: \(\lhd\)
- en: We will need the following definition.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要以下定义。
- en: '**DEFINITION** **(Aperiodic)** \(\idx{aperiodic}\xdi\) Let \((X_t)_{t \geq
    0}\) be a Markov chain over a finite state space \(\mathcal{S}\). We say that
    state \(i \in \mathcal{S}\) is aperiodic if'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: '**定义：** **(非周期)** \(\idx{aperiodic}\xdi\) 设 \((X_t)_{t \geq 0}\) 是一个在有限状态空间
    \(\mathcal{S}\) 上的马尔可夫链。我们说状态 \(i \in \mathcal{S}\) 是非周期的，如果'
- en: \[ \P[X_t = i\,|\,X_0 = i] > 0, \]
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \P[X_t = i\,|\,X_0 = i] > 0, \]
- en: for all sufficiently large \(t\). A chain is aperiodic if all its states are.
    \(\natural\)
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 对于所有足够大的 \(t\)。如果一个链的所有状态都是非周期的，那么这个链是非周期的。 \(\natural\)
- en: '**EXAMPLE:** **(A Periodic Chain, continued)** Going back to the two-state
    chain above, we note that neither state is aperiodic. For state \(1\), we have
    shown that'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '**例证：** **(周期链，继续)** 回到上面的两个状态链，我们注意到两个状态都不是非周期的。对于状态 \(1\)，我们已经证明'
- en: \[ \P[X_t = 1\,|\, X_0 = 1] = 0 \]
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \P[X_t = 1\,|\, X_0 = 1] = 0 \]
- en: for all \(t\) odd. \(\lhd\)
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 对于所有奇数 \(t\)。 \(\lhd\)
- en: We will not need to explore this definition in great details here. Instead we
    give a simple *sufficient* condition that is typically good enough for data science
    applications.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在这里不需要深入探讨这个定义。相反，我们给出一个简单的**充分**条件，这对于数据科学应用通常已经足够。
- en: '**DEFINITION** **(Lazy)** \(\idx{lazy}\xdi\) We say that a Markov chain \((X_t)_{t
    \geq 0}\) is lazy if every state \(i\) satisfies'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '**定义：** **(懒惰)** \(\idx{lazy}\xdi\) 我们说一个马尔可夫链 \((X_t)_{t \geq 0}\) 是懒惰的，如果每个状态
    \(i\) 都满足'
- en: \[ \P[X_1 = i\,|\,X_0 = i] > 0. \]
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \P[X_1 = i\,|\,X_0 = i] > 0. \]
- en: Put differently, all entries on the diagonal of the transition matrix are strictly
    positive. \(\natural\)
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 换句话说，转移矩阵的对角线上的所有项都是严格正的。\(\natural\)
- en: Graphically, the chain has self-loops\(\idx{self-loop}\xdi\) on each vertex.
    This terminology (which is not entirely standard) emphasizes the idea that the
    chain can “lazily” stay in its current state rather than always transitioning
    to a different one.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 图形上，链在每个顶点都有自环（\(\idx{self-loop}\xdi\)）。这个术语（它并不完全标准）强调了链可以“懒散地”保持其当前状态，而不是总是过渡到另一个状态。
- en: We check that a lazy chain is necessarily aperiodic. For any state \(i \in \mathcal{S}\)
    and any \(t\)
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 我们检查懒散链必然是非周期的。对于任何状态 \(i \in \mathcal{S}\) 和任何 \(t\)
- en: \[ \P[X_t = i\,|\,X_0 = i] \geq \prod_{s = 1}^t \P[X_{s} = i\,|\,X_{s-1} = i]
    = (\P[X_1 = i\,|\,X_0 = i])^t > 0, \]
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \P[X_t = i\,|\,X_0 = i] \geq \prod_{s = 1}^t \P[X_{s} = i\,|\,X_{s-1} = i]
    = (\P[X_1 = i\,|\,X_0 = i])^t > 0, \]
- en: by assumption. In words, the probability of being at \(i\) at time \(t\) given
    that we started at \(i\) is at least the probability that we never left.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 根据假设。换句话说，在时间 \(t\) 处于 \(i\) 状态的概率，给定我们从 \(i\) 状态开始，至少是我们从未离开的概率。
- en: '**EXAMPLE:** Any Markov chain can be modified to be lazy by adding self-loops
    to all vertices. Specifically, let \(P = (p_{i,j})_{i,j} \in \mathbb{R}^{n \times
    n}\) be the transition matrix of a Markov chain on \([n]\). Consider the modified
    transition matrix \(Q = (q_{i,j})_{i,j}\) defined as'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例**：任何马尔可夫链都可以通过向所有顶点添加自环来修改为“懒散”版本。具体来说，设 \(P = (p_{i,j})_{i,j} \in \mathbb{R}^{n
    \times n}\) 是 \([n]\) 上马尔可夫链的转移矩阵。考虑修改后的转移矩阵 \(Q = (q_{i,j})_{i,j}\)，定义为'
- en: \[ Q = \frac{1}{2}(I_{n \times n} + P). \]
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: \[ Q = \frac{1}{2}(I_{n \times n} + P). \]
- en: We check that this is indeed a stochastic matrix. For each \(i, j \in [n]\),
    we have
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 我们检查这确实是一个随机矩阵。对于每个 \(i, j \in [n]\)，我们有
- en: \[ q_{i,j} = \frac{1}{2} \mathbf{1}_{i = j} + \frac{1}{2} p_{i,j} \geq \frac{1}{2}
    p_{i,j} \geq 0 \]
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: \[ q_{i,j} = \frac{1}{2} \mathbf{1}_{i = j} + \frac{1}{2} p_{i,j} \geq \frac{1}{2}
    p_{i,j} \geq 0 \]
- en: and
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 和
- en: \[ \sum_{\ell=1}^n q_{i,\ell} = \sum_{\ell=1}^n \left[\frac{1}{2} \mathbf{1}_{i
    = \ell} + \frac{1}{2} p_{i,\ell}\right] = \frac{1}{2} \sum_{\ell=1}^n \mathbf{1}_{i
    = \ell} + \frac{1}{2} \sum_{\ell=1}^n p_{i,\ell} = \frac{1}{2} + \frac{1}{2} =
    1. \]
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \sum_{\ell=1}^n q_{i,\ell} = \sum_{\ell=1}^n \left[\frac{1}{2} \mathbf{1}_{i
    = \ell} + \frac{1}{2} p_{i,\ell}\right] = \frac{1}{2} \sum_{\ell=1}^n \mathbf{1}_{i
    = \ell} + \frac{1}{2} \sum_{\ell=1}^n p_{i,\ell} = \frac{1}{2} + \frac{1}{2} =
    1. \]
- en: Finally, we note that \(Q\) is lazy since
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们注意到 \(Q\) 是懒散的，因为
- en: \[ q_{i,i} = \frac{1}{2} \mathbf{1}_{i = i} + \frac{1}{2} p_{i,i} = \frac{1}{2}
    + \frac{1}{2} p_{i,i} \geq \frac{1}{2} > 0. \]
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: \[ q_{i,i} = \frac{1}{2} \mathbf{1}_{i = i} + \frac{1}{2} p_{i,i} = \frac{1}{2}
    + \frac{1}{2} p_{i,i} \geq \frac{1}{2} > 0. \]
- en: The chain \(Q\) is often referred to as the “lazy version” of \(P\). \(\lhd\)
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 链 \(Q\) 通常被称为 \(P\) 的“懒散版本”。\(\lhd\)
- en: 7.4.2\. Convergence theorems[#](#convergence-theorems "Link to this heading")
  id: totrans-44
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 7.4.2\. 收敛定理[#](#convergence-theorems "链接到这个标题")
- en: We are ready to state two key theorems.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 我们准备陈述两个关键定理。
- en: First, the *Convergence to Equilibrium Theorem* applies to irreducible and aperiodic
    chains. Such chains have a unique stationary distribution. The theorem says that,
    started from any initial distribution, the distribution at time \(t\) converges
    to the stationary distribution as \(t \to +\infty\).
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，**收敛到平衡定理**适用于不可约和非周期的链。这样的链具有唯一的平稳分布。该定理表明，从任何初始分布开始，时间 \(t\) 的分布随着 \(t
    \to +\infty\) 趋向于平稳分布。
- en: '**THEOREM** **(Convergence to Equilibrium)** \(\idx{convergence to equilibrium
    theorem}\xdi\) Let \((X_t)_{t\geq 0}\) be a finite, irreducible and aperiodic
    Markov chain with unique stationary distribution \(\bpi\). Then for any initial
    distribution \(\bmu\) and any state \(i\)'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '**定理** **（收敛到平衡定理）** \(\idx{convergence to equilibrium theorem}\xdi\) 设 \((X_t)_{t\geq
    0}\) 是一个有限、不可约和周期的马尔可夫链，具有唯一的平稳分布 \(\bpi\)。那么对于任何初始分布 \(\bmu\) 和任何状态 \(i\)'
- en: \[ \P[X_t = i] \to \pi_i, \]
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \P[X_t = i] \to \pi_i, \]
- en: as \(t \to +\infty\). \(\sharp\)
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 随着 \(t \to +\infty\)。\(\sharp\)
- en: Put differently, this theorem should look familiar. Using the formula \((\bmu
    P^t)_i\) for the probability that the state is \(i\) at time \(t\), we can rephrase
    the theorem in matrix form as
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 换句话说，这个定理看起来应该很熟悉。使用 \((\bmu P^t)_i\) 公式来表示在时间 \(t\) 状态为 \(i\) 的概率，我们可以将定理用矩阵形式重新表述为
- en: \[ \bmu P^t \to \bpi, \]
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bmu P^t \to \bpi, \]
- en: as \(t \to +\infty\). This is highly reminiscent of the *Power Iteration Lemma*.
    Here repeated multiplication by \(P\) starting from an arbitrary distribution
    converges to \(\bpi\), which recall is a left eigenvector of \(P\) with eigenvalue
    \(1\). Unlike the *Power Iteration Lemma*, there is no need to normalize here.
    This is because we implicitly work with the \(\ell_1\)-norm and \(P\) is stochastic,
    thereby preserving the norm.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 当 \(t \to +\infty\) 时，这非常类似于*幂迭代引理*。从任意分布开始，重复乘以 \(P\) 会收敛到 \(\bpi\)，回忆一下，\(\bpi\)
    是 \(P\) 的一个左特征向量，其特征值为 \(1\)。与*幂迭代引理*不同，这里不需要归一化。这是因为我们隐式地使用 \(\ell_1\)-范数，而 \(P\)
    是随机的，从而保持范数不变。
- en: Second, the *Ergodic Theorem* applies to irreducible (but not necessarily aperiodic)
    chains. Again such have a unique stationary distribution. The theorem says that,
    started from any initial distribution, the frequency of visits to any state \(i\)
    converges to the stationary distribution. Below, we use the notation \(\mathbf{1}[X_s
    = i]\) which is \(1\) when \(X_s = i\) and \(0\) otherwise.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 第二，*遍历定理*适用于不可约链（但不一定是非周期的链）。这样的链具有唯一的平稳分布。该定理表明，从任何初始分布开始，访问任何状态 \(i\) 的频率会收敛到平稳分布。下面，我们使用符号
    \(\mathbf{1}[X_s = i]\)，当 \(X_s = i\) 时为 \(1\)，否则为 \(0\)。
- en: '**THEOREM** **(Ergodic)** \(\idx{ergodic theorem}\xdi\) Let \((X_t)_{t\geq
    0}\) be a finite and irreducible Markov chain with unique stationary distribution
    \(\bpi\). Then for any initial distribution \(\bmu\) and any state \(i\)'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '**定理** **(遍历)** \(\idx{ergodic theorem}\xdi\) 设 \((X_t)_{t\geq 0}\) 是一个有限且不可约的马尔可夫链，具有唯一的平稳分布
    \(\bpi\)。那么对于任何初始分布 \(\bmu\) 和任何状态 \(i\)'
- en: \[ \frac{1}{t} \sum_{s = 0}^t \mathbf{1}[X_s = i] \to \pi_i, \]
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \frac{1}{t} \sum_{s = 0}^t \mathbf{1}[X_s = i] \to \pi_i, \]
- en: as \(t \to +\infty\). \(\sharp\)
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 当 \(t \to +\infty\) 时。 \(\sharp\)
- en: Above, \(\sum_{s = 0}^t \mathbf{1}[X_s = i]\) is the number of visits to \(i\)
    up to time \(t\).
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 在上面，\(\sum_{s = 0}^t \mathbf{1}[X_s = i]\) 是到时间 \(t\) 时访问 \(i\) 的次数。
- en: Note that neither of these two theorems immediately implies the other. They
    are both useful in their own way.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，这两个定理中没有一个立即意味着另一个。它们各自都有其用途。
- en: '**NUMERICAL CORNER:** The *Convergence to Equilibrium Theorem* implies that
    we can use power iteration to compute the unique stationary diistribution in the
    irreducible case. We revisit the *Robot Vaccum Example*. We initialize with the
    uniform distribution, then repeatedly multiply by \(P\).'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '**数值角:** *收敛到平衡定理*意味着在不可约的情况下，我们可以使用幂迭代来计算唯一的平稳分布。我们重新审视*机器人吸尘器示例*。我们以均匀分布初始化，然后反复乘以
    \(P\)。'
- en: '[PRE0]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '[PRE1]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '[PRE2]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '[PRE3]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '[PRE4]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '[PRE5]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: We repeat, say, \(10\) more times and compare to the truth `pi_robot`.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 我们再重复，比如，\(10\) 次更多，并与真实值 `pi_robot` 进行比较。
- en: '[PRE6]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '[PRE7]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '[PRE8]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '[PRE9]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: We see that a small number of iterations sufficed to get an accurate answer.
    In general, the speed of convergence depends on the eigenvalues of \(P\) that
    are strictly smaller than \(1\) in absolute value.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到，只需要少量迭代就足以得到准确的答案。一般来说，收敛速度取决于 \(P\) 的绝对值严格小于 \(1\) 的特征值。
- en: We can also check the *Ergodic Theorem* through simulation. We generate a long
    sample path and compare the state visit frequencies to `pi_robot`.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也可以通过模拟来检查*遍历定理*。我们生成一个长的样本路径，并将状态访问频率与`pi_robot`进行比较。
- en: '[PRE10]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '[PRE11]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '[PRE12]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '[PRE13]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: \(\unlhd\)
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: '**CHAT & LEARN** The mixing time is an important quantity in the study of Markov
    chains. Ask your favorite AI chatbot to define this concept and discuss its relevance
    to the convergence of Markov chains. Explore some bounds on the mixing time for
    specific classes of Markov chains. \(\ddagger\)'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: '**聊天与学习** 混合时间是马尔可夫链研究中一个重要的量。请你的首选AI聊天机器人定义这个概念，并讨论其与马尔可夫链收敛的相关性。探索特定类马尔可夫链的混合时间的一些界限。
    \(\ddagger\)'
- en: '***Self-assessment quiz*** *(with help from Claude, Gemini, and ChatGPT)*'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: '***自我评估测验*** *(由Claude，Gemini和ChatGPT协助)*'
- en: '**1** Which of the following is a sufficient condition for a Markov chain to
    be aperiodic?'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: '**1** 以下哪个是马尔可夫链非周期的充分条件？'
- en: a) The chain is irreducible.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: a) 链是不可约的。
- en: b) The chain has a unique stationary distribution.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: b) 链具有唯一的平稳分布。
- en: c) The chain is lazy.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: c) 链是懒惰的。
- en: d) The chain has a finite state space.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: d) 链具有有限的状态空间。
- en: '**2** In a Markov chain with state space \(S\) and transition matrix \(P\),
    what does it mean if the chain is lazy?'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: '**2** 在状态空间为 \(S\) 且转移矩阵为 \(P\) 的马尔可夫链中，如果链是懒惰的，这意味着什么？'
- en: a) \(\mathbb{E}[X_t] = 0\) for all \(t\).
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: a) 对于所有 \(t\)，\(\mathbb{E}[X_t] = 0\)。
- en: b) \(P_{ii} > 0\) for all \(i \in S\).
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: b) 对于所有 \(i \in S\)，\(P_{ii} > 0\)。
- en: c) \(P_{ij} = 0\) for all \(i \ne j\).
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: c) 对于所有 \(i \ne j\)，\(P_{ij} = 0\)。
- en: d) \(\mathrm{Var}(X_t) = 1\) for all \(t\).
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: d) 对于所有 \(t\)，\(\mathrm{Var}(X_t) = 1\)。
- en: '**3** The Convergence to Equilibrium Theorem applies to which type of Markov
    chains?'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: '**3** 收敛到平衡定理适用于哪种类型的马尔可夫链？'
- en: a) Irreducible and aperiodic chains
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: a) 不可约且非周期链
- en: b) Irreducible and periodic chains
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: b) 不可约且周期链
- en: c) Reducible and aperiodic chains
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: c) 可约和非周期链
- en: d) Reducible and periodic chains
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: d) 可约且周期链
- en: '**4** The Ergodic Theorem applies to which type of Markov chains?'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: '**4** 遍历定理适用于哪种类型的马尔可夫链？'
- en: a) Irreducible chains
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: a) 不可约链
- en: b) Aperiodic chains
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: b) 非周期链
- en: c) Reducible chains
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: c) 可约链
- en: d) Periodic chains
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: d) 周期链
- en: '**5** Which of the following describes a key difference between the Convergence
    to Equilibrium Theorem and the Ergodic Theorem?'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: '**5** 以下哪项描述了收敛到平衡定理和遍历定理之间的一个关键区别？'
- en: a) The Convergence to Equilibrium Theorem applies to periodic chains, while
    the Ergodic Theorem applies to aperiodic chains.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: a) 收敛到平衡定理适用于周期链，而遍历定理适用于非周期链。
- en: b) The Convergence to Equilibrium Theorem concerns the state distribution, while
    the Ergodic Theorem concerns the frequency of state visits.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: b) 收敛到平衡定理关注状态分布，而遍历定理关注状态访问的频率。
- en: c) The Convergence to Equilibrium Theorem requires a diagonal transition matrix,
    while the Ergodic Theorem does not.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: c) 收敛到平衡定理需要对角转移矩阵，而遍历定理不需要。
- en: d) The Convergence to Equilibrium Theorem is applicable only to finite Markov
    chains, while the Ergodic Theorem is not.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: d) 收敛到平衡定理仅适用于有限马尔可夫链，而遍历定理不适用。
- en: 'Answer for 1: c. Justification: The text states, “We check that a lazy chain
    is necessarily aperiodic.”'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 答案 1：c. 证明：文本指出，“我们检查懒惰链必然是非周期的。”
- en: 'Answer for 2: b. Justification: A weakly lazy Markov chain is defined as having
    all diagonal entries of the transition matrix strictly positive, i.e., \(P_{ii}
    > 0\) for all \(i \in S\).'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 答案 2：b. 证明：弱懒惰马尔可夫链定义为转移矩阵的所有对角线元素严格为正，即 \(P_{ii} > 0\) 对于所有 \(i \in S\)。
- en: 'Answer for 3: a. Justification: The text states, “First, the Convergence to
    Equilibrium Theorem applies to irreducible and aperiodic chains.”'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 答案 3：a. 证明：文本指出，“首先，收敛到平衡定理适用于不可约和非周期链。”
- en: 'Answer for 4: a. Justification: The text states, “Second, the Ergodic Theorem
    applies to irreducible (but not necessarily aperiodic) chains.”'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 答案 4：a. 证明：文本指出，“其次，遍历定理适用于不可约（但不一定是非周期的）链。”
- en: 'Answer for 5: b. Justification: The Convergence to Equilibrium Theorem addresses
    the convergence of the state distribution to the stationary distribution, while
    the Ergodic Theorem focuses on the frequency of visits to any state converging
    to the stationary distribution.'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 答案 5：b. 证明：收敛到平衡定理处理状态分布收敛到平稳分布的问题，而遍历定理关注任何状态访问频率收敛到平稳分布。
- en: 7.4.1\. Definitions[#](#definitions "Link to this heading")
  id: totrans-110
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 7.4.1\. 定义[#](#definitions "链接到这个标题")
- en: Now that we have established the existence and uniqueness of a stationary distribution
    (at least in the irreducible case), it remains to justify its relevance. As we
    indicated before, the fixed-point nature of the stationary distribution definition
    suggests that it arises as a limit of repeatedly applying \(P\). Indeed it can
    be shown that, starting from any distribution, the state distribution at time
    \(t\) converges to the stationary distribution as \(t \to +\infty\) – under an
    additional assumption.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 既然我们已经证明了平稳分布的存在性和唯一性（至少在不可约的情况下），接下来需要证明其相关性。正如我们之前指出的，平稳分布定义的定点性质表明它作为反复应用
    \(P\) 的极限出现。确实可以证明，从任何分布开始，状态分布随时间 \(t\) 收敛到平稳分布，当 \(t \to +\infty\) 时——在额外的假设下。
- en: The additional assumption involves issues of periodicity. The following example
    will suffice to illustrate.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 额外的假设涉及周期性问题。以下例子足以说明。
- en: '**EXAMPLE:** **(A Periodic Chain)** Consider a two-state Markov chain with
    transition matrix'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: '**例题：** **（周期链）** 考虑一个具有转移矩阵的两个状态马尔可夫链'
- en: \[\begin{split} P =\begin{pmatrix} 0 & 1\\ 1 & 0 \end{pmatrix}. \end{split}\]
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} P =\begin{pmatrix} 0 & 1\\ 1 & 0 \end{pmatrix}. \end{split}\]
- en: Note that this chain is irreducible. Its unique stationary distribution is \(\bpi
    = (1/2, 1/2)^T\) since indeed
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，这个链是不可约的。它的唯一平稳分布是 \(\bpi = (1/2, 1/2)^T\)，因为确实
- en: \[\begin{split} \bpi P = (1/2, 1/2)^T \begin{pmatrix} 0 & 1\\ 1 & 0 \end{pmatrix}
    = (1/2, 1/2)^T = \bpi. \end{split}\]
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bpi P = (1/2, 1/2)^T \begin{pmatrix} 0 & 1\\ 1 & 0 \end{pmatrix}
    = (1/2, 1/2)^T = \bpi. \end{split}\]
- en: We compute the distribution at time \(t\), started from state \(1\). That is,
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 我们计算从状态 \(1\) 开始在时间 \(t\) 的分布。也就是说，
- en: \[ \bmu = (1, 0)^T. \]
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bmu = (1, 0)^T. \]
- en: Then
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 然后
- en: \[ \bmu P = (0, 1)^T, \]\[ \bmu P^2 = (1,0)^T, \]\[ \bmu P^3 = (0,1)^T, \]
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bmu P = (0, 1)^T, \]\[ \bmu P^2 = (1,0)^T, \]\[ \bmu P^3 = (0,1)^T, \]
- en: and so on.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 以及等等。
- en: In general, by induction,
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 一般情况下，通过归纳，
- en: \[\begin{split} \bmu P^k = \begin{cases} (1,0)^T & \text{if $k$ is even}\\ (0,1)^T
    & \text{if $k$ is odd}. \end{cases} \end{split}\]
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: \[\begin{split} \bmu P^k = \begin{cases} (1,0)^T & \text{如果 $k$ 是偶数}\\ (0,1)^T
    & \text{如果 $k$ 是奇数}. \end{cases} \end{split}\]
- en: Clearly the distribution is not converging. Note however that the time average
    does
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，分布并没有收敛。然而，请注意，时间平均确实
- en: \[ \lim_{t \to +\infty} \frac{1}{t}\sum_{k \leq t} \bmu P^k = (1/2, 1/2)^T =
    \bpi. \]
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \lim_{t \to +\infty} \frac{1}{t}\sum_{k \leq t} \bmu P^k = (1/2, 1/2)^T =
    \bpi. \]
- en: \(\lhd\)
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: \(\lhd\)
- en: We will need the following definition.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将需要以下定义。
- en: '**DEFINITION** **(Aperiodic)** \(\idx{aperiodic}\xdi\) Let \((X_t)_{t \geq
    0}\) be a Markov chain over a finite state space \(\mathcal{S}\). We say that
    state \(i \in \mathcal{S}\) is aperiodic if'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '**定义** **(非周期)** \(\idx{aperiodic}\xdi\) 设 \((X_t)_{t \geq 0}\) 是一个在有限状态空间
    \(\mathcal{S}\) 上的马尔可夫链。我们说状态 \(i \in \mathcal{S}\) 是非周期的，如果'
- en: \[ \P[X_t = i\,|\,X_0 = i] > 0, \]
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \P[X_t = i\,|\,X_0 = i] > 0, \]
- en: for all sufficiently large \(t\). A chain is aperiodic if all its states are.
    \(\natural\)
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 对于所有足够大的 \(t\)。如果一个链的所有状态都是非周期的，那么这个链是非周期的。\(\natural\)
- en: '**EXAMPLE:** **(A Periodic Chain, continued)** Going back to the two-state
    chain above, we note that neither state is aperiodic. For state \(1\), we have
    shown that'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例:** **(周期链的继续)** 回到上面提到的两个状态的链，我们注意到两个状态都不是非周期的。对于状态 \(1\)，我们已经证明'
- en: \[ \P[X_t = 1\,|\, X_0 = 1] = 0 \]
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \P[X_t = 1\,|\, X_0 = 1] = 0 \]
- en: for all \(t\) odd. \(\lhd\)
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 对于所有奇数 \(t\)。\(\lhd\)
- en: We will not need to explore this definition in great details here. Instead we
    give a simple *sufficient* condition that is typically good enough for data science
    applications.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在这里不需要详细探讨这个定义。相反，我们给出一个简单的 *充分* 条件，这对于数据科学应用通常足够。
- en: '**DEFINITION** **(Lazy)** \(\idx{lazy}\xdi\) We say that a Markov chain \((X_t)_{t
    \geq 0}\) is lazy if every state \(i\) satisfies'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: '**定义** **(懒惰)** \(\idx{lazy}\xdi\) 我们说一个马尔可夫链 \((X_t)_{t \geq 0}\) 是懒惰的，如果每个状态
    \(i\) 都满足'
- en: \[ \P[X_1 = i\,|\,X_0 = i] > 0. \]
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \P[X_1 = i\,|\,X_0 = i] > 0. \]
- en: Put differently, all entries on the diagonal of the transition matrix are strictly
    positive. \(\natural\)
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 换句话说，转移矩阵的对角线上的所有项都是严格正的。\(\natural\)
- en: Graphically, the chain has self-loops\(\idx{self-loop}\xdi\) on each vertex.
    This terminology (which is not entirely standard) emphasizes the idea that the
    chain can “lazily” stay in its current state rather than always transitioning
    to a different one.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 图形上，链在每个顶点都有自环\(\idx{self-loop}\xdi\)。这个术语（它并不完全标准）强调了链可以“懒惰地”保持在当前状态，而不是总是转换到另一个状态。
- en: We check that a lazy chain is necessarily aperiodic. For any state \(i \in \mathcal{S}\)
    and any \(t\)
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 我们检查一个懒惰链必然是非周期的。对于任何状态 \(i \in \mathcal{S}\) 和任何 \(t\)
- en: \[ \P[X_t = i\,|\,X_0 = i] \geq \prod_{s = 1}^t \P[X_{s} = i\,|\,X_{s-1} = i]
    = (\P[X_1 = i\,|\,X_0 = i])^t > 0, \]
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \P[X_t = i\,|\,X_0 = i] \geq \prod_{s = 1}^t \P[X_{s} = i\,|\,X_{s-1} = i]
    = (\P[X_1 = i\,|\,X_0 = i])^t > 0, \]
- en: by assumption. In words, the probability of being at \(i\) at time \(t\) given
    that we started at \(i\) is at least the probability that we never left.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 根据假设。换句话说，在时间 \(t\) 处处于 \(i\) 的概率，给定我们从 \(i\) 开始，至少是我们从未离开的概率。
- en: '**EXAMPLE:** Any Markov chain can be modified to be lazy by adding self-loops
    to all vertices. Specifically, let \(P = (p_{i,j})_{i,j} \in \mathbb{R}^{n \times
    n}\) be the transition matrix of a Markov chain on \([n]\). Consider the modified
    transition matrix \(Q = (q_{i,j})_{i,j}\) defined as'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例:** 任何马尔可夫链都可以通过向所有顶点添加自环来修改为懒惰的。具体来说，设 \(P = (p_{i,j})_{i,j} \in \mathbb{R}^{n
    \times n}\) 是在 \([n]\) 上的马尔可夫链的转移矩阵。考虑修改后的转移矩阵 \(Q = (q_{i,j})_{i,j}\)，定义为'
- en: \[ Q = \frac{1}{2}(I_{n \times n} + P). \]
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: \[ Q = \frac{1}{2}(I_{n \times n} + P). \]
- en: We check that this is indeed a stochastic matrix. For each \(i, j \in [n]\),
    we have
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 我们检查这确实是一个随机矩阵。对于每个 \(i, j \in [n]\)，我们有
- en: \[ q_{i,j} = \frac{1}{2} \mathbf{1}_{i = j} + \frac{1}{2} p_{i,j} \geq \frac{1}{2}
    p_{i,j} \geq 0 \]
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: \[ q_{i,j} = \frac{1}{2} \mathbf{1}_{i = j} + \frac{1}{2} p_{i,j} \geq \frac{1}{2}
    p_{i,j} \geq 0 \]
- en: and
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 以及
- en: \[ \sum_{\ell=1}^n q_{i,\ell} = \sum_{\ell=1}^n \left[\frac{1}{2} \mathbf{1}_{i
    = \ell} + \frac{1}{2} p_{i,\ell}\right] = \frac{1}{2} \sum_{\ell=1}^n \mathbf{1}_{i
    = \ell} + \frac{1}{2} \sum_{\ell=1}^n p_{i,\ell} = \frac{1}{2} + \frac{1}{2} =
    1. \]
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \sum_{\ell=1}^n q_{i,\ell} = \sum_{\ell=1}^n \left[\frac{1}{2} \mathbf{1}_{i
    = \ell} + \frac{1}{2} p_{i,\ell}\right] = \frac{1}{2} \sum_{\ell=1}^n \mathbf{1}_{i
    = \ell} + \frac{1}{2} \sum_{\ell=1}^n p_{i,\ell} = \frac{1}{2} + \frac{1}{2} =
    1. \]
- en: Finally, we note that \(Q\) is lazy since
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们注意到 \(Q\) 是懒惰的，因为
- en: \[ q_{i,i} = \frac{1}{2} \mathbf{1}_{i = i} + \frac{1}{2} p_{i,i} = \frac{1}{2}
    + \frac{1}{2} p_{i,i} \geq \frac{1}{2} > 0. \]
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: \[ q_{i,i} = \frac{1}{2} \mathbf{1}_{i = i} + \frac{1}{2} p_{i,i} = \frac{1}{2}
    + \frac{1}{2} p_{i,i} \geq \frac{1}{2} > 0. \]
- en: The chain \(Q\) is often referred to as the “lazy version” of \(P\). \(\lhd\)
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 链 \(Q\) 通常被称为 \(P\) 的“懒惰版本”。\(\lhd\)
- en: 7.4.2\. Convergence theorems[#](#convergence-theorems "Link to this heading")
  id: totrans-151
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 7.4.2\. 收敛定理[#](#convergence-theorems "链接到这个标题")
- en: We are ready to state two key theorems.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 我们准备好陈述两个关键定理。
- en: First, the *Convergence to Equilibrium Theorem* applies to irreducible and aperiodic
    chains. Such chains have a unique stationary distribution. The theorem says that,
    started from any initial distribution, the distribution at time \(t\) converges
    to the stationary distribution as \(t \to +\infty\).
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，**收敛到平衡定理**适用于不可约和非周期的链。这样的链具有唯一的平稳分布。定理表明，从任何初始分布开始，时间 \(t\) 的分布会随着 \(t
    \to +\infty\) 而收敛到平稳分布。
- en: '**THEOREM** **(Convergence to Equilibrium)** \(\idx{convergence to equilibrium
    theorem}\xdi\) Let \((X_t)_{t\geq 0}\) be a finite, irreducible and aperiodic
    Markov chain with unique stationary distribution \(\bpi\). Then for any initial
    distribution \(\bmu\) and any state \(i\)'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: '**定理** **(收敛到平衡定理**) \(\idx{convergence to equilibrium theorem}\xdi\) 设 \((X_t)_{t\geq
    0}\) 是一个有限、不可约且非周期的马尔可夫链，具有唯一的平稳分布 \(\bpi\)。那么对于任何初始分布 \(\bmu\) 和任何状态 \(i\)'
- en: \[ \P[X_t = i] \to \pi_i, \]
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \P[X_t = i] \to \pi_i, \]
- en: as \(t \to +\infty\). \(\sharp\)
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 当 \(t \to +\infty\)。\(\sharp\)
- en: Put differently, this theorem should look familiar. Using the formula \((\bmu
    P^t)_i\) for the probability that the state is \(i\) at time \(t\), we can rephrase
    the theorem in matrix form as
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 换句话说，这个定理应该看起来很熟悉。使用 \((\bmu P^t)_i\) 的公式，即时间 \(t\) 时状态为 \(i\) 的概率，我们可以将定理重新表述为矩阵形式
- en: \[ \bmu P^t \to \bpi, \]
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \bmu P^t \to \bpi, \]
- en: as \(t \to +\infty\). This is highly reminiscent of the *Power Iteration Lemma*.
    Here repeated multiplication by \(P\) starting from an arbitrary distribution
    converges to \(\bpi\), which recall is a left eigenvector of \(P\) with eigenvalue
    \(1\). Unlike the *Power Iteration Lemma*, there is no need to normalize here.
    This is because we implicitly work with the \(\ell_1\)-norm and \(P\) is stochastic,
    thereby preserving the norm.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 当 \(t \to +\infty\)。这非常类似于**幂迭代引理**。从任意分布开始，重复乘以 \(P\) 会收敛到 \(\bpi\)，回忆一下，\(\bpi\)
    是 \(P\) 的左特征向量，特征值为 \(1\)。与**幂迭代引理**不同，这里不需要归一化。这是因为我们隐式地使用 \(\ell_1\)-范数，而 \(P\)
    是随机的，从而保持范数不变。
- en: Second, the *Ergodic Theorem* applies to irreducible (but not necessarily aperiodic)
    chains. Again such have a unique stationary distribution. The theorem says that,
    started from any initial distribution, the frequency of visits to any state \(i\)
    converges to the stationary distribution. Below, we use the notation \(\mathbf{1}[X_s
    = i]\) which is \(1\) when \(X_s = i\) and \(0\) otherwise.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 其次，**遍历定理**适用于不可约（但不一定是非周期的）链。这样的链具有唯一的平稳分布。定理表明，从任何初始分布开始，访问任何状态 \(i\) 的频率会收敛到平稳分布。下面，我们使用
    \(\mathbf{1}[X_s = i]\) 的符号，当 \(X_s = i\) 时为 \(1\)，否则为 \(0\)。
- en: '**THEOREM** **(Ergodic)** \(\idx{ergodic theorem}\xdi\) Let \((X_t)_{t\geq
    0}\) be a finite and irreducible Markov chain with unique stationary distribution
    \(\bpi\). Then for any initial distribution \(\bmu\) and any state \(i\)'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '**定理** **(遍历定理**) \(\idx{ergodic theorem}\xdi\) 设 \((X_t)_{t\geq 0}\) 是一个有限且不可约的马尔可夫链，具有唯一的平稳分布
    \(\bpi\)。那么对于任何初始分布 \(\bmu\) 和任何状态 \(i\)'
- en: \[ \frac{1}{t} \sum_{s = 0}^t \mathbf{1}[X_s = i] \to \pi_i, \]
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \frac{1}{t} \sum_{s = 0}^t \mathbf{1}[X_s = i] \to \pi_i, \]
- en: as \(t \to +\infty\). \(\sharp\)
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 当 \(t \to +\infty\)。\(\sharp\)
- en: Above, \(\sum_{s = 0}^t \mathbf{1}[X_s = i]\) is the number of visits to \(i\)
    up to time \(t\).
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，\(\sum_{s = 0}^t \mathbf{1}[X_s = i]\) 是到时间 \(t\) 访问 \(i\) 的次数。
- en: Note that neither of these two theorems immediately implies the other. They
    are both useful in their own way.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，这两个定理中的任何一个都不立即意味着另一个。它们各自都有其用途。
- en: '**NUMERICAL CORNER:** The *Convergence to Equilibrium Theorem* implies that
    we can use power iteration to compute the unique stationary diistribution in the
    irreducible case. We revisit the *Robot Vaccum Example*. We initialize with the
    uniform distribution, then repeatedly multiply by \(P\).'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '**数值角**: **收敛到平衡定理**意味着在不可约的情况下，我们可以使用幂迭代来计算唯一的平稳分布。我们重新审视**机器人吸尘器示例**。我们使用均匀分布初始化，然后反复乘以
    \(P\)。'
- en: '[PRE14]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '[PRE15]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '[PRE16]'
  id: totrans-169
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '[PRE17]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '[PRE18]'
  id: totrans-171
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '[PRE19]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: We repeat, say, \(10\) more times and compare to the truth `pi_robot`.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 我们重复，比如再重复 \(10\) 次，并与真实值 `pi_robot` 进行比较。
- en: '[PRE20]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '[PRE21]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '[PRE22]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '[PRE23]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: We see that a small number of iterations sufficed to get an accurate answer.
    In general, the speed of convergence depends on the eigenvalues of \(P\) that
    are strictly smaller than \(1\) in absolute value.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到，经过少数几次迭代就足以得到准确的答案。一般来说，收敛速度取决于 \(P\) 的绝对值严格小于 \(1\) 的特征值。
- en: We can also check the *Ergodic Theorem* through simulation. We generate a long
    sample path and compare the state visit frequencies to `pi_robot`.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也可以通过模拟来检查遍历定理。我们生成一个长样本路径，并将状态访问频率与 \(\pi\_robot\) 进行比较。
- en: '[PRE24]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '[PRE25]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '[PRE26]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '[PRE27]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: \(\unlhd\)
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: \(\unlhd\)
- en: '**CHAT & LEARN** The mixing time is an important quantity in the study of Markov
    chains. Ask your favorite AI chatbot to define this concept and discuss its relevance
    to the convergence of Markov chains. Explore some bounds on the mixing time for
    specific classes of Markov chains. \(\ddagger\)'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: '**CHAT & LEARN** 混合时间是马尔可夫链研究中一个重要的量。请你的心仪AI聊天机器人定义这个概念，并讨论其与马尔可夫链收敛的相关性。探索特定类马尔可夫链的混合时间的一些界限。
    \(\ddagger\)'
- en: '***Self-assessment quiz*** *(with help from Claude, Gemini, and ChatGPT)*'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: '***自我评估测验*** *(有Claude、Gemini和ChatGPT的帮助)*'
- en: '**1** Which of the following is a sufficient condition for a Markov chain to
    be aperiodic?'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: '**1** 以下哪项是马尔可夫链成为非周期的充分条件？'
- en: a) The chain is irreducible.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: a) 链是不可约的。
- en: b) The chain has a unique stationary distribution.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: b) 链具有唯一的平稳分布。
- en: c) The chain is lazy.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: c) 链是懒惰的。
- en: d) The chain has a finite state space.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: d) 链具有有限的状态空间。
- en: '**2** In a Markov chain with state space \(S\) and transition matrix \(P\),
    what does it mean if the chain is lazy?'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: '**2** 在状态空间为 \(S\) 且转移矩阵为 \(P\) 的马尔可夫链中，如果链是懒惰的，这意味着什么？'
- en: a) \(\mathbb{E}[X_t] = 0\) for all \(t\).
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: a) 对于所有 \(t\)，\(\mathbb{E}[X_t] = 0\)。
- en: b) \(P_{ii} > 0\) for all \(i \in S\).
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: b) 对于所有 \(i \in S\)，\(P_{ii} > 0\)。
- en: c) \(P_{ij} = 0\) for all \(i \ne j\).
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: c) 对于所有 \(i \ne j\)，\(P_{ij} = 0\)。
- en: d) \(\mathrm{Var}(X_t) = 1\) for all \(t\).
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: d) 对于所有 \(t\)，\(\mathrm{Var}(X_t) = 1\)。
- en: '**3** The Convergence to Equilibrium Theorem applies to which type of Markov
    chains?'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: '**3** 收敛到平衡定理适用于哪种类型的马尔可夫链？'
- en: a) Irreducible and aperiodic chains
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: a) 不可约和非周期链
- en: b) Irreducible and periodic chains
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: b) 不可约和周期链
- en: c) Reducible and aperiodic chains
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: c) 可约和非周期链
- en: d) Reducible and periodic chains
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: d) 可约和周期链
- en: '**4** The Ergodic Theorem applies to which type of Markov chains?'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: '**4** 遍历定理适用于哪种类型的马尔可夫链？'
- en: a) Irreducible chains
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: a) 不可约链
- en: b) Aperiodic chains
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: b) 非周期链
- en: c) Reducible chains
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: c) 可约链
- en: d) Periodic chains
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: d) 周期链
- en: '**5** Which of the following describes a key difference between the Convergence
    to Equilibrium Theorem and the Ergodic Theorem?'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: '**5** 以下哪项描述了收敛到平衡定理和遍历定理之间的关键区别？'
- en: a) The Convergence to Equilibrium Theorem applies to periodic chains, while
    the Ergodic Theorem applies to aperiodic chains.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: a) 收敛到平衡定理适用于周期链，而遍历定理适用于非周期链。
- en: b) The Convergence to Equilibrium Theorem concerns the state distribution, while
    the Ergodic Theorem concerns the frequency of state visits.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: b) 收敛到平衡定理关注状态分布，而遍历定理关注状态访问的频率。
- en: c) The Convergence to Equilibrium Theorem requires a diagonal transition matrix,
    while the Ergodic Theorem does not.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: c) 收敛到平衡定理需要一个对角转移矩阵，而遍历定理不需要。
- en: d) The Convergence to Equilibrium Theorem is applicable only to finite Markov
    chains, while the Ergodic Theorem is not.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: d) 收敛到平衡定理仅适用于有限马尔可夫链，而遍历定理不适用。
- en: 'Answer for 1: c. Justification: The text states, “We check that a lazy chain
    is necessarily aperiodic.”'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 1的答案：c. 理由：文本中提到，“我们检查一个懒惰链必然是非周期的。”
- en: 'Answer for 2: b. Justification: A weakly lazy Markov chain is defined as having
    all diagonal entries of the transition matrix strictly positive, i.e., \(P_{ii}
    > 0\) for all \(i \in S\).'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 2的答案：b. 理由：弱懒惰马尔可夫链被定义为转移矩阵的所有对角元素严格为正，即对于所有 \(i \in S\)，\(P_{ii} > 0\)。
- en: 'Answer for 3: a. Justification: The text states, “First, the Convergence to
    Equilibrium Theorem applies to irreducible and aperiodic chains.”'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 3的答案：a. 理由：文本中提到，“首先，收敛到平衡定理适用于不可约和非周期的链。”
- en: 'Answer for 4: a. Justification: The text states, “Second, the Ergodic Theorem
    applies to irreducible (but not necessarily aperiodic) chains.”'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 4的答案：a. 理由：文本中提到，“其次，遍历定理适用于不可约的（但不一定是非周期的）链。”
- en: 'Answer for 5: b. Justification: The Convergence to Equilibrium Theorem addresses
    the convergence of the state distribution to the stationary distribution, while
    the Ergodic Theorem focuses on the frequency of visits to any state converging
    to the stationary distribution.'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 答案为5：b. 证明：收敛到平衡态定理讨论状态分布收敛到稳态分布的问题，而遍历定理则关注访问任何状态的频率收敛到稳态分布。
