["```py\nlibrary(arrow)\nlibrary(nflverse)\nlibrary(poissonreg)\nlibrary(tidymodels)\nlibrary(tidyverse)\nlibrary(tinytable)\n```", "```py\nsim_run_data <- \n read_parquet(file = here::here(\"outputs/data/running_data.parquet\"))\n\nset.seed(853)\n\nsim_run_data_split <-\n initial_split(\n data = sim_run_data,\n prop = 0.80\n )\n\nsim_run_data_split\n```", "```py\n<Training/Testing/Total>\n<160/40/200>\n```", "```py\nsim_run_data_train <- training(sim_run_data_split)\n\nsim_run_data_test <- testing(sim_run_data_split)\n```", "```py\nsim_run_data_first_model_tidymodels <-\n linear_reg() |>\n set_engine(engine = \"lm\") |>\n fit(\n marathon_time ~ five_km_time + was_raining,\n data = sim_run_data_train\n )\n```", "```py\nweek_or_weekday <- \n read_parquet(file = \"outputs/data/week_or_weekday.parquet\")\n\nset.seed(853)\n\nweek_or_weekday <-\n week_or_weekday |>\n mutate(is_weekday = as_factor(is_weekday))\n\nweek_or_weekday_split <- initial_split(week_or_weekday, prop = 0.80)\nweek_or_weekday_train <- training(week_or_weekday_split)\nweek_or_weekday_test <- testing(week_or_weekday_split)\n\nweek_or_weekday_tidymodels <-\n logistic_reg(mode = \"classification\") |>\n set_engine(\"glm\") |>\n fit(\n is_weekday ~ number_of_cars,\n data = week_or_weekday_train\n )\n```", "```py\nweek_or_weekday_tidymodels |>\n predict(new_data = week_or_weekday_test) |>\n cbind(week_or_weekday_test) |>\n conf_mat(truth = is_weekday, estimate = .pred_class)\n```", "```py\n Truth\nPrediction  0  1\n         0 90  8\n         1  7 95\n```", "```py\nces2020 <- \n read_parquet(file = \"outputs/data/ces2020.parquet\")\n\nset.seed(853)\n\nces2020_split <- initial_split(ces2020, prop = 0.80)\nces2020_train <- training(ces2020_split)\nces2020_test <- testing(ces2020_split)\n\nces_tidymodels <-\n logistic_reg(mode = \"classification\") |>\n set_engine(\"glm\") |>\n fit(\n voted_for ~ gender + education,\n data = ces2020_train\n )\n\nces_tidymodels\n```", "```py\nparsnip model object\n\nCall:  stats::glm(formula = voted_for ~ gender + education, family = stats::binomial, \n    data = data)\n\nCoefficients:\n                  (Intercept)                     genderMale  \n                       0.2157                        -0.4697  \neducationHigh school graduate          educationSome college  \n                      -0.1857                         0.3502  \n              education2-year                education4-year  \n                       0.2311                         0.6700  \n           educationPost-grad  \n                       0.9898  \n\nDegrees of Freedom: 34842 Total (i.e. Null);  34836 Residual\nNull Deviance:      47000 \nResidual Deviance: 45430    AIC: 45440\n```", "```py\nces_tidymodels |>\n predict(new_data = ces2020_test) |>\n cbind(ces2020_test) |>\n conf_mat(truth = voted_for, estimate = .pred_class)\n```", "```py\n Truth\nPrediction Trump Biden\n     Trump   656   519\n     Biden  2834  4702\n```", "```py\nset.seed(853)\n\nces2020_10_folds <- vfold_cv(ces2020, v = 10)\n```", "```py\nces2020_cross_validation <-\n fit_resamples(\n object = logistic_reg(mode = \"classification\") |> set_engine(\"glm\"),\n preprocessor = recipe(voted_for ~ gender + education,\n data = ces2020),\n resamples = ces2020_10_folds,\n metrics = metric_set(accuracy, sens),\n control = control_resamples(save_pred = TRUE)\n )\n```", "```py\ncollect_metrics(ces2020_cross_validation) |>\n select(.metric, mean) |>\n tt() |> \n style_tt(j = 1:2, align = \"lr\") |> \n format_tt(digits = 2, num_mark_big = \",\", num_fmt = \"decimal\") |> \n setNames(c(\"Metric\", \"Mean\"))\nconf_mat_resampled(ces2020_cross_validation) |>\n mutate(Proportion = Freq / sum(Freq)) |>\n tt() |> \n style_tt(j = 1:4, align = \"llrr\") |> \n format_tt(digits = 2, num_mark_big = \",\", num_fmt = \"decimal\")\n```", "```py\nces2020_with_predictions <-\n cbind(\n ces2020,\n collect_predictions(ces2020_cross_validation) |>\n arrange(.row) |>\n select(.pred_class)\n ) |>\n as_tibble()\n```", "```py\nces2020_with_predictions |>\n group_by(gender, education, voted_for) |>\n count(.pred_class) |>\n tt() |> \n style_tt(j = 1:5, align = \"llllr\") |> \n format_tt(digits = 0, num_mark_big = \",\", num_fmt = \"decimal\") |> \n setNames(c(\n \"Gender\",\n \"Education\",\n \"Voted for\",\n \"Predicted vote\",\n \"Number\"\n ))\n```", "```py\ncount_of_A <- \n read_parquet(file = \"outputs/data/count_of_A.parquet\")\n\nset.seed(853)\n\ncount_of_A_split <-\n initial_split(count_of_A, prop = 0.80)\ncount_of_A_train <- training(count_of_A_split)\ncount_of_A_test <- testing(count_of_A_split)\n\ngrades_tidymodels <-\n poisson_reg(mode = \"regression\") |>\n set_engine(\"glm\") |>\n fit(\n number_of_As ~ department,\n data = count_of_A_train\n )\n```", "```py\nqb_regular_season_stats <- \n load_player_stats(seasons = TRUE) |> \n filter(season_type == \"REG\" & position == \"QB\")\n```"]