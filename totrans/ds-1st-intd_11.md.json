["```r\nset.seed(1)\nrandom_numbers1 <- sample(0:9, 10, replace = TRUE)\nrandom_numbers1\n```", "```r\n##  [1] 8 3 6 0 1 6 1 2 0 4\n```", "```r\nrandom_numbers2 <- sample(0:9, 10, replace = TRUE)\nrandom_numbers2\n```", "```r\n##  [1] 4 9 5 9 6 8 4 4 8 8\n```", "```r\nset.seed(1)\nrandom_numbers1_again <- sample(0:9, 10, replace = TRUE)\nrandom_numbers1_again\n```", "```r\n##  [1] 8 3 6 0 1 6 1 2 0 4\n```", "```r\nrandom_numbers2_again <- sample(0:9, 10, replace = TRUE)\nrandom_numbers2_again\n```", "```r\n##  [1] 4 9 5 9 6 8 4 4 8 8\n```", "```r\nset.seed(4235)\nrandom_numbers1_different <- sample(0:9, 10, replace = TRUE)\nrandom_numbers1_different\n```", "```r\n##  [1] 8 3 1 4 6 8 8 4 1 7\n```", "```r\nrandom_numbers2_different <- sample(0:9, 10, replace = TRUE)\nrandom_numbers2_different\n```", "```r\n##  [1] 3 7 8 2 8 8 6 3 3 8\n```", "```r\n# load packages\nlibrary(tidyverse)\nlibrary(tidymodels)\n\n# set the seed\nset.seed(1)\n\n# load data\ncancer <- read_csv(\"data/wdbc_unscaled.csv\") |>\n # convert the character Class variable to the factor datatype\n mutate(Class = as_factor(Class))  |>\n # rename the factor values to be more readable\n mutate(Class = fct_recode(Class, \"Malignant\" = \"M\", \"Benign\" = \"B\"))\n\n# create scatter plot of tumor cell concavity versus smoothness,\n# labeling the points be diagnosis class\nperim_concav <- cancer |>\n ggplot(aes(x = Smoothness, y = Concavity, color = Class)) +\n geom_point(alpha = 0.5) +\n labs(color = \"Diagnosis\") +\n scale_color_manual(values = c(\"darkorange\", \"steelblue\")) +\n theme(text = element_text(size = 12))\n\nperim_concav\n```", "```r\ncancer_split <- initial_split(cancer, prop = 0.75, strata = Class)\ncancer_train <- training(cancer_split)\ncancer_test <- testing(cancer_split)\n```", "```r\nglimpse(cancer_train)\n```", "```r\n## Rows: 426\n## Columns: 12\n## $ ID                <dbl> 8510426, 8510653, 8510824, 854941, 85713702, 857155,…\n## $ Class             <fct> Benign, Benign, Benign, Benign, Benign, Benign, Beni…\n## $ Radius            <dbl> 13.540, 13.080, 9.504, 13.030, 8.196, 12.050, 13.490…\n## $ Texture           <dbl> 14.36, 15.71, 12.44, 18.42, 16.84, 14.63, 22.30, 21.…\n## $ Perimeter         <dbl> 87.46, 85.63, 60.34, 82.61, 51.71, 78.04, 86.91, 74.…\n## $ Area              <dbl> 566.3, 520.0, 273.9, 523.8, 201.9, 449.3, 561.0, 427…\n## $ Smoothness        <dbl> 0.09779, 0.10750, 0.10240, 0.08983, 0.08600, 0.10310…\n## $ Compactness       <dbl> 0.08129, 0.12700, 0.06492, 0.03766, 0.05943, 0.09092…\n## $ Concavity         <dbl> 0.066640, 0.045680, 0.029560, 0.025620, 0.015880, 0.…\n## $ Concave_Points    <dbl> 0.047810, 0.031100, 0.020760, 0.029230, 0.005917, 0.…\n## $ Symmetry          <dbl> 0.1885, 0.1967, 0.1815, 0.1467, 0.1769, 0.1675, 0.18…\n## $ Fractal_Dimension <dbl> 0.05766, 0.06811, 0.06905, 0.05863, 0.06503, 0.06043…\n```", "```r\nglimpse(cancer_test)\n```", "```r\n## Rows: 143\n## Columns: 12\n## $ ID                <dbl> 842517, 84300903, 84501001, 84610002, 848406, 848620…\n## $ Class             <fct> Malignant, Malignant, Malignant, Malignant, Malignan…\n## $ Radius            <dbl> 20.570, 19.690, 12.460, 15.780, 14.680, 16.130, 19.8…\n## $ Texture           <dbl> 17.77, 21.25, 24.04, 17.89, 20.13, 20.68, 22.15, 14.…\n## $ Perimeter         <dbl> 132.90, 130.00, 83.97, 103.60, 94.74, 108.10, 130.00…\n## $ Area              <dbl> 1326.0, 1203.0, 475.9, 781.0, 684.5, 798.8, 1260.0, …\n## $ Smoothness        <dbl> 0.08474, 0.10960, 0.11860, 0.09710, 0.09867, 0.11700…\n## $ Compactness       <dbl> 0.07864, 0.15990, 0.23960, 0.12920, 0.07200, 0.20220…\n## $ Concavity         <dbl> 0.08690, 0.19740, 0.22730, 0.09954, 0.07395, 0.17220…\n## $ Concave_Points    <dbl> 0.070170, 0.127900, 0.085430, 0.066060, 0.052590, 0.…\n## $ Symmetry          <dbl> 0.1812, 0.2069, 0.2030, 0.1842, 0.1586, 0.2164, 0.15…\n## $ Fractal_Dimension <dbl> 0.05667, 0.05999, 0.08243, 0.06082, 0.05922, 0.07356…\n```", "```r\ncancer_proportions <- cancer_train |>\n group_by(Class) |>\n summarize(n = n()) |>\n mutate(percent = 100*n/nrow(cancer_train))\n\ncancer_proportions\n```", "```r\n## # A tibble: 2 × 3\n##   Class         n percent\n##   <fct>     <int>   <dbl>\n## 1 Malignant   159    37.3\n## 2 Benign      267    62.7\n```", "```r\ncancer_recipe <- recipe(Class ~ Smoothness + Concavity, data = cancer_train) |>\n step_scale(all_predictors()) |>\n step_center(all_predictors())\n```", "```r\nknn_spec <- nearest_neighbor(weight_func = \"rectangular\", neighbors = 3) |>\n set_engine(\"kknn\") |>\n set_mode(\"classification\")\n\nknn_fit <- workflow() |>\n add_recipe(cancer_recipe) |>\n add_model(knn_spec) |>\n fit(data = cancer_train)\n\nknn_fit\n```", "```r\n## ══ Workflow [trained] ══════════\n## Preprocessor: Recipe\n## Model: nearest_neighbor()\n## \n## ── Preprocessor ──────────\n## 2 Recipe Steps\n## \n## • step_scale()\n## • step_center()\n## \n## ── Model ──────────\n## \n## Call:\n## kknn::train.kknn(formula = ..y ~ ., data = data, ks = min_rows(3,     data, 5), \n## kernel = ~\"rectangular\")\n## \n## Type of response variable: nominal\n## Minimal misclassification: 0.1126761\n## Best kernel: rectangular\n## Best k: 3\n```", "```r\ncancer_test_predictions <- predict(knn_fit, cancer_test) |>\n bind_cols(cancer_test)\n\ncancer_test_predictions\n```", "```r\n## # A tibble: 143 × 13\n##    .pred_class       ID Class     Radius Texture Perimeter  Area Smoothness\n##    <fct>          <dbl> <fct>      <dbl>   <dbl>     <dbl> <dbl>      <dbl>\n##  1 Benign        842517 Malignant   20.6    17.8     133\\.  1326      0.0847\n##  2 Malignant   84300903 Malignant   19.7    21.2     130   1203      0.110 \n##  3 Malignant   84501001 Malignant   12.5    24.0      84.0  476\\.     0.119 \n##  4 Malignant   84610002 Malignant   15.8    17.9     104\\.   781      0.0971\n##  5 Benign        848406 Malignant   14.7    20.1      94.7  684\\.     0.0987\n##  6 Malignant   84862001 Malignant   16.1    20.7     108\\.   799\\.     0.117 \n##  7 Malignant     849014 Malignant   19.8    22.2     130   1260      0.0983\n##  8 Malignant    8511133 Malignant   15.3    14.3     102\\.   704\\.     0.107 \n##  9 Malignant     852552 Malignant   16.6    21.4     110    905\\.     0.112 \n## 10 Malignant     853612 Malignant   11.8    18.7      77.9  441\\.     0.111 \n## # ℹ 133 more rows\n## # ℹ 5 more variables: Compactness <dbl>, Concavity <dbl>, Concave_Points <dbl>,\n## #   Symmetry <dbl>, Fractal_Dimension <dbl>\n```", "```r\ncancer_test_predictions |>\n metrics(truth = Class, estimate = .pred_class) |>\n filter(.metric == \"accuracy\")\n```", "```r\n## # A tibble: 1 × 3\n##   .metric  .estimator .estimate\n##   <chr>    <chr>          <dbl>\n## 1 accuracy binary         0.853\n```", "```r\ncancer_test_predictions |> pull(Class) |> levels()\n```", "```r\n## [1] \"Malignant\" \"Benign\"\n```", "```r\ncancer_test_predictions |>\n precision(truth = Class, estimate = .pred_class, event_level = \"first\")\n```", "```r\n## # A tibble: 1 × 3\n##   .metric   .estimator .estimate\n##   <chr>     <chr>          <dbl>\n## 1 precision binary         0.767\n```", "```r\ncancer_test_predictions |>\n recall(truth = Class, estimate = .pred_class, event_level = \"first\")\n```", "```r\n## # A tibble: 1 × 3\n##   .metric .estimator .estimate\n##   <chr>   <chr>          <dbl>\n## 1 recall  binary         0.868\n```", "```r\nconfusion <- cancer_test_predictions |>\n conf_mat(truth = Class, estimate = .pred_class)\nconfusion\n```", "```r\n##            Truth\n## Prediction  Malignant Benign\n##   Malignant        46     14\n##   Benign            7     76\n```", "```r\ncancer_proportions\n```", "```r\n## # A tibble: 2 × 3\n##   Class         n percent\n##   <fct>     <int>   <dbl>\n## 1 Malignant   159    37.3\n## 2 Benign      267    62.7\n```", "```r\n# create the 25/75 split of the training data into training and validation\ncancer_split <- initial_split(cancer_train, prop = 0.75, strata = Class)\ncancer_subtrain <- training(cancer_split)\ncancer_validation <- testing(cancer_split)\n\n# recreate the standardization recipe from before\n# (since it must be based on the training data)\ncancer_recipe <- recipe(Class ~ Smoothness + Concavity,\n data = cancer_subtrain) |>\n step_scale(all_predictors()) |>\n step_center(all_predictors())\n\n# fit the knn model (we can reuse the old knn_spec model from before)\nknn_fit <- workflow() |>\n add_recipe(cancer_recipe) |>\n add_model(knn_spec) |>\n fit(data = cancer_subtrain)\n\n# get predictions on the validation data\nvalidation_predicted <- predict(knn_fit, cancer_validation) |>\n bind_cols(cancer_validation)\n\n# compute the accuracy\nacc <- validation_predicted |>\n metrics(truth = Class, estimate = .pred_class) |>\n filter(.metric == \"accuracy\") |>\n select(.estimate) |>\n pull()\n\nacc\n```", "```r\n## [1] 0.8598131\n```", "```r\ncancer_vfold <- vfold_cv(cancer_train, v = 5, strata = Class)\ncancer_vfold\n```", "```r\n## #  5-fold cross-validation using stratification \n## # A tibble: 5 × 2\n##   splits           id   \n##   <list>           <chr>\n## 1 <split [340/86]> Fold1\n## 2 <split [340/86]> Fold2\n## 3 <split [341/85]> Fold3\n## 4 <split [341/85]> Fold4\n## 5 <split [342/84]> Fold5\n```", "```r\n# recreate the standardization recipe from before\n# (since it must be based on the training data)\ncancer_recipe <- recipe(Class ~ Smoothness + Concavity,\n data = cancer_train) |>\n step_scale(all_predictors()) |>\n step_center(all_predictors())\n\n# fit the knn model (we can reuse the old knn_spec model from before)\nknn_fit <- workflow() |>\n add_recipe(cancer_recipe) |>\n add_model(knn_spec) |>\n fit_resamples(resamples = cancer_vfold)\n\nknn_fit\n```", "```r\n## # Resampling results\n## # 5-fold cross-validation using stratification \n## # A tibble: 5 × 4\n##   splits          id    .metrics         .notes          \n##   <list>          <chr> <list>          <list>          \n## 1 <split [340/86]> Fold1 <tibble [2 × 4]> <tibble [0 × 3]>\n## 2 <split [340/86]> Fold2 <tibble [2 × 4]> <tibble [0 × 3]>\n## 3 <split [341/85]> Fold3 <tibble [2 × 4]> <tibble [0 × 3]>\n## 4 <split [341/85]> Fold4 <tibble [2 × 4]> <tibble [0 × 3]>\n## 5 <split [342/84]> Fold5 <tibble [2 × 4]> <tibble [0 × 3]>\n```", "```r\nknn_fit |>\n collect_metrics()\n```", "```r\n## # A tibble: 2 × 6\n##   .metric  .estimator  mean     n std_err .config             \n##   <chr>    <chr>      <dbl> <int>   <dbl> <chr>               \n## 1 accuracy binary     0.890     5  0.0180 Preprocessor1_Model1\n## 2 roc_auc  binary     0.925     5  0.0151 Preprocessor1_Model1\n```", "```r\ncancer_vfold <- vfold_cv(cancer_train, v = 10, strata = Class)\n\nvfold_metrics <- workflow() |>\n add_recipe(cancer_recipe) |>\n add_model(knn_spec) |>\n fit_resamples(resamples = cancer_vfold) |>\n collect_metrics()\n\nvfold_metrics\n```", "```r\n## # A tibble: 2 × 6\n##   .metric  .estimator  mean     n std_err .config             \n##   <chr>    <chr>      <dbl> <int>   <dbl> <chr>               \n## 1 accuracy binary     0.890    10  0.0127 Preprocessor1_Model1\n## 2 roc_auc  binary     0.913    10  0.0150 Preprocessor1_Model1\n```", "```r\ncancer_vfold_50 <- vfold_cv(cancer_train, v = 50, strata = Class)\n\nvfold_metrics_50 <- workflow() |>\n add_recipe(cancer_recipe) |>\n add_model(knn_spec) |>\n fit_resamples(resamples = cancer_vfold_50) |>\n collect_metrics()\n\nvfold_metrics_50\n```", "```r\n## # A tibble: 2 × 6\n##   .metric  .estimator  mean     n std_err .config             \n##   <chr>    <chr>      <dbl> <int>   <dbl> <chr>               \n## 1 accuracy binary     0.884    50 0.00568 Preprocessor1_Model1\n## 2 roc_auc  binary     0.926    50 0.0148  Preprocessor1_Model1\n```", "```r\nknn_spec <- nearest_neighbor(weight_func = \"rectangular\",\n neighbors = tune()) |>\n set_engine(\"kknn\") |>\n set_mode(\"classification\")\n```", "```r\nk_vals <- tibble(neighbors = seq(from = 1, to = 100, by = 5))\n\nknn_results <- workflow() |>\n add_recipe(cancer_recipe) |>\n add_model(knn_spec) |>\n tune_grid(resamples = cancer_vfold, grid = k_vals) |>\n collect_metrics()\n\naccuracies <- knn_results |>\n filter(.metric == \"accuracy\")\n\naccuracies\n```", "```r\n## # A tibble: 20 × 7\n##    neighbors .metric  .estimator  mean     n std_err .config              \n##        <dbl> <chr>    <chr>      <dbl> <int>   <dbl> <chr>                \n##  1         1 accuracy binary     0.866    10  0.0165 Preprocessor1_Model01\n##  2         6 accuracy binary     0.890    10  0.0153 Preprocessor1_Model02\n##  3        11 accuracy binary     0.887    10  0.0173 Preprocessor1_Model03\n##  4        16 accuracy binary     0.887    10  0.0142 Preprocessor1_Model04\n##  5        21 accuracy binary     0.887    10  0.0143 Preprocessor1_Model05\n##  6        26 accuracy binary     0.887    10  0.0170 Preprocessor1_Model06\n##  7        31 accuracy binary     0.897    10  0.0145 Preprocessor1_Model07\n##  8        36 accuracy binary     0.899    10  0.0144 Preprocessor1_Model08\n##  9        41 accuracy binary     0.892    10  0.0135 Preprocessor1_Model09\n## 10        46 accuracy binary     0.892    10  0.0156 Preprocessor1_Model10\n## 11        51 accuracy binary     0.890    10  0.0155 Preprocessor1_Model11\n## 12        56 accuracy binary     0.873    10  0.0156 Preprocessor1_Model12\n## 13        61 accuracy binary     0.876    10  0.0104 Preprocessor1_Model13\n## 14        66 accuracy binary     0.871    10  0.0139 Preprocessor1_Model14\n## 15        71 accuracy binary     0.876    10  0.0104 Preprocessor1_Model15\n## 16        76 accuracy binary     0.873    10  0.0127 Preprocessor1_Model16\n## 17        81 accuracy binary     0.876    10  0.0135 Preprocessor1_Model17\n## 18        86 accuracy binary     0.873    10  0.0131 Preprocessor1_Model18\n## 19        91 accuracy binary     0.873    10  0.0140 Preprocessor1_Model19\n## 20        96 accuracy binary     0.866    10  0.0126 Preprocessor1_Model20\n```", "```r\naccuracy_vs_k <- ggplot(accuracies, aes(x = neighbors, y = mean)) +\n geom_point() +\n geom_line() +\n labs(x = \"Neighbors\", y = \"Accuracy Estimate\") +\n theme(text = element_text(size = 12))\n\naccuracy_vs_k\n```", "```r\nbest_k <- accuracies |>\n arrange(desc(mean)) |>\n head(1) |>\n pull(neighbors)\nbest_k\n```", "```r\n## [1] 36\n```", "```r\nk_lots <- tibble(neighbors = seq(from = 1, to = 385, by = 10))\n\nknn_results <- workflow() |>\n add_recipe(cancer_recipe) |>\n add_model(knn_spec) |>\n tune_grid(resamples = cancer_vfold, grid = k_lots) |>\n collect_metrics()\n\naccuracies_lots <- knn_results |>\n filter(.metric == \"accuracy\")\n\naccuracy_vs_k_lots <- ggplot(accuracies_lots, aes(x = neighbors, y = mean)) +\n geom_point() +\n geom_line() +\n labs(x = \"Neighbors\", y = \"Accuracy Estimate\") +\n theme(text = element_text(size = 12))\n\naccuracy_vs_k_lots\n```", "```r\ncancer_recipe <- recipe(Class ~ Smoothness + Concavity, data = cancer_train) |>\n step_scale(all_predictors()) |>\n step_center(all_predictors())\n\nknn_spec <- nearest_neighbor(weight_func = \"rectangular\", neighbors = best_k) |>\n set_engine(\"kknn\") |>\n set_mode(\"classification\")\n\nknn_fit <- workflow() |>\n add_recipe(cancer_recipe) |>\n add_model(knn_spec) |>\n fit(data = cancer_train)\n\nknn_fit\n```", "```r\n## ══ Workflow [trained] ══════════════════════════════════════════════════════════\n## Preprocessor: Recipe\n## Model: nearest_neighbor()\n## \n## ── Preprocessor ────────────────────────────────────────────────────────────────\n## 2 Recipe Steps\n## \n## • step_scale()\n## • step_center()\n## \n## ── Model ───────────────────────────────────────────────────────────────────────\n## \n## Call:\n## kknn::train.kknn(formula = ..y ~ ., data = data, ks = min_rows(36,     data, 5), kernel = ~\"rectangular\")\n## \n## Type of response variable: nominal\n## Minimal misclassification: 0.1150235\n## Best kernel: rectangular\n## Best k: 36\n```", "```r\ncancer_test_predictions <- predict(knn_fit, cancer_test) |>\n bind_cols(cancer_test)\n\ncancer_test_predictions |>\n metrics(truth = Class, estimate = .pred_class) |>\n filter(.metric == \"accuracy\")\n```", "```r\n## # A tibble: 1 × 3\n##   .metric  .estimator .estimate\n##   <chr>    <chr>          <dbl>\n## 1 accuracy binary         0.860\n```", "```r\ncancer_test_predictions |>\n precision(truth = Class, estimate = .pred_class, event_level=\"first\")\n```", "```r\n## # A tibble: 1 × 3\n##   .metric   .estimator .estimate\n##   <chr>     <chr>          <dbl>\n## 1 precision binary           0.8\n```", "```r\ncancer_test_predictions |>\n recall(truth = Class, estimate = .pred_class, event_level=\"first\")\n```", "```r\n## # A tibble: 1 × 3\n##   .metric .estimator .estimate\n##   <chr>   <chr>          <dbl>\n## 1 recall  binary         0.830\n```", "```r\nconfusion <- cancer_test_predictions |>\n conf_mat(truth = Class, estimate = .pred_class)\nconfusion\n```", "```r\n##            Truth\n## Prediction  Malignant Benign\n##   Malignant        44     11\n##   Benign            9     79\n```", "```r\ncancer_irrelevant |>\n select(Class, Smoothness, Concavity, Perimeter, Irrelevant1, Irrelevant2)\n```", "```r\n## # A tibble: 569 × 6\n##    Class     Smoothness Concavity Perimeter Irrelevant1 Irrelevant2\n##    <fct>          <dbl>     <dbl>     <dbl>       <dbl>       <dbl>\n##  1 Malignant     0.118     0.300      123\\.            1           0\n##  2 Malignant     0.0847    0.0869     133\\.            0           0\n##  3 Malignant     0.110     0.197      130             0           0\n##  4 Malignant     0.142     0.241       77.6           0           1\n##  5 Malignant     0.100     0.198      135\\.            0           0\n##  6 Malignant     0.128     0.158       82.6           1           0\n##  7 Malignant     0.0946    0.113      120\\.            0           1\n##  8 Malignant     0.119     0.0937      90.2           1           0\n##  9 Malignant     0.127     0.186       87.5           0           0\n## 10 Malignant     0.119     0.227       84.0           1           1\n## # ℹ 559 more rows\n```", "```r\ncancer_subset <- cancer_irrelevant |>\n select(Class,\n Smoothness,\n Concavity,\n Perimeter,\n Irrelevant1,\n Irrelevant2,\n Irrelevant3)\n\nnames <- colnames(cancer_subset |> select(-Class))\n\ncancer_subset\n```", "```r\n## # A tibble: 569 × 7\n##    Class     Smoothness Concavity Perimeter Irrelevant1 Irrelevant2 Irrelevant3\n##    <fct>          <dbl>     <dbl>     <dbl>       <dbl>       <dbl>       <dbl>\n##  1 Malignant     0.118     0.300      123\\.            1           0           1\n##  2 Malignant     0.0847    0.0869     133\\.            0           0           0\n##  3 Malignant     0.110     0.197      130             0           0           0\n##  4 Malignant     0.142     0.241       77.6           0           1           0\n##  5 Malignant     0.100     0.198      135\\.            0           0           0\n##  6 Malignant     0.128     0.158       82.6           1           0           1\n##  7 Malignant     0.0946    0.113      120\\.            0           1           1\n##  8 Malignant     0.119     0.0937      90.2           1           0           0\n##  9 Malignant     0.127     0.186       87.5           0           0           1\n## 10 Malignant     0.119     0.227       84.0           1           1           0\n## # ℹ 559 more rows\n```", "```r\nexample_formula <- paste(\"Class\", \"~\", paste(names, collapse=\"+\"))\nexample_formula\n```", "```r\n## [1] \"Class ~ Smoothness+Concavity+Perimeter+Irrelevant1+Irrelevant2+Irrelevant3\"\n```", "```r\n# create an empty tibble to store the results\naccuracies <- tibble(size = integer(),\n model_string = character(),\n accuracy = numeric())\n\n# create a model specification\nknn_spec <- nearest_neighbor(weight_func = \"rectangular\",\n neighbors = tune()) |>\n set_engine(\"kknn\") |>\n set_mode(\"classification\")\n\n# create a 5-fold cross-validation object\ncancer_vfold <- vfold_cv(cancer_subset, v = 5, strata = Class)\n\n# store the total number of predictors\nn_total <- length(names)\n\n# stores selected predictors\nselected <- c()\n\n# for every size from 1 to the total number of predictors\nfor (i in 1:n_total) {\n # for every predictor still not added yet\n accs <- list()\n models <- list()\n for (j in 1:length(names)) {\n # create a model string for this combination of predictors\n preds_new <- c(selected, names[[j]])\n model_string <- paste(\"Class\", \"~\", paste(preds_new, collapse=\"+\"))\n\n # create a recipe from the model string\n cancer_recipe <- recipe(as.formula(model_string),\n data = cancer_subset) |>\n step_scale(all_predictors()) |>\n step_center(all_predictors())\n\n # tune the K-NN classifier with these predictors,\n # and collect the accuracy for the best K\n acc <- workflow() |>\n add_recipe(cancer_recipe) |>\n add_model(knn_spec) |>\n tune_grid(resamples = cancer_vfold, grid = 10) |>\n collect_metrics() |>\n filter(.metric == \"accuracy\") |>\n summarize(mx = max(mean))\n acc <- acc$mx |> unlist()\n\n # add this result to the dataframe\n accs[[j]] <- acc\n models[[j]] <- model_string\n }\n jstar <- which.max(unlist(accs))\n accuracies <- accuracies |>\n add_row(size = i,\n model_string = models[[jstar]],\n accuracy = accs[[jstar]])\n selected <- c(selected, names[[jstar]])\n names <- names[-jstar]\n}\naccuracies\n```", "```r\n## # A tibble: 6 × 3\n##    size model_string                                                    accuracy\n##   <int> <chr>                                                              <dbl>\n## 1     1 Class ~ Perimeter                                                  0.896\n## 2     2 Class ~ Perimeter+Concavity                                        0.916\n## 3     3 Class ~ Perimeter+Concavity+Smoothness                             0.931\n## 4     4 Class ~ Perimeter+Concavity+Smoothness+Irrelevant1                 0.928\n## 5     5 Class ~ Perimeter+Concavity+Smoothness+Irrelevant1+Irrelevant3     0.924\n## 6     6 Class ~ Perimeter+Concavity+Smoothness+Irrelevant1+Irrelevant3…    0.902\n```"]