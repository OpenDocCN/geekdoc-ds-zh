- en: Weak Form
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec16.3-weak_form.html](https://phys-sim-book.github.io/lec16.3-weak_form.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: 'First, since the external force term R(X,0)Aext(X,t) resembles a lot to the
    time derivative of the momentum on the left-hand side, we will ignore it during
    the derivation for simplicity. Then, for an arbitrary test function Q(⋅,t):Ω0→Rd,
    let''s compute the dot product to both sides of Equation [(16.2.3)](lec16.2-momentum_conserv.html#eq:lec16:momentum_conserve_derived)
    and integrate over Ω0 to generate the weak form: =​∫Ω0​R(X,0)Q(X,t)⋅A(X,t)dX∫Ω0​Q(X,t)⋅(∇X⋅P(X,t))dX,∀ Q(⋅,t):Ω0→Rd and t≥0.​(16.3.1)
    Here we denote A(X,t)=∂t∂V​(X,t). Without going into details on finite element
    analysis, we claim that the weak form is sufficiently equivalent to the strong
    form since Equation [(16.3.1)](#eq:lec16:weak_form) is required to hold for arbitrary
    Q(⋅,t), and solving the weak form provides us a solution that is a "good enough"
    soution to the original problem.'
  prefs: []
  type: TYPE_NORMAL
- en: With index notation where Ai​ means the i-th component of vector-valued function
    A:Ω0→Rd, and Ai,j​ means ∂Xj​∂Ai​​, we can rewrite Equation [(16.3.1)](#eq:lec16:weak_form)
    as ∫Ω0​R(X,0)i∑​Qi​(X,t)Ai​(X,t)dX=∫Ω0​i∑​Qi​(X,t)j∑​Pij,j​(X,t)dX.(16.3.2) If
    we further omit the summation symbol and let the repetitive subscripts represent
    summation (this is known as Einstein notation), we obtain ∫Ω0​R(X,0)Qi​(X,t)Ai​(X,t)dX=∫Ω0​Qi​(X,t)Pij,j​(X,t)dX.(16.3.3)
    Now applying Integration By Parts on the right-hand side, we can rewrite Equation
    [(16.3.3)](#eq:lec16:weak_form_index_nosum) as ​∫Ω0​R(X,0)Qi​(X,t)Ai​(X,t)dX=∫Ω0​(∇⋅(Qi​(X,t)Pi​(X,t))−∇Qi​(X,t)⋅Pi​(X,t))dX=∫Ω0​((Qi​(X,t)Pij​(X,t)),j​−Qi,j​(X,t)Pij​(X,t))dX.​(16.3.4)
  prefs: []
  type: TYPE_NORMAL
- en: '****Definition 16.3.1 (Integration By Parts).**** For a scalar-valued function
    u(x) and a vector-valued function (vector field) V(x), the product rule for divergence
    states that: ∇⋅(u(x)V(x))=u(x)∇⋅V(x)+∇u(x)⋅V(x). Integrating both sides on domain
    Ω then gives: ∫Ω​∇⋅(u(x)V(x))dx=∫Ω​u(x)∇⋅V(x)dx+∫Ω​∇u(x)⋅V(x)dx.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Then if we further apply the divergence theorem on the first part of the right-hand
    side of Equation [(16.3.4)](#eq:lec16:weak_form_index_IBP), we obtain ​∫Ω0​R(X,0)Qi​(X,t)Ai​(X,t)dX=∫∂Ω0​Qi​(X,t)Pij​(X,t)Nj​(X)ds(X)−∫Ω0​Qi,j​(X,t)Pij​(X,t)dX.​(16.3.5)
    The quantity Pij​Nj​ would be specified as a boundary condition. If we let T(X,t)
    be the boundary force per unit reference area (traction) with Ti​=Pij​Nj​, then
    we can say that the conservation of momentum implies that ∀Q(⋅,t):Ω0→Rd ​∫Ω0​R(X,0)Qi​(X,t)Ai​(X,t)dX=∫∂Ω0​Qi​(X,t)Ti​(X,t)ds(X)−∫Ω0​Qi,j​(X,t)Pij​(X,t)dX.​(16.3.6)
    This is momentum conservation's weak form written in Ω0.
  prefs: []
  type: TYPE_NORMAL
- en: '***Remark 16.3.1 (Why Weak Form).*** In finite element method (FEM) for solids,
    conservation of momentum is formulated in the weak form rather than directly discretizing
    the strong form due to specific advantages. The strong form requires the displacement
    field and its derivatives to be continuously differentiable across the entire
    domain, which is difficult to achieve in practical scenarios involving complex
    geometries or material discontinuities. On the other hand, the weak form only
    requires the displacement field itself to be continuous, relaxing the need for
    continuous derivatives. This makes the weak form more adaptable to irregular mesh
    geometries and better suited for incorporating boundary conditions and handling
    interface problems. The weak form''s integration-based approach reduces the sensitivity
    to local irregularities, making it more stable and robust for numerical computation
    in solid mechanics. Thus, while the strong form provides a direct representation
    of physical laws, its direct discretization is less practical for the computational
    demands and complexities typical in FEM analyses.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
