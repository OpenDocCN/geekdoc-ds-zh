- en: Weak Form
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 弱形式
- en: 原文：[https://phys-sim-book.github.io/lec16.3-weak_form.html](https://phys-sim-book.github.io/lec16.3-weak_form.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec16.3-weak_form.html](https://phys-sim-book.github.io/lec16.3-weak_form.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: 'First, since the external force term R(X,0)Aext(X,t) resembles a lot to the
    time derivative of the momentum on the left-hand side, we will ignore it during
    the derivation for simplicity. Then, for an arbitrary test function Q(⋅,t):Ω0→Rd,
    let''s compute the dot product to both sides of Equation [(16.2.3)](lec16.2-momentum_conserv.html#eq:lec16:momentum_conserve_derived)
    and integrate over Ω0 to generate the weak form: =​∫Ω0​R(X,0)Q(X,t)⋅A(X,t)dX∫Ω0​Q(X,t)⋅(∇X⋅P(X,t))dX,∀ Q(⋅,t):Ω0→Rd and t≥0.​(16.3.1)
    Here we denote A(X,t)=∂t∂V​(X,t). Without going into details on finite element
    analysis, we claim that the weak form is sufficiently equivalent to the strong
    form since Equation [(16.3.1)](#eq:lec16:weak_form) is required to hold for arbitrary
    Q(⋅,t), and solving the weak form provides us a solution that is a "good enough"
    soution to the original problem.'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，由于外力项 R(X,0)Aext(X,t) 与左侧动量的时间导数非常相似，我们将忽略它以简化推导。然后，对于任意测试函数 Q(⋅,t):Ω0→Rd，让我们计算方程
    [(16.2.3)](lec16.2-momentum_conserve.html#eq:lec16:momentum_conserve_derived)
    两边的点积，并在 Ω0 上积分以生成弱形式：=∫Ω0 R(X,0)Q(X,t)⋅A(X,t)dX/∫Ω0 Q(X,t)⋅(∇X⋅P(X,t))dX，对于所有
    Q(⋅,t):Ω0→Rd 和 t≥0。(16.3.1) 这里我们表示 A(X,t)=∂t/∂V(X,t)。不深入有限元素分析的具体细节，我们声称弱形式与强形式足够等价，因为方程
    [(16.3.1)](#eq:lec16:weak_form) 必须对任意 Q(⋅,t) 成立，并且求解弱形式为我们提供了一个对原始问题“足够好”的解。
- en: With index notation where Ai​ means the i-th component of vector-valued function
    A:Ω0→Rd, and Ai,j​ means ∂Xj​∂Ai​​, we can rewrite Equation [(16.3.1)](#eq:lec16:weak_form)
    as ∫Ω0​R(X,0)i∑​Qi​(X,t)Ai​(X,t)dX=∫Ω0​i∑​Qi​(X,t)j∑​Pij,j​(X,t)dX.(16.3.2) If
    we further omit the summation symbol and let the repetitive subscripts represent
    summation (this is known as Einstein notation), we obtain ∫Ω0​R(X,0)Qi​(X,t)Ai​(X,t)dX=∫Ω0​Qi​(X,t)Pij,j​(X,t)dX.(16.3.3)
    Now applying Integration By Parts on the right-hand side, we can rewrite Equation
    [(16.3.3)](#eq:lec16:weak_form_index_nosum) as ​∫Ω0​R(X,0)Qi​(X,t)Ai​(X,t)dX=∫Ω0​(∇⋅(Qi​(X,t)Pi​(X,t))−∇Qi​(X,t)⋅Pi​(X,t))dX=∫Ω0​((Qi​(X,t)Pij​(X,t)),j​−Qi,j​(X,t)Pij​(X,t))dX.​(16.3.4)
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在指标符号表示法中，其中 Ai 表示向量值函数 A:Ω0→Rd 的第 i 个分量，而 Ai,j 表示 ∂Xj/∂Ai，我们可以将方程 [(16.3.1)](#eq:lec16:weak_form)
    重写为 ∫Ω0 R(X,0)i∑ Qi(X,t)Ai(X,t)dX=∫Ω0 i∑ Qi(X,t)j∑ Pij,j(X,t)dX.(16.3.2) 如果我们进一步省略求和符号，并让重复的下标表示求和（这被称为爱因斯坦符号），则得到
    ∫Ω0 R(X,0)Qi(X,t)Ai(X,t)dX=∫Ω0 Qi(X,t)Pij,j(X,t)dX.(16.3.3) 现在对方程 [(16.3.3)](#eq:lec16:weak_form_index_nosum)
    的右侧应用分部积分，我们可以将方程重写为 ∫Ω0 R(X,0)Qi(X,t)Ai(X,t)dX=∫Ω0 (∇⋅(Qi(X,t)Pi(X,t))−∇Qi(X,t)⋅Pi(X,t))dX=∫Ω0
    ((Qi(X,t)Pij(X,t)),j−Qi,j(X,t)Pij(X,t))dX.​(16.3.4)
- en: '****Definition 16.3.1 (Integration By Parts).**** For a scalar-valued function
    u(x) and a vector-valued function (vector field) V(x), the product rule for divergence
    states that: ∇⋅(u(x)V(x))=u(x)∇⋅V(x)+∇u(x)⋅V(x). Integrating both sides on domain
    Ω then gives: ∫Ω​∇⋅(u(x)V(x))dx=∫Ω​u(x)∇⋅V(x)dx+∫Ω​∇u(x)⋅V(x)dx.'
  id: totrans-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '****定义 16.3.1 (分部积分).**** 对于标量值函数 u(x) 和向量值函数（向量场）V(x)，散度的乘积法则表明：∇⋅(u(x)V(x))=u(x)∇⋅V(x)+∇u(x)⋅V(x)。然后在域
    Ω 上对两边积分给出：∫Ω ∇⋅(u(x)V(x))dx=∫Ω u(x)∇⋅V(x)dx+∫Ω ∇u(x)⋅V(x)dx.'
- en: Then if we further apply the divergence theorem on the first part of the right-hand
    side of Equation [(16.3.4)](#eq:lec16:weak_form_index_IBP), we obtain ​∫Ω0​R(X,0)Qi​(X,t)Ai​(X,t)dX=∫∂Ω0​Qi​(X,t)Pij​(X,t)Nj​(X)ds(X)−∫Ω0​Qi,j​(X,t)Pij​(X,t)dX.​(16.3.5)
    The quantity Pij​Nj​ would be specified as a boundary condition. If we let T(X,t)
    be the boundary force per unit reference area (traction) with Ti​=Pij​Nj​, then
    we can say that the conservation of momentum implies that ∀Q(⋅,t):Ω0→Rd ​∫Ω0​R(X,0)Qi​(X,t)Ai​(X,t)dX=∫∂Ω0​Qi​(X,t)Ti​(X,t)ds(X)−∫Ω0​Qi,j​(X,t)Pij​(X,t)dX.​(16.3.6)
    This is momentum conservation's weak form written in Ω0.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，如果我们进一步对方程 [(16.3.4)](#eq:lec16:weak_form_index_IBP) 右侧的第一部分应用散度定理，我们得到 ∫Ω0
    R(X,0)Qi(X,t)Ai(X,t)dX=∫∂Ω0 Qi(X,t)Pij(X,t)Nj(X)ds(X)−∫Ω0 Qi,j(X,t)Pij(X,t)dX.​(16.3.5)
    量 PijNj 将被指定为边界条件。如果我们让 T(X,t) 为单位参考面积上的边界力（牵引力），其中 Ti=PijNj，那么我们可以说动量守恒意味着对于所有
    Q(⋅,t):Ω0→Rd，∫Ω0 R(X,0)Qi(X,t)Ai(X,t)dX=∫∂Ω0 Qi(X,t)Ti(X,t)ds(X)−∫Ω0 Qi,j(X,t)Pij(X,t)dX.​(16.3.6)
    这是在 Ω0 中书写的动量守恒的弱形式。
- en: '***Remark 16.3.1 (Why Weak Form).*** In finite element method (FEM) for solids,
    conservation of momentum is formulated in the weak form rather than directly discretizing
    the strong form due to specific advantages. The strong form requires the displacement
    field and its derivatives to be continuously differentiable across the entire
    domain, which is difficult to achieve in practical scenarios involving complex
    geometries or material discontinuities. On the other hand, the weak form only
    requires the displacement field itself to be continuous, relaxing the need for
    continuous derivatives. This makes the weak form more adaptable to irregular mesh
    geometries and better suited for incorporating boundary conditions and handling
    interface problems. The weak form''s integration-based approach reduces the sensitivity
    to local irregularities, making it more stable and robust for numerical computation
    in solid mechanics. Thus, while the strong form provides a direct representation
    of physical laws, its direct discretization is less practical for the computational
    demands and complexities typical in FEM analyses.'
  id: totrans-7
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '***备注16.3.1（为什么使用弱形式）***。在固体有限元法（FEM）中，动量守恒是以弱形式表述的，而不是直接离散化强形式，这是由于特定的优势。强形式要求位移场及其导数在整个域内连续可微，这在涉及复杂几何形状或材料不连续性的实际场景中很难实现。另一方面，弱形式只要求位移场本身是连续的，放宽了对连续导数的需求。这使得弱形式更适合不规则网格几何形状，并且更适合引入边界条件和处理界面问题。基于积分的弱形式方法降低了局部不规则性的敏感性，使得它在固体力学中的数值计算更加稳定和健壮。因此，虽然强形式提供了物理定律的直接表示，但其直接离散化在有限元分析中典型的计算需求和复杂性方面不太实用。'
