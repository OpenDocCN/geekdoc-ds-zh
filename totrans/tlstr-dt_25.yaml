- en: 13  Generalized linear models
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 13  广义线性模型
- en: 原文：[https://tellingstorieswithdata.com/13-ijaglm.html](https://tellingstorieswithdata.com/13-ijaglm.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://tellingstorieswithdata.com/13-ijaglm.html](https://tellingstorieswithdata.com/13-ijaglm.html)
- en: '[Modeling](./12-ijalm.html)'
  id: totrans-2
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[建模](./12-ijalm.html)'
- en: '[13  Generalized linear models](./13-ijaglm.html)'
  id: totrans-3
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[13  广义线性模型](./13-ijaglm.html)'
- en: '*Chapman and Hall/CRC published this book in July 2023\. You can purchase that
    [here](https://www.routledge.com/Telling-Stories-with-Data-With-Applications-in-R/Alexander/p/book/9781032134772).'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '*Chapman and Hall/CRC于2023年7月出版了这本书。您可以在[这里](https://www.routledge.com/Telling-Stories-with-Data-With-Applications-in-R/Alexander/p/book/9781032134772)购买。*'
- en: This online version has some updates to what was printed. An online version
    that matches the print version is available [here](https://rohanalexander.github.io/telling_stories-published/).*  ***Prerequisites**
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 这个在线版本对印刷版进行了一些更新。与印刷版相匹配的在线版本可在[这里](https://rohanalexander.github.io/telling_stories-published/)找到。***先决条件**
- en: Read *Regression and Other Stories*, ([Gelman, Hill, and Vehtari 2020](99-references.html#ref-gelmanhillvehtari2020))
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 阅读 *Regression and Other Stories*, ([Gelman, Hill, and Vehtari 2020](99-references.html#ref-gelmanhillvehtari2020))
- en: Focus on Chapters 13 “Logistic regression” and 15 “Other generalized linear
    models”, which provide a detailed guide to generalized linear models.
  id: totrans-7
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 重点关注第13章“逻辑回归”和第15章“其他广义线性模型”，它们提供了对广义线性模型的详细指南。
- en: Read *An Introduction to Statistical Learning with Applications in R*, ([James
    et al. [2013] 2021](99-references.html#ref-islr))
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 阅读 *An Introduction to Statistical Learning with Applications in R*, ([James
    et al. [2013] 2021](99-references.html#ref-islr))
- en: Focus on Chapter 4 “Classification”, which is a complementary treatment of generalized
    linear models from a different perspective.
  id: totrans-9
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 重点关注第4章“分类”，这是从不同角度对广义线性模型的补充处理。
- en: Read *We Gave Four Good Pollsters the Same Raw Data. They Had Four Different
    Results*, ([Cohn 2016](99-references.html#ref-cohn2016))
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 阅读 *We Gave Four Good Pollsters the Same Raw Data. They Had Four Different Results*,
    ([Cohn 2016](99-references.html#ref-cohn2016))
- en: Details a situation in which different modeling choices, given the same dataset,
    result in different forecasts.
  id: totrans-11
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 详细描述了在相同数据集的情况下，不同的建模选择会导致不同的预测结果。
- en: '**Key concepts and skills**'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '**关键概念和技能**'
- en: Linear regression can be generalized for alternative types of outcome variables.
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 线性回归可以推广到其他类型的输出变量。
- en: Logistic regression can be used when we have a binary outcome variable.
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当我们有一个二元结果变量时，可以使用逻辑回归。
- en: Poisson regression can be used when we have an integer count outcome variable.
    A variant—negative binomial regression—is often also considered because the assumptions
    are less onerous.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当我们有一个整数计数结果变量时，可以使用泊松回归。一个变体——负二项回归——通常也被考虑，因为其假设条件不那么苛刻。
- en: Multilevel modeling is an approach that can allow us to make better use of our
    data.
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 多层次建模是一种可以让我们更好地利用数据的方法。
- en: '**Software and packages**'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: '**软件和包**'
- en: Base R ([R Core Team 2024](99-references.html#ref-citeR))
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基础R ([R Core Team 2024](99-references.html#ref-citeR))
- en: '`boot` ([Canty and Ripley 2021](99-references.html#ref-boot); [Davison and
    Hinkley 1997](99-references.html#ref-bootii))'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`boot` ([Canty and Ripley 2021](99-references.html#ref-boot); [Davison and
    Hinkley 1997](99-references.html#ref-bootii))'
- en: '`broom.mixed` ([Bolker and Robinson 2022](99-references.html#ref-mixedbroom))'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`broom.mixed` ([Bolker and Robinson 2022](99-references.html#ref-mixedbroom))'
- en: '`collapse` ([Krantz 2023](99-references.html#ref-collapse))'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`collapse` ([Krantz 2023](99-references.html#ref-collapse))'
- en: '`dataverse` ([Kuriwaki, Beasley, and Leeper 2023](99-references.html#ref-dataverse))'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`dataverse` ([Kuriwaki, Beasley, and Leeper 2023](99-references.html#ref-dataverse))'
- en: '`gutenbergr` ([Johnston and Robinson 2022](99-references.html#ref-gutenbergr))'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`gutenbergr` ([Johnston and Robinson 2022](99-references.html#ref-gutenbergr))'
- en: '`janitor` ([Firke 2023](99-references.html#ref-janitor))'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`janitor` ([Firke 2023](99-references.html#ref-janitor))'
- en: '`marginaleffects` ([Arel-Bundock 2023](99-references.html#ref-marginaleffects))'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`marginaleffects` ([Arel-Bundock 2023](99-references.html#ref-marginaleffects))'
- en: '`modelsummary` ([Arel-Bundock 2022](99-references.html#ref-citemodelsummary))'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`modelsummary` ([Arel-Bundock 2022](99-references.html#ref-citemodelsummary))'
- en: '`rstanarm` ([Goodrich et al. 2023](99-references.html#ref-citerstanarm))'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`rstanarm` ([Goodrich et al. 2023](99-references.html#ref-citerstanarm))'
- en: '`tidybayes` ([Kay 2022](99-references.html#ref-citetidybayes))'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`tidybayes` ([Kay 2022](99-references.html#ref-citetidybayes))'
- en: '`tidyverse` ([Wickham et al. 2019](99-references.html#ref-tidyverse))'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`tidyverse` ([Wickham et al. 2019](99-references.html#ref-tidyverse))'
- en: '`tinytable` ([Arel-Bundock 2024](99-references.html#ref-tinytable))'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`tinytable` ([Arel-Bundock 2024](99-references.html#ref-tinytable))'
- en: '[PRE0]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '*## 13.1 Introduction'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '*## 13.1 简介'
- en: Linear models, covered in [Chapter 12](12-ijalm.html), have evolved substantially
    over the past century. Francis Galton, mentioned in [Chapter 8](08-hunt.html),
    and others of his generation used linear regression in earnest in the late 1800s
    and early 1900s. Binary outcomes quickly became of interest and needed special
    treatment, leading to the development and wide adaption of logistic regression
    and similar methods in the mid-1900s ([Cramer 2003](99-references.html#ref-cramer2002origins)).
    The generalized linear model framework came into being, in a formal sense, in
    the 1970s with Nelder and Wedderburn ([1972](99-references.html#ref-nelder1972generalized)).
    Generalized linear models (GLMs) broaden the types of outcomes that are allowed.
    We still model outcomes as a linear function, but we are less constrained. The
    outcome can be anything in the exponential family, and popular choices include
    the logistic distribution and the Poisson distribution. For the sake of a completed
    story but turning to approaches that are beyond the scope of this book, a further
    generalization of GLMs is generalized additive models (GAMs) where we broaden
    the structure of the explanatory side. We still explain the outcome variable as
    an additive function of various bits and pieces, but those bits and pieces can
    be functions. This framework was proposed in the 1990s by Hastie and Tibshirani
    ([1990](99-references.html#ref-hastie1990generalized)).
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 在第12章中介绍的线性模型在过去一个世纪中已经发生了显著的变化。第8章中提到的弗朗西斯·高尔顿及其同时代人，在19世纪末和20世纪初认真使用了线性回归。二元结果很快引起了人们的兴趣，并需要特殊处理，导致逻辑回归及其类似方法在20世纪中叶得到发展和广泛应用（[Cramer
    2003](99-references.html#ref-cramer2002origins)）。广义线性模型（GLMs）扩展了允许的输出类型。我们仍然将输出建模为线性函数，但我们的约束较少。输出可以是指数族中的任何东西，常见的选择包括逻辑分布和泊松分布。为了完成一个完整的故事，但转向超出本书范围的方法，GLMs的进一步推广是广义加性模型（GAMs），其中我们扩展了解释侧的结构。我们仍然将输出变量解释为各种片段的加性函数，但这些片段可以是函数。这个框架是在20世纪90年代由Hastie和Tibshirani提出的（[1990](99-references.html#ref-hastie1990generalized)）。
- en: 'In terms of generalized linear models, in this chapter we consider logistic,
    Poisson, and negative binomial regression. But we also explore a variant that
    is relevant to both linear models and generalized linear models: multilevel modeling.
    This is when we take advantage of some type of grouping that exists within our
    dataset.'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在广义线性模型方面，本章我们考虑了逻辑回归、泊松回归和负二项回归。但我们还探索了一种与线性模型和广义线性模型都相关的变体：多层次模型。这就是当我们利用数据集中存在的某种分组时的情况。
- en: 13.2 Logistic regression
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 13.2 逻辑回归
- en: Linear regression is a useful way to better understand our data. But it assumes
    a continuous outcome variable that can take any number on the real line. We would
    like some way to use this same machinery when we cannot satisfy this condition.
    We turn to logistic and Poisson regression for binary and count outcome variables,
    respectively. They are still linear models, because the predictor variables enter
    in a linear fashion.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 线性回归是更好地理解我们数据的有用方法。但它假设一个连续的因变量，可以在实数线上取任何数值。我们希望有一种方法可以在不满足这个条件时使用相同的机制。我们转向逻辑回归和泊松回归来处理二元和计数因变量，它们仍然是线性模型，因为预测变量以线性方式进入。
- en: Logistic regression, and its close variants, are useful in a variety of settings,
    from elections ([Wang et al. 2015](99-references.html#ref-wang2015forecasting))
    through to horse racing ([Chellel 2018](99-references.html#ref-chellel2018gambler);
    [Bolton and Chapman 1986](99-references.html#ref-boltonruth)). We use logistic
    regression when the outcome variable is a binary outcome, such as 0 or 1, or “yes”
    or “no”. Although the presence of a binary outcome variable may sound limiting,
    there are a lot of circumstances in which the outcome either naturally falls into
    this situation or can be adjusted into it. For instance, win or lose, available
    or not available, support or not.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 逻辑回归及其密切的变体在各种环境中都很有用，从选举（[Wang et al. 2015](99-references.html#ref-wang2015forecasting)）到赛马（[Chellel
    2018](99-references.html#ref-chellel2018gambler)；[Bolton and Chapman 1986](99-references.html#ref-boltonruth)）。当因变量是二元结果，如0或1，或“是”或“否”时，我们使用逻辑回归。尽管二元因变量的存在可能听起来有限制，但在许多情况下，结果要么自然地落入这种情况，要么可以调整到这种情况。例如，赢或输，可用或不可用，支持或不支持。
- en: The foundation of this is the Bernoulli distribution. There is a certain probability,
    \(p\), of outcome “1” and the remainder, \(1-p\), for outcome “0”. We can use
    `rbinom()` with one trial (“size = 1”) to simulate data from the Bernoulli distribution.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 这个基础的模型是伯努利分布。结果“1”发生的概率是 \(p\)，而结果“0”的概率是 \(1-p\)。我们可以使用 `rbinom()` 函数进行一次试验（“size
    = 1”）来模拟伯努利分布的数据。
- en: '[PRE1]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '*[PRE2]*  *One reason to use logistic regression is that we will be modeling
    a probability, hence it will be bounded between 0 and 1\. With linear regression
    we may end up with values outside this. The foundation of logistic regression
    is the logit function:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE2]*  *使用逻辑回归的一个原因是我们将建模一个概率，因此它将在0和1之间有界。使用线性回归，我们可能会得到这个范围之外的值。逻辑回归的基础是logit函数：'
- en: \[ \mbox{logit}(x) = \log\left(\frac{x}{1-x}\right). \] This will transpose
    values between 0 and 1 onto the real line. For instance, `logit(0.1) = -2.2`,
    `logit(0.5) = 0`, and `logit(0.9) = 2.2` ([Figure 13.1](#fig-heyitslogit)). We
    call this the “link function”. It relates the distribution of interest in a generalized
    linear model to the machinery we use in linear models.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mbox{logit}(x) = \log\left(\frac{x}{1-x}\right). \] 这会将0到1之间的值转换到实数线上。例如，`logit(0.1)
    = -2.2`，`logit(0.5) = 0`，和 `logit(0.9) = 2.2` ([图13.1](#fig-heyitslogit))。我们称这个为“连接函数”。它将广义线性模型中感兴趣的分布与线性模型中使用的机制联系起来。
- en: '![](../Images/f5d39fc643f7992f9884d37e4e47c1e8.png)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/f5d39fc643f7992f9884d37e4e47c1e8.png)'
- en: 'Figure 13.1: Example of the logit function for values between 0 and 1'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.1：0到1之间值的logit函数示例
- en: '13.2.1 Simulated example: day or night'
  id: totrans-44
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.2.1 模拟示例：白天或夜晚
- en: To illustrate logistic regression, we will simulate data on whether it is a
    weekday or weekend, based on the number of cars on the road. We will assume that
    on weekdays the road is busier.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 为了说明逻辑回归，我们将模拟基于道路上的汽车数量是否为工作日或周末的数据。我们将假设在工作日道路上更繁忙。
- en: '[PRE3]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '*[PRE4]*  *We can use `glm()` from base R to do a quick estimation. In this
    case we will try to work out whether it is a weekday or weekend, based on the
    number of cars we can see. We are interested in estimating [Equation 13.1](#eq-logisticexample):'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE4]*  *我们可以使用基础R中的 `glm()` 函数进行快速估计。在这种情况下，我们将尝试根据我们看到的汽车数量来判断是工作日还是周末。我们感兴趣的是估计
    [方程13.1](#eq-logisticexample)：'
- en: \[ \mbox{Pr}(y_i=1) = \mbox{logit}^{-1}\left(\beta_0+\beta_1 x_i\right) \tag{13.1}\]
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \mbox{Pr}(y_i=1) = \mbox{logit}^{-1}\left(\beta_0+\beta_1 x_i\right) \tag{13.1}\]
- en: where \(y_i\) is whether it is a weekday and \(x_i\) is the number of cars on
    the road.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(y_i\) 表示是否为工作日，而 \(x_i\) 表示道路上的汽车数量。
- en: '[PRE5]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '*[PRE6]*  *The estimated coefficient on the number of cars is 0.19\. The interpretation
    of coefficients in logistic regression is more complicated than linear regression
    as they relate to changes in the log-odds of the binary outcome. For instance,
    the estimate of 0.19 is the average change in the log-odds of it being a weekday
    with observing one extra car on the road. The coefficient is positive which means
    an increase. As it is non-linear, if we want to specify a particular change, then
    this will be different for different baseline levels of the observation. That
    is, an increase of 0.19 log-odds has a larger impact when the baseline log-odds
    are 0, compared to 2.'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE6]*  *汽车数量的估计系数为0.19。逻辑回归中的系数解释比线性回归更复杂，因为它们与二元结果的log-odds变化相关。例如，0.19的估计是观察到道路上多一辆车时，工作日log-odds的平均变化。系数是正的，这意味着增加。由于它是非线性的，如果我们想要指定特定的变化，那么这将在不同的观测基线水平上有所不同。也就是说，当基线log-odds为0时，0.19
    log-odds的增加比基线log-odds为2时的影响更大。'
- en: We can translate our estimate into the probability of it being a weekday, for
    a given number of cars. We can add the implied probability that it is a weekday
    for each observation using `predictions()` from `marginaleffects`.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以将我们的估计转换为给定汽车数量的工作日概率。我们可以使用 `marginaleffects` 的 `predictions()` 函数为每个观测值添加隐含的工作日概率。
- en: '[PRE7]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '*[PRE8]*  *And we can then graph the probability that our model implies, for
    each observation, of it being a weekday ([Figure 13.2](#fig-dayornightprobs)).
    This is a nice opportunity to consider a few different ways of illustrating the
    fit. While it is common to use a scatterplot ([Figure 13.2 (a)](#fig-dayornightprobs-1)),
    this is also an opportunity to use an ECDF ([Figure 13.2 (b)](#fig-dayornightprobs-2)).'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE8]*  *然后我们可以绘制模型对每个观测值是工作日的概率图（[图13.2](#fig-dayornightprobs)）。这是一个考虑几种不同展示拟合方式的好机会。虽然使用散点图（[图13.2
    (a)](#fig-dayornightprobs-1)）是常见的，但这也是一个使用经验累积分布函数（ECDF）（[图13.2 (b)](#fig-dayornightprobs-2)）的机会。'
- en: '[PRE9]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '*![](../Images/e05a463cebe8d858d5c0232f7451d936.png)'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: '*![](../Images/e05a463cebe8d858d5c0232f7451d936.png)'
- en: (a) Illustrating the fit with a scatterplot
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: (a) 使用散点图展示拟合情况
- en: '![](../Images/f55673a973373e12b85fecb248a6cea9.png)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/f55673a973373e12b85fecb248a6cea9.png)'
- en: (b) Illustrating the fit with an ECDF
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: (b) 使用经验累积分布函数(ECDF)展示拟合情况
- en: 'Figure 13.2: Logistic regression probability results with simulated data of
    whether it is a weekday or weekend based on the number of cars that are around'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 图 13.2：基于周围车辆数量的模拟数据得到的逻辑回归概率结果
- en: The marginal effect at each observation is of interest because it provides a
    sense of how this probability is changing. It enables us to say that at the median
    (which in this case is if we were to see 50 cars) the probability of it being
    a weekday increases by almost five per cent if we were to see another car ([Table 13.1](#tbl-marginaleffectcar)).
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 每个观察的边际效应是有趣的，因为它提供了这种概率如何变化的感觉。它使我们能够说，在平均值处（在这种情况下，如果我们看到 50 辆车），如果再看到一辆车，成为工作日的概率将增加近五个百分比（[表 13.1](#tbl-marginaleffectcar)）。
- en: '[PRE10]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '*Table 13.1: Marginal effect of another car on the probability that it is a
    weekday, at the median'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: '*表 13.1：另一辆车对成为工作日概率的边际效应，在平均值处'
- en: '| Term | Estimate | Standard error |'
  id: totrans-64
  prefs: []
  type: TYPE_TB
  zh: '| 项 | 估计值 | 标准误差 |'
- en: '| --- | --- | --- |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| num_cars | 0.047 | 0.004 |*  *To more thoroughly examine the situation we
    might want to build a Bayesian model using `rstanarm`. As in [Chapter 12](12-ijalm.html)
    we will specify priors for our model, but these will just be the default priors
    that `rstanarm` uses:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '| num_cars | 0.047 | 0.004 |*  *为了更彻底地研究这种情况，我们可能想要使用 `rstanarm` 构建一个贝叶斯模型。正如在第
    12 章([12-ijalm.html](12-ijalm.html))中所述，我们将为我们的模型指定先验，但这些将只是 `rstanarm` 默认使用的先验：'
- en: \[ \begin{aligned} y_i|\pi_i & \sim \mbox{Bern}(\pi_i) \\ \mbox{logit}(\pi_i)
    & = \beta_0+\beta_1 x_i \\ \beta_0 & \sim \mbox{Normal}(0, 2.5)\\ \beta_1 & \sim
    \mbox{Normal}(0, 2.5) \end{aligned} \] where \(y_i\) is whether it is a weekday
    (actually 0 or 1), \(x_i\) is the number of cars on the road, and \(\pi_i\) is
    the probability that observation \(i\) is a weekday.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \begin{aligned} y_i|\pi_i & \sim \mbox{Bern}(\pi_i) \\ \mbox{logit}(\pi_i)
    & = \beta_0+\beta_1 x_i \\ \beta_0 & \sim \mbox{Normal}(0, 2.5)\\ \beta_1 & \sim
    \mbox{Normal}(0, 2.5) \end{aligned} \] 其中 \(y_i\) 是是否为工作日（实际上是 0 或 1），\(x_i\)
    是道路上的车辆数量，而 \(\pi_i\) 是观察 \(i\) 为工作日的概率。
- en: '[PRE11]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '*The results of our Bayesian model are similar to the quick model we built
    using base ([Table 13.2](#tbl-modelsummarylogistic)).'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '*我们贝叶斯模型的结果与我们使用基础([表 13.2](#tbl-modelsummarylogistic))构建的快速模型相似。'
- en: '[PRE12]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '*Table 13.2: Explaining whether it is day or night, based on the number of
    cars on the road'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: '*表 13.2：根据道路上的车辆数量解释白天或夜晚'
- en: '|  | Day or night |'
  id: totrans-72
  prefs: []
  type: TYPE_TB
  zh: '|  | 白天或夜晚 |'
- en: '| --- | --- |'
  id: totrans-73
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| (Intercept) | -9.464 |'
  id: totrans-74
  prefs: []
  type: TYPE_TB
  zh: '| (截距) | -9.464 |'
- en: '| number_of_cars | 0.186 |'
  id: totrans-75
  prefs: []
  type: TYPE_TB
  zh: '| number_of_cars | 0.186 |'
- en: '| Num.Obs. | 1000 |'
  id: totrans-76
  prefs: []
  type: TYPE_TB
  zh: '| Num.Obs. | 1000 |'
- en: '| R2 | 0.779 |'
  id: totrans-77
  prefs: []
  type: TYPE_TB
  zh: '| R2 | 0.779 |'
- en: '| Log.Lik. | -177.899 |'
  id: totrans-78
  prefs: []
  type: TYPE_TB
  zh: '| Log.Lik. | -177.899 |'
- en: '| ELPD | -179.8 |'
  id: totrans-79
  prefs: []
  type: TYPE_TB
  zh: '| ELPD | -179.8 |'
- en: '| ELPD s.e. | 13.9 |'
  id: totrans-80
  prefs: []
  type: TYPE_TB
  zh: '| ELPD s.e. | 13.9 |'
- en: '| LOOIC | 359.6 |'
  id: totrans-81
  prefs: []
  type: TYPE_TB
  zh: '| LOOIC | 359.6 |'
- en: '| LOOIC s.e. | 27.9 |'
  id: totrans-82
  prefs: []
  type: TYPE_TB
  zh: '| LOOIC s.e. | 27.9 |'
- en: '| WAIC | 359.6 |'
  id: totrans-83
  prefs: []
  type: TYPE_TB
  zh: '| WAIC | 359.6 |'
- en: '| RMSE | 0.24 |*  *[Table 13.2](#tbl-modelsummarylogistic) makes it clear that
    each of the approaches is similar in this case. They agree on the direction of
    the effect of seeing an extra car on the probability of it being a weekday. Even
    the magnitude of the effect is estimated to be similar.*******  ***### 13.2.2
    Political support in the United States'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: '| RMSE | 0.24 |*  *[表 13.2](#tbl-modelsummarylogistic) 清楚地表明，在这种情况下，每种方法都很相似。它们在看到额外一辆车对成为工作日概率的影响方向上达成一致。甚至估计的影响程度也相似。*******  ***###
    13.2.2 美国的政治支持'
- en: One area where logistic regression is often used is political polling. In many
    cases voting implies the need for one preference ranking, and so issues are reduced,
    whether appropriately or not, to “support” or “not support”.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 逻辑回归常用于政治民意调查领域。在许多情况下，投票意味着需要一种偏好排序，因此问题被简化，无论是否适当，都归结为“支持”或“不支持”。
- en: 'As a reminder, the workflow we advocate in this book is:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 作为提醒，本书中我们倡导的工作流程是：
- en: \[\mbox{Plan} \rightarrow \mbox{Simulate} \rightarrow \mbox{Acquire} \rightarrow
    \mbox{Explore} \rightarrow \mbox{Share}\]
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: \[\mbox{计划} \rightarrow \mbox{模拟} \rightarrow \mbox{获取} \rightarrow \mbox{探索}
    \rightarrow \mbox{分享}\]
- en: While the focus here is the exploration of data using models, we still need
    to do the other aspects. We begin by planning. In this case, we are interested
    in US political support. In particular we are interested in whether we can forecast
    who a respondent is likely to vote for, based only on knowing their highest level
    of education and gender. That means we are interested in a dataset with variables
    for who an individual voted for, and some of their characteristics, such as gender
    and education. A quick sketch of such a dataset is [Figure 13.3 (a)](#fig-uspoliticalsupportsketch).
    We would like our model to average over these points. A quick sketch is [Figure 13.3
    (b)](#fig-uspoliticalsupportmodel).
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然这里的重点是使用模型探索数据，但我们仍需要做其他方面的工作。我们首先从规划开始。在这种情况下，我们感兴趣的是美国政治支持。特别是，我们感兴趣的是是否可以根据受访者最高教育水平和性别预测他们可能会为谁投票。这意味着我们对一个包含个人投票对象及其一些特征（如性别和教育）的变量数据集感兴趣。此类数据集的快速草图是[图13.3
    (a)](#fig-uspoliticalsupportsketch)。我们希望我们的模型对这些点进行平均。快速草图是[图13.3 (b)](#fig-uspoliticalsupportmodel)。
- en: '![](../Images/47606870e19f3d58d654b4c5de3c0ad0.png)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/47606870e19f3d58d654b4c5de3c0ad0.png)'
- en: (a) Quick sketch of a dataset that could be used to examine US political support
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: (a) 用于检验美国政治支持的快速数据集草图
- en: '![](../Images/5074e2a953ed039df2d4ecbe7bef8caa.png)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/5074e2a953ed039df2d4ecbe7bef8caa.png)'
- en: (b) Quick sketch of what we expect from the analysis before finalizing either
    the data or the analysis
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: (b) 在最终确定数据或分析之前，我们期望的分析的快速草图
- en: 'Figure 13.3: Sketches of the expected dataset and analysis focus and clarify
    our thinking even if they will be updated later'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.3：预期数据集和分析的草图，即使它们稍后会被更新，也能澄清我们的思路
- en: We will simulate a dataset where the chance that a person supports Biden depends
    on their gender and education.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将模拟一个数据集，其中一个人支持拜登的概率取决于他们的性别和教育水平。
- en: '[PRE13]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '*For the actual data we can use the 2020 Cooperative Election Study (CES) ([Schaffner,
    Ansolabehere, and Luks 2021](99-references.html#ref-cooperativeelectionstudyus)).
    This is a long-standing annual survey of US political opinion. In 2020, there
    were 61,000 respondents who completed the post-election survey. The sampling methodology,
    detailed in Ansolabehere, Schaffner, and Luks ([2021, 13](99-references.html#ref-guidetothe2020ces)),
    relies on matching and is an accepted approach that balances sampling concerns
    and cost.'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: '*对于实际数据，我们可以使用2020年合作选举研究（CES）([Schaffner, Ansolabehere, and Luks 2021](99-references.html#ref-cooperativeelectionstudyus))。这是一项长期年度的美国政治意见调查。2020年，有61,000名受访者完成了选举后的调查。Ansolabehere,
    Schaffner, 和 Luks ([2021, 13](99-references.html#ref-guidetothe2020ces))中详细说明的抽样方法依赖于匹配，这是一种平衡抽样关注和成本的公认方法。'
- en: We can access the CES using `get_dataframe_by_name()` after installing and loading
    `dataverse`. This approach was introduced in [Chapter 7](07-gather.html) and [Chapter
    10](10-store_and_share.html). We save the data that are of interest to us, and
    then refer to that saved dataset.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 安装并加载`dataverse`后，我们可以使用`get_dataframe_by_name()`访问CES。这种方法在[第7章](07-gather.html)和[第10章](10-store_and_share.html)中介绍。我们保存对我们感兴趣的数据，然后引用该保存的数据集。
- en: '[PRE14]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '*[PRE15]'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE15]'
- en: '*[PRE16]'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE16]'
- en: When we look at the actual data, there are concerns that we did not anticipate
    in our sketches. We use the codebook to investigate this more thoroughly. We only
    want respondents who are registered to vote, and we are only interested in those
    that voted for either Biden or Trump. We see that when the variable “CC20_410”
    is 1, then this means the respondent supported Biden, and when it is 2 that means
    Trump. We can filter to only those respondents and then add more informative labels.
    Genders of “female” and “male” is what is available from the CES, and when the
    variable “gender” is 1, then this means “male”, and when it is 2 this means “females”.
    Finally, the codebook tells us that “educ” is a variable from 1 to 6, in increasing
    levels of education.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们查看实际数据时，我们发现了一些在草图中没有预料到的担忧。我们使用代码簿进行更彻底的调查。我们只想调查那些注册投票的受访者，并且我们只对那些为拜登或特朗普投票的人感兴趣。我们看到，当变量“CC20_410”为1时，这意味着受访者支持拜登，而当它为2时，这意味着特朗普。我们可以过滤出这些受访者，并添加更多有信息的标签。CES中可用的性别是“女性”和“男性”，当变量“gender”为1时，这意味着“男性”，而当它为2时，这意味着“女性”。最后，代码簿告诉我们，“educ”是一个从1到6的变量，代表教育水平的递增。
- en: '[PRE17]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '*In the end we are left with 43,554 respondents ([Figure 13.4](#fig-cesissogooditslikecheating)).'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '*最终，我们剩下43,554名受访者([图13.4](#fig-cesissogooditslikecheating))。'
- en: '[PRE18]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '*![](../Images/1a65322dd28d0dc6bb4d9b43fadbf31c.png)'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '*![图片](../Images/1a65322dd28d0dc6bb4d9b43fadbf31c.png)'
- en: 'Figure 13.4: The distribution of presidential preferences, by gender, and highest
    education*  *The model that we are interested in is:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.4：按性别和最高教育程度划分的总统偏好分布*  *我们感兴趣的模型是：
- en: \[ \begin{aligned} y_i|\pi_i & \sim \mbox{Bern}(\pi_i) \\ \mbox{logit}(\pi_i)
    & = \beta_0+\beta_1 \times \mbox{gender}_i + \beta_2 \times \mbox{education}_i
    \\ \beta_0 & \sim \mbox{Normal}(0, 2.5)\\ \beta_1 & \sim \mbox{Normal}(0, 2.5)\\
    \beta_2 & \sim \mbox{Normal}(0, 2.5) \end{aligned} \]
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \begin{aligned} y_i|\pi_i & \sim \mbox{Bern}(\pi_i) \\ \mbox{logit}(\pi_i)
    & = \beta_0+\beta_1 \times \mbox{gender}_i + \beta_2 \times \mbox{education}_i
    \\ \beta_0 & \sim \mbox{Normal}(0, 2.5)\\ \beta_1 & \sim \mbox{Normal}(0, 2.5)\\
    \beta_2 & \sim \mbox{Normal}(0, 2.5) \end{aligned} \]
- en: where \(y_i\) is the political preference of the respondent and equal to 1 if
    Biden and 0 if Trump, \(\mbox{gender}_i\) is the gender of the respondent, and
    \(\mbox{education}_i\) is the education of the respondent. We could estimate the
    parameters using `stan_glm()`. Note that the model is a generally accepted short-hand.
    In practice `rstanarm` converts categorical variables into a series of indicator
    variables and there are multiple coefficients estimated. In the interest of run-time
    we will randomly sample 1,000 observations and fit the model on that, rather than
    the full dataset.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(y_i\) 是受访者的政治偏好，如果拜登得票则为1，如果特朗普得票则为0，\(\mbox{gender}_i\) 是受访者的性别，\(\mbox{education}_i\)
    是受访者的教育程度。我们可以使用 `stan_glm()` 来估计参数。请注意，这个模型是一个普遍接受的简写。在实际操作中，`rstanarm` 将分类变量转换为一系列指标变量，并估计多个系数。为了节省运行时间，我们将随机抽取1,000个观测值并在此基础上拟合模型，而不是使用完整的数据集。
- en: '[PRE19]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '*[PRE20]'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE20]'
- en: '*The results of our model are interesting. They suggest males were less likely
    to vote for Biden, and that there is a considerable effect of education ([Table 13.3](#tbl-modelsummarylogisticpolitical)).'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '*我们的模型结果很有趣。它们表明男性不太可能投票给拜登，并且教育程度有相当大的影响([表13.3](#tbl-modelsummarylogisticpolitical))。'
- en: '[PRE21]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '*Table 13.3: Whether a respondent is likely to vote for Biden based on their
    gender and education'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: '*表13.3：根据性别和教育程度，受访者是否可能投票给拜登'
- en: '|  | Support Biden |'
  id: totrans-114
  prefs: []
  type: TYPE_TB
  zh: '|  | 支持拜登 |'
- en: '| --- | --- |'
  id: totrans-115
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| (Intercept) | -0.745 |'
  id: totrans-116
  prefs: []
  type: TYPE_TB
  zh: '| (Intercept) | -0.745 |'
- en: '|  | (0.517) |'
  id: totrans-117
  prefs: []
  type: TYPE_TB
  zh: '|  | (0.517) |'
- en: '| genderMale | -0.477 |'
  id: totrans-118
  prefs: []
  type: TYPE_TB
  zh: '| genderMale | -0.477 |'
- en: '|  | (0.136) |'
  id: totrans-119
  prefs: []
  type: TYPE_TB
  zh: '|  | (0.136) |'
- en: '| educationHigh school graduate | 0.617 |'
  id: totrans-120
  prefs: []
  type: TYPE_TB
  zh: '| educationHigh school graduate | 0.617 |'
- en: '|  | (0.534) |'
  id: totrans-121
  prefs: []
  type: TYPE_TB
  zh: '|  | (0.534) |'
- en: '| educationSome college | 1.494 |'
  id: totrans-122
  prefs: []
  type: TYPE_TB
  zh: '| educationSome college | 1.494 |'
- en: '|  | (0.541) |'
  id: totrans-123
  prefs: []
  type: TYPE_TB
  zh: '|  | (0.541) |'
- en: '| education2-year | 0.954 |'
  id: totrans-124
  prefs: []
  type: TYPE_TB
  zh: '| education2-year | 0.954 |'
- en: '|  | (0.538) |'
  id: totrans-125
  prefs: []
  type: TYPE_TB
  zh: '|  | (0.538) |'
- en: '| education4-year | 1.801 |'
  id: totrans-126
  prefs: []
  type: TYPE_TB
  zh: '| education4-year | 1.801 |'
- en: '|  | (0.532) |'
  id: totrans-127
  prefs: []
  type: TYPE_TB
  zh: '|  | (0.532) |'
- en: '| educationPost-grad | 1.652 |'
  id: totrans-128
  prefs: []
  type: TYPE_TB
  zh: '| educationPost-grad | 1.652 |'
- en: '|  | (0.541) |'
  id: totrans-129
  prefs: []
  type: TYPE_TB
  zh: '|  | (0.541) |'
- en: '| Num.Obs. | 1000 |'
  id: totrans-130
  prefs: []
  type: TYPE_TB
  zh: '| Num.Obs. | 1000 |'
- en: '| R2 | 0.064 |'
  id: totrans-131
  prefs: []
  type: TYPE_TB
  zh: '| R2 | 0.064 |'
- en: '| Log.Lik. | -646.335 |'
  id: totrans-132
  prefs: []
  type: TYPE_TB
  zh: '| Log.Lik. | -646.335 |'
- en: '| ELPD | -653.5 |'
  id: totrans-133
  prefs: []
  type: TYPE_TB
  zh: '| ELPD | -653.5 |'
- en: '| ELPD s.e. | 9.4 |'
  id: totrans-134
  prefs: []
  type: TYPE_TB
  zh: '| ELPD s.e. | 9.4 |'
- en: '| LOOIC | 1307.0 |'
  id: totrans-135
  prefs: []
  type: TYPE_TB
  zh: '| LOOIC | 1307.0 |'
- en: '| LOOIC s.e. | 18.8 |'
  id: totrans-136
  prefs: []
  type: TYPE_TB
  zh: '| LOOIC s.e. | 18.8 |'
- en: '| WAIC | 1307.0 |'
  id: totrans-137
  prefs: []
  type: TYPE_TB
  zh: '| WAIC | 1307.0 |'
- en: '| RMSE | 0.48 |*  *It can be useful to plot the credibility intervals of these
    predictors ([Figure 13.5](#fig-modelplotlogisticpolitical)). In particular this
    might be something that is especially useful in an appendix.'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: '| RMSE | 0.48 |*  *绘制这些预测变量的可信区间可能很有用([图13.5](#fig-modelplotlogisticpolitical))。特别是，这可能在附录中特别有用。'
- en: '[PRE22]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '*![](../Images/80b5ae52df44038377e0ab89dbe906d5.png)'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: '*![](../Images/80b5ae52df44038377e0ab89dbe906d5.png)'
- en: 'Figure 13.5: Credible intervals for predictors of support for Biden*************  ***##
    13.3 Poisson regression'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.5：支持拜登预测变量的可信区间*************  ***## 13.3 泊松回归
- en: When we have count data we should initially think to take advantage of the Poisson
    distribution. One application of Poisson regression is modeling the outcomes of
    sports. For instance Burch ([2023](99-references.html#ref-Burch2023)) builds a
    Poisson model of hockey outcomes, following Baio and Blangiardo ([2010](99-references.html#ref-Baio2010))
    who build a Poisson model of football outcomes.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们拥有计数数据时，我们最初应该考虑利用泊松分布。泊松回归的一个应用是建模体育结果。例如，Burch ([2023](99-references.html#ref-Burch2023))
    建立了冰球结果的泊松模型，遵循Baio和Blangiardo ([2010](99-references.html#ref-Baio2010)) 建立的足球结果泊松模型。
- en: 'The Poisson distribution is governed by one parameter, \(\lambda\). This distributes
    probabilities over non-negative integers and hence governs the shape of the distribution.
    As such, the Poisson distribution has the interesting feature that the mean is
    also the variance. As the mean increases, so does the variance. The Poisson probability
    mass function is ([Pitman 1993, 121](99-references.html#ref-pitman)):'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 泊松分布由一个参数\(\lambda\)控制。它将概率分布在非负整数上，因此控制分布的形状。因此，泊松分布有一个有趣的特征，即均值也是方差。随着均值的增加，方差也增加。泊松概率质量函数是（[Pitman
    1993, 121](99-references.html#ref-pitman)）：
- en: \[P_{\lambda}(k) = e^{-\lambda}\lambda^k/k!\mbox{, for }k=0,1,2,\dots\] We can
    simulate \(n=20\) draws from the Poisson distribution with `rpois()`, where \(\lambda\)
    is equal to three.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: \[P_{\lambda}(k) = e^{-\lambda}\lambda^k/k!\mbox{, for }k=0,1,2,\dots\] 我们可以使用`rpois()`从泊松分布中模拟\(n=20\)个抽取值，其中\(\lambda\)等于三。
- en: '[PRE23]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '*[PRE24]*  *We can also look at what happens to the distribution as we change
    the value of \(\lambda\) ([Figure 13.6](#fig-poissondistributiontakingshape)).'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE24]*  *我们还可以观察当改变\(\lambda\)的值时，分布会发生什么变化（[图13.6](#fig-poissondistributiontakingshape)）。'
- en: '![](../Images/25ca792a6efd972f65a47e22e52c62b4.png)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/25ca792a6efd972f65a47e22e52c62b4.png)'
- en: 'Figure 13.6: The Poisson distribution is governed by the value of the mean,
    which is the same as its variance'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.6：泊松分布由均值控制，均值的值与方差相同
- en: '13.3.1 Simulated example: number of As by department'
  id: totrans-149
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.3.1 模拟示例：按部门划分的A等成绩数量
- en: To illustrate the situation, we could simulate data about the number of As that
    are awarded in each university course. In this simulated example, we consider
    three departments, each of which has many courses. Each course will award a different
    number of As.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 为了说明这种情况，我们可以模拟关于每个大学课程授予的A等成绩数量的数据。在这个模拟示例中，我们考虑了三个部门，每个部门都有许多课程。每个课程将授予不同数量的A等成绩。
- en: '[PRE25]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '*[PRE26]'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE26]'
- en: '*![](../Images/c40c20c68bb9b28a91f64cae0f9d5171.png)'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '*![](../Images/c40c20c68bb9b28a91f64cae0f9d5171.png)'
- en: 'Figure 13.7: Simulated number of As in various classes across three departments*  *Our
    simulated dataset has the number of As awarded by courses, which are structured
    within departments ([Figure 13.7](#fig-simgradesdepartments)). In [Chapter 16](15-mrp.html),
    we will take advantage of this departmental structure, but for now we just ignore
    it and focus on differences between departments.'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.7：模拟三个部门中不同班级的A等成绩数量*  *我们的模拟数据集包含了课程授予的A等成绩数量，这些课程在部门内结构化（[图13.7](#fig-simgradesdepartments)）。在[第16章](15-mrp.html)中，我们将利用这种部门结构，但现在我们只是忽略它，专注于部门间的差异。
- en: 'The model that we are interested in estimating is:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 我们感兴趣要估计的模型是：
- en: \[ \begin{aligned} y_i|\lambda_i &\sim \mbox{Poisson}(\lambda_i)\\ \log(\lambda_i)
    & = \beta_0 + \beta_1 \times \mbox{department}_i \end{aligned} \] where \(y_i\)
    is the number of A grades awarded, and we are interested in how this differs by
    department.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \begin{aligned} y_i|\lambda_i &\sim \mbox{Poisson}(\lambda_i)\\ \log(\lambda_i)
    & = \beta_0 + \beta_1 \times \mbox{department}_i \end{aligned} \] 其中\(y_i\)是授予的A等成绩数量，我们感兴趣的是它如何因部门而异。
- en: We can use `glm()` from base R to get a quick sense of the data. This function
    is quite general, and we specify Poisson regression by setting the “family” parameter.
    The estimates are contained in the first column of [Table 13.4](#tbl-modelsummarypoisson).
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用R的基础函数`glm()`来快速了解数据。这个函数相当通用，我们通过设置“family”参数来指定泊松回归。估计值包含在[表13.4](#tbl-modelsummarypoisson)的第一列中。
- en: '[PRE27]'
  id: totrans-158
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: '*[PRE28]*  *As with logistic regression, the interpretation of the coefficients
    from Poisson regression can be difficult. The interpretation of the coefficient
    on “department2” is that it is the log of the expected difference between departments.
    We expect \(e^{0.883} \approx 2.4\) and \(e^{1.703} \approx 5.5\) as many A grades
    in departments 2 and 3, respectively, compared with department 1 ([Table 13.4](#tbl-modelsummarypoisson)).'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE28]*  *与逻辑回归类似，泊松回归系数的解释可能很困难。对于“department2”系数的解释是，它是部门间预期差异的对数。我们预计
    \(e^{0.883} \approx 2.4\) 和 \(e^{1.703} \approx 5.5\)，与部门1相比，部门2和部门3分别有这么多A等成绩（[表13.4](#tbl-modelsummarypoisson)）。'
- en: We could build a Bayesian model and estimate it with `rstanarm` ([Table 13.4](#tbl-modelsummarypoisson)).
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以构建一个贝叶斯模型，并用`rstanarm`对其进行估计（[表13.4](#tbl-modelsummarypoisson)）。
- en: \[ \begin{aligned} y_i|\lambda_i &\sim \mbox{Poisson}(\lambda_i)\\ \log(\lambda_i)
    & = \beta_0 + \beta_1 \times\mbox{department}_i\\ \beta_0 & \sim \mbox{Normal}(0,
    2.5)\\ \beta_1 & \sim \mbox{Normal}(0, 2.5) \end{aligned} \] where \(y_i\) is
    the number of As awarded.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \begin{aligned} y_i|\lambda_i &\sim \mbox{Poisson}(\lambda_i)\\ \log(\lambda_i)
    & = \beta_0 + \beta_1 \times\mbox{department}_i\\ \beta_0 & \sim \mbox{Normal}(0,
    2.5)\\ \beta_1 & \sim \mbox{Normal}(0, 2.5) \end{aligned} \] 其中 \(y_i\) 是授予A的数量。
- en: '[PRE29]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: '*The results are in [Table 13.4](#tbl-modelsummarypoisson).'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '*结果见[表13.4](#tbl-modelsummarypoisson)*。'
- en: '[PRE30]'
  id: totrans-164
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '*Table 13.4: Examining the number of A grades given in different departments'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: '*表13.4：检查不同部门授予A的数量'
- en: '|  | Number of As |'
  id: totrans-166
  prefs: []
  type: TYPE_TB
  zh: '|  | 数量A |'
- en: '| --- | --- |'
  id: totrans-167
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| (Intercept) | 1.321 |'
  id: totrans-168
  prefs: []
  type: TYPE_TB
  zh: '| (Intercept) | 1.321 |'
- en: '| department2 | 0.884 |'
  id: totrans-169
  prefs: []
  type: TYPE_TB
  zh: '| department2 | 0.884 |'
- en: '| department3 | 1.706 |'
  id: totrans-170
  prefs: []
  type: TYPE_TB
  zh: '| department3 | 1.706 |'
- en: '| Num.Obs. | 78 |'
  id: totrans-171
  prefs: []
  type: TYPE_TB
  zh: '| Num.Obs. | 78 |'
- en: '| Log.Lik. | -193.355 |'
  id: totrans-172
  prefs: []
  type: TYPE_TB
  zh: '| Log.Lik. | -193.355 |'
- en: '| ELPD | -196.2 |'
  id: totrans-173
  prefs: []
  type: TYPE_TB
  zh: '| ELPD | -196.2 |'
- en: '| ELPD s.e. | 7.7 |'
  id: totrans-174
  prefs: []
  type: TYPE_TB
  zh: '| ELPD s.e. | 7.7 |'
- en: '| LOOIC | 392.4 |'
  id: totrans-175
  prefs: []
  type: TYPE_TB
  zh: '| LOOIC | 392.4 |'
- en: '| LOOIC s.e. | 15.4 |'
  id: totrans-176
  prefs: []
  type: TYPE_TB
  zh: '| LOOIC s.e. | 15.4 |'
- en: '| WAIC | 392.4 |'
  id: totrans-177
  prefs: []
  type: TYPE_TB
  zh: '| WAIC | 392.4 |'
- en: '| RMSE | 3.41 |*  *As with logistic regression, we can use `slopes()` from
    `marginaleffects` to help with interpreting these results. It may be useful to
    consider how we expect the number of A grades to change as we go from one department
    to another. [Table 13.5](#tbl-marginaleffectspoisson) suggests that in our dataset,
    classes in Department 2 tend to have around five additional A grades, compared
    with Department 1, and that classes in Department 3 tend to have around 17 more
    A grades, compared with Department 1.'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: '*与逻辑回归一样，我们可以使用`marginaleffects`中的`slopes()`来帮助解释这些结果。考虑我们如何期望从一个部门到另一个部门A的数量如何变化可能是有用的。[表13.5](#tbl-marginaleffectspoisson)表明，在我们的数据集中，2号部门的班级通常比1号部门多五个A，而3号部门的班级通常比1号部门多17个A。'
- en: '[PRE31]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: '*Table 13.5: The estimated difference in the number of A grades awarded at
    each department'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: '*表13.5：每个部门授予A的数量估计差异'
- en: '| Compare department | Estimate | 2.5% | 97.5% |'
  id: totrans-181
  prefs: []
  type: TYPE_TB
  zh: '| 比较部门 | 估计 | 2.5% | 97.5% |'
- en: '| --- | --- | --- | --- |'
  id: totrans-182
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| 2 - 1 | 5.32 | 4.01 | 6.7 |'
  id: totrans-183
  prefs: []
  type: TYPE_TB
  zh: '| 2 - 1 | 5.32 | 4.01 | 6.7 |'
- en: '| 3 - 1 | 16.92 | 15.1 | 18.84 |******  ***### 13.3.2 Letters used in *Jane
    Eyre*'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: '| 3 - 1 | 16.92 | 15.1 | 18.84 |******  ***### 13.3.2 《简·爱》中使用的字母'
- en: In an earlier age, Edgeworth ([1885](99-references.html#ref-edgeworth1885methods))
    made counts of the dactyls in Virgil’s *Aeneid* (Stigler ([1978, 301](99-references.html#ref-Stigler1978))
    provides helpful background and the dataset is available using `Dactyl` from `HistData`
    ([Friendly 2021](99-references.html#ref-HistData))). Inspired by this we could
    use `gutenbergr` to get the text of *Jane Eyre* by Charlotte Brontë. (Recall that
    in [Chapter 7](07-gather.html) we converted PDFs of *Jane Eyre* into a dataset.)
    We could then consider the first ten lines of each chapter, count the number of
    words, and count the number of times either “E” or “e” appears. We are interested
    to see whether the number of e/Es increases as more words are used. If not, it
    could suggest that the distribution of e/Es is not consistent, which could be
    of interest to linguists.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 在较早的年代，埃奇沃斯([1885](99-references.html#ref-edgeworth1885methods))对维吉尔的作品《埃涅阿斯纪》中的跖骨进行了计数（Stigler
    ([1978, 301](99-references.html#ref-Stigler1978))提供了有用的背景信息，数据集可通过`Dactyl`从`HistData`获取（[Friendly
    2021](99-references.html#ref-HistData))). 受此启发，我们可以使用`gutenbergr`获取夏洛特·勃朗特的《简·爱》的文本。
    (回想一下，在[第7章](07-gather.html)中，我们将《简·爱》的PDF转换为数据集。) 然后，我们可以考虑每章的前十行，计算单词数，并计算“E”或“e”出现的次数。我们想看看随着单词数量的增加，e/Es的数量是否会增加。如果不增加，这可能表明e/Es的分布不一致，这可能对语言学家来说很有趣。
- en: Following the workflow advocated in this book, we first sketch our dataset and
    model. A quick sketch of what the dataset could look like is [Figure 13.12 (a)](#fig-letterssketch),
    and a quick sketch of our model is [Figure 13.12 (b)](#fig-lettersmodel).
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 按照本书倡导的工作流程，我们首先绘制我们的数据集和模型草图。数据集可能的样子快速草图见[图13.12 (a)](#fig-letterssketch)，我们模型的快速草图见[图13.12
    (b)](#fig-lettersmodel)。
- en: '![](../Images/436d9c367f7e4accbb32d62d4f5bb950.png)'
  id: totrans-187
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/436d9c367f7e4accbb32d62d4f5bb950.png)'
- en: (a) Planned counts, by line and chapter, in *Jane Eyre*
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: (a) 《简·爱》中按行和章节计划的计数
- en: '![](../Images/24fb289538534259885d2c7aaa6a7876.png)'
  id: totrans-189
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/24fb289538534259885d2c7aaa6a7876.png)'
- en: (b) Expected relationship between count of e/Es and number of words in the line
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: (b) e/Es的计数与行中单词数之间的预期关系
- en: 'Figure 13.8: Sketches of the expected dataset and analysis force us to consider
    what we are interested in'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.8：预期数据集和分析草图迫使我们考虑我们感兴趣的内容
- en: We simulate a dataset of how the number of e/Es could be distributed following
    the Poisson distribution ([Figure 13.9](#fig-simenum)).
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 我们模拟了一个遵循泊松分布的 e/Es 数量的数据集([图 13.9](#fig-simenum))。
- en: '[PRE32]'
  id: totrans-193
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: '*![](../Images/8375100b284bbd8393b31e298ab42171.png)'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: '*![](../Images/8375100b284bbd8393b31e298ab42171.png)'
- en: 'Figure 13.9: Simulated counts of e/Es*  *We can now gather and prepare our
    data. We download the text of the book from Project Gutenberg using `gutenberg_download()`
    from `gutenbergr`.'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 图 13.9：模拟的 e/Es 计数*  *我们现在可以收集和准备我们的数据。我们使用 `gutenberg_download()` 从 `gutenbergr`
    下载书籍的文本。
- en: '[PRE33]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: '*We will download it and then use our local copy to avoid overly imposing on
    the Project Gutenberg servers.'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: '*我们将下载它，然后使用我们的本地副本以避免过度占用 Project Gutenberg 服务器。'
- en: '[PRE34]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: '*[PRE35]'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE35]'
- en: We are interested in only those lines that have content, so we remove those
    empty lines that are just there for spacing. Then we can create counts of the
    number of e/Es in that line, for the first ten lines of each chapter. For instance,
    we can look at the first few lines and see that there are five e/Es in the first
    line and eight in the second.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 我们只对有内容的行感兴趣，因此我们移除了那些仅用于间隔的空行。然后我们可以创建每章前十行中 e/Es 数量的计数。例如，我们可以查看前几行，看到第一行有五个
    e/Es，第二行有八个。
- en: '[PRE36]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: '*[PRE37]'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE37]'
- en: '*[PRE38]*  *We can verify that the mean and variance of the number of e/Es
    is roughly similar by plotting all of the data ([Figure 13.10](#fig-janeecounts)).
    The mean, in pink, is 6.7, and the variance, in blue, is 6.2\. While they are
    not entirely the same, they are similar. We include the diagonal in [Figure 13.10
    (b)](#fig-janeecounts-2) to help with thinking about the data. If the data were
    on the \(y=x\) line, then on average there would be one e/E per word. Given the
    mass of points below that line expect that on average there is less than one per
    word.'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE38]*  *我们可以通过绘制所有数据([图 13.10](#fig-janeecounts))来验证 e/Es 数量的平均值和方差大致相似。平均值，用粉色表示，为
    6.7，方差，用蓝色表示，为 6.2。虽然它们并不完全相同，但它们是相似的。我们在[图 13.10 (b)](#fig-janeecounts-2)中包含了对角线，以帮助思考数据。如果数据在
    \(y=x\) 线上，那么平均每词会有一个 e/E。考虑到那条线以下的点群，我们预计平均每词少于一个。'
- en: '[PRE39]'
  id: totrans-204
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: '*![](../Images/d365b52ccb37988b7d289188e7fdd605.png)'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: '*![](../Images/d365b52ccb37988b7d289188e7fdd605.png)'
- en: (a) Distribution of the number of e/Es
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: (a) e/Es 数量的分布
- en: '![](../Images/70bde923d9bd1f0793291e3c7201272a.png)'
  id: totrans-207
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/70bde923d9bd1f0793291e3c7201272a.png)'
- en: (b) Comparison of the number of e/Es in the line and the number of words in
    the line
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: (b) 行中 e/Es 数量与行中单词数量的比较
- en: 'Figure 13.10: Number of e/Es letters in the first ten lines of each chapter
    in Jane Eyre'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 图 13.10：简·爱各章节前十行中 e/Es 字母的数量
- en: 'We could consider the following model:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以考虑以下模型：
- en: \[ \begin{aligned} y_i|\lambda_i &\sim \mbox{Poisson}(\lambda_i)\\ \log(\lambda_i)
    & = \beta_0 + \beta_1 \times \mbox{Number of words}_i\\ \beta_0 & \sim \mbox{Normal}(0,
    2.5)\\ \beta_1 & \sim \mbox{Normal}(0, 2.5) \end{aligned} \] where \(y_i\) is
    the number of e/Es in the line and the explanatory variable is the number of words
    in the line. We could estimate the model using `stan_glm()`.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \begin{aligned} y_i|\lambda_i &\sim \mbox{Poisson}(\lambda_i)\\ \log(\lambda_i)
    & = \beta_0 + \beta_1 \times \mbox{Number of words}_i\\ \beta_0 & \sim \mbox{Normal}(0,
    2.5)\\ \beta_1 & \sim \mbox{Normal}(0, 2.5) \end{aligned} \] 其中 \(y_i\) 是行中的 e/Es
    数量，解释变量是该行中的单词数量。我们可以使用 `stan_glm()` 来估计模型。
- en: '[PRE40]'
  id: totrans-212
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: '*While we would normally be interested in the table of estimates, as we have
    seen that a few times now, rather than again creating a table of the estimates,
    we introduce `plot_cap()` from `marginaleffects`. We can use this to show the
    number of e/Es predicted by the model, for each line, based on the number of words
    in that line. [Figure 13.11](#fig-predictionsjaneecounts) makes it clear that
    we expect a positive relationship.'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: '*虽然我们通常会对估计表感兴趣，正如我们现在已经看到的那样，而不是再次创建一个估计表，我们引入了来自 `marginaleffects` 的 `plot_cap()`。我们可以使用它来显示模型预测的每行
    e/Es 数量，基于该行的单词数量。[图 13.11](#fig-predictionsjaneecounts) 清楚地表明我们期望存在正相关关系。'
- en: '[PRE41]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: '*![](../Images/7daece35a861e879fa4040d102858ef0.png)'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: '*![](../Images/7daece35a861e879fa4040d102858ef0.png)'
- en: 'Figure 13.11: The predicted number of e/Es in each line based on the number
    of words************  ***## 13.4 Negative binomial regression'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 图 13.11：根据每行单词数量预测的每行 e/Es 的数量************  ***## 13.4 负二项式回归
- en: One of the restrictions with Poisson regression is the assumption that the mean
    and the variance are the same. We can relax this assumption to allow over-dispersion
    by using a close variant, negative binomial regression.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: Poisson回归的一个限制是假设均值和方差相同。我们可以通过使用一个近似的变体，即负二项式回归，来放宽这个假设，允许过度分散。
- en: 'Poisson and negative binomial models go hand in hand. It is often the case
    that we will end up fitting both, and then comparing them. For instance:'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: Poisson和负二项式模型相辅相成。我们通常都会拟合这两种模型，然后进行比较。例如：
- en: Maher ([1982](99-references.html#ref-maher1982modelling)) considers both in
    the context of results from the English Football League and discusses situations
    in which one may be considered more appropriate than the other.
  id: totrans-219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Maher ([1982](99-references.html#ref-maher1982modelling)) 在英格兰足球联赛的结果背景下考虑了这两种情况，并讨论了在某些情况下一种可能比另一种更合适的情况。
- en: Smith ([2002](99-references.html#ref-thanksleo)) considers the 2000 US presidential
    election and especially the issue of overdispersion in a Poisson analysis.
  id: totrans-220
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Smith ([2002](99-references.html#ref-thanksleo)) 考虑了2000年美国总统选举，特别是Poisson分析中的过度分散问题。
- en: Osgood ([2000](99-references.html#ref-Osgood2000)) compares them in the case
    of crime data.
  id: totrans-221
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Osgood ([2000](99-references.html#ref-Osgood2000)) 在犯罪数据的案例中比较了它们。
- en: 13.4.1 Mortality in Alberta, Canada
  id: totrans-222
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.4.1 加拿大艾伯塔省的死亡率
- en: Consider, somewhat morbidly, that every year each individual either dies or
    does not. From the perspective of a geographic area, we could gather data on the
    number of people who died each year, by their cause of death. The Canadian province
    of Alberta has made [available](https://open.alberta.ca/opendata/leading-causes-of-death)
    the number of deaths, by cause, since 2001, for the top 30 causes each year.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑到有些许病态，每年每个人要么死亡，要么没有。从地理区域的视角来看，我们可以收集每年死亡人数及其死因的数据。加拿大艾伯塔省已将自2001年以来每年前30位死因的死亡人数数据[公布](https://open.alberta.ca/opendata/leading-causes-of-death)。
- en: As always we first sketch our dataset and model. A quick sketch of what the
    dataset could look like is [Figure 13.12 (a)](#fig-albertadatasketch), and a quick
    sketch of our model is [Figure 13.12 (b)](#fig-albertamodelsketch)
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 如往常一样，我们首先绘制我们的数据集和模型草图。数据集可能的快速草图是[图13.12 (a)](#fig-albertadatasketch)，我们模型的快速草图是[图13.12
    (b)](#fig-albertamodelsketch)
- en: '![](../Images/1519d91972744065af259ab9e88bd9d0.png)'
  id: totrans-225
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1519d91972744065af259ab9e88bd9d0.png)'
- en: (a) Quick sketch of a dataset that could be used to examine cause of death in
    Alberta
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: (a) 用于检查艾伯塔省死亡原因的潜在数据集的快速草图
- en: '![](../Images/b03ac43ca4ed8abc0c6869a700b7fde4.png)'
  id: totrans-227
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b03ac43ca4ed8abc0c6869a700b7fde4.png)'
- en: (b) Quick sketch of what we expect from the analysis of cause of death in Alberta
    before finalizing either the data or the analysis
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: (b) 在最终确定数据或分析之前，对艾伯塔省死亡原因分析的快速概述
- en: 'Figure 13.12: Sketches of the expected dataset and analysis for cause of death
    in Alberta'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.12：艾伯塔省死亡原因预期数据集和分析的草图
- en: We will simulate a dataset of cause of death distributed following the negative
    binomial distribution.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将模拟一个死亡原因遵循负二项式分布的数据集。
- en: '[PRE42]'
  id: totrans-231
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: '*[PRE43]*  *We can look at the distribution of these deaths, by year and cause
    ([Figure 13.13](#fig-albertacod)). We have truncated the full cause of death because
    some are quite long. As some causes are not always in the top 30 each year, not
    all causes have the same number of occurrences.'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE43]*  *我们可以查看这些死亡人数的分布，按年份和死因([图13.13](#fig-albertacod))。我们截断了完整的死因，因为有些死因相当长。由于某些死因并非每年都出现在前30位，因此并非所有死因都有相同的发生次数。'
- en: '[PRE44]'
  id: totrans-233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: '*If we were to look at the top-ten causes in 2021, we would notice a variety
    of interesting aspects ([Table 13.6](#tbl-albertahuh)). For instance, we would
    expect that the most common causes would be present in all 21 years of our data.
    But we notice that the most common cause, “Other ill-defined and unknown causes
    of mortality”, is only in three years. “COVID-19, virus identified”, is only in
    two other years, as there were no known COVID deaths in Canada before 2020.'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: '*如果我们观察2021年的前十位死因，我们会注意到一些有趣的现象([表13.6](#tbl-albertahuh))。例如，我们预计最常见的死因会在我们21年的数据中都有出现。但我们会发现最常见的死因，“其他未定义和未知死亡原因”，只在三年中出现。“COVID-19，已识别病毒”，在另外两年中也有出现，因为在2020年之前加拿大没有已知的COVID死亡病例。'
- en: '[PRE45]'
  id: totrans-235
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: '*Table 13.6: Top-ten causes of death in Alberta in 2021'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: '*表13.6：2021年艾伯塔省前十位死因'
- en: '| Year | Cause | Ranking | Deaths | Years |'
  id: totrans-237
  prefs: []
  type: TYPE_TB
  zh: '| 年份 | 原因 | 排名 | 死亡人数 | 年份 |'
- en: '| --- | --- | --- | --- | --- |'
  id: totrans-238
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- |'
- en: '| 2,021 | Other ill-defined and unkno... | 1 | 3,362 | 3 |'
  id: totrans-239
  prefs: []
  type: TYPE_TB
  zh: '| 2,021 | 其他未定义和未知... | 1 | 3,362 | 3 |'
- en: '| 2,021 | Organic dementia | 2 | 2,135 | 21 |'
  id: totrans-240
  prefs: []
  type: TYPE_TB
  zh: '| 2,021 | 有机性痴呆 | 2 | 2,135 | 21 |'
- en: '| 2,021 | COVID-19, virus identified | 3 | 1,950 | 2 |'
  id: totrans-241
  prefs: []
  type: TYPE_TB
  zh: '| 2,021 | 已识别的COVID-19病毒 | 3 | 1,950 | 2 |'
- en: '| 2,021 | All other forms of chronic ... | 4 | 1,939 | 21 |'
  id: totrans-242
  prefs: []
  type: TYPE_TB
  zh: '| 2,021 | 所有其他形式的慢性... | 4 | 1,939 | 21 |'
- en: '| 2,021 | Malignant neoplasms of trac... | 5 | 1,552 | 21 |'
  id: totrans-243
  prefs: []
  type: TYPE_TB
  zh: '| 2,021 | 恶性肿瘤... | 5 | 1,552 | 21 |'
- en: '| 2,021 | Acute myocardial infarction | 6 | 1,075 | 21 |'
  id: totrans-244
  prefs: []
  type: TYPE_TB
  zh: '| 2,021 | 急性心肌梗死 | 6 | 1,075 | 21 |'
- en: '| 2,021 | Other chronic obstructive p... | 7 | 1,028 | 21 |'
  id: totrans-245
  prefs: []
  type: TYPE_TB
  zh: '| 2,021 | 其他慢性阻塞性肺... | 7 | 1,028 | 21 |'
- en: '| 2,021 | Diabetes mellitus | 8 | 728 | 21 |'
  id: totrans-246
  prefs: []
  type: TYPE_TB
  zh: '| 2,021 | 糖尿病 | 8 | 728 | 21 |'
- en: '| 2,021 | Stroke, not specified as he... | 9 | 612 | 21 |'
  id: totrans-247
  prefs: []
  type: TYPE_TB
  zh: '| 2,021 | 梗死，未指定他... | 9 | 612 | 21 |'
- en: '| 2,021 | Accidental poisoning by and... | 10 | 604 | 9 |*  *For simplicity
    we restrict ourselves to the five most common causes of death in 2021 of those
    that have been present every year.'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: '| 2,021 | 由...引起的意外中毒 | 10 | 604 | 9 |*  *为了简化，我们只关注每年都存在的2021年最常见的五种死亡原因。'
- en: '[PRE46]'
  id: totrans-249
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: '*[PRE47]'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE47]'
- en: '*![](../Images/d92459691acc3ba41750d6e97e6281a5.png)'
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: '*![](../Images/d92459691acc3ba41750d6e97e6281a5.png)'
- en: 'Figure 13.13: Annual number of deaths for the top-five causes in 2021, since
    2001, for Alberta, Canada*  *One thing that we notice is that the mean, 1,273,
    is different to the variance, 182,378 ([Table 13.7](#tbl-ohboyalberta)).'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.13：自2001年以来，加拿大阿尔伯塔省前五大死亡原因的年度死亡人数*  *我们注意到，平均值1,273与方差182,378([表13.7](#tbl-ohboyalberta))不同。
- en: 'Table 13.7: Summary statistics of the number of yearly deaths, by cause, in
    Alberta, Canada'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 表13.7：加拿大阿尔伯塔省按原因汇总的年度死亡人数统计
- en: '|  | Min | Mean | Max | SD | Var | N |'
  id: totrans-254
  prefs: []
  type: TYPE_TB
  zh: '|  | 最小值 | 平均值 | 最大值 | 标准差 | 方差 | N |'
- en: '| --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-255
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- |'
- en: '| total_deaths | 280 | 1273 | 2135 | 427 | 182378 | 105 |'
  id: totrans-256
  prefs: []
  type: TYPE_TB
  zh: '| total_deaths | 280 | 1273 | 2135 | 427 | 182378 | 105 |'
- en: We can implement negative binomial regression when using `stan_glm()` by specifying
    the negative binomial distribution in “family”. In this case, we run both Poisson
    and negative binomial.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`stan_glm()`时，我们可以通过在“family”中指定负二项式分布来实现负二项式回归。在这种情况下，我们运行了泊松和负二项式两种模型。
- en: '[PRE48]'
  id: totrans-258
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: '*We can compare our different models ([Table 13.8](#tbl-modelsummarypoissonvsnegbinomial)).'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: '*我们可以比较我们的不同模型([表13.8](#tbl-modelsummarypoissonvsnegbinomial))。'
- en: 'Table 13.8: Modeling the most prevalent cause of deaths in Alberta, 2001-2020'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 表13.8：2001-2020年阿尔伯塔省最常见的死亡原因建模
- en: '[PRE49]'
  id: totrans-261
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: '*The estimates are similar. We could use posterior predictive checks, introduced
    in [Section 12.4](12-ijalm.html#sec-inferencewithbayesianmethods), to show that
    the negative binomial approach is a better choice for this circumstance ([Figure 13.14](#fig-ppcheckpoissonvsbinomial)).'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: '*估计值相似。我们可以使用在[第12.4节](12-ijalm.html#sec-inferencewithbayesianmethods)中介绍的后续预测检验来表明，对于这种情况，负二项式方法是一个更好的选择([图13.14](#fig-ppcheckpoissonvsbinomial))。'
- en: '[PRE50]'
  id: totrans-263
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: '*![](../Images/c121da9512b39af25165e1e4adfb5872.png)'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: '*![](../Images/c121da9512b39af25165e1e4adfb5872.png)'
- en: (a) Poisson model
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: (a) 泊松模型
- en: '![](../Images/483256ef3d786f9cf71aad6741c45f1e.png)'
  id: totrans-266
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/483256ef3d786f9cf71aad6741c45f1e.png)'
- en: (b) Negative binomial model
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: (b) 负二项式模型
- en: 'Figure 13.14: Comparing posterior prediction checks for Poisson and negative
    binomial models'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.14：比较泊松和负二项式模型的后验预测检验
- en: Finally, we can compare between the models using the resampling method leave-one-out
    (LOO) cross-validation (CV). This is a variant of cross-validation, where the
    size of each fold is one. That is to say, if there was a dataset with 100 observations,
    this LOO is equivalent to 100-fold cross validation. We can implement this in
    `rstanarm` with `loo()` for each model, and then compare between them with `loo_compare()`
    where the higher the better.[¹](#fn1)
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们可以使用留一法交叉验证（LOO CV）来比较模型。这是交叉验证的一种变体，其中每个折叠的大小为1。也就是说，如果有一个包含100个观测值的数据库，这种LOO就相当于100次交叉验证。我们可以在`rstanarm`中使用`loo()`为每个模型实现这一点，然后使用`loo_compare()`进行比较，其中数值越高越好。[¹](#fn1)
- en: We provide more information on cross-validation in [Online Appendix 14](13-prediction.html).
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在[在线附录14](13-prediction.html)中提供了关于交叉验证的更多信息。
- en: '[PRE51]'
  id: totrans-271
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: '*[PRE52]*  *In this case we find that the negative binomial model is a better
    fit than the Poisson, because ELPD is larger.*********  ***## 13.5 Multilevel
    modeling'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE52]*  *在这种情况下，我们发现负二项式模型比泊松模型更适合，因为ELPD更大。*********  ***## 13.5 多层建模'
- en: Multilevel modeling goes by a variety of names including “hierarchical”, and
    “random effects”. While there are sometimes small differences in meaning between
    disciplines, in general they refer to the same or at least similar ideas. The
    fundamental insight of multilevel modeling is that a lot of the time our observations
    are not completely independent of each other, and can instead be grouped. Accounting
    for that grouping when we model, can provide us with some useful information.
    For instance, there is a difference in the earnings of professional athletes depending
    on whether they compete in men’s or women’s events. If we were interested in trying
    to forecast the earnings of a particular athlete, based on their competition results,
    then knowing which type of competition the individual competed in would enable
    the model to make a better forecast.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 多层模型有多种名称，包括“分层”和“随机效应”。虽然不同学科之间有时在含义上存在细微差别，但通常它们指的是相同或至少相似的概念。多层模型的基本洞察是，我们的观察结果往往并不是完全相互独立的，而是可以分组的。在建模时考虑到这种分组，可以为我们提供一些有用的信息。例如，专业运动员的收益因他们参加的是男子还是女子比赛而有所不同。如果我们对尝试根据运动员的比赛结果预测特定运动员的收益感兴趣，那么知道该个人参加的是哪种类型的比赛将使模型能够做出更好的预测。
- en: '*Shoulders of giants* *Dr Fiona Steele is a Professor of Statistics at the
    London School of Economics (LSE). After earning a PhD in Statistics from University
    of Southampton in 1996, she was appointed as a Lecturer at the LSE, before moving
    to the University of London, and the University of Bristol where she was appointed
    a full professor in 2008\. She returned to the LSE in 2013\. One area of her research
    is multilevel modeling and applications in demography, education, family psychology,
    and health. For instance, Steele ([2007](99-references.html#ref-Steele2007)) looks
    at multilevel models for longitudinal data, and Steele, Vignoles, and Jenkins
    ([2007](99-references.html#ref-Steele2007again)) uses a multilevel model to look
    at the relationship between school resources and pupil attainment. She was awarded
    the Royal Statistical Society Guy Medal in Bronze in 2008.*  *We distinguish between
    three settings:'
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: '*巨人的肩膀* *菲奥娜·斯蒂尔博士是伦敦政治经济学院（LSE）的统计学教授。1996年从南安普顿大学获得统计学博士学位后，她被任命为LSE的讲师，之后前往伦敦大学和布里斯托尔大学，2008年被任命为全职教授。2013年她回到了LSE。她研究的一个领域是多层模型及其在人口统计学、教育、家庭心理学和健康中的应用。例如，Steele
    ([2007](99-references.html#ref-Steele2007)) 研究纵向数据的多层模型，而Steele, Vignoles, 和 Jenkins
    ([2007](99-references.html#ref-Steele2007again)) 使用多层模型来研究学校资源与学生成绩之间的关系。她在2008年获得了皇家统计学会的铜质盖伊奖章。*
    *我们区分三种设置：'
- en: Complete pooling, where we treat every observation as being from the same group,
    which is what we have been doing to this point.
  id: totrans-275
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完全混合，即我们将每个观察结果视为来自同一组，这是我们迄今为止所做的方法。
- en: No pooling, where we treat every group separately, which might happen if we
    were to run a separate regression for each group.
  id: totrans-276
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 不混合，即我们单独处理每个组，这可能发生在我们为每个组运行单独回归的情况下。
- en: Partial pooling, where we allow group membership to have some influence.
  id: totrans-277
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 部分混合，即我们允许组别成员有一些影响。
- en: For instance, consider we are interested in the relationship between GDP and
    inflation for each of the countries in the world. Complete pooling would have
    us put all the countries into the one group; no pooling would have us run separate
    regressions for each continent. We will now illustrate the partial pooling approach.
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，假设我们感兴趣的是世界上每个国家GDP与通货膨胀之间的关系。完全混合将使我们把所有国家放入一个组；不混合将使我们为每个大陆运行单独的回归。现在我们将说明部分混合方法。
- en: 'In general there are two ways to go about this:'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 通常有两种方法可以做到这一点：
- en: enable varying intercepts, or
  id: totrans-280
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 允许截距变化，或
- en: enable varying slopes.
  id: totrans-281
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 允许斜率变化。
- en: In this book we consider only the first, but you should move onto Gelman, Hill,
    and Vehtari ([2020](99-references.html#ref-gelmanhillvehtari2020)), McElreath
    ([[2015] 2020](99-references.html#ref-citemcelreath)), and Johnson, Ott, and Dogucu
    ([2022](99-references.html#ref-bayesrules)).
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 在这本书中，我们只考虑第一种，但你应该转向Gelman, Hill, 和 Vehtari ([2020](99-references.html#ref-gelmanhillvehtari2020))，McElreath
    ([[2015] 2020](99-references.html#ref-citemcelreath))，以及Johnson, Ott, 和 Dogucu
    ([2022](99-references.html#ref-bayesrules))。
- en: '13.5.1 Simulated example: political support'
  id: totrans-283
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.5.1 模拟示例：政治支持
- en: Let us consider a situation in which the probability of support for a particular
    political party depends on an individual’s gender, and the state that they live
    in.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们考虑一个情况，其中某个特定政治党派的投票支持概率取决于个人的性别以及他们居住的州。
- en: \[ \begin{aligned} y_i|\pi_i & \sim \mbox{Bern}(\pi_i) \\ \mbox{logit}(\pi_i)
    & = \beta_0 + \alpha_{g[i]}^{\mbox{gender}} + \alpha_{s[i]}^{\mbox{state}} \\
    \beta_0 & \sim \mbox{Normal}(0, 2.5)\\ \alpha_{g}^{\mbox{gender}} & \sim \mbox{Normal}(0,
    2.5)\mbox{ for }g=1, 2\\ \alpha_{s}^{\mbox{state}} & \sim \mbox{Normal}\left(0,
    \sigma_{\mbox{state}}^2\right)\mbox{ for }s=1, 2, \dots, S\\ \sigma_{\mbox{state}}
    & \sim \mbox{Exponential}(1) \end{aligned} \]
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: \[ \begin{aligned} y_i|\pi_i & \sim \mbox{Bern}(\pi_i) \\ \mbox{logit}(\pi_i)
    & = \beta_0 + \alpha_{g[i]}^{\mbox{gender}} + \alpha_{s[i]}^{\mbox{state}} \\
    \beta_0 & \sim \mbox{Normal}(0, 2.5)\\ \alpha_{g}^{\mbox{gender}} & \sim \mbox{Normal}(0,
    2.5)\mbox{ for }g=1, 2\\ \alpha_{s}^{\mbox{state}} & \sim \mbox{Normal}\left(0,
    \sigma_{\mbox{state}}^2\right)\mbox{ for }s=1, 2, \dots, S\\ \sigma_{\mbox{state}}
    & \sim \mbox{Exponential}(1) \end{aligned} \]
- en: where \(\pi_i = \mbox{Pr}(y_i=1)\), there are two gender groups, because that
    is what is going to be available from the survey we will use in [Chapter 16](15-mrp.html),
    and \(S\) is the total number of states. We include this in the function with
    “(1 | state)” within `stan_glmer()` from `rstanarm` ([Goodrich et al. 2023](99-references.html#ref-citerstanarm)).
    This term indicates that we are looking at a group effect by state, which means
    that the fitted model’s intercept is allowed to vary according by state.
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 \(\pi_i = \mbox{Pr}(y_i=1)\)，存在两个性别组，因为这是我们将在[第16章](15-mrp.html)中使用的调查中将要获得的信息，而
    \(S\) 是州的总数。我们在`stan_glmer()`函数中使用“（1 | state）”将此包含在`rstanarm`中（[Goodrich等人2023](99-references.html#ref-citerstanarm)）。这个术语表示我们正在查看按州划分的组效应，这意味着拟合模型的截距可以按州变化。
- en: '[PRE53]'
  id: totrans-287
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: '*[PRE54]*  *[PRE55]'
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE54]*  *[PRE55]'
- en: '*[PRE56]'
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE56]'
- en: '*[PRE57]*  *It is worth trying to look for opportunities to use a multilevel
    model when you come to a new modeling situation, especially one where inference
    is the primary concern. There is often some grouping that can be taken advantage
    of to provide the model with more information.'
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE57]*  *在遇到新的建模情况时，特别是当推理是主要关注点时，值得尝试寻找使用多级模型的机会。通常有一些分组可以利用，为模型提供更多信息。'
- en: When we move to multilevel modeling, it is possible that some `rstanarm` models
    will result in a warning about “divergent transitions”. For the purposes of getting
    a model working for this book, if there are just a handful of warnings and the
    Rhat values of the coefficients are all close to one (check this with `any(summary(change_this_to_the_model_name)[,
    "Rhat"] > 1.1)`), then just ignore it. If there are more than a handful, and/or
    any of the Rhats are not close to one, then add “adapt_delta = 0.99” as an argument
    to `stan_glmer()` and re-run the model (keeping in mind that it will take longer
    to run). If that does not fix the issue, then simplify the model by removing a
    variable. We will see an example in [Chapter 16](15-mrp.html) when we apply MRP
    to the 2020 US election, where the “adapt_delta” strategy fixes the issue.***  ***###
    13.5.2 Austen, Brontë, Dickens, and Shakespeare
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们转向多级建模时，某些`rstanarm`模型可能会出现关于“发散转换”的警告。为了使模型适用于本书，如果只有少数几个警告，并且系数的Rhat值都接近于1（可以通过`any(summary(change_this_to_the_model_name)[,
    "Rhat"] > 1.1)`来检查这一点），那么只需忽略它。如果有超过少数几个警告，并且/或者任何Rhat值没有接近于1，那么将“adapt_delta
    = 0.99”作为`stan_glmer()`的参数，并重新运行模型（记住这将需要更长的时间）。如果这不能解决问题，那么通过删除变量简化模型。我们将在[第16章](15-mrp.html)中看到一个例子，当我们将MRP应用于2020年美国大选时，“adapt_delta”策略解决了问题。***  ***###
    13.5.2 奥斯汀、勃朗特、狄更斯和莎士比亚
- en: 'As an example of multilevel modeling, we consider data from Project Gutenberg
    on the length of books by four authors: Jane Austen, Charlotte Brontë, Charles
    Dickens, and William Shakespeare. We would expect that Austen, Brontë, and Dickens,
    as they wrote books, will have longer books than Shakespeare, as he wrote plays.
    But it is not clear what difference we should expect between the three book authors.'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 作为多级建模的一个例子，我们考虑来自古腾堡计划（Project Gutenberg）的四位作者（简·奥斯汀、夏洛蒂·勃朗特、查尔斯·狄更斯和威廉·莎士比亚）的书籍长度数据。我们预计奥斯汀、勃朗特和狄更斯在写作书籍时，其书籍长度将比莎士比亚（他写作戏剧）更长。但我们对三位书籍作者之间应该期望的差异并不清楚。
- en: '[PRE58]'
  id: totrans-293
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: '*[PRE59]'
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE59]'
- en: '*[PRE60]'
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE60]'
- en: '*[PRE61]'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE61]'
- en: '[PRE62]'
  id: totrans-297
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: '*Table 13.9: Explaining whether Austen, Brontë, Dickens, or Shakespeare wrote
    a book based on the number of lines'
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: '*表13.9：根据行数解释奥斯汀、勃朗特、狄更斯或莎士比亚是否写作书籍'
- en: '[PRE63]'
  id: totrans-299
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: '*[Table 13.9](#tbl-modelsummaryaustenshakes) is a little empty for the multilevel
    model, and we often use graphs to avoid overwhelming the reader with numbers (we
    will see examples of this in [Chapter 16](15-mrp.html)). For instance, [Figure 13.15](#fig-multilevelexampleleveldistribution)
    shows the distribution of draws for each of the four authors using `spread_draws()`
    from `tidybayes`.'
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: '*[表13.9](#tbl-modelsummaryaustenshakes)对于多层次模型来说有点空，我们经常使用图表来避免用数字压倒读者（我们将在[第16章](15-mrp.html)中看到这样的例子）。例如，[图13.15](#fig-multilevelexampleleveldistribution)展示了使用`tidybayes`中的`spread_draws()`函数对四位作者抽样分布的展示。'
- en: '[PRE64]'
  id: totrans-301
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: '*![](../Images/096fa7bffb1de4504fdd9edd5e75d5d9.png)'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: '*![](../Images/096fa7bffb1de4504fdd9edd5e75d5d9.png)'
- en: 'Figure 13.15: Examining the distribution of draws for each of the four authors*  *In
    this case, we see that we typically expect Brontë to write the longest books of
    the three book authors. Shakespeare, as expected, typically wrote works with the
    fewest lines.**********  ****## 13.6 Concluding remarks'
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.15：检查四位作者中每位作者的抽样分布*  *在这种情况下，我们通常预期勃朗特会写出三部书中最长的一部。正如预期的那样，莎士比亚通常写的作品行数最少。**********  ****##
    13.6 结论
- en: In this chapter we have considered generalized linear models and introduced
    multilevel modeling. We built on the foundation established in [Chapter 12](12-ijalm.html)
    and provided some essentials for Bayesian model building. As mentioned in [Chapter
    12](12-ijalm.html), this is enough to get started. Hopefully you are excited to
    learn more and to do that you should start with the modeling books recommended
    in [Chapter 18](17-concluding.html).
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们讨论了广义线性模型并介绍了多层次建模。我们建立在[第12章](12-ijalm.html)中建立的基础之上，并为贝叶斯模型构建提供了一些基本要素。正如[第12章](12-ijalm.html)中提到的，这已经足够开始学习了。希望你能对学习更多内容感到兴奋，并且你应该从[第18章](17-concluding.html)中推荐的建模书籍开始。
- en: Over the course of [Chapter 12](12-ijalm.html) and [Chapter 13](#sec-its-just-a-generalized-linear-model)
    we have covered a variety of approaches for Bayesian models. But we have not done
    everything for every model.
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第12章](12-ijalm.html)和[第13章](#sec-its-just-a-generalized-linear-model)中，我们介绍了多种贝叶斯模型的处理方法。但我们并没有为每个模型都做到面面俱到。
- en: 'It is difficult to be definitive about what is “enough” because it is context
    specific, but the following checklist, drawn from concepts introduced across [Chapter
    12](12-ijalm.html) and [Chapter 13](#sec-its-just-a-generalized-linear-model)
    would be sufficient for most purposes when you are getting started. In the model
    section of the paper, write out the model using equations and include a few paragraphs
    of text explaining the equations. Then justify the model choices, and briefly
    detail any alternatives that you considered. Finish with a sentence explaining
    how the model was fit, which in this case is likely to be with `rstanarm`, and
    that diagnostics are available in a cross-referenced appendix. In that appendix
    you should include: prior predictive checks, trace plots, Rhat plots, posterior
    distributions, and posterior predictive checks.'
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 要确定“足够”是什么很难，因为它具有情境特异性，但以下清单，从[第12章](12-ijalm.html)和[第13章](#sec-its-just-a-generalized-linear-model)中介绍的概念中提取，在开始时对于大多数目的来说应该是足够的。在论文的模型部分，用方程式写出模型，并包含几段文字解释这些方程式。然后说明模型选择的原因，并简要描述你考虑过的任何替代方案。最后，用一句话解释模型是如何拟合的，在这种情况下，很可能是使用`rstanarm`，并且诊断结果可以在交叉引用的附录中找到。在那个附录中，你应该包括：先验预测检查、迹图、Rhat图、后验分布和后验预测检查。
- en: In the results section you should include a table of the estimates, built using
    `modelsummary`, and talk through them, likely with the help of `marginaleffects`.
    It may also be useful to include a graph of your results, especially if you are
    using a multilevel model, with the help of `tidybayes`. The model itself should
    be run in a separate R script. It should be preceded by tests of class and the
    number of observations. It should be followed by tests of the coefficients. These
    should be based on simulation. You should save the model in that R script using
    `saveRDS()`. In the Quarto document, you should read in that model using `readRDS()`.
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 在结果部分，你应该包括使用`modelsummary`构建的估计值表，并对其进行讨论，可能需要借助`marginaleffects`。如果使用多层次模型，包括结果图可能也很有用，可以使用`tidybayes`。模型本身应该在单独的R脚本中运行。它应该先进行类别和观测数的测试，然后进行系数的测试。这些测试应该基于模拟。你应该使用`saveRDS()`在R脚本中保存模型。在Quarto文档中，你应该使用`readRDS()`读取该模型。
- en: 13.7 Exercises
  id: totrans-308
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 13.7 练习
- en: Practice
  id: totrans-309
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 练习
- en: '*(Plan)* Consider the following scenario: *A person is interested in the number
    of deaths, attributed to cancer, in Sydney, Australia. They collect data from
    the five largest hospitals, for the past 20 years.* Please sketch out what that
    dataset could look like and then sketch a graph that you could build to show all
    observations.'
  id: totrans-310
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*(计划)* 考虑以下场景：*一个人对澳大利亚悉尼因癌症死亡的人数感兴趣。他们收集了过去20年五家最大医院的数据。* 请绘制出这个数据集可能的样子，然后绘制一个图表来展示所有观察结果。'
- en: '*(Simulate)* Please further consider the scenario described and simulate the
    situation—both the outcome (number of deaths, by cause) and a handful of predictors.
    Please include at least ten tests based on the simulated data.'
  id: totrans-311
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*(模拟)* 请进一步考虑所描述的场景，并模拟这种情况——结果（死亡人数，按原因分类）和几个预测变量。请至少包括基于模拟数据的十个测试。'
- en: '*(Acquire)* Please describe one possible source of such a dataset.'
  id: totrans-312
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*(获取)* 请描述一个此类数据集的可能来源。'
- en: '*(Explore)* Please use `ggplot2` to build the graph that you sketched. Then
    use `rstanarm` to build a model.'
  id: totrans-313
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*(探索)* 请使用`ggplot2`构建你绘制的图表。然后使用`rstanarm`构建模型。'
- en: '*(Communicate)* Please write two paragraphs about what you did.'
  id: totrans-314
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*(沟通)* 请写两段关于你所做的事情。'
- en: Quiz
  id: totrans-315
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 测验
- en: When should we consider logistic regression (pick one)?
  id: totrans-316
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们应该在什么时候考虑逻辑回归（选择一个）？
- en: Continuous outcome variable.
  id: totrans-317
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 连续结果变量。
- en: Binary outcome variable.
  id: totrans-318
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 二元结果变量。
- en: Count outcome variable.
  id: totrans-319
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算结果变量。
- en: We are interested in studying how voting intentions in the 2020 US presidential
    election vary by an individual’s income. We set up a logistic regression model
    to study this relationship. In this study, one possible outcome variable would
    be (pick one)?
  id: totrans-320
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们对研究2020年美国总统选举中投票意愿如何随着个人收入的变化感兴趣。我们建立了一个逻辑回归模型来研究这种关系。在这个研究中，一个可能的结果变量会是（选择一个）？
- en: Whether the respondent is a US citizen (yes/no)
  id: totrans-321
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 被调查者是否是美国公民（是/否）
- en: The respondent’s personal income (high/low)
  id: totrans-322
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 被调查者的个人收入（高/低）
- en: Whether the respondent is going to vote for Biden (yes/no)
  id: totrans-323
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 被调查者是否将投票给拜登（是/否）
- en: Who the respondent voted for in 2016 (Trump/Clinton)
  id: totrans-324
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 被调查者在2016年投票给了谁（特朗普/克林顿）
- en: We are interested in studying how voting intentions in the 2020 US presidential
    election vary by an individual’s income. We set up a logistic regression model
    to study this relationship. In this study, some possible predictor variables could
    be (select all that apply)?
  id: totrans-325
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们对研究2020年美国总统选举中投票意愿如何随着个人收入的变化感兴趣。我们建立了一个逻辑回归模型来研究这种关系。在这个研究中，一些可能的自变量可以是（选择所有适用的）？
- en: The race of the respondent (white/not white)
  id: totrans-326
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 被调查者的种族（白人/非白人）
- en: The respondent’s marital status (married/not)
  id: totrans-327
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 被调查者的婚姻状况（已婚/未婚）
- en: Whether the respondent is going to vote for Biden (yes/no)
  id: totrans-328
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 被调查者是否将投票给拜登（是/否）
- en: The mean of a Poisson distribution is equal to its?
  id: totrans-329
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 泊松分布的均值等于其？
- en: Median.
  id: totrans-330
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 中位数。
- en: Standard deviation.
  id: totrans-331
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 标准差。
- en: Variance.
  id: totrans-332
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 方差。
- en: Please redo the `rstanarm` example of US elections but include additional variables.
    Which variable did you choose, and how did the performance of the model improve?
  id: totrans-333
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 请重新做一下关于美国选举的`rstanarm`示例，但包括额外的变量。你选择了哪个变量，模型的表现是如何提高的？
- en: Please create the graph of the density of the Poisson distribution when \(\lambda
    = 75\).
  id: totrans-334
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 请绘制当 \(\lambda = 75\) 时泊松分布密度的图表。
- en: From Gelman, Hill, and Vehtari ([2020](99-references.html#ref-gelmanhillvehtari2020)),
    what is the offset in Poisson regression?
  id: totrans-335
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据 Gelman, Hill, 和 Vehtari ([2020](99-references.html#ref-gelmanhillvehtari2020))，泊松回归中的偏移量是什么？
- en: Redo the *Jane Eyre* example, but for “A/a”.
  id: totrans-336
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重新做一下关于“简·爱”的例子，但针对“A/a”。
- en: The twentieth century British statistician George Box, famously said, “[s]ince
    all models are wrong the scientist must be alert to what is importantly wrong.
    It is inappropriate to be concerned about mice when there are tigers abroad.”
    ([Box 1976, 792](99-references.html#ref-Box1976)). Discuss, with the help of examples
    and citations.
  id: totrans-337
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 20世纪的英国统计学家乔治·博克斯，著名地说，“[因为所有模型都是错误的，科学家必须警惕什么是重要的错误。当老虎在国外时，关心老鼠是不恰当的。” ([Box
    1976, 792](99-references.html#ref-Box1976))。请通过例子和引用进行讨论。
- en: Class activities
  id: totrans-338
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 课堂活动
- en: 'Discuss how you would build a Bayesian regression model to look at the association
    between whether someone prefers football or hockey, and their age, gender, and
    location. Write out:'
  id: totrans-339
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 讨论你将如何构建一个贝叶斯回归模型来研究某人是否喜欢足球或曲棍球与他们的年龄、性别和地点之间的关联。请列出：
- en: The outcome of interest and the likelihood
  id: totrans-340
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们感兴趣的结果和似然
- en: The regression model for the outcome of interest
  id: totrans-341
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们感兴趣的结果的回归模型
- en: The priors on any parameters to be estimated in the model.
  id: totrans-342
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在模型中估计任何参数的先验。
- en: Like in [Chapter 12](12-ijalm.html), we are again interested in understanding
    the relationship between bill length and depth using `palmerpenguins`, but this
    time for all three species. Begin by estimating separate models for each. Then
    estimate one model for all three species. Finally, estimate a model with partial
    pooling.
  id: totrans-343
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 像在[第12章](12-ijalm.html)中一样，我们再次对理解法案长度与深度之间的关系感兴趣，这次是针对所有三个物种。首先为每个物种估计单独的模型。然后估计一个针对所有三个物种的模型。最后，估计一个部分池化的模型。
- en: Use the [starter folder](https://github.com/RohanAlexander/starter_folder) and
    create a new repo. Add a link to the GitHub repo in the class’s shared Google
    Doc.
  id: totrans-344
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用[入门文件夹](https://github.com/RohanAlexander/starter_folder)并创建一个新的仓库。在班级共享的Google文档中添加GitHub仓库链接。
- en: We are interested in explaining support for either a Democrat or Republican,
    based on education, age-group, and gender, and state. Please sketch and simulate
    the situation.
  id: totrans-345
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们感兴趣的是根据教育程度、年龄组和性别以及州来解释对民主党或共和党的支持。请绘制并模拟这种情况。
- en: Please obtain the data underpinning Cohn ([2016](99-references.html#ref-cohn2016)),
    available [here](https://github.com/TheUpshot/2016-upshot-siena-polls/). Save
    the unedited data, and construct an analysis dataset (there is some code below
    to get you started). Add graphs of each of the variables, individually, into the
    data section, as well as graphs of how they relate.
  id: totrans-346
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 请获取Cohn ([2016](99-references.html#ref-cohn2016))的数据基础，可在[此处](https://github.com/TheUpshot/2016-upshot-siena-polls/)找到。保存未编辑的数据，并构建一个分析数据集（下面有一些代码可以帮助你开始）。将每个变量的图表以及它们之间的关系图添加到数据部分。
- en: Please build one model explaining “vt_pres_2”, as a function of “gender”, “educ”,
    and “age”; and another which additionally considers “state”. Write up the two
    models in a model section, and add the results into the results section (again,
    there is some code below to get you started).
  id: totrans-347
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 请构建一个解释“vt_pres_2”作为“性别”、“教育”和“年龄”函数的模型，以及另一个考虑“州”的模型。在模型部分撰写这两个模型，并将结果添加到结果部分（同样，下面有一些代码可以帮助你开始）。
- en: '[PRE65]'
  id: totrans-348
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: '*[PRE66]*  **### Task'
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: '*[PRE66]*  **### 任务'
- en: Please consider Maher ([1982](99-references.html#ref-maher1982modelling)), Smith
    ([2002](99-references.html#ref-thanksleo)), or Cohn ([2016](99-references.html#ref-cohn2016)).
    Build a simplified version of their model.
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 请考虑Maher ([1982](99-references.html#ref-maher1982modelling))、Smith ([2002](99-references.html#ref-thanksleo))或Cohn
    ([2016](99-references.html#ref-cohn2016))。构建他们模型的简化版本。
- en: Obtain some recent relevant data, estimate the model, and discuss your choice
    between logistic, Poisson, and negative binomial regression.
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 获取一些最近的相关数据，估计模型，并讨论你在逻辑回归、泊松回归和负二项回归之间的选择。
- en: Use Quarto, and include an appropriate title, author, date, link to a GitHub
    repo, sections, and citations, and be sure to thoroughly specify the model.
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Quarto，并包括适当的标题、作者、日期、GitHub仓库链接、章节和引用，并确保详细指定模型。
- en: Paper
  id: totrans-353
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 论文
- en: At about this point the *Spadina* Paper from [Online Appendix F](25-papers.html)
    would be appropriate.
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: 大约在这个时候，[在线附录F](25-papers.html)中的*Spadina*论文是合适的。
- en: 'Ansolabehere, Stephen, Brian Schaffner, and Sam Luks. 2021\. “Guide to the
    2020 Cooperative Election Study.” [https://doi.org/10.7910/DVN/E9N6PH](https://doi.org/10.7910/DVN/E9N6PH).Arel-Bundock,
    Vincent. 2022\. “modelsummary: Data and Model Summaries in R.” *Journal of Statistical
    Software* 103 (1): 1–23\. [https://doi.org/10.18637/jss.v103.i01](https://doi.org/10.18637/jss.v103.i01).———.
    2023\. *marginaleffects: Predictions, Comparisons, Slopes, Marginal Means, and
    Hypothesis Tests*. [https://vincentarelbundock.github.io/marginaleffects/](https://vincentarelbundock.github.io/marginaleffects/).———.
    2024\. *tinytable: Simple and Configurable Tables in “HTML,” “LaTeX,” “Markdown,”
    “Word,” “PNG,” “PDF,” and “Typst” Formats*. [https://vincentarelbundock.github.io/tinytable/](https://vincentarelbundock.github.io/tinytable/).Baio,
    Gianluca, and Marta Blangiardo. 2010\. “Bayesian Hierarchical Model for the Prediction
    of Football Results.” *Journal of Applied Statistics* 37 (2): 253–64\. [https://doi.org/10.1080/02664760802684177](https://doi.org/10.1080/02664760802684177).Bolker,
    Ben, and David Robinson. 2022\. *broom.mixed: Tidying Methods for Mixed Models*.
    [https://CRAN.R-project.org/package=broom.mixed](https://CRAN.R-project.org/package=broom.mixed).Bolton,
    Ruth, and Randall Chapman. 1986\. “Searching for Positive Returns at the Track.”
    *Management Science* 32 (August): 1040–60\. [https://doi.org/10.1287/mnsc.32.8.1040](https://doi.org/10.1287/mnsc.32.8.1040).Box,
    George E. P. 1976\. “Science and Statistics.” *Journal of the American Statistical
    Association* 71 (356): 791–99\. [https://doi.org/10.1080/01621459.1976.10480949](https://doi.org/10.1080/01621459.1976.10480949).Burch,
    Tyler James. 2023\. “2023 NHL Playoff Predictions,” April. [https://tylerjamesburch.com/blog/misc/nhl-predictions](https://tylerjamesburch.com/blog/misc/nhl-predictions).Canty,
    Angelo, and B. D. Ripley. 2021\. *boot: Bootstrap R (S-Plus) Functions*.Chellel,
    Kit. 2018\. “The Gambler Who Cracked the Horse-Racing Code.” *Bloomberg Businessweek*,
    May. [https://www.bloomberg.com/news/features/2018-05-03/the-gambler-who-cracked-the-horse-racing-code](https://www.bloomberg.com/news/features/2018-05-03/the-gambler-who-cracked-the-horse-racing-code).Cohn,
    Nate. 2016\. “We Gave Four Good Pollsters the Same Raw Data. They Had Four Different
    Results.” *The New York Times*, September. [https://www.nytimes.com/interactive/2016/09/20/upshot/the-error-the-polling-world-rarely-talks-about.html](https://www.nytimes.com/interactive/2016/09/20/upshot/the-error-the-polling-world-rarely-talks-about.html).Cramer,
    Jan Salomon. 2003\. “The Origins of Logistic Regression.” *SSRN Electronic Journal*.
    [https://doi.org/10.2139/ssrn.360300](https://doi.org/10.2139/ssrn.360300).Davison,
    A. C., and D. V. Hinkley. 1997\. *Bootstrap Methods and Their Applications*. Cambridge:
    Cambridge University Press. [http://statwww.epfl.ch/davison/BMA/](http://statwww.epfl.ch/davison/BMA/).Edgeworth,
    Francis Ysidro. 1885\. “Methods of Statistics.” *Journal of the Statistical Society
    of London*, 181–217.Firke, Sam. 2023\. *janitor: Simple Tools for Examining and
    Cleaning Dirty Data*. [https://CRAN.R-project.org/package=janitor](https://CRAN.R-project.org/package=janitor).Friendly,
    Michael. 2021\. *HistData: Data Sets from the History of Statistics and Data Visualization*.
    [https://CRAN.R-project.org/package=HistData](https://CRAN.R-project.org/package=HistData).Gelman,
    Andrew, Jennifer Hill, and Aki Vehtari. 2020\. *Regression and Other Stories*.
    Cambridge University Press. [https://avehtari.github.io/ROS-Examples/](https://avehtari.github.io/ROS-Examples/).Goodrich,
    Ben, Jonah Gabry, Imad Ali, and Sam Brilleman. 2023\. “rstanarm: Bayesian applied
    regression modeling via Stan.” [https://mc-stan.org/rstanarm](https://mc-stan.org/rstanarm).Hastie,
    Trevor, and Robert Tibshirani. 1990\. *Generalized Additive Models*. 1st ed. Boca
    Raton: Chapman; Hall/CRC.James, Gareth, Daniela Witten, Trevor Hastie, and Robert
    Tibshirani. (2013) 2021\. *An Introduction to Statistical Learning with Applications
    in R*. 2nd ed. Springer. [https://www.statlearning.com](https://www.statlearning.com).Johnson,
    Alicia, Miles Ott, and Mine Dogucu. 2022\. *Bayes Rules! An Introduction to Bayesian
    Modeling with R*. 1st ed. Chapman; Hall/CRC. [https://www.bayesrulesbook.com](https://www.bayesrulesbook.com).Johnston,
    Myfanwy, and David Robinson. 2022\. *gutenbergr: Download and Process Public Domain
    Works from Project Gutenberg*. [https://CRAN.R-project.org/package=gutenbergr](https://CRAN.R-project.org/package=gutenbergr).Kay,
    Matthew. 2022\. *tidybayes: Tidy Data and Geoms for Bayesian Models*. [https://doi.org/10.5281/zenodo.1308151](https://doi.org/10.5281/zenodo.1308151).Krantz,
    Sebastian. 2023\. *collapse: Advanced and Fast Data Transformation*. [https://CRAN.R-project.org/package=collapse](https://CRAN.R-project.org/package=collapse).Kuriwaki,
    Shiro, Will Beasley, and Thomas Leeper. 2023\. *dataverse: R Client for Dataverse
    4+ Repositories*.Maher, Michael. 1982\. “Modelling Association Football Scores.”
    *Statistica Neerlandica* 36 (3): 109–18\. [https://doi.org/10.1111/j.1467-9574.1982.tb00782.x](https://doi.org/10.1111/j.1467-9574.1982.tb00782.x).McElreath,
    Richard. (2015) 2020\. *Statistical Rethinking: A Bayesian Course with Examples
    in R and Stan*. 2nd ed. Chapman; Hall/CRC.Nelder, John, and Robert Wedderburn.
    1972\. “Generalized Linear Models.” *Journal of the Royal Statistical Society:
    Series A (General)* 135 (3): 370–84\. [https://doi.org/10.2307/2344614](https://doi.org/10.2307/2344614).Osgood,
    D. Wayne. 2000\. “Poisson-Based Regression Analysis of Aggregate Crime Rates.”
    *Journal of Quantitative Criminology* 16 (1): 21–43\. [https://doi.org/10.1023/a:1007521427059](https://doi.org/10.1023/a:1007521427059).Pitman,
    Jim. 1993\. *Probability*. 1st ed. New York: Springer. [https://doi.org/10.1007/978-1-4612-4374-8](https://doi.org/10.1007/978-1-4612-4374-8).R
    Core Team. 2024\. *R: A Language and Environment for Statistical Computing*. Vienna,
    Austria: R Foundation for Statistical Computing. [https://www.R-project.org/](https://www.R-project.org/).Schaffner,
    Brian, Stephen Ansolabehere, and Sam Luks. 2021\. “Cooperative Election Study
    Common Content, 2020.” Harvard Dataverse. [https://doi.org/10.7910/DVN/E9N6PH](https://doi.org/10.7910/DVN/E9N6PH).Smith,
    Richard. 2002\. “A Statistical Assessment of Buchanan’s Vote in Palm Beach County.”
    *Statistical Science* 17 (4): 441–57\. [https://doi.org/10.1214/ss/1049993203](https://doi.org/10.1214/ss/1049993203).Steele,
    Fiona. 2007\. “Multilevel Models for Longitudinal Data.” *Journal of the Royal
    Statistical Society Series A: Statistics in Society* 171 (1): 5–19\. [https://doi.org/10.1111/j.1467-985x.2007.00509.x](https://doi.org/10.1111/j.1467-985x.2007.00509.x).Steele,
    Fiona, Anna Vignoles, and Andrew Jenkins. 2007\. “The Effect of School Resources
    on Pupil Attainment: A Multilevel Simultaneous Equation Modelling Approach.” *Journal
    of the Royal Statistical Society Series A: Statistics in Society* 170 (3): 801–24\.
    [https://doi.org/10.1111/j.1467-985x.2007.00476.x](https://doi.org/10.1111/j.1467-985x.2007.00476.x).Stigler,
    Stephen. 1978\. “Francis Ysidro Edgeworth, Statistician.” *Journal of the Royal
    Statistical Society. Series A (General)* 141 (3): 287–322\. [https://doi.org/10.2307/2344804](https://doi.org/10.2307/2344804).Wang,
    Wei, David Rothschild, Sharad Goel, and Andrew Gelman. 2015\. “Forecasting Elections
    with Non-Representative Polls.” *International Journal of Forecasting* 31 (3):
    980–91\. [https://doi.org/10.1016/j.ijforecast.2014.06.001](https://doi.org/10.1016/j.ijforecast.2014.06.001).Wickham,
    Hadley, Mara Averick, Jenny Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain
    François, Garrett Grolemund, et al. 2019\. “Welcome to the Tidyverse.” *Journal
    of Open Source Software* 4 (43): 1686\. [https://doi.org/10.21105/joss.01686](https://doi.org/10.21105/joss.01686).**
    *** * *'
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: 'Ansolabehere, Stephen, Brian Schaffner, and Sam Luks. 2021. “Guide to the 2020
    Cooperative Election Study.” [https://doi.org/10.7910/DVN/E9N6PH](https://doi.org/10.7910/DVN/E9N6PH).
    Arel-Bundock, Vincent. 2022. “modelsummary: Data and Model Summaries in R.” *Journal
    of Statistical Software* 103 (1): 1–23. [https://doi.org/10.18637/jss.v103.i01](https://doi.org/10.18637/jss.v103.i01).———.
    2023. *marginaleffects: Predictions, Comparisons, Slopes, Marginal Means, and
    Hypothesis Tests*. [https://vincentarelbundock.github.io/marginaleffects/](https://vincentarelbundock.github.io/marginaleffects/).———.
    2024. *tinytable: Simple and Configurable Tables in “HTML,” “LaTeX,” “Markdown,”
    “Word,” “PNG,” “PDF,” and “Typst” Formats*. [https://vincentarelbundock.github.io/tinytable/](https://vincentarelbundock.github.io/tinytable/).
    Baio, Gianluca, and Marta Blangiardo. 2010. “Bayesian Hierarchical Model for the
    Prediction of Football Results.” *Journal of Applied Statistics* 37 (2): 253–64.
    [https://doi.org/10.1080/02664760802684177](https://doi.org/10.1080/02664760802684177).
    Bolker, Ben, and David Robinson. 2022. *broom.mixed: Tidying Methods for Mixed
    Models*. [https://CRAN.R-project.org/package=broom.mixed](https://CRAN.R-project.org/package=broom.mixed).
    Bolton, Ruth, and Randall Chapman. 1986. “Searching for Positive Returns at the
    Track.” *Management Science* 32 (August): 1040–60. [https://doi.org/10.1287/mnsc.32.8.1040](https://doi.org/10.1287/mnsc.32.8.1040).
    Box, George E. P. 1976. “Science and Statistics.” *Journal of the American Statistical
    Association* 71 (356): 791–99. [https://doi.org/10.1080/01621459.1976.10480949](https://doi.org/10.1080/01621459.1976.10480949).
    Burch, Tyler James. 2023. “2023 NHL Playoff Predictions,” April. [https://tylerjamesburch.com/blog/misc/nhl-predictions](https://tylerjamesburch.com/blog/misc/nhl-predictions).
    Canty, Angelo, and B. D. Ripley. 2021. *boot: Bootstrap R (S-Plus) Functions*.
    Chellel, Kit. 2018. “The Gambler Who Cracked the Horse-Racing Code.” *Bloomberg
    Businessweek*, May. [https://www.bloomberg.com/news/features/2018-05-03/the-gambler-who-cracked-the-horse-racing-code](https://www.bloomberg.com/news/features/2018-05-03/the-gambler-who-cracked-the-horse-racing-code).
    Cohn, Nate. 2016. “We Gave Four Good Pollsters the Same Raw Data. They Had Four
    Different Results.” *The New York Times*, September. [https://www.nytimes.com/interactive/2016/09/20/upshot/the-error-the-polling-world-rarely-talks-about.html](https://www.nytimes.com/interactive/2016/09/20/upshot/the-error-the-polling-world-rarely-talks-about.html).
    Cramer, Jan Salomon. 2003. “The Origins of Logistic Regression.” *SSRN Electronic
    Journal*. [https://doi.org/10.2139/ssrn.360300](https://doi.org/10.2139/ssrn.360300).
    Davison, A. C., and D. V. Hinkley. 1997. *Bootstrap Methods and Their Applications*.
    Cambridge: Cambridge University Press. [http://statwww.epfl.ch/davison/BMA/](http://statwww.epfl.ch/davison/BMA/).
    Edgeworth, Francis Ysidro. 1885. “Methods of Statistics.” *Journal of the Statistical
    Society of London*, 181–217. Firke, Sam. 2023. *janitor: Simple Tools for Examining
    and Cleaning Dirty Data*. [https://CRAN.R-project.org/package=janitor](https://CRAN.R-project.org/package=janitor).
    Friendly, Michael. 2021. *HistData: Data Sets from the History of Statistics and
    Data Visualization*. [https://CRAN.R-project.org/package=HistData](https://CRAN.R-project.org/package=HistData).
    Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2020. *Regression and Other Stories*.
    Cambridge University Press. [https://avehtari.github.io/ROS-Examples/](https://avehtari.github.io/ROS-Examples/).
    Goodrich, Ben, Jonah Gabry, Imad Ali, and Sam Brilleman. 2023. “rstanarm: Bayesian
    applied regression modeling via Stan.” [https://mc-stan.org/rstanarm](https://mc-stan.org/rstanarm).
    Hastie, Trevor, and Robert Tibshirani. 1990. *Generalized Additive Models*. 1st
    ed. Boca Raton: Chapman; Hall/CRC. James, Gareth, Daniela Witten, Trevor Hastie,
    and Robert Tibshirani. (2013) 2021. *An Introduction to Statistical Learning with
    Applications in R*. 2nd ed. Springer. [https://www.statlearning.com](https://www.statlearning.com).
    Johnson, Alicia, Miles Ott, and Mine Dogucu. 2022. *Bayes Rules! An Introduction
    to Bayesian Modeling with R*. 1st ed. Chapman; Hall/CRC. [https://www.bayesrulesbook.com](https://www.bayesrulesbook.com).
    Johnston, Myfanwy, and David Robinson. 2022. *gutenbergr: Download and Process
    Public Domain Works from Project Gutenberg*. [https://CRAN.R-project.org/package=gutenbergr](https://CRAN.R-project.org/package=gutenbergr).
    Kay, Matthew. 2022. *tidybayes: Tidy Data and Geoms for Bayesian Models*. [https://doi.org/10.5281/zenodo.1308151](https://doi.org/10.5281/zenodo.1308151).
    Krantz, Sebastian. 2023. *collapse: Advanced and Fast Data Transformation*. [https://CRAN.R-project.org/package=collapse](https://CRAN.R-project.org/package=collapse).
    Kuriwaki, Shiro, Will Beasley, and Thomas Leeper. 2023. *dataverse: R Client for
    Dataverse 4+ Repositories*. Maher, Michael. 1982. “Modelling Association Football
    Scores.” *Statistica Neerlandica* 36 (3): 109–18. [https://doi.org/10.1111/j.1467-9574.1982.tb00782.x](https://doi.org/10.1111/j.1467-9574.1982.tb00782.x).
    McElreath, Richard. (2015) 2020. *Statistical Rethinking: A Bayesian Course with
    Examples in R and Stan*. 2nd ed. Chapman; Hall/CRC. Nelder, John, and Robert Wedderburn.
    1972. “Generalized Linear Models.” *Journal of the Royal Statistical Society:
    Series A (General)* 135 (3): 370–84. [https://doi.org/10.2307/2344614](https://doi.org/10.2307/2344614).
    Osgood, D. Wayne. 2000. “Poisson-Based Regression Analysis of Aggregate Crime
    Rates.” *Journal of Quantitative Criminology* 16 (1): 21–43. [https://doi.org/10.1023/a:1007521427059](https://doi.org/10.1023/a:1007521427059).
    Pitman, Jim. 1993. *Probability*. 1st ed. New York: Springer. [https://doi.org/10.1007/978-1-4612-4374-8](https://doi.org/10.1007/978-1-4612-4374-8).
    R Core Team. 2024. *R: A Language and Environment for Statistical Computing*.
    Vienna, Austria: R Foundation for Statistical Computing. [https://www.R-project.org/](https://www.R-project.org/).
    Schaffner, Brian, Stephen Ansolabehere, and Sam Luks. 2021. “Cooperative Election
    Study Common Content, 2020.” Harvard Dataverse. [https://doi.org/10.7910/DVN/E9N6PH](https://doi.org/10.7910/DVN/E9N6PH).
    Smith, Richard. 2002. “A Statistical Assessment of Buchanan’s Vote in Palm Beach
    County.” *Statistical Science* 17 (4): 441–57. [https://doi.org/10.1214/ss/1049993203](https://doi.org/10.1214/ss/1049993203).
    Steele, Fiona. 2007. “Multilevel Models for Longitudinal Data.” *Journal of the
    Royal Statistical Society Series A: Statistics in Society* 171 (1): 5–19. [https://doi.org/10.1111/j.1467-985x.2007.00509.x](https://doi.org/10.1111/j.1467-985x.2007.00509.x).
    Steele, Fiona, Anna Vignoles, and Andrew Jenkins. 2007. “The Effect of School
    Resources on Pupil Attainment: A Multilevel Simultaneous Equation Modelling Approach.”
    *Journal of the Royal Statistical Society Series A: Statistics in Society* 170
    (3): 801–24. [https://doi.org/10.1111/j.1467-985x.2007.00476.x](https://doi.org/10.1111/j.1467-985x.2007.00476.x).
    Stigler, Stephen. 1978. “Francis Ysidro Edgeworth, Statistician.” *Journal of
    the Royal Statistical Society. Series A (General)* 141 (3): 287–322. [https://doi.org/10.2307/2344804](https://doi.org/10.2307/2344804).
    Wang, Wei, David Rothschild, Sharad Goel, and Andrew Gelman. 2015. “Forecasting
    Elections with Non-Representative Polls.” *International Journal of Forecasting*
    31 (3): 980–91. [https://doi.org/10.1016/j.ijforecast.2014.06.001](https://doi.org/10.1016/j.ijforecast.2014.06.001).
    Wickham, Hadley, Mara Averick, Jenny Bryan, Winston Chang, Lucy D’Agostino McGowan,
    Romain François, Garrett Grolemund, et al. 2019. “Welcome to the Tidyverse.” *Journal
    of Open Source Software* 4 (43): 1686. [https://doi.org/10.21105/joss.01686](https://doi.org/10.21105/joss.01686).'
- en: By way of background, LOO-CV is not done by `loo()`, because it would be too
    computationally intensive. Instead an approximation is done which provides the
    expected log point wise predictive density (ELPD). The `rstanarm` vignettes provide
    more detail.[↩︎](#fnref1)*****************
  id: totrans-356
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 作为背景介绍，LOO-CV 并不是通过 `loo()` 函数实现的，因为这会过于计算密集。相反，采用了一种近似方法，该方法提供了预期的对数点预测密度（ELPD）。`rstanarm`
    的示例文档提供了更多详细信息。[↩︎](#fnref1)*****************
