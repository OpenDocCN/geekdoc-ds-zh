- en: Solution Accuracy
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 解的准确性
- en: 原文：[https://phys-sim-book.github.io/lec7.3-sol_accuracy.html](https://phys-sim-book.github.io/lec7.3-sol_accuracy.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '[原文链接](https://phys-sim-book.github.io/lec7.3-sol_accuracy.html)'
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: 'So why can we solve Equation [(7.2.2)](lec7.2-dist_barrier_formulation.html#eq:lec7:barrier_IPC)
    to approximate the solution of the original problem in Equation [(7.2.1)](lec7.2-dist_barrier_formulation.html#eq:lec7:constrained_IP)?
    Similar to [Dirichlet Boundary Conditions](lec2.2-dirichlet_BC.html), at the solution
    \(x^*\) of Equation [(7.2.1)](lec7.2-dist_barrier_formulation.html#eq:lec7:constrained_IP),
    the following KKT conditions all hold: ∇E(x∗)−i,j∑​γij​∇dij​(x∗)=0,∀i,j, dij​(x∗)≥0, γij​≥0, γij​dij​(x∗)=0.​(7.3.1)
    While at the local optimum \(x''\) of Equation [(7.2.2)](lec7.2-dist_barrier_formulation.html#eq:lec7:barrier_IPC),
    we have ∇E(x′)+h2∇Pb​(x′)=0,(7.3.2) which is equivalently ∇E(x′)+h2i,j∑​Ai​d^∇b(dij​(x′))=0
    and ∇E(x′)+h2i,j∑​Ai​d^∂d∂b​(dij​(x′))∇dij​(x′)=0 if we plug in the expression
    of \(\nabla b(d_{ij})\). Let \(\gamma_{ij}'' = -h^2 A_i \hat{d} \frac{\partial
    b}{\partial d}(d_{ij}(x''))\), we can further rewrite Equation [(7.3.2)](#eq:lec7:optimality_barrier)
    as ∇E(x′)−i,j∑​γij′​∇dij​(x′)=0, which is essentially the stationarity condition
    (first line in Equation [(7.3.1)](#eq:lec7:IC_KKT)) if we take \(\gamma_{ij}''\)
    as the dual variable. Now since the barrier function provides arbitrarily large
    repulsion to avoid interpenetration, we know that \(\forall i,j\), \(d_{ij}(x'')
    \geq 0\). In addition, \(\gamma_{ij}'' \geq 0\) also holds for all \(i,j\) because
    \(\frac{\partial b}{\partial d} \leq 0\) by construction. This means that at \(x''\),
    we have momentum balance, no interpenetrations, and contact forces only push but
    not pull.'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，我们为什么可以解方程 [(7.2.2)](lec7.2-dist_barrier_formulation.html#eq:lec7:barrier_IPC)
    来近似求解方程 [(7.2.1)](lec7.2-dist_barrier_formulation.html#eq:lec7:constrained_IP)
    的解呢？与 [Dirichlet 边界条件](lec2.2-dirichlet_BC.html) 类似，在方程 [(7.2.1)](lec7.2-dist_barrier_formulation.html#eq:lec7:constrained_IP)
    的解 \(x^*\) 处，以下 KKT 条件都成立：∇E(x∗)−i,j∑​γij​∇dij​(x∗)=0,∀i,j, dij​(x∗)≥0, γij​≥0, γij​dij​(x∗)=0.​(7.3.1)
    而在方程 [(7.2.2)](lec7.2-dist_barrier_formulation.html#eq:lec7:barrier_IPC) 的局部最优
    \(x'\) 处，我们有 ∇E(x′)+h2∇Pb​(x′)=0,(7.3.2) 这等价于 ∇E(x′)+h2i,j∑​Ai​d^∇b(dij​(x′))=0
    和 ∇E(x′)+h2i,j∑​Ai​d^∂d∂b​(dij​(x′))∇dij​(x′)=0，如果我们代入 \(\nabla b(d_{ij})\) 的表达式。令
    \(\gamma_{ij}' = -h^2 A_i \hat{d} \frac{\partial b}{\partial d}(d_{ij}(x'))\)，我们可以进一步将方程
    [(7.3.2)](#eq:lec7:optimality_barrier) 重写为 ∇E(x′)−i,j∑​γij′​∇dij​(x′)=0，如果我们把
    \(\gamma_{ij}'\) 作为对偶变量。现在，由于障碍函数提供了任意大的排斥力以避免相互穿透，我们知道对于所有 \(i,j\)，\(d_{ij}(x')
    \geq 0\)。此外，对于所有 \(i,j\)，\(\gamma_{ij}' \geq 0\) 也成立，因为 \(\frac{\partial b}{\partial
    d} \leq 0\) 是构造的。这意味着在 \(x'\) 处，我们具有动量平衡，没有相互穿透，接触力只推不拉。
- en: In our simulation, the only Karush-Kuhn-Tucker (KKT) condition not strictly
    satisfied at \( x' \) is the complementarity slackness condition. This arises
    due to the way our barrier approximation functions. Specifically, we have a situation
    where \( \gamma_{ij} > 0 \Longleftrightarrow 0 < d_{ij} < \hat{d} \), representing
    the activation of contact forces based on the distance between solids and obstacles.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的模拟中，在 \( x' \) 处唯一没有严格满足的 Karush-Kuhn-Tucker (KKT) 条件是互补松弛条件。这源于我们的障碍近似函数的方式。具体来说，我们有一个情况，其中
    \( \gamma_{ij} > 0 \Longleftrightarrow 0 < d_{ij} < \hat{d} \)，表示基于固体和障碍物之间的距离激活接触力。
- en: 'As the threshold \( \hat{d} \) decreases, contact forces become active only
    when the solids are in closer proximity (as illustrated in [Figure 7.2.1](lec7.2-dist_barrier_formulation.html#fig:lec7:barrier_func)).
    This adjustment leads to a reduction in the complementarity slackness error, which
    can be controlled to a certain extent. However, it''s important to note that this
    control comes at a cost: computational efficiency may be reduced. This is because
    sharper objective functions, resulting from smaller \( \hat{d} \) values, tend
    to require more Newton iterations to resolve. Therefore, there is a trade-off
    between the accuracy of the simulation (in terms of adhering to the KKT condition)
    and the computational resources required.'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 随着阈值 \( \hat{d} \) 的降低，接触力仅在固体更接近时才会激活（如图 7.2.1 所示）。这种调整导致互补松弛误差减少，这在一定程度上是可以控制的。然而，需要注意的是，这种控制是有代价的：计算效率可能会降低。这是因为较小的
    \( \hat{d} \) 值导致更尖锐的目标函数，这通常需要更多的牛顿迭代来求解。因此，在模拟的准确性（即遵守 KKT 条件）和所需的计算资源之间存在着权衡。
