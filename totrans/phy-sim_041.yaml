- en: Solution Accuracy
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec7.3-sol_accuracy.html](https://phys-sim-book.github.io/lec7.3-sol_accuracy.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: 'So why can we solve Equation [(7.2.2)](lec7.2-dist_barrier_formulation.html#eq:lec7:barrier_IPC)
    to approximate the solution of the original problem in Equation [(7.2.1)](lec7.2-dist_barrier_formulation.html#eq:lec7:constrained_IP)?
    Similar to [Dirichlet Boundary Conditions](lec2.2-dirichlet_BC.html), at the solution
    \(x^*\) of Equation [(7.2.1)](lec7.2-dist_barrier_formulation.html#eq:lec7:constrained_IP),
    the following KKT conditions all hold: ∇E(x∗)−i,j∑​γij​∇dij​(x∗)=0,∀i,j, dij​(x∗)≥0, γij​≥0, γij​dij​(x∗)=0.​(7.3.1)
    While at the local optimum \(x''\) of Equation [(7.2.2)](lec7.2-dist_barrier_formulation.html#eq:lec7:barrier_IPC),
    we have ∇E(x′)+h2∇Pb​(x′)=0,(7.3.2) which is equivalently ∇E(x′)+h2i,j∑​Ai​d^∇b(dij​(x′))=0
    and ∇E(x′)+h2i,j∑​Ai​d^∂d∂b​(dij​(x′))∇dij​(x′)=0 if we plug in the expression
    of \(\nabla b(d_{ij})\). Let \(\gamma_{ij}'' = -h^2 A_i \hat{d} \frac{\partial
    b}{\partial d}(d_{ij}(x''))\), we can further rewrite Equation [(7.3.2)](#eq:lec7:optimality_barrier)
    as ∇E(x′)−i,j∑​γij′​∇dij​(x′)=0, which is essentially the stationarity condition
    (first line in Equation [(7.3.1)](#eq:lec7:IC_KKT)) if we take \(\gamma_{ij}''\)
    as the dual variable. Now since the barrier function provides arbitrarily large
    repulsion to avoid interpenetration, we know that \(\forall i,j\), \(d_{ij}(x'')
    \geq 0\). In addition, \(\gamma_{ij}'' \geq 0\) also holds for all \(i,j\) because
    \(\frac{\partial b}{\partial d} \leq 0\) by construction. This means that at \(x''\),
    we have momentum balance, no interpenetrations, and contact forces only push but
    not pull.'
  prefs: []
  type: TYPE_NORMAL
- en: In our simulation, the only Karush-Kuhn-Tucker (KKT) condition not strictly
    satisfied at \( x' \) is the complementarity slackness condition. This arises
    due to the way our barrier approximation functions. Specifically, we have a situation
    where \( \gamma_{ij} > 0 \Longleftrightarrow 0 < d_{ij} < \hat{d} \), representing
    the activation of contact forces based on the distance between solids and obstacles.
  prefs: []
  type: TYPE_NORMAL
- en: 'As the threshold \( \hat{d} \) decreases, contact forces become active only
    when the solids are in closer proximity (as illustrated in [Figure 7.2.1](lec7.2-dist_barrier_formulation.html#fig:lec7:barrier_func)).
    This adjustment leads to a reduction in the complementarity slackness error, which
    can be controlled to a certain extent. However, it''s important to note that this
    control comes at a cost: computational efficiency may be reduced. This is because
    sharper objective functions, resulting from smaller \( \hat{d} \) values, tend
    to require more Newton iterations to resolve. Therefore, there is a trade-off
    between the accuracy of the simulation (in terms of adhering to the KKT condition)
    and the computational resources required.'
  prefs: []
  type: TYPE_NORMAL
