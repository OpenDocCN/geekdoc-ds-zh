- en: Linear Modal Analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec25.7-linear_modal_analysis.html](https://phys-sim-book.github.io/lec25.7-linear_modal_analysis.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: 'We begin our exploration of model reduction with the simplest case: linear
    elasticity [(13.1.4)](lec13.1-rigid_null_rot_inv.html#eq:lec13:strain_energy_lin).
    While limited to small deformations, this context provides a clear and intuitive
    introduction to the core concepts of subspace simulation.'
  prefs: []
  type: TYPE_NORMAL
- en: '[The Physics of Vibration Modes](#the-physics-of-vibration-modes)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The object doesn't deform in a random way; instead, it vibrates in a superposition
    of specific, characteristic patterns called **modes**. Each of these fundamental
    patterns is called a **mode shape**, representing a specific way the object can
    deform. The overall motion is then described by how much each mode shape contributes
    to the total deformation at any given moment; this "amount" of contribution is
    the **modal amplitude**.
  prefs: []
  type: TYPE_NORMAL
- en: Each mode has an associated natural frequency. Low-frequency modes correspond
    to large, low-energy deformations (like the fundamental bending of the tuning
    fork), while high-frequency modes represent complex, high-energy vibrations that
    are often difficult to see and are quick to dissipate.
  prefs: []
  type: TYPE_NORMAL
- en: The key insight is that the vast majority of an object's visible dynamic behavior
    can be described by a small number of these low-frequency modes. By restricting
    our simulation to only these important modes, we can create a highly efficient
    approximation. It is crucial to remember that this approach is valid only for
    small deformations, where the material's response remains approximately linear.
    This means that the internal forces that resist deformation are directly proportional
    to the amount of displacement (a relationship often described by Hooke's Law).
    In our discrete setting, this is captured by a constant stiffness matrix K, which
    is also the negative of the strain energy's Hessian matrix. For large deformations,
    the stiffness properties change with the deformation, and linear modal analysis
    is no longer applicable.
  prefs: []
  type: TYPE_NORMAL
- en: '[Computing the Modes](#computing-the-modes)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Finding these modes requires us to solve a generalized eigenvalue problem. The
    setup involves first defining the full system and then applying constraints. We
    will assume our system is 3-dimensional from now on.
  prefs: []
  type: TYPE_NORMAL
- en: We start by forming the full mass matrix M∈R3n×3n and stiffness matrix K∈R3n×3n.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: To account for Dirichlet boundary conditions (fixed vertices), we form smaller,
    constrained matrices M^ and K^ by removing the rows and columns from M and K that
    correspond to the fixed degrees of freedom.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The eigenvalue problem is then solved on these constrained matrices: K^ψ^​i​=λi​M^ψ^​i​.(26.1.1)'
  prefs: []
  type: TYPE_NORMAL
- en: '**Example 26.1.1 (Interpreting the Generalized Eigenvalue Problem).** The equation
    [(26.1.1)](#eq:lec26:linear_system) is fundamental to understanding vibrations
    in mechanical systems. Let''s break it down:'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: K∈R3n×3n is the full **stiffness matrix**. It relates displacement to internal
    elastic forces (felastic​=Ku). A high value in K means the object strongly resists
    deformation.
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
- en: M∈R3n×3n is the full **mass matrix**. It relates acceleration to inertial forces
    (finertial​=Ma).
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
- en: An **eigenvector** ψi​∈R3n is a **mode shape**. It's a vector that describes
    the spatial pattern of a particular vibration mode.
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
- en: An **eigenvalue** λi​∈R is the squared **natural frequency**, for the corresponding
    mode ψi​.
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The equation Kψi​=λi​Mψi​ essentially states that a modal deformation ψi​ is
    special: if the object is deformed into this shape, the elastic restoring force
    (Kψi​) is perfectly proportional to the inertial force (Mψi​) required to produce
    a sinusoidal vibration with that shape.'
  prefs: []
  type: TYPE_NORMAL
- en: The **modes** are the shapes where the elastic and inertial forces align perfectly.
    Low eigenvalues correspond to low-energy modes, which are the most important for
    visual animation.
  prefs: []
  type: TYPE_NORMAL
- en: The solution from the eigensolver gives us eigenvalues λi​ and eigenvectors
    ψ^​i​ for the unconstrained DOFs. The eigenvalues are the squares of the natural
    frequencies of vibration, λi​=ωi2​, and the eigenvectors represent the mode shapes.
    In order to check that the eigensolver was successful, it is common to visualize
    the individual modes by animating them as ψi​sin(ωi​t), where t is time.
  prefs: []
  type: TYPE_NORMAL
- en: 'The different modal vectors are typically assembled into a **modal basis matrix**:'
  prefs: []
  type: TYPE_NORMAL
- en: U=[ψ1​,…,ψr​]∈R3n×r,
  prefs: []
  type: TYPE_NORMAL
- en: where we select the r modes corresponding to the smallest non-zero eigenvalues.
  prefs: []
  type: TYPE_NORMAL
- en: '[Subspace Simulation of Linear Dynamics](#subspace-simulation-of-linear-dynamics)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Now, let''s see how this modal basis accelerates simulation. The full-space
    equation of motion for a linear elastic system with damping is:'
  prefs: []
  type: TYPE_NORMAL
- en: Mu¨+Du˙+Ku=fext​,(26.1.2)
  prefs: []
  type: TYPE_NORMAL
- en: 'where D is the damping matrix and fext​ is the vector of external forces. To
    reduce this system, we introduce the central approximation of subspace methods:
    the full-space displacement u is approximated by a linear combination of our basis
    vectors:'
  prefs: []
  type: TYPE_NORMAL
- en: u(t)≈Uq(t).
  prefs: []
  type: TYPE_NORMAL
- en: Here, q(t)∈Rr is the vector of **reduced coordinates** or **modal amplitudes**,
    where ideally r≪3n. Each component qi​(t) represents "how much" of mode ψi​ is
    present in the deformation at time t.
  prefs: []
  type: TYPE_NORMAL
- en: 'To derive the equation of motion for q, we substitute approximation for u(t)
    into [(26.1.2)](#eq:lec26:main_ode) and project the entire equation onto the subspace
    by pre-multiplying with UT: UT(M(Uq¨​)+D(Uq˙​)+K(Uq))=UTfext​ (UTMU)q¨​+(UTDU)q˙​+(UTKU)q=UTfext​.
    This is where the magic happens. Due to the properties of the generalized eigenvalue
    problem, the eigenvectors can be scaled to be **mass-orthonormal**, meaning ψiT​Mψj​=δij​
    (1 if i=j, 0 otherwise).'
  prefs: []
  type: TYPE_NORMAL
- en: '****Method 26.1.1 (Mass-Orthonormalization of Eigenvectors).**** To achieve
    the simplification UTMU=I, the modal basis must be made **mass-orthonormal**.
    This is accomplished in two steps. First, the generalized eigenvalue problem naturally
    produces eigenvectors that are **M-orthogonal**, meaning ψiT​Mψj​=0 for any two
    different modes i and j. This property ensures that all off-diagonal entries of
    the projected mass matrix are zero. Second, to make the diagonal entries equal
    to one, we explicitly normalize each raw eigenvector ψ​i​ from the solver using
    its mass-weighted length: ψi​=ψ​iT​Mψ​i​​ψ​i​​.​(26.1.3) The resulting vectors
    ψi​, which satisfy ψiT​Mψi​=1, are assembled into the basis U. Together, M-orthogonality
    and M-normalization guarantee the projected mass matrix is the identity, which
    is what decouples the system of equations.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'This simplifies the projected matrices dramatically:'
  prefs: []
  type: TYPE_NORMAL
- en: UTMU=I;
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: UTKU=Λ, where Λ is a diagonal matrix of the eigenvalues, diag(λ1​,…,λr​).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'If we assume **Rayleigh damping**, where D=αM+βK, the projected damping matrix
    also becomes diagonal: UTDU=αI+βΛ.'
  prefs: []
  type: TYPE_NORMAL
- en: 'This means that the final reduced system becomes a set of r completely independent,
    1D ordinary differential equations: q¨​i​+(α+βλi​)q˙​i​+λi​qi​=ψiT​fext​for i=1,…,r.(26.1.4)'
  prefs: []
  type: TYPE_NORMAL
- en: '**Method 26.1.2 (Linear Modal Simulation).** We can think of the overall process
    as being split into a one-time precomputation and an efficient runtime loop.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Precomputation:**'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Discretize the object to form the global mass matrix M and stiffness matrix
    K.
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
- en: Solve the generalized eigenvalue problem Kψi​=λi​Mψi​ for the r smallest non-zero
    eigenvalues λi​ and corresponding eigenvectors ψi​.
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
- en: Assemble the mass-orthonormal basis matrix U=[ψ1​,…,ψr​].
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Runtime Loop (per time step):**'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Compute external forces fext​ in the full-space (e.g., from gravity, user interaction).
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Project the forces onto the reduced basis: freduced​=UTfext​.'
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
- en: For each mode i=1,…,r, solve its simple 1D ODE [(26.1.4)](#eq:lec26:linear_system_simple)
    to update its amplitude qi​. This can be done with a simple and stable implicit
    integration scheme.
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Reconstruct the full-space deformation for rendering: u=Uq.'
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
- en: The computational savings are immense. Instead of solving a large, coupled 3n×3n
    system, we solve r tiny, independent 1D equations, where r might be 20-50 while
    3n could be in the tens of thousands or even millions.
  prefs: []
  type: TYPE_NORMAL
