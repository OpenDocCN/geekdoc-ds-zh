- en: Linear Modal Analysis
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 线性模态分析
- en: 原文：[https://phys-sim-book.github.io/lec25.7-linear_modal_analysis.html](https://phys-sim-book.github.io/lec25.7-linear_modal_analysis.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec25.7-linear_modal_analysis.html](https://phys-sim-book.github.io/lec25.7-linear_modal_analysis.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: 'We begin our exploration of model reduction with the simplest case: linear
    elasticity [(13.1.4)](lec13.1-rigid_null_rot_inv.html#eq:lec13:strain_energy_lin).
    While limited to small deformations, this context provides a clear and intuitive
    introduction to the core concepts of subspace simulation.'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从最简单的情况开始探索模型降阶：线性弹性 [(13.1.4)](lec13.1-rigid_null_rot_inv.html#eq:lec13:strain_energy_lin)。虽然仅限于小变形，但这个背景提供了一个清晰直观的介绍，帮助我们理解子空间模拟的核心概念。
- en: '[The Physics of Vibration Modes](#the-physics-of-vibration-modes)'
  id: totrans-4
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[振动模式的物理](#the-physics-of-vibration-modes)'
- en: The object doesn't deform in a random way; instead, it vibrates in a superposition
    of specific, characteristic patterns called **modes**. Each of these fundamental
    patterns is called a **mode shape**, representing a specific way the object can
    deform. The overall motion is then described by how much each mode shape contributes
    to the total deformation at any given moment; this "amount" of contribution is
    the **modal amplitude**.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 物体不会以随机的方式变形；相反，它会以特定、特征的模式叠加振动，这些模式称为**模式**。每个基本模式都称为**模式形状**，代表物体可以变形的特定方式。整体运动随后由每个模式形状在任意给定时刻对总变形的贡献程度来描述；这种“贡献量”称为**模态振幅**。
- en: Each mode has an associated natural frequency. Low-frequency modes correspond
    to large, low-energy deformations (like the fundamental bending of the tuning
    fork), while high-frequency modes represent complex, high-energy vibrations that
    are often difficult to see and are quick to dissipate.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 每个模式都有一个相关的固有频率。低频模式对应于大、低能量的变形（如音叉的基本弯曲），而高频模式代表复杂、高能量的振动，这些振动通常难以看到且容易消散。
- en: The key insight is that the vast majority of an object's visible dynamic behavior
    can be described by a small number of these low-frequency modes. By restricting
    our simulation to only these important modes, we can create a highly efficient
    approximation. It is crucial to remember that this approach is valid only for
    small deformations, where the material's response remains approximately linear.
    This means that the internal forces that resist deformation are directly proportional
    to the amount of displacement (a relationship often described by Hooke's Law).
    In our discrete setting, this is captured by a constant stiffness matrix K, which
    is also the negative of the strain energy's Hessian matrix. For large deformations,
    the stiffness properties change with the deformation, and linear modal analysis
    is no longer applicable.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 关键的洞察是，一个物体的绝大多数可见动态行为可以用这些低频模式中的少数几个来描述。通过将我们的模拟限制在这些重要的模式上，我们可以创建一个高度有效的近似。重要的是要记住，这种方法仅适用于小变形，其中材料的响应保持近似线性。这意味着抵抗变形的内力与位移量成正比（这种关系通常由胡克定律描述）。在我们的离散设置中，这由一个常数刚度矩阵
    K 来捕捉，它也是应变能的海森矩阵的负值。对于大变形，刚度特性会随着变形而变化，线性模态分析不再适用。
- en: '[Computing the Modes](#computing-the-modes)'
  id: totrans-8
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[计算模式](#computing-the-modes)'
- en: Finding these modes requires us to solve a generalized eigenvalue problem. The
    setup involves first defining the full system and then applying constraints. We
    will assume our system is 3-dimensional from now on.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 找到这些模式需要我们解决一个广义特征值问题。设置包括首先定义完整系统，然后应用约束。从现在起，我们将假设我们的系统是三维的。
- en: We start by forming the full mass matrix M∈R3n×3n and stiffness matrix K∈R3n×3n.
  id: totrans-10
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们首先形成完整的质量矩阵 M∈R3n×3n 和刚度矩阵 K∈R3n×3n。
- en: To account for Dirichlet boundary conditions (fixed vertices), we form smaller,
    constrained matrices M^ and K^ by removing the rows and columns from M and K that
    correspond to the fixed degrees of freedom.
  id: totrans-11
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了考虑狄利克雷边界条件（固定顶点），我们通过移除与固定自由度相对应的行和列，形成较小的约束矩阵 M^ 和 K^。
- en: 'The eigenvalue problem is then solved on these constrained matrices: K^ψ^​i​=λi​M^ψ^​i​.(26.1.1)'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 然后在这些约束矩阵上求解特征值问题：K^ψ^i = λi M^ψ^i。(26.1.1)
- en: '**Example 26.1.1 (Interpreting the Generalized Eigenvalue Problem).** The equation
    [(26.1.1)](#eq:lec26:linear_system) is fundamental to understanding vibrations
    in mechanical systems. Let''s break it down:'
  id: totrans-13
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**示例 26.1.1（解释广义特征值问题）**。方程 [(26.1.1)](#eq:lec26:linear_system) 对于理解机械系统的振动至关重要。让我们来分解它：'
- en: ''
  id: totrans-14
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: K∈R3n×3n is the full **stiffness matrix**. It relates displacement to internal
    elastic forces (felastic​=Ku). A high value in K means the object strongly resists
    deformation.
  id: totrans-15
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: K∈R3n×3n 是完整的**刚度矩阵**。它将位移与内部弹性力（felastic=Ku）相关联。K中的高值意味着物体强烈抵抗变形。
- en: M∈R3n×3n is the full **mass matrix**. It relates acceleration to inertial forces
    (finertial​=Ma).
  id: totrans-16
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: M∈R3n×3n 是完整的**质量矩阵**。它将加速度与惯性力（finertial=Ma）相关联。
- en: An **eigenvector** ψi​∈R3n is a **mode shape**. It's a vector that describes
    the spatial pattern of a particular vibration mode.
  id: totrans-17
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**特征向量** ψi∈R3n 是**模态形状**。它是一个描述特定振动模式空间模式的向量。'
- en: An **eigenvalue** λi​∈R is the squared **natural frequency**, for the corresponding
    mode ψi​.
  id: totrans-18
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**特征值** λi∈R 是对应于模态 ψi 的**自然频率**的平方。'
- en: 'The equation Kψi​=λi​Mψi​ essentially states that a modal deformation ψi​ is
    special: if the object is deformed into this shape, the elastic restoring force
    (Kψi​) is perfectly proportional to the inertial force (Mψi​) required to produce
    a sinusoidal vibration with that shape.'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 方程 Kψi=λiMψi 实质上表明一个模态变形 ψi 是特殊的：如果物体变形为这种形状，弹性恢复力（Kψi）将完美地与产生该形状正弦振动的惯性力（Mψi）成比例。
- en: The **modes** are the shapes where the elastic and inertial forces align perfectly.
    Low eigenvalues correspond to low-energy modes, which are the most important for
    visual animation.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '**模态**是弹性力和惯性力完美对齐的形状。低特征值对应于低能量模态，这对于视觉动画最为重要。'
- en: The solution from the eigensolver gives us eigenvalues λi​ and eigenvectors
    ψ^​i​ for the unconstrained DOFs. The eigenvalues are the squares of the natural
    frequencies of vibration, λi​=ωi2​, and the eigenvectors represent the mode shapes.
    In order to check that the eigensolver was successful, it is common to visualize
    the individual modes by animating them as ψi​sin(ωi​t), where t is time.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 特征值求解器的解给出了无约束自由度的特征值 λi 和特征向量 ψ^i。特征值是振动自然频率的平方，λi=ωi2，特征向量代表模态形状。为了验证特征值求解器是否成功，通常通过将它们作为
    ψi sin(ωi t) 动画来可视化单个模态，其中 t 是时间。
- en: 'The different modal vectors are typically assembled into a **modal basis matrix**:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 不同的模态向量通常组装成一个**模态基矩阵**：
- en: U=[ψ1​,…,ψr​]∈R3n×r,
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: U=[ψ1,…,ψr]∈R3n×r,
- en: where we select the r modes corresponding to the smallest non-zero eigenvalues.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 其中我们选择了对应于最小非零特征值的 r 个模态。
- en: '[Subspace Simulation of Linear Dynamics](#subspace-simulation-of-linear-dynamics)'
  id: totrans-25
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[线性动力学子空间模拟](#subspace-simulation-of-linear-dynamics)'
- en: 'Now, let''s see how this modal basis accelerates simulation. The full-space
    equation of motion for a linear elastic system with damping is:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们看看这种模态基如何加速模拟。具有阻尼的线性弹性系统的全空间运动方程为：
- en: Mu¨+Du˙+Ku=fext​,(26.1.2)
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: Mu¨+Du˙+Ku=fext​,(26.1.2)
- en: 'where D is the damping matrix and fext​ is the vector of external forces. To
    reduce this system, we introduce the central approximation of subspace methods:
    the full-space displacement u is approximated by a linear combination of our basis
    vectors:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 D 是阻尼矩阵，fext 是外力向量。为了简化这个系统，我们引入子空间方法的核心近似：将全空间位移 u 近似为我们的基向量的线性组合：
- en: u(t)≈Uq(t).
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: u(t)≈Uq(t).
- en: Here, q(t)∈Rr is the vector of **reduced coordinates** or **modal amplitudes**,
    where ideally r≪3n. Each component qi​(t) represents "how much" of mode ψi​ is
    present in the deformation at time t.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，q(t)∈Rr 是**简化坐标**或**模态振幅**的向量，理想情况下 r≪3n。每个分量 qi(t) 代表在时间 t 的变形中存在多少 ψi
    模态。
- en: 'To derive the equation of motion for q, we substitute approximation for u(t)
    into [(26.1.2)](#eq:lec26:main_ode) and project the entire equation onto the subspace
    by pre-multiplying with UT: UT(M(Uq¨​)+D(Uq˙​)+K(Uq))=UTfext​ (UTMU)q¨​+(UTDU)q˙​+(UTKU)q=UTfext​.
    This is where the magic happens. Due to the properties of the generalized eigenvalue
    problem, the eigenvectors can be scaled to be **mass-orthonormal**, meaning ψiT​Mψj​=δij​
    (1 if i=j, 0 otherwise).'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 要推导出 q 的运动方程，我们将 u(t) 的近似值代入 [(26.1.2)](#eq:lec26:main_ode)，并通过预乘以 UT 将整个方程投影到子空间：UT(M(Uq¨)+D(Uq˙)+K(Uq))=UTfext
    (UTMU)q¨+(UTDU)q˙+(UTKU)q=UTfext。这就是魔法发生的地方。由于广义特征值问题的性质，特征向量可以被缩放到**质量正交归一**，意味着
    ψiT Mψj=δij (如果 i=j，则为 1，否则为 0)。
- en: '****Method 26.1.1 (Mass-Orthonormalization of Eigenvectors).**** To achieve
    the simplification UTMU=I, the modal basis must be made **mass-orthonormal**.
    This is accomplished in two steps. First, the generalized eigenvalue problem naturally
    produces eigenvectors that are **M-orthogonal**, meaning ψiT​Mψj​=0 for any two
    different modes i and j. This property ensures that all off-diagonal entries of
    the projected mass matrix are zero. Second, to make the diagonal entries equal
    to one, we explicitly normalize each raw eigenvector ψ​i​ from the solver using
    its mass-weighted length: ψi​=ψ​iT​Mψ​i​​ψ​i​​.​(26.1.3) The resulting vectors
    ψi​, which satisfy ψiT​Mψi​=1, are assembled into the basis U. Together, M-orthogonality
    and M-normalization guarantee the projected mass matrix is the identity, which
    is what decouples the system of equations.'
  id: totrans-32
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '****方法 26.1.1 (特征向量的质量正交化)。**** 要实现简化 UTMU=I，模态基必须被制成 **质量正交**。这通过两个步骤完成。首先，广义特征值问题自然产生
    **M-正交** 的特征向量，这意味着 ψiT​Mψj​=0 对于任何两个不同的模式 i 和 j。这一性质确保了投影质量矩阵的所有非对角元素都是零。其次，为了使对角元素等于一，我们使用求解器的质量加权长度显式归一化每个原始特征向量
    ψi​：ψi​=ψ​iT​Mψ​i​​ψ​i​​.​(26.1.3) 满足 ψiT​Mψi​=1 的结果向量 ψi​ 被组装到基 U 中。M-正交性和 M-归一性共同保证了投影质量矩阵是单位矩阵，这就是解耦方程组的原因。'
- en: 'This simplifies the projected matrices dramatically:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 这极大地简化了投影矩阵：
- en: UTMU=I;
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: UTMU=I;
- en: UTKU=Λ, where Λ is a diagonal matrix of the eigenvalues, diag(λ1​,…,λr​).
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: UTKU=Λ，其中 Λ 是特征值的对角矩阵，diag(λ1​,…,λr​)。
- en: 'If we assume **Rayleigh damping**, where D=αM+βK, the projected damping matrix
    also becomes diagonal: UTDU=αI+βΛ.'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们假设 **瑞利阻尼**，其中 D=αM+βK，则投影阻尼矩阵也变为对角线：UTDU=αI+βΛ。
- en: 'This means that the final reduced system becomes a set of r completely independent,
    1D ordinary differential equations: q¨​i​+(α+βλi​)q˙​i​+λi​qi​=ψiT​fext​for i=1,…,r.(26.1.4)'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着最终的简化系统变成了一组 r 个完全独立的 1D 常微分方程：q¨​i​+(α+βλi​)q˙​i​+λi​qi​=ψiT​fext​for i=1,…,r.(26.1.4)
- en: '**Method 26.1.2 (Linear Modal Simulation).** We can think of the overall process
    as being split into a one-time precomputation and an efficient runtime loop.'
  id: totrans-38
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**方法 26.1.2 (线性模态模拟)。** 我们可以将整个过程视为分为一次性的预计算和高效的运行时循环。'
- en: ''
  id: totrans-39
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Precomputation:**'
  id: totrans-40
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**预计算：**'
- en: ''
  id: totrans-41
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Discretize the object to form the global mass matrix M and stiffness matrix
    K.
  id: totrans-42
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将物体离散化以形成全局质量矩阵 M 和刚度矩阵 K。
- en: Solve the generalized eigenvalue problem Kψi​=λi​Mψi​ for the r smallest non-zero
    eigenvalues λi​ and corresponding eigenvectors ψi​.
  id: totrans-43
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 解广义特征值问题 Kψi​=λi​Mψi​ 以找到 r 个最小的非零特征值 λi​ 和相应的特征向量 ψi​。
- en: Assemble the mass-orthonormal basis matrix U=[ψ1​,…,ψr​].
  id: totrans-44
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 组装质量正交基矩阵 U=[ψ1​,…,ψr​].
- en: ''
  id: totrans-45
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Runtime Loop (per time step):**'
  id: totrans-46
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**运行循环（每时间步）：**'
- en: ''
  id: totrans-47
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Compute external forces fext​ in the full-space (e.g., from gravity, user interaction).
  id: totrans-48
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算全空间中的外力 fext​（例如，来自重力、用户交互）。
- en: 'Project the forces onto the reduced basis: freduced​=UTfext​.'
  id: totrans-49
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将力投影到简化基上：freduced​=UTfext​.
- en: For each mode i=1,…,r, solve its simple 1D ODE [(26.1.4)](#eq:lec26:linear_system_simple)
    to update its amplitude qi​. This can be done with a simple and stable implicit
    integration scheme.
  id: totrans-50
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于每个模式 i=1,…,r，求解其简单的 1D ODE [(26.1.4)](#eq:lec26:linear_system_simple) 以更新其振幅
    qi​。这可以通过一个简单且稳定的隐式积分方案来完成。
- en: 'Reconstruct the full-space deformation for rendering: u=Uq.'
  id: totrans-51
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重建全空间变形以进行渲染：u=Uq。
- en: The computational savings are immense. Instead of solving a large, coupled 3n×3n
    system, we solve r tiny, independent 1D equations, where r might be 20-50 while
    3n could be in the tens of thousands or even millions.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 计算节省巨大。我们不是解决一个大的、耦合的 3n×3n 系统而是解决 r 个微小的、独立的 1D 方程，其中 r 可能是 20-50，而 3n 可能是成千上万甚至数百万。
