- en: Deformation Gradient and Particle State Update
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec26.4-particle_state_update.html](https://phys-sim-book.github.io/lec26.4-particle_state_update.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: In MPM, each particle carries a deformation gradient Fp​, which tracks how the
    local material volume attached to the particle is stretched, rotated, or sheared
    over time. It plays a central role in computing stress based on constitutive models.
  prefs: []
  type: TYPE_NORMAL
- en: At the beginning of each time step, the grid lies on a regular, undeformed lattice.
    Let xin​ be the position of grid node i at time tn. The deformation gradient is
    updated by observing how the grid locally moves over the time step, assuming a
    given grid velocity field v^in+1​.
  prefs: []
  type: TYPE_NORMAL
- en: '[Deformation Gradient Update](#deformation-gradient-update)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The most common approach is to compute Fpn+1​ using a 1st-order approximation:'
  prefs: []
  type: TYPE_NORMAL
- en: Fpn+1​=(I+Δti∑​vin+1​∇(wipn​)T)Fpn​.
  prefs: []
  type: TYPE_NORMAL
- en: In **MLS-MPM** [[Hu et al. 2018]](bibliography.html#hu2018moving) and **APIC**
    [[Jiang et al. 2015]](bibliography.html#jiang2015affine), the deformation gradient
    update can be rewritten more compactly using the affine velocity matrix Cp​ that
    is already computed during P2G and G2P transfers.
  prefs: []
  type: TYPE_NORMAL
- en: 'Recall the local affine velocity field:'
  prefs: []
  type: TYPE_NORMAL
- en: vp​(x)=vp​+Cp​(x−xp​).
  prefs: []
  type: TYPE_NORMAL
- en: 'From this, the grid motion induces a local velocity gradient Cp​, and the deformation
    gradient can be updated as:'
  prefs: []
  type: TYPE_NORMAL
- en: Fpn+1​=(I+ΔtCp​)Fpn​.(3)
  prefs: []
  type: TYPE_NORMAL
- en: This bypasses the need to explicitly evaluate ∇wip​, and instead uses the already-aggregated
    affine behavior stored in Cp​.
  prefs: []
  type: TYPE_NORMAL
- en: '**Plasticity flow** is also applied at this stage to project the updated deformation
    gradient back onto the admissible space defined by the material''s yield criterion.
    This process, known as **return mapping**, ensures that the material obeys plastic
    limits, and will be discussed in detail in the [next lecture](./lec27-mpm_plasticity.html).'
  prefs: []
  type: TYPE_NORMAL
- en: '[Position Update](#position-update)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The particle position at time tn+1 is then advected as:'
  prefs: []
  type: TYPE_NORMAL
- en: xpn+1​=xpn​+Δtvpn+1​.
  prefs: []
  type: TYPE_NORMAL
