- en: Stiffness and Damping in Constraint Solving
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 约束求解中的刚度和阻尼
- en: 原文：[https://phys-sim-book.github.io/lec31.5-stiffness_damping.html](https://phys-sim-book.github.io/lec31.5-stiffness_damping.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec31.5-stiffness_damping.html](https://phys-sim-book.github.io/lec31.5-stiffness_damping.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: '[Stiffness](#stiffness)'
  id: totrans-3
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[刚度](#stiffness)'
- en: 'Material stiffness is controlled by a parameter k∈[0,1], which controls how
    strongly a constraint is enforced. The most straightforward way to incorporate
    stiffness is to scale the calculated correction by k: Δpi​←k⋅Δpi​. However, this
    makes the effective stiffness dependent on the number of solver iterations, ns​.
    If a constraint is projected ns​ times, the remaining error after the projections
    would be proportional to (1−k)ns​. A more robust formulation that decouples stiffness
    from the iteration count is: k′=1−(1−k)1/ns​(32.5.1) By scaling the correction
    by k′ instead of k, the remaining error after ns​ iterations becomes (1−k′)ns​=1−k,
    which is independent of ns​. This allows artists to tune the material stiffness
    k without worrying about how many solver iterations are being used.'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 材料刚度由参数k∈[0,1]控制，该参数控制约束施加的强度。将刚度纳入的最直接方法是将计算出的校正量乘以k：Δpi​←k⋅Δpi​。然而，这使得有效刚度依赖于求解器迭代次数ns​。如果一个约束被投影ns次，投影后的剩余误差将与(1−k)ns成正比。一个更稳健的公式，将刚度与迭代计数解耦是：k′=1−(1−k)1/ns（32.5.1）。通过将校正量乘以k′而不是k，ns次迭代后的剩余误差变为(1−k′)ns=1−k，这与ns无关。这使得艺术家可以调整材料刚度k，而不用担心使用了多少求解器迭代。
- en: '[Damping](#damping)'
  id: totrans-5
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[阻尼](#damping)'
- en: Although the PBD method is generally stable, simulations can exhibit excessive
    oscillations or kinetic energy gain, particularly with stiff constraints. The
    quality of dynamic simulations can generally be improved by the incorporation
    of an appropriate damping scheme. It can improve the stability by reducing temporal
    jittering of the point positions of an object. It also allows for larger time
    steps which increases the performance of a dynamic simulation.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然PBD方法通常稳定，但模拟可能会表现出过度的振荡或动能增加，尤其是在刚性约束的情况下。通过引入适当的阻尼方案，通常可以提高动态模拟的质量。它可以通过减少物体点位置的时间抖动来提高稳定性。它还允许使用更大的时间步长，从而提高动态模拟的性能。
- en: A naive damping of all velocities can undesirably affect the global motion of
    an object, slowing down its overall translation and rotation. A more sophisticated
    approach is to damp only the relative motions of particles while preserving the
    total linear and angular momentum of the system.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 对所有速度进行简单的阻尼可能会不希望地影响物体的全局运动，减慢其整体平移和旋转。更复杂的方法是仅阻尼粒子的相对运动，同时保持系统的总线性和角动量。
- en: '****Method 32.5.1 (Momentum-Conserving Damping).****'
  id: totrans-8
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '****方法32.5.1（动量守恒阻尼）****'
- en: ''
  id: totrans-9
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Compute Center of Mass and Velocity:** pcm​=∑i​mi​∑i​mi​pi​​, vcm​=∑i​mi​∑i​mi​vi​​'
  id: totrans-10
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**计算质心和速度：** pcm​=∑i​mi​∑i​mi​pi​​, vcm​=∑i​mi​∑i​mi​vi​​'
- en: ''
  id: totrans-11
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-12
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**Compute Angular Momentum and Inertia Tensor:** Let ri​=xi​−pcm​.'
  id: totrans-13
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**计算角动量和惯性张量：** 令ri​=xi​−pcm​.'
- en: ''
  id: totrans-14
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-15
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-16
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: L=∑i​ri​×(mi​vi​)
  id: totrans-17
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
  zh: L=∑i​ri​×(mi​vi​)
- en: ''
  id: totrans-18
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-19
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-20
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: I=∑i​mi​((ri​⋅ri​)Id−ri​⊗ri​)
  id: totrans-21
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
  zh: I=∑i​mi​((ri​⋅ri​)Id−ri​⊗ri​)
- en: ''
  id: totrans-22
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-23
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**Compute Angular Velocity:** ω=I−1L'
  id: totrans-24
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**计算角速度：** ω=I−1L'
- en: ''
  id: totrans-25
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-26
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '**Apply Damping:** For each particle i:'
  id: totrans-27
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**应用阻尼：** 对于每个粒子i：'
- en: ''
  id: totrans-28
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-29
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-30
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: 'a. Calculate the velocity deviation from rigid body motion: Δvi​=(vcm​+ω×ri​)−vi​'
  id: totrans-31
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
  zh: a. 计算刚体运动的速度偏差：Δvi​=(vcm​+ω×ri​)−vi​
- en: ''
  id: totrans-32
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-33
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-34
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: 'b. Apply damping to the deviation: vi​←vi​+kdamping​Δvi​'
  id: totrans-35
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
  zh: b. 将阻尼应用于偏差：vi​←vi​+kdamping​Δvi​
- en: This method effectively isolates the non-rigid components of motion and damps
    only them. In the extreme case where kdamping​=1, all relative motion is eliminated,
    and the object behaves as a perfect rigid body.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 此方法有效地隔离了运动中的非刚性组件，并仅对它们进行阻尼。在极端情况下，当kdamping​=1时，所有相对运动都被消除，物体表现为完美的刚性体。
- en: '[Extended Position Based Dynamics (XPBD)](#extended-position-based-dynamics-xpbd)'
  id: totrans-37
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[扩展位置基于动力学（XPBD）](#extended-position-based-dynamics-xpbd)'
- en: 'While the stiffness formulation in Equation [(32.5.1)](#eq:pbd:stiffness) decouples
    the effective stiffness from the solver iteration count, a fundamental limitation
    of standard PBD remains: the resulting material stiffness is still dependent on
    the simulation time step Δt. An extension known as **Extended Position Based Dynamics
    (XPBD)** addresses this issue, enabling true parameter-independent stiffness.'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然方程式 [(32.5.1)](#eq:pbd:stiffness) 中的刚度公式将有效刚度与求解器的迭代次数解耦，但标准PBD仍然存在一个基本限制：得到的材料刚度仍然依赖于模拟时间步
    Δt。一种称为**扩展位置基动力学（XPBD）**的扩展方法解决了这个问题，实现了真正的参数无关刚度。
- en: XPBD is derived from a compliant constraint formulation and introduces the concept
    of compliance as the inverse of stiffness.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: XPBD是从合规性约束公式推导出来的，并引入了合规性作为刚度的倒数这一概念。
- en: '****Definition 32.5.1 (Compliance).**** Compliance, α≥0, is the inverse of
    a material''s stiffness k, with α=1/k. It describes a material''s propensity to
    deform under load. In XPBD, a compliance of α=0 corresponds to an infinitely stiff,
    or hard, constraint.'
  id: totrans-40
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '****定义 32.5.1（合规性）**** 合规性，α≥0，是材料刚度 k 的倒数，α=1/k。它描述了材料在载荷下的变形倾向。在 XPBD 中，合规性
    α=0 对应于无限刚硬或硬约束。'
- en: 'The core idea of XPBD is to treat the Lagrange multiplier λ not as a temporary
    value recalculated in each iteration, but as a physical quantity representing
    the accumulated impulse that is incrementally updated. In each solver iteration,
    we calculate an impulse increment, Δλ, and add it to the total impulse λ for that
    constraint. The formula for this increment modifies Equation [(32.4.3)](lec31.4-solver.html#eq:solver:lambda)
    as follows: Δλ=∑j​wj​∣∇pj​​C(p)∣2+α^−C(p)−α^λ​(32.5.2) Here, λ is the total accumulated
    Lagrange multiplier for the constraint from previous iterations within the current
    time step. The term α^ is the time-step scaled compliance, defined as: α^=(Δt)2α​
    This scaling ensures that the compliance parameter α has physically consistent
    units within the dynamical system. After computing Δλ, the solver updates both
    the particle positions and the accumulated Lagrange multiplier for that constraint:
    Δpi​=−Δλwi​∇pi​​C(p)andλ←λ+Δλ'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: XPBD的核心思想是将拉格朗日乘子 λ 不视为每次迭代重新计算的临时值，而视为一个表示累积冲量的物理量，该冲量是增量更新的。在每个求解器迭代中，我们计算一个冲量增量
    Δλ，并将其添加到该约束的总冲量 λ。这个增量公式的修改如下：Δλ=∑j​wj​∣∇pj​​C(p)∣2+α^−C(p)−α^λ​(32.5.2)。在这里，λ
    是当前时间步内之前迭代中约束的总累积拉格朗日乘子。α^ 是时间步缩放后的合规性，定义为：α^=(Δt)2α。这种缩放确保了合规性参数 α 在动力学系统内具有物理上一致的单位。计算
    Δλ 后，求解器会更新该约束的粒子位置和累积拉格朗日乘子：Δpi​=−Δλwi​∇pi​​C(p)和λ←λ+Δλ
- en: '***Remark 32.5.1 (Interpretation of XPBD).*** The +α^ term in the denominator
    of Equation [(32.5.2)](#eq:pbd:xpbd_delta_lambda) acts to limit the magnitude
    of the corrective impulse Δλ. As compliance α increases (i.e., the material becomes
    softer), α^ grows, thus reducing the impulse applied per iteration. In the case
    of zero compliance (α=0), the α^ terms vanish, and the formula for Δλ reduces
    to the standard PBD formulation in Equation [(32.4.3)](lec31.4-solver.html#eq:solver:lambda).'
  id: totrans-42
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '***备注 32.5.1（XPBD的解释）***。方程式 [(32.5.2)](#eq:pbd:xpbd_delta_lambda) 分母中的 +α^
    项旨在限制校正冲量 Δλ 的大小。随着合规性 α 的增加（即材料变得更柔软），α^ 增加，从而减少了每次迭代应用的冲量。在零合规性（α=0）的情况下，α^
    项消失，Δλ 的公式简化为方程式 [(32.4.3)](lec31.4-solver.html#eq:solver:lambda) 中的标准PBD公式。'
- en: The primary benefit of XPBD is **not faster convergence, but convergence to
    a physically consistent state that correctly reflects the user-defined compliance
    α**, independent of the time step or iteration count. If the solver is terminated
    early, the system still exhibits the desired softness to some degree rather than
    an artificial, uncontrolled compliance. This makes material behavior more predictable
    and robust.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: XPBD的主要优势**不是更快地收敛，而是收敛到一个物理上一致的状态，正确地反映了用户定义的合规性 α**，与时间步或迭代次数无关。如果求解器提前终止，系统仍然会表现出一定程度上的所需柔软性，而不是人工的、不受控制的合规性。这使得材料行为更加可预测和稳健。
