["```py\ndef q(a, b, c, x):\n    return a * (x ** 2) + b * x + c \n```", "```py\nx = np.linspace(-2, 2, 100)\nplt.plot(x, q(2, 4, -1, x))\nplt.plot(x, q(2, -4, 4, x))\nplt.plot(x, q(-2, 0, 4, x))\nplt.legend(['$y_1$', '$y_2$', '$y_3$'])\nplt.show() \n```", "```py\ndef opt_reps(X, k, assign):\n    (n, d) = X.shape\n    reps = np.zeros((k, d))\n    for i in range(k):\n        in_i = [j for j in range(n) if assign[j] == i]             \n        reps[i,:] = np.sum(X[in_i,:],axis=0) / len(in_i)\n    return reps\n\ndef opt_clust(X, k, reps):\n    (n, d) = X.shape\n    dist = np.zeros(n)\n    assign = np.zeros(n, dtype=int)\n    for j in range(n):\n        dist_to_i = np.array([LA.norm(X[j,:] - reps[i,:]) for i in range(k)])\n        assign[j] = np.argmin(dist_to_i)\n        dist[j] = dist_to_i[assign[j]]\n    G = np.sum(dist ** 2)\n    print(G)\n    return assign \n```", "```py\ndef kmeans(rng, X, k, maxiter=5):\n    (n, d) = X.shape\n    assign = rng.integers(0,k,n)\n    reps = np.zeros((k, d), dtype=int)\n    for iter in range(maxiter):\n        reps = opt_reps(X, k, assign) \n        assign = opt_clust(X, k, reps) \n    return assign \n```", "```py\nseed = 535\nrng = np.random.default_rng(seed)\nX = np.array([[1., 0.],[-2., 0.],[-2.,1.],[1.,-3.],\n              [-10.,10.],[2.,-2.],[-3.,1.],[3.,-1.]])\nassign = kmeans(rng, X, 3) \n```", "```py\n162.7\n74.8611111111111\n9.083333333333334\n9.083333333333334\n9.083333333333334 \n```", "```py\nplt.scatter(X[:,0], X[:,1], s=10, c=assign, cmap='brg')\nplt.axis([-11,4,-4,11])\nplt.show() \n```", "```py\nprint(opt_reps(X, 3, assign)) \n```", "```py\n[[ -2.33333333   0.66666667]\n [  1.75        -1.5       ]\n [-10\\.          10\\.        ]] \n```", "```py\ndata = pd.read_csv('penguins-measurements.csv')\ndata = data.dropna()\nX = data[['bill_length_mm', 'bill_depth_mm', \n        'flipper_length_mm', 'body_mass_g']].to_numpy() \n```", "```py\nplt.scatter(X[:,1], X[:,3], s=5, c='k')\nplt.xlabel('bill_depth_mm'), plt.ylabel('body_mass_g')\nplt.show() \n```", "```py\nmean = np.mean(X, axis=0)\nstd = np.std(X, axis=0)\nX = (X - mean) / std \n```", "```py\nassign = kmeans(rng, X, 2) \n```", "```py\n1338.2046936914157\n820.9361062178352\n603.8787658966849\n575.2587351391593\n567.7837494880662 \n```", "```py\nplt.scatter(X[:,1], X[:,3], s=5, c=assign, cmap='brg')\nplt.xlabel('bill_depth (standardized)'), plt.ylabel('body_mass (standardized)')\nplt.show() \n```", "```py\nassign = kmeans(rng, X, 3) \n```", "```py\n1312.344945158482\n577.1700837839458\n428.50397345437966\n392.2616692426171\n383.3452894259011 \n```", "```py\nplt.scatter(X[:,1], X[:,3], s=5, c=assign, cmap='brg')\nplt.xlabel('bill_depth (standardized)'), plt.ylabel('body_mass (standardized)')\nplt.show() \n```", "```py\nplt.scatter(X[:,0], X[:,3], s=5, c=assign, cmap='brg')\nplt.xlabel('bill_length (standardized)'), plt.ylabel('body_mass (standardized)')\nplt.show() \n```", "```py\ndata_truth = pd.read_csv('penguins-species.csv') \ndata_truth = data_truth.iloc[data.index]\ndata_truth.head() \n```", "```py\nspecies = data_truth['species']\nprint(species.unique()) \n```", "```py\n['Adelie' 'Chinstrap' 'Gentoo'] \n```", "```py\nspecies2color_dict = {'Adelie': 'blue', 'Chinstrap': 'lime', 'Gentoo': 'red'}\ntruth = [species2color_dict[a] for a in species] \n```", "```py\nf, (ax1, ax2) = plt.subplots(1, 2, sharex=True, sharey=True, figsize=(6.5, 3))\nax1.scatter(X[:,0], X[:,3], s=5, c=truth)\nax1.set_title('truth')\nax2.scatter(X[:,0], X[:,3], s=5, c=assign, cmap='brg')\nax2.set_title('kmeans')\nplt.show() \n```", "```py\ndef q(a, b, c, x):\n    return a * (x ** 2) + b * x + c \n```", "```py\nx = np.linspace(-2, 2, 100)\nplt.plot(x, q(2, 4, -1, x))\nplt.plot(x, q(2, -4, 4, x))\nplt.plot(x, q(-2, 0, 4, x))\nplt.legend(['$y_1$', '$y_2$', '$y_3$'])\nplt.show() \n```", "```py\ndef opt_reps(X, k, assign):\n    (n, d) = X.shape\n    reps = np.zeros((k, d))\n    for i in range(k):\n        in_i = [j for j in range(n) if assign[j] == i]             \n        reps[i,:] = np.sum(X[in_i,:],axis=0) / len(in_i)\n    return reps\n\ndef opt_clust(X, k, reps):\n    (n, d) = X.shape\n    dist = np.zeros(n)\n    assign = np.zeros(n, dtype=int)\n    for j in range(n):\n        dist_to_i = np.array([LA.norm(X[j,:] - reps[i,:]) for i in range(k)])\n        assign[j] = np.argmin(dist_to_i)\n        dist[j] = dist_to_i[assign[j]]\n    G = np.sum(dist ** 2)\n    print(G)\n    return assign \n```", "```py\ndef kmeans(rng, X, k, maxiter=5):\n    (n, d) = X.shape\n    assign = rng.integers(0,k,n)\n    reps = np.zeros((k, d), dtype=int)\n    for iter in range(maxiter):\n        reps = opt_reps(X, k, assign) \n        assign = opt_clust(X, k, reps) \n    return assign \n```", "```py\nseed = 535\nrng = np.random.default_rng(seed)\nX = np.array([[1., 0.],[-2., 0.],[-2.,1.],[1.,-3.],\n              [-10.,10.],[2.,-2.],[-3.,1.],[3.,-1.]])\nassign = kmeans(rng, X, 3) \n```", "```py\n162.7\n74.8611111111111\n9.083333333333334\n9.083333333333334\n9.083333333333334 \n```", "```py\nplt.scatter(X[:,0], X[:,1], s=10, c=assign, cmap='brg')\nplt.axis([-11,4,-4,11])\nplt.show() \n```", "```py\nprint(opt_reps(X, 3, assign)) \n```", "```py\n[[ -2.33333333   0.66666667]\n [  1.75        -1.5       ]\n [-10\\.          10\\.        ]] \n```", "```py\ndata = pd.read_csv('penguins-measurements.csv')\ndata = data.dropna()\nX = data[['bill_length_mm', 'bill_depth_mm', \n        'flipper_length_mm', 'body_mass_g']].to_numpy() \n```", "```py\nplt.scatter(X[:,1], X[:,3], s=5, c='k')\nplt.xlabel('bill_depth_mm'), plt.ylabel('body_mass_g')\nplt.show() \n```", "```py\nmean = np.mean(X, axis=0)\nstd = np.std(X, axis=0)\nX = (X - mean) / std \n```", "```py\nassign = kmeans(rng, X, 2) \n```", "```py\n1338.2046936914157\n820.9361062178352\n603.8787658966849\n575.2587351391593\n567.7837494880662 \n```", "```py\nplt.scatter(X[:,1], X[:,3], s=5, c=assign, cmap='brg')\nplt.xlabel('bill_depth (standardized)'), plt.ylabel('body_mass (standardized)')\nplt.show() \n```", "```py\nassign = kmeans(rng, X, 3) \n```", "```py\n1312.344945158482\n577.1700837839458\n428.50397345437966\n392.2616692426171\n383.3452894259011 \n```", "```py\nplt.scatter(X[:,1], X[:,3], s=5, c=assign, cmap='brg')\nplt.xlabel('bill_depth (standardized)'), plt.ylabel('body_mass (standardized)')\nplt.show() \n```", "```py\nplt.scatter(X[:,0], X[:,3], s=5, c=assign, cmap='brg')\nplt.xlabel('bill_length (standardized)'), plt.ylabel('body_mass (standardized)')\nplt.show() \n```", "```py\ndata_truth = pd.read_csv('penguins-species.csv') \ndata_truth = data_truth.iloc[data.index]\ndata_truth.head() \n```", "```py\nspecies = data_truth['species']\nprint(species.unique()) \n```", "```py\n['Adelie' 'Chinstrap' 'Gentoo'] \n```", "```py\nspecies2color_dict = {'Adelie': 'blue', 'Chinstrap': 'lime', 'Gentoo': 'red'}\ntruth = [species2color_dict[a] for a in species] \n```", "```py\nf, (ax1, ax2) = plt.subplots(1, 2, sharex=True, sharey=True, figsize=(6.5, 3))\nax1.scatter(X[:,0], X[:,3], s=5, c=truth)\nax1.set_title('truth')\nax2.scatter(X[:,0], X[:,3], s=5, c=assign, cmap='brg')\nax2.set_title('kmeans')\nplt.show() \n```"]