["```py\nimport networkx as nx\nimport matplotlib.pyplot as plt\n\nG = nx.Graph()\nedges = [(1, 2), (1, 3), (2, 3), (2, 4), (3, 5)]\nG.add_edges_from(edges)\npos = nx.spring_layout(G)\n\nnx.draw(G, pos, with_labels=True, node_color='lightblue', node_size=500, font_size=15)\nnx.draw_networkx_edges(G, pos, edgelist=[(1, 3), (2, 3), (2, 4)], edge_color='r', width=2)\nplt.show() \n```", "```py\ndef build_ssbm(n, p, q):\n\n    block_assignments = np.zeros(n, dtype=int)\n    block_assignments[n//2:] = 1\n\n    J = np.ones((n//2, n//2))\n\n    M_top = np.hstack((p * J, q * J))\n    M_bottom = np.hstack((q * J, p * J))\n    M = np.vstack((M_top, M_bottom))\n\n    return block_assignments, M \n```", "```py\nn = 10\np = 0.8\nq = 0.2\n\nblock_assignments, M = build_ssbm(n, p, q)\nprint(\"Block Assignments:\\n\", block_assignments)\nprint(\"Matrix M:\\n\", M) \n```", "```py\nBlock Assignments:\n [0 0 0 0 0 1 1 1 1 1]\nMatrix M:\n [[0.8 0.8 0.8 0.8 0.8 0.2 0.2 0.2 0.2 0.2]\n [0.8 0.8 0.8 0.8 0.8 0.2 0.2 0.2 0.2 0.2]\n [0.8 0.8 0.8 0.8 0.8 0.2 0.2 0.2 0.2 0.2]\n [0.8 0.8 0.8 0.8 0.8 0.2 0.2 0.2 0.2 0.2]\n [0.8 0.8 0.8 0.8 0.8 0.2 0.2 0.2 0.2 0.2]\n [0.2 0.2 0.2 0.2 0.2 0.8 0.8 0.8 0.8 0.8]\n [0.2 0.2 0.2 0.2 0.2 0.8 0.8 0.8 0.8 0.8]\n [0.2 0.2 0.2 0.2 0.2 0.8 0.8 0.8 0.8 0.8]\n [0.2 0.2 0.2 0.2 0.2 0.8 0.8 0.8 0.8 0.8]\n [0.2 0.2 0.2 0.2 0.2 0.8 0.8 0.8 0.8 0.8]] \n```", "```py\nseed = 535\nrng = np.random.default_rng(seed)\nG = mmids.inhomogeneous_er_random_graph(rng, n, M) \n```", "```py\nL = nx.laplacian_matrix(G).toarray()\neigenvalues, eigenvectors = LA.eigh(L) \n```", "```py\nprint(\"Laplacian Matrix:\\n\", L) \n```", "```py\nLaplacian Matrix:\n [[ 5  0 -1 -1 -1  0  0 -1 -1  0]\n [ 0  4  0 -1 -1  0  0  0 -1 -1]\n [-1  0  5 -1  0 -1 -1  0 -1  0]\n [-1 -1 -1  5 -1  0  0  0  0 -1]\n [-1 -1  0 -1  3  0  0  0  0  0]\n [ 0  0 -1  0  0  4 -1 -1 -1  0]\n [ 0  0 -1  0  0 -1  5 -1 -1 -1]\n [-1  0  0  0  0 -1 -1  5 -1 -1]\n [-1 -1 -1  0  0 -1 -1 -1  6  0]\n [ 0 -1  0 -1  0  0 -1 -1  0  4]] \n```", "```py\nprint(\"Eigenvalues:\\n\", eigenvalues) \n```", "```py\nEigenvalues:\n [-1.03227341e-15  1.83189278e+00  3.17040405e+00  4.36335953e+00\n  4.47745803e+00  5.00000000e+00  5.62350706e+00  6.78008860e+00\n  7.17298485e+00  7.58030511e+00] \n```", "```py\nprint(\"The first two eigenvectors:\\n\", eigenvectors[:,:2]) \n```", "```py\nThe first two eigenvectors:\n [[ 0.31622777  0.09163939]\n [ 0.31622777  0.3432291 ]\n [ 0.31622777 -0.17409747]\n [ 0.31622777  0.28393334]\n [ 0.31622777  0.61535604]\n [ 0.31622777 -0.42850888]\n [ 0.31622777 -0.32008722]\n [ 0.31622777 -0.25633242]\n [ 0.31622777 -0.17853607]\n [ 0.31622777  0.02340419]] \n```", "```py\nn = 100\np = 0.8\nq = 0.2\nblock_assignments, M = build_ssbm(n, p, q)\nG = mmids.inhomogeneous_er_random_graph(rng, n, M)\nL = nx.laplacian_matrix(G).toarray()\neigenvalues, eigenvectors = LA.eigh(L) \n```", "```py\nplt.figure(figsize=(10, 6))\nplt.hist(eigenvalues, bins=30, color='lightblue', edgecolor='black')\nplt.xlabel('Eigenvalue'), plt.ylabel('Frequency')\nplt.show() \n```", "```py\nfrom skimage import io, segmentation, color\nfrom skimage import graph\nfrom sklearn.cluster import KMeans \n```", "```py\nimg = io.imread('cell-nuclei.png')\nfig, ax = plt.subplots(figsize=(6, 6))\nax.imshow(img)\nplt.show() \n```", "```py\nimg = io.imread('wisconsin-regions.png')\nfig, ax = plt.subplots(figsize=(6, 6))\nax.imshow(img)\nplt.show() \n```", "```py\nimg.shape \n```", "```py\n(709, 652, 3) \n```", "```py\nimg[300,400,:] \n```", "```py\narray([111, 172, 232], dtype=uint8) \n```", "```py\nplt.imshow(np.reshape(img[300,400,:],(1,1,3)))\nplt.show() \n```", "```py\nlabels1 = segmentation.slic(img, \n                            compactness=25, \n                            n_segments=100, \n                            sigma=2., \n                            start_label=0)\nprint(labels1) \n```", "```py\n[[ 0  0  0 ...  8  8  8]\n [ 0  0  0 ...  8  8  8]\n [ 0  0  0 ...  8  8  8]\n ...\n [77 77 77 ... 79 79 79]\n [77 77 77 ... 79 79 79]\n [77 77 77 ... 79 79 79]] \n```", "```py\nout1 = color.label2rgb(labels1, img/255, kind='avg', bg_label=0)\nout1.shape \n```", "```py\n(709, 652, 3) \n```", "```py\nfig, ax = plt.subplots(figsize=(6, 6))\nax.imshow(out1)\nplt.show() \n```", "```py\ng = graph.rag_mean_color(img, labels1, mode='similarity')\nnx.draw(g, pos=nx.spring_layout(g)) \n```", "```py\nfig, ax = plt.subplots(nrows=1, figsize=(6, 8))\nlc = graph.show_rag(labels1, g, img, ax=ax)\nfig.colorbar(lc, fraction=0.05, ax=ax)\nplt.show() \n```", "```py\nL = nx.laplacian_matrix(g).toarray()\nprint(L) \n```", "```py\n[[ 9.93627574e-01 -9.93627545e-01  0.00000000e+00 ...  0.00000000e+00\n   0.00000000e+00  0.00000000e+00]\n [-9.93627545e-01  1.98331432e+00 -9.89686777e-01 ...  0.00000000e+00\n   0.00000000e+00  0.00000000e+00]\n [ 0.00000000e+00 -9.89686777e-01  1.72084919e+00 ...  0.00000000e+00\n   0.00000000e+00  0.00000000e+00]\n ...\n [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 ...  4.03242708e-05\n   0.00000000e+00  0.00000000e+00]\n [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 ...  0.00000000e+00\n   7.93893423e-01  0.00000000e+00]\n [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 ...  0.00000000e+00\n   0.00000000e+00  1.99992197e+00]] \n```", "```py\nw, v = LA.eigh(L)\nplt.plot(np.sort(w))\nplt.show() \n```", "```py\nndims = 15 # number of dimensions to project to\nnsegs = 10 # number of segments\n\ntop = np.argsort(w)[1:ndims]\ntopvecs = v[:,top]\ntopvals = w[top]\n\nkmeans = KMeans(n_clusters=nsegs, random_state=12345).fit(topvecs)\nassign_seg = kmeans.labels_\nprint(assign_seg) \n```", "```py\n[1 1 1 1 1 1 1 1 1 2 9 1 1 2 1 1 1 9 8 1 9 6 9 2 1 9 1 9 2 9 9 2 2 4 1 2 9\n 9 2 4 3 2 4 4 2 2 9 2 4 3 1 5 2 4 3 4 2 0 5 4 5 3 3 4 0 0 0 5 5 1 5 1 3 0\n 0 0 5 5 7 3 5] \n```", "```py\nlabels2 = assign_seg[labels1]\nprint(labels2) \n```", "```py\n[[1 1 1 ... 1 1 1]\n [1 1 1 ... 1 1 1]\n [1 1 1 ... 1 1 1]\n ...\n [5 5 5 ... 3 3 3]\n [5 5 5 ... 3 3 3]\n [5 5 5 ... 3 3 3]] \n```", "```py\nout2 = color.label2rgb(labels2, kind='overlay', bg_label=0)\nout2.shape \n```", "```py\n(709, 652, 3) \n```", "```py\nfig, ax = plt.subplots(nrows=2, sharex=True, sharey=True, figsize=(16, 8))\nax[0].imshow(img)\nax[1].imshow(out2)\nplt.show() \n```", "```py\ndef imgseg_rag(img, compactness=30, n_spixels=400, sigma=0., figsize=(10,10)):\n    labels1 = segmentation.slic(img, \n                                compactness=compactness, \n                                n_segments=n_spixels, \n                                sigma=sigma, \n                                start_label=0)\n    out1 = color.label2rgb(labels1, img/255, kind='avg', bg_label=0)\n    g = graph.rag_mean_color(img, labels1, mode='similarity')\n    fig, ax = plt.subplots(figsize=figsize)\n    ax.imshow(out1)\n    plt.show()\n    return labels1, g \n```", "```py\ndef imgseg_eig(g):\n    L = nx.laplacian_matrix(g).toarray()\n    w, v = LA.eigh(L)\n    plt.plot(np.sort(w))\n    plt.show()\n    return w,v \n```", "```py\ndef imgseg_labels(w, v, n_dims=10, n_segments=5, random_state=0):\n    top = np.argsort(w)[1:n_dims]\n    topvecs = v[:,top]\n    topvals = w[top]\n    kmeans = KMeans(n_clusters=n_segments, \n                    random_state=random_state).fit(topvecs)\n    assign_seg = kmeans.labels_\n    labels2 = assign_seg[labels1]\n    return labels2 \n```", "```py\ndef imgseg_viz(img, labels2, figsize=(20,10)):\n    out2 = color.label2rgb(labels2, kind='overlay', bg_label=0)\n    fig, ax = plt.subplots(nrows=2, sharex=True, sharey=True, figsize=figsize)\n    ax[0].imshow(img)\n    ax[1].imshow(out2)\n    plt.show() \n```", "```py\nimg = io.imread('two-badgers.jpg')\nfig, ax = plt.subplots(figsize=(10, 10))\nax.imshow(img)\nplt.show() \n```", "```py\nlabels1, g = imgseg_rag(img, \n                        compactness=30, \n                        n_spixels=1000, \n                        sigma=0., \n                        figsize=(10,10)) \n```", "```py\nw, v = imgseg_eig(g) \n```", "```py\nlabels2 = imgseg_labels(w, v, n_dims=60, n_segments=50, random_state=535)\nimgseg_viz(img,labels2,figsize=(20,10)) \n```", "```py\nimg = io.imread('cell-nuclei.png')\nlabels1, g = imgseg_rag(img,compactness=40,n_spixels=300,sigma=0.1,figsize=(6,6)) \n```", "```py\nw, v = imgseg_eig(g) \n```", "```py\nlabels2 = imgseg_labels(w, v, n_dims=40, n_segments=30, random_state=535)\nimgseg_viz(img,labels2,figsize=(20,10)) \n```", "```py\nlabels2 = graph.cut_normalized(labels1, g)\nimgseg_viz(img,labels2,figsize=(20,10)) \n```", "```py\nimport networkx as nx\nimport matplotlib.pyplot as plt\n\nG = nx.Graph()\nedges = [(1, 2), (1, 3), (2, 3), (2, 4), (3, 5)]\nG.add_edges_from(edges)\npos = nx.spring_layout(G)\n\nnx.draw(G, pos, with_labels=True, node_color='lightblue', node_size=500, font_size=15)\nnx.draw_networkx_edges(G, pos, edgelist=[(1, 3), (2, 3), (2, 4)], edge_color='r', width=2)\nplt.show() \n```", "```py\nimport networkx as nx\nimport matplotlib.pyplot as plt\n\nG = nx.Graph()\nedges = [(1, 2), (1, 3), (2, 3), (2, 4), (3, 5)]\nG.add_edges_from(edges)\npos = nx.spring_layout(G)\n\nnx.draw(G, pos, with_labels=True, node_color='lightblue', node_size=500, font_size=15)\nnx.draw_networkx_edges(G, pos, edgelist=[(1, 3), (2, 3), (2, 4)], edge_color='r', width=2)\nplt.show() \n```", "```py\ndef build_ssbm(n, p, q):\n\n    block_assignments = np.zeros(n, dtype=int)\n    block_assignments[n//2:] = 1\n\n    J = np.ones((n//2, n//2))\n\n    M_top = np.hstack((p * J, q * J))\n    M_bottom = np.hstack((q * J, p * J))\n    M = np.vstack((M_top, M_bottom))\n\n    return block_assignments, M \n```", "```py\nn = 10\np = 0.8\nq = 0.2\n\nblock_assignments, M = build_ssbm(n, p, q)\nprint(\"Block Assignments:\\n\", block_assignments)\nprint(\"Matrix M:\\n\", M) \n```", "```py\nBlock Assignments:\n [0 0 0 0 0 1 1 1 1 1]\nMatrix M:\n [[0.8 0.8 0.8 0.8 0.8 0.2 0.2 0.2 0.2 0.2]\n [0.8 0.8 0.8 0.8 0.8 0.2 0.2 0.2 0.2 0.2]\n [0.8 0.8 0.8 0.8 0.8 0.2 0.2 0.2 0.2 0.2]\n [0.8 0.8 0.8 0.8 0.8 0.2 0.2 0.2 0.2 0.2]\n [0.8 0.8 0.8 0.8 0.8 0.2 0.2 0.2 0.2 0.2]\n [0.2 0.2 0.2 0.2 0.2 0.8 0.8 0.8 0.8 0.8]\n [0.2 0.2 0.2 0.2 0.2 0.8 0.8 0.8 0.8 0.8]\n [0.2 0.2 0.2 0.2 0.2 0.8 0.8 0.8 0.8 0.8]\n [0.2 0.2 0.2 0.2 0.2 0.8 0.8 0.8 0.8 0.8]\n [0.2 0.2 0.2 0.2 0.2 0.8 0.8 0.8 0.8 0.8]] \n```", "```py\nseed = 535\nrng = np.random.default_rng(seed)\nG = mmids.inhomogeneous_er_random_graph(rng, n, M) \n```", "```py\nL = nx.laplacian_matrix(G).toarray()\neigenvalues, eigenvectors = LA.eigh(L) \n```", "```py\nprint(\"Laplacian Matrix:\\n\", L) \n```", "```py\nLaplacian Matrix:\n [[ 5  0 -1 -1 -1  0  0 -1 -1  0]\n [ 0  4  0 -1 -1  0  0  0 -1 -1]\n [-1  0  5 -1  0 -1 -1  0 -1  0]\n [-1 -1 -1  5 -1  0  0  0  0 -1]\n [-1 -1  0 -1  3  0  0  0  0  0]\n [ 0  0 -1  0  0  4 -1 -1 -1  0]\n [ 0  0 -1  0  0 -1  5 -1 -1 -1]\n [-1  0  0  0  0 -1 -1  5 -1 -1]\n [-1 -1 -1  0  0 -1 -1 -1  6  0]\n [ 0 -1  0 -1  0  0 -1 -1  0  4]] \n```", "```py\nprint(\"Eigenvalues:\\n\", eigenvalues) \n```", "```py\nEigenvalues:\n [-1.03227341e-15  1.83189278e+00  3.17040405e+00  4.36335953e+00\n  4.47745803e+00  5.00000000e+00  5.62350706e+00  6.78008860e+00\n  7.17298485e+00  7.58030511e+00] \n```", "```py\nprint(\"The first two eigenvectors:\\n\", eigenvectors[:,:2]) \n```", "```py\nThe first two eigenvectors:\n [[ 0.31622777  0.09163939]\n [ 0.31622777  0.3432291 ]\n [ 0.31622777 -0.17409747]\n [ 0.31622777  0.28393334]\n [ 0.31622777  0.61535604]\n [ 0.31622777 -0.42850888]\n [ 0.31622777 -0.32008722]\n [ 0.31622777 -0.25633242]\n [ 0.31622777 -0.17853607]\n [ 0.31622777  0.02340419]] \n```", "```py\nn = 100\np = 0.8\nq = 0.2\nblock_assignments, M = build_ssbm(n, p, q)\nG = mmids.inhomogeneous_er_random_graph(rng, n, M)\nL = nx.laplacian_matrix(G).toarray()\neigenvalues, eigenvectors = LA.eigh(L) \n```", "```py\nplt.figure(figsize=(10, 6))\nplt.hist(eigenvalues, bins=30, color='lightblue', edgecolor='black')\nplt.xlabel('Eigenvalue'), plt.ylabel('Frequency')\nplt.show() \n```", "```py\nfrom skimage import io, segmentation, color\nfrom skimage import graph\nfrom sklearn.cluster import KMeans \n```", "```py\nimg = io.imread('cell-nuclei.png')\nfig, ax = plt.subplots(figsize=(6, 6))\nax.imshow(img)\nplt.show() \n```", "```py\nimg = io.imread('wisconsin-regions.png')\nfig, ax = plt.subplots(figsize=(6, 6))\nax.imshow(img)\nplt.show() \n```", "```py\nimg.shape \n```", "```py\n(709, 652, 3) \n```", "```py\nimg[300,400,:] \n```", "```py\narray([111, 172, 232], dtype=uint8) \n```", "```py\nplt.imshow(np.reshape(img[300,400,:],(1,1,3)))\nplt.show() \n```", "```py\nlabels1 = segmentation.slic(img, \n                            compactness=25, \n                            n_segments=100, \n                            sigma=2., \n                            start_label=0)\nprint(labels1) \n```", "```py\n[[ 0  0  0 ...  8  8  8]\n [ 0  0  0 ...  8  8  8]\n [ 0  0  0 ...  8  8  8]\n ...\n [77 77 77 ... 79 79 79]\n [77 77 77 ... 79 79 79]\n [77 77 77 ... 79 79 79]] \n```", "```py\nout1 = color.label2rgb(labels1, img/255, kind='avg', bg_label=0)\nout1.shape \n```", "```py\n(709, 652, 3) \n```", "```py\nfig, ax = plt.subplots(figsize=(6, 6))\nax.imshow(out1)\nplt.show() \n```", "```py\ng = graph.rag_mean_color(img, labels1, mode='similarity')\nnx.draw(g, pos=nx.spring_layout(g)) \n```", "```py\nfig, ax = plt.subplots(nrows=1, figsize=(6, 8))\nlc = graph.show_rag(labels1, g, img, ax=ax)\nfig.colorbar(lc, fraction=0.05, ax=ax)\nplt.show() \n```", "```py\nL = nx.laplacian_matrix(g).toarray()\nprint(L) \n```", "```py\n[[ 9.93627574e-01 -9.93627545e-01  0.00000000e+00 ...  0.00000000e+00\n   0.00000000e+00  0.00000000e+00]\n [-9.93627545e-01  1.98331432e+00 -9.89686777e-01 ...  0.00000000e+00\n   0.00000000e+00  0.00000000e+00]\n [ 0.00000000e+00 -9.89686777e-01  1.72084919e+00 ...  0.00000000e+00\n   0.00000000e+00  0.00000000e+00]\n ...\n [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 ...  4.03242708e-05\n   0.00000000e+00  0.00000000e+00]\n [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 ...  0.00000000e+00\n   7.93893423e-01  0.00000000e+00]\n [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 ...  0.00000000e+00\n   0.00000000e+00  1.99992197e+00]] \n```", "```py\nw, v = LA.eigh(L)\nplt.plot(np.sort(w))\nplt.show() \n```", "```py\nndims = 15 # number of dimensions to project to\nnsegs = 10 # number of segments\n\ntop = np.argsort(w)[1:ndims]\ntopvecs = v[:,top]\ntopvals = w[top]\n\nkmeans = KMeans(n_clusters=nsegs, random_state=12345).fit(topvecs)\nassign_seg = kmeans.labels_\nprint(assign_seg) \n```", "```py\n[1 1 1 1 1 1 1 1 1 2 9 1 1 2 1 1 1 9 8 1 9 6 9 2 1 9 1 9 2 9 9 2 2 4 1 2 9\n 9 2 4 3 2 4 4 2 2 9 2 4 3 1 5 2 4 3 4 2 0 5 4 5 3 3 4 0 0 0 5 5 1 5 1 3 0\n 0 0 5 5 7 3 5] \n```", "```py\nlabels2 = assign_seg[labels1]\nprint(labels2) \n```", "```py\n[[1 1 1 ... 1 1 1]\n [1 1 1 ... 1 1 1]\n [1 1 1 ... 1 1 1]\n ...\n [5 5 5 ... 3 3 3]\n [5 5 5 ... 3 3 3]\n [5 5 5 ... 3 3 3]] \n```", "```py\nout2 = color.label2rgb(labels2, kind='overlay', bg_label=0)\nout2.shape \n```", "```py\n(709, 652, 3) \n```", "```py\nfig, ax = plt.subplots(nrows=2, sharex=True, sharey=True, figsize=(16, 8))\nax[0].imshow(img)\nax[1].imshow(out2)\nplt.show() \n```", "```py\ndef imgseg_rag(img, compactness=30, n_spixels=400, sigma=0., figsize=(10,10)):\n    labels1 = segmentation.slic(img, \n                                compactness=compactness, \n                                n_segments=n_spixels, \n                                sigma=sigma, \n                                start_label=0)\n    out1 = color.label2rgb(labels1, img/255, kind='avg', bg_label=0)\n    g = graph.rag_mean_color(img, labels1, mode='similarity')\n    fig, ax = plt.subplots(figsize=figsize)\n    ax.imshow(out1)\n    plt.show()\n    return labels1, g \n```", "```py\ndef imgseg_eig(g):\n    L = nx.laplacian_matrix(g).toarray()\n    w, v = LA.eigh(L)\n    plt.plot(np.sort(w))\n    plt.show()\n    return w,v \n```", "```py\ndef imgseg_labels(w, v, n_dims=10, n_segments=5, random_state=0):\n    top = np.argsort(w)[1:n_dims]\n    topvecs = v[:,top]\n    topvals = w[top]\n    kmeans = KMeans(n_clusters=n_segments, \n                    random_state=random_state).fit(topvecs)\n    assign_seg = kmeans.labels_\n    labels2 = assign_seg[labels1]\n    return labels2 \n```", "```py\ndef imgseg_viz(img, labels2, figsize=(20,10)):\n    out2 = color.label2rgb(labels2, kind='overlay', bg_label=0)\n    fig, ax = plt.subplots(nrows=2, sharex=True, sharey=True, figsize=figsize)\n    ax[0].imshow(img)\n    ax[1].imshow(out2)\n    plt.show() \n```", "```py\nimg = io.imread('two-badgers.jpg')\nfig, ax = plt.subplots(figsize=(10, 10))\nax.imshow(img)\nplt.show() \n```", "```py\nlabels1, g = imgseg_rag(img, \n                        compactness=30, \n                        n_spixels=1000, \n                        sigma=0., \n                        figsize=(10,10)) \n```", "```py\nw, v = imgseg_eig(g) \n```", "```py\nlabels2 = imgseg_labels(w, v, n_dims=60, n_segments=50, random_state=535)\nimgseg_viz(img,labels2,figsize=(20,10)) \n```", "```py\nimg = io.imread('cell-nuclei.png')\nlabels1, g = imgseg_rag(img,compactness=40,n_spixels=300,sigma=0.1,figsize=(6,6)) \n```", "```py\nw, v = imgseg_eig(g) \n```", "```py\nlabels2 = imgseg_labels(w, v, n_dims=40, n_segments=30, random_state=535)\nimgseg_viz(img,labels2,figsize=(20,10)) \n```", "```py\nlabels2 = graph.cut_normalized(labels1, g)\nimgseg_viz(img,labels2,figsize=(20,10)) \n```", "```py\ndef build_ssbm(n, p, q):\n\n    block_assignments = np.zeros(n, dtype=int)\n    block_assignments[n//2:] = 1\n\n    J = np.ones((n//2, n//2))\n\n    M_top = np.hstack((p * J, q * J))\n    M_bottom = np.hstack((q * J, p * J))\n    M = np.vstack((M_top, M_bottom))\n\n    return block_assignments, M \n```", "```py\nn = 10\np = 0.8\nq = 0.2\n\nblock_assignments, M = build_ssbm(n, p, q)\nprint(\"Block Assignments:\\n\", block_assignments)\nprint(\"Matrix M:\\n\", M) \n```", "```py\nBlock Assignments:\n [0 0 0 0 0 1 1 1 1 1]\nMatrix M:\n [[0.8 0.8 0.8 0.8 0.8 0.2 0.2 0.2 0.2 0.2]\n [0.8 0.8 0.8 0.8 0.8 0.2 0.2 0.2 0.2 0.2]\n [0.8 0.8 0.8 0.8 0.8 0.2 0.2 0.2 0.2 0.2]\n [0.8 0.8 0.8 0.8 0.8 0.2 0.2 0.2 0.2 0.2]\n [0.8 0.8 0.8 0.8 0.8 0.2 0.2 0.2 0.2 0.2]\n [0.2 0.2 0.2 0.2 0.2 0.8 0.8 0.8 0.8 0.8]\n [0.2 0.2 0.2 0.2 0.2 0.8 0.8 0.8 0.8 0.8]\n [0.2 0.2 0.2 0.2 0.2 0.8 0.8 0.8 0.8 0.8]\n [0.2 0.2 0.2 0.2 0.2 0.8 0.8 0.8 0.8 0.8]\n [0.2 0.2 0.2 0.2 0.2 0.8 0.8 0.8 0.8 0.8]] \n```", "```py\nseed = 535\nrng = np.random.default_rng(seed)\nG = mmids.inhomogeneous_er_random_graph(rng, n, M) \n```", "```py\nL = nx.laplacian_matrix(G).toarray()\neigenvalues, eigenvectors = LA.eigh(L) \n```", "```py\nprint(\"Laplacian Matrix:\\n\", L) \n```", "```py\nLaplacian Matrix:\n [[ 5  0 -1 -1 -1  0  0 -1 -1  0]\n [ 0  4  0 -1 -1  0  0  0 -1 -1]\n [-1  0  5 -1  0 -1 -1  0 -1  0]\n [-1 -1 -1  5 -1  0  0  0  0 -1]\n [-1 -1  0 -1  3  0  0  0  0  0]\n [ 0  0 -1  0  0  4 -1 -1 -1  0]\n [ 0  0 -1  0  0 -1  5 -1 -1 -1]\n [-1  0  0  0  0 -1 -1  5 -1 -1]\n [-1 -1 -1  0  0 -1 -1 -1  6  0]\n [ 0 -1  0 -1  0  0 -1 -1  0  4]] \n```", "```py\nprint(\"Eigenvalues:\\n\", eigenvalues) \n```", "```py\nEigenvalues:\n [-1.03227341e-15  1.83189278e+00  3.17040405e+00  4.36335953e+00\n  4.47745803e+00  5.00000000e+00  5.62350706e+00  6.78008860e+00\n  7.17298485e+00  7.58030511e+00] \n```", "```py\nprint(\"The first two eigenvectors:\\n\", eigenvectors[:,:2]) \n```", "```py\nThe first two eigenvectors:\n [[ 0.31622777  0.09163939]\n [ 0.31622777  0.3432291 ]\n [ 0.31622777 -0.17409747]\n [ 0.31622777  0.28393334]\n [ 0.31622777  0.61535604]\n [ 0.31622777 -0.42850888]\n [ 0.31622777 -0.32008722]\n [ 0.31622777 -0.25633242]\n [ 0.31622777 -0.17853607]\n [ 0.31622777  0.02340419]] \n```", "```py\nn = 100\np = 0.8\nq = 0.2\nblock_assignments, M = build_ssbm(n, p, q)\nG = mmids.inhomogeneous_er_random_graph(rng, n, M)\nL = nx.laplacian_matrix(G).toarray()\neigenvalues, eigenvectors = LA.eigh(L) \n```", "```py\nplt.figure(figsize=(10, 6))\nplt.hist(eigenvalues, bins=30, color='lightblue', edgecolor='black')\nplt.xlabel('Eigenvalue'), plt.ylabel('Frequency')\nplt.show() \n```", "```py\nfrom skimage import io, segmentation, color\nfrom skimage import graph\nfrom sklearn.cluster import KMeans \n```", "```py\nimg = io.imread('cell-nuclei.png')\nfig, ax = plt.subplots(figsize=(6, 6))\nax.imshow(img)\nplt.show() \n```", "```py\nimg = io.imread('wisconsin-regions.png')\nfig, ax = plt.subplots(figsize=(6, 6))\nax.imshow(img)\nplt.show() \n```", "```py\nimg.shape \n```", "```py\n(709, 652, 3) \n```", "```py\nimg[300,400,:] \n```", "```py\narray([111, 172, 232], dtype=uint8) \n```", "```py\nplt.imshow(np.reshape(img[300,400,:],(1,1,3)))\nplt.show() \n```", "```py\nlabels1 = segmentation.slic(img, \n                            compactness=25, \n                            n_segments=100, \n                            sigma=2., \n                            start_label=0)\nprint(labels1) \n```", "```py\n[[ 0  0  0 ...  8  8  8]\n [ 0  0  0 ...  8  8  8]\n [ 0  0  0 ...  8  8  8]\n ...\n [77 77 77 ... 79 79 79]\n [77 77 77 ... 79 79 79]\n [77 77 77 ... 79 79 79]] \n```", "```py\nout1 = color.label2rgb(labels1, img/255, kind='avg', bg_label=0)\nout1.shape \n```", "```py\n(709, 652, 3) \n```", "```py\nfig, ax = plt.subplots(figsize=(6, 6))\nax.imshow(out1)\nplt.show() \n```", "```py\ng = graph.rag_mean_color(img, labels1, mode='similarity')\nnx.draw(g, pos=nx.spring_layout(g)) \n```", "```py\nfig, ax = plt.subplots(nrows=1, figsize=(6, 8))\nlc = graph.show_rag(labels1, g, img, ax=ax)\nfig.colorbar(lc, fraction=0.05, ax=ax)\nplt.show() \n```", "```py\nL = nx.laplacian_matrix(g).toarray()\nprint(L) \n```", "```py\n[[ 9.93627574e-01 -9.93627545e-01  0.00000000e+00 ...  0.00000000e+00\n   0.00000000e+00  0.00000000e+00]\n [-9.93627545e-01  1.98331432e+00 -9.89686777e-01 ...  0.00000000e+00\n   0.00000000e+00  0.00000000e+00]\n [ 0.00000000e+00 -9.89686777e-01  1.72084919e+00 ...  0.00000000e+00\n   0.00000000e+00  0.00000000e+00]\n ...\n [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 ...  4.03242708e-05\n   0.00000000e+00  0.00000000e+00]\n [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 ...  0.00000000e+00\n   7.93893423e-01  0.00000000e+00]\n [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 ...  0.00000000e+00\n   0.00000000e+00  1.99992197e+00]] \n```", "```py\nw, v = LA.eigh(L)\nplt.plot(np.sort(w))\nplt.show() \n```", "```py\nndims = 15 # number of dimensions to project to\nnsegs = 10 # number of segments\n\ntop = np.argsort(w)[1:ndims]\ntopvecs = v[:,top]\ntopvals = w[top]\n\nkmeans = KMeans(n_clusters=nsegs, random_state=12345).fit(topvecs)\nassign_seg = kmeans.labels_\nprint(assign_seg) \n```", "```py\n[1 1 1 1 1 1 1 1 1 2 9 1 1 2 1 1 1 9 8 1 9 6 9 2 1 9 1 9 2 9 9 2 2 4 1 2 9\n 9 2 4 3 2 4 4 2 2 9 2 4 3 1 5 2 4 3 4 2 0 5 4 5 3 3 4 0 0 0 5 5 1 5 1 3 0\n 0 0 5 5 7 3 5] \n```", "```py\nlabels2 = assign_seg[labels1]\nprint(labels2) \n```", "```py\n[[1 1 1 ... 1 1 1]\n [1 1 1 ... 1 1 1]\n [1 1 1 ... 1 1 1]\n ...\n [5 5 5 ... 3 3 3]\n [5 5 5 ... 3 3 3]\n [5 5 5 ... 3 3 3]] \n```", "```py\nout2 = color.label2rgb(labels2, kind='overlay', bg_label=0)\nout2.shape \n```", "```py\n(709, 652, 3) \n```", "```py\nfig, ax = plt.subplots(nrows=2, sharex=True, sharey=True, figsize=(16, 8))\nax[0].imshow(img)\nax[1].imshow(out2)\nplt.show() \n```", "```py\ndef imgseg_rag(img, compactness=30, n_spixels=400, sigma=0., figsize=(10,10)):\n    labels1 = segmentation.slic(img, \n                                compactness=compactness, \n                                n_segments=n_spixels, \n                                sigma=sigma, \n                                start_label=0)\n    out1 = color.label2rgb(labels1, img/255, kind='avg', bg_label=0)\n    g = graph.rag_mean_color(img, labels1, mode='similarity')\n    fig, ax = plt.subplots(figsize=figsize)\n    ax.imshow(out1)\n    plt.show()\n    return labels1, g \n```", "```py\ndef imgseg_eig(g):\n    L = nx.laplacian_matrix(g).toarray()\n    w, v = LA.eigh(L)\n    plt.plot(np.sort(w))\n    plt.show()\n    return w,v \n```", "```py\ndef imgseg_labels(w, v, n_dims=10, n_segments=5, random_state=0):\n    top = np.argsort(w)[1:n_dims]\n    topvecs = v[:,top]\n    topvals = w[top]\n    kmeans = KMeans(n_clusters=n_segments, \n                    random_state=random_state).fit(topvecs)\n    assign_seg = kmeans.labels_\n    labels2 = assign_seg[labels1]\n    return labels2 \n```", "```py\ndef imgseg_viz(img, labels2, figsize=(20,10)):\n    out2 = color.label2rgb(labels2, kind='overlay', bg_label=0)\n    fig, ax = plt.subplots(nrows=2, sharex=True, sharey=True, figsize=figsize)\n    ax[0].imshow(img)\n    ax[1].imshow(out2)\n    plt.show() \n```", "```py\nimg = io.imread('two-badgers.jpg')\nfig, ax = plt.subplots(figsize=(10, 10))\nax.imshow(img)\nplt.show() \n```", "```py\nlabels1, g = imgseg_rag(img, \n                        compactness=30, \n                        n_spixels=1000, \n                        sigma=0., \n                        figsize=(10,10)) \n```", "```py\nw, v = imgseg_eig(g) \n```", "```py\nlabels2 = imgseg_labels(w, v, n_dims=60, n_segments=50, random_state=535)\nimgseg_viz(img,labels2,figsize=(20,10)) \n```", "```py\nimg = io.imread('cell-nuclei.png')\nlabels1, g = imgseg_rag(img,compactness=40,n_spixels=300,sigma=0.1,figsize=(6,6)) \n```", "```py\nw, v = imgseg_eig(g) \n```", "```py\nlabels2 = imgseg_labels(w, v, n_dims=40, n_segments=30, random_state=535)\nimgseg_viz(img,labels2,figsize=(20,10)) \n```", "```py\nlabels2 = graph.cut_normalized(labels1, g)\nimgseg_viz(img,labels2,figsize=(20,10)) \n```"]