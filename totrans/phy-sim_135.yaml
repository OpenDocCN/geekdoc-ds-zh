- en: Model Reduction for Nonlinear Systems
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 非线性系统的模型降阶
- en: 原文：[https://phys-sim-book.github.io/lec25.8-nonlinear_reductions.html](https://phys-sim-book.github.io/lec25.8-nonlinear_reductions.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://phys-sim-book.github.io/lec25.8-nonlinear_reductions.html](https://phys-sim-book.github.io/lec25.8-nonlinear_reductions.html)
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
- en: Linear modal analysis is remarkably efficient, but its underlying assumption
    of small deformations is a major limitation. For simulating visually rich phenomena
    like buckling, large bending, or twisting, a linear model produces severe visual
    artifacts. As shown in the previous section, a simple linear model fails to capture
    the natural foreshortening that occurs when an object bends, resulting in an unrealistic
    extension of length and volume. To correctly capture these essential nonlinear
    effects, we must apply model reduction to the full nonlinear equations of motion.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 线性模态分析非常高效，但其基于小变形的假设是一个主要的限制。对于模拟如屈曲、大弯曲或扭转等视觉丰富的现象，线性模型会产生严重的视觉伪影。如前节所示，一个简单的线性模型无法捕捉到物体弯曲时发生的自然缩短，导致长度和体积的不现实扩展。为了正确捕捉这些基本非线性效应，我们必须将模型降阶应用于完整的非线性运动方程。
- en: '[Projecting the Nonlinear Equations](#projecting-the-nonlinear-equations)'
  id: totrans-4
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[投影非线性方程](#projecting-the-nonlinear-equations)'
- en: 'The equation of motion for a general hyperelastic object, including damping,
    is:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 对于一个一般超弹性物体的运动方程，包括阻尼，为：
- en: Mu¨+Du˙+fint​(u)=fext​.(26.3.1)
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: Mu¨+Du˙+fint​(u)=fext​.(26.3.1)
- en: Here, the linear elastic force Ku is replaced by a general **internal force
    function** fint​(u), which can be a complex nonlinear function of the displacements
    u. This nonlinearity can arise from the material model (stress-strain relationship)
    or from the strain measure itself (geometric nonlinearity).
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，线性弹性力 Ku 被一个通用的 **内部力函数** fint​(u) 所替代，它可以是一个关于位移 u 的复杂非线性函数。这种非线性可能来自材料模型（应力-应变关系）或来自应变测量本身（几何非线性）。
- en: 'We follow the same projection-based procedure as in the linear case. We assume
    the existence of a suitable basis matrix U∈R3n×r (where r≪3n)—more on the choice
    of basis in the next section-and approximate the full-space displacements u using
    the reduced coordinates q∈Rr:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 我们遵循与线性情况相同的基于投影的步骤。我们假设存在一个合适的基矩阵 U∈R3n×r（其中 r≪3n）——关于基的选择将在下一节中详细讨论——并使用简化的坐标
    q∈Rr 来近似全空间的位移 u：
- en: u(t)≈Uq(t).
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: u(t)≈Uq(t).
- en: 'Substituting this into [(26.3.1)](#eq:lec26:nonlinear_system) and pre-multiplying
    by UT to project the dynamics onto the subspace yields the **reduced nonlinear
    equation of motion**:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 将其代入 [(26.3.1)](#eq:lec26:nonlinear_system) 并通过前乘 UT 投影到子空间，得到 **简化非线性运动方程**：
- en: UTMUq¨​+UTDUq˙​+UTfint​(Uq)=UTfext​.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: UTMUq¨​+UTDUq˙​+UTfint​(Uq)=UTfext​.
- en: 'Assuming we have constructed a mass-orthonormal basis such that UTMU=I, this
    simplifies to:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们已经构建了一个质量正交基，使得 UTMU=I，这简化为：
- en: q¨​+D^q˙​+f^int​(q)=f^ext​,(26.3.2)
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: q¨​+D^q˙​+f^int​(q)=f^ext​,(26.3.2)
- en: 'where:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 其中：
- en: D^=UTDU is the r×r reduced damping matrix.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: D^=UTDU 是 r×r 的简化阻尼矩阵。
- en: f^int​(q)=UTfint​(Uq) is the r×1 **reduced internal force** vector.
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: f^int​(q)=UTfint​(Uq) 是 r×1 的 **简化内部力**向量。
- en: f^ext​=UTfext​ is the r×1 reduced external force vector.
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: f^ext​=UTfext​ 是 r×1 的简化外部力向量。
- en: 'Unlike the linear case, the reduced system in [(26.3.2)](#eq:lec26:simplified_nonlinear)
    is no longer a set of independent 1D oscillators. The reduced internal force f^int​(q)
    is a nonlinear function that couples all the components of q. This introduces
    two critical questions:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 与线性情况不同，[(26.3.2)](#eq:lec26:simplified_nonlinear) 中的简化系统不再是独立的一维振荡器集合。简化内部力
    f^int​(q) 是一个将 q 的所有分量耦合的非线性函数。这引入了两个关键问题：
- en: How do we efficiently time-step this coupled, nonlinear system?
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们如何高效地时间步进这个耦合的非线性系统？
- en: How do we choose an effective basis U that can represent nonlinear deformations?
    (next section)
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们如何选择一个有效的基 U 来表示非线性变形？（下一节）
- en: '[Timestepping and the Evaluation Bottleneck](#timestepping-and-the-evaluation-bottleneck)'
  id: totrans-21
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[时间步进和评估瓶颈](#timestepping-and-the-evaluation-bottleneck)'
- en: 'To solve [(26.3.2)](#eq:lec26:simplified_nonlinear) we typically use an implicit
    time integration scheme, which is necessary to handle the high-frequency stiffness
    common in elastic systems. An implicit step requires solving a linear system involving
    the derivative of the forces. For our reduced system, this means we need the **reduced
    tangent stiffness matrix**, K^(q):'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 为了求解 [(26.3.2)](#eq:lec26:simplified_nonlinear)，我们通常使用隐式时间积分方案，这对于处理弹性系统中常见的高频刚度是必要的。隐式步骤需要求解涉及力导数的线性系统。对于我们的减缩系统，这意味着我们需要**减缩切线刚度矩阵**
    K^(q)：
- en: K^(q)=Dq​f^int​(q).
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: K^(q)=Dq(f^int(q)).
- en: 'Using the chain rule, we can relate this to the full-space tangent stiffness
    matrix K(u)=Du​fint​(u):'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 使用链式法则，我们可以将此与全空间切线刚度矩阵 K(u)=Du(fint(u)) 相关联：
- en: K^(q)=Dq​(UTfint​(Uq))=UTDq​(fint​(Uq))=UT(Du​(fint​(u))​u=Uq​Dq​(Uq)),
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: K^(q)=Dq(U^Tfint(Uq))=U^TDq(fint(Uq))=U^TDu(fint(u))u=UqDq(Uq),
- en: K^(q)=UTK(Uq)U.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: K^(q)=U^TK(Uq)U。
- en: At each time step, an implicit integrator will solve a dense r×r linear system
    involving K^. Since r≪3n, this is a monumental improvement over solving the original
    sparse 3n×3n system.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在每个时间步，一个隐式积分器将求解一个涉及 K^ 的密集 r×r 线性系统。由于 r≪3n，这比求解原始稀疏 3n×3n 系统是一个巨大的改进。
- en: 'However, a major computational challenge emerges: how do we compute f^int​(q)
    and K^(q) efficiently? The naive approach is to:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，出现了一个主要的计算挑战：我们如何高效地计算 f^int(q) 和 K^(q)？直观的方法是：
- en: Take the current reduced coordinates q.
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 取当前的减缩坐标 q。
- en: '**De-project** to find the full-space deformation: u=Uq.'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**反投影**以找到全空间变形：u=Uq。'
- en: '**Evaluate** the full-space forces fint​(u) and stiffness K(u) by looping over
    all elements in the high-resolution mesh.'
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**评估**全空间力 fint(u) 和刚度 K(u) 通过遍历高分辨率网格中的所有元素。'
- en: '**Project back** to the reduced space: f^int​=UTfint​ and K^=UTKU.'
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**投影回**减缩空间：f^int(U^Tfint(Uq)) 和 K^=U^TKU。'
- en: This process is extremely slow because step 3 still requires a full pass over
    the high-resolution mesh, completely defeating the purpose of model reduction.
    Even worse, computing the matrix products UTKU is both computation and memory
    intensive.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 这个过程非常慢，因为步骤 3 仍然需要遍历高分辨率网格，完全违背了模型降阶的目的。更糟糕的是，计算矩阵乘积 UTKU 既是计算也是内存密集型的。
- en: '[Accelerating Force Evaluation](#accelerating-force-evaluation)'
  id: totrans-34
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[加速力评估](#accelerating-force-evaluation)'
- en: To make nonlinear model reduction practical, we need a way to evaluate the reduced
    forces and stiffness matrices without ever forming their full-space counterparts.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使非线性模型降阶实用，我们需要一种方法来评估减缩力和刚度矩阵，而无需形成它们的全空间对应物。
- en: '[Polynomial Fitting (for specific materials)](#polynomial-fitting-for-specific-materials)'
  id: totrans-36
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[多项式拟合（适用于特定材料）](#polynomial-fitting-for-specific-materials)'
- en: For certain material models, a highly efficient analytical approach is possible.
    For instance, in a geometrically nonlinear but materially linear model (e.g.,
    St. Venant-Kirchhoff), each component of the full-space internal force vector
    fint​(u) is a cubic polynomial in the components of u.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 对于某些材料模型，存在一种高度有效的方法。例如，在几何非线性但材料线性的模型（例如，圣维南-基尔霍夫）中，全空间内部力向量 fint(u) 的每个分量都是
    u 的分量上的三次多项式。
- en: Since u=Uq, it follows that the reduced force f^int​(q)=UTfint​(Uq) is also
    a cubic polynomial, but in the reduced coordinates q. We can precompute the coefficients
    of this r-variate cubic polynomial. At runtime, evaluating f^int​(q) and its derivative
    K^(q) simply involves evaluating these precomputed polynomials. The evaluation
    cost is O(r4) for the forces and O(r3) for implicit integration, which is manageable
    for small r (e.g., r<30) and completely independent of the mesh size n. Unfortunately,
    this approach is limited to materials where forces are low-degree polynomials.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 u=Uq，因此可以得出结论，减缩力 f^int(q)=U^Tfint(Uq) 也是一个三次多项式，但在减缩坐标 q 上。我们可以预先计算这个 r
    变量的三次多项式的系数。在运行时，评估 f^int(q) 及其导数 K^(q) 简单地涉及评估这些预先计算的多项式。评估成本对于力是 O(r^4)，对于隐式积分是
    O(r^3)，这对于小的 r（例如，r<30）是可管理的，并且与网格大小 n 完全无关。不幸的是，这种方法仅限于力是低次多项式的材料。
- en: '[Cubature (for general materials)](#cubature-for-general-materials)'
  id: totrans-39
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[数值积分法（适用于通用材料）](#cubature-for-general-materials)'
- en: A more general and powerful solution is **cubature** [[An et al. 2008]](bibliography.html#an2008optimizing).
    The core insight is to re-examine how the reduced force is calculated.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 一种更通用且强大的解决方案是**数值积分法** [[An et al. 2008]](bibliography.html#an2008optimizing)。其核心洞察力在于重新审视如何计算减缩力。
- en: 'The reduced energy E^ is the full energy evaluated within the subspace: E^(q)=E(Uq)=∫Ω0​​Ψ(F(Uq,X))dV.'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 减缩能量 E^ 是在子空间内评估的全能量：E^(q)=E(Uq)=∫Ω0Ψ(F(Uq,X))dV。
- en: 'The reduced internal force f^int​ is the gradient of this reduced energy with
    respect to the reduced coordinates q. By moving the derivative inside the integral,
    we find:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 减少的内部力 f^int​ 是相对于减少坐标 q 的减少能量的梯度。通过将导数移入积分内部，我们得到：
- en: f^int​(q)=∇q​E=∫Ω0​​∇q​Ψ(F(Uq,X))dV. This shows that the reduced force is the
    integral of the *reduced energy density gradient* over the object's volume. The
    projection UT is implicitly included within the derivative ∇q​ via the chain rule.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: f^int​(q)=∇q​E=∫Ω0​​∇q​Ψ(F(Uq,X))dV. 这表明减少力是对象体积上 *减少能量密度梯度* 的积分。通过链式法则，投影 UT
    隐含地包含在导数 ∇q​ 中。
- en: 'Instead of computing this integral exactly by summing contributions from all
    finite elements, cubature approximates it with a weighted sum over a very small
    number, T, of pre-selected sample points (or "quadrature points") Xj​∈Ω0​:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 而不是通过求和所有有限元的贡献来精确计算这个积分，样条近似使用在非常小的数量 T 上预先选定的样本点（或“求积点”）Xj​∈Ω0​ 的加权求和来近似它：
- en: f^int​(q)≈j=1∑T​wj​∇q​Ψ(F(Uq,X))​X=Xj​​.(26.3.3)
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: f^int​(q)≈j=1∑T​wj​∇q​Ψ(F(Uq,X))X=Xj​​.(26.3.3)
- en: The number of cubature points T can be surprisingly small (often on the order
    of r) while still yielding a highly accurate approximation. The points Xj​ and
    their non-negative weights wj​ are optimized in a precomputation step to best
    match the true reduced forces over a set of representative "training" poses.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 立方体点数 T 可以非常小（通常在 r 的数量级），同时仍然能提供高度精确的近似。点 Xj​ 和它们的非负权重 wj​ 在预计算步骤中被优化，以最佳匹配一组代表性的“训练”姿态下的真实减少力。
- en: At runtime, evaluating the reduced forces and stiffness only requires looping
    over these T points. The cost becomes independent of the original mesh resolution
    n, making fast simulation of complex, nonlinear materials feasible.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在运行时，评估减少力和刚度只需要遍历这些 T 个点。成本与原始网格分辨率 n 无关，使得复杂、非线性的材料的快速模拟成为可能。
- en: You can notice that it might be very important *how* we choose the basis U s.t.
    we can most effecitvely represent the space of non-linear deformations. This will
    be discussed in the following section!
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以注意到，我们选择基 U 的方式可能非常重要，以便我们能够最有效地表示非线性变形的空间。这将在下一节中讨论！
