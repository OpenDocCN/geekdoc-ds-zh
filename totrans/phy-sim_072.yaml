- en: Computing P
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://phys-sim-book.github.io/lec14.2-compute_P.html](https://phys-sim-book.github.io/lec14.2-compute_P.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s begin with the computation of P. For isotropic materials, the first
    Piola-Kirchhoff stress tensor can be calculated as follows: PwhereF​=UP^VT=UΣVT,Ψ(F)=Ψ^(Σ),andP^ij​=∂σi​∂Ψ^​δij​.​(14.2.1)
    This formulation leverages the property that P shares the same SVD space as F,
    which simplifies the derivation and computation process.'
  prefs: []
  type: TYPE_NORMAL
- en: '****Example 14.2.1.**** For the Neo-Hookean model (Equation [(13.1.2)](lec13.1-rigid_null_rot_inv.html#eq:lec13:strain_density_NH)),
    we have: Ψ^NH​(Σ)=2μ​(i∑d​σi2​−d)−μln(J)+2λ​ln2(J). Thus, we can first perform
    SVD on F=UΣV and derive: P^ii​=μ(σi​−σi​1​)+λln(J)σi​1​ to compute ∂F∂Ψ​=P=UP^VT
    without symbolically deriving the derivative of Ψ w.r.t. F.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Here we provide the proof that P commutes with rotations in diagonal space
    (see Equation [(14.2.1)](#eqn:PdiagonalSpace)). To demonstrate that P(RF)=RP(F)
    for any rotation matrix R, consider a generic (potentially anisotropic) material
    model. The key idea is that a rotation applied after deformation does not alter
    the material''s stored energy, thus we have the identity Ψ(F)=Ψ(RF). Differentiating
    both sides of this equation with respect to the deformation gradient F yields:'
  prefs: []
  type: TYPE_NORMAL
- en: δΨP(F):δFP(F):δFP(F)RP(F)​=∂F∂Ψ​(F):δF=∂F∂Ψ​(RF):δ(RF),=P(RF):(RδF),=(RTP(RF)):δF,=RTP(RF),=P(RF).​
  prefs: []
  type: TYPE_NORMAL
- en: 'Furthermore, for an isotropic material where Ψ(FR)=Ψ(F), a similar argument
    shows that P(FR)=P(F)R. Combining these relationships for P under rotation, we
    establish that: P(F)=P(UΣVT)=UP(Σ)VT=UP^VT. This formulation confirms the rotational
    invariance of P in diagonal space.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Additional Proof for P(Σ)=P^=∂Σ∂Ψ^​](#additional-proof-for-pΣpΣΨ)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In the above, the last equality comes from the fact that P(F=Σ)=∂Σ∂Ψ^​. Here
    we show why this is true.
  prefs: []
  type: TYPE_NORMAL
- en: (1) First, we claim that P(Σ) is diagonal. This can be seen by realizing that
    for isotropic elasticity, P(F)=k∑​∂Ik​∂Ψ​(F)∂F∂Ik​​(F), where Ik​ is the isotropic
    invariants. Following [[Sifakis & Barbic 2012]](bibliography.html#sifakis2012finite)
    (page 23), we can observe that ∂F∂Ik​​(F) when the argument F is diagonal, must
    be diagonal. Therefore, P(F) is diagonal when F is diagonal.
  prefs: []
  type: TYPE_NORMAL
- en: (2) Next, we claim that diag(∂Fij​∂Σ​)=diag(UT∂Fij​∂F​V). This is proven in
    [[Xu et al. 2015]](bibliography.html#xu2015nonlinear) (Equation 7).
  prefs: []
  type: TYPE_NORMAL
- en: (3) Based on (2), we know that for any ij, after substituting F=Σ, we have diag(∂Fij​∂Σ​(Σ))=diag(IT∂Fij​∂F​(Σ)I),
    using this we can write out the cases for ij=11,ij=22,ij=33. For example, for
    ij=11, we have ∂F11​∂Σ​(Σ)=​1∗∗​∗0∗​∗∗0​​
  prefs: []
  type: TYPE_NORMAL
- en: '(4) Finally, let''s derive P(Σ). Since we know it is diagonal from (1), we
    just need to derive its diagonal entry. Let''s use 11 entry as an example: Pab​(Σ)P11​(Σ)P11​(Σ)​=∂Fab​∂Ψ^​(Σ)=∂Σ∂Ψ^​(Σ):∂Fab​∂Σ​(Σ)=∂Σ∂Ψ^​(Σ):∂F11​∂Σ​(Σ)=​∂σ1​∂Ψ^​​∂σ1​∂Ψ^​​∂σ1​∂Ψ^​​​:​1∗∗​∗0∗​∗∗0​​=∂σ1​∂Ψ^​​
    Now we are done with the final proof.'
  prefs: []
  type: TYPE_NORMAL
