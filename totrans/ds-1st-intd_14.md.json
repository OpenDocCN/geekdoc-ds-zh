["```r\nlibrary(tidyverse)\nset.seed(1)\n```", "```r\npenguins <- read_csv(\"data/penguins.csv\")\npenguins\n```", "```r\n## # A tibble: 18 × 2\n##    bill_length_mm flipper_length_mm\n##             <dbl>             <dbl>\n##  1           39.2               196\n##  2           36.5               182\n##  3           34.5               187\n##  4           36.7               187\n##  5           38.1               181\n##  6           39.2               190\n##  7           36                 195\n##  8           37.8               193\n##  9           46.5               213\n## 10           46.1               215\n## 11           47.8               215\n## 12           45                 220\n## 13           49.1               212\n## 14           43.3               208\n## 15           46                 195\n## 16           46.7               195\n## 17           52.2               197\n## 18           46.8               189\n```", "```r\npenguins_standardized\n```", "```r\n## # A tibble: 18 × 2\n##    bill_length_standardized flipper_length_standardized\n##                       <dbl>                       <dbl>\n##  1                   -0.641                      -0.190\n##  2                   -1.14                       -1.33 \n##  3                   -1.52                       -0.922\n##  4                   -1.11                       -0.922\n##  5                   -0.847                      -1.41 \n##  6                   -0.641                      -0.678\n##  7                   -1.24                       -0.271\n##  8                   -0.902                      -0.434\n##  9                    0.720                       1.19 \n## 10                    0.646                       1.36 \n## 11                    0.963                       1.36 \n## 12                    0.440                       1.76 \n## 13                    1.21                        1.11 \n## 14                    0.123                       0.786\n## 15                    0.627                      -0.271\n## 16                    0.757                      -0.271\n## 17                    1.78                       -0.108\n## 18                    0.776                      -0.759\n```", "```r\nggplot(penguins_standardized,\n aes(x = flipper_length_standardized,\n y = bill_length_standardized)) +\n geom_point() +\n xlab(\"Flipper Length (standardized)\") +\n ylab(\"Bill Length (standardized)\") +\n theme(text = element_text(size = 12))\n```", "```r\nlibrary(tidyclust)\n```", "```r\nkmeans_recipe <- recipe(~ ., data=penguins) |>\n step_scale(all_predictors()) |>\n step_center(all_predictors())\nkmeans_recipe\n```", "```r\n## \n## ── Recipe ──────────\n## \n## ── Inputs \n## Number of variables by role\n## predictor: 2\n## \n## ── Operations \n## • Scaling for: all_predictors()\n## • Centering for: all_predictors()\n```", "```r\nkmeans_spec <- k_means(num_clusters = 3) |>\n set_engine(\"stats\")\nkmeans_spec\n```", "```r\n## K Means Cluster Specification (partition)\n## \n## Main Arguments:\n##   num_clusters = 3\n## \n## Computational engine: stats\n```", "```r\nkmeans_fit <- workflow() |>\n add_recipe(kmeans_recipe) |>\n add_model(kmeans_spec) |>\n fit(data = penguins)\n\nkmeans_fit\n```", "```r\n## ══ Workflow [trained] ══════════\n## Preprocessor: Recipe\n## Model: k_means()\n## \n## ── Preprocessor ──────────\n## 2 Recipe Steps\n## \n## • step_scale()\n## • step_center()\n## \n## ── Model ──────────\n## K-means clustering with 3 clusters of sizes 4, 6, 8\n## \n## Cluster means:\n##   bill_length_mm flipper_length_mm\n## 1      0.9858721        -0.3524358\n## 2      0.6828058         1.2606357\n## 3     -1.0050404        -0.7692589\n## \n## Clustering vector:\n##  [1] 3 3 3 3 3 3 3 3 2 2 2 2 2 2 1 1 1 1\n## \n## Within cluster sum of squares by cluster:\n## [1] 1.098928 1.247042 2.121932\n##  (between_SS / total_SS =  86.9 %)\n## \n## Available components:\n## \n## [1] \"cluster\"      \"centers\"      \"totss\"        \"withinss\"     \"tot.withinss\"\n## [6] \"betweenss\"    \"size\"         \"iter\"         \"ifault\"\n```", "```r\nclustered_data <- kmeans_fit |>\n augment(penguins)\nclustered_data\n```", "```r\n## # A tibble: 18 × 3\n##    bill_length_mm flipper_length_mm .pred_cluster\n##             <dbl>             <dbl> <fct>        \n##  1           39.2               196 Cluster_1    \n##  2           36.5               182 Cluster_1    \n##  3           34.5               187 Cluster_1    \n##  4           36.7               187 Cluster_1    \n##  5           38.1               181 Cluster_1    \n##  6           39.2               190 Cluster_1    \n##  7           36                 195 Cluster_1    \n##  8           37.8               193 Cluster_1    \n##  9           46.5               213 Cluster_2    \n## 10           46.1               215 Cluster_2    \n## 11           47.8               215 Cluster_2    \n## 12           45                 220 Cluster_2    \n## 13           49.1               212 Cluster_2    \n## 14           43.3               208 Cluster_2    \n## 15           46                 195 Cluster_3    \n## 16           46.7               195 Cluster_3    \n## 17           52.2               197 Cluster_3    \n## 18           46.8               189 Cluster_3\n```", "```r\ncluster_plot <- ggplot(clustered_data,\n aes(x = flipper_length_mm,\n y = bill_length_mm,\n color = .pred_cluster),\n size = 2) +\n geom_point() +\n labs(x = \"Flipper Length\",\n y = \"Bill Length\",\n color = \"Cluster\") +\n scale_color_manual(values = c(\"steelblue\",\n \"darkorange\",\n \"goldenrod1\")) +\n theme(text = element_text(size = 12))\n\ncluster_plot\n```", "```r\nglance(kmeans_fit)\n```", "```r\n## # A tibble: 1 × 4\n##   totss tot.withinss betweenss  iter\n##   <dbl>        <dbl>     <dbl> <int>\n## 1    34         4.47      29.5     2\n```", "```r\npenguin_clust_ks <- tibble(num_clusters = 1:9)\npenguin_clust_ks\n```", "```r\n## # A tibble: 9 × 1\n##   num_clusters\n##          <int>\n## 1            1\n## 2            2\n## 3            3\n## 4            4\n## 5            5\n## 6            6\n## 7            7\n## 8            8\n## 9            9\n```", "```r\nkmeans_spec <- k_means(num_clusters = tune()) |>\n set_engine(\"stats\")\nkmeans_spec\n```", "```r\n## K Means Cluster Specification (partition)\n## \n## Main Arguments:\n##   num_clusters = tune()\n## \n## Computational engine: stats\n```", "```r\nkmeans_results <- workflow() |>\n add_recipe(kmeans_recipe) |>\n add_model(kmeans_spec) |>\n tune_cluster(resamples = apparent(penguins), grid = penguin_clust_ks) |>\n collect_metrics()\nkmeans_results\n```", "```r\n## # A tibble: 18 × 7\n##    num_clusters .metric          .estimator   mean     n std_err .config        \n##           <int> <chr>            <chr>       <dbl> <int>   <dbl> <chr>          \n##  1            1 sse_total        standard   34         1      NA Preprocessor1_…\n##  2            1 sse_within_total standard   34         1      NA Preprocessor1_…\n##  3            2 sse_total        standard   34         1      NA Preprocessor1_…\n##  4            2 sse_within_total standard   10.9       1      NA Preprocessor1_…\n##  5            3 sse_total        standard   34         1      NA Preprocessor1_…\n##  6            3 sse_within_total standard    4.47      1      NA Preprocessor1_…\n##  7            4 sse_total        standard   34         1      NA Preprocessor1_…\n##  8            4 sse_within_total standard    3.54      1      NA Preprocessor1_…\n##  9            5 sse_total        standard   34         1      NA Preprocessor1_…\n## 10            5 sse_within_total standard    2.23      1      NA Preprocessor1_…\n## 11            6 sse_total        standard   34         1      NA Preprocessor1_…\n## 12            6 sse_within_total standard    1.75      1      NA Preprocessor1_…\n## 13            7 sse_total        standard   34         1      NA Preprocessor1_…\n## 14            7 sse_within_total standard    2.06      1      NA Preprocessor1_…\n## 15            8 sse_total        standard   34         1      NA Preprocessor1_…\n## 16            8 sse_within_total standard    2.46      1      NA Preprocessor1_…\n## 17            9 sse_total        standard   34         1      NA Preprocessor1_…\n## 18            9 sse_within_total standard    0.906     1      NA Preprocessor1_…\n```", "```r\nkmeans_results <- kmeans_results |>\n filter(.metric == \"sse_within_total\") |>\n mutate(total_WSSD = mean) |>\n select(num_clusters, total_WSSD)\nkmeans_results\n```", "```r\n## # A tibble: 9 × 2\n##   num_clusters total_WSSD\n##          <int>      <dbl>\n## 1            1     34    \n## 2            2     10.9  \n## 3            3      4.47 \n## 4            4      3.54 \n## 5            5      2.23 \n## 6            6      1.75 \n## 7            7      2.06 \n## 8            8      2.46 \n## 9            9      0.906\n```", "```r\nelbow_plot <- ggplot(kmeans_results, aes(x = num_clusters, y = total_WSSD)) +\n geom_point() +\n geom_line() +\n xlab(\"K\") +\n ylab(\"Total within-cluster sum of squares\") +\n scale_x_continuous(breaks = 1:9) +\n theme(text = element_text(size = 12))\n\nelbow_plot\n```", "```r\nkmeans_spec <- k_means(num_clusters = tune()) |>\n set_engine(\"stats\", nstart = 10)\nkmeans_spec\n```", "```r\n## K Means Cluster Specification (partition)\n## \n## Main Arguments:\n##   num_clusters = tune()\n## \n## Engine-Specific Arguments:\n##   nstart = 10\n## \n## Computational engine: stats\n```", "```r\nkmeans_results <- workflow() |>\n add_recipe(kmeans_recipe) |>\n add_model(kmeans_spec) |>\n tune_cluster(resamples = apparent(penguins), grid = penguin_clust_ks) |>\n collect_metrics() |>\n filter(.metric == \"sse_within_total\") |>\n mutate(total_WSSD = mean) |>\n select(num_clusters, total_WSSD)\n\nelbow_plot <- ggplot(kmeans_results, aes(x = num_clusters, y = total_WSSD)) +\n geom_point() +\n geom_line() +\n xlab(\"K\") +\n ylab(\"Total within-cluster sum of squares\") +\n scale_x_continuous(breaks = 1:9) +\n theme(text = element_text(size = 12))\n\nelbow_plot\n```"]