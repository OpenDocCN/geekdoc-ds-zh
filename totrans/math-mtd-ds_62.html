<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>8.1. Motivating example: classifying natural images#</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>8.1. Motivating example: classifying natural images#</h1>
<blockquote>原文：<a href="https://mmids-textbook.github.io/chap08_nn/01_motiv/roch-mmids-nn-motiv.html">https://mmids-textbook.github.io/chap08_nn/01_motiv/roch-mmids-nn-motiv.html</a></blockquote>

<p>In this chapter, we return to the classification problem. This time we consider more complex datasets involving natural images. We have seen an example previously, the MNIST dataset. We use a related dataset known as Fashion-MNIST developed by the <a class="reference external" href="https://engineering.zalando.com/tags/zalando-research.html">Zalando Research</a>. Quoting from their <a class="reference external" href="https://github.com/zalandoresearch/fashion-mnist">GitHub repository</a>:</p>
<blockquote>
<div><p>Fashion-MNIST is a dataset of Zalando’s article images – consisting of a training set of 60,000 examples and a test set of 10,000 examples. Each example is a 28x28 grayscale image, associated with a label from 10 classes. We intend Fashion-MNIST to serve as a direct drop-in replacement for the original MNIST dataset for benchmarking machine learning algorithms. It shares the same image size and structure of training and testing splits.</p>
</div></blockquote>
<p><strong>Figure:</strong> Fashion-MNIST sample images (<a class="reference external" href="https://github.com/zalandoresearch/fashion-mnist">Source</a>)</p>
<p><img alt="Fashion-MNIST sample images" src="../Images/ca5de089f1108499cd298a6112fb5d69.png" data-original-src="https://github.com/zalandoresearch/fashion-mnist/raw/master/doc/img/fashion-mnist-sprite.png"/></p>
<p><span class="math notranslate nohighlight">\(\bowtie\)</span></p>
<p>We first load the data and convert it to an appropriate matrix representation. The data can be accessed with <a class="reference external" href="https://pytorch.org/vision/stable/generated/torchvision.datasets.FashionMNIST.html"><code class="docutils literal notranslate"><span class="pre">torchvision.datasets.FashionMNIST</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torchvision</span> <span class="kn">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">transforms</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">TensorDataset</span>

<span class="n">fashion_mnist</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">FashionMNIST</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">'./data'</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                      <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>For example, the first image and its label are the following. The <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.Tensor.squeeze.html"><code class="docutils literal notranslate"><span class="pre">squeeze()</span></code></a> below removes the color dimension in the image, which is grayscale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">img</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">fashion_mnist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'gray'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e147d6f854f4e44af9650dd813c7dd25d252f8f6cfe588b3dc237b732a50999b.png" src="../Images/519ce9781fa942190a03ecb90108d942.png" data-original-src="https://mmids-textbook.github.io/_images/e147d6f854f4e44af9650dd813c7dd25d252f8f6cfe588b3dc237b732a50999b.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="n">label</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span/>9
</pre></div>
</div>
</div>
</div>
<p>This label is not particularly meaningful. One can get the actual names of the classes as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span/><span class="k">def</span> <span class="nf">FashionMNIST_get_class_name</span><span class="p">(</span><span class="n">label</span><span class="p">):</span>

    <span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"T-shirt/top"</span><span class="p">,</span> <span class="s2">"Trouser"</span><span class="p">,</span> <span class="s2">"Pullover"</span><span class="p">,</span> <span class="s2">"Dress"</span><span class="p">,</span> 
    <span class="s2">"Coat"</span><span class="p">,</span> <span class="s2">"Sandal"</span><span class="p">,</span> <span class="s2">"Shirt"</span><span class="p">,</span> <span class="s2">"Sneaker"</span><span class="p">,</span> <span class="s2">"Bag"</span><span class="p">,</span> <span class="s2">"Ankle boot"</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">class_names</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">: '</span><span class="si">{</span><span class="n">FashionMNIST_get_class_name</span><span class="p">(</span><span class="n">label</span><span class="p">)</span><span class="si">}</span><span class="s2">'"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span/>9: 'Ankle boot'
</pre></div>
</div>
</div>
</div>
<p>The purpose of this chapter is to develop some of the mathematical tools used to solve this kind of classification problem:</p>
<ul class="simple">
<li><p>neural networks,</p></li>
<li><p>backpropagation,</p></li>
<li><p>stochastic gradient descent.</p></li>
</ul>
    
</body>
</html>