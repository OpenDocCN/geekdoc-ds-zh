# 变量替换

> 原文：[`phys-sim-book.github.io/lec6.2-change_of_vars.html`](https://phys-sim-book.github.io/lec6.2-change_of_vars.html)

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">

### 一般滑动 DBC 和 DOF 消除方法中的挑战

当处理一般线性等式约束时，例如非轴对齐的滑动 DBC，直接自由度（DOF）消除方法面临某些局限性。这一点在 \( AA^T \) 不是 \( m \times m \) 单位矩阵时尤为明显。根据 Karush-Kuhn-Tucker（KKT）系统（方程(5.1.3)），拉格朗日乘子向量 \( \lambda \) 可以如下求解：

\( \lambda = -(A^T(AA^T)^{-1}A)H\Delta x - (A^T(AA^T)^{-1}A)g. \)(6.2.1)

当我们将方程(6.2.1)代入 KKT 系统时，它会导致：

\( (I - A^T(AA^T)^{-1}A)H\Delta x = (I - A^T(AA^T)^{-1}A)(-g), \)(6.2.2)

这导致了一个欠约束系统。这里的关键挑战是 \( I - A^T(AA^T)^{-1}A \) 没有特殊的结构，可以方便地利用来推导出等效的非奇异系统，同时仍然满足约束。这使得直接应用 DOF 消除方法对于一般的滑动 DBC 来说不切实际。

### 使用奇异值分解简化约束

我们的方法涉及将自由度（DOF）转换成一组新的变量，使得约束与粘性 DBC 中的约束一样简单。为了实现这一点，我们在约束雅可比矩阵 \( A \) 上执行奇异值分解（SVD）。\( A \) 的 SVD 表示为：\( A=USVT \)。在这里，\( U \) 是一个 \( m \times m \) 的正交矩阵，\( V \) 是一个 \( dn \times dn \) 的正交矩阵，\( S \) 是一个 \( m \times dn \) 的对角矩阵。

通过定义 \( y = V^T \Delta x \)，我们可以将 Karush-Kuhn-Tucker（KKT）系统（方程(5.1.3)）重新表述为新的格式：

[VTHVS​ST0​][yλ′​]=[−VTg0​].(6.2.3)

在这个变换后的系统中，\( \lambda' = U^T \lambda \). 特别值得注意的是，对角矩阵 \( S \) 存在于非对角块中，这使得直接应用自由度（DOF）消除方法成为可能。一旦我们解出 \( y \)，原始变量 \( \Delta x \) 可以通过矩阵-向量乘积 \( \Delta x = V y \) 容易地恢复。

> ***备注 6.2.1（使用 SVD 进行 DOF 消除的局限性）***。虽然我们利用奇异值分解（SVD）来阐述概念，但重要的是要认识到在实践应用 SVD 时的局限性，尤其是在处理大型矩阵时。有两个主要问题：
> 
> 1.  **大型矩阵的不适用性**：对大型矩阵执行 SVD 可能是计算上具有挑战性的，并且通常不切实际。
> 1.  
> 1.  **对计算效率的影响：** 增量势能 Hessian \( H \) 通常具有稀疏性，这使得在模拟中的线性求解过程中进行分解变得高效。然而，如果 SVD 得到的 \( V \) 是密集的，那么 \( V^T H V \) 也将是密集的。这不仅会减慢计算速度，还会显著增加线性求解的成本。
> 1.  
> 重要的是要注意，新的基组（\( V \) 的列向量）需要线性无关，但不必一定是正交归一的。这一洞察为识别稀疏基组提供了可能性。这样的集合在处理一般的线性等式约束时可以保持计算效率。关于这种方法的一个实际例子，请参阅 [[陈等 2022]](bibliography.html#chen2022unified)。
