# 非线性系统的模型降阶

> 原文：[`phys-sim-book.github.io/lec25.8-nonlinear_reductions.html`](https://phys-sim-book.github.io/lec25.8-nonlinear_reductions.html)

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">

线性模态分析非常高效，但其基于小变形的假设是一个主要的限制。对于模拟如屈曲、大弯曲或扭转等视觉丰富的现象，线性模型会产生严重的视觉伪影。如前节所示，一个简单的线性模型无法捕捉到物体弯曲时发生的自然缩短，导致长度和体积的不现实扩展。为了正确捕捉这些基本非线性效应，我们必须将模型降阶应用于完整的非线性运动方程。

### 投影非线性方程

对于一个一般超弹性物体的运动方程，包括阻尼，为：

Mu¨+Du˙+fint​(u)=fext​.(26.3.1)

在这里，线性弹性力 Ku 被一个通用的 **内部力函数** fint​(u) 所替代，它可以是一个关于位移 u 的复杂非线性函数。这种非线性可能来自材料模型（应力-应变关系）或来自应变测量本身（几何非线性）。

我们遵循与线性情况相同的基于投影的步骤。我们假设存在一个合适的基矩阵 U∈R3n×r（其中 r≪3n）——关于基的选择将在下一节中详细讨论——并使用简化的坐标 q∈Rr 来近似全空间的位移 u：

u(t)≈Uq(t).

将其代入 (26.3.1) 并通过前乘 UT 投影到子空间，得到 **简化非线性运动方程**：

UTMUq¨​+UTDUq˙​+UTfint​(Uq)=UTfext​.

假设我们已经构建了一个质量正交基，使得 UTMU=I，这简化为：

q¨​+D^q˙​+f^int​(q)=f^ext​,(26.3.2)

其中：

+   D^=UTDU 是 r×r 的简化阻尼矩阵。

+   f^int​(q)=UTfint​(Uq) 是 r×1 的 **简化内部力**向量。

+   f^ext​=UTfext​ 是 r×1 的简化外部力向量。

与线性情况不同，(26.3.2) 中的简化系统不再是独立的一维振荡器集合。简化内部力 f^int​(q) 是一个将 q 的所有分量耦合的非线性函数。这引入了两个关键问题：

1.  我们如何高效地时间步进这个耦合的非线性系统？

1.  我们如何选择一个有效的基 U 来表示非线性变形？（下一节）

### 时间步进和评估瓶颈

为了求解 (26.3.2)，我们通常使用隐式时间积分方案，这对于处理弹性系统中常见的高频刚度是必要的。隐式步骤需要求解涉及力导数的线性系统。对于我们的减缩系统，这意味着我们需要**减缩切线刚度矩阵** K^(q)：

K^(q)=Dq(f^int(q)).

使用链式法则，我们可以将此与全空间切线刚度矩阵 K(u)=Du(fint(u)) 相关联：

K^(q)=Dq(U^Tfint(Uq))=U^TDq(fint(Uq))=U^TDu(fint(u))u=UqDq(Uq),

K^(q)=U^TK(Uq)U。

在每个时间步，一个隐式积分器将求解一个涉及 K^ 的密集 r×r 线性系统。由于 r≪3n，这比求解原始稀疏 3n×3n 系统是一个巨大的改进。

然而，出现了一个主要的计算挑战：我们如何高效地计算 f^int(q) 和 K^(q)？直观的方法是：

1.  取当前的减缩坐标 q。

1.  **反投影**以找到全空间变形：u=Uq。

1.  **评估**全空间力 fint(u) 和刚度 K(u) 通过遍历高分辨率网格中的所有元素。

1.  **投影回**减缩空间：f^int(U^Tfint(Uq)) 和 K^=U^TKU。

这个过程非常慢，因为步骤 3 仍然需要遍历高分辨率网格，完全违背了模型降阶的目的。更糟糕的是，计算矩阵乘积 UTKU 既是计算也是内存密集型的。

### 加速力评估

为了使非线性模型降阶实用，我们需要一种方法来评估减缩力和刚度矩阵，而无需形成它们的全空间对应物。

#### 多项式拟合（适用于特定材料）

对于某些材料模型，存在一种高度有效的方法。例如，在几何非线性但材料线性的模型（例如，圣维南-基尔霍夫）中，全空间内部力向量 fint(u) 的每个分量都是 u 的分量上的三次多项式。

由于 u=Uq，因此可以得出结论，减缩力 f^int(q)=U^Tfint(Uq) 也是一个三次多项式，但在减缩坐标 q 上。我们可以预先计算这个 r 变量的三次多项式的系数。在运行时，评估 f^int(q) 及其导数 K^(q) 简单地涉及评估这些预先计算的多项式。评估成本对于力是 O(r⁴)，对于隐式积分是 O(r³)，这对于小的 r（例如，r<30）是可管理的，并且与网格大小 n 完全无关。不幸的是，这种方法仅限于力是低次多项式的材料。

#### 数值积分法（适用于通用材料）

一种更通用且强大的解决方案是**数值积分法** [[An et al. 2008]](bibliography.html#an2008optimizing)。其核心洞察力在于重新审视如何计算减缩力。

减缩能量 E^ 是在子空间内评估的全能量：E^(q)=E(Uq)=∫Ω0Ψ(F(Uq,X))dV。

减少的内部力 f^int​ 是相对于减少坐标 q 的减少能量的梯度。通过将导数移入积分内部，我们得到：

f^int​(q)=∇q​E=∫Ω0​​∇q​Ψ(F(Uq,X))dV. 这表明减少力是对象体积上 *减少能量密度梯度* 的积分。通过链式法则，投影 UT 隐含地包含在导数 ∇q​ 中。

而不是通过求和所有有限元的贡献来精确计算这个积分，样条近似使用在非常小的数量 T 上预先选定的样本点（或“求积点”）Xj​∈Ω0​ 的加权求和来近似它：

f^int​(q)≈j=1∑T​wj​∇q​Ψ(F(Uq,X))X=Xj​​.(26.3.3)

立方体点数 T 可以非常小（通常在 r 的数量级），同时仍然能提供高度精确的近似。点 Xj​ 和它们的非负权重 wj​ 在预计算步骤中被优化，以最佳匹配一组代表性的“训练”姿态下的真实减少力。

在运行时，评估减少力和刚度只需要遍历这些 T 个点。成本与原始网格分辨率 n 无关，使得复杂、非线性的材料的快速模拟成为可能。

你可以注意到，我们选择基 U 的方式可能非常重要，以便我们能够最有效地表示非线性变形的空间。这将在下一节中讨论！
