# 障碍势

> 原文：[`phys-sim-book.github.io/lec18.3-barrier_potential.html`](https://phys-sim-book.github.io/lec18.3-barrier_potential.html)

``

如非穿透距离障碍中所述，固体到障碍物接触的 IPC 原则是使用障碍函数确保任何节点自由度（DOFs）和障碍物之间的有符号距离在整个模拟过程中保持正值。为了处理自接触，可能对于同维对象，这个想法被扩展以确保任何边界点和边界之间的无符号距离在整个模拟过程中保持非零。

让我们考虑边界上的两个碰撞区域，Γ1⊂∂Ω0 和 Γ2⊂∂Ω0，对于任何点 X1∈Γ1，我们必须确保 X1 和 Γ2 上任意点之间的最近距离保持非零。这可以通过使用障碍函数来强制这个最小距离来实现，其中函数的负梯度提供了接触力。这可以写成

TC(X1,t)=−∂x(X1,t)∂b(minX2∈Γ2∥x(X1,t)−x(X2,t)∥,d^)​,(18.3.1)

其中 b 是障碍函数：

b(d,d^)={2κd^(d^d−1)lnd^d0d<d^d≥d^,​(18.3.2)

作为接触势能密度。在这里，障碍函数随着距离接近零而趋于无穷大，提供任意大的排斥力以防止相互穿透。当距离高于阈值 d^ 且没有接触发生时，不施加接触力。通过使用障碍函数，非光滑接触约束被近似为一个保守力的本构模型，使得可以通过基于优化的时间积分器进行一致解算。

> ***注 18.3.1 (障碍密度).*** 与方程 (7.2.3) 相比，这里的障碍能密度函数还额外乘以 d^，以保持表面积分后的单位一致性。回想一下注 7.2.1，障碍势可以被视为紧靠固体边界外的一个额外薄层（d^-厚）的虚拟材料，而 κ 与杨氏模量类似。
> 
> ***注 18.3.2 (最小操作符).*** 当多个点与 X1 有相同的最小距离时，X1 到所有这些点的距离障碍应该相加。`min` 操作符是非光滑的，这仍然可能使基于优化的时间积分复杂化。在下一章中，我们将展示如何将其近似为非穿透距离障碍中描述的那样。

两个碰撞区域的案例导致一个边界积分：

∫Γ1Qi(X1,t)TC1|i(X1,t)ds(X)+∫Γ2Qi(X2,t)TC2|i(X2,t)ds(X),

其中 TC1 在方程 (18.3.1) 中定义，并且：

TC2​​(X2​,t)=−∂x(X2​,t)∂b(minX1​∈Γ1​​∥x(X2​,t)−x(X1​,t)∥,d^)​,(18.3.3)

然而，在这个例子中，我们忽略了 Γ1​ 和 Γ2​ 的自接触。因此，将此推广到整个域的任意自接触，我们可以保持单个边界积分项 ∫ΓC​​Qi​(X,t)TC∣i​(X,t)ds(X) 用于接触，如方程 (18.2.1) 所示，并更普遍地定义牵引力：

TC​(X,t)=−∂x(X,t)∂b(minX2​∈ΓC​−N(X)∥x(X,t)−x(X2​,t)∥,d^)​,(18.3.4)

其中 N(X)={XN​∈Rd∣∥XN​−X∥<r} 是 X 的一个无穷小圆，半径 r 足够小，以避免点与其测地邻居之间产生不必要的接触力。

> ***备注 18.3.3（势垒力限制）***。在方程 (18.3.4) 中，对于 N(X) 内部的点，忽略了自接触。这是为了平滑地近似接触力，在宏观视角下接触力是不连续的。同样，d^ 引入了另一个误差来源。然而，当 d^→0 和 r→0 时，我们的模型收敛到不连续的定义。请注意，我们还需要 d^/r→0，否则在 r 和 d^ 之间仍可能存在一些距离 d，这会导致势垒在极限情况下发散。

最后，我们可以在整个边界 ΓC​ 上定义接触势：

∫ΓC​​21​b(X2​∈ΓC​−N(X)min∥x(X,t)−x(X2​,t)∥,d^)ds(X).(18.3.5)

在这里，系数 21​ 被使用，因为由于对称性，每个接触点的对之间的势垒能量密度 b 在积分中会被计算两次。在计算势垒力时，这两种情况都需要进行微分。因此，使用系数 21​ 允许我们将方程 (18.3.4) 中的力定义相匹配。我们将在下一章中详细阐述这一点，在离散弱形式下。

在弱形式中不需要接触势，但对于基于优化的时间积分将很有用。
