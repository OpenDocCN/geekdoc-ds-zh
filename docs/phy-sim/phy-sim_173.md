# 基于连续介质力学的约束

> [`phys-sim-book.github.io/lec32.5-pbd_continuum.html`](https://phys-sim-book.github.io/lec32.5-pbd_continuum.html)

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">

虽然简单的几何约束，如距离和体积，对许多材料是有效的，但通过直接从连续介质力学的原理推导约束，可以实现更物理严格和表达丰富的模拟。这种方法将基于位置的动力系统与有限元法（FEM）等已建立方法的丰富理论基础联系起来，允许模拟包括各向异性、弹塑性和非线性弹性在内的复杂材料行为。核心思想是基于变形梯度定义约束，这是一个测量材料局部拉伸和剪切的张量。

本节将首先回顾离散化变形和应变的必要概念。然后详细说明制定基于连续介质的约束的两种主要方法：一种基于应变能的整体方法，以及一种更细粒度的方法，它直接约束应变张量的各个分量。

### 应变能约束

将标准超弹性材料模型直接纳入 PBD 的最直接方法是将它的应变能势作为约束函数。

在离散设置中，例如四面体网格，假设变形梯度在每个单元内是恒定的。对于一个具有材料空间顶点（P1，P2，P3，P4）和世界空间顶点（p1，p2，p3，p4）的四面体，我们可以从边向量定义一个材料空间形状矩阵 Dm 和世界空间形状矩阵 Ds：DmDs=[P1−P4，P2−P4，P3−P4]=[p1−p4，p2−p4，p3−p4]变形梯度对于四面体由 F=DsDm−1 给出。注意 Dm−1 是恒定的，可以预先计算。

从 F，我们可以推导出各种应变度量。其中最常见的是**格林-圣维南应变张量**，ε，它不依赖于刚体旋转：ε=21(FTF−I)(33.5.1)相关的**右柯西-格林变形张量**，S=FTF=2ε+I，将特别有助于制定直接应变约束。如果没有变形，F=I，S=I，且ε=0。

通过胡克广义定律，我们可以将应力与应变联系起来：

S=Cε 其中 C 是材料的弹性张量。回想一下，变形固体的能量是通过在整个体Ω上积分标量应变能密度场来定义的：

Es=∫ΩΨs dP 其中应变能密度可以用应力应变来定义：

Ψs=21ε:S=21tr(ε⊤S)

因此，单个四面体单元的总应变能是其初始体积 V0 乘以能量密度。对于未变形状态，这种能量为零。这自然导致以下约束公式的形成：C(p1,...,p4)=Es=V0Ψs(F(p1,...,p4))=0(33.5.2)。

PBD 求解器需要计算约束相对于顶点位置的梯度。这个梯度具有深刻的物理意义，因为它直接与**第一 Piola-Kirchhoff 应力张量** P 相关，P 将当前配置中的力与参考配置中的面积联系起来。应力张量是变形梯度 P(F) 的函数。使用链式法则，可以以紧凑的矩阵形式计算前三个顶点的能量梯度：[∂p1/∂Es, ∂p2/∂Es, ∂p3/∂Es]=V0P(F)Dm−T(33.5.3)。第四个顶点的梯度由平移不变性条件（即元素上的净力必须为零）确定：∂p4/∂Es=−i=1∑3∂pi/∂Es(33.5.4)。这种公式自然地扩展到由三角形组成的表面网格。对于一个静面积 A0 的三角形，约束是 C(p)=A0Ψs(Ftri)。梯度计算类似：[∂p1/∂Es, ∂p2/∂Es]=A0P(Ftri)Dm−T，且 ∂p3/∂Es=−i=1∑2∂pi/∂Es(33.5.5)。

> ***备注 33.5.1（处理元素逆置）***。标准本构模型通常不适用于退化或逆置元素（其中 det(F)≤0），这可能导致模拟中的不稳定性。这是一个关键的实际问题。通过增强本构模型，并采用为逆置处理设计的技巧，可以稳健地解决这个问题。

这种应变能约束的优雅之处在于其通用性。它不仅限于单一的材料类型，如简单的圣维南-柯西模型。更复杂且物理上更准确的模型，如用于橡胶类材料的莫尔-库仑模型，可以通过简单地替换适当的能量密度函数 Ψs 来轻松支持。这允许 PBD 以高保真度和效率模拟复杂的物理效应，如横向收缩（泊松效应）、各向异性和弹塑性。

### 基于直接应变的约束

对于需要更细粒度或直观控制材料属性的应用，尤其是模拟各向异性，为每种变形模式定义单独的约束是有利的。这种方法作用于右柯西-格林变形张量的分量，S=FTF。

#### 拉伸约束

S 矩阵的对角元素 Sii 代表沿材料参考轴的拉伸平方。在未变形状态下，Sii=1。为确保约束投影是线性的并且单步收敛，拉伸约束是基于拉伸本身而不是其平方来制定的：Cstretch,i(x)=Sii−1=0（33.5.6）。通过为每个主轴定义一个这样的约束，可以分配独立的刚度参数，这是模拟各向异性拉伸阻力的关键。

#### 剪切约束

S 矩阵的非对角元素 Sij=fk⋅fj（其中 fk 是 F 的列向量），衡量材料轴之间的剪切。一个简单的 Sij=0 约束问题性地耦合了剪切和拉伸。为了隔离剪切变形，约束必须归一化，因此只依赖于变形轴之间的角度：Cshear,ij(x)=|fi||fj|fi⋅fj=0（33.5.7）。这种公式确保剪切约束在不妨碍控制其长度的拉伸约束的情况下，强制材料轴之间的正交性。这种解耦对于直观且独立地调整材料行为至关重要。
