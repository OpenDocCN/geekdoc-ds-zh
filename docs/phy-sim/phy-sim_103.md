# 自接触

> 原文：[`phys-sim-book.github.io/lec20.3-self_contact.html`](https://phys-sim-book.github.io/lec20.3-self_contact.html)

`<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">`

使用三角形离散化，域的边界被近似为由一组边形成的折线。让我们将这个边界边的集合表示为 E，势垒势能变为：

≈=∫ΓC21b(X2∈ΓC−N(X)min∥x(X,t)−x(X2,t)∥,d^)ds(X)∫ΓC21b(e∈E−I(X)minX2∈emin∥x(X,t)−x(X2,t)∥,d^)ds(X)∫ΓC21b(e∈E−I(X)mindPE(x(X,t),e),d^)ds(X)。

在这里，I(X)是包含 X 的边的集合。在当前离散化下，完全忽略这些边是 N(X)的一个特定选择。术语 minX2∈e∥x(X,t)−x(X2,t)∥简单地是点-边距离 dPE(x(X,t),e)，这可以根据点和边的相对位置计算为点-点距离或点-线距离。

如我们所知，势垒能量密度函数 b 已经是防止两个碰撞点之间相互穿透的不连续法向接触力的平滑近似。然而，当考虑离散表面（此处为分段线性）之间的自接触时，点-边距离上的非平滑 min 运算符是不可避免的。这种非平滑性仍然会对优化时间积分器提出挑战。

为了在分段线性边界的情况下获得平滑的势垒势能，我们首先将 min 运算符转换为 max 运算符，因为能量密度函数 b 在整个域内都是非递增的。这给我们：

∫ΓC21e∈E−I(X)maxb(dPE(x(X,t),e),d^)ds(X)。

接下来，我们需要平滑地近似 max 运算符。一个直接的选择是使用平滑的 max 函数，例如 p-范数函数：

max(a1,a2,...,an)≈(a1p+a2p+…+anp)p1，

当 p>0 足够大时。然而，指数 p1 将多个输入耦合在一起，增加模板大小，使 Hessian 矩阵变得不那么稀疏，这将使模拟更加计算密集。

幸运的是，由于 b 在局部支持下的作用，当接触力仅存在于小于 d^的距离时，使用 p=1 是足够的。在相对较小的 d^下，边界元素界面（图 20.3.1）上只会存在一些冗余的接触力。

![图片](img/f3d49d706392ea533a897a7d202d1ac9.png)

**图 20.3.1**。在这个简单的双边示意图中，黄色和绿色区域只被求和计算一次，但蓝色区域和黄色-绿色重叠部分被计算了两次。如果我们减去一次蓝色区域，那么对于右上边界（凸形），它就变得完美，但对于左下边界（凹形），我们仍然可以看到一些重叠部分被计算了两次。

由于多个边界元素的重叠支持可以清楚地识别，因此也可以从这些区域减去冗余的势垒势，如[[Li et al. 2023]](bibliography.html#li2023convergent)中详细讨论的那样。对于这本书，我们使用 p=1 和 p-范数公式来简化，这只是一个求和：

∫ΓC21e∈E−I(X)maxb(dPE(x(X,t),e),d^)ds(X)≈∫ΓC21e∈E−I(X)∑b(dPE(x(X,t),e),d^)ds(X).

在三角形离散化下对积分进行近似，并选取每个边界边的端点作为求积点，我们得到完全离散的形式：

≈∫ΓC21e∈E−I(X)∑b(dPE(x(X,t),e),d^)ds(X)a^∑4∥Xa^−Xa^−1∥+∥Xa^−Xa^+1∥e∈E−I(Xa^)∑b(dPE(xa^,e),d^).(20.3.1)

与固体障碍物接触情况类似，TC 可以通过对整个接触势相对于节点自由度（DOFs）的导数来推导。
