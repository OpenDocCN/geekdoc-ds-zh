# 质量矩阵和聚集

> 原文：[`phys-sim-book.github.io/lec19.2-mass_matrix.html`](https://phys-sim-book.github.io/lec19.2-mass_matrix.html)



回忆一下 弱形式离散化 中的内容：

Mab=∫Ω0R(X,0)Na(X)Nb(X)dX.(19.2.1)

将固体域离散成三角形 T，我们有：

Mab=e∈T∑∫Ωe0R(X,0)Na(X)Nb(X)dX,(19.2.2)

其中 Ωe0 表示三角形 e 的材料空间。注意，对于线性三角形单元，由于 Ni 在节点 i 的相邻三角形上才不为零，因此这里我们只需要考虑以 a 和 b 为顶点的三角形。

让我们将积分变量从 X 变换到 (β,γ)，这给出：

=∫Ωe0R(X,0)Na(X)Nb(X)dX∫01∫01−βR(β,γ,0)Na(β,γ)Nb(β,γ)det(∂(β,γ)/∂X)dγdβ.​(19.2.3)

为了简化，让我们将这个三角形 e 的顶点表示为 X1、X2 和 X3，然后我们有：

det(∂(β,γ)/∂X)=|det([X2−X1,X3−X1])|=2Ae，

其中 Ae 是三角形 e 的面积。在这里，Na 和 Nb 根据 a 和 b 的顶点索引取 1−β−γ、β 或 γ。例如，如果 a 和 b 对应于三角形 e 的第 2 和第 3 个顶点，那么 Na=β，Nb=γ。假设均匀密度，我们有：

∫Ωe0R(X,0)Na(X)Nb(X)dX====2RAe∫01∫01−ββγdγdβ2RAe∫0121βγ2γ=0γ=1−βdβRAe∫01β(1−β)2dβRAe(2β2−32β3+4β4)β=0β=1=121RAe.​(19.2.4)

在质量聚集中，Mablump=δab∑cMac，这意味着：

Maalump=e∈T∑b∈V∑∫Ωe0R(X,0)Na(X)Nb(X)dX,(19.2.5)

其中 V 包含了网格的所有节点，Mlump 的所有非对角线项都是 0。同样，由于 N 的局部性，对于每个三角形单元，b 只需要遍历所有三个三角形顶点：

Maalump=e∈T(a)∑2RAe(∫01∫01−ββ(1−β−γ)dγdβ+∫01∫01−ββ2dγdβ+∫01∫01−ββγdγdβ)=e∈T(a)∑2RAe∫01βdγdβ=e∈T(a)∑2RAe∫01βγ|γ=0γ=1−βdβ=e∈T(a)∑2RAe∫01β(1−β)dβ=e∈T(a)∑2RAe(2β2−3β3)β=0β=1= e∈T(a)∑31RAe,​(19.2.6)

其中 T(a) 表示与节点 a 相邻的所有三角形的集合。这个结果也解释了为什么在 无逆弹性 中，当计算所有节点的质量时，我们需要遍历所有三角形，计算三角形 RAe 的质量，并将其均匀分配到三个顶点。计算完质量矩阵后，动量变化和外部体力的项以及它们的能量形式都很容易处理。
