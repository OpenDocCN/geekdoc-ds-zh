# 优化时间积分器

> [原文链接](https://phys-sim-book.github.io/lec2.1-opt_time_integration.html)

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">

使用后向欧拉方法，每个时间步都需要解决一个非线性方程组，如方程 (1.5.2) 所述。实际上，这相当于解决一个优化问题，其表述为：\(x_{n+1}\) 其中 \(E(x) = \arg\min E(x) = \frac{1}{2} \|x - \tilde{x}^n\|²_M + \frac{\Delta t²}{P(x)}\)。在这里，\(\tilde{x}^n = x^n + \Delta t v^n\)，\(\frac{1}{2} \|x - \tilde{x}^n\|²_M = \frac{1}{2} (x - \tilde{x}^n)^T M (x - \tilde{x}^n)\) 表示惯性项，\(P(x)\) 代表力 \(f(x)\) 的势能，其中 \(\frac{\partial P}{\partial x}(x) = -f(x)\)，而 \(E(x)\) 被称为**增量势能**。在 \(E(x)\) 的局部最小值处，\(\frac{\partial E}{\partial x}(x^{n+1}) = 0\)，对应于方程 (1.5.2)。

将时间积分视为一个优化问题使我们能够利用成熟的优化方法来稳健地获取解。这也允许我们有一个一致的框架来模拟更复杂的物理现象。

> ****定义 2.1.1（保守力）****。对于存在势能 \(P(x)\) 的力 \(f(x)\)，使得 \(\frac{\partial P(x)}{\partial x} = -f(x)\)，被称为**保守力**。常见的弹性力和如重力这样的体力都是保守力的例子。它们可以通过将势能项添加到增量势能中轻松地集成到优化框架中。
> 
> ***备注 2.1.1（重力）***。作用在质量为 \(m\) 的物体上的重力（表示为力 \(F = -mg\mathbf{z}\)）在地球表面以上高度 \(h\) 处，其中 \(g\) 是重力加速度，\(\mathbf{z}\) 是指向上的单位向量，对应于重力势能 \(U = mgh\)。在这里，\(U\) 是克服重力将物体从参考点（在 \(h = 0\)）移动到高度 \(h\) 所做的功。力是能量相对于位置的负梯度（数学上表示为 \(F = -\nabla U\)），这证实了能量守恒原理。对 \(U\) 关于 \(h\) 求导，我们得到 \(\nabla U = mg\mathbf{z}\)，因此 \(F = -\nabla U = -mg\mathbf{z}\)，这与我们最初的力表达式相匹配。
> 
> ***备注 2.1.2 (弹性).*** 弹性是指固体物体在受到外部力作用时保持其静止形状的能力。在弹性的影响下，同一固体上的样本点在模拟过程中将被*绑定*在一起。更坚硬的固体将具有更刚性的弹性能量，在相同程度的变形下提供更大的弹性力，从而有助于恢复静止形状。甲壳虫弹弓示例（图 1.3.1）展示了典型的弹性效应。弹性是所有固体共有的属性，无论它们的几何形状如何，以及它们是否直观上是刚性的或非刚性的，例如，金属、木材、软组织、橡胶、布料、头发、沙子等。
