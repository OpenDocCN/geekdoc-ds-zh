# 等式约束公式

> 原文：[`phys-sim-book.github.io/lec5.1-equality_constraints.html`](https://phys-sim-book.github.io/lec5.1-equality_constraints.html)

`<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">`

Dirichlet 边界条件（BC），当集成到优化时间积分器中时，表示为线性等式约束：Ax=b，（5.1.1）在这个方程中，矩阵 \(A\) 是一个 \(m \times dn\) 矩阵，其中 \(m \leq dn\)。这个矩阵的作用是选择受边界条件影响的节点上的自由度（DOFs）。向量 \(b\) 是一个 \(m \times 1\) 的向量，它指定了这些条件规定的精确空间值。

> **示例 5.1.1（粘性 Dirichlet 边界条件）**。对于一个包含两个节点 \((x_{11}, x_{12})\) 和 \((x_{21}, x_{22})\) 的二维系统，要将第二个节点固定在位置 \((1, 2)\)，边界条件（方程 (5.1.1)）可以表示为 [00 00 10 01] x11 x12 x21 x22 = [12]。

最常见的两种 Dirichlet 边界条件是粘性和滑动：

**粘性边界条件**：这些条件有效地将某些节点的位置固定在时间步内。它们的特点是具有块状约束雅可比矩阵 \(A\)。在这个矩阵中，每组 \(d\) 行包含一个 \(d \times d\) 的单位矩阵。矩阵的其余部分由零矩阵组成。这种配置在 示例 5.1.1 中有说明。粘性边界条件的实现确保了指定的节点在模拟过程中保持静止，遵循规定的位置。

**滑动边界条件**：这些条件旨在将每个边界条件（BC）节点约束在特定的线性子空间内，例如一个平面或一条线，这些子空间可能不是轴对齐的。例如，考虑平面滑动边界条件。在这里，对于每个 BC 节点，矩阵 \(A\) 中都有一个对应的行，该行包含平面的法向量。这个向量占据了对应 BC 节点的列，如 示例 5.1.2 中详细说明。这样的条件允许节点移动，但只能在定义的线性子空间内，从而为模拟增加了复杂性和现实感。

> **示例 5.1.2（滑动 Dirichlet 边界条件）**。对于与 示例 5.1.1 中相同的两个节点系统，要约束方程 \(2x + 3y = 4\) 上的第一个节点，约束（方程 (5.1.1)）可以表示为 [2 3 0 0] x11 x12 x21 x22 = 4。

在每个时间步长的开始，如果我们知道所有边界条件都已满足，那么在优化过程中的目标仅仅是保持边界条件节点的位置。这表示为：AΔx=0.(5.1.2) 这里，\(\Delta x\) 是每次优化迭代中的搜索方向。保持这个条件确保了任何更新的节点位置 \(x + \alpha \Delta x\)（其中 \(\alpha\) 是线搜索的步长），仍然满足边界条件：A(x+αΔx)=b。这保证了在整个优化过程中遵守边界条件。

为了在时间步长内强制执行粘性 DBC 的线性等式约束（方程(5.1.2)），我们在求解搜索方向 \( \Delta x \) 的过程中，在每次牛顿迭代中处理这个问题。这个过程涉及到使用对增量势能的二次近似来形成拉格朗日函数：

L(Δx,λ)=21​ΔxTHΔx+gTΔx+λTAΔx,

在这里，\( \lambda \) 是 \( m\times 1 \) 的拉格朗日乘子向量。增量势能的梯度和对偶梯度分别用 \( g \) 和 \( H \) 表示。

解决方案通过一个最大-最小优化问题来逼近：

λmax​Δxmin​L(Δx,λ),

这导致了一个 Karush-Kuhn-Tucker (KKT)系统的形成：

[HA​AT​][Δxλ​]=[−g0​].(5.1.3)

解决这个 KKT 系统对于确定搜索方向是至关重要的。请注意，这个系统不是对称正定（SPD）的，并且其大小随着边界条件节点数量的增加而增加。
