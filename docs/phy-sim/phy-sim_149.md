# 边界条件

> 原文：[`phys-sim-book.github.io/lec28.1-grid_bc.html`](https://phys-sim-book.github.io/lec28.1-grid_bc.html)



在材料点方法中，**边界条件（BCs）**是在背景欧拉网格上施加的，因为控制方程——以弱形式离散化——是在网格节点上表述的，这些节点是系统的真正自由度（DOFs）。这些节点必须满足牛顿第二定律。因此，所有外部约束，包括静态墙壁、移动边界或接触力，都必须在 P2G 之后和 G2P 之前直接应用于网格。

如同往常，我们用 v^in+1​ 表示网格节点 xi​ 处的节点速度。在外力积分之后，根据边界条件的类型，我们在边界节点上应用不同的速度投影。

### 边界条件类型

设 n 为边界网格节点 xi​ 处的表面法线：

+   **粘性**: 速度完全被抑制：v^in+1​←0。

+   **滑动**: 仅移除法向分量；切向运动保持不变：v^in+1​←v^in+1​−n(n⊤v^in+1​)。

+   **分离（单向墙）**: 正常流入被阻挡，但允许向外运动：v^in+1​←v^in+1​−n⋅min(n⊤v^in+1​,0)。

这些操作是 **局部**的，独立应用于每个边界网格节点。

### 外部力

在 P2G 之后，可以添加外部力，如 **重力**：

v^in+1​←v^in+1​+Δt⋅g。

### 移动碰撞体

对于移动或变形物体，使用 **符号距离函数（SDFs）** 来检测网格节点 xi​ 是否位于物体内部。一旦检测到，计算 **表面法线** n 和 **相对速度** Δv，并相应地调整网格速度。

### 库仑摩擦

为了在嵌入的碰撞体（例如，球体或胶囊）上施加 **库仑摩擦力**，我们在表面法线方向应用一个投影速度校正：

设 n 为接触法线，Δv 为相反速度（即 Δv=vSDF​−v^in+1​）。定义法向分量：

v˙n​=n⊤Δv。

然后校正后的网格速度为：

v^in+1​←v^in+1​+Δv⋅μ+n⋅v˙n​⋅(1−μ)。

其中 μ∈[0,1] 是 **摩擦系数**。此操作在完全 **分离**（μ=0）和 **粘性**（μ=1）之间平滑过渡。
