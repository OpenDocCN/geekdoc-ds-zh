# 计算 P

> 原文：[`phys-sim-book.github.io/lec14.2-compute_P.html`](https://phys-sim-book.github.io/lec14.2-compute_P.html)



让我们从计算 P 开始。对于各向同性材料，第一 Piola-Kirchhoff 应力张量可以按以下方式计算：PwhereF​=UP^VT=UΣVT,Ψ(F)=Ψ^(Σ),andP^ij​=∂σi​∂Ψ^​δij​.​(14.2.1) 这种公式利用了 P 与 F 共享相同的 SVD 空间的性质，从而简化了推导和计算过程。

> ****例 14.2.1.**** 对于 Neo-Hookean 模型（方程 (13.1.2)），我们有：Ψ^NH​(Σ)=2μ​(i∑d​σi2​−d)−μln(J)+2λ​ln2(J)。因此，我们首先对 F=UΣV 进行奇异值分解，并推导出：P^ii​=μ(σi​−σi​1​)+λln(J)σi​1​，以计算 ∂F∂Ψ​=P=UP^VT，而不需要符号地推导 Ψ 对 F 的导数。

在这里，我们提供了 P 与对角空间中的旋转交换的证明（见方程 (14.2.1)）。为了证明对于任何旋转矩阵 R，都有 P(RF)=RP(F)，考虑一个通用的（可能各向异性的）材料模型。关键思想是变形后的旋转不会改变材料的储存能量，因此我们有恒等式 Ψ(F)=Ψ(RF)。对变形梯度 F 对该方程的两边进行微分得到：

δΨP(F):δFP(F):δFP(F)RP(F)​=∂F∂Ψ​(F):δF=∂F∂Ψ​(RF):δ(RF),=P(RF):(RδF),=(RTP(RF)):δF,=RTP(RF),=P(RF).​

此外，对于各向同性材料，其中 Ψ(FR)=Ψ(F)，类似的论证表明 P(FR)=P(F)R。结合旋转下 P 的这些关系，我们得出：P(F)=P(UΣVT)=UP(Σ)VT=UP^VT。这种公式证实了 P 在对角空间中的旋转不变性。

### P(Σ)=P^=∂Σ∂Ψ^的附加证明

在上述内容中，最后一个等式来源于 P(F=Σ)=∂Σ∂Ψ^的事实。在这里，我们展示为什么这是正确的。

(1) 首先，我们声称 P(Σ) 是对角的。这可以通过意识到对于各向同性弹性，P(F)=k∑​∂Ik​∂Ψ​(F)∂F∂Ik​​(F)，其中 Ik​ 是各向同性不变量。根据 [[Sifakis & Barbic 2012]](bibliography.html#sifakis2012finite)（第 23 页），我们可以观察到当 F 为对角时，∂F∂Ik​​(F) 必须是对角的。因此，当 F 为对角时，P(F) 是对角的。

(2) 接下来，我们声称 diag(∂Fij​∂Σ​)=diag(UT∂Fij​∂F​V)。这在 [[Xu et al. 2015]](bibliography.html#xu2015nonlinear)（方程 7）中得到证明。

(3) 根据 (2)，我们知道对于任何 ij，在将 F=Σ 代入后，我们有 diag(∂Fij​∂Σ​(Σ))=diag(IT∂Fij​∂F​(Σ)I)，使用这一点我们可以写出 ij=11、ij=22、ij=33 的情况。例如，对于 ij=11，我们有 ∂F11​∂Σ​(Σ)=​1∗∗​∗0∗​∗∗0​​

(4) 最后，我们来推导 P(Σ)。由于根据(1)我们知道它是对角线形式，我们只需要推导其对角线元素。以第 11 个元素为例：Pab(Σ)P11(Σ)P11(Σ)=∂Fab∂Ψ^(Σ)=∂Σ∂Ψ^(Σ):∂Fab∂Σ(Σ)=∂Σ∂Ψ^(Σ):∂F11∂Σ(Σ)=∂σ1∂Ψ^∂σ1∂Ψ^∂σ1∂Ψ^:1****0**0**0=∂σ1∂Ψ^ 现在我们已经完成了最终的证明。
