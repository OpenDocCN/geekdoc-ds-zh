# 材料粒子的摩擦接触

> 原文：[`phys-sim-book.github.io/lec28.2-contact_on_particles.html`](https://phys-sim-book.github.io/lec28.2-contact_on_particles.html)



之前，我们讨论了直接在欧拉网格节点上应用边界条件。虽然这种方法由于网格节点是真正的自由度（DOFs）且牛顿第二定律在这些节点上得到实施，因此是自然的，但它存在几个固有的问题：

+   **法线估计误差**：对于粗网格，估计准确表面法线变得具有挑战性，可能导致错误的接触响应。

+   **接触间隙（dx gap）**：基于网格的碰撞处理甚至在网格节点与碰撞表面大约一个网格单元间距内时也会响应，导致可见的间隙和较早的碰撞响应。

由于材料点法（MPM）直接将固体离散成一组材料粒子，因此在粒子级别直接处理摩擦接触更直观——并且可能更准确。然而，简单地计算粒子上的碰撞力和摩擦力，然后直接通过 P2G 转移到网格上，在物理上是不一致的，因为这种天真方法绕过了在网格 DOFs 上正确实施牛顿第二定律，可能导致非物理响应，尤其是未能正确实施静摩擦约束。

相反，一种更稳健的策略是在网格级别明确地将摩擦接触问题表述为一个优化问题，利用基于粒子的碰撞能量或罚函数的定义。这使我们采用两阶段时间分裂数值方案。

### 两阶段时间分裂优化方案

**阶段 1：自由运动速度**

在第一阶段，我们完全忽略接触约束，并在网格节点上计算中间的“自由运动”节点速度 vi∗，这些速度在没有任何接触力的情况下会发生。这些速度可以通过标准的 辛普森欧拉法 时间积分步骤方便地获得。

**阶段 2：通过优化实现摩擦接触**

在第二阶段，通过求解围绕自由运动速度 v∗ 的约束线性化动量平衡来实施摩擦接触：

M(vin+1−vi∗)=hJT(xpn​)γ(vin+1​).

在这里：

+   M 是质量矩阵。

+   J 是定义在粒子层面的接触雅可比矩阵，它将网格节点速度映射到粒子层面的接触速度。具体来说，每个接触粒子 j 贡献一个局部雅可比矩阵：Jj​=∂vi​∂vc,j​​∈R3×nv​。将这些单个雅可比矩阵堆叠起来产生全局接触雅可比矩阵 J∈R3nc×nv​，它将所有粒子接触速度 vc 与网格速度 v 相关联：vc=Jvi​。直观上，J 可以理解为在当前配置下线性化的特殊网格到粒子（G2P）转移算子，直接编码了网格节点速度的无限小变化如何影响接触点的粒子速度（法向和切向分量）。

+   γ(vin+1​)表示在摩擦锥约束下的接触力（法向和切向）。

这个线性系统可以被重新表述为一个**无约束优化问题**：

vi​minℓ(vi​)=21∥vi​−vi∗∥M2+ℓc​(vc​(vi​)).

对于ℓc​可能的接触能量公式包括对数障碍势能和半隐式摩擦。
