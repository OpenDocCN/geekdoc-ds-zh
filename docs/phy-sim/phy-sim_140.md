# 插值函数

> 原文：[`phys-sim-book.github.io/lec26.2-interpolating_functions.html`](https://phys-sim-book.github.io/lec26.2-interpolating_functions.html)

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">

在材料点法（MPM）的每个时间步中，粒子将质量动量转移到背景网格，然后从网格检索更新的速度以执行对流。这两个转移都依赖于**插值函数**来确定每个粒子与附近网格节点的交互方式。

我们将关联于网格节点 i 的插值函数定义为 Ni​(x)。在这里，i 是一个多索引 - 2D 中的(i,j)或 3D 中的(i,j,k) - ，而 x 是任意空间位置。当在粒子位置 xp​评估此函数时，我们使用缩写：

wip​=Ni​(xp​).

这个权重决定了粒子 p 对网格节点 i 的影响强度：粒子越接近节点，wip​变得越大。

> **示例 27.2.1（线性插值）**。在 1D 中，最简单的插值函数选择是**线性（帐篷）函数**：N(x)={1−∣x∣0​if 0≤∣x∣<1,otherwise.​ 要在基于网格的设置中应用此函数，我们按比例缩放空间坐标相对于**网格间距**h（即沿一个轴相邻网格节点之间的距离）。缩放后的版本变为：N(hxp​−xi​​)。在更高维（2D，3D）中，我们使用 1D 函数的**张量积**：Ni​(xp​)=N(hxp​−xi​​)⋅N(hyp​−yj​​)⋅N(hzp​−zk​​)。

线性插值计算效率高，易于实现，在 FLIP [[Brackbill et al. 1988]](bibliography.html#brackbill1988flip) [[Bridson 2015]](bibliography.html#bridson2015fluid) 流体模拟中得到广泛应用。然而，当应用于 MPM 时，它存在两个严重问题：

1.  其梯度∇N(x)是**不连续的**，导致不稳定的噪声力评估。

1.  当粒子接近单元格边界时，wip​变得很小，而∇wip​保持很大，导致称为**单元格交叉不稳定性**的数值不稳定性。

1.  函数的支持范围太窄，当相邻粒子没有共享足够的网格节点时，容易发生**数值断裂**。

由于这些问题，线性插值通常在 MPM 中避免，尤其是在固体模拟中。

> **示例 27.2.2（二次 B 样条插值）**。更好的选择是**二次 B 样条**插值函数，它是 C1-连续的（具有连续的梯度）并且支持范围更广：N(x)=⎩⎨⎧​43​−x221​(23​−∣x∣)20​if ∣x∣<21​,if 21​≤∣x∣<23​,otherwise.​

二次 B 样条具有宽度为 3h 的支持区域，提供粒子与网格之间平滑、稳定的交互。它们计算效率高，比高阶 B 样条需要更少的内存。

> **示例 27.2.3（三次 B 样条插值）**。为了获得更好的平滑性和更广泛的支持，我们可以使用**三次 B 样条**插值函数：N(x)=⎩⎨⎧​21​∣x∣3−∣x∣2+32​61​(2−∣x∣)30​if 0≤∣x∣<1,if 1≤∣x∣<2,otherwise.​

立方 B 样条的支持区间为[−2h,2h]，这使得它在数值断裂和不稳定性方面更加稳健。然而，更宽的支持区间也意味着每个粒子会与更多的网格节点相互作用，这增加了**传输过程中的计算开销**（例如，质量、动量和力）。在选择插值核时，应考虑这种在平滑性和效率之间的权衡。

### 插值函数的梯度

在力计算过程中需要梯度。对于使用张量积定义的高维插值函数，我们使用链式法则来计算它们的梯度：∇Ni(xp)=h1N′(hxp−xi)N(hyp−yj)N(hzp−zk)N(hxp−xi)h1N′(hyp−yj)N(hzp−zk)N(hxp−xi)N(hyp−yj)h1N′(hzp−zk)．在这里，N′(x)是 1D 插值函数 N(x)的导数。
