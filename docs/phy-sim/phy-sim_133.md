# 线性模态分析

> 原文：[`phys-sim-book.github.io/lec25.7-linear_modal_analysis.html`](https://phys-sim-book.github.io/lec25.7-linear_modal_analysis.html)



我们从最简单的情况开始探索模型降阶：线性弹性 (13.1.4)。虽然仅限于小变形，但这个背景提供了一个清晰直观的介绍，帮助我们理解子空间模拟的核心概念。

### 振动模式的物理

物体不会以随机的方式变形；相反，它会以特定、特征的模式叠加振动，这些模式称为**模式**。每个基本模式都称为**模式形状**，代表物体可以变形的特定方式。整体运动随后由每个模式形状在任意给定时刻对总变形的贡献程度来描述；这种“贡献量”称为**模态振幅**。

每个模式都有一个相关的固有频率。低频模式对应于大、低能量的变形（如音叉的基本弯曲），而高频模式代表复杂、高能量的振动，这些振动通常难以看到且容易消散。

关键的洞察是，一个物体的绝大多数可见动态行为可以用这些低频模式中的少数几个来描述。通过将我们的模拟限制在这些重要的模式上，我们可以创建一个高度有效的近似。重要的是要记住，这种方法仅适用于小变形，其中材料的响应保持近似线性。这意味着抵抗变形的内力与位移量成正比（这种关系通常由胡克定律描述）。在我们的离散设置中，这由一个常数刚度矩阵 K 来捕捉，它也是应变能的海森矩阵的负值。对于大变形，刚度特性会随着变形而变化，线性模态分析不再适用。

### 计算模式

找到这些模式需要我们解决一个广义特征值问题。设置包括首先定义完整系统，然后应用约束。从现在起，我们将假设我们的系统是三维的。

1.  我们首先形成完整的质量矩阵 M∈R3n×3n 和刚度矩阵 K∈R3n×3n。

1.  为了考虑狄利克雷边界条件（固定顶点），我们通过移除与固定自由度相对应的行和列，形成较小的约束矩阵 M^ 和 K^。

然后在这些约束矩阵上求解特征值问题：K^ψ^i = λi M^ψ^i。(26.1.1)

> **示例 26.1.1（解释广义特征值问题）**。方程 (26.1.1) 对于理解机械系统的振动至关重要。让我们来分解它：
> 
> +   K∈R3n×3n 是完整的**刚度矩阵**。它将位移与内部弹性力（felastic=Ku）相关联。K 中的高值意味着物体强烈抵抗变形。
> +   
> +   M∈R3n×3n 是完整的**质量矩阵**。它将加速度与惯性力（finertial=Ma）相关联。
> +   
> +   **特征向量** ψi∈R3n 是**模态形状**。它是一个描述特定振动模式空间模式的向量。
> +   
> +   **特征值** λi∈R 是对应于模态 ψi 的**自然频率**的平方。

方程 Kψi=λiMψi 实质上表明一个模态变形 ψi 是特殊的：如果物体变形为这种形状，弹性恢复力（Kψi）将完美地与产生该形状正弦振动的惯性力（Mψi）成比例。

**模态**是弹性力和惯性力完美对齐的形状。低特征值对应于低能量模态，这对于视觉动画最为重要。

特征值求解器的解给出了无约束自由度的特征值 λi 和特征向量 ψ^i。特征值是振动自然频率的平方，λi=ωi2，特征向量代表模态形状。为了验证特征值求解器是否成功，通常通过将它们作为 ψi sin(ωi t) 动画来可视化单个模态，其中 t 是时间。

不同的模态向量通常组装成一个**模态基矩阵**：

U=[ψ1,…,ψr]∈R3n×r,

其中我们选择了对应于最小非零特征值的 r 个模态。

### 线性动力学子空间模拟

现在，让我们看看这种模态基如何加速模拟。具有阻尼的线性弹性系统的全空间运动方程为：

Mu¨+Du˙+Ku=fext​,(26.1.2)

其中 D 是阻尼矩阵，fext 是外力向量。为了简化这个系统，我们引入子空间方法的核心近似：将全空间位移 u 近似为我们的基向量的线性组合：

u(t)≈Uq(t).

在这里，q(t)∈Rr 是**简化坐标**或**模态振幅**的向量，理想情况下 r≪3n。每个分量 qi(t) 代表在时间 t 的变形中存在多少 ψi 模态。

要推导出 q 的运动方程，我们将 u(t) 的近似值代入 (26.1.2)，并通过预乘以 UT 将整个方程投影到子空间：UT(M(Uq¨)+D(Uq˙)+K(Uq))=UTfext (UTMU)q¨+(UTDU)q˙+(UTKU)q=UTfext。这就是魔法发生的地方。由于广义特征值问题的性质，特征向量可以被缩放到**质量正交归一**，意味着 ψiT Mψj=δij (如果 i=j，则为 1，否则为 0)。

> ****方法 26.1.1 (特征向量的质量正交化)。**** 要实现简化 UTMU=I，模态基必须被制成 **质量正交**。这通过两个步骤完成。首先，广义特征值问题自然产生 **M-正交** 的特征向量，这意味着 ψiT​Mψj​=0 对于任何两个不同的模式 i 和 j。这一性质确保了投影质量矩阵的所有非对角元素都是零。其次，为了使对角元素等于一，我们使用求解器的质量加权长度显式归一化每个原始特征向量 ψi​：ψi​=ψ​iT​Mψ​i​​ψ​i​​.​(26.1.3) 满足 ψiT​Mψi​=1 的结果向量 ψi​ 被组装到基 U 中。M-正交性和 M-归一性共同保证了投影质量矩阵是单位矩阵，这就是解耦方程组的原因。

这极大地简化了投影矩阵：

+   UTMU=I;

+   UTKU=Λ，其中 Λ 是特征值的对角矩阵，diag(λ1​,…,λr​)。

如果我们假设 **瑞利阻尼**，其中 D=αM+βK，则投影阻尼矩阵也变为对角线：UTDU=αI+βΛ。

这意味着最终的简化系统变成了一组 r 个完全独立的 1D 常微分方程：q¨​i​+(α+βλi​)q˙​i​+λi​qi​=ψiT​fext​for i=1,…,r.(26.1.4)

> **方法 26.1.2 (线性模态模拟)。** 我们可以将整个过程视为分为一次性的预计算和高效的运行时循环。
> 
> **预计算：**
> 
> 1.  将物体离散化以形成全局质量矩阵 M 和刚度矩阵 K。
> 1.  
> 1.  解广义特征值问题 Kψi​=λi​Mψi​ 以找到 r 个最小的非零特征值 λi​ 和相应的特征向量 ψi​。
> 1.  
> 1.  组装质量正交基矩阵 U=[ψ1​,…,ψr​].
> 1.  
> **运行循环（每时间步）：**
> 
> 1.  计算全空间中的外力 fext​（例如，来自重力、用户交互）。
> 1.  
> 1.  将力投影到简化基上：freduced​=UTfext​.
> 1.  
> 1.  对于每个模式 i=1,…,r，求解其简单的 1D ODE (26.1.4) 以更新其振幅 qi​。这可以通过一个简单且稳定的隐式积分方案来完成。
> 1.  
> 1.  重建全空间变形以进行渲染：u=Uq。

计算节省巨大。我们不是解决一个大的、耦合的 3n×3n 系统而是解决 r 个微小的、独立的 1D 方程，其中 r 可能是 20-50，而 3n 可能是成千上万甚至数百万。
