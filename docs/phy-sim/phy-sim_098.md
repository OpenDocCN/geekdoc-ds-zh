# 弹性项

> 原文：[`phys-sim-book.github.io/lec19.3-elasticity_term.html`](https://phys-sim-book.github.io/lec19.3-elasticity_term.html)



对于离散弱形式系统中的弹性项 ∫Ω0​Na^,j​(X)Pi^j​(X,tn)dX，我们可以将其写成每个三角形 e 上的积分之和，以向量形式表示：

∫Ω0​Na^,j​(X)Pi^j​(X,tn)dX=∫Ω0​(P(X,tn)∇XNa^​(X))i^​ dX=e∈T∑​∫Ωe0​​(P(X,tn)∇XNa^​(X))i^​ dX.​(19.3.1)

类似地，这个求和也只需要涉及节点 a^ 的入射三角形。

从 应变能 中回忆起，为了计算第一 Piola-Kirchoff 应力 P(X,tn)，我们只需要变形梯度 F(X,tn)。从 运动学 部分我们知道 F=∂X∂x​。应用链式法则，使用参数空间变量 (β,γ) 作为中间变量，我们有：

F=∂(β,γ)∂x​(∂(β,γ)∂X​)−1≈∂(β,γ)∂x^​(∂(β,γ)∂X​)−1=[x2​−x1​,x3​−x1​][X2​−X1​,X3​−X1​]−1,​(19.3.2)

这与我们的早期实现（无逆弹性部分）中的方程 (15.1.1) 完全相同。在这里，我们还可以看到，在线性有限元中，变形梯度场在 Ω0 中是分段常数的，P 也是如此。

然后对于 ∇XNa^​(X)，根据 a^ 在三角形 e 中的索引，我们可以使用参数空间变量再次推导它，如下所示：

∇XN1​(X)∇XN2​(X)=([1,0][X2​−X1​,X3​−X1​]−1)T∇XN3​(X)=([0,1][X2​−X1​,X3​−X1​]−1)T.​=∂X∂(1−β−γ)​=(∂(β,γ)∂(1−β−γ)​(∂(β,γ)∂X​)−1)T=([−1,−1][X2​−X1​,X3​−X1​]−1)T=∂X∂β​=(∂(β,γ)∂β​(∂(β,γ)∂X​)−1)T=∂X∂γ​=(∂(β,γ)∂γ​(∂(β,γ)∂X​)−1)T

这也使我们能够看到 P(X,tn)∇XNa^​(X) 在任何三角形 e 内是常数，并且它与 ∂xa^​∂Ψe​​ 等价，因为：

∂xa^​∂Ψe​​=∂F∂Ψe​​∂xa^​∂F​=P∇XNa^​.​

将 ∂xa^​∂Ψe​​ 代入方程 (19.3.1) 中，我们得到：

∫Ω0​Na^,j​(X)Pi^j​(X,tn)dX​=e∈T∑​∫Ωe0​​(P(X,tn)∇XNa^​(X))i^​ dX=e∈T∑​∫Ωe0​​(∂xa^​∂Ψe​​)i^​ dX=e∈T∑​Ae​(∂xa^​∂Ψe​​)i^​,​

这正是我们在 无逆弹性 部分计算节点弹性力的方式。这也表明，总弹性势能可以计算为 ∑e∈T​Ae​Ψe​，这是在空间离散化之前的 ∫Ω0​Ψ(X)dX。

> ***备注 19.3.1.* [线性有限元法]** 线性有限元法指的是 x 是 X 的分段线性函数，但弹性模型仍然可以是非线性的，即 P 可以是 F 的非线性函数。
