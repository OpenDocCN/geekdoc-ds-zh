# 离散化和近似

> 原文：[`phys-sim-book.github.io/lec22.1-disc_and_approx.html`](https://phys-sim-book.github.io/lec22.1-disc_and_approx.html)

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">

从方程 (18.4.2) 中，单位面积的摩擦力定义为

TF(X,t)=−μ∥TC(X,t)∥f(∥VF(X,t)∥)s(VF(X,t)),

其中 μ 是摩擦系数，TC 是法向接触力，VF 是相对滑动速度。当 ∥VF∥>0 时，s(VF)=∥VF∥VF，而当 ∥VF∥=0 时，s(VF) 取与法向 N(X,t) 正交的任何单位向量。此外，摩擦缩放函数 f 也相对于 VF 是非光滑的，因为当 ∥VF∥>0 时，f(∥VF∥)=1，而当 ∥VF∥=0 时，f(∥VF∥)∈[0,1]。

需要注意的是，如果没有时间离散化，则不存在摩擦的势能。然而，类似于摩擦接触，一旦我们将法向力大小和切向算子离散化到最后一步，并平滑地近似摩擦缩放函数 f，第 (n+1)-th 时间步的摩擦力相对于 x 变得可积，我们得到

TFn+1(X)≈−∂xn+1(X)∂Dn+1(X)​=−∂xn+1(X)∂(μ∥TCn​(X)∥f0​(∥VˉFn+1​(X)h^∥))​.

在这里，VˉFn+1(X)=(I−Nn(X)Nn(X)T)(Vn+1(X)−Vn+1(X2)) 是近似相对滑动速度，其中 Nn 和 X2 是最后一步中与 X 接触的法向和点，h^I=(∂v/∂x)−1，并且

f0(y)={−3ϵv2h²y3+ϵvh^y2+3ϵvh^​,y,​y∈0,ϵvh^);y≥ϵvh^.​

因此，考虑到自接触，整个边界的近似摩擦势可以写成

∫ΓC21μ∥TCn(X)∥f0(∥VˉFn+1(X)h^∥)ds(X),

其中 21 的缩放来自积分中对每对接触点之间摩擦的双倍计数（类似于[边界条件和摩擦接触中的法向接触力）。

在将边界曲线离散化为多边形并使用求和近似法向接触力分量中的最大运算符（分段线性边界）之后，我们同样可以得到空间离散化的摩擦势：

∫ΓCe∈E−I(X)∑21μ(−∂d∂b(dPE(xn(X),e),d^)​)f0(∥VˉFn+1(X,e)h^∥)ds(X).

在这里，dPE(xn(X),e) 是 xn(X) 和最后一步中边 e 之间的点-边距离，VˉFn+1(X,e) 是具有接触法向和最近点离散化到最后一步的点-边对的近似相对滑动速度（参见下一节以获取详细信息）。

如果我们选择边界节点作为求积点来近似积分，我们最终得到我们的离散摩擦势：

Pf(x)​=a^∑Aa^​e∈E−I(Xa^​)∑21μ(−∂d∂b(dPE(xa^n​,e),d^)​)f0(∥VˉFn+1(Xa^​,e)h^∥)=k∈{(a^,e)}∑μλkn​f0(∥vˉk​h^∥)​

其中，Aa^=2∥Xa^−Xa^−1∥+∥Xa^−Xa^+1∥是积分权重。令 vˉk=VˉFn+1(Xa^,e)和λkn=21Aa^(-∂d/∂b(dPE(xa^n, e),d^))，Pf 的表达式与直接导出的方程(9.2.1)的离散形式一致，只是这里的 k 遍历边界上的所有非入射点-边对。

基于此平滑半隐式摩擦势的离散形式，我们现在需要确定如何计算点-边对中的λ和 vˉ，实现 Pf(x)的值、梯度和 Hessian 的计算，然后将它们纳入优化过程。
