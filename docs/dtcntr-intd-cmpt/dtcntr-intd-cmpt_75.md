# 28 Pyret for Racketeers and SchemersðŸ”—

> åŽŸæ–‡ï¼š[`dcic-world.org/2025-08-27/p4rs.html`](https://dcic-world.org/2025-08-27/p4rs.html)

| 28.1 æ•°å­—ã€å­—ç¬¦ä¸²å’Œå¸ƒå°”å€¼](#%28part._.Numbers__.Strings__and_.Booleans%29) |
| --- |
| 28.2 ä¸­ç¼€è¡¨è¾¾å¼](#%28part._.Infix_.Expressions%29) |
| 28.3 å‡½æ•°å®šä¹‰å’Œåº”ç”¨](#%28part._.Function_.Definition_and_.Application%29) |
| 28.4 æµ‹è¯•](#%28part._.Tests%29) |
| 28.5 å˜é‡å](#%28part._.Variable_.Names%29) |
| 28.6 æ•°æ®å®šä¹‰](#%28part._.Data_.Definitions%29) |
| 28.7 æ¡ä»¶è¯­å¥](#%28part._.Conditionals%29) |
| 28.8 åˆ—è¡¨](#%28part._.Lists%29) |
| 28.9 é¦–ç±»å‡½æ•°](#%28part._.First-.Class_.Functions%29) |
| 28.10 æ³¨é‡Š](#%28part._.Annotations%29) |
| 28.11 è¿˜æœ‰å…¶ä»–ä»€ä¹ˆï¼Ÿ](#%28part._.What_.Else_%29) |

å¦‚æžœä½ ä¹‹å‰åœ¨åƒ Scheme æˆ– Racket çš„å­¦ç”Ÿçº§åˆ«ï¼ˆæˆ– WeScheme ç¼–ç¨‹çŽ¯å¢ƒï¼‰è¿™æ ·çš„è¯­è¨€ä¸­ç¼–ç¨‹è¿‡ï¼Œæˆ–è€…ç”šè‡³åœ¨æŸäº›éƒ¨åˆ†çš„ OCamlã€Haskellã€Scalaã€Erlangã€Clojure æˆ–å…¶ä»–è¯­è¨€ä¸­ç¼–ç¨‹è¿‡ï¼Œä½ ä¼šå‘çŽ° Pyret çš„è®¸å¤šéƒ¨åˆ†éžå¸¸ç†Ÿæ‚‰ã€‚æœ¬ç« ä¸“é—¨ç¼–å†™æ¥å¸®åŠ©ä½ é€šè¿‡å±•ç¤ºå¦‚ä½•è½¬æ¢è¯­æ³•ï¼Œä»Žï¼ˆå­¦ç”Ÿï¼‰Racket/Scheme/WeSchemeï¼ˆç¼©å†™ä¸ºâ€œRSWâ€ï¼‰è¿‡æ¸¡åˆ° Pyretã€‚æˆ‘ä»¬æ‰€è¯´çš„å†…å®¹å¤§å¤šé€‚ç”¨äºŽæ‰€æœ‰è¿™äº›è¯­è¨€ï¼Œå°½ç®¡åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†å…·ä½“æåˆ° Racketï¼ˆå’Œ WeSchemeï¼‰ä¸­æœªåœ¨ Scheme ä¸­æ‰¾åˆ°çš„åŠŸèƒ½ã€‚

åœ¨ä¸‹é¢çš„æ¯ä¸ªä¾‹å­ä¸­ï¼Œä¸¤ä¸ªç¨‹åºå°†äº§ç”Ÿç›¸åŒçš„ç»“æžœã€‚

### 28.1 æ•°å­—ã€å­—ç¬¦ä¸²å’Œå¸ƒå°”å€¼ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

ä¸¤ä¸ªè¯­è¨€ä¹‹é—´çš„æ•°å­—éžå¸¸ç›¸ä¼¼ã€‚åƒ Scheme ä¸€æ ·ï¼ŒPyret å®žçŽ°äº†ä»»æ„ç²¾åº¦æ•°å­—å’Œæœ‰ç†æ•°ã€‚ä¸€äº› Scheme ä¸­æ›´å¥‡ç‰¹çš„æ•°å­—ç³»ç»Ÿï¼ˆå¦‚å¤æ•°ï¼‰ä¸åœ¨ Pyret ä¸­ï¼›Pyret è¿˜å¯¹ä¸ç²¾ç¡®æ•°å­—çš„å¤„ç†ç•¥æœ‰ä¸åŒã€‚

| RSW | Pyret |
| --- | --- |
| 1 | `1` |
| RSW | Pyret |
| 1/2 | `1/2` |
| RSW | Pyret |
| #i3.14 | `~3.14` |

å­—ç¬¦ä¸²ä¹Ÿéžå¸¸ç›¸ä¼¼ï¼Œå°½ç®¡ Pyret å…è®¸ä½ ä½¿ç”¨å•å¼•å·ã€‚

| RSW | Pyret |
| --- | --- |
| "Hello, world!" | `"Hello, world!"` |
| RSW | Pyret |
| â€œHelloâ€ï¼Œä»–è¯´ | `"â€œHelloâ€ï¼Œä»–è¯´"` |
| RSW | Pyret |
| â€œHelloâ€ï¼Œä»–è¯´ | `'"Hello"ï¼Œä»–è¯´'` |

å¸ƒå°”å€¼å…·æœ‰ç›¸åŒçš„åç§°ï¼š

| RSW | Pyret |
| --- | --- |
| true | `true` |
| RSW | Pyret |
| false | `false` |

### 28.2 ä¸­ç¼€è¡¨è¾¾å¼ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

Pyret ä½¿ç”¨ä¸­ç¼€è¯­æ³•ï¼Œç±»ä¼¼äºŽè®¸å¤šå…¶ä»–æ–‡æœ¬ç¼–ç¨‹è¯­è¨€ï¼š

| RSW | Pyret |
| --- | --- |
| (+ 1 2) | `1 + 2` |
| RSW | Pyret |
| (* (- 4 2) 5) | `(4 - 2) * 5` |

æ³¨æ„ï¼ŒPyret æ²¡æœ‰å…³äºŽè¿ç®—ç¬¦ä¼˜å…ˆçº§é¡ºåºçš„è§„åˆ™ï¼Œæ‰€ä»¥å½“ä½ æ··åˆè¿ç®—ç¬¦æ—¶ï¼Œä½ å¿…é¡»æ‹¬å·è¡¨è¾¾å¼ä»¥ä½¿ä½ çš„æ„å›¾æ˜Žç¡®ã€‚å½“ä½ é“¾å¼ä½¿ç”¨ç›¸åŒçš„è¿ç®—ç¬¦æ—¶ï¼Œä½ ä¸éœ€è¦æ‹¬å·ï¼›é“¾å¼åœ¨ä¸¤ç§è¯­è¨€ä¸­éƒ½æ˜¯å·¦ç»“åˆçš„ï¼š

| RSW | Pyret |
| --- | --- |
| (/ 1 2 3 4) | `1 / 2 / 3 / 4` |

è¿™ä¸¤ä¸ªéƒ½è®¡ç®—ä¸º 1/24ã€‚

### 28.3 å‡½æ•°å®šä¹‰å’Œåº”ç”¨ðŸ”— "é“¾æŽ¥è‡³æ­¤")

åœ¨ Pyret ä¸­ï¼Œå‡½æ•°å®šä¹‰å’Œåº”ç”¨å…·æœ‰ä¸­ç¼€è¯­æ³•ï¼Œæ›´ç±»ä¼¼äºŽè®¸å¤šå…¶ä»–æ–‡æœ¬ç¼–ç¨‹è¯­è¨€ã€‚åº”ç”¨ä½¿ç”¨ä»Žä¼ ç»Ÿä»£æ•°ä¹¦ç±ä¸­ç†Ÿæ‚‰çš„è¯­æ³•ï¼š

| RSW | Pyret |
| --- | --- |
| (dist 3 4) | `dist(3, 4)` |

åº”ç”¨åœ¨å‡½æ•°å¤´ä¸­ä½¿ç”¨ç±»ä¼¼çš„è¯­æ³•ï¼Œåœ¨ä¸»ä½“ä¸­ä½¿ç”¨ä¸­ç¼€ï¼š

| RSW | Pyret |
| --- | --- |

|

> &#124; (define (dist x y) &#124;
> 
> &#124; (sqrt (+ (* x x) &#124;
> 
> &#124; (* y y))) &#124;

|

```py
fun dist(x, y):
  num-sqrt((x * x) +
           (y * y))
end
```

|

### 28.4 æµ‹è¯•ðŸ”— "é“¾æŽ¥è‡³æ­¤")

å®žé™…ä¸Šï¼Œæœ‰ä¸‰ç§ä¸åŒçš„æ–¹å¼æ¥ç¼–å†™ Racket çš„ check-expect æµ‹è¯•çš„ç­‰æ•ˆä»£ç ã€‚å®ƒä»¬å¯ä»¥ç¿»è¯‘æˆ check å—ï¼š

| RSW | Pyret |
| --- | --- |
| (check-expect 1 1) |

```py
check:
  1 is 1
end
```

|

æ³¨æ„ï¼Œå¯ä»¥å°†å¤šä¸ªæµ‹è¯•æ”¾å…¥ä¸€ä¸ªå—ä¸­ï¼š

| RSW | Pyret |
| --- | --- |

|

> &#124; (check-expect 1 1) &#124;
> 
> &#124; (check-expect 2 2) &#124;

|

```py
check:
  1 is 1
  2 is 2
end
```

|

ç¬¬äºŒç§æ–¹å¼æ˜¯ï¼šä½œä¸º `check` çš„åˆ«åï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å†™ `examples`ã€‚è¿™ä¸¤ä¸ªåœ¨åŠŸèƒ½ä¸Šæ˜¯ç›¸åŒçš„ï¼Œä½†å®ƒä»¬æ•æ‰äº†ä¾‹å­ï¼ˆæŽ¢ç´¢é—®é¢˜ï¼Œåœ¨å°è¯•è§£å†³æ–¹æ¡ˆä¹‹å‰ç¼–å†™ï¼‰å’Œæµ‹è¯•ï¼ˆè¯•å›¾æ‰¾åˆ°è§£å†³æ–¹æ¡ˆä¸­çš„é”™è¯¯ï¼Œå¹¶ç¼–å†™æ¥æŽ¢æµ‹å…¶è®¾è®¡ï¼‰ä¹‹é—´çš„äººç±»å·®å¼‚ã€‚

ç¬¬ä¸‰ç§æ–¹å¼æ˜¯ç¼–å†™ä¸€ä¸ª `where` å—æ¥ä¼´éšå‡½æ•°å®šä¹‰ã€‚ä¾‹å¦‚ï¼š

```py
fun double(n):
  n + n
where:
  double(0) is 0
  double(10) is 20
  double(-1) is -2
end
```

è¿™äº›ç”šè‡³å¯ä»¥ç”¨äºŽå†…éƒ¨å‡½æ•°ï¼ˆå³åŒ…å«åœ¨å…¶ä»–å‡½æ•°ä¸­çš„å‡½æ•°ï¼‰ï¼Œè¿™å¯¹äºŽ check-expect æ¥è¯´å¹¶ä¸æˆç«‹ã€‚

ä¸Ž Racket ä¸åŒï¼ŒPyret ä¸­çš„æµ‹è¯•å—å¯ä»¥åŒ…å«æ–‡æ¡£å­—ç¬¦ä¸²ã€‚å½“ Pyret æŠ¥å‘Šæµ‹è¯•æˆåŠŸå’Œå¤±è´¥æ—¶ï¼Œä¼šä½¿ç”¨å®ƒã€‚ä¾‹å¦‚ï¼Œå°è¯•è¿è¡Œå¹¶æŸ¥çœ‹æ‚¨å¾—åˆ°çš„ç»“æžœï¼š

```py
check "squaring always produces non-negatives":
  (0 * 0) is 0
  (-2 * -2) is 4
  (3 * 3) is 9
end
```

è¿™å¯¹äºŽè®°å½•æµ‹è¯•å—çš„ç›®çš„å¾ˆæœ‰ç”¨ã€‚

å°±åƒåœ¨ Racket ä¸­ä¸€æ ·ï¼ŒPyret ä¸­æœ‰è®¸å¤šæµ‹è¯•è¿ç®—ç¬¦ï¼ˆé™¤äº† `is`ï¼‰ã€‚å‚è§ [æ–‡æ¡£](https://www.pyret.org/docs/latest/testing.html)ã€‚

### 28.5 å˜é‡åðŸ”— "é“¾æŽ¥è‡³æ­¤")

ä¸¤ç§è¯­è¨€éƒ½æœ‰ç›¸å½“å®½å®¹çš„å˜é‡å‘½åç³»ç»Ÿã€‚è™½ç„¶ä½ å¯ä»¥åœ¨ä¸¤è€…ä¸­ä½¿ç”¨é©¼å³°å¼å’Œä¸‹åˆ’çº¿ï¼Œä½†ä¼ ç»Ÿä¸Šä½¿ç”¨æ‰€è°“çš„ [kebab-case](http://c2.com/cgi/wiki?KebabCase)ã€‚è¿™ä¸ªåç§°ä¸å‡†ç¡®ã€‚å•è¯â€œkebabâ€åªæ˜¯æ„å‘³ç€â€œè‚‰â€ã€‚ä¸²æ˜¯â€œshishâ€ã€‚å› æ­¤ï¼Œè‡³å°‘åº”è¯¥è¢«ç§°ä¸ºâ€œshish kebab caseâ€ã€‚å› æ­¤ï¼š

| RSW | Pyret |
| --- | --- |
| this-is-a-name | `this-is-a-name` |

å³ä½¿ Pyret æœ‰ä¸­ç¼€å‡æ³•ï¼Œè¯¥è¯­è¨€ä¹Ÿèƒ½æ˜Žç¡®åŒºåˆ† `this-name`ï¼ˆä¸€ä¸ªå˜é‡ï¼‰å’Œ `this - name`ï¼ˆä¸€ä¸ªå‡æ³•è¡¨è¾¾å¼ï¼‰ï¼Œå› ä¸ºåŽè€…ä¸­çš„ `-` å¿…é¡»è¢«ç©ºæ ¼åŒ…å›´ã€‚

å°½ç®¡å­˜åœ¨è¿™ç§ç¼©è¿›çº¦å®šï¼ŒPyret å¹¶ä¸å…è®¸ Scheme å…è®¸çš„ä¸€äº›æ›´å¥‡ç‰¹çš„åå­—ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥è¿™æ ·å†™

> | (define e^i*pi -1) |
> | --- |

åœ¨ Scheme ä¸­æ˜¯æœ‰æ•ˆçš„ï¼Œä½†åœ¨ Pyret ä¸­ä¸æ˜¯æœ‰æ•ˆçš„å˜é‡åã€‚

### 28.6 æ•°æ®å®šä¹‰ðŸ”— "é“¾æŽ¥è‡³æ­¤")

Pyret åœ¨å¤„ç†æ•°æ®å®šä¹‰æ–¹é¢ä¸Ž Racketï¼ˆç”šè‡³ä¸Ž Schemeï¼‰æœ‰æ‰€ä¸åŒã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•å®šä¹‰ä¸€ä¸ªç»“æž„ï¼š

| RSW | Pyret |
| --- | --- |
| (define-structÂ ptÂ (xÂ y)) |

```py
data Point:
  &#124; pt(x, y)
end
```

|

è¿™å¯èƒ½çœ‹èµ·æ¥æœ‰äº›è¿‡åº¦ï¼Œä½†æˆ‘ä»¬å°†å¾ˆå¿«çœ‹åˆ°ä¸ºä»€ä¹ˆå®ƒæ˜¯æœ‰ç”¨çš„ã€‚åŒæ—¶ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“æ•°æ®å®šä¹‰ä¸­åªæœ‰ä¸€ç§æ•°æ®ç±»åž‹æ—¶ï¼Œå ç”¨è¿™ä¹ˆå¤šè¡Œæ¥ç¼–å†™å®ƒæ„Ÿè§‰å¾ˆä¸æ–¹ä¾¿ã€‚å°†å…¶å†™åœ¨ä¸€è¡Œæ˜¯æœ‰æ•ˆçš„ï¼Œä½†çŽ°åœ¨ä¸­é—´çš„ `|` è®©ä»£ç çœ‹èµ·æ¥å¾ˆä¸‘ï¼š

```py
data Point: | pt(x, y) end
```

å› æ­¤ï¼ŒPyret å…è®¸ä½ çœç•¥åˆå§‹çš„ `|`ï¼Œä»Žè€Œä½¿å¾—ä»£ç æ›´æ˜“è¯»ã€‚

```py
data Point: pt(x, y) end
```

çŽ°åœ¨å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ç§ç±»åž‹çš„ç‚¹ã€‚åœ¨ Racket çš„å­¦ç”Ÿè¯­è¨€ä¸­ï¼Œæˆ‘ä»¬ä¼šç”¨æ³¨é‡Šæ¥æè¿°è¿™ä¸€ç‚¹ï¼š

> | ;;Â ä¸€ä¸ªç‚¹å¯ä»¥æ˜¯ |
> | --- |
> | ;;Â -Â (ptÂ numberÂ number),Â or |
> | ;;Â -Â (pt3dÂ numberÂ numberÂ number) |

åœ¨ Pyret ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥è¡¨è¾¾è¿™ä¸€ç‚¹ï¼š

```py
data Point:
  | pt(x, y)
  | pt3d(x, y, z)
end
```

ç®€è€Œè¨€ä¹‹ï¼ŒRacket ä¼˜åŒ–äº†å•å˜ä½“æƒ…å†µï¼Œè€Œ Pyret ä¼˜åŒ–äº†å¤šå˜ä½“æƒ…å†µã€‚å› æ­¤ï¼Œåœ¨ Racket ä¸­æ¸…æ¥šåœ°è¡¨è¾¾å¤šå˜ä½“æƒ…å†µå¾ˆå›°éš¾ï¼Œè€Œåœ¨ Pyret ä¸­è¡¨è¾¾å•å˜ä½“æƒ…å†µåˆ™æ˜¾å¾—ç¬¨æ‹™ã€‚

å¯¹äºŽç»“æž„ï¼ŒRacket å’Œ Pyret éƒ½æš´éœ²äº†æž„é€ å‡½æ•°ã€é€‰æ‹©å™¨å’Œè°“è¯ã€‚æž„é€ å‡½æ•°åªæ˜¯å‡½æ•°ï¼š

| RSW | Pyret |
| --- | --- |
| (ptÂ 1Â 2) | `pt(1, 2)` |

è°“è¯ä¹Ÿæ˜¯éµå¾ªç‰¹å®šå‘½åæ–¹æ¡ˆçš„å‡½æ•°ï¼š

| RSW | Pyret |
| --- | --- |
| (pt?Â x) | is-pt(x) |

å®ƒä»¬çš„è¡Œä¸ºæ–¹å¼ç›¸åŒï¼ˆå¦‚æžœå‚æ•°æ˜¯ç”±è¯¥æž„é€ å‡½æ•°æž„é€ çš„ï¼Œåˆ™è¿”å›ž trueï¼Œå¦åˆ™è¿”å›ž falseï¼‰ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œé€‰æ‹©åœ¨ä¸¤ç§è¯­è¨€ä¸­æ˜¯ä¸åŒçš„ï¼ˆæˆ‘ä»¬å°†åœ¨ä¸‹é¢å…³äºŽ `cases` çš„éƒ¨åˆ†ä¸­çœ‹åˆ°æ›´å¤šå…³äºŽé€‰æ‹©çš„å†…å®¹ï¼‰ï¼š

| RSW | Pyret |
| --- | --- |
| (pt-xÂ v) | `v.x` |

æ³¨æ„ï¼Œåœ¨ Racket çš„æƒ…å†µä¸‹ï¼Œpt-x åœ¨æå– x å­—æ®µçš„å€¼ä¹‹å‰ä¼šæ£€æŸ¥å‚æ•°æ˜¯å¦ç”± pt æž„é€ ã€‚å› æ­¤ï¼Œpt-x å’Œ pt3d-x æ˜¯ä¸¤ä¸ªä¸åŒçš„å‡½æ•°ï¼Œä¸èƒ½äº’ç›¸æ›¿ä»£ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåœ¨ Pyret ä¸­ï¼Œ`.x` ä»Žä»»ä½•å…·æœ‰è¯¥å­—æ®µçš„å€¼ä¸­æå– `x` å­—æ®µï¼Œè€Œä¸è€ƒè™‘å®ƒæ˜¯å¦‚ä½•æž„é€ çš„ã€‚å› æ­¤ï¼Œæ— è®ºå€¼æ˜¯ç”± `pt` æˆ– `pt3d`ï¼ˆæˆ–ä»»ä½•å…¶ä»–å…·æœ‰è¯¥å­—æ®µçš„å¯¹è±¡ï¼‰æž„é€ çš„ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥åœ¨å€¼ä¸Šä½¿ç”¨ `.x`ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œ`cases` ä¼šæ³¨æ„è¿™ç§åŒºåˆ«ã€‚

### 28.7 æ¡ä»¶ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

Pyret ä¸­æœ‰å‡ ç§æ¡ä»¶ç±»åž‹ï¼Œæ¯” Racket çš„å­¦ç”Ÿè¯­è¨€å¤šä¸€ç§ã€‚

é€šç”¨æ¡ä»¶å¯ä»¥ä½¿ç”¨ `if` è¡¨è¾¾ï¼Œå¯¹åº”äºŽ Racket çš„ `if`ï¼Œä½†è¯­æ³•æ›´å¤æ‚ã€‚

| RSW | Pyret |
| --- | --- |

|

> &#124; (ifÂ full-moon &#124;
> 
> &#124; Â Â Â Â "howl" &#124;
> 
> &#124; Â Â Â Â "meow") &#124;

|

```py
if full-moon:
  "howl"
else:
  "meow"
end
```

|

| RSW | Pyret |
| --- | --- |

|

> &#124; (ifÂ full-moon &#124;
> 
> &#124; Â Â Â Â "howl" &#124;
> 
> &#124; Â Â Â Â (ifÂ new-moon &#124;
> 
> &#124; Â Â Â Â Â Â Â Â "bark" &#124;
> 
> &#124; Â Â Â Â Â Â Â Â "meow")) &#124;

|

```py
if full-moon:
  "howl"
else if new-moon:
  "bark"
else:
  "meow"
end
```

|

æ³¨æ„ï¼Œ`if` åŒ…å« `else if`ï¼Œè¿™ä½¿å¾—å¯ä»¥åœ¨åŒä¸€ç¼©è¿›çº§åˆ«ä¸Šåˆ—å‡ºä¸€ç³»åˆ—é—®é¢˜ï¼Œè¿™åœ¨ Racket ä¸­æ˜¯ä¸å­˜åœ¨çš„ã€‚ç›¸åº”çš„ Racket ä»£ç å°†å†™æˆ

> | (cond |
> | --- |
> | Â Â [full-moonÂ "howl"] |
> | Â Â [new-moonÂ "bark"] |
> | Â Â [elseÂ "meow"]) |

ä¸ºäº†æ¢å¤ç¼©è¿›ã€‚Pyret ä¸­æœ‰ä¸€ä¸ªç±»ä¼¼çš„æž„é€ ï¼Œç§°ä¸º `ask`ï¼Œæ—¨åœ¨ä¸Ž `cond` å¹³è¡Œï¼š

```py
ask:
  | full-moon then: "howl"
  | new-moon then:  "bark"
  | otherwise:      "meow"
end
```

åœ¨ Racket ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿä½¿ç”¨ `cond` æ¥æ ¹æ®æ•°æ®ç±»åž‹åˆ†å‘ï¼š

> | (cond |
> | --- |
> | |Â Â Â [(pt?Â v)Â Â Â (+Â (pt-xÂ v)Â (pt-yÂ v))] |
> | |Â Â Â [(pt3d?Â v)Â (+Â (pt-xÂ v)Â (pt-zÂ v))]) |

æˆ‘ä»¬å¯ä»¥åœ¨ Pyret ä¸­ä»¥éžå¸¸ç›¸ä¼¼çš„æ–¹å¼ç¼–å†™ï¼š

```py
ask:
  | is-pt(v)   then: v.x + v.y
  | is-pt3d(v) then: v.x + v.z
end
```

æˆ–è€…ç”šè‡³å¯ä»¥å†™æˆï¼š

```py
if is-pt(v):
  v.x + v.y
else if is-pt3d(v):
  v.x + v.z
end
```

(ä¸Ž Racket å­¦ç”Ÿè¯­è¨€ä¸€æ ·ï¼Œå¦‚æžœæ¡ä»¶åˆ†æ”¯æ²¡æœ‰åŒ¹é…ï¼ŒPyret ç‰ˆæœ¬å°†å‘å‡ºé”™è¯¯ä¿¡å·ã€‚)

ç„¶è€Œï¼ŒPyret æä¾›äº†ä¸“é—¨ç”¨äºŽæ•°æ®å®šä¹‰çš„ç‰¹æ®Šè¯­æ³•ï¼š

```py
cases (Point) v:
  | pt(x, y)      => x + y
  | pt3d(x, y, z) => x + z
end
```

è¿™æ£€æŸ¥ `v` æ˜¯å¦ä¸º `Point`ï¼Œæä¾›äº†ä¸€ç§å¹²å‡€çš„è¯­æ³•æ–¹å¼æ¥è¯†åˆ«ä¸åŒçš„åˆ†æ”¯ï¼Œå¹¶ä½¿å¾—ä¸ºæ¯ä¸ªå­—æ®µä½ç½®æä¾›ä¸€ä¸ªç®€æ´çš„å±€éƒ¨åç§°æˆä¸ºå¯èƒ½ï¼Œè€Œä¸æ˜¯å¿…é¡»ä½¿ç”¨é€‰æ‹©å™¨å¦‚ `.x`ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨ Pyret ä¸­ï¼Œæˆ‘ä»¬æ›´å–œæ¬¢ä½¿ç”¨ `cases` æ¥å¤„ç†æ•°æ®å®šä¹‰ã€‚ç„¶è€Œï¼Œæœ‰æ—¶ï¼Œä¾‹å¦‚ï¼Œæ•°æ®æœ‰å¤šç§å˜ä½“ï¼Œä½†å‡½æ•°åªå¤„ç†å…¶ä¸­çš„ä¸€å°éƒ¨åˆ†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¾å¼ä½¿ç”¨è°“è¯å’Œé€‰æ‹©å™¨æ›´æœ‰æ„ä¹‰ã€‚

### 28.8Â åˆ—è¡¨ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

åœ¨ Racket ä¸­ï¼Œæ ¹æ®è¯­è¨€çº§åˆ«ï¼Œåˆ—è¡¨å¯ä»¥ä½¿ç”¨ cons æˆ– list åˆ›å»ºï¼Œç©ºåˆ—è¡¨ä½¿ç”¨ emptyã€‚Pyret ä¸­çš„å¯¹åº”æ¦‚å¿µåˆ†åˆ«ç§°ä¸º `link`ã€`list` å’Œ `empty`ã€‚`link` æ˜¯ä¸€ä¸ªæŽ¥å—ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œå°±åƒåœ¨ Racket ä¸­ä¸€æ ·ï¼š

| RSW | Pyret |
| --- | --- |
| (consÂ 1Â empty) | `link(1, empty)` |
| RSW | Pyret |
| (listÂ 1Â 2Â 3) | `[list: 1, 2, 3]` |

æ³¨æ„ï¼Œè¡¨ç¤ºåˆ—è¡¨çš„è¯­æ³• `[1, 2, 3]` åœ¨ Pyret ä¸­æ˜¯éžæ³•çš„ï¼šåˆ—è¡¨æ²¡æœ‰è‡ªå·±çš„ä¸“ç”¨è¯­æ³•ã€‚ç›¸åï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨æ˜¾å¼çš„æž„é€ å‡½æ•°ï¼šæ­£å¦‚ `[list: 1, 2, 3]` æž„é€ åˆ—è¡¨ä¸€æ ·ï¼Œ`[set: 1, 2, 3]` æž„é€ é›†åˆè€Œä¸æ˜¯åˆ—è¡¨ã€‚å®žé™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ [åˆ›å»ºè‡ªå·±çš„æž„é€ å‡½æ•°](https://www.pyret.org/docs/latest/Expressions.html#%28part._s~3aconstruct-expr%29) å¹¶ä½¿ç”¨è¿™ç§è¯­æ³•ã€‚

> ç»ƒä¹ 
> 
> > å°è¯•è¾“å…¥ `[1, 2, 3]` å¹¶æŸ¥çœ‹é”™è¯¯ä¿¡æ¯ã€‚

è¿™å±•ç¤ºäº†å¦‚ä½•æž„é€ åˆ—è¡¨ã€‚è¦åˆ†è§£å®ƒä»¬ï¼Œæˆ‘ä»¬ä½¿ç”¨ `cases`ã€‚æœ‰ä¸¤ç§å˜ä½“ï¼Œ`empty` å’Œ `link`ï¼ˆæˆ‘ä»¬ç”¨æ¥æž„é€ åˆ—è¡¨ï¼‰ï¼š

| RSW | Pyret |
| --- | --- |

|

> &#124; (cond &#124;
> 
> &#124;Â Â Â [(empty?Â l)Â 0] &#124;
> 
> &#124;Â Â Â [(cons?Â l) &#124;
> 
> &#124;Â Â Â (+Â (firstÂ l) &#124;
> 
> &#124;Â Â Â Â Â (gÂ (restÂ l)))] &#124;

|

```py
cases (List) l:
  &#124; empty      => 0
  &#124; link(f, r) => f + g(r)
end
```

|

é€šå¸¸å°†å­—æ®µå‘½åä¸º `f` å’Œ `r`ï¼ˆåˆ†åˆ«ä»£è¡¨â€œfirstâ€å’Œâ€œrestâ€ï¼‰ã€‚å½“ç„¶ï¼Œå¦‚æžœå­˜åœ¨å…¶ä»–åŒåçš„äº‹ç‰©ï¼Œè¿™ç§çº¦å®šå°±ä¸é€‚ç”¨ï¼›ç‰¹åˆ«æ˜¯å½“ç¼–å†™åˆ—è¡¨çš„åµŒå¥—åˆ†è§£æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸å†™æˆ `fr` å’Œ `rr`ï¼ˆåˆ†åˆ«ä»£è¡¨â€œfirst of the restâ€å’Œâ€œrest of the restâ€ï¼‰ã€‚

### 28.9Â ä¸€ç­‰å‡½æ•°ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

Racket çš„ lambda å¯¹åº”äºŽ Pyret çš„ `lam`ï¼š

| RSW | Pyret |
| --- | --- |
| (lambdaÂ (xÂ y)Â (+Â xÂ y)) | `lam(x, y): x + y end` |

### 28.10Â æ³¨è§£ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

åœ¨å­¦ç”Ÿ Racket è¯­è¨€ä¸­ï¼Œæ³¨è§£é€šå¸¸ä»¥æ³¨é‡Šçš„å½¢å¼ä¹¦å†™ï¼š

> | ;Â square:Â NumberÂ ->Â Number |
> | --- |
> | ;Â sort-nums:Â List<Number>Â ->Â List<Number> |
> | ; sort: List<T> * (T * T -> Boolean) -> List<T> |

åœ¨ Pyret ä¸­ï¼Œæˆ‘ä»¬ç›´æŽ¥åœ¨å‚æ•°å’Œè¿”å›žå€¼ä¸Šå†™æ³¨é‡Šã€‚Pyret å°†åœ¨æœ‰é™ç¨‹åº¦ä¸ŠåŠ¨æ€æ£€æŸ¥å®ƒä»¬ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨å…¶ç±»åž‹æ£€æŸ¥å™¨é™æ€æ£€æŸ¥å®ƒä»¬ã€‚ä¸Šè¿°å¯¹åº”çš„æ³¨é‡Šå°†å†™æˆ

```py
fun square(n :: Number) -> Number: ...

fun sort-nums(l :: List<Number>) -> List<Number>: ...

fun sort<T>(l :: List<T>, cmp :: (T, T -> Boolean)) -> List<T>: ...
```

### 28.11 å…¶ä»–å†…å®¹ï¼ŸðŸ”— "é“¾æŽ¥è‡³æ­¤")

å¦‚æžœæ‚¨æƒ³çœ‹åˆ° Scheme æˆ– Racket è¯­æ³•çš„å…¶ä»–éƒ¨åˆ†è¢«ç¿»è¯‘ï¼Œè¯·[å‘ŠçŸ¥æˆ‘ä»¬](http://cs.brown.edu/~sk/Contact/)ã€‚

### 28.1 æ•°å­—ã€å­—ç¬¦ä¸²å’Œå¸ƒå°”å€¼ðŸ”— "é“¾æŽ¥è‡³æ­¤")

ä¸¤ä¸ªè¯­è¨€ä¸­çš„æ•°å­—éžå¸¸ç›¸ä¼¼ã€‚åƒ Scheme ä¸€æ ·ï¼ŒPyret å®žçŽ°äº†ä»»æ„ç²¾åº¦æ•°å­—å’Œæœ‰ç†æ•°ã€‚ä¸€äº› Scheme ä¸­æ›´å¥‡ç‰¹çš„æ•°å­—ç³»ç»Ÿï¼ˆå¦‚å¤æ•°ï¼‰ä¸åœ¨ Pyret ä¸­ï¼›Pyret è¿˜å¯¹ä¸ç²¾ç¡®æ•°å­—çš„å¤„ç†ç•¥æœ‰ä¸åŒã€‚

| RSW | Pyret |
| --- | --- |
| 1 | `1` |
| RSW | Pyret |
| 1/2 | `1/2` |
| RSW | Pyret |
| #i3.14 | `~3.14` |

å­—ç¬¦ä¸²ä¹Ÿéžå¸¸ç›¸ä¼¼ï¼Œå°½ç®¡ Pyret å…è®¸æ‚¨ä½¿ç”¨å•å¼•å·ã€‚

| RSW | Pyret |
| --- | --- |
| "Hello, world!" | `"Hello, world!"` |
| RSW | Pyret |
| "\"Hello\", he said" | `"\"Hello\", he said"` |
| RSW | Pyret |
| "\"Hello\", he said" | `'"Hello", he said'` |

å¸ƒå°”å€¼å…·æœ‰ç›¸åŒçš„åç§°ï¼š

| RSW | Pyret |
| --- | --- |
| true | `true` |
| RSW | Pyret |
| false | `false` |

### 28.2 ä¸­ç¼€è¡¨è¾¾å¼ðŸ”— "é“¾æŽ¥è‡³æ­¤")

Pyret ä½¿ç”¨ä¸­ç¼€è¯­æ³•ï¼Œè¿™è®©äººè”æƒ³åˆ°è®¸å¤šå…¶ä»–æ–‡æœ¬ç¼–ç¨‹è¯­è¨€ï¼š

| RSW | Pyret |
| --- | --- |
| (+ 1 2) | `1 + 2` |
| RSW | Pyret |
| (* (- 4 2) 5) | `(4 - 2) * 5` |

æ³¨æ„ï¼ŒPyret æ²¡æœ‰å…³äºŽè¿ç®—ç¬¦ä¼˜å…ˆçº§é¡ºåºçš„è§„åˆ™ï¼Œæ‰€ä»¥å½“æ‚¨æ··åˆè¿ç®—ç¬¦æ—¶ï¼Œæ‚¨å¿…é¡»ä½¿ç”¨æ‹¬å·æ¥æ˜Žç¡®æ‚¨çš„æ„å›¾ã€‚å½“æ‚¨é“¾å¼ä½¿ç”¨ç›¸åŒçš„è¿ç®—ç¬¦æ—¶ï¼Œæ‚¨ä¸éœ€è¦ä½¿ç”¨æ‹¬å·ï¼›é“¾å¼åœ¨ä¸¤ç§è¯­è¨€ä¸­éƒ½æ˜¯å·¦ç»“åˆçš„ï¼š

| RSW | Pyret |
| --- | --- |
| (/ 1 2 3 4) | `1 / 2 / 3 / 4` |

è¿™ä¸¤ä¸ªéƒ½ç­‰äºŽ 1/24ã€‚

### 28.3 å‡½æ•°å®šä¹‰å’Œåº”ç”¨ðŸ”— "é“¾æŽ¥è‡³æ­¤")

Pyret ä¸­çš„å‡½æ•°å®šä¹‰å’Œåº”ç”¨ä½¿ç”¨ä¸­ç¼€è¯­æ³•ï¼Œè¿™è®©äººè”æƒ³åˆ°è®¸å¤šå…¶ä»–æ–‡æœ¬ç¼–ç¨‹è¯­è¨€ã€‚åº”ç”¨ä½¿ç”¨ä»Žä¼ ç»Ÿä»£æ•°ä¹¦ç±ä¸­ç†Ÿæ‚‰çš„è¯­æ³•ï¼š

| RSW | Pyret |
| --- | --- |
| (dist 3 4) | `dist(3, 4)` |

å‡½æ•°å¤´ä¸­ç›¸åº”åœ°ä½¿ç”¨ç±»ä¼¼çš„è¯­æ³•ï¼Œè€Œåœ¨å‡½æ•°ä½“ä¸­ä½¿ç”¨ä¸­ç¼€è¯­æ³•ï¼š

| RSW | Pyret |
| --- | --- |

|

> | (define (dist x y) | 
> 
> | | (sqrt (+ (* x x) | 
> 
> | | (* y y)))) | 

|

```py
fun dist(x, y):
  num-sqrt((x * x) +
           (y * y))
end
```

|

### 28.4 æµ‹è¯•ðŸ”— "é“¾æŽ¥è‡³æ­¤")

å®žé™…ä¸Šï¼Œæœ‰ä¸‰ç§ä¸åŒçš„æ–¹å¼æ¥ç¼–å†™ Racket çš„ check-expect æµ‹è¯•çš„ç­‰ä»·ç‰©ã€‚å®ƒä»¬å¯ä»¥ç¿»è¯‘æˆæ£€æŸ¥å—ï¼š

| RSW | Pyret |
| --- | --- |
| (check-expect 1 1) |  |

```py
check:
  1 is 1
end
```

|

æ³¨æ„ï¼Œå¤šä¸ªæµ‹è¯•å¯ä»¥æ”¾å…¥ä¸€ä¸ªå•ç‹¬çš„å—ä¸­ï¼š

| RSW | Pyret |
| --- | --- |

|

> | (check-expect 1 1) | 
> 
> | (check-expect 2 2) | 

|

```py
check:
  1 is 1
  2 is 2
end
```

|

ç¬¬äºŒç§æ–¹æ³•æ˜¯ï¼šä½œä¸º`check`çš„åˆ«åï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å†™æˆ`examples`ã€‚è¿™ä¸¤ä¸ªåœ¨åŠŸèƒ½ä¸Šæ˜¯ç›¸åŒçš„ï¼Œä½†å®ƒä»¬æ•æ‰äº†ä¾‹å­ï¼ˆæŽ¢ç´¢é—®é¢˜ï¼Œåœ¨å°è¯•è§£å†³æ–¹æ¡ˆä¹‹å‰ç¼–å†™ï¼‰å’Œæµ‹è¯•ï¼ˆè¯•å›¾åœ¨è§£å†³æ–¹æ¡ˆä¸­æ‰¾åˆ°é”™è¯¯ï¼Œå¹¶ç¼–å†™æ¥æŽ¢æµ‹å…¶è®¾è®¡ï¼‰ä¹‹é—´çš„äººç±»å·®å¼‚ã€‚

ç¬¬ä¸‰ç§æ–¹æ³•æ˜¯ç¼–å†™ä¸€ä¸ª`where`å—æ¥ä¼´éšå‡½æ•°å®šä¹‰ã€‚ä¾‹å¦‚ï¼š

```py
fun double(n):
  n + n
where:
  double(0) is 0
  double(10) is 20
  double(-1) is -2
end
```

è¿™äº›ç”šè‡³å¯ä»¥æ˜¯ä¸ºå†…éƒ¨å‡½æ•°ï¼ˆå³åŒ…å«åœ¨å…¶ä»–å‡½æ•°ä¸­çš„å‡½æ•°ï¼‰ç¼–å†™çš„ï¼Œè¿™å¯¹äºŽ check-expect æ¥è¯´å¹¶ä¸æˆç«‹ã€‚

åœ¨ Pyret ä¸­ï¼Œä¸Ž Racket ä¸åŒï¼Œæµ‹è¯•å—å¯ä»¥åŒ…å«æ–‡æ¡£å­—ç¬¦ä¸²ã€‚å½“ Pyret æŠ¥å‘Šæµ‹è¯•æˆåŠŸå’Œå¤±è´¥æ—¶ï¼Œä¼šä½¿ç”¨è¿™ä¸ªå­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼Œå°è¯•è¿è¡Œå¹¶æŸ¥çœ‹ä½ å¾—åˆ°çš„ç»“æžœï¼š

```py
check "squaring always produces non-negatives":
  (0 * 0) is 0
  (-2 * -2) is 4
  (3 * 3) is 9
end
```

è¿™å¯¹äºŽè®°å½•æµ‹è¯•å—çš„ç›®çš„å¾ˆæœ‰ç”¨ã€‚

å°±åƒåœ¨ Racket ä¸­ä¸€æ ·ï¼ŒPyret ä¸­æœ‰è®¸å¤šæµ‹è¯•è¿ç®—ç¬¦ï¼ˆé™¤äº†`is`ä¹‹å¤–ï¼‰ã€‚å‚è§[æ–‡æ¡£](https://www.pyret.org/docs/latest/testing.html)ã€‚

### 28.5 å˜é‡åðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

ä¸¤ç§è¯­è¨€éƒ½æœ‰ç›¸å½“å®½å®¹çš„å˜é‡å‘½åç³»ç»Ÿã€‚è™½ç„¶ä½ å¯ä»¥åœ¨ä¸¤è€…ä¸­ä½¿ç”¨é©¼å³°å¼å’Œä¸‹åˆ’çº¿ï¼Œä½†ä¼ ç»Ÿä¸Šä½¿ç”¨çš„æ˜¯æ‰€è°“çš„[kebab-case](http://c2.com/cgi/wiki?KebabCase)ã€‚è¿™ä¸ªåç§°ä¸å‡†ç¡®ã€‚å•è¯â€œkebabâ€åªæ˜¯æ„å‘³ç€â€œè‚‰â€ã€‚ä¸²çƒ¤æž¶æ˜¯â€œshishâ€ã€‚å› æ­¤ï¼Œè‡³å°‘åº”è¯¥è¢«ç§°ä¸ºâ€œshish kebab caseâ€ã€‚å› æ­¤ï¼š

| RSW | Pyret |
| --- | --- |
| this-is-a-name | `this-is-a-name` |

å°½ç®¡ Pyret æœ‰ä¸­ç¼€å‡æ³•ï¼Œä½†è¯­è¨€å¯ä»¥æ˜Žç¡®åœ°åŒºåˆ†`this-name`ï¼ˆä¸€ä¸ªå˜é‡ï¼‰å’Œ`this - name`ï¼ˆä¸€ä¸ªå‡æ³•è¡¨è¾¾å¼ï¼‰ï¼Œå› ä¸ºåŽè€…çš„`-`å¿…é¡»è¢«ç©ºæ ¼åŒ…å›´ã€‚

å°½ç®¡æœ‰è¿™ç§é—´è·çº¦å®šï¼ŒPyret ä¸å…è®¸ Scheme å…è®¸çš„ä¸€äº›æ›´å¥‡ç‰¹çš„åå­—ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥è¿™æ ·å†™

> | (defineÂ e^i*piÂ -1) |
> | --- |

åœ¨ Scheme ä¸­æ˜¯æœ‰æ•ˆçš„ï¼Œä½†åœ¨ Pyret ä¸­ä¸æ˜¯æœ‰æ•ˆçš„å˜é‡åã€‚

### 28.6 æ•°æ®å®šä¹‰ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

Pyret åœ¨å¤„ç†æ•°æ®å®šä¹‰æ–¹é¢ä¸Ž Racketï¼ˆç”šè‡³æ›´ä¸ç”¨è¯´ Schemeï¼‰æœ‰æ‰€ä¸åŒã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•å®šä¹‰ä¸€ä¸ªç»“æž„ï¼š

| RSW | Pyret |
| --- | --- |
| (define-structÂ ptÂ (xÂ y)) |

```py
data Point:
  &#124; pt(x, y)
end
```

|

è¿™å¯èƒ½çœ‹èµ·æ¥æœ‰äº›è¿‡åº¦ï¼Œä½†æˆ‘ä»¬å°†å¾ˆå¿«çœ‹åˆ°ä¸ºä»€ä¹ˆå®ƒæ˜¯æœ‰ç”¨çš„ã€‚åŒæ—¶ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“æ•°æ®å®šä¹‰ä¸­åªæœ‰ä¸€ä¸ªæ•°æ®ç±»åž‹æ—¶ï¼Œå ç”¨è¿™ä¹ˆå¤šè¡Œä¼šæ„Ÿè§‰éš¾ä»¥ç®¡ç†ã€‚åœ¨ä¸€è¡Œä¸­å†™å®ƒæ˜¯æœ‰æ•ˆçš„ï¼Œä½†çŽ°åœ¨ä¸­é—´çš„`|`çœ‹èµ·æ¥å¾ˆä¸‘é™‹ï¼š

```py
data Point: | pt(x, y) end
```

å› æ­¤ï¼ŒPyret å…è®¸ä½ çœç•¥å¼€å¤´çš„`|`ï¼Œä»Žè€Œä½¿å…¶æ›´æ˜“äºŽé˜…è¯»

```py
data Point: pt(x, y) end
```

çŽ°åœ¨å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ç§ç±»åž‹çš„ç‚¹ã€‚åœ¨ Racket çš„å­¦ç”Ÿè¯­è¨€ä¸­ï¼Œæˆ‘ä»¬ä¼šç”¨æ³¨é‡Šæ¥æè¿°è¿™ä¸€ç‚¹ï¼š

> | ;;Â AÂ PointÂ isÂ either |
> | --- |
> | ;;Â -Â (ptÂ numberÂ number),Â or |
> | ;;Â -Â (pt3dÂ numberÂ numberÂ number) |

åœ¨ Pyret ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥è¡¨è¾¾è¿™ä¸€ç‚¹ï¼š

```py
data Point:
  | pt(x, y)
  | pt3d(x, y, z)
end
```

ç®€è€Œè¨€ä¹‹ï¼ŒRacket ä¼˜åŒ–äº†å•å˜ä½“æƒ…å†µï¼Œè€Œ Pyret ä¼˜åŒ–äº†å¤šå˜ä½“æƒ…å†µã€‚å› æ­¤ï¼Œåœ¨ Racket ä¸­æ¸…æ¥šåœ°è¡¨è¾¾å¤šå˜ä½“æƒ…å†µæ¯”è¾ƒå›°éš¾ï¼Œè€Œåœ¨ Pyret ä¸­è¡¨è¾¾å•å˜ä½“æƒ…å†µåˆ™æ˜¾å¾—ç¬¨æ‹™ã€‚

å¯¹äºŽç»“æž„ä½“ï¼ŒRacket å’Œ Pyret éƒ½æš´éœ²äº†æž„é€ å‡½æ•°ã€é€‰æ‹©å™¨å’Œæ–­è¨€ã€‚æž„é€ å‡½æ•°åªæ˜¯å‡½æ•°ï¼š

| RSW | Pyret |
| --- | --- |
| |Â Â Â (ptÂ 1Â 2) |Â Â Â `pt(1, 2)` |

æ–­è¨€ä¹Ÿæ˜¯éµå¾ªç‰¹å®šå‘½åçº¦å®šçš„å‡½æ•°ï¼š

| RSW | Pyret |
| --- | --- |
| |Â Â Â (pt?Â x) | is-pt(x) |

å®ƒä»¬çš„è¡Œä¸ºæ–¹å¼ç›¸åŒï¼ˆå¦‚æžœå‚æ•°æ˜¯ç”±è¯¥æž„é€ å‡½æ•°æž„é€ çš„ï¼Œåˆ™è¿”å›ž trueï¼Œå¦åˆ™è¿”å›ž falseï¼‰ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œé€‰æ‹©åœ¨ä¸¤ç§è¯­è¨€ä¸­æ˜¯ä¸åŒçš„ï¼ˆæˆ‘ä»¬å°†åœ¨ä¸‹é¢å…³äºŽ`cases`çš„è®¨è®ºä¸­çœ‹åˆ°æ›´å¤šå…³äºŽé€‰æ‹©çš„å†…å®¹ï¼‰ï¼š

| RSW | Pyret |
| --- | --- |
| |Â Â Â (pt-xÂ v) | `v.x` |

æ³¨æ„ï¼Œåœ¨ Racket çš„æƒ…å†µä¸‹ï¼Œpt-x åœ¨æå– x å­—æ®µçš„å€¼ä¹‹å‰ä¼šæ£€æŸ¥å‚æ•°æ˜¯å¦æ˜¯ç”± pt æž„é€ çš„ã€‚å› æ­¤ï¼Œpt-x å’Œ pt3d-x æ˜¯ä¸¤ä¸ªä¸åŒçš„å‡½æ•°ï¼Œä¸èƒ½äº’ç›¸æ›¿ä»£ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåœ¨ Pyret ä¸­ï¼Œ`.x`ä¼šä»Žä»»ä½•å…·æœ‰è¯¥å­—æ®µçš„å€¼ä¸­æå–`x`å­—æ®µï¼Œè€Œä¸è€ƒè™‘å®ƒæ˜¯å¦‚ä½•æž„é€ çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç”±`pt`æˆ–`pt3d`ï¼ˆæˆ–ä»»ä½•å…¶ä»–å…·æœ‰è¯¥å­—æ®µçš„å¯¹è±¡ï¼‰æž„é€ çš„å€¼ä¸Šä½¿ç”¨`.x`ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œ`cases`åˆ™æ³¨æ„è¿™ç§åŒºåˆ«ã€‚

### 28.7 æ¡ä»¶è¯­å¥ðŸ”— "é“¾æŽ¥åˆ°æ­¤å¤„")

Pyret ä¸­æœ‰å‡ ç§æ¡ä»¶è¯­å¥ï¼Œæ¯” Racket çš„å­¦ç”Ÿè¯­è¨€å¤šä¸€ç§ã€‚

é€šç”¨æ¡ä»¶è¯­å¥å¯ä»¥ä½¿ç”¨ `if` æ¥ç¼–å†™ï¼Œå¯¹åº”äºŽ Racket çš„ `if`ï¼Œä½†è¯­æ³•æ›´ä¸°å¯Œã€‚

| RSW | Pyret |
| --- | --- |

|

> |Â Â Â (ifÂ æ»¡æœˆ |
> 
> |Â Â Â "howl" |
> 
> |Â Â Â "meow") |Â Â Â "å–µå–µ" |

|

```py
if full-moon:
  "howl"
else:
  "meow"
end
```

|

| RSW | Pyret |
| --- | --- |

|

> |Â Â Â (ifÂ æ»¡æœˆ |
> 
> |Â Â Â "howl" |
> 
> |Â Â Â (ifÂ new-moon |
> 
> |Â Â Â "å å«" |
> 
> |Â Â Â "meow")) |Â Â Â "å–µå–µ" |

|

```py
if full-moon:
  "howl"
else if new-moon:
  "bark"
else:
  "meow"
end
```

|

æ³¨æ„ï¼Œ`if` åŒ…å« `else if`ï¼Œè¿™ä½¿å¾—å¯ä»¥åœ¨åŒä¸€ç¼©è¿›çº§åˆ«ä¸Šåˆ—å‡ºä¸€ç³»åˆ—é—®é¢˜ï¼Œè¿™åœ¨ Racket ä¸­æ˜¯ä¸å…·å¤‡çš„ã€‚åœ¨ Racket ä¸­å¯¹åº”çš„ä»£ç å°†å†™æˆ

> | (cond |
> | --- |
> | |Â Â Â [æ»¡æœˆÂ "å—¥å«"] |
> | |Â Â Â [æ–°æœˆÂ "å å«"] |
> | |Â Â Â [elseÂ "meow"]) |

ä¸ºäº†æ¢å¤ç¼©è¿›ã€‚Pyret ä¸­æœ‰ä¸€ä¸ªç±»ä¼¼çš„æž„é€ ï¼Œç§°ä¸º`ask`ï¼Œæ—¨åœ¨ä¸Ž`cond`å¹³è¡Œï¼š

```py
ask:
  | full-moon then: "howl"
  | new-moon then:  "bark"
  | otherwise:      "meow"
end
```

åœ¨ Racket ä¸­ï¼Œæˆ‘ä»¬åŒæ ·ä½¿ç”¨ `cond` æ¥æ ¹æ®æ•°æ®ç±»åž‹è¿›è¡Œåˆ†å‘ï¼š

> | (cond |
> | --- |
> | |Â Â Â [(pt?Â v)Â Â Â (+Â (pt-xÂ v)Â (pt-yÂ v))] |
> | |Â Â Â [(pt3d?Â v)Â (+Â (pt-xÂ v)Â (pt-zÂ v))] |

æˆ‘ä»¬å¯ä»¥åœ¨ Pyret ä¸­éžå¸¸ç›¸ä¼¼åœ°å†™å‡ºï¼š

```py
ask:
  | is-pt(v)   then: v.x + v.y
  | is-pt3d(v) then: v.x + v.z
end
```

æˆ–è€…ç”šè‡³å¯ä»¥å†™æˆï¼š

```py
if is-pt(v):
  v.x + v.y
else if is-pt3d(v):
  v.x + v.z
end
```

ï¼ˆä¸Ž Racket çš„å­¦ç”Ÿè¯­è¨€ä¸€æ ·ï¼Œå¦‚æžœæ¡ä»¶è¯­å¥çš„ä»»ä½•åˆ†æ”¯éƒ½æ²¡æœ‰åŒ¹é…ï¼ŒPyret ç‰ˆæœ¬å°†å‘å‡ºé”™è¯¯ä¿¡å·ã€‚ï¼‰

ç„¶è€Œï¼ŒPyret æä¾›äº†ä¸€ç§ç‰¹æ®Šçš„è¯­æ³•ï¼Œä¸“é—¨ç”¨äºŽæ•°æ®å®šä¹‰ï¼š

```py
cases (Point) v:
  | pt(x, y)      => x + y
  | pt3d(x, y, z) => x + z
end
```

è¿™æ£€æŸ¥ `v` æ˜¯å¦ä¸º `Point`ï¼Œæä¾›äº†ä¸€ç§å¹²å‡€çš„è¯­æ³•æ–¹å¼æ¥è¯†åˆ«ä¸åŒçš„åˆ†æ”¯ï¼Œå¹¶ä½¿å¾—ä¸ºæ¯ä¸ªå­—æ®µä½ç½®æä¾›ä¸€ä¸ªç®€æ´çš„å±€éƒ¨åç§°æˆä¸ºå¯èƒ½ï¼Œè€Œä¸æ˜¯å¿…é¡»ä½¿ç”¨é€‰æ‹©å™¨å¦‚ `.x`ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨ Pyret ä¸­ï¼Œæˆ‘ä»¬æ›´å–œæ¬¢ä½¿ç”¨ `cases` æ¥å¤„ç†æ•°æ®å®šä¹‰ã€‚ç„¶è€Œï¼Œæœ‰æ—¶ï¼Œä¾‹å¦‚ï¼Œæ•°æ®æœ‰å¤šç§å˜ä½“ï¼Œä½†å‡½æ•°åªå¤„ç†å…¶ä¸­çš„ä¸€å°éƒ¨åˆ†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¾å¼ä½¿ç”¨è°“è¯å’Œé€‰æ‹©å™¨æ›´æœ‰æ„ä¹‰ã€‚

### 28.8 åˆ—è¡¨ðŸ”— "é“¾æŽ¥è‡³æ­¤")

åœ¨ Racket ä¸­ï¼Œæ ¹æ®è¯­è¨€çº§åˆ«ï¼Œåˆ—è¡¨çš„åˆ›å»ºä½¿ç”¨ cons æˆ– listï¼Œç©ºåˆ—è¡¨ä½¿ç”¨ emptyã€‚Pyret ä¸­çš„å¯¹åº”æ¦‚å¿µåˆ†åˆ«ç§°ä¸º `link`ã€`list` å’Œ `empty`ã€‚`link` æ˜¯ä¸€ä¸ªæŽ¥å—ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œå°±åƒåœ¨ Racket ä¸­ä¸€æ ·ï¼š

| RSW | Pyret |
| --- | --- |
| (cons 1 empty) | `link(1, empty)` |
| RSW | Pyret |
| (list 1 2 3) | `[list: 1, 2, 3]` |

æ³¨æ„ï¼Œåœ¨è®¸å¤šè¯­è¨€ä¸­è¡¨ç¤ºåˆ—è¡¨çš„è¯­æ³• `[1, 2, 3]` åœ¨ Pyret ä¸­æ˜¯éžæ³•çš„ï¼šåˆ—è¡¨æ²¡æœ‰è‡ªå·±çš„ç‰¹æƒè¯­æ³•ã€‚ç›¸åï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨æ˜¾å¼çš„æž„é€ å™¨ï¼šæ­£å¦‚ `[list: 1, 2, 3]` æž„å»ºä¸€ä¸ªåˆ—è¡¨ä¸€æ ·ï¼Œ`[set: 1, 2, 3]` æž„å»ºä¸€ä¸ªé›†åˆè€Œä¸æ˜¯åˆ—è¡¨ã€‚å®žé™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥[åˆ›å»ºè‡ªå·±çš„æž„é€ å™¨](https://www.pyret.org/docs/latest/Expressions.html#%28part._s~3aconstruct-expr%29)å¹¶ä½¿ç”¨è¿™ç§è¯­æ³•ã€‚

> ç»ƒä¹ 
> 
> > å°è¯•è¾“å…¥ `[1, 2, 3]` å¹¶æŸ¥çœ‹é”™è¯¯ä¿¡æ¯ã€‚

è¿™å±•ç¤ºäº†æˆ‘ä»¬å¦‚ä½•æž„å»ºåˆ—è¡¨ã€‚è¦åˆ†è§£å®ƒä»¬ï¼Œæˆ‘ä»¬ä½¿ç”¨ `cases`ã€‚æœ‰ä¸¤ç§å˜ä½“ï¼Œ`empty` å’Œ `link`ï¼ˆæˆ‘ä»¬ç”¨æ¥æž„å»ºåˆ—è¡¨ï¼‰ï¼š

| RSW | Pyret |
| --- | --- |

|

> &#124; (cond &#124;
> 
> &#124; [(empty? l) 0] &#124;
> 
> &#124; [(cons? l) &#124;
> 
> &#124; (+ (first l) &#124;
> 
> &#124; (g (rest l)))]) &#124;

|

```py
cases (List) l:
  &#124; empty      => 0
  &#124; link(f, r) => f + g(r)
end
```

|

é€šå¸¸å°†å­—æ®µç§°ä¸º `f` å’Œ `r`ï¼ˆåˆ†åˆ«ä»£è¡¨â€œç¬¬ä¸€ä¸ªâ€å’Œâ€œå…¶ä½™â€ï¼‰ã€‚å½“ç„¶ï¼Œå¦‚æžœå­˜åœ¨å…¶ä»–åŒåçš„äº‹ç‰©ï¼Œè¿™ç§çº¦å®šå°±ä¸é€‚ç”¨ï¼›ç‰¹åˆ«æ˜¯åœ¨ç¼–å†™åˆ—è¡¨çš„åµŒå¥—è§£æž„æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸å†™ä½œ `fr` å’Œ `rr`ï¼ˆåˆ†åˆ«ä»£è¡¨â€œå…¶ä½™çš„ç¬¬ä¸€ä¸ªâ€å’Œâ€œå…¶ä½™çš„å…¶ä½™â€ï¼‰ã€‚

### 28.9 é¦–ç±»å‡½æ•°ðŸ”— "é“¾æŽ¥è‡³æ­¤")

Racket çš„ lambda çš„ç­‰ä»·ç‰©æ˜¯ Pyret çš„ `lam`ï¼š

| RSW | Pyret |
| --- | --- |
| (lambda (x y) (+ x y)) | `lam(x, y): x + y end` |

### 28.10 æ³¨é‡ŠðŸ”— "é“¾æŽ¥è‡³æ­¤")

åœ¨å­¦ç”Ÿ Racket è¯­è¨€ä¸­ï¼Œæ³¨é‡Šé€šå¸¸ä»¥æ³¨é‡Šçš„å½¢å¼ç¼–å†™ï¼š

> | ; square: Number -> Number |
> | --- |
> | ; sort-nums: List<Number> -> List<Number> |
> | ; sort: List<T> * (T * T -> Boolean) -> List<T> |

åœ¨ Pyret ä¸­ï¼Œæˆ‘ä»¬ç›´æŽ¥åœ¨å‚æ•°å’Œè¿”å›žå€¼ä¸Šå†™æ³¨é‡Šã€‚Pyret å°†åœ¨æœ‰é™èŒƒå›´å†…åŠ¨æ€æ£€æŸ¥å®ƒä»¬ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨å…¶ç±»åž‹æ£€æŸ¥å™¨é™æ€æ£€æŸ¥å®ƒä»¬ã€‚ä¸Šè¿°å¯¹åº”çš„æ³¨é‡Šå°†å†™ä½œ

```py
fun square(n :: Number) -> Number: ...

fun sort-nums(l :: List<Number>) -> List<Number>: ...

fun sort<T>(l :: List<T>, cmp :: (T, T -> Boolean)) -> List<T>: ...
```

### 28.11 å…¶ä»–å†…å®¹ï¼ŸðŸ”— "é“¾æŽ¥è‡³æ­¤")

å¦‚æžœæ‚¨å¸Œæœ›çœ‹åˆ° Scheme æˆ– Racket è¯­æ³•ä¸­å…¶ä»–éƒ¨åˆ†çš„ç¿»è¯‘ï¼Œè¯·[å‘ŠçŸ¥æˆ‘ä»¬](http://cs.brown.edu/~sk/Contact/)ã€‚
