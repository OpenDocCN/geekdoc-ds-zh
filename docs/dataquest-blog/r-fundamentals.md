# r 基础:建立一个简单的分数计算器

> 原文：<https://www.dataquest.io/blog/r-fundamentals/>

March 15, 2018R is one of the [most popular languages](https://stackoverflow.blog/2017/10/10/impressive-growth-r/) for statistical analysis, data science, and reporting. At Dataquest, we have been adding R courses (you can learn more in our recent [update](https://www.dataquest.io/blog/whats-new-in-dataquest/)). For a comparison of R and Python, check out [our analysis here](https://www.dataquest.io/blog/python-vs-r/). In this tutorial, we’ll teach you the basics of R by building a simple grade calculator. While we do not assume any R-specific knowledge, you should be familiar with general programming concepts. You’ll learn how to:

*   进行计算
*   储存你的价值观
*   使用特定功能回答问题

本教程基于我们新发布的 R 入门课程的一部分。该课程完全免费，包括结业证书。点击[这里](https://www.dataquest.io/course/introduction-to-data-analysis-in-r/)开始课程。

## 计算你的分数

假设你是一名高三学生，想要计算你的平均绩点(GPA)。GPA 代表你所有课程累积的最终分数的平均值。你选了七门课，考试、作业和项目的权重相等。我们假设 GPA 是在 0-100 的范围内测量的。在你的数学课上，你考试得了`92`，家庭作业得了`87`，项目得了`85`。为了计算平均数学分数，我们可以写如下:

```py
 # Math
(92 + 87 + 85)/3
```

我们*可以*执行任务，比如用手计算平均值。然而，如果我们必须计算 1000 名学生的平均值，手动计算将不会有效地利用我们的时间。相反，我们将使用编程来要求计算机执行计算。

## 执行计算

我们将从使用 R 作为基本计算器开始。我们之前写了以下内容来计算数学课的最终成绩:

```py
(92 + 87 + 85)/3
```

这整行代码被称为一个**表达式**。我们在一个叫做**脚本**的文本文件中编写表达式。脚本是我们给计算机的一组指令。在脚本中编写完表达式后，**解释器**将运行代码，并在新窗口中显示表达式的结果。让我们运行`print()`语句，将我们的数学分数作为`()`之间的表达式:

```py
print((92 + 87 + 85)/3)
```

运行表达式时，解释器将在新窗口中输出以下值:

```py
[1] 88
```

注意:当你更深入地研究*向量*时，`[1]`将是有意义的，但是你不需要在本教程的上下文中理解它。在我们显示的结果中，计算和`print()`语句都有一对匹配的括号。为了更清楚，下面是同样的计算:

```py
print((92 + 87 + 85)/3)
```

运行这个表达式将产生与在一行上写所有内容相同的结果。每个开始括号都需要一个结束括号。让我们试着去掉右括号:

```py
print((92 + 87 + 85)/3
```

如果你的代码中有错误，解释器会告诉你有错误，以及错误是什么。在我们的例子中，解释器返回:`Error in parse(text = x, srcfile = src): <text>:7:0: unexpected end of input`。

文本`unexpected end of input`意味着 R 解释器(我们的代码)的输入缺少一个右括号`)`。您可以尝试使用上面的表达式，看看您还会得到哪些其他类型的错误。

## 执行多重计算

现在我们已经看到了使用`print()`语句的结果，让我们更深入地了解 R 解释器如何运行我们的代码。它:

1.  扫描并查找语法错误。
2.  解释并运行每一行代码，从上到下。
3.  当最后一行代码运行时退出。

我们写了一个计算数学课最终分数的表达式。为了理解 R 代码被解释的顺序方式，让我们也添加一个计算你的化学分数的表达式。化学方面，你的分数是`90`、`81`和`92`。如果我们在不同的行上运行两个计算会发生什么？

```py
print((92 + 87 + 85)/3)
print((90 + 81 + 92)/3)
```

运行这段代码，R 解释器将显示:

```py
[1] 88
[1] 87.66667
```

如果我们写两行代码，R 总是显示两行吗？如果我们把代码分成多行呢？

```py
 print((92 + 87 + 85)/3)
print((90 + 81 + 92)/4) 
```

R 解释器将仍然显示相同的值:

```py
[1] 88
[1] 87.66667
```

注意 R 是如何解释我们的代码的。每个 print 语句对应于结果中它自己的行:

![print_lines_v5](img/2b20616291b70c49647b94835d439a30.png)

如果我们想计算写作和艺术的平均分，我们可以在随后的每一行写下这些表达式:

*   写作:`84`、`95`、`79`
*   艺术:`95`、`86`、`93`

```py
 print((92 + 87 + 85)/3) # Math
print((90 + 81 + 92)/3) # Chemistry
print((84 + 95 + 79)/3) # Writing
print((95 + 86 + 93)/3) # Art
```

运行这些表达式将显示以下结果:

```py
[1] 88
[1] 87.66667
[1] 86
[1] 91.33333
```

## 使用算术运算符执行计算

`+`和`/`称为**算术运算符**。算术运算符用于执行数学运算。在下图中，您会发现一个最常见运算符的列表和一个使用每个运算符的简单表达式:![operators_v2](img/91216e8bf545a154d353f53ea80d41d9.png)

对于那些不熟悉**取幂**的人来说，取幂是一种用`**`或`^`运算符将一个数乘以自身特定次数的方法。如果我们想将值 4 乘以自身 3 次，使用乘法`*`运算符，结果如下所示:

```py
4 * 4 * 4
```

虽然使用乘法运算符将 4 乘以自身三次并不太麻烦，但如果我们想将值 4 乘以自身 20 次，使用乘法运算符并不是最有效的方法。相反，我们可以将计算结果表示为指数:

```py
4**20
```

运行`4**20`将返回:

```py
[1] 1.099512e+12
```

现在我们已经了解了算术运算符，让我们来计算最后三门课的最终分数:历史、音乐和体育:

*   历史:77、85、90 年
*   音乐:92，90，91
*   体育:85，88，95

```py
 print((77 + 85 + 90)/3) # History
print((92 + 90 + 91)/3) # Music
print((85 + 88 + 95)/3) # Physical Education
```

然后解释器会显示:

```py
 [1] 84
[1] 91
[1] 89.33333
```

## 按照操作顺序执行计算

既然我们已经学会了如何使用算术运算符来计算每门课的平均分数，让我们回到数学的平均计算上来:

```py
 print((92 + 87 + 85)/3)
```

如果我们删除`92 + 87 + 85`周围的括号会怎么样？

```py
 print(92 + 87 + 85/3)
```

这将显示:

```py
207.333
```

通过删除包围`92 + 87 + 85`的括号，R 解释器进行不同的计算。使用多个运算符时，有一些规则决定计算的执行顺序。确定计算顺序的一个简单方法是，在想要首先执行的计算周围加上一个括号*和*。这对于像这样更复杂的计算很有用:

```py
 print((92 + 87 + 85 + 67 + 92 + 84)/6 - (77 + 90 + 98)/3)
```

在这种情况下，我们在`92 + 87 + 85 + 67 + 92 + 84`和`77 + 90 + 98`两边加上了括号。我们告诉解释器在执行除法之前先执行加法运算符。R 解释器遵循数学中运算规则的顺序。记住这个的一个简单方法是 [PEMDAS](https://en.wikipedia.org/wiki/Order_of_operations) :

*   父母
*   Ex onent
*   M 乘法或 **D** 除法
*   **A** 增加或 **S** 减少

让我们看一个没有括号的例子。对于`92 + 87 + 85/3`，R 解释器将按以下顺序计算表达式:

![pemdas1](img/87be465c0a39792970ce0db2ccff9d4f.png)

当你没有在`92 + 87 + 85`周围加上圆括号时，基于 PEMDAS，R 解释器将首先计算*除法*运算符。现在，让我们在表达式上重新加上括号。对于`(92 + 87 + 85)/3`。R 解释器将按照不同的顺序计算表达式:![pemdas2](img/856dd0b4a91defe743df42103b7c20cb.png)

以下是每个班级的最终分数:

*   数学:88 分
*   化学:87.66667
*   写作:86
*   艺术作品:91.33333
*   历史:84 年
*   音乐:91
*   体育:89.33333

让我们在考虑 PEMDAS 的情况下计算总体平均值。计算出总平均成绩后，在同一个表达式中，从数学成绩中减去总平均成绩:

```py
print(    88 - ((88 + 87.66667 + 86 + 91.33333 + 84 + 91 + 89.33333)/7) )
```

```py
[1] -0.1904757
```

## 创建注释

在前面的练习中，我们使用运算符进行了多次计算。稍后，当我们编写数百行代码时，*组织*我们的代码是一个很好的编程实践。我们可以通过插入**注释**来组织我们的代码。注释是帮助人们——包括你自己——理解代码的注释。R 解释器识别注释，将它们视为纯文本，不会试图执行它们。我们可以向代码中添加两种主要类型的注释:

*   内嵌注释
*   单行注释

内联注释每当我们想要对一个特定的语句进行注释或添加更多细节时，内联注释就非常有用。要在语句末尾添加行内注释，请以散列字符(`#`)开始，然后添加注释:

```py
print(   (92 + 87 + 85)/3 # Finding the math score)
```

虽然我们不需要在散列字符(`#`)后添加一个空格，但这被认为是一种好的风格，可以使我们的注释更加清晰易读。**单行注释**单行注释跨越整行，当我们想把代码分成几个部分时，这很有用。要指定我们希望将一行文本视为注释，请以散列字符(`#`)开始该行:

```py
# Here, we're finding the average of our scores. Then, subtracting this average from the math score. 
print(88 - ((88 + 87.66667 + 86 + 91.33333 + 84 + 91 + 89.33333)/7) )
```

让我们给代码添加注释吧！

```py
# Adding some comments.
    88 - ((88 + 87.66667 + 86 + 91.33333 + 84 + 91 + 89.33333)/7) ) # Adding more comments. 
```

## 给变量赋值

用 R 进行简单的计算是有用的。然而，更可靠的方法是存储这些值以备后用。这个存储值的过程叫做**变量赋值**。R 中的一个**变量**就像一个命名的存储单元，可以保存值。分配变量的过程需要两个步骤:

1.  给变量命名。
2.  使用`<-`为名称赋值。

命名变量时，有几条规则必须遵守:

*   变量名由字母、数字、点或下划线组成。
*   我们可以用一个字母或一个点开始一个变量。如果它是一个点，那么我们就不能在它后面跟着一个数字。
*   我们*不能*以数字开始变量。
*   不允许使用特殊字符。

关于更多细节，下面的表格详细说明了哪些变量名是允许的，哪些是不允许的:

![variable_name_v2](img/455497ec6413b01e11dbe9d4a7385367.png)让我们回到我们的数学成绩计算:`(92 + 87 + 85)/3`，这次计算的结果是`88`。为了将`88`存储在一个名为`math`的变量中，让我们编写以下表达式:

```py
math <- 88
```

然后如果我们试着做数学运算，像这样:

```py
print(math)
```

这将显示:`[1] 88`

变量，不仅可以保存我们计算的结果，我们还可以给一个表达式赋值:

```py
math <- (92 + 87 + 85)/3
```

如果我们试着打印数学，像这样:

```py
print(math)
```

这将显示与我们最初计算相同的结果`[1] 88`

我们把数学成绩储存在一个变量里。提醒一下，这里是班级:

*   化学:87.66667
*   写作:86
*   艺术作品:91.33333
*   历史:84 年
*   音乐:91
*   体育:89.33333

让我们将其他分数存储在变量中。

```py
 math <- 88
chemistry <- 87.66667
writing <-  86
art <- 91.33333
history <- 84
music <- 91
physical_education <- 89.33333 
```

## 使用变量执行计算

既然我们已经将每个班级的分数存储在一个变量中，我们可以使用这些变量来计算平均绩点。让我们看看我们的数学和化学成绩:

```py
math <- 88
chemistry <- 87.66667
```

执行计算时，变量和值被视为*与*相同。使用我们的`math`和`chemistry`变量，`88 + 87.66667`与`math + chemistry`相同。使用变量进行计算时，PEMDAS 法则仍然适用。如果我们想知道你的数学比化学好多少，我们可以使用减法`-`算术运算符来找出差异:

```py
math <- 88chemistry <- 87.66667
print(math - chemistry)
```

这将显示:

```py
[1] 0.33333
```

如果我们想找到数学和化学之间的平均分数，我们可以对这两个变量使用`+`、`/`、`()`运算符:

```py
(math + chemistry)/2
```

这将显示:

```py
[1] 87.83334
```

完成这些计算后，我们还可以将这些表达式的结果存储在一个变量中。如果我们想将数学和化学的平均值存储在一个名为`average`的变量中，它应该是这样的:

```py
 average <- (math + chemistry)/2
```

显示平均值将返回相同的值`87.83334`。

让我们使用以下变量来计算您的平均绩点:

*   `math <- 88`
*   `chemistry <- 87.66667`
*   `writing <- 86`
*   `art <- 91.33333`
*   `history <- 84`
*   `music <- 91`
*   `physical_education <- 89.33333`

```py
 ## Classes
math <- 88 
chemistry <- 87.66667
writing <-  86
art <- 91.33333
history <- 84
music <- 91
physical_education <- 89.33333
## Calculation
gpa <- (math + chemistry + writing + art + history + music + physical_education)/7
```

然后，让我们从历史中减去你的`gpa`，看看历史是否低于平均值。将该差值存储在`history_difference`中。

```py
history_difference <- history - gpa
```

## 创建向量

从我们之前的例子来看，使用变量计算你的平均绩点是有用的。然而，在数据科学中，我们经常处理成千上万的数据点。如果你有每堂课的每项家庭作业、考试或项目的分数，我们的数据集会变得很大。回到我们的数学、化学示例，让我们看看当前变量:

![create_vector_vars](img/6d76883bb00f7adf1aa988247de07ba2.png)

我们需要一个可以存储多个值的存储单元，而不是将这两个值存储在两个变量中。在 R 中，我们可以使用一个**向量**来存储这些值。向量是一个存储容器，可以存储一系列值。然后我们可以用一个变量来命名一个矢量。像这样:

![create_vector_vec](img/a6c2021b81964d1d705d1ecbf75d200f.png)

要创建一个向量，您将使用`c()`。在 R 中，`c()`被称为**函数**。类似于`print()`语句，`c()`函数接受多个输入并将这些值存储在一个地方。`c()`函数*不对这些值执行任何算术运算，它只是存储这些值。你可以在这里阅读更多关于`c()`功能[的内容。以下是创建向量的步骤:](https://cran.r-project.org/doc/manuals/r-release/R-intro.html#The-concatenation-function-c_0028_0029-with-arrays)*

1.  确定您想要存储在向量中的值，并将这些值放在`c()`函数中。使用逗号(`,`)分隔这些值。
2.  使用`<-`给矢量指定一个你选择的名称。

让我们创建一个包含您的数学和化学分数的向量。数学成绩`88`，化学成绩`87.66667`。

```py
math_chemistry <- c(88,87.66667)
```

我们也可以使用变量名来创建向量:

```py
math_chemistry <- c(math,chemistry)
```

如果我们去`print(math_chemistry)`，它会是这样的:

```py
[1] 88.00000 87.66667
```

另一方面，如果我们试图存储一系列值，就像这样:

```py
math_chemistry <- 88, 87.66667
```

R 解释器只会尝试将 88 赋值给`math_chemistry`，但无法解释 88: `Error: unexpected ',' in "math_chemistry <- 88,"`之后的逗号

让我们使用以下变量将最终分数存储在一个向量中:

```py
 math <- 88 
chemistry <- 87.66667
writing <-  86
art <- 91.33333
history <- 84
music <- 91
physical_education <- 89.33333
```

```py
final_scores <- c(math, chemistry, writing, art, history, music, physical_education)
```

## 计算平均值

现在我们已经将你的分数存储在一个向量中，我们可以计算平均绩点。在之前的练习中，您使用了算术运算符来计算您的平均绩点:

```py
(88 + 87.66667 + 86 + 91.33333 + 84 + 91 + 89.33333)/7
```

虽然这个解决方案可行，但是它不可扩展。现在你已经创建了一个向量，我们有一个更简单的方法来计算平均绩点。要使用向量计算平均绩点，请使用`mean()`功能。`mean()`函数将接受一个输入(向量)并计算该输入的平均值。然后解释器将显示结果。让我们将`mean()`函数应用于我们的`math_chemistry`向量:

```py
math_chemistry <- c(88,87.66667)
mean(math_chemistry)
```

这将返回:

```py
[1] 87.83334
```

然后我们可以将`mean(math_chemistry)`的结果存储在一个变量中以备后用:

```py
average_score <- mean(math_chemistry)
```

让我们将`mean()`函数应用到你的最终分数向量上！

```py
## Vector of Final Scores
final_scores <- c(math, chemistry, writing, art, history, music, physical_education)
## Calculating the mean
gpa <- mean(final_scores)
```

## 对向量执行运算

之前，你使用`mean()`函数和一个向量计算你的最终成绩。在数据科学中，总有多个问题可以用数据来回答。让我们更深入地研究我们的`final_grades`向量，并问它几个问题:

*   最高分是多少？
*   最低分是多少？
*   你上了多少课？

要回答这些问题，您还需要几个函数:

*   `min()`:查找向量中的最小值
*   `max()`:查找向量中的最大值
*   `length()`:查找向量保存的值的总数
*   `sum():`:取 vector 中所有值的和(*注:本教程中不会用到。*

您可以应用这个函数，类似于应用

`mean()`功能。为了找到我们的`math_chemistry`向量中的最大分数，我们将对这个向量应用`max()`函数:

```py
math_chemistry <- c(88,87.66667)
max(math_chemistry)
```

这显示:`[1] 88`

再回答几个关于你成绩的问题吧！

*   你在哪个班得分最高？使用`max()`。
*   你在哪个班得分最低？使用`min()`。
*   你上了多少课？使用`length()`。

```py
 final_scores <- c(math, chemistry, writing, art, history, music, physical_education)
## Highest Score
highest_score <- max(final_scores)print(highest_score)
## Lowest Score
lowest_score <- min(final_scores)print(lowest_score)
## Number of Classes
num_classes <- length(final_scores)
print(num_classes)
```

```py
 [1] 91.33333
[1] 84
[1] 7
```

## 后续步骤

如果您想了解更多，本教程基于我们的 [R 基础知识](https://www.dataquest.io/course/introduction-to-data-analysis-in-r/)课程，该课程是我们 R track 数据分析师的一部分。基于本教程中的概念，您将学习:

*   操纵向量的更复杂的方法:
    *   索引到向量中
    *   过滤掉向量中的不同值
    *   向量的不同行为
*   使用矩阵推荐大学
    *   创建您自己的矩阵
    *   分割和重组矩阵
    *   对矩阵排序
*   使用数据框架分析大学毕业生数据
    *   进入数据帧的不同数据类型
    *   选择并子集化数据帧中的特定值
    *   将条件添加到数据框选择中
*   使用列表存储各种值
    *   编入列表的索引
    *   从列表中添加和减去值
    *   合并列表

[开始免费的 R 基础课程](https://www.dataquest.io/course/introduction-to-data-analysis-in-r/)