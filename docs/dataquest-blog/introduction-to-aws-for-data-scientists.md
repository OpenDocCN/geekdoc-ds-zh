# 面向数据科学家的 AWS 简介

> 原文：<https://www.dataquest.io/blog/introduction-to-aws-for-data-scientists/>

January 30, 2018

如今，许多企业使用基于云的服务；因此，各种各样的公司已经开始建立和提供这种服务。亚马逊[以亚马逊网络服务(AWS)开始了这一趋势](https://www.computerweekly.com/feature/A-history-of-cloud-computing)。虽然 AWS 在 2006 年开始作为一项副业，但它现在每年为[带来 145 亿美元的收入。](https://www.forbes.com/sites/bobevans1/2017/07/28/ibm-beats-amazon-in-12-month-cloud-revenue-15-1-billion-to-14-5-billion/#53c3e14c39d6)

该领域的其他领导者包括:

*   谷歌——谷歌云平台(GCP)
*   微软—Azure 云服务
*   IBM—IBM 云

云服务对各种规模的企业都很有用，与购买服务器相比，小公司受益于低成本。较大的公司以较低的成本获得了可靠性和生产力，因为服务运行在最佳的能量和维护上。

这些服务也是您可以用来减轻工作负担的强大工具。如果您是第一次使用 Spark，手动设置 Hadoop 集群可能需要几天时间，但 AWS 可以在几分钟内为您设置好。

这里我们将重点关注 AWS，因为它附带了更多与数据科学家相关的产品。总的来说，我们可以说熟悉 AWS 有助于数据科学家:

1.  轻松准备他们工作所需的基础架构(例如 Hadoop 集群)
2.  轻松设置必要的工具(如 Spark)
3.  大幅降低开支，例如仅在需要时才购买大型 Hadoop 集群
4.  减少维护时间，因为不需要手动备份数据等任务
5.  开发不需要工程师帮助(或者至少需要很少的帮助)就可以发布的产品和功能

在这篇文章中，我将概述对数据科学家有用的 AWS 服务——它们是什么，为什么有用，以及它们的价格。

## 弹性计算云(EC2)

许多其他 AWS 服务都是围绕 EC2 构建的，使其成为 AWS 的核心部分。ec2 实际上是(虚拟)服务器，你可以从 Amazon 上租用，并在上面安装或运行任何程序/应用程序。这些服务器采用不同的操作系统，亚马逊根据服务器的计算能力和容量(即硬盘容量、CPU、内存等)向您收费。)和服务器启动的持续时间。

### EC2 优势

例如，您可以租用一台计算能力和存储容量符合您特定需求的 Linux 或 Windows 服务器，亚马逊会根据这些规格和您使用服务器的时间向您收费。请注意，以前 AWS 对您运行的每个实例至少收费一个小时，但是他们最近将他们的政策改为每秒收费。

EC2 的优点之一是它的可伸缩性——通过改变内存、vCPUs 数量、带宽等，您可以轻松地扩展或缩小您的系统。因此，如果您认为系统没有足够的能力来运行特定任务，或者项目中的计算耗时太长，您可以扩大规模来完成您的工作，稍后再缩小规模来降低成本。EC2 也非常可靠，因为 Amazon 会负责维护。

### EC2 成本

EC2 实例的成本相对较低，不同的用例有不同类型的实例。例如，有些实例针对计算进行了优化，而那些实例的 CPU 使用成本相对较低。或者那些针对内存优化的应用程序的内存使用成本较低。

为了让您了解 EC2 的成本，一个具有 2 个 vCPUs 和 4gb 内存的通用中型实例(在撰写本文时)的 linux 服务器每小时成本为 0.0464 美元，有关价格和更多信息，请参见 [Amazon EC2 Pricing](https://aws.amazon.com/ec2/pricing/on-demand/) 。AWS 现在也有[现货实例定价](https://aws.amazon.com/ec2/spot/pricing/)，它根据当时的供应/需求计算价格，并根据您想要使用实例的时间，为短期使用提供高达 90%的折扣。例如，在现货定价方案中，上述相同的实例每小时的成本为 0.0173 美元。

请注意，您还必须将存储成本添加到上述成本中。大多数 EC2 实例使用弹性块存储(EBS)系统，其成本约为 0.1 美元/千兆/月；点击查看价格[。](https://aws.amazon.com/ebs/pricing/)[存储优化实例](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/storage-optimized-instances.html)使用更贵的固态硬盘(SSD)系统。

![Ec2cost](img/1ea30bb68bd1da452559fe8a58e79331.png)

EBS 就像一个外部硬盘驱动器。您可以将其附加到实例，取消附加，然后重新附加到另一个实例。您还可以在工作完成后停止或终止实例，并且在实例空闲时不为其付费。

如果您停止一个实例，AWS 仍将保持 EBS 活动，因此您在硬盘上的数据将保持不变(就像关闭您的计算机一样)。稍后，您可以重新启动停止的实例，并访问您生成的数据，甚至是您在之前的会话中安装的工具。然而，当您停止一个实例而不是终止它时，Amazon 仍然会向您收取附加的 EBS 费用(约 0.1 美元/GIG/月)。如果您终止实例，EBS 将被清理，因此您将丢失该实例上的所有数据，但您不再需要为 EBS 付费。

如果您需要将数据保存在 EBS 上以备将来使用(假设您在该实例上安装了定制工具，并且您不希望以后再次重做您的工作)，您可以制作 EBS 的快照，以后可以将其恢复到新的 EBS 中，并将其附加到新的实例。

快照存储在 S3(亚马逊的廉价存储系统；我们稍后会谈到它)，所以像这样在 EBS 中保存数据会花费您更少的成本(0.05 美元/GB 月)。但是，获取快照并恢复它需要时间(取决于 EBS 的大小)。此外，将恢复的 EBS 重新附加到 EC2 实例并不是那么简单，所以只有在您知道暂时不会使用该 EBS 的情况下，使用这样的快照才有意义。

请注意，要放大或缩小实例，您必须首先停止实例，然后更改实例规范。你不能减少 EBS 的大小，只能增加它，这更困难。你必须:

1.  停止实例
2.  为 EBS 制作快照
3.  使用新大小在 EBS 中恢复快照
4.  取消附加以前的 EBS
5.  附上新的。

## 简单存储服务(S3)

S3 是 AWS 对象(文件)存储服务。S3 就像 Dropbox 或 Google drive，但更具可扩展性，特别适合处理代码和应用程序。

S3 没有提供一个用户友好的界面，因为它是为在线应用程序而设计的，而不是为最终用户设计的。因此，通过 API 使用 S3 比通过其 web 控制台更容易，并且有许多库和 API(用各种语言)被开发来使用该服务。例如， [Boto3](https://boto3.readthedocs.io) 是一个用 Python 编写的 S3 库(事实上 Boto3 也适用于许多其他 AWS 服务)。

S3 基于`bucket` s 和`key` s 存储文件，桶类似于根文件夹，键类似于子文件夹和文件。因此，如果你在 s3 上存储一个名为`my_file.txt`的文件，比如`myproject/mytextfiles/my_file.txt`，那么“我的项目”就是你正在使用的桶，那么`mytextfiles/my_file.txt`就是那个文件的密钥。了解这一点很重要，因为当您想从 s3 中检索文件时，API 会分别要求 bucket 和 key。

### S3 福利

你可以在 S3 上存储的数据大小没有限制——你只需要根据你每月需要的大小来支付存储费用。

S3 也非常可靠，其设计具有 99.999999999%的耐用性。但是，该服务可能不会一直运行。2017 年 2 月 28 日，s3 的一些服务器宕机了几个小时，这中断了许多应用程序，如 Slack、Trello 等。见[这些](https://aws.amazon.com/message/41926/) [文章](https://venturebeat.com/2017/02/28/aws-is-investigating-s3-issues-affecting-quora-slack-trello/)了解更多关于这一事件的信息。

### S3 成本

如果您希望定期访问这些文件，成本很低，标准访问每月每 GB 0.023 美元起。如果您不需要过于频繁地加载数据，它可能会更低。查看[亚马逊 S3 定价](https://aws.amazon.com/s3/pricing/)了解更多信息。

AWS 可能会对其他与 S3 相关的操作(如通过 API 的请求)收费，但这些费用微不足道(大多数情况下每 1000 个请求不到 0.05 美元)。

## 关系数据库服务

AWS RDS 是云中的关系数据库服务。RDS 目前支持 SQL Server、MySQL、PostgreSQL、ORACLE 和一些其他基于 SQL 的框架。AWS 设置您需要的系统并配置参数，这样您可以在几分钟内建立并运行一个关系数据库。RDS 还自行处理备份、恢复、软件修补、故障检测和修复，因此您无需维护系统。

### RDS 优势

RDS 是可扩展的，计算能力和存储容量都可以很容易地扩大或缩小。RDS 系统运行在 EC2 服务器上(正如我提到的，EC2 服务器是大多数 AWS 服务的核心，包括 RDS 服务)，因此这里的计算能力指的是运行 RDS 服务的 EC2 服务器的计算能力，您可以将该系统的计算能力扩展到 32 个 vCPUs 和 244 GiB RAM，更改扩展不会超过几分钟。

也可以提高或降低存储要求。 [Amazon Aurora](https://aws.amazon.com/rds/aurora/) 是 MySQL 和 PostgreSQL 的一个版本，具有一些附加功能，并且可以在需要更多存储空间时自动扩展(您可以定义最大值)。MySQL、MariaDB、Oracle 和 PostgreSQL 引擎允许您在不停机的情况下动态扩展。

### RDS 成本

RDS 服务器的[成本基于三个因素:计算能力、存储和数据传输。](https://aws.amazon.com/rds/postgresql/pricing/)

![RDSpricing](img/b6b59fa26b2122fdd1f085d555959095.png)

例如，一个中等计算能力(2 个 vCPUs 和 8g 内存)的 PostgreSQL 系统每小时的成本为 0.182 美元；如果你签一年或三年的合同，你可以少付钱。

储物方面，有[多种选择和价格](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Storage.html)。如果您选择单可用性区域通用 SSD 存储(gp2)，这是数据科学家的一个好选择，在撰写本文时，北弗吉尼亚的服务器成本为 0.115 美元/GB 月，您可以选择 5 GB 至 16 TB 的 SSD。

对于数据传输，成本会根据数据的来源和目的地(其中之一是 RDS)而有所不同。例如，所有从互联网传输到 RDS 的数据都是免费的。从 RDS 传输到互联网的第一个千兆字节的数据也是免费的，一个月内接下来的 10 兆字节的数据每千兆字节收费 0.09 美元；传输更多数据的成本会降低。

## 红移

Redshift 是亚马逊的数据仓库服务；它是一个分布式系统(有点像 Hadoop 框架),允许你存储大量的数据和进行查询。该服务与 RDS 的区别在于其高容量和处理大数据的能力(TB 和 Pb)。您也可以对红移使用简单的 SQL 查询。

Redshift 在分布式框架上工作，数据分布在集群上连接的不同节点(服务器)上。简单地说，分布式系统上的查询在所有节点上并行运行，然后从每个节点收集结果并进行汇总。

### 红移的好处

Redshift 是高度可扩展的，这意味着在理论上(取决于查询、网络结构和设计、服务规范等。)从 1tb 的数据和 1tb 的数据中获取查询的速度可以通过纵向扩展(添加更多集群)系统来匹配。

创建红移表时，可以选择三种分布样式之一:均匀、关键或全部。

*   EVEN 意味着表行将平均分布在所有节点上。然后，涉及该表的查询分布在集群中，并行运行，最后进行总结。根据 Amazon 的文档，“当一个表不参与连接时，平均分布是合适的”。
*   ALL 意味着在每个节点上都有这个表的一个副本，所以如果您查询那个表上的一个连接，这个表已经在所有节点上了，不需要通过网络从一个节点到另一个节点复制所需的数据。问题是"[所有的分布都将集群中节点的数量乘以所需的存储，因此将数据加载、更新或插入到多个表中需要更长的时间](https://docs.aws.amazon.com/redshift/latest/dg/c_choosing_dist_sort.html)。
*   在键样式中，表的分布行基于一列中的值进行分布，试图将该列中具有相同值的行保留在同一节点中。在相同的节点上物理地存储匹配的值使得在并行系统中连接特定的列更快，参见更多信息[这里](https://docs.aws.amazon.com/redshift/latest/dg/c_choosing_dist_sort.html)。

### 红移成本

红移有两种类型的实例:密集计算或密集存储。密集计算针对快速查询进行了优化，并且对于小于 500GB 的数据具有成本效益(三年期部分预付合同约为 5，500 美元/TB/年)。

密集存储针对大容量存储进行了优化(三年期合同，部分预付约 1，000 美元/TB/年),并且对于+500GB 具有成本效益，但速度较慢。您可以在此找到更多一般定价[。](https://aws.amazon.com/redshift/pricing/)

您还可以在 S3 上保存大量数据，并使用 [Amazon Redshift Spectrum](https://aws.amazon.com/redshift/spectrum/) 对这些数据运行 SQL 查询。对于红移谱，AWS 按每次查询红移谱扫描的字节数向你收费；扫描每兆字节数据 5 美元(每次查询至少 10 兆字节)。

## 弹性 MapReduce

EMR 适合使用 Spark 和其他分布式应用程序设置 Hadoop 集群。Hadoop 集群可以用作计算引擎或(分布式)存储系统。然而，如果数据太大，需要一个分布式系统来处理，红移比存储在 EMR 中更合适，也更便宜。

集群上有三种类型的[节点](https://docs.aws.amazon.com/emr/latest/DeveloperGuide/emr-nodes.html):

*   主节点(您只有一个)负责管理集群。它将工作负载分配给核心和任务节点，跟踪任务状态，并监控集群的健康状况。
*   核心节点运行任务并存储数据。
*   任务节点只能运行任务。

### EMR 优势

由于您可以设置 EMR 安装 Apache Spark，因此该服务非常适合清理、重新格式化和分析大数据。您可以按需使用 EMR，这意味着您可以将其设置为从一个源获取代码和数据(例如，s3 获取代码，S3 或 RDS 获取数据)，在集群上运行任务，并将结果存储在某个位置(同样是 S3、RDS 或 Redshift)并终止集群。

通过以这种方式使用服务，您可以显著降低集群的成本。在我看来，EMR 是对数据科学家最有用的 AWS 服务之一。

要设置 EMR 集群，您需要首先配置要在集群上安装的应用程序。请注意，不同版本的 EMR 带有不同版本的应用程序。例如，如果您将 EMR 版本 5.10.0 配置为安装 Spark，则该版本的 Spark 默认版本是 2.2.0。所以如果你的代码只在 Spark 1.6 上运行，你需要在 4.x 版本上运行 EMR。EMR 将设置网络并配置集群上的所有节点以及所需的工具。

EMR 集群有一个主实例和许多核心节点(从实例)。您可以选择核心节点的数量，甚至可以选择没有核心节点，只使用主服务器进行工作。像其他服务一样，您可以选择服务器的计算能力和每个节点上可用的存储大小。您可以为核心节点使用 autoscale 选项，这意味着您可以向系统添加规则，以便在运行代码时根据需要添加/删除核心节点(最多可达您选择的最大数量)。有关自动缩放的更多信息，请参见[在 Amazon EMR 中使用自动缩放](https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-automatic-scaling.html)。

### EMR 定价

EMR 定价基于您为不同实例(主节点、核心节点和任务节点)选择的计算能力。基本上，它是 EC2 服务器的成本加上 EMR 的成本。你可以在这里找到详细的定价[。](https://aws.amazon.com/emr/pricing/)

![EMRpricing](img/7e379362baabcddfb09af841bf833049.png)

## 结论

我在 AWS 上使用 Python 和 Spark 为我们公司开发了许多端到端的数据驱动产品(包括报告、机器学习模型和产品健康检查系统)，这些产品后来成为公司的良好收入来源。

使用云服务的经验，尤其是像 AWS 这样的知名服务，对你的数据科学家职业生涯是一个巨大的加分。许多公司现在依赖于这些服务，并不断地使用它们，所以你熟悉这些服务会给他们信心，你需要更少的培训就可以加入。随着越来越多的人进入数据科学领域，你希望你的简历尽可能突出。

*你有云小贴士可以补充吗？[让我们了解一下](https://twitter.com/dataquestio)。*