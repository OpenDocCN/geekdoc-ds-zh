# 7.4\. 限行为 2：收敛到平衡

> 原文：[`mmids-textbook.github.io/chap07_rwmc/04_mclimit/roch-mmids-rwmc-mclimit.html`](https://mmids-textbook.github.io/chap07_rwmc/04_mclimit/roch-mmids-rwmc-mclimit.html)

我们继续研究链的长期行为。再次，我们将自己限制在有限空间离散时间马尔可夫链，这些链也是时间齐次的。

## 7.4.1\. 定义#

现在我们已经证明了平稳分布的存在性和唯一性（至少在不可约情况下），接下来需要证明其相关性。正如我们之前指出的，平稳分布定义的定点性质表明它是由反复应用 $P$ 而产生的极限。确实可以证明，从任何分布开始，状态分布随时间 $t$ 趋于平稳分布，前提是满足一个额外的假设。

这个额外的假设涉及到周期性问题。以下例子足以说明。

**例证：** **(周期链)** 考虑一个具有转移矩阵的两个状态马尔可夫链

$$\begin{split} P =\begin{pmatrix} 0 & 1\\ 1 & 0 \end{pmatrix}. \end{split}$$

注意到这个链是不可约的。它的唯一平稳分布是 $\bpi = (1/2, 1/2)^T$，因为确实

$$\begin{split} \bpi P = (1/2, 1/2)^T \begin{pmatrix} 0 & 1\\ 1 & 0 \end{pmatrix} = (1/2, 1/2)^T = \bpi. \end{split}$$

我们计算从状态 $1$ 开始的时间 $t$ 的分布。也就是说，

$$ \bmu = (1, 0)^T. $$

然后

$$ \bmu P = (0, 1)^T, $$$$ \bmu P² = (1,0)^T, $$$$ \bmu P³ = (0,1)^T, $$

等等。

通常情况下，通过归纳法，

$$\begin{split} \bmu P^k = \begin{cases} (1,0)^T & \text{如果 $k$ 是偶数}\\ (0,1)^T & \text{如果 $k$ 是奇数}. \end{cases} \end{split}$$

显然分布并没有收敛。然而，时间平均却在

$$ \lim_{t \to +\infty} \frac{1}{t}\sum_{k \leq t} \bmu P^k = (1/2, 1/2)^T = \bpi. $$

$\lhd$

我们需要以下定义。

**定义：** **(非周期)** $\idx{aperiodic}\xdi$ 设 $(X_t)_{t \geq 0}$ 是一个在有限状态空间 $\mathcal{S}$ 上的马尔可夫链。我们说状态 $i \in \mathcal{S}$ 是非周期的，如果

$$ \P[X_t = i\,|\,X_0 = i] > 0, $$

对于所有足够大的 $t$。如果一个链的所有状态都是非周期的，那么这个链是非周期的。 $\natural$

**例证：** **(周期链，继续)** 回到上面的两个状态链，我们注意到两个状态都不是非周期的。对于状态 $1$，我们已经证明

$$ \P[X_t = 1\,|\, X_0 = 1] = 0 $$

对于所有奇数 $t$。 $\lhd$

我们在这里不需要深入探讨这个定义。相反，我们给出一个简单的**充分**条件，这对于数据科学应用通常已经足够。

**定义：** **(懒惰)** $\idx{lazy}\xdi$ 我们说一个马尔可夫链 $(X_t)_{t \geq 0}$ 是懒惰的，如果每个状态 $i$ 都满足

$$ \P[X_1 = i\,|\,X_0 = i] > 0. $$

换句话说，转移矩阵的对角线上的所有项都是严格正的。$\natural$

图形上，链在每个顶点都有自环（$\idx{self-loop}\xdi$）。这个术语（它并不完全标准）强调了链可以“懒散地”保持其当前状态，而不是总是过渡到另一个状态。

我们检查懒散链必然是非周期的。对于任何状态 $i \in \mathcal{S}$ 和任何 $t$

$$ \P[X_t = i\,|\,X_0 = i] \geq \prod_{s = 1}^t \P[X_{s} = i\,|\,X_{s-1} = i] = (\P[X_1 = i\,|\,X_0 = i])^t > 0, $$

根据假设。换句话说，在时间 $t$ 处于 $i$ 状态的概率，给定我们从 $i$ 状态开始，至少是我们从未离开的概率。

**示例**：任何马尔可夫链都可以通过向所有顶点添加自环来修改为“懒散”版本。具体来说，设 $P = (p_{i,j})_{i,j} \in \mathbb{R}^{n \times n}$ 是 $[n]$ 上马尔可夫链的转移矩阵。考虑修改后的转移矩阵 $Q = (q_{i,j})_{i,j}$，定义为

$$ Q = \frac{1}{2}(I_{n \times n} + P). $$

我们检查这确实是一个随机矩阵。对于每个 $i, j \in [n]$，我们有

$$ q_{i,j} = \frac{1}{2} \mathbf{1}_{i = j} + \frac{1}{2} p_{i,j} \geq \frac{1}{2} p_{i,j} \geq 0 $$

和

$$ \sum_{\ell=1}^n q_{i,\ell} = \sum_{\ell=1}^n \left[\frac{1}{2} \mathbf{1}_{i = \ell} + \frac{1}{2} p_{i,\ell}\right] = \frac{1}{2} \sum_{\ell=1}^n \mathbf{1}_{i = \ell} + \frac{1}{2} \sum_{\ell=1}^n p_{i,\ell} = \frac{1}{2} + \frac{1}{2} = 1. $$

最后，我们注意到 $Q$ 是懒散的，因为

$$ q_{i,i} = \frac{1}{2} \mathbf{1}_{i = i} + \frac{1}{2} p_{i,i} = \frac{1}{2} + \frac{1}{2} p_{i,i} \geq \frac{1}{2} > 0. $$

链 $Q$ 通常被称为 $P$ 的“懒散版本”。$\lhd$

## 7.4.2\. 收敛定理#

我们准备陈述两个关键定理。

首先，**收敛到平衡定理**适用于不可约和非周期的链。这样的链具有唯一的平稳分布。该定理表明，从任何初始分布开始，时间 $t$ 的分布随着 $t \to +\infty$ 趋向于平稳分布。

**定理** **（收敛到平衡定理）** $\idx{convergence to equilibrium theorem}\xdi$ 设 $(X_t)_{t\geq 0}$ 是一个有限、不可约和周期的马尔可夫链，具有唯一的平稳分布 $\bpi$。那么对于任何初始分布 $\bmu$ 和任何状态 $i$

$$ \P[X_t = i] \to \pi_i, $$

随着 $t \to +\infty$。$\sharp$

换句话说，这个定理看起来应该很熟悉。使用 $(\bmu P^t)_i$ 公式来表示在时间 $t$ 状态为 $i$ 的概率，我们可以将定理用矩阵形式重新表述为

$$ \bmu P^t \to \bpi, $$

当 $t \to +\infty$ 时，这非常类似于*幂迭代引理*。从任意分布开始，重复乘以 $P$ 会收敛到 $\bpi$，回忆一下，$\bpi$ 是 $P$ 的一个左特征向量，其特征值为 $1$。与*幂迭代引理*不同，这里不需要归一化。这是因为我们隐式地使用 $\ell_1$-范数，而 $P$ 是随机的，从而保持范数不变。

第二，*遍历定理*适用于不可约链（但不一定是非周期的链）。这样的链具有唯一的平稳分布。该定理表明，从任何初始分布开始，访问任何状态 $i$ 的频率会收敛到平稳分布。下面，我们使用符号 $\mathbf{1}[X_s = i]$，当 $X_s = i$ 时为 $1$，否则为 $0$。

**定理** **(遍历)** $\idx{ergodic theorem}\xdi$ 设 $(X_t)_{t\geq 0}$ 是一个有限且不可约的马尔可夫链，具有唯一的平稳分布 $\bpi$。那么对于任何初始分布 $\bmu$ 和任何状态 $i$

$$ \frac{1}{t} \sum_{s = 0}^t \mathbf{1}[X_s = i] \to \pi_i, $$

当 $t \to +\infty$ 时。 $\sharp$

在上面，$\sum_{s = 0}^t \mathbf{1}[X_s = i]$ 是到时间 $t$ 时访问 $i$ 的次数。

注意，这两个定理中没有一个立即意味着另一个。它们各自都有其用途。

**数值角:** *收敛到平衡定理*意味着在不可约的情况下，我们可以使用幂迭代来计算唯一的平稳分布。我们重新审视*机器人吸尘器示例*。我们以均匀分布初始化，然后反复乘以 $P$。

```py
P_robot = np.array([[0, 0.8, 0, 0.2, 0, 0, 0, 0, 0],
                    [0.3, 0, 0.2, 0, 0, 0.5, 0, 0, 0],
                    [0, 0.6, 0, 0, 0, 0.4, 0, 0, 0],
                    [0.1, 0.1, 0, 0, 0.8, 0, 0, 0, 0],
                    [0, 0, 0, 0.25, 0, 0, 0.75, 0, 0],
                    [0, 0.15, 0.15, 0, 0, 0, 0, 0.35, 0.35],
                    [0, 0, 0, 0, 0, 0, 0, 1, 0],
                    [0, 0, 0, 0, 0.3, 0.4, 0.2, 0, 0.1],
                    [0, 0, 0, 0, 0, 1, 0, 0, 0]])
n_robot = P_robot.shape[0]
mu = np.ones(n_robot)/n_robot
print(mu) 
```

```py
[0.11111111 0.11111111 0.11111111 0.11111111 0.11111111 0.11111111
 0.11111111 0.11111111 0.11111111] 
```

```py
mu = mu @ P_robot
print(mu) 
```

```py
[0.04444444 0.18333333 0.03888889 0.05       0.12222222 0.25555556
 0.10555556 0.15       0.05      ] 
```

```py
mu = mu @ P_robot
print(mu) 
```

```py
[0.06       0.10222222 0.075      0.03944444 0.085      0.21722222
 0.12166667 0.195      0.10444444] 
```

我们再重复，比如，$10$ 次更多，并与真实值 `pi_robot` 进行比较。

```py
for _ in range(10):
    mu = mu @ P_robot
print(mu) 
```

```py
[0.0358112  0.10982018 0.06297235 0.02721311 0.08055026 0.27393441
 0.09944157 0.19521946 0.11503747] 
```

```py
w, v = LA.eig(P_robot.T)
pi_robot = np.real(v[:,0]) / np.sum(np.real(v[:,0]))
print(pi_robot) 
```

```py
[0.03581295 0.11029771 0.06311453 0.02723642 0.0802953  0.27369992
 0.09922559 0.19502056 0.11529703] 
```

我们看到，只需要少量迭代就足以得到准确的答案。一般来说，收敛速度取决于 $P$ 的绝对值严格小于 $1$ 的特征值。

我们也可以通过模拟来检查*遍历定理*。我们生成一个长的样本路径，并将状态访问频率与`pi_robot`进行比较。

```py
seed = 535
rng = np.random.default_rng(seed)

mu = np.ones(n_robot) / n_robot
path_length = 50000
visit_freq = np.zeros(n_robot)

path = mmids.SamplePath(rng, mu, P_robot, path_length)
for i in range(n_robot):
    visit_freq[i] = np.count_nonzero(path == i+1)/(path_length+1)

print(visit_freq) 
```

```py
[0.03627927 0.10927781 0.0601788  0.02645947 0.08045839 0.27359453
 0.10119798 0.19693606 0.11561769] 
```

```py
print(pi_robot) 
```

```py
[0.03581295 0.11029771 0.06311453 0.02723642 0.0802953  0.27369992
 0.09922559 0.19502056 0.11529703] 
```

$\unlhd$

**聊天与学习** 混合时间是马尔可夫链研究中一个重要的量。请你的首选 AI 聊天机器人定义这个概念，并讨论其与马尔可夫链收敛的相关性。探索特定类马尔可夫链的混合时间的一些界限。 $\ddagger$

***自我评估测验*** *(由 Claude，Gemini 和 ChatGPT 协助)*

**1** 以下哪个是马尔可夫链非周期的充分条件？

a) 链是不可约的。

b) 链具有唯一的平稳分布。

c) 链是懒惰的。

d) 链具有有限的状态空间。

**2** 在状态空间为 $S$ 且转移矩阵为 $P$ 的马尔可夫链中，如果链是懒惰的，这意味着什么？

a) 对于所有 $t$，$\mathbb{E}[X_t] = 0$。

b) 对于所有 $i \in S$，$P_{ii} > 0$。

c) 对于所有 $i \ne j$，$P_{ij} = 0$。

d) 对于所有 $t$，$\mathrm{Var}(X_t) = 1$。

**3** 收敛到平衡定理适用于哪种类型的马尔可夫链？

a) 不可约且非周期链

b) 不可约且周期链

c) 可约和非周期链

d) 可约且周期链

**4** 遍历定理适用于哪种类型的马尔可夫链？

a) 不可约链

b) 非周期链

c) 可约链

d) 周期链

**5** 以下哪项描述了收敛到平衡定理和遍历定理之间的一个关键区别？

a) 收敛到平衡定理适用于周期链，而遍历定理适用于非周期链。

b) 收敛到平衡定理关注状态分布，而遍历定理关注状态访问的频率。

c) 收敛到平衡定理需要对角转移矩阵，而遍历定理不需要。

d) 收敛到平衡定理仅适用于有限马尔可夫链，而遍历定理不适用。

答案 1：c. 证明：文本指出，“我们检查懒惰链必然是非周期的。”

答案 2：b. 证明：弱懒惰马尔可夫链定义为转移矩阵的所有对角线元素严格为正，即 $P_{ii} > 0$ 对于所有 $i \in S$。

答案 3：a. 证明：文本指出，“首先，收敛到平衡定理适用于不可约和非周期链。”

答案 4：a. 证明：文本指出，“其次，遍历定理适用于不可约（但不一定是非周期的）链。”

答案 5：b. 证明：收敛到平衡定理处理状态分布收敛到平稳分布的问题，而遍历定理关注任何状态访问频率收敛到平稳分布。

## 7.4.1\. 定义#

既然我们已经证明了平稳分布的存在性和唯一性（至少在不可约的情况下），接下来需要证明其相关性。正如我们之前指出的，平稳分布定义的定点性质表明它作为反复应用 $P$ 的极限出现。确实可以证明，从任何分布开始，状态分布随时间 $t$ 收敛到平稳分布，当 $t \to +\infty$ 时——在额外的假设下。

额外的假设涉及周期性问题。以下例子足以说明。

**例题：** **（周期链）** 考虑一个具有转移矩阵的两个状态马尔可夫链

$$\begin{split} P =\begin{pmatrix} 0 & 1\\ 1 & 0 \end{pmatrix}. \end{split}$$

注意，这个链是不可约的。它的唯一平稳分布是 $\bpi = (1/2, 1/2)^T$，因为确实

$$\begin{split} \bpi P = (1/2, 1/2)^T \begin{pmatrix} 0 & 1\\ 1 & 0 \end{pmatrix} = (1/2, 1/2)^T = \bpi. \end{split}$$

我们计算从状态 $1$ 开始在时间 $t$ 的分布。也就是说，

$$ \bmu = (1, 0)^T. $$

然后

$$ \bmu P = (0, 1)^T, $$$$ \bmu P² = (1,0)^T, $$$$ \bmu P³ = (0,1)^T, $$

以及等等。

一般情况下，通过归纳，

$$\begin{split} \bmu P^k = \begin{cases} (1,0)^T & \text{如果 $k$ 是偶数}\\ (0,1)^T & \text{如果 $k$ 是奇数}. \end{cases} \end{split}$$

显然，分布并没有收敛。然而，请注意，时间平均确实

$$ \lim_{t \to +\infty} \frac{1}{t}\sum_{k \leq t} \bmu P^k = (1/2, 1/2)^T = \bpi. $$

$\lhd$

我们将需要以下定义。

**定义** **(非周期)** $\idx{aperiodic}\xdi$ 设 $(X_t)_{t \geq 0}$ 是一个在有限状态空间 $\mathcal{S}$ 上的马尔可夫链。我们说状态 $i \in \mathcal{S}$ 是非周期的，如果

$$ \P[X_t = i\,|\,X_0 = i] > 0, $$

对于所有足够大的 $t$。如果一个链的所有状态都是非周期的，那么这个链是非周期的。$\natural$

**示例:** **(周期链的继续)** 回到上面提到的两个状态的链，我们注意到两个状态都不是非周期的。对于状态 $1$，我们已经证明

$$ \P[X_t = 1\,|\, X_0 = 1] = 0 $$

对于所有奇数 $t$。$\lhd$

我们在这里不需要详细探讨这个定义。相反，我们给出一个简单的 *充分* 条件，这对于数据科学应用通常足够。

**定义** **(懒惰)** $\idx{lazy}\xdi$ 我们说一个马尔可夫链 $(X_t)_{t \geq 0}$ 是懒惰的，如果每个状态 $i$ 都满足

$$ \P[X_1 = i\,|\,X_0 = i] > 0. $$

换句话说，转移矩阵的对角线上的所有项都是严格正的。$\natural$

图形上，链在每个顶点都有自环$\idx{self-loop}\xdi$。这个术语（它并不完全标准）强调了链可以“懒惰地”保持在当前状态，而不是总是转换到另一个状态。

我们检查一个懒惰链必然是非周期的。对于任何状态 $i \in \mathcal{S}$ 和任何 $t$

$$ \P[X_t = i\,|\,X_0 = i] \geq \prod_{s = 1}^t \P[X_{s} = i\,|\,X_{s-1} = i] = (\P[X_1 = i\,|\,X_0 = i])^t > 0, $$

根据假设。换句话说，在时间 $t$ 处处于 $i$ 的概率，给定我们从 $i$ 开始，至少是我们从未离开的概率。

**示例:** 任何马尔可夫链都可以通过向所有顶点添加自环来修改为懒惰的。具体来说，设 $P = (p_{i,j})_{i,j} \in \mathbb{R}^{n \times n}$ 是在 $[n]$ 上的马尔可夫链的转移矩阵。考虑修改后的转移矩阵 $Q = (q_{i,j})_{i,j}$，定义为

$$ Q = \frac{1}{2}(I_{n \times n} + P). $$

我们检查这确实是一个随机矩阵。对于每个 $i, j \in [n]$，我们有

$$ q_{i,j} = \frac{1}{2} \mathbf{1}_{i = j} + \frac{1}{2} p_{i,j} \geq \frac{1}{2} p_{i,j} \geq 0 $$

以及

$$ \sum_{\ell=1}^n q_{i,\ell} = \sum_{\ell=1}^n \left[\frac{1}{2} \mathbf{1}_{i = \ell} + \frac{1}{2} p_{i,\ell}\right] = \frac{1}{2} \sum_{\ell=1}^n \mathbf{1}_{i = \ell} + \frac{1}{2} \sum_{\ell=1}^n p_{i,\ell} = \frac{1}{2} + \frac{1}{2} = 1. $$

最后，我们注意到 $Q$ 是懒惰的，因为

$$ q_{i,i} = \frac{1}{2} \mathbf{1}_{i = i} + \frac{1}{2} p_{i,i} = \frac{1}{2} + \frac{1}{2} p_{i,i} \geq \frac{1}{2} > 0. $$

链 $Q$ 通常被称为 $P$ 的“懒惰版本”。$\lhd$

## 7.4.2\. 收敛定理#

我们准备好陈述两个关键定理。

首先，**收敛到平衡定理**适用于不可约和非周期的链。这样的链具有唯一的平稳分布。定理表明，从任何初始分布开始，时间 $t$ 的分布会随着 $t \to +\infty$ 而收敛到平稳分布。

**定理** **(收敛到平衡定理**) $\idx{convergence to equilibrium theorem}\xdi$ 设 $(X_t)_{t\geq 0}$ 是一个有限、不可约且非周期的马尔可夫链，具有唯一的平稳分布 $\bpi$。那么对于任何初始分布 $\bmu$ 和任何状态 $i$

$$ \P[X_t = i] \to \pi_i, $$

当 $t \to +\infty$。$\sharp$

换句话说，这个定理应该看起来很熟悉。使用 $(\bmu P^t)_i$ 的公式，即时间 $t$ 时状态为 $i$ 的概率，我们可以将定理重新表述为矩阵形式

$$ \bmu P^t \to \bpi, $$

当 $t \to +\infty$。这非常类似于**幂迭代引理**。从任意分布开始，重复乘以 $P$ 会收敛到 $\bpi$，回忆一下，$\bpi$ 是 $P$ 的左特征向量，特征值为 $1$。与**幂迭代引理**不同，这里不需要归一化。这是因为我们隐式地使用 $\ell_1$-范数，而 $P$ 是随机的，从而保持范数不变。

其次，**遍历定理**适用于不可约（但不一定是非周期的）链。这样的链具有唯一的平稳分布。定理表明，从任何初始分布开始，访问任何状态 $i$ 的频率会收敛到平稳分布。下面，我们使用 $\mathbf{1}[X_s = i]$ 的符号，当 $X_s = i$ 时为 $1$，否则为 $0$。

**定理** **(遍历定理**) $\idx{ergodic theorem}\xdi$ 设 $(X_t)_{t\geq 0}$ 是一个有限且不可约的马尔可夫链，具有唯一的平稳分布 $\bpi$。那么对于任何初始分布 $\bmu$ 和任何状态 $i$

$$ \frac{1}{t} \sum_{s = 0}^t \mathbf{1}[X_s = i] \to \pi_i, $$

当 $t \to +\infty$。$\sharp$

在这里，$\sum_{s = 0}^t \mathbf{1}[X_s = i]$ 是到时间 $t$ 访问 $i$ 的次数。

注意，这两个定理中的任何一个都不立即意味着另一个。它们各自都有其用途。

**数值角**: **收敛到平衡定理**意味着在不可约的情况下，我们可以使用幂迭代来计算唯一的平稳分布。我们重新审视**机器人吸尘器示例**。我们使用均匀分布初始化，然后反复乘以 $P$。

```py
P_robot = np.array([[0, 0.8, 0, 0.2, 0, 0, 0, 0, 0],
                    [0.3, 0, 0.2, 0, 0, 0.5, 0, 0, 0],
                    [0, 0.6, 0, 0, 0, 0.4, 0, 0, 0],
                    [0.1, 0.1, 0, 0, 0.8, 0, 0, 0, 0],
                    [0, 0, 0, 0.25, 0, 0, 0.75, 0, 0],
                    [0, 0.15, 0.15, 0, 0, 0, 0, 0.35, 0.35],
                    [0, 0, 0, 0, 0, 0, 0, 1, 0],
                    [0, 0, 0, 0, 0.3, 0.4, 0.2, 0, 0.1],
                    [0, 0, 0, 0, 0, 1, 0, 0, 0]])
n_robot = P_robot.shape[0]
mu = np.ones(n_robot)/n_robot
print(mu) 
```

```py
[0.11111111 0.11111111 0.11111111 0.11111111 0.11111111 0.11111111
 0.11111111 0.11111111 0.11111111] 
```

```py
mu = mu @ P_robot
print(mu) 
```

```py
[0.04444444 0.18333333 0.03888889 0.05       0.12222222 0.25555556
 0.10555556 0.15       0.05      ] 
```

```py
mu = mu @ P_robot
print(mu) 
```

```py
[0.06       0.10222222 0.075      0.03944444 0.085      0.21722222
 0.12166667 0.195      0.10444444] 
```

我们重复，比如再重复 $10$ 次，并与真实值 `pi_robot` 进行比较。

```py
for _ in range(10):
    mu = mu @ P_robot
print(mu) 
```

```py
[0.0358112  0.10982018 0.06297235 0.02721311 0.08055026 0.27393441
 0.09944157 0.19521946 0.11503747] 
```

```py
w, v = LA.eig(P_robot.T)
pi_robot = np.real(v[:,0]) / np.sum(np.real(v[:,0]))
print(pi_robot) 
```

```py
[0.03581295 0.11029771 0.06311453 0.02723642 0.0802953  0.27369992
 0.09922559 0.19502056 0.11529703] 
```

我们看到，经过少数几次迭代就足以得到准确的答案。一般来说，收敛速度取决于 $P$ 的绝对值严格小于 $1$ 的特征值。

我们也可以通过模拟来检查遍历定理。我们生成一个长样本路径，并将状态访问频率与 $\pi\_robot$ 进行比较。

```py
seed = 535
rng = np.random.default_rng(seed)

mu = np.ones(n_robot) / n_robot
path_length = 50000
visit_freq = np.zeros(n_robot)

path = mmids.SamplePath(rng, mu, P_robot, path_length)
for i in range(n_robot):
    visit_freq[i] = np.count_nonzero(path == i+1)/(path_length+1)

print(visit_freq) 
```

```py
[0.03627927 0.10927781 0.0601788  0.02645947 0.08045839 0.27359453
 0.10119798 0.19693606 0.11561769] 
```

```py
print(pi_robot) 
```

```py
[0.03581295 0.11029771 0.06311453 0.02723642 0.0802953  0.27369992
 0.09922559 0.19502056 0.11529703] 
```

$\unlhd$

**CHAT & LEARN** 混合时间是马尔可夫链研究中一个重要的量。请你的心仪 AI 聊天机器人定义这个概念，并讨论其与马尔可夫链收敛的相关性。探索特定类马尔可夫链的混合时间的一些界限。 $\ddagger$

***自我评估测验*** *(有 Claude、Gemini 和 ChatGPT 的帮助)*

**1** 以下哪项是马尔可夫链成为非周期的充分条件？

a) 链是不可约的。

b) 链具有唯一的平稳分布。

c) 链是懒惰的。

d) 链具有有限的状态空间。

**2** 在状态空间为 $S$ 且转移矩阵为 $P$ 的马尔可夫链中，如果链是懒惰的，这意味着什么？

a) 对于所有 $t$，$\mathbb{E}[X_t] = 0$。

b) 对于所有 $i \in S$，$P_{ii} > 0$。

c) 对于所有 $i \ne j$，$P_{ij} = 0$。

d) 对于所有 $t$，$\mathrm{Var}(X_t) = 1$。

**3** 收敛到平衡定理适用于哪种类型的马尔可夫链？

a) 不可约和非周期链

b) 不可约和周期链

c) 可约和非周期链

d) 可约和周期链

**4** 遍历定理适用于哪种类型的马尔可夫链？

a) 不可约链

b) 非周期链

c) 可约链

d) 周期链

**5** 以下哪项描述了收敛到平衡定理和遍历定理之间的关键区别？

a) 收敛到平衡定理适用于周期链，而遍历定理适用于非周期链。

b) 收敛到平衡定理关注状态分布，而遍历定理关注状态访问的频率。

c) 收敛到平衡定理需要一个对角转移矩阵，而遍历定理不需要。

d) 收敛到平衡定理仅适用于有限马尔可夫链，而遍历定理不适用。

1 的答案：c. 理由：文本中提到，“我们检查一个懒惰链必然是非周期的。”

2 的答案：b. 理由：弱懒惰马尔可夫链被定义为转移矩阵的所有对角元素严格为正，即对于所有 $i \in S$，$P_{ii} > 0$。

3 的答案：a. 理由：文本中提到，“首先，收敛到平衡定理适用于不可约和非周期的链。”

4 的答案：a. 理由：文本中提到，“其次，遍历定理适用于不可约的（但不一定是非周期的）链。”

答案为 5：b. 证明：收敛到平衡态定理讨论状态分布收敛到稳态分布的问题，而遍历定理则关注访问任何状态的频率收敛到稳态分布。
