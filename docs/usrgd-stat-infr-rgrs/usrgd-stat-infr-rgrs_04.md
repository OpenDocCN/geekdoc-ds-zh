# 1  基于设计的推理

> 原文：[`mattblackwell.github.io/gov2002-book/design.html`](https://mattblackwell.github.io/gov2002-book/design.html)

1.  统计推理

1.  1  基于设计的推理

## 1.1 引言

社会数据的定量分析具有一种迷人的精确性。它使我们能够估计观看 YouTube 视频的平均分钟数精确到毫秒，在这个过程中，它赋予我们真正的科学家的光环。但定量分析的优势不在于推导出精确到小数点后三位的估计的能力；相反，定量方法之所以出色，是因为它们允许我们用（希望是）共同、紧凑和精确的数学语言来传达方法论目标、假设和结果。正是这种语言帮助阐明研究人员到底在用他们的数据做什么以及为什么这么做。

这种对定量方法的模糊看法不幸地往往与这些方法在现实世界中的使用方式相矛盾。作为研究人员，我们常常找到一些任意的数据，应用我们熟悉的统计工具，然后将结果强行塞入一个可能或可能没有（脆弱的）联系的理论故事中。这样应用的定量方法将为我们提供一个关于一个无形状目标的模糊问题的非常具体的答案。

本书是定量分析和，特别是统计推理更好基础的指南。推理是使用我们拥有的数据来了解我们没有的数据的任务。

这本书的组织口号是帮助我们作为研究人员做到：

> 明确陈述我们的目标，透明陈述我们的假设，诚实地评估我们的结果。

这些目标是我们的推理目标——或者我们想了解什么，以及关于谁。

在追求这些目标的过程中，本书将关注统计推理的一般工作流程。这个工作流程归结为回答关于我们分析的目标、假设和方法的一系列问题：

1.  **总体（Population）**: 我们想了解谁或什么？

1.  **设计/模型（Design/model）**: 我们将如何收集数据，或者，我们对数据是如何产生的有什么假设？

1.  **感兴趣的量（Quantity of Interest）**: 我们想了解关于总体的什么？

1.  **估计量（Estimator）**: 我们将如何使用数据来产生一个估计？

1.  **不确定性（Uncertainty）**: 我们将如何估计和传达与估计相关的误差？

这些问题构成了任何定量研究工作的核心。对这些问题的回答将借鉴实质性兴趣、可行性和统计理论，这种混合将因问题而异。例如，感兴趣的总体可以从一项研究到另一项研究有很大的变化，而许多不同的研究可能采用相同的估计量和估计方法。

第三个核心问题尤为重要，因为它突出了研究人员在统计推断方法上的基本分歧——具体来说，是**基于设计的推理**与**基于模型推理**。基于设计的推理通常关注我们对我们样本如何从总体中随机选择有精确知识的情况。这里的不确定性完全来自样本中包含的观察值的随机性。相比之下，在**基于模型**的框架中，我们将数据视为随机变量，并提出了一个关于数据如何存在的概率模型。这些模型在假设的强度上有所不同。

基于设计的推理是解决核心推断问题最清晰的方法框架，因此它是本章的重点。其主要缺点是它比基于模型的方法要少得多，并且该框架的数学稍微复杂一些。

我们现在将更详细地审查每个核心问题。

## 1.2 问题 1：总体

推断是使用我们拥有的数据来了解世界事实的任务（即我们没有的数据）。最直接的情况是我们有一个固定的单元集合，我们想要了解一些关于它们的信息。这些单元就是我们所说的**总体**或**目标总体**。我们将关注从这个总体中进行随机抽样，但要做到这一点，我们需要有一个总体单位的列表。这个包含$N$个单位的列表被称为**框架**或**样本框架**，我们将在样本框架中通过$i \in \mathcal{U} = \{1, \ldots, N\}$对这些单位进行索引。在这里我们假设$N$，即总体的大小是已知的，但请注意，这并不总是正确的。

样本框架可能仅仅因为可行性原因而与目标总体不同。例如，目标总体可能包括一个给定城市中的所有家庭，但样本框架可能是该城市所有住宅电话号码的列表。当然，许多家庭没有固定电话，而完全依赖移动电话。这种目标总体与样本框架之间的差距被称为**低估**或**覆盖偏差**。

**示例 1.1** 早期但突出的框架偏差调查样本例子是臭名昭著的 1936 年美国总统选举的《文学 Digest》民意调查。《文学 Digest》是一本（现已停刊）杂志，向汽车注册名单和电话簿中找到的地址发送了超过 1000 万张选票，试图找出谁将赢得重要的 1936 年总统选举。样本量巨大：超过 200 万受访者。最终，预测结果显示，共和党候选人阿尔夫·兰登将获得 55%的选票，而现任民主党总统富兰克林·D·罗斯福将仅赢得 41%的选票。不幸的是，对于《文学 Digest》来说，兰登只获得了 37%的选票。

这种大规模民意调查误差的可能原因有很多。最明显的是，抽样框架与目标人群不同。为什么？只有那些拥有汽车或电话的人被包括在抽样框架中，而没有这两种设备的人几乎全部支持民主党，支持罗斯福。虽然这并不是偏差的唯一来源——差异性的非响应似乎是一个特别大的问题——但框架偏差是误差的主要原因之一。更多关于这次调查的信息，请参阅 SQUIRE (1988)。

设计推断的一个优点是我们必须如何精确地阐述抽样框架。我们可以非常清楚地了解我们试图了解的单位群体。我们将看到，在基于模型的推断中，总体和抽样框架的概念变得更加模糊。

**示例 1.2（美国国家选举调查，人口）** 根据来自 2012 年美国国家选举调查（ANES）的材料，其目标人群是所有 18 岁或以上的美国公民。调查面对面部分的抽样框架“由美国邮政服务使用的投递顺序文件（DSF）”用于住宅邮件投递。”不幸的是，有住房单元由邮政服务通过邮件投递覆盖，这可能导致抽样框架偏差。ANES 的设计者使用十年人口普查将许多这些单元添加到最终的抽样框架中。

## 1.3 问题 2：抽样设计

现在我们已经清楚地定义了总体和抽样框架，我们可以考虑如何从总体中抽取样本。我们将重点关注**概率样本**，其中单位是通过机会被选入样本的，抽样框架中的每个单位都有非零的概率被包括。令 $\mathcal{S} \subset \mathcal{U}$ 为一个样本，令 $\mb{Z} = (Z_1, Z_2, \ldots, Z_N)$ 为一个包含指示符的向量，其中 $Z_i = 1$ 如果 $i \in \mathcal{S}$，否则 $Z_i = 0$。我们用大写字母表示这些指示符，因为它们是随机变量。我们假设样本大小为 $|\mathcal{S}| = n$。

假设我们的抽样框架是霍比特人，他们是“指环同盟”的成员，这是一个由一位睿智的精灵领主创建的独家团体。这个由四个霍比特人组成的群体是一个有效——尽管规模小且虚构——的总体，$\mathcal{U} =$ {Frodo, Sam, Pip, Merry}。

假设我们想从这个群体中抽取两个霍比特人。我们可以列出从这个总体中抽取的两个霍比特人的所有六种可能的样本，用样本成员 $\mathcal{S}$ 或等价地，用包含指示符 $\mb{Z}$ 来表示：

+   $\mathcal{S}_1 =$ {Frodo, Sam} with $\mb{Z}_{1} = (1, 1, 0, 0)$

+   $\mathcal{S}_2 =$ {Frodo, Pip} with $\mb{Z}_{2} = (1, 0, 1, 0)$

+   $\mathcal{S}_3 =$ {Frodo, Merry} with $\mb{Z}_{3} = (1, 0, 0, 1)$

+   $\mathcal{S}_4 =$ {Sam, Pip} with $\mb{Z}_{4} = (0, 1, 1, 0)$

+   $\mathcal{S}_5 =$ {Sam, Merry} with $\mb{Z}_{5} = (0, 1, 0, 1)$

+   $\mathcal{S}_6 =$ {Pip, Merry} with $\mb{Z}_{6} = (0, 0, 1, 1)$

**抽样设计**是对每个样本被选中的可能性的完整说明。也就是说，我们需要为每个样本 $\mathcal{S}_j$ 确定一个选择概率 $\pi_j$。最广泛使用和研究的方案是将每个可能大小为 $n$ 的样本赋予相同的概率。

**定义 1.1** 一个**简单随机样本**（srs）是一种概率抽样设计，其中每个可能的大小为 $n$ 的样本都有相同的出现概率。更具体地说，设 $\mb{z} = (z_{1}, \ldots, z_{N})$ 为一个特定的可能抽样，那么，$$ \P(\mb{Z} = \mb{z}) = \begin{cases} {N \choose n}^{-1} &\text{if } \sum_{i=1}^N z_i = n,\\ 0 & \text{otherwise} \end{cases} $$

如果我们抽取两个霍比特人，srs（简单随机样本）将为上述每个样本 $\mathcal{S}_j$ 分配 $1/{4\choose 2} = 1/6$ 的概率。请注意，srs 对任何样本中不恰好有 $n$ 个单位的样本分配零概率。

另一种常见的抽样设计——**贝努利抽样**设计——通过以相同的概率独立选择每个单位来实现。

**定义 1.2** **贝努利抽样**是一种概率抽样设计，其中独立的贝努利试验（成功概率为 $q$）决定每个单位是否被包含在样本中。更具体地说，设 $\mb{z} = (z_{1}, \ldots, z_{N})$ 为一个特定的可能抽样。贝努利抽样将是 $$ \P(\mb{Z} = \mb{z}) = \P(Z_1 = z_1) \cdots \P(Z_N = z_N) = \prod_{i=1}^N q_i^{Z_i}(1 - q_i)^{1-Z_i} $$

贝努利抽样非常简单，因为独立选择单位简化了许多计算。然而，这种“抛硬币”的方法意味着样本大小 $N_s = \sum_{i=1}^N Z_i$ 本身将是一个随机变量，因为它是由有多少次抛硬币落在“正面”的结果决定的。

简单随机样本和贝努利随机样本易于理解和实现。对于大型调查，由于成本节约的原因，抽样设计通常更为复杂。我们现在描述 ANES 的抽样设计，它包含了许多类似大型调查的典型设计特征。

**示例 1.3（美国国家选举调查，抽样设计）** ANES 对其 2012 年的面对面调查使用了一种典型但复杂的方案。首先，设计者将（或分层）美国各州划分为九个普查区（这些区基于地理划分）。在每个区内部，设计者随后随机抽取了一定数量的普查区（对于人口较多的区，抽取的普查区数量更多）。人口较多的普查区以更高的概率被选中。

第二阶段从抽样框架（在示例 1.2 中描述）中随机抽取地址。为了获得这些群体的过度抽样，从黑人拉丁裔居民比例较高的区域抽取了更多家庭。

最后，抽样的第三阶段是从每个家庭中随机选择一名合格人员进行问卷调查。

## 1.4 问题 3：感兴趣的量

**感兴趣的量**是我们想要了解的关于人口的数值摘要。这些量也被称为**估计量**（拉丁语为“要估计的东西”）。

设 $x_1, x_2, \ldots, x_N$ 为关于人口的一组固定特征或项目。使用统计学家最喜欢的家居装饰，我们可能会将我们的总体视为一个罐子中一系列弹珠的集合，其中 $x_i$ 值表示，例如，第 $i$ 个弹珠的颜色。在调查中，$x_i$ 可能代表总体中第 $i$ 个人的年龄、意识形态或收入。

我们可以根据人口特征定义许多有用的感兴趣量。这些量通常总结了 $x_1, \ldots, x_N$ 的值。最常见且无疑是最有用的一种是**总体均值**，定义为 $$ \overline{x} = \frac{1}{N} \sum_{i=1}^N x_i. $$ 总体均值是固定的，因为 $N$ 和人口特征 $x_1, \ldots, x_N$ 是固定的。调查抽样文献中另一个常见的估计量是总体总数，$$ t = \sum_{i=1}^N x_i = N\overline{x}. $$

**示例 1.4（子总体均值）** 我们也可能对不同子域的量感兴趣。假设我们感兴趣的是估计（例如）保守派身份认同的受访者中支持增加合法移民的比例。设 $d= 1, \ldots, D$ 为子域或子总体的数量。在这种情况下，我们可能有 $d = 1$ 作为自由派身份认同者，$d = 2$ 作为温和派身份认同者，$d = 3$ 作为保守派身份认同者。我们将这些组中的每个子总体称为 $\mathcal{U}_d \subset \{1,\ldots, N\}$，并定义这些组的大小为 $N_d = |\mathcal{U}_d|$。因此，$N_3$ 将是总体中保守派身份认同公民的数量。

每个组的均值随后为 $$ \overline{x}_d = \frac{1}{N_d} \sum_{i \in \mathcal{U}_d} x_i. $$

子总体估计可能比总体估计稍微复杂一些，因为我们可能不知道谁属于哪个子总体，直到我们实际上对总体进行抽样。例如，我们的抽样框架可能没有关于“潜在受访者”意识形态的信息。因此，$N_d$ 对于研究人员来说是未知的，而 $N$ 对于总体均值来说是已知的。

我们可能对许多其他感兴趣量感兴趣，但基于设计的推断主要关注这些类型的总体和子总体均值及总数。

## 1.5 问题 4：估计量

现在我们已经有一个抽样设计和一个感兴趣的量，我们可以考虑从我们的样本中可以了解这个感兴趣量的哪些内容。**估计量**是样本测量值的函数，旨在作为我们对感兴趣量的最佳猜测。

如果最常见的估计量是总体均值，那么最受欢迎的估计量是**样本均值**，定义为 $$ \overline{X}_n = \frac{1}{n} \sum_{i=1}^{N}Z_ix_i $$

样本均值是一个**随机**量，因为它会随着样本的不同而变化，而这些样本是按概率选择的。例如，假设我们从表 1.1 中的小矮人群体中获得了身高测量值。

表 1.1：一个小矮人群体

| 单元 ($i$) | 身高（cm）($x_i$) |
| --- | --- |
| 1 (Frodo) | 124 |
| 2 (Sam) | 127 |
| 3 (Pip) | 123 |
| 4 (Merry) | 127 |

如果我们考虑从这个群体中抽取一个大小为 $n=2$ 的简单随机样本，我们可以列出与这种抽样设计相关联的所有可能样本均值的概率，就像我们在表 1.2 中所做的那样。表 1.3 结合了样本均值的等效值，以得出在大小为 2 的简单随机抽样下的矮人身高样本均值的**抽样分布**。

表 1.2：来自矮人人群的所有可能简单随机样本大小为 2

| 样本 ($j$) | 概率 ($\pi_j$) | 样本均值 ($\overline{X}_n$) |
| --- | --- | --- |
| 1 (Frodo, Sam) | 1/6 | (124 + 127) / 2 = 125.5 |
| 2 (Frodo, Pip) | 1/6 | (124 + 123) / 2 = 123.5 |
| 3 (Frodo, Merry) | 1/6 | (124 + 127) / 2 = 125.5 |
| 4 (Sam, Pip) | 1/6 | (127 + 123) / 2 = 125 |
| 5 (Sam, Merry) | 1/6 | (127 + 127) / 2 = 127 |
| 6 (Pip, Merry) | 1/6 | (123 + 127) / 2 = 125 |

表 1.3：来自矮人人群的简单随机样本大小为 2 的样本均值抽样分布

| 样本均值 | 概率 |
| --- | --- |
| 123.5 | 1/6 |
| 125 | 1/3 |
| 125.5 | 1/3 |
| 127 | 1/6 |

因此，抽样分布告诉我们估计量的哪些值更可能或不太可能，并且取决于总体分布和抽样设计。

*注意* *请注意，估计量的抽样分布将取决于抽样设计。在这里，我们使用了简单随机抽样。伯努利抽样会产生不同的分布。使用伯努利抽样，我们可能会得到仅包含弗罗多的样本，在这种情况下，样本均值将是他的身高（124cm），这是一个在大小为 $n=2$ 的简单随机抽样中不可能出现的样本均值值。*  *### 1.5.1 估计量抽样分布的性质

一般而言，我们希望“好的”估计量。但什么使估计量“好”？显然，最好的估计量是总是正确的估计量（$\Xbar_n = \overline{x}$ 的概率为 1），但这只有在进行人口普查——也就是说，从人口中抽取每个人——或者人口不变化的情况下才可能。对于大多数研究人员来说，这两种情况都不典型。

我们转而关注估计量的抽样分布的性质。以下类型的问题涉及到这些性质：

+   估计量的观测值（实现）是否围绕感兴趣的量的真实值中心？（无偏性）

+   在从总体中不同样本的估计量实现中，是否存在很大的或很小的变化？（样本方差）

+   估计量平均上有多接近真实值？（均方误差）

这些问题的答案将取决于（a）估计量和（b）抽样设计。

为了支持这一点，抽样分布向我们展示了从总体中不同样本的所有可能的估计量值。如果我们想用一个单一的数字来总结这个分布，我们会关注它的期望值，这是分布的中心趋势的度量。粗略地说，我们希望分布的中心接近并且理想情况下等于真实感兴趣的量。如果这不是这种情况，这意味着估计量系统地高估或低估了真实值。我们称这个差异为估计量的**偏差**，可以用数学公式表示为 $$ \textsf{bias}[\Xbar_{n}] = \E[\Xbar_{n}] - \overline{x}. $$ 任何偏差等于零的估计量被称为**无偏估计量**。

我们可以通过首先计算估计量的期望值，$$ \E[\Xbar_{n}] = \frac{1}{6}\cdot 123.5 + \frac{1}{3} \cdot 125 + \frac{1}{3} \cdot 125.5 + \frac{1}{6} \cdot 127 = 125.25, $$ 然后将其与总体均值进行比较，$$ \overline{x} = \frac{1}{4}\left(124 + 127 + 123 + 127\right) = 125.25. $$ 两者相同，这意味着在这个简单随机样本中的样本均值是无偏的。

*警告* *请注意，有时“偏差”一词也指系统性地在其他方面不正确的研究。例如，我们可能会抱怨一个调查问题是有偏差的，如果它提出了一个引导性的或误导性的问题，或者如果它错误地衡量了感兴趣的概念。为了说明这一点，假设我们想要估计一个群体中定期向政治竞选活动捐款的比例，但 $x_i$ 实际上衡量的是一个人是否在调查当天捐款。在这种情况下，$\overline{x}$ 会相当低，因为它只捕捉到一天的捐款模式，而不是随时间进行的定期捐款。教科书通常将我们获得的测量值和想要获得的测量值之间的差距称为**测量偏差**。这与样本均值的偏差是不同的。以我们的捐款为例，从每日捐款者群体中抽取一个简单随机样本，$\Xbar_{n}$ 仍然会对 $\overline{x}$ 进行无偏估计，即使这完全不是我们感兴趣的量。* *我们的矮人抽样是否无偏仅限于这个例子？幸运的是，并非如此。我们可以证明，在简单随机样本下，样本均值将对总体均值进行无偏估计。依赖于样本均值的定义，我们可以得到：$$ \E[\Xbar_{n}] = \E\left[\frac{1}{n} \sum_{i=1}^{N} Z_{i}x_{i}\right] = \frac{1}{n} \sum_{i=1}^{N} \E[Z_{i}]x_{i} = \frac{1}{n} \sum_{i=1}^{N} \frac{n}{N}x_{i} = \frac{1}{N} \sum_{i=1}^{N}x_{i} = \overline{x} $$ 在第二个等式中使用 $\E[Z_i] = n/N$ 对于简单随机样本是关键的。直观上，被包括在样本中的概率仅仅是所选样本的分数，$n/N$。

估计量的抽样分布的第二个显著特征是其分布范围。一般来说，我们更喜欢那些估计值在样本之间非常相似的估计量，而不是那些估计值在样本之间波动很大的估计量。我们用**抽样方差**来量化这种分布范围，它就是估计量的抽样分布的方差，或者$$ \V[\Xbar_n] = \E[(\Xbar_n - \E[\Xbar_n])²]. $$ 分布范围的另一种度量是估计量的**标准误差**，它是抽样方差的平方根，$$ \se[\Xbar_n] = \sqrt{\V[\Xbar_n]}. $$ 标准误差通常更容易解释，因为它与原始变量处于相同的量级。以我们关于矮人身高为例，抽样方差将以平方厘米为单位来衡量，但标准误差将以厘米为单位来衡量，因此更容易解释。

最后一个重要的属性是**均方误差**或**MSE**，它（正如其名称所暗示的）衡量的是平方误差的平均值：$$ \text{MSE} = \E[(\Xbar_n-\overline{x})²]. $$ 留意细节的读者可能会发现这个量是多余的，因为我们上面已经展示了样本均值是无偏的，所以 $\E[\Xbar_n] = \overline{x}$。这反过来意味着样本均值的抽样方差就是均方误差。然而，情况往往会让我们使用有偏估计量，因此这两个量将不同。实际上，如果我们有一个对某个总体量 $\theta$ 的估计量 $\widehat{\theta}$，$$ \begin{aligned} \text{MSE}[\widehat{\theta}] &= \E[(\widehat{\theta} - \theta)²] \\ &= \E[(\widehat{\theta} - \E[\widehat{\theta}] + \E[\widehat{\theta}] - \theta)²] \\ &= \E[(\widehat{\theta} - \E[\widehat{\theta}])²] + \left(\E[\widehat{\theta}] - \theta\right) ^ 2 + 2\E[(\widehat{\theta} - \E[\widehat{\theta}])]\left(\E[\widehat{\theta}] - \theta\right) \\ &= \text{bias}[\widehat{\theta}_n]² + \V[\widehat{\theta}_n] \end{aligned} $$ 因此，当偏差和方差都低时，均方误差就低。

注意，将这些概念与精确度和准确性的概念联系起来是有用的。特别是，抽样方差低的估计量是**精确的**，而均方误差低的估计量是**准确的**。一个估计量可以非常精确，但同样的估计量可能是不准确的，因为它是有偏的。

现在我们有一个总体，一个感兴趣的量，一个抽样设计，一个估计量，以及，有了数据，一个实际的估计。但如果我们从矮人群体中抽取了萨姆和梅里，并得到了样本平均身高为 127 厘米，一个合理的担忧是，不同的样本——例如，萨姆和弗罗多或梅里和皮平——会给出不同的样本均值。那么，我们从萨姆和梅里的样本中得到的 127 英寸的估计值是否接近真实的总体均值呢？没有对这四个矮人进行全面普查，我们就无法真正知道，这将使我们的抽样变得毫无意义。我们能否找出我们可能离真相有多远——即真实的总体均值？抽样方差解决了这个确切的问题，但抽样方差取决于抽样分布，而我们只从这个分布中抽取了一个样本，得到了 127 的估计值。

如果我们有一个特定的估计量和抽样设计，我们通常可以推导出抽样方差（以及因此的标准误差）的解析表达式，这反过来将确定影响抽样方差的因素。为了帮助这一努力，我们需要定义总体分布的另一个特征，即**总体方差**，$$ s^{2}= \frac{1}{N-1} \sum_{i=1}^{N} (x_{i} - \overline{x})^{2}. $$ 总体方差衡量的是总体中 $x_i$ 值的分布范围。因此，它是一个固定量，不是一个随机变量。

现在我们将简单随机抽样下 $\Xbar_n$ 的抽样方差写成 $$ \V[\Xbar_{n}] = \left(1 - \frac{n}{N}\right) \frac{s^{2}}{n} $$ 从这个表达式中，有几个特点很突出。首先，如果数据 $x_i$ 在总体中分布得更广，样本均值也会分布得更广。其次，样本大小 $n$ 越大，抽样方差（对于固定的总体大小）越小。第三，总体大小 $N$ 越大，抽样方差（对于固定的样本大小）越小。

### 1.6.1 推导样本均值的抽样方差

我们是如何获得简单随机抽样下抽样方差的这个表达式的？简单地说“别人为我证明了它”可能会很有诱惑力，但盲目相信统计理论限制了我们对这种状况的理解，以及应对研究过程中经常出现的各种新情况的能力。

要推导样本均值的抽样方差，让我们从一个简单应用方差规则开始，这个规则对于任何抽样设计都是有效的：$$ \V[\Xbar_{n}] = \V\left[\frac{1}{n} \sum_{i=1}^N x_iZ_i\right] = \frac{1}{n²}\left[\sum_{i=1}^N x_i²\V[Z_i] + \sum_{i=1}^N\sum_{j\neq i} x_ix_j\cov[Z_i,Z_j]\right]. $$ 注意在第二个等式中，$x_i$ 和 $x_j$ 的值从方差和协方差算子中出来，就像它们是常数一样。这是因为，在设计推断中，它们确实是常数。唯一的变化和不确定性的来源是抽样，这由包含指示符 $Z_i$ 表示。为了取得进展，我们需要知道这些包含指示符的方差和协方差。回想一下，具有概率 $p$ 为 1 的二元指示符的方差是 $p(1 - p)$。所以如果对于简单随机样本，$\P(Z_i = 1) = n/N$，那么 $$ \V[Z_i] = \frac{n}{N}\left(1 - \frac{n}{N}\right) = \frac{n(N - n)}{N²}. $$

如果你习惯了“独立同分布”的框架（我们将在下一章中讨论），那么在样本方差中的协方差可能会让你感到惊讶。单位通常不是被假定为独立的吗？虽然这个假设（以及将会是）会使我们的数学生活变得容易，但对于简单随机样本来说并不成立。简单随机样本在抽取时不放回，这意味着单位被纳入样本并不是独立的——知道单位 $i$ 被纳入样本意味着另一个单位 $j$ 被纳入样本的概率只有 $(n-1)/(N-1)$。为了推导协方差的表达式，注意 $\cov(Z_i, Z_j) = \E[Z_iZ_j] - \E[Z_i]\E[Z_j]$ 和 $$ \E[Z_iZ_j] = \P(Z_i = 1, Z_j = 1) = \P(Z_i = 1)\P(Z_j =1 \mid Z_i = 1) = \frac{n}{N}\cdot \frac{n-1}{N-1}. $$ 将这个结果代入我们的协方差表达式中，我们得到 $$ \begin{aligned} \cov(Z_i, Z_j) &= \E[Z_iZ_j] - \E[Z_i]\E[Z_j] \\ &= \frac{n}{N}\cdot \frac{n-1}{N-1} - \frac{n²}{N²}. \\ &=\frac{n}{N}\left(\frac{n-1}{N-1} - \frac{n}{N}\right) \\ &= \frac{n}{N}\left(\frac{Nn-N - Nn + n}{N(N-1)}\right) \\ &= -\frac{n(N- n)}{N²(N-1)} \\ &= -\frac{\V[Z_i]}{N-1}. \end{aligned} $$ 由于方差和总体大小必须是正数，两个单位被纳入样本之间的协方差是负的。回到我们的矮人例子，样本中有固定数量的位置，因此弗罗多被纳入样本会降低山姆被纳入样本的机会，所以我们最终得到这个负协方差。

现在已经计算出了协方差和方差，我们可以推导出样本均值的抽样方差：$$ \begin{aligned} \V[\Xbar_{n}] &= \frac{1}{n²}\left[\sum_{i=1}^N x_i²\V[Z_i] + \sum_{i=1}^N\sum_{j\neq i} x_ix_j\cov[Z_i,Z_j]\right] \\ &= \frac{1}{n²}\left[\sum_{i=1}^N x_i²\V[Z_i] - \frac{1}{N-1} \sum_{i=1}^N\sum_{j\neq i} x_ix_j\V[Z_i]\right] \\ &= \frac{\V[Z_i]}{n²}\left[\sum_{i=1}^N x_i² - \frac{1}{N-1} \sum_{i=1}^N\sum_{j\neq i} x_ix_j\right] \\ &= \frac{N-n}{nN²}\left[\sum_{i=1}^N x_i² - \frac{1}{N-1} \sum_{i=1}^N\sum_{j\neq i} x_ix_j\right] \end{aligned} $$ 接下来我们该怎么做呢？不幸的是，我们来到了一个非直观且看似神奇的步骤：“加减一个关键量”。（在完成证明之前需要知道这个步骤，那么在没有知道这个步骤的情况下如何完成证明呢？）在这种情况下，需要加减的量是 $(N-1)^{-1} \sum_{i=1}^N x_i²$。为了理解为什么，以稍微不同的方式重写总体方差：$$ s² = \frac{1}{N-1}\sum_{i=1}^N (x_i - \overline{x})² = \frac{1}{N-1} \left(\sum_{i=1}^N x_i² - N\overline{x}²\right) $$ 注意到我们可以写出 $$ N²\overline{x}² = \sum_{i=1}^N x_i² + \sum_{i=1}^N \sum_{j\neq i} x_ix_j, $$ 这为我们将要加减的量提供了一个提示 $$ \begin{aligned} \V[\Xbar_{n}] &= \frac{N-n}{nN²}\left[\sum_{i=1}^N x_i² \textcolor{red!50}{\underbrace{+ \frac{1}{N-1}\sum_{i=1}^N x_i² - \frac{1}{N-1}\sum_{i=1}^N x_i²}_{\text{加减}}} - \frac{1}{N-1} \sum_{i=1}^N\sum_{j\neq i} x_ix_j\right] \\ &= \frac{N-n}{nN²}\left[\frac{N}{N-1}\sum_{i=1}^N x_i² - \frac{1}{N-1} \sum_{i=1}^N\sum_{j=i}^N x_ix_j\right] \\ &= \frac{N-n}{nN²}\left[\frac{N}{N-1}\sum_{i=1}^N x_i² - \frac{N²}{N-1} \overline{x}\right] \\ &= \frac{N-n}{nN(N-1)}\left[\sum_{i=1}^N x_i² - N \overline{x}\right] \\ &= \frac{N-n}{nN(N-1)}\sum_{i=1}^N (x_i - \overline{x})² \\ &= \frac{(N-n)}{N}\frac{s²}{n} = \left(1 - \frac{n}{N}\right)\frac{s²}{n}. \end{aligned} $$ 这个证明相当复杂，但确实展示了推导统计结果的一些常用方法。它还强调了抽样方案如何导致依赖性，使得结果更加复杂。下一章将讨论在独立同分布抽样下样本均值的方差是如何变得简单的。

### 1.6.2 估计抽样方差

抽样方差 $\V[\Xbar_n]$ 的一个不幸之处在于它依赖于总体方差 $s²$，而我们无法知道它，除非我们对整个总体进行普查（如果我们有这些信息，我们就不必担心不确定性了）。因此，我们需要估计抽样方差。由于我们已经知道 $n$，样本大小，以及 $N$，总体大小，最直接的方法是找到一个总体方差的估计量。

对于这个问题的良好估计量是**样本方差**，它仅仅是将方差公式应用于样本本身，$$ S² = \frac{1}{n-1} \sum_{i=1}^N Z_i(x_i - \Xbar_n)². $$ 我们可以通过将此代入总体方差来获得样本方差的估计量，$$ \widehat{\V}[\Xbar_n] = \left(1 - \frac{n}{N}\right)\frac{S²}{n}. $$

*注意你的方差* *很容易混淆总体方差、样本方差和样本方差（就像容易混淆总体、样本分布和样本分布一样）。增加混淆的是，这些都是方差，但针对非常不同的分布.*  *为什么 $\widehat{\V}[\Xbar_n]$ 是 $\V[\Xbar_{n}]$ 的“良好”估计量？为了回答这个问题，我们应用与问题 4 中相同的标准。理想情况下，估计量应该是无偏的，这意味着它不会系统地高估或低估样本均值在重复样本中的变异程度。

$$ \begin{aligned} \E[S²] &= \frac{1}{n-1} \sum_{i=1}^N \E[Z_i(x_i - \Xbar_n)²] \\ &= \frac{1}{n-1} \E\left[\sum_{i=1}^N Z_i(x_i - \overline{x} - (\Xbar_n - \overline{x}))²\right] \\ &= \frac{1}{n-1} \E\left[\sum_{i=1}^N Z_i(x_i - \overline{x})² -2Z_i(x_i - \overline{x})(\Xbar_n - \overline{x}) + Z_i(\Xbar_n - \overline{x})²\right] \\ \end{aligned} $$

注意到 $(\Xbar_n - \overline{x})$ 不依赖于 $i$，因此我们可以将其从求和中提取出来：

$$ \begin{aligned} \E[S²] &= \frac{1}{n-1} \E\left[\sum_{i=1}^N Z_i(x_i - \overline{x})² -2(\Xbar_n - \overline{x}) \sum_{i=1}^N Z_i(x_i - \overline{x}) + (\Xbar_n - \overline{x})² \sum_{i=1}^N Z_i\right] \\ &= \frac{1}{n-1} \E\left[\sum_{i=1}^N Z_i(x_i - \overline{x})² -2n(\Xbar_n - \overline{x})² + n(\Xbar_n - \overline{x})²\right] \\ &= \frac{1}{n-1} \left[\sum_{i=1}^N \E[Z_i] (x_i - \overline{x})² -n\E[(\Xbar_n - \overline{x})²]\right] \\ &= \frac{n}{N}\frac{1}{n-1}\sum_{i=1}^N (x_i - \overline{x})² -\frac{n}{n-1}\V[\Xbar_n] \\ &= \frac{n(N-1)}{N(n-1)}s² -\frac{(N-n)}{N(n-1)}s² \\ &= s² \end{aligned} $$

这表明样本方差对于总体方差是无偏的。为了完成推导，我们只需将此代入估计的样本方差，$$ \E\left[\widehat{\V}[\Xbar_n]\right] = \left(1 - \frac{n}{N}\right)\frac{\E\left[S²\right]}{n} = \left(1 - \frac{n}{N}\right)\frac{s²}{n} = \V[\Xbar_n], $$ 这就证明了估计量是无偏的.*  *## 1.7 分层抽样和调查权重

真如其名，简单随机抽样可能是获取固定大小随机样本的最直接方法。然而，如果我们对总体有更多信息，我们可以通过将此信息纳入抽样方案来获得对总体数量的更好估计。我们可以通过进行**分层随机抽样**来实现这一点，即将总体划分为几个层（或组），并在每个层中进行简单随机抽样。我们根据关于总体的额外信息创建这些层（或“在通常术语中分层总体”）。

考虑一个扩大的《指环王》全体成员的总体，其中包括 9 个冒险成员——四个霍比特人加上两个人类（阿拉贡和注定要失败的博罗米尔）、一个精灵（森林精灵的莱戈拉斯）、一个矮人（吉姆利）和一个魔法师（灰衣甘道夫）。

| 单位 ($i$) | 种族 | 身高（cm）($x_i$) |
| --- | --- | --- |
| 1 (Frodo) | 霍比特人 | 124 cm |
| 2 (Sam) | 霍比特人 | 127 cm |
| 3 (Pip) | 霍比特人 | 123 cm |
| 4 (Merry) | 霍比特人 | 127 cm |
| 5 (Gimli) | 矮人 | 137 cm |
| 6 (Gandalf) | 魔法师 | 168 cm |
| 7 (Aragorn) | 人类 | 198 cm |
| 8 (Boromir) | 人类 | 193 cm |
| 9 (Legolas) | 精灵 | 183 cm |

如果我们从该总体中抽取一个 5 个样本，我们可以使用简单随机抽样，但请注意样本可能是不平衡的。例如，我们可以主要或全部抽取非霍比特人。我们还可以在这里进行分层抽样，将我们的总体分为两个层：霍比特人和非霍比特人，分别占总体的大约 4/9（约 44%）和 5/9（约 56%）。为了得到一个 5 个样本，我们可以对霍比特人进行大小为 2 的简单随机抽样，对非霍比特人进行大小为 3 的简单随机抽样。这将保证我们的样本每次都是 40%的霍比特人，同时仍然保持我们在选择哪些霍比特人和非霍比特人进入样本时的随机性。

进行分层随机抽样的另一个原因是保证总体中某个子群体的精度。社会科学研究人员经常进行全国代表性调查，但他们对获得某些少数群体——例如，非裔美国人、拉丁美洲人、LGBTQ+人群和其他人的估计有特定兴趣。在较小的样本量中，这些群体中的一个的受访者数量可能太少，无法了解他们的观点。对感兴趣群体的更高比例进行抽样将有助于确保我们可以对该群体做出精确的陈述。

在简单随机抽样中，对于所有 $i$，我们有 $\pi_i = n/N$。相比之下，分层随机抽样是具有不相等包含概率的广泛抽样方法的一个例子，我们表示为 $\pi_i = \P(Z_{i} = 1)$。在《指环王》的例子中，我们抽取了 2 个霍比特人和 3 个非霍比特人，因此我们有以下包含概率：

| 单位 ($i$) | 种族 | 包含概率 ($\pi_i$) |
| --- | --- | --- |
| 1 (弗罗多) | 霍比特人 | 0.5 |
| 2 (山姆) | 霍比特人 | 0.5 |
| 3 (皮普) | 霍比特人 | 0.5 |
| 4 (梅里) | 霍比特人 | 0.5 |
| 5 (吉姆利) | 矮人 | 0.6 |
| 6 (甘道夫) | 法师 | 0.6 |
| 7 (阿拉贡) | 人类 | 0.6 |
| 8 (博罗米尔) | 人类 | 0.6 |
| 9 (莱戈拉斯) | 精灵 | 0.6 |

有其他方法可以以不同的包含概率进行随机抽样。例如，假设目标是随机抽取 5 个美国城市进行研究。我们可能希望使样本偏向大城市，以便在总体样本中捕获更多的公民。如果城市 $i$ 的居民数为 $b_i$，那么我们的抽样替换的包含概率¹ 为 $$ \pi_i = \frac{b_i}{\sum_{i=1}^N b_i}. $$ 请注意，我们在抽样设计中使用了有关人口的信息，尽管这种信息是连续的，而分层估计量中的信息是离散的。

使用具有不同包含概率的抽样设计意味着我们已经改变了我们的抽样设计（问题 3），但总体和估计量（问题 1 和 2）保持不变。我们仍然对估计总体均值 $\overline{x}$ 感兴趣。我们现在转向估计量（问题 4），因为我们需要使用一个与设计相匹配的新估计量。

当使用不同包含概率进行抽样时，通常使用两个估计量来估计总体均值。第一个是 **Horvitz-Thompson (HT) 估计量**，其形式为 $$ \widetilde{X}_{HT} = \frac{1}{N} \sum_{i=1}^{N} \frac{Z_{i}x_{i}}{\pi_{i}}, $$ 这是对样本中那些人的加权平均，权重是包含概率的倒数。这就是为什么这个估计量有时被称为逆概率加权，或 IPW，估计量。

我们可以通过注意到 $\E[Z_i] = \P(Z_i = 1) = \pi_i$ 来证明 HT 估计量对于总体均值是无偏的，因此 $$ \E[\widetilde{X}_{HT}] = \frac{1}{N} \sum_{i=1}^N \frac{\E[Z_i]x_i}{\pi_i} = \frac{1}{N} \sum_{i=1}^N x_i = \overline{x}. $$ HT 估计量的一个缺点是，如果选中的单位具有非常小的包含概率，则该单位的权重（$1/\pi_i$）将非常大。这种不稳定性是分层设计的无偏性的代价。此外，请注意，样本方差的公式相当复杂，并且需要与当前任务不太重要的符号。

当使用不同包含概率进行抽样时，对总体均值进行估计的第二个估计量是 **Hájek 估计量**，它将权重标准化，使它们的总和为 $N$，其形式为 $$ \widetilde{X}_{hj} = \frac{\sum_{i=1}^N Z_{i}x_{i} / \pi_{i}}{\sum_{i=1}^{N} Z_{i}/\pi_{i}}. $$ 由于分母中有一个随机量，这个估计量对总体均值是 **有偏的**。然而，Hajek 估计量在许多情况下通常被认为是更好的估计量，因为它比 HT 估计量具有更低的样本方差。

### 1.7.1 抽样权重

HT 和 Hajek 估计量都是通常所说的**抽样权重**的函数，$$w_i = \frac{1}{\pi_i}$$。我们可以将 HT 估计量写为$$ \widetilde{X}_{HT} = \frac{1}{N} \sum_{i=1}^N w_iZ_ix_i, $$，而 Hajek 估计量可以写为$$ \widetilde{X}_{hj} = \frac{\sum_{i=1}^N w_iZ_{i}x_{i}}{\sum_{i=1}^{N} w_iZ_{i}}. $$ 这些权重，$w_i$，通常包含在最终的调查数据集中，因为它们包含了研究人员分析调查响应所需的所有关于抽样设计的信息，即使不知道确切的设计。²

抽样权重在伪总体方面有一个很好的解释：样本中的每个单位“代表” $w_i = 1/\pi_i$ 个总体单位。这使得样本更能代表总体。

最后，请注意，统计软件在处理权重方面有时会有些令人困惑。R 中的估计函数`weighted.mean(x, w)`可能并不明显。实际上，源代码基本上调用

```r
sum(x * w) / sum(w)
```

*这相当于上面提到的 Hajek 估计量。*  *## 1.8 总结

本章在从总体抽样的背景下介绍了设计基础推断的基本结构。我们介绍了统计推断的基本问题，包括指定总体和感兴趣的量，选择抽样设计和估计量，以及评估估计量的不确定性。当然，我们只是触及了在抽样实践中使用的类型的设计和估计量的表面。专业概率调查通常使用聚类，这意味着随机选择较大的单位簇，然后在这些单位中进行随机抽样。尽管抽样设计可能很复杂，但设计基础统计推断的核心步骤仍然是相同的。研究人员必须确定一个总体，确定抽样设计，选择感兴趣的量，选择估计量，并描述任何估计的不确定性。

SQUIRE, PEVERILL. 1988\. “WHY THE 1936 LITERARY DIGEST POLL FAILED.” *Public Opinion Quarterly* 52 (1): 125–33\. [`doi.org/10.1086/269085`](https://doi.org/10.1086/269085).

* * *

1.  这种描述适用于有放回的抽样。当进行无放回抽样时，我们需要调整概率，以考虑到首先被选中意味着该单位不能再次被选中的情况。↩︎

1.  如果我们想要设计基础的样本方差估计量，我们也需要知道联合包含概率，即任何两个单位同时被抽样的概率。↩︎****
