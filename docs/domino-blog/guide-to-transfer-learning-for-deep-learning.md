# 迁移学习及其工作原理的详细指南

> 原文：<https://www.dominodatalab.com/blog/guide-to-transfer-learning-for-deep-learning>

对于数据科学团队来说，如果数据不足或数据过多，并且没有足够的时间或资源来处理这些数据，迁移学习可能是机器学习模型开发中的一条重要捷径。最常与深度学习和神经网络相关联，它也正被用来取代传统的机器学习 [模型训练技术](https://www.dominodatalab.com/blog/what-is-machine-learning-model-training) 作为加速开发的方法。

## 什么是迁移学习？

迁移学习是一种机器学习技术，它重用为一项任务开发的完整模型，作为新模型完成新任务的起点。第一模型使用的知识因此被转移到第二模型。“迁移学习”一词来自人类心理学，例如，一个知道如何弹钢琴的人比一个毫无经验的人更容易学会拉小提琴。

### 迁移学习的子集

迁移学习的运用取决于三个因素:需要迁移什么，如何迁移，何时迁移。因为迁移学习设置中的源数据集和目标数据可以在它们的领域或它们的任务中变化，所以有三个不同的迁移学习 子集 [。](https://hal.archives-ouvertes.fr/hal-01575126/document)

1.  **归纳学习:**任务是不同的，不管源域和目标域之间有什么相似之处。
2.  **直推式学习:**任务相同，但特征空间或领域间的边际概率分布不同。
3.  **无监督学习:**没有可用于训练的标记数据时。

## 为什么要用迁移学习？

当训练一个新模型时，迁移学习可以加快进度和提高性能，所以当时间是一个因素或者训练一个模型需要大量资源时，主要使用它。出于这些原因，你会经常看到迁移学习用于深度学习项目，包括用于解决自然语言处理(NLP)或计算机视觉(CV)任务的神经网络。当概念漂移可能成为一个问题时，或者当第二个模型需要多任务学习时，也可以使用迁移学习。

另一个使用迁移学习的时间是当可用的 [训练数据不足](https://www.analyticsvidhya.com/blog/2021/06/4-ways-to-handle-insufficient-data-in-machine-learning/) 时。在这些情况下，来自预训练模型的权重可以用于初始化新模型的权重。

只有当第一个模型在其第一个任务中学习的特征被概括并可以转移到第二个任务时，迁移学习才是成功的。出于同样的原因，第二次训练中使用的数据集需要与第一次训练中使用的数据集相似。

## 机器学习中的迁移学习与深度学习

迁移学习是深度学习模型中的一个增长趋势，也是传统机器学习过去使用时的一种替代方法。传统的 [机器学习模型](//blog.dominodatalab.com/a-guide-to-machine-learning-models) 通常被设计用来执行特定的任务，并使用为模型需求定制的数据集进行训练。一旦他们被训练和测试，他们就被放入模拟训练环境的环境中，以实现他们被训练的目的。这可以描述为一种 [孤立的机器学习方法](https://www.section.io/engineering-education/transfer-learning-with-deep-learning/) 。

机器学习中迁移学习的不同之处在于不鼓励孤立。目标是利用来自预训练模型的知识来训练后续模型。其结果是一个学习的菊花链，通常导致更快和更有效的模型开发。用一个人类的比喻来说，考虑一下高中的数学和科学老师正在培养未来的科学家、医生、牙医和数据科学家。

在深度迁移学习的情况下，用于像[自然语言处理](https://www.dominodatalab.com/blog/a-guide-to-natural-language-processsing) (NLP)和[计算机视觉](https://www.dominodatalab.com/blog/what-is-computer-vision)等领域的复杂模型，模型所需的任务可能是单一的，然而，训练数据集可能是不够的。可能是数据太少，也可能是数据标注不充分。当获取或配置高质量数据集的前景需要太多时间时，深度迁移学习可能会更快、更有效。

## 迁移学习方法

迁移学习的使用可以通过几种不同的方法来实现:

### 在相似的领域上训练模型

这种方法包括在相似的域上训练一个模型。比如，假设你需要解决问题 A，但是你没有足够的数据。问题 B 类似于问题 B，你有足够的数据来解决这个问题。因此，您可以针对问题 B 训练一个模型，然后使用这个成功的模型引导一个新的模型来处理问题 a

### 特征抽出

迁移学习方法涉及[特征提取](https://www.dominodatalab.com/blog/feature-extraction-and-image-classification-using-deep-neural-networks)。在这种情况下，数据科学团队将训练一个深度神经网络，用作自动特征提取器。一旦应用于预训练模型，其表示就可以导出到新模型中。

### 开发预先训练的模型

最后，这种方法包括开发考虑迁移学习的预训练模型。在开发模型方面有丰富背景的组织可能经常有一个模型库可以使用。当需要一个新的动作或需要解决一个问题时，可以采用一个预先训练好的模型，对其进行调整以解决手边的问题，然后用于训练一个新的模型。

## 迁移学习过程

无论采用哪种方法，下面概述的流程都是迁移学习如何开发和实施的高级概述:

1.  **获得预先训练的模型:**这些模型可以从您组织自己的模型库中获得，也可以从其他存储库中获得，例如位于 [PyTorch Hub](https://pytorch.org/hub/) 或 [TensorFlow Hub](https://www.tensorflow.org/hub) 的模型。
2.  **冻结层:**这是为了防止模型中的权重被重新初始化。如果它们被重新初始化，模型将会丢失所有的学习。
3.  **训练新层**:新层需要添加到模型中，将其特征转化为新数据集上的 [新预测](//blog.dominodatalab.com/introduction-to-predictive-modeling) 。
4.  **通过微调改善模型:**并非总是需要，微调基础模型可以改善模型性能。这包括解冻部分基础模型，然后在新的数据集上以较低的学习速率再次训练它。

## 行动中的迁移学习

今天有许多迁移学习的应用，更多的应用即将出现。使用迁移学习的一个常见场景是使用图像数据作为数据输入的预测建模。基于图像的数据集问题的预训练模型的例子包括 [牛津 VGG 模型](http://www.robots.ox.ac.uk/~vgg/research/very_deep/)[谷歌盗梦空间模型](https://github.com/google/inception) 和 [微软 ResNet 模型](https://github.com/KaimingHe/deep-residual-networks) 。

迁移学习的另一个流行领域是当模型需要处理语言数据时，包括使用文本的自然语言处理。基于语言的数据问题的预训练模型的例子有 [谷歌的 word2vec 模型](https://code.google.com/archive/p/word2vec/) ，以及 [斯坦福的 GloVe 模型](https://nlp.stanford.edu/projects/glove/) 。

## 开发和实施迁移学习

虽然迁移学习可以减少处理要求和开发时间，但如果算法、预先训练的模型和数据集不容易访问和很好地记录，以及模型驱动的组织所需的治理要求，这就没有什么意义了。

如果您准备好开始迁移学习，请参见我们的[使用 Keras 和 HuggingFace](https://www.dominodatalab.com/blog/transfer-learning-in-python) 进行迁移学习的实践教程。